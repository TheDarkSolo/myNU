dojo.provide("com.ibm.themes.PageBuilder2.nls.theme_en");dojo.provide("com.ibm.mm.enabler.nls.modelMessages");com.ibm.mm.enabler.nls.modelMessages._built=true;dojo.provide("com.ibm.mm.enabler.nls.modelMessages.en");com.ibm.mm.enabler.nls.modelMessages.en={"E_COMNODE_NOTFOUND_1":"BMWMF0011E: Cannot find node ${0}.","E_WIDGETDEF_MUST_BE_IDENTIFIABLE_0":"BMWMF0018E: WidgetDefinition is not identifiable.","E_INVALID_PARAM_TYPE_0":"BMWMF0021E: Parameter ${num} is invalid. Must be of type ${type}","E_NO_PREFTYPE_0":"BMWMF0006E: No preference type is specified.","E_CREATEPREF_NO_CONTEXT_0":"BMWMF0008E: No context is specified when creating a new preference entry.","E_NO_PREFNAME_0":"BMWMF0007E: No preference name is specified.","E_LAYOUTNODE_NOTFOUND_1":"BMWMF0015E: Cannot find node ${0}.","E_INVALID_DOCUMENT_0":"BMWMF0022E: Given document must not be null.","E_XHR_REQUEST_FAILED_2":"BMWMF0025E: XHR request failed to execute. The request returned with status '${0}' and response data '${1}'.","E_PARAM_ISNULL_0":"BMWMF0014E: Parameter must not be null.","E_PARAM_IS_SMALLER_ZERO_0":"BMWMF0016E: Parameter must not be smaller than zero.","E_PARAM_ISNULL_OR_UNDEFINED_3":"BMWMF0024E: Parameter '${0}' in function '${1}.${2}' must not be null or undefined.","E_LOAD_NAVNODE_1":"BMWMF0002E: Could not load the navigation node ${0}.","E_NAVNODE_NOTFOUND_1":"BMWMF0004E: Cannot find node ${0}.","E_INVALID_CONTEXT_MISSING_TYPE_0":"BMWMF0019E: Given context does not contain a type.","E_READONLY_PREF_0":"BMWMF0009E: Values cannot be set on a read-only preference node.","E_INVALID_CONTEXT_SPECIFIED_0":"BMWMF0017E: Given context is invalid.","E_CATNODE_NOTFOUND_1":"BMWMF0010E: Cannot find node ${0}.","E_NODE_ISNULL_0":"BMWMF0001E: Node must not be null.","E_ELEMENT_NOT_FOUND_2":"BMWMF0013E: Cannot find element ${0} in ${1}.","E_INVALID_XPATH_EXPR_0":"BMWMF0023E: Given expression must not be empty.","E_INVALID_PARAM_COUNT_0":"BMWMF0020E: Parameter count is invalid.","E_UNSUPPORTED_OP_0":"BMWMF0003E: This operation is unsupported.","E_OBJECT_DISPOSED_0":"BMWMF0026E: Object has been disposed.","E_CCATNODE_NOTFOUND_1":"BMWMF0012E: Cannot find node ${0}."};dojo.provide("com.ibm.mm.data.nls.dataTypeStrings");com.ibm.mm.data.nls.dataTypeStrings._built=true;dojo.provide("com.ibm.mm.data.nls.dataTypeStrings.en");com.ibm.mm.data.nls.dataTypeStrings.en={"countrycode":"Country Code","languagecode":"Language Code","date":"Date","boolean":"Boolean","json":"JSON","table":"Table","rss":"RSS","email":"E-mail","image":"Image","any":"Any Data","text":"Text","html":"HTML","modeldata":"Model Data","time":"Time","phone":"Phone","url":"URL","currency":"Currency","address":"Address","postalcode":"Postal Code","xml":"XML","timestamp":"Timestamp","person":"Person","number":"Number","atom":"Atom"};dojo.provide("com.ibm.mm.enabler.nls.iwStr");com.ibm.mm.enabler.nls.iwStr._built=true;dojo.provide("com.ibm.mm.enabler.nls.iwStr.en");com.ibm.mm.enabler.nls.iwStr.en={"I_NO_PREVIEW_SUPPORT_0":"BMWIS0001I: This item does not support preview.","ALL_AUTH":"All Authenticated Users","LOAD":"Loading.....","I_ONEUI_INFORMATION_0":"Information","I_ONEUI_INFORMATION_1":"Information:","WIDGET_NOT_INSTALLED":"Widget Not Available","ERROR":"Error","WARNING":"Warning","ANON":"Anonymous","INFO":"Info","WIDGET_NOT_INSTALLED_SUB":"This widget is not enabled or is not available for use."};dojo.provide("com.ibm.mm.enabler.nls.iwMessages");com.ibm.mm.enabler.nls.iwMessages._built=true;dojo.provide("com.ibm.mm.enabler.nls.iwMessages.en");com.ibm.mm.enabler.nls.iwMessages.en={"E_WIDGET_DISPLAY_FAIL_2":"BMWIW0006E: Unable to display the widget ${0}. Error detail: ${1}","W_STANDALONECLASS_MISSING_1":"BMWIW0013W: iw-Standalone class is missing for widget ${0}.","E_IWIDGETDEF_NOTAVAILABLE_1":"BMWIW0001E: The ${0} widget is unavailable. Check your network connection, or contact your administrator.","W_API_DEPRECATED_1":"BMWIW0008W: This method is no longer supported. Use ${0} instead.","E_NODISPLAY_UNSECUREWIDGET_1":"BMWIW0010E: System is unable to display non-trusted widget ${0}.","E_RESOURCE_LOAD_FAIL_2":"BMWIW0011E: Unable to load resource ${0} : ${1}.","E_SUBDOMAIN_NOTAVAILABLE_2":"BMWIW0003E: Unable to load the non-trusted widget ${0} because the number of sub-domains has exceeded its limit of ${1}. To add this widget to your page securely, make a sub-domain available by marking another widget as trusted.","E_SUBDOMAIN_NOTAVAILABLE1_2":"BMWIW0009E: Unable to load the non-trusted widget ${0} because the number of sub-domains has exceeded its limit of ${1}.","E_WIDGET_EVENT_FAIL_3":"BMWIW0007E: Unable to handle event ${0} for widget ${1} . Error detail: ${2}","E_WIDGETS_UNLOAD_FAIL_1":"BMWIW0004E: Unable to unload widgets when browser window is unloaded. Error detail: ${0}","W_DEPRECATE_2":"BMWIW0012W: Deprecated function: ${0}. Use ${1} instead.","E_WIDGET_UNLOAD_FAIL_2":"BMWIW0005E: Unable to unload the widget ${0}. Error detail: ${1}","E_IWIDGETDEF_CONTENTNOTAVAILABLE_1":"BMWIW0002E: Unable to find content for mode -- ${0}.","E_WIDGET_INCORRECTCONFIG_1":"BMWIW0014E: Incorrectly Configured widget '${0}'."};dojo.provide("com.ibm.mm.builder.nls.coreWidgetsMessages");com.ibm.mm.builder.nls.coreWidgetsMessages._built=true;dojo.provide("com.ibm.mm.builder.nls.coreWidgetsMessages.en");com.ibm.mm.builder.nls.coreWidgetsMessages.en={"E_SPACE_UTIL_INVALID_NAME_BLANK_0":"BMWMB0092E: The space name  is required.","E_SPACE_IMPORT_FAIL_1":"BMWMB0106E: The space could not be created. Error detail: ${0}.","E_EDITPAGE_SAVE_ERROR_0":"BMWMB0105E: The page cannot be saved because the navigation layout model is returning null.","E_HTML_EDITOR_CREATE_0":"BMWMB0019E: The HTML Markup widget cannot load because the Dijit editor could not be created. Refresh the page and try again.","E_SPACE_MANAGER_NO_SPACE_FOR_SPACE_CREATION_0":"BMWMB0084E: The space cannot be duplicated because the original space does not exists. Try duplicating a different space.","E_PUBLISH_SPACE_EXPLORTING_SPACE_1":"BMWMB0153E: The following space could not be exported: ${0}.","E_LAYOUT_NOT_SUPPORTED_0":"BMWMB0009E: The layout cannot be changed because it is not supported yet.","E_PUBLISH_PAGE_EXPLORTING_PAGE_1":"BMWMB0053E: The following page could not be exported: ${0}.","E_SKIN_THEME_NOT_EXIST_0":"BMWMB0045E: The page theme was not found in the theme model.","I_TOOLBOX_PAGE_SAVED_1":"BMWMB0001I: Page '${0}' was saved successfully.","E_SPACE_CREATE_FAIL_1":"BMWMB0108E: The space cannot be created. Error detail: ${0}.","E_SHARE_WITH_ME_COMMUNITY_FAIL_1":"BMWMB0041E: The community was not found in the following node: ${0}.","E_COLUMN_LAYOUT_INIT_1":"BMWMB0014E: The page could not load because the column layout widget failed to initialize. Error detail: ${0}","E_SPACE_COPY_FAIL_1":"BMWMB0109E: The space cannot be copied. Error detail: ${0}.","E_SPACE_MANAGER_SPACE_OWNER_IS_REQUIRED_0":"BMWMB0079E: A space owner is required.","E_PAGE_UTIL_INVALID_NAME_EMPTY_0":"BMWMB0032E: A page name is required.","I_SUCCESSFUL_AUTO_WIRING_2":"BMWMB0012I: Widget '${0}' was wired with '${1}' successfully.","E_SPACE_MANAGER_SPACE_DESC_HAS_MAX_LIMIT_0":"BMWMB0104E: Space descriptions cannot exceed 512 characters.","E_NAV_REFRESH_NAVIGATION_1":"BMWMB0028E: The navigation could not be refreshed. Error details: ${0}.","E_SPACE_UTIL_INVALID_NAME_LENGTH_0":"BMWMB0093E: The space name cannot contain more than 255 characters.","E_EMBEDDING_WIDTHHEIGHT_INPUTERROR1_0":"BMWMB0066E: The value must be between 50 and 2000 pixels.","E_SPACE_IMPORT_INVALID_FILE_TYPE_0":"BMWMB0097E: The file type for the space import is invalid.","E_EMBEDDING_WIDTHHEIGHT_INPUTERROR2_0":"BMWMB0067E: The value must be an integer.","E_MAIN_LOAD_INVALIDTHEME_0":"BMWMB0099E: The page theme could not be loaded and has temporarily changed to the default theme. Go to Page Settings to change the theme.","E_MAIN_LOAD_NAV_MODEL_FAIL_1":"BMWMB0038E: The navigation model using enabler API (URI: ${0}) could not be loaded. Contact your system administrator for help.","E_HTML_UTIL_SET_CLASS_1":"BMWMB0027E: The class attribute could not be set. Error detail: ${0}","E_SPACE_MANAGER_PAGE_EXPORT_URL_IS_NULL_0":"BMWMB0100E: The URL of the page export is required.","E_SPACE_MANAGER_SPACE_CREATED_FAILED_0":"BMWMB0081E: The space was not created.","E_ACL_FAIL_TO_GET_PERMISSION_1":"BMWMB0007E: Permission for this user was not found . Error detail: ${0}","E_PAGE_IMPORT_FAIL_1":"BMWMB0107E: The page could not be created. Error detail: ${0}.","E_EMBEDDING_NOPREVIEWDLG_ERROR_0":"BMWMB0064E: The preview window does not exist.","E_PAGE_UTIL_INVALID_DESCRIPTION_LENGTH_1":"BMWMB0120E: The page description is limited to ${0} characters. Shorten your description and save again.","E_COLUMN_WITH_RESIZER_CHANGE_SIZE_1":"BMWMB0023E: The column size cannot be changed because the cursor position could not be determined. Error details: ${0}","E_SHARE_PAGE_NO_PERMISSION_0":"BMWMB0080E: The page cannot be shared. Ask your system administrator to confirm that you have the required permissions.","E_NEW_PAGE_POSITION_MISSING_0":"BMWMB0075E: A new position is required to reorder the page.","E_FREEFORM_LAYOUT_LOAD_1":"BMWMB0016E: The page cannot display because the free-form layout widget could not be loaded. Error detail: ${0}","E_NAV_NO_PAGE_OR_NET_DISCONNECT_0":"BMWMB0069E: The server cannot be reached. Try reloading your browser.","E_COLUMN_CREATE_WIDGET_1":"BMWMB0004E: The widget could not be created. Error detail: ${0}","E_PUB_API_PAGE_MODE_CHANGE_1":"BMWMB0056E: The page mode could not be updated. Error details: ${0}.","I_PUBLISH_PAGE_1":"BMWMB0002I: Page '${0}' was published successfully.","E_TAG_SERVICE_ATTACH_FAIL_1":"BMWMB0047E: The skin could not be attached. Error details: ${0}.","E_SPACE_MANAGER_SPACE_NAME_HAS_MAX_LIMIT_0":"BMWMB0102E: The space name cannot exceed 256 characters.","E_SPACE_IMPORT_FILENAME_IS_REQUIRED_0":"BMWMB0096E: A file is required.","E_PAGE_UTIL_INVALID_NAME_LENGTH_0":"BMWMB0034E: The page name cannot contain more than 255 characters.","E_COLUMN_DND_1":"BMWMB0003E: The drag and drop action could not be completed. Refresh the page and try again. Error detail: ${0}","E_PUB_API_PAGE_PROPERTY_UPDATE_1":"BMWMB0060E: The page property could not be updated. Error details: ${0}.","E_SPACE_UTIL_INVALID_NAME_EMPTY_0":"BMWMB0091E: A space name is required.","E_PUB_API_PAGE_SAVE_1":"BMWMB0059E: The page content could not be saved. Error details: ${0}.","E_SKIN_LOAD_TEMPLATE_FAIL_1":"BMWMB0044E: The following skin template could not be found: ${0}.","E_DND_CREATEWIDGET_0":"BMWMB0054E: The widget definition was not found.","I_TOOLBOX_DELETE_WARN_1":"BMWMB0055I: Do you want to delete catalog entry ${0}?","E_LAYOUT_UTIL_CHOOSE_SKIN_0":"BMWMB0026E: The skin cannot be selected because the theme could not be found in the theme model.","E_PUB_API_DELETE_PAGE_1":"BMWMB0071E: The page could not be deleted. Error details: ${0}.","E_COLUMN_LAYOUT_LOAD_1":"BMWMB0015E: The page could not be accessed because the column layout widget failed to load properly. Error detail: ${0}","E_HTML_UTIL_REMOVE_ATTR_FAIL_0":"BMWMB0042E: The widget attribute 'widgetstatus' could not be removed.","E_EMBEDDING_WIDGET_ERROR_0":"BMWMB0063E: No supported mode could be found to display the widget.","E_LAYOUT_UTIL_CREATE_SKIN_CONF_0":"BMWMB0025E: The skin cannot be created because the theme could not be found in the theme model.","E_SKIN_LOAD_ROOT_FAIL_1":"BMWMB0046E: The following skin root URL could not be found: ${0}.","E_MAIN_LOAD_THEME_MODEL_FAIL_0":"BMWMB0138E: The following theme could not be found: ${0}. Contact your system administrator.","E_NAV_LOAD_PAGE_1":"BMWMB0121E: The page could not be loaded. Error details: ${0}.","E_PAGE_UTIL_INVALID_NAME_DUP_1":"BMWMB0036E: A page named [ ${0} ] already exists. Select a different name.","E_SPACE_MANAGER_NO_TEMPLATE_FOR_SPACE_CREATION_0":"BMWMB0082E: The specified template does not exist in the catalog. Try using a different template.","E_EMBEDDING_NOWIDGET_ERROR_1":"BMWMB0065E: The following widget instance does not exist: ${0}.","E_NAVIGATION_SWITCH_PAGE_1":"BMWMB0021E: The page cannot be loaded. Error details: ${0}","I_NO_AUTO_WIRING_2":"BMWMB0013I: The wire between widgets '${0}' and '${1}' could not be created.","E_CONTEXT_MENU_FAIL_1":"BMWMB0112E: The context menu could not be loaded. Error details: ${0}.","E_CONTEXT_MENU_FAIL_2":"BMWMB0113E: The context menu could not be loaded. Error details: ${0}.","E_PAGE_UTIL_INVALID_NAME_BLANK_0":"BMWMB0033E: A page name is required.","E_SPACE_UTIL_INVALID_NAME_CHAR_0":"BMWMB0094E: A space name cannot contain any of the following characters: \n\t\t\t @\\/:*?\"<>|.","E_CONTEXT_MENU_FAIL_3":"BMWMB0114E: The context menu could not be loaded. Error details: ${0}.","E_SPACE_MANAGER_PAGE_ID_IS_NULL_0":"BMWMB0077E: A page ID is required.","E_CONTEXT_MENU_FAIL_4":"BMWMB0115E: The context menu could not be loaded because the ID does not exist. Error details: ${0}.","E_MAIN_LOAD_PAGE_FAIL_2":"BMWMB0039E: The page cannot be loaded because of the following error: ${0} - ${1}. Contact your system administrator.","E_SPACE_SAVE_AS_TEMPLATE_FAIL_1":"BMWMB0110E: The space could not be saved as a template. Error detail: ${0}.","E_PAGE_MENU_FAIL_ACCESS_1":"BMWMB0049E: The access level could not be found. Provide your system administrator with the following error details: ${0}.","E_EMBEDDING_PAGEACCESS_ERROR_0":"BMWMB0070E: Either the content you requested does not exist, or the content owner has not granted you permission to view it.","E_MOVE_PAGE_INSUFFICIENT_ACCESS_RIGHTS_0":"BMWMB0111E: The page cannot be moved because of insufficient access rights.","I_PUBLISH_SPACE_1":"BMWMB0102I: Space '${0}' was published successfully.","E_PAGE_SOURCE_GET_SINGLE_WIDGET_1":"BMWMB0024E: The widget source could not be found. Error detail: ${0}","E_ACL_FAIL_TO_CALL_COMMUNITY_COMMIT_1":"BMWMB0101E: The following function was not called: communityModel.commit(). Error detail: ${0}","E_PUB_API_CREATE_PAGE_1":"BMWMB0062E: The page could not be created. Error details: ${0}.","E_ACCOUNT_SETTING_SAVE_FAIL_1":"BMWMB0098E: The account settings could not be saved. Error details: ${0}.","E_DIFFERENT_LOCATION_REQUIRED_0":"BMWMB0074E: This selection keeps the page in its current position. To move the page, select a different location.","E_PAGE_UTIL_INVALID_NAME_CHAR_0":"BMWMB0035E: A page name cannot contain any of the following characters: \n\t\t\t @\\/:*?\"<>|.","E_PUBLISH_PAGE_NO_PERMISSION_0":"BMWMB0083E: The page [ ${0} ] cannot be viewed because the page owner [ ${1} ] has not given you view permission.","E_SPACE_MANAGER_SPACE_NAME_HAS_INVALID_CHAR_0":"BMWMB0103E: The space name contains one or more of the following invalid characters: @\\/:*?\"<>|.","E_DATA_VIEWER_LOAD_G11N_PROP_0":"BMWMB0018E: The Data Viewer widget cannot load because the widget's language resource file cannot be found.","E_SPACE_UTIL_INVALID_NAME_DUP_1":"BMWMB0095E: A space named [ ${0} ] already exists. Select a different name.","E_HTML_MARKUP_LOAD_FAIL_1":"BMWMB0051E: The HTML Markup widget could not be loaded. Error details: ${0}.","E_SKIN_NOT_EXIST_0":"BMWMB0043E: This skin does not exist in the current theme.","E_SKIN_NOT_EXIST_1":"BMWMB0072E: This skin does not exist in the current theme. Use the default skin instead.","E_MODE_SELECTOR_GET_CATALOG_1":"BMWMB0022E: The catalog cannot be loaded. Error details: ${0}","E_MAIN_INVALID_ID_2":"BMWMB0011E: Content for the page ID {0} cannot be found. Error detail: ${1}","E_SYSTEM_WIDGET_ONUNLOAD_ERROR_2":"BMWMB0068E: The system widget ${0} could not be destroyed. Error details: ${1}.","E_SKIN_NOT_EXIST_2":"BMWMB0073E: This skin does not exist in the current theme. Use the first skin instead.","E_SPACE_MANAGER_SPACE_ID_IS_NULL_0":"BMWMB0076E: A space ID is required.","E_SPACE_MANAGER_SPACE_NAME_IS_REQUIRED_0":"BMWMB0090E: A space name is required.","E_NAV_PANE_PUBLISH_EVENT_ERROR_1":"BMWMB0052E: The following event could not be invoked: serviceManager.getService publishEvent. Error details: ${0}."};dojo.provide("com.ibm.mm.builder.nls.coreWidgetsStr");com.ibm.mm.builder.nls.coreWidgetsStr._built=true;dojo.provide("com.ibm.mm.builder.nls.coreWidgetsStr.en");com.ibm.mm.builder.nls.coreWidgetsStr.en={"I_COLUMN_CONF_COLUMN_NUMBER_1":"One","I_COLUMN_CONF_COLUMN_NUMBER_2":"Two","I_COLUMN_CONF_COLUMN_NUMBER_3":"Three","I_CHANGE_PAGE_OWNER_HEADER":"Changing page owner for","I_CHANGE_SPACE_OWNER_NOTE":"Users with edit permission can add, delete, and configure pages in the space. Users with view access can only view pages in the space.","I_COLUMN_CONF_COLUMN_NUMBER_4":"Four","I_CONTEXT_MENU_RESIZE":"Resize","I_PAGE_PROPERTIES_CHANGE_OWNER":"Change Owner","I_COLUMN_CONF_MOVEWIDGET_COLUMN_INFO_1":"Column ${0}","I_PAGE_PROPERTIES_NO_PAGE_OWNER":"No Page Owner","I_PAGE_PROPERTIES_PAGE_WIDTH_MODE_FIXED":"Fixed width","I_COLUMN_CONF_ALLCOLUMN_FOR":"Settings for all columns:","I_ACL_PERMISSION_EDIT":"Edit","I_COMMON_ACTION_LOGIN_ALT":"Log In","I_COLUMN_CONF_MOVEWIDGET_SELECTED_ROW_INFO_1":"Row ${0} is selected.","I_PAGE_PROPERTIES_AUTO_WIRING":"Automatic Wiring","I_SPACE_MANAGER_SPACE_INFO_NO_OWNER":"No Owner.","E_SPACE_MANAGER_LIST_HUB_PAGES_FAILED":"Failed to load pages in catalog, please try again.","I_SPACE_MANAGER_ACTIONS":"Actions","W_NO_PAGE_TO_SHOW":"No pages currently exist. \n Either create a new mashup page and add it to your navigation, or add a new or existing page to your space. Spaces must contain at least one page.","I_PUBLISH_PAGE_LABEL_VERSION":"Version:","I_COLUMN_CONF_WIDGET_APPLY_SKIN_ALL":"Apply to future and all existing widgets","I_ACL_INSUFFICIENT_PERMISSION":"You do not have sufficient access rights (delegate) on the user <${0}> to share this page.","I_ACCOUNT_SETTINGS_LOGIN_LAST_PAGE":"The last page I visited.","EDIT_SPACE_PROPERTIES":"Edit Settings: ${0}","I_FREEFORM_CONF_PAGE_BACKGROUND":"Page Background","I_FREEFORM_CONF_MORE":"More Options...","I_FREEFORM_CONF_PAGE_BG_NONE":"None","I_PUBLISH_SPACE_LABEL_PERMISSION_PRIVATE":"Private(Space is invisible to all other users)","I_AUTO_WIRING_NOTIFICATION_SENDING_TO":"Sending to ${0}","I_EMBED_PREVIEW_BYDEFAULT":"Always open preview by default.","I_PUBLISH_PAGE_LABEL_PERMISSION_PRIVATE":"Private (Page displays in the catalog for you only)","I_EMBED_PREVIEW_CLOSE":"Close Preview","I_SPACE_MANAGER_SPACE_INFO":"Owned by ${0} | Pages : ${1}","I_WIRING_OTHER_WIDGETS_SEND":"Select another widget to receive content","I_WIRING_SEND_EVENT_DESCRIPTION":"This event send data to ${0} event(s)","I_COLUMN_CONF_WIDGET_DEFAULT_SKIN":"Default skin for new widgets","I_ACL_SEARCHSCOPE":"Show Search Scope","E_SPACE_MANAGER_PAGE_CATALOG_PAGE_REQUIRED":"You are attempting to use a page that does not exist in the catalog. Try using a different page.","I_ACL_REASSIGN_BTN":"Reassign","I_WIRING_EVENT_CONTENT_SEND":"${0} ${1} as ${2} ${3}","I_PUBLISH_PAGE_LABEL_DESC":"Description:","I_WIRING_EVENTS_RECEIVE":"Select content to receive","I_COMMON_ACTION_HELP_ALT":"Open the IBM Mashup Center wiki","I_CHANGE_PAGE_OWNER_SAME":"The same permissions as the space","I_CONTEXT_MENU_WIDGET_HEIGHT":"Widget height:","I_AUTO_WIRING_OPEN_PROPERTIES":"View and modify widget wiring.","I_COMMON_PREVIEW":"Preview","I_CREATE_SUBPAGE_IN_SPACE_TITLE":"Create a child page for: ${0}","I_EMBED_PAGE_WIDTH_INPUT_TITLE":"Set width","CREATE_SPACE_FROM_SPACE":"Duplicate an existing space","I_MODE_SELECTOR_BUTTON":"Mode Selector button","I_ACL_SEARCHINPUT":"Search Input","I_SPACE_MANAGER_RECENT_SPACES_HINT":"Displays the last five spaces you visited","I_PAGE_SOURCE_SOURCE_MODE":"Source Mode","COPY_SPACE_CAPTION":"Duplicate: ${0}","I_FREEFORM_CONF_PAGE_BG_URL":"URL","I_SEARCH_NO_RESULT_TEXT_USER":"No users were found. Try another search item.","I_WIRINGGRAPH_TITLE":"Wiring Graph","CREATE_SPACE_FROM_EMPTY":"Create an empty page","PAGE_MENU_PUBPAGE_CON_TEXT1":"The last saved version of the page will be published to the catalog.","I_PUBLISH_PAGE_EXPORTING_PAGE_1":"Exporting page via ${0}","PAGE_MENU_PUBPAGE_CON_TEXT2":"Do you want to save your changes before publishing this page?","I_ACCOUNT_SETTINGS_DISPLAY_NOTIFICATION":"Notify me when automatic wiring occurs. Notification includes a list of widgets that are wired together.","I_FREEFORM_CONF_PAGE_MARGIN":"Page Margin","I_WIRING_EVENT_TITLE_SEND":"${0} as ${1}: ${2}","I_PUBLISH_PAGE_CANCEL_LINK_TITLE":"Cancel","I_FREEFORM_CONF_RESTORE_DEFAULT_PAGE_PROPERTIES":"Restore default page properties","PAGE_MENU_PUBPAGE_CON_PWOS":"Do not save","I_PAGE_PROPERTIES_PAGE_WIDTH_MODE":"Page width","I_AUTO_WIRING_NOTIFICATION_TITLE":"Auto-Wiring Notifications","I_MODE_SELECTOR_GO_EDIT":"Go to Edit","I_COLUMN_CONF_PAGE_PROPERTIES":"Page Properties","I_WIRING_OTHER_EVENTS_RECEIVE":"Select other content to receive","I_COLUMN_CONF_COLUMN_PROP_BORDER":"Border:","I_SPACE_MANAGER_PAGE_INFO":"Owned by ${0}","I_PUBLISH_SPACE_EXPORTING_SPACE_1":"Exporting space via ${0}","I_PAGE_SAVE_TITLE":"Save Page","COPY_SPACE_NAME":"Space name:","I_SPACE_MANAGER_FAVORITE_SPACES":"Favorite Spaces","I_EMBED_PAGE_SCROLL_BAR_OFF_TITLE":"Scroll bar off","I_COMMON_ACTION_LOGIN":"Log In","I_CONTEXT_MENU_WIDGET_ICONURL":"Widget Icon URL","I_ACL_DIALOG_DESC":"Search for users and groups, and then drag them from list to list to give them view and edit permissions","I_CONTEXT_MENU_WIRE":"Edit Wiring","I_PAGE_SAVE_KEEP_EDIT":"Cancel","I_IFRAME_TITLE":"iframe","I_EMBED_PAGE_PREVIEW_TITLE":"Preview for ${0}","I_SPACE_IS_HOME_SPACE":"Home Space","I_CREATE_PAGE_IN_SPACE_PAGE_DESCRIPTION":"Page description:","I_CREATE_PAGE_IN_SPACE_ADD_FROM_CATALOG":"Add a page from the catalog","I_PAGE_PROPERTIES_HINT_FOR_FLUID_MODE":"Minimum page width:","I_SYSTEM_MESSAGE_APPLY":"Apply","I_NVA_TITLE":"Hidden Widgets","I_FREEFORM_CONF_PAGE_COLOR_PICKER_COLOR_TITLE":"Red is ${0},  Green is ${1}, Blue is ${2}","I_COLUMN_CONF_PAGE_BG_IMAGE_PROP_REPEATH":"Repeat Horizontal","I_WIRING_WIDGETEVENTS_RECEIVE":"Select content to send","COPY_SPACE_HINT":"The new space will have the same share settings as the original space.","I_FREEFORM_CONF_PAGE_BG_IMAGE_TRANS":"Background Image Transparency","I_ACL_SEARCH_RESULT":"Search Results","I_FREEFORM_CONF_WIDGET_PROPERTIES":"Widget Properties","I_PUBLISH_SPACE_LABEL_PERMISSION_PUBLIC":"Public(All users can view this space)","PAGE_MENU_DELETE_MESSAGE":"Do you want to delete or remove this page and all its child pages?","I_ACL_GROUP_SEARCH":"Group Search","E_SPACE_MANAGER_PAGE_TO_COPY_REQUIRED":"You are attempting to duplicate a page that does not exist. Try duplicating a different page.","I_SPACE_MANAGER_IMPORT":"Import","EDIT_SPACE_ICON_ALT_IMAGE10":"Reviews","I_COLUMN_CONF_PAGE_BG_IMAGE_PROP_REPEATV":"Repeat Vertical","LAYOUT_BORDER_STYLE_DOTTED":"dotted","EDIT_SPACE_ICON_ALT_IMAGE11":"PDA","EDIT_SPACE_ICON_ALT_IMAGE12":"Computer","I_WIRING_PORTLETS_AND_WIDGETS":"NOTE: Wires between portlets and widgets may not function properly in a server side aggregated page.","EDIT_SPACE_ICON_ALT_IMAGE13":"Money","I_COLUMN_CONF_WIDTH_BETWEEN_COLUMN":"Width between columns","I_COLUMN_CONF_MORE":"More Options...","EDIT_SPACE_ICON_ALT_IMAGE14":"Data","EDIT_SPACE_ICON_ALT_IMAGE15":"Default","I_ACCOUNT_SETTINGS_LOGIN_TITLE":"When I login, take me to:","I_PUBLISH_SPACE_LABEL_DESC":"Description:","I_PAGE_PROPERTIES_ADVANCED":"Advanced","EDIT_SPACE_ICON_ALT_IMAGE16":"Checklist","I_CONTEXT_MENU_COLUMNWIDGET_POSITION_IN_COLUMN_LABEL":"Position in column:","I_CONTEXT_MENU_CONFIG":"Edit Settings","EDIT_SPACE_ICON_ALT_IMAGE17":"Feeds","EDIT_SPACE_ICON_ALT_IMAGE18":"Files","I_MODE_SELECTOR_GO_CATALOG_NEW_WINDOW":"Open Catalog in a New Browser","EDIT_SPACE_ICON_ALT_IMAGE19":"Global repository","I_FREEFORM_CONF_RESTORE_BUTTON":"Restore Defaults","I_COLUMN_CONF_PAGE_BORDER":"Page Border","I_COMMON_OK":"OK","I_SYSTEM_MESSAGE_NAME":"System Message","I_CHANGE_SPACE_OWNER_EDIT":"Edit permission on this space","I_ACL_INCLUDE_VIEWER":"Include viewers from parent","CREATE_SPACE_FROM_TEMPLATE":"Create a new space using a template","I_ACCOUNT_SETTINGS_TITLE":"My Account Settings","I_WIRING_PAYLOAD_TYPE_MATCH":"Consider payload type only for matching of sources and targets","I_WIRINGGRAPH_LINK_EXPLAIN_TEXT":"A wire exists between widget ${0} and widget ${1}.","EDIT_SPACE_ICON_ALT_IMAGE20":"Global process","EDIT_SPACE_ICON_ALT_IMAGE21":"Home","EDIT_SPACE_ICON_ALT_IMAGE22":"Graph","I_SPACE_MANAGER_FILTER_SPACES":"Filter Spaces","I_SEARCH_INPUT_VALID_ITEM":"Specify a valid search item.","I_CONTEXT_MENU_WIDGET_TOP_LABEL":"Top coordinate","EDIT_SPACE_ICON_ALT_IMAGE23":"Globe","I_CONTEXT_MENU_COLUMNWIDGET_POSITION_IN_COLUMN_PANEBOX_TITLE":"Row ${0} of column ${1}","I_PAGE_SOURCE_CONTENT_FRAME":"Content Frame","I_COLUMN_CONF_OPTIONS_FOR_NUMBER_1":"Column One","EDIT_SPACE_ICON_ALT_IMAGE24":"Human 01","I_COLUMN_CONF_OPTIONS_FOR_NUMBER_2":"Column Two","EDIT_SPACE_ICON_ALT_IMAGE25":"Human 02","I_COLUMN_CONF_OPTIONS_FOR_NUMBER_3":"Column Three","EDIT_SPACE_ICON_ALT_IMAGE26":"Human 03","I_COLUMN_CONF_OPTIONS_FOR_ALL":"All columns","I_NAVIGATION_NEW_PAGE":"Create a New Page","I_COLUMN_CONF_OPTIONS_FOR_NUMBER_4":"Column Four","I_SEARCH_TEXT":"Enter search text","EDIT_SPACE_ICON_ALT_IMAGE27":"User related","EDIT_SPACE_ICON_ALT_IMAGE28":"Inbox","I_SPACE_MANAGER_ACTION_CREATE_COPY":"Create a copy","EDIT_SPACE_ICON_ALT_IMAGE29":"Laptop","I_COLUMN_LAYOUT_NAME":"Column Layout","I_COMMON_EDITSETTING":"Edit Setting","I_COLUMN_CONF_RESTORE_DEFAULT_WIDGET_PROPERTIES":"Restore default widget properties","I_SPACE_MANAGER_RECENT_SPACES_TITLE":"Recent Spaces","I_COMMON_REMOVE":"Remove","I_SYSTEM_CONF_TITLE":"${0} Edit","I_ACL_USER_SEARCH":"User Search","I_CHANGE_PAGE_OWNER_NEW_NAME":"Name of new owner:","I_COLUMN_CONF_PAGE_BG_NONE":"None","I_SEARCH_INDICATE":"Searching...","I_AUTO_WIRING_NOTIFICATION_DISABLE_NOTI":"Do not show this notification again","I_EMBED_PAGE_TITLE":"Display on a Web Page: ${0}","EDIT_SPACE_ICON_ALT_IMAGE30":"Stats 2","I_COMMON_CANCEL":"Cancel","EDIT_SPACE_ICON_ALT_IMAGE31":"Server","EDIT_SPACE_ICON_ALT_IMAGE32":"Mail","I_CHANGE_PAGE_OWNER_SEARCH_RESULTS":"Search results:","I_PAGE_PROPERTIES_THEME":"Theme:","EDIT_SPACE_ICON_ALT_IMAGE33":"Diagram","I_SPACE_MANAGER_ACTION_ADD_PAGE":"Add a new page","EDIT_SPACE_ICON_ALT_IMAGE34":"Cart","EDIT_SPACE_ICON_ALT_IMAGE35":"Space","EDIT_SPACE_ICON_ALT_IMAGE36":"Stats","EDIT_SPACE_ICON_ALT_IMAGE37":"Tables","EDIT_SPACE_ICON_ALT_IMAGE38":"Teams","EDIT_SPACE_ICON_ALT_IMAGE39":"Tasks","I_SPACE_MANAGER_DELETE_SPACE_TITLE":"Delete: ${0}","I_COLUMN_CONF_PAGE_BG_IMAGE_TRANS":"Background Image Transparency","EDIT_SPACE_CHOOSE_THEME":"Choose a theme:","I_EMBED_PAGE_WIDTH_MODE_AUTO_TITLE":"Use auto width","I_MODE_SELECTOR_CREATE_FEED":"Create New Feed ...","I_COLUMN_CONF_PAGE_BG_IMAGE_PRO_REPEATB":"Repeat Both","I_WIDGET_BUILDER":"Widget Builder","I_WIRING_OTHER_WIDGETS_RECEIVE":"Select another widget to send content","I_EDIT_PROPERTIE_PAGE":"Edit: ${0}","I_DELETEDLG_CONFIRMDELETE_CHILD_DESC":"Delete this page and all its child pages?","I_DELETEDLG_CONFIRMDELETE":"Do you want to delete this page and all its child pages ?","I_COLUMN_CONF_PAGE_BORDER_COLOR":"Page Border Color","I_CHANGE_PAGE_OWNER_VIEW":"View permissions on this page","EDIT_SPACE_ICON_ALT_IMAGE40":"Truck","EDIT_SPACE_ICON_ALT_IMAGE41":"Business Compass","EDIT_SPACE_CHOOSE_ICON":"Choose an icon:","I_SPACE_MANAGER_YOUR_SPACES":"Your Spaces","I_EMBED_PAGE_MARKUP_TEXTAREA_TITLE":"Markup","I_PAGE_SAVE_NO_SAVE":"Do not save","I_CONTEXT_MENU_MODE_HELP":"Help","I_COLUMN_CONF_PAGE_BG_IMAGE_PROP_CENTER":"Center","I_WIRING_NO_RECEIVE_EVENTS":"No action is available to receive content.","I_SEARCH_NO_RESULT_TEXT_GROUP":"No groups were found. Try another search item.","I_SPACE_PERSONAL_SPACE_PAGE_DESCRIPTION":"My Mashup Apps is your personal work zone for assembling, configuring, and wiring mashup applications. In this mode, you can create individual mashup pages, set sharing permissions, and publish those pages to the community-based catalog for others to discover and reuse. You can also reuse pages that others have shared with you and use them as building blocks in your own applications.","I_IMPORT_PAGE_TITLE":"Import Page","I_PUBLISH_SPACE_LABEL_TAG":"Tags:","I_CONTEXT_MENU_DISPLAY":"Display","PAGE_MENU_PUBPAGE_CON_SAP":"Save","EDIT_SPACE_THEME":"Theme","I_WIRINGGRAPH_BOTTOM_MESSAGE_BEFORE":"Only wires to and from ${0} are displayed.","I_FREEFORM_CONF_PAGE_BG_URL_REQUIRED":"URL Required","I_PAGE_PROPERTIES_AUTO_WIRING_TXT":"Enable automatic wiring when you want the page to wire widgets together automatically. The widget creator must have configured the widgets to accept automatic wiring. The widgets must also share a common event name and payload type.","I_PUBLISH_SPACE_LABEL_VERSION":"Version:","CREATE_SPACE_EXISTING_SPACE":"Existing space list","I_SEARCH_CATALOG":"Search the Catalog","I_CONTEXT_MENU_WIRE_GRAPH":"View Wiring Graph","I_ACCOUNT_SETTINGS_WHEN_NOTI_ENABLED":"When enabled:","I_MODE_SELECTOR_GO_SOURCE":"View Source","I_WIRING_CWIDGET_SEND":"Widget to send content","I_IMPORT_SPACE_TITLE":"Import Space","I_WIRING_PROMPTER_SEND_1":"What content do you want '${0}' to send to another widget on the page ?","I_WIRING_PROMPTER_SEND_2":"Which widget on the page do you want to receive the content '${0}' ?","I_FREEFORM_CONF_PAGE_BG_IMAGE_PROP_SCALE":"Scale","I_WIRING_PROMPTER_SEND_3":"Which action do you want to take place when '${0}' receives the content '${1}' ?","PAGE_MENU_EMBPAGE_CON_PWOS":"Do not save","I_SPACE_MANAGER_HIDDEN":"- Hidden from other users' view","E_SPACE_MANAGER_CREATE_NEW_PAGE_FAIL":"Failed to create this page. Try again.","I_PAGE_SAVE_WARNING":"The page you are leaving has unsaved changes.","I_COLUMN_CONF_COLUMN_BORDER_COLOR":"Column Border Color","I_WIRINGGRAPH_LOADING_MESSAGE":"Loading...","MESSAGE_BOX_ICON_ERROR":"error","I_WIRING_NO_MATCH_WIDGET":"A connection widget is not available.","I_SPACE_PERSONAL_SPACE":"My Mashup Apps","I_COLUMN_CONF_MOVEWIDGET_ROW_INFO_1":"Row ${0}","I_SYSTEM_MESSAGE_DONE":"Done","I_WIRING_PAYLOAD_TYPE_OR_ALIAS_MATCH":"Consider semantic types or payload type for matching of sources and targets","EDIT_SPACE_ICON":"Icon","I_SPACE_MANAGER_ALL_SPACES":"All Spaces","I_PUBLISH_PAGE_TITLE":"Publish: ${0}","I_SPACE_PORTAL":"Portal","I_COLUMN_CONF_RESTORE_TITLE":"Restore the page back to the default settings:","EDIT_SPACE_INFORMATION":"Space Information","I_EMBED_PAGE_HEIGHT_INPUT_TITLE":"Set height","I_COLUMN_CONF_PAGE_BG_IMAGE_PROP_SCALE":"Scale","I_CREATE_PAGE_IN_SPACE_EMPTY_PAGE":"Create an empty page","CREATE_SPACE_DESC":"Space description:","I_COLUMN_CONF_COLOUR":"Red is ${0},  Green is ${1}, Blue is ${2}","SWITCH_JAWS_MODE":"If JAWS didn't turn off the virtual cursor pc mode, please use Insert plus Z to change JAWS mode","I_CHANGE_PAGE_OWNER_HEADER_COMBO":"Changing page owner for ${0}'s ${1}","I_COLUMN_CONF_PAGE_BG_URL":"URL","I_WIRING_EVENT_CONTENT_RECEIVE":"${0} ${1} using ${2} ${3}","I_ACCOUNT_SETTINGS_LOGIN_PROPS":"Login Properties","I_ACL_PERMISSION_VIEW":"View","PUBLISH_SPACE_CAPTION":"Publish as Template: ${0}","I_CONTEXT_MENU_MOVE":"Move","LAYOUT_BORDER_STYLE_NONE":"none","I_SPACE_MANAGER_NEW_PAGE":"New Page","CREATE_SPACE_CAPTION":"Create Space","I_COMMON_PUBLISH":"Publish","I_WIRING_PROMPTER_RECEIVE_1":"What content do you want ${0} to receive from another widget ?","I_SEARCH_GROUP":"Search for Group","I_WIRING_PROMPTER_RECEIVE_2":"Which widget on your page should send content to action '${0}' ?","I_WIRING_PROMPTER_RECEIVE_3":"Which action's content do you want the ${0} send to ${1} ?","I_CONTEXT_MENU_WIDGET_RIGHT_LABEL":"Right coordinate","I_COLUMN_CONF_WIDGET_PROPERTIES":"Widget Properties","I_SPACE_MANAGER_DONE":"Done","I_COLUMN_CONF_RESTORE_BUTTON":"Restore Defaults","I_CHANGE_PAGE_OWNER":"Change Page Owner","I_WIRING_RECEIVE_EVENT_DESCRIPTION":"This event receive data from ${0} event(s)","I_CONTEXT_MENU_WIDGET_TITLE":"Widget name:","I_WIRING_NAME":"Wiring","I_SKIN_WIRE_ICON_TITLE":"Wire widgets","I_ACL_INCLUDE_EDITOR":"Include editors from parent","I_DELETECONFIRM_WIDGETDELETE":"The widget you are deleting:","I_PUBLISH_PAGE_LABEL_TAG":"Tags:","I_WIRING_CWIDGET_RECEIVE":"Widget To receive content","I_COLUMN_CONF_COLUMN_PROP_BG_COLOR":"Background color:","I_SPACE_MANAGER_SAVE_SPACE_AS_TEMPLATE_OK":"Space \"${0}\" has been saved as a template.","I_WIRING_MATCHING_MODE":"Matching Mode","I_EMBED_PAGE_SCROLL_BAR_ON_TITLE":"Scroll bar on","I_COLUMN_CONF_RESTORE_DEFAULT_PAGE_PROPERTIES":"Restore default page properties","I_MODE_SELECTOR_OPEN":"Open Mode Selector Menu","I_SPACE_MANAGER_COPY_OF":"Copy of ${0}","I_FREEFORM_CONF_PRO_TITLE":"Properties for Freeform Layout","I_EMBED_WIDGET_HEADERTEXT":"Add ${0} to Web page","I_CREATE_PAGE_IN_SPACE_TITLE":"Create Page","I_PUBLISH_PAGE_LABEL_SHARE_METHOD":"Sharing Method:","I_MODE_SELECTOR_GO_CATALOG":"Open Catalog in a Dialog Box","I_COMMON_CLOSE":"Close","I_FREEFORM_CONF_PAGE_COLOR":"Background Color:","I_COLUMN_CONF_WIDGET_APPLY_TOWIDGETS":"Apply to all widgets","I_FREEFORM_CONF_SKIN_SELECTED":"${0} skin is selected","I_CONTEXT_MENU_RESIZE_WIDGET_PROMPT":"Resize: ${0}","I_CHANGE_SPACE_OWNER_SEARCH_RESULTS_EMPTY":"Search result is empty.","I_ACL_DIALOG_TITLE":"Share: ${0}","I_REORDER_PAGE_DIALOG_TITLE":"Move: ${0}","I_SPACE_SELECTOR_IN_PERSONAL_SPACE":"Space selector action menu cannot be opened in personal space","I_COMMON_ACTION_HELP":"Help","I_AS_CHILD_OF_SELECTED_PAGE":"As child of the selected page","I_SPACE_MANAGER_DELETE_PAGE_TITLE":"Delete: ${0}","I_PUBLISH_PAGE_LABEL_TITLE":"Title:","I_EMBED_PREVIEW_FRAME":"Preview iframe","I_MODE_IS_SELECT":"is selected","MESSAGE_BOX_ICON_WARN":"warn","I_SPACE_MANAGER_NEW_SPACE":"Create Space","I_MODE_SELECTOR_GO_VIEW":"Go to View","I_CREATE_PAGE_IN_SPACE_DUPLICATE_PAGE":"Create a page by duplicating another page","I_ACL_ADD_TO_EDIT":"Add to Edit","I_FREEFORM_CONF_RESTORE_TITLE":"Restore page settings","I_TOOLBOX_CATEGORY_NAME":"Catalog","I_COLUMN_CONF_WIDGET_PROP_VMARGINS":"Vertical widget margins","I_COLUMN_CONF_RESTORE_DEFAULT_COLUMN_PROPERTIES":"Restore default column properties","I_SPACE_MANAGER_FAVORITES_QUICK_ACCESS":"Favorites Quick Access","LAYOUT_BORDER_STYLE_SOLID":"solid","I_CONTEXT_MENU_RENAME_WIDGET_PROMPT":"Rename: ${0}","E_PAGE_PROPERTIES_WRONG_PAGE_WIDTH":"The width must be between ${0} and ${1} pixels.","I_EMBED_ANON_MESSAGE":"To allow users to view this page without logging in, you must share this page with the anonymous user by selecting Share from the page menu, searching for the user anonymous, and then providing the anonymous user with view permission.","PAGE_MENU_PUBPAGE_CON_RETURN":"Cancel","I_AUTO_WIRING_NOTIFICATION_RECEIVING_FROM":"Receiving from ${0}","I_WIRING_SHOW_GRAPH":"Show Graph","I_WIRING_TEXT_AS":"as","I_PUBLISH_SPACE_LABEL_PERMISSION":"Permission:","MESSAGE_BOX_ICON_INFO":"info","CREATE_SPACE_NAME":"Space name:","I_SPACE_MANAGER_ACTION_SAVE_AS_TEMPLATE":"Save as a template","I_COLUMN_CONF_PAGE_EDGE":"Page Edge","I_TOOLBOX_NO_CHILD_IN_CATEGORY":"No widgets exist in this category. Widgets can be added from the ${0}","I_WIRING_ALIAS_MATCH":"Consider semantic types only for matching of sources and targets","I_ACL_CONFLICT_TITLE":"Permission Conflict","I_EMBED_PAGE_DESC":"To display this page here as well as on another Web page, copy (Ctrl-C) the markup below, and paste it (Ctrl-V) into the HTML markup of the Web page.","I_TABTHEME_SHARE":"Share","I_DELETEDLG_CONFIRMDELETE_PAGEONLY_DESC":"Delete this page only, and move its child pages to the parent of this page?","I_ACCOUNT_SETTINGS_CHANGE_AUTOWIRE_SETTINGS":"Change settings for automatic wiring","I_MOVE_THE_PAGE_TO_BE":"Move this page to be:","I_ACL_REASSIGN_NOT_CHANGE":"Do not change","EDIT_SPACE_OWNER":"Space owner:","I_AUTO_WIRING_INTERFACE_TIP_HIDDEN":"This hidden widget ( ${0} )  can be automatically wired with other widgets on the page. You can ${1} open the automatic wiring properties ${2} to modify this setting.","I_ACCOUNT_SETTINGS_WHEN_NOTI_DISABLED":"When disabled:","I_PAGE_PROPERTIES_ENABLE_AUTO_WIRING":"Enable automatic wiring","I_SPACE_SELECTOR_OPEN_ACTION_MENU":"Open Space Selector Action Menu","I_TOOLBOX_SAVE_PAGE_TOOLTIP":"Save this page","I_SKIN_EDIT_ICON_TITLE":"Open a menu of options","I_COLUMN_CONF_PAGE_BACKGROUND_IMAGE":"Background Image","I_PUBLISH_PAGE_LABEL_PERMISSION":"Permissions:","I_EMBED_PAGE_ON":"On","I_PAGE_PROPERTIES_PAGE_OWNER":"Page Owner","E_RENAME_NO_SCRIPT_ALLOWED":"No script code is allowed in widget name","E_SPACE_MANAGER_PAGE_NAME_REQUIRED":"Page name is required.","I_CHANGE_SPACE_OWNER_VIEW":"View permission on this space","I_COMMON_ACTION_LOGOUT_ALT":"Log out","E_CREATE_PAGE_IN_SPACE_DESCRIPTION_REQUIRED":"Page description is required.","I_PUBLISH_PAGE_LABEL_SHARE_METHOD_URL":"Publish page as URL","I_PAGE_PROPERTIES_HINT_FOR_FIXED_MODE":"Page width:","I_EMBED_PAGE_OFF":"Off","I_WIRING_OTHER_EVENTS_SEND":"Select other content to send","I_SPACE_MANAGER_LOADING":"Loading...","I_SYSTEM_MESSAGE_MSG_CODE":"Message Code: ${0}","EDIT_SPACE_ICON_ALT":"Space icon number: ${0}","I_CREATE_PAGE_IN_SPACE_PAGE_NAME":"Page name:","I_WIRING_DONE":"Done","I_WIRING_WIDGETEVENTS_SEND":"Select an action","CREATE_SPACE_MAKE_FAVORITE":"Make this space a favorite space","I_AUTO_WIRING_NOTIFICATION_TITLE_FOR_WIDGET":"Auto-Wiring Notifications for the hidden widget: ${0}","I_COLUMN_CONF_INDIVIDUALCOL_FOR":"Settings for an individual column:","I_EMBED_PAGE_HEIGHT":"Height:","EDIT_SPACE_ICON_ALT_IMAGE1":"Application","EDIT_SPACE_ICON_ALT_IMAGE2":"Alerts","EDIT_SPACE_ICON_ALT_IMAGE3":"Measurements","I_PUBLISH_WARNING":"The last saved version of this page will be published to the catalog. Do you want to save your changes before publishing this page?","EDIT_SPACE_ICON_ALT_IMAGE4":"Service","I_SEARCH_TITLE":"Search","EDIT_SPACE_ICON_ALT_IMAGE5":"Business","I_ACL_REMOVE":"Remove Selected from List","EDIT_SPACE_ICON_ALT_IMAGE6":"Company","I_PUBLISH_SPACE_LABEL_TITLE":"Title:","EDIT_SPACE_ICON_ALT_IMAGE7":"Calculator","I_PUBLISH_WITHOUT_SAVING":"Do not save","EDIT_SPACE_ICON_ALT_IMAGE8":"Car","I_FREEFORM_CONF_PAGE_BG_IMAGE_PROPERTIES":"Image Properties","I_MORE_PAGE_TITLE":"More Pages","EDIT_SPACE_ICON_ALT_IMAGE9":"Clock","I_MAIN_CONTENT":"Skip to main content","I_WIRING_SETTINGS_DIALOG_NAME":"Settings","I_FREEFORM_CONF_RESTORE_DEFAULT_WIDGET_PROPERTIES":"Restore default widget properties","E_SPACE_MANAGER_PAGE_DESCRIPTION_REQUIRED":"Page description is required.","PAGE_MENU_EMBPAGE_CON_RETURN":"Cancel","CREATE_SPACE_CHOOSE_THEME":"Choose a theme for this space:","I_ACL_INFORMATION_1":"These people or groups currently have permissions:","I_COLUMN_CONF_WIDGET_APPLY_SKIN":"Apply to future and existing widgets using default skin","I_ACL_INFORMATION_2":"What would you like to do:","I_SPACE_MANAGER_DELETE_PAGE_PROMPT":"Would you like to delete the page \"${0}\"?","I_PAGE_ACTION_MENU":"Page Action Menu","I_EMBED_WIDGET_DESC_WITHEDITMODE":"To add this widget to a Web page, open the widget in edit mode, copy (Ctrl-C) the markup below, and then paste it (Ctrl-V) into the HTML markup of the Web page.","I_EMBED_PAGE_AUTOWIDTH":"Auto width","I_COMMON_SAVE":"Save","I_CONTEXT_MENU_RENAME_WIDGET":"Rename Widget","CREATE_SPACE_FAVORITE_LIMIT":"You have reached the limit of ${0} favorites. You must remove a favorite before adding another.","I_COLUMN_CONF_MOVEWIDGET_SELECTED_COLUMN_INFO_1":"Column ${0} is selected.","I_SPACE_MANAGE_SPACES":"Space Manager","I_COMMON_ADD":"ADD","I_CONTEXT_MENU_CUSTOMIZE_TITLE_AND_ICON":"Rename","I_COLUMN_DRAG_HANDLER":"Drag or use left or right arrow keys to resize ${0} or ${1}","I_COMMON_ACTION_SETTINGS":"Settings","I_COLUMN_CONF_PAGE_BG_IMAGE_PROPERTIES":"Image Properties","I_EDIT_PROPERTIES_SETTINGS":"Settings","I_CHANGE_PAGE_OWNER_NOTE":"If you select to keep the same permissions as the parent page or space, this page may disappear from your view if you do not have view permissions for that parent page or space. \n If you select to have view permissions only, you will not be able to edit or modify permissions for the page, unless you are the owner of the space that contains the page.","I_CONTEXT_MENU_MODE":"Widget Actions","I_SPACE_MANAGER_IMPORT_SPACE":"Import Space","E_PUBLISH_PAGE_PUBLISH_FAILED_MSG_0":"An error occurred when publishing this page or space to the catalog. Ask your system administrator to check the log file on the server for configuration errors.","I_COLUMN_CONF_COLUMN_NUMBER":"Number of columns","I_COLUMN_CONF_WIDGET_PROP_HMARGINS":"Horizontal widget margins","I_SYSTEM_MESSAGE_CLEAR":"Clear","I_WIRING_TITLE_RECEIVE":"Receive","I_SPACE_SELECTOR_ACTION_MENU_BUTTON":"Space Selector Action Menu Button","I_FREEFORM_CONF_PAGE_BG_IMAGE_PRO_REPEATB":"Repeat Both","I_EMBED_PAGE_WIDTH_MODE_PIXEL_TITLE":"Use width pixel","I_COLUMN_CONF_PAGE_MARGIN":"Page Margin","I_SPACE_MANAGER_NO_DESCRIPTION":"No description","I_WIRING_NO_SEND_EVENTS":"No action is available to send content.","I_FREEFORM_LAYOUT_NAME":"FreeForm Layout","I_COLUMN_CONF_PAGEBGIMAGEURL_INPUT":"Type the URL of the background image","I_COLUMN_CONF_COLUMN_PROPERTIES":"Column Properties","I_FREEFORM_CONF_LESS":"Fewer Options...","I_WIRING_TEXT_USING":"using","I_ACL_INFORMATION_HAS":"${0} ${2} has ${3} ${1}","I_ABOVE_THE_SELECTED_PAGE":"Above the selected page","I_SPACE_MANAGER_NO_SPACES_FOUND":"No spaces found.","I_CONTEXT_MENU_WIDGET_INPUT_INVALIDMESSAGE":"Numbers only.","I_FREEFORM_CONF_PAGE_BG_IMAGE_PROP_CENTER":"Center","I_CONTEXT_MENU_COLUMNWIDGET_COLUMN_LABEL":"Column:","I_CONTEXT_MENU_COLUMNWIDGET_COLUMN_PANEBOX_TITLE":"Column ${0}","I_PAGE_SOURCE_EDIT_MODE":"Edit Mode","I_CHANGE_SPACE_OWNER_NONE":"No permission on this space","E_CREATE_PAGE_IN_SPACE_NAME_REQUIRED":"Page name is required.","I_WIRING_WIDGETS_SEND":"Select a widget to receive content","I_FREEFORM_CONF_PAGE_BORDER_COLOR":"Page Border Color","I_PUBLISH_PAGE_LABEL_SHARE_METHOD_UPLOAD":"Publish page definition and artifacts","E_PUBLISH_PAGE_REQUIRED_FIELDS_EMPTY_0":"Title, Description, and Version are required fields","I_PAGE_SAVE_SUGGEST":"What would you like to do:","I_EMBED_PAGE_WIDTH":"Width:","I_EMBED_PAGE_UNIT":"px","I_EDIT_PROPERTIE_ACCOUNT":"My Account Settings","THEMES_DEFAULT_COLUMN_THEME":"Default Column Theme","I_PAGE_PROPERTIES_DISABLE_AUTO_WIRING":"Disable automatic wiring","LAYOUT_BORDER_STYLE_DOUBLE":"double","I_SPACE_CREATE_NEW_SPACE":"Create a New Space...","I_SPACE_MANAGER_NO_TITLE":"Untitled","I_COLUMN_CONF_PAGE_BG_URL_REQUIRED":"URL Required","I_ACCOUNT_SETTINGS_LOGIN_HOME_SPACE":"My home space.","E_PUBLISH_SPACE_REQUIRED_FIELDS_EMPTY_0":"Title, Description, and Version are required fields","I_WIRING_EVENT_TITLE_RECEIVE":"${0} using ${1}: ${2}","I_CONTEXT_MENU_MOVE_WIDGET_PROMPT":"Move: ${0}","I_DELETECONFIRM_SENDCONTENT":"Sends content to:","I_ACCOUNT_SETTINGS_NOTIFY_ME":"Notify me when widgets on my current mashup page support the automatic wiring feature. Notification includes a list of widgets that can be automatically wired.","I_SPACE_PERSONAL_SPACE_PAGE_TITLE":"My Page","I_TABTHEME_SHARE_ALT":"Share actions","I_CHANGE_PAGE_OWNER_OWNERSHIP_TYPE":"After transferring ownership, I will have:","I_WIRING_EVENTS_SEND":"Select content to send","I_TOOLBOX_ADD_WIDGET_TOOLTIP":"Open the catalog in a new browser","I_SYSTEM_MODE_TITLE":"${1} ${0}","I_ACL_ADD_TO_PERSONALIZE":"Add to Personalize","EDIT_NO_SPACE_OWNER":"No Space Owner","I_TOOLBOX_NVA_TOOLTIP":"View hidden widgets","I_COMMON_DELETE":"Delete","I_COLUMN_CONF_ICON_HOVERTEXT":"Configure the page layout","I_FREEFORM_CONF_PAGE_BG_IMAGE_PROP_REPEATH":"Repeat Horizontal","I_COMMON_ACTION_SETTINGS_ALT":"Open Account Settings","I_CONTEXT_MENU_WIDGET_INPUT_TITLE1":"Enter the widget's left coordinate.","I_CONTEXT_MENU_WIDGET_INPUT_TITLE2":"Enter the widget's top coordinate.","I_TOOLBOX_NVA_DND_TOOLTIP":"Hide widget","I_ACCOUNT_SETTINGS_NOTIFICATIONS":"Automatic Wiring Notifications","I_MORE_PAGE_FROM_WHO":"${1} from ${0}","I_FREEFORM_CONF_PAGE_BG_IMAGE_PROP_REPEATV":"Repeat Vertical","I_WIRING_TITLE_SEND":"Send","I_CONTEXT_MENU_WIDGET_LEFT_LABEL":"Left coordinate","COPY_SPACE_COPY_OF":"Copy of ${0}","I_DELETECONFIRM_RECCONTENT":"Receives content from:","I_MODE_SELECTOR_GO_SHARE":"View More Pages","I_SPACE_MANAGER_DELETE_SPACE_PROMPT":"Would you like to delete the space \"${0}\" and all of its pages?","I_FREEFORM_CONF_PAGE_PROPERTIES":"Page Properties","I_FREEFORM_CONF_PAGE_EDGE":"Page Edge","I_SEARCH_USER":"Search for User","I_BROWSER_TITLE":"IBM Mashup Center","I_MORE_PAGE_DESC":"Page authors have shared these pages with you. To accept a page into your navigation, click Add.","I_AUTO_WIRING_NOTIFICATION_OPEN_WIRE_INTERFACE":"Open the wiring interface","I_WIRING_PROMPTER_STEP_1":"Step 1","I_PAGE_SOURCE_TITLE":"Page Source","I_WIRING_PROMPTER_STEP_2":"Step 2","THEMES_TAB_THEME":"Tab Theme","I_WIRING_PROMPTER_STEP_3":"Step 3","I_DELETECONFIRM_KEEPORDELETE":"Do you want to keep or delete the widget","I_EMBED_PAGE_UPDATEMARKUP":"Refresh Markup","I_PAGE_PROPERTIES_TITLE":"Properties for ${0}","I_SPACE_MANAGER_FILTER_SPACES_TITLE":"input condition here to filter spaces","EDIT_SPACE_CHANGEOWNER":"Change","I_FREEFORM_CONF_ICON_HOVERTEXT":"Click to configure the page layout","I_COLUMN_CONF_PRO_TITLE":"Properties for Column Layout","I_COLUMN_CONF_LESS":"Fewer Options...","I_PAGE_PROPERTIES_GENERAL_PROPERTIES":"General Properties","CHANGE_SPACE_OWNER_CAPTION":"Change Owner","I_HTMLFRAGMENT_CANTLOAD_URL":"Cannot load Web content from the URL you specified.","I_BELOW_THE_SELECTED_PAGE":"Below the selected page","I_EMBED_WIDGET_DESC_NOEDITMODE":"To add this widget to a Web page, copy (Ctrl-C) the markup below, and then paste it (Ctrl-V) into the HTML markup of the Web page.","I_FREEFORM_CONF_PAGE_BORDER":"Page Border","I_HTMLFRAGMENT_ERROR_INVALID_URL":"The URL you specified is invalid. Are you sure you want to use it?","I_EMBED_DIALOG_TITLE":"Embedding","I_PAGE_PROPERTIES_THEME_MSG":"This action will save the current state of your page with the selected theme.","PAGE_MENU_EMBPAGE_CON_TEXT1":"The last saved version of your page will display in the embedded page.","I_PUBLISH_PAGE_LABEL_PERMISSION_PUBLIC":"Public (Page displays in the catalog for all users)","PAGE_MENU_EMBPAGE_CON_TEXT2":"Do you want to save your changes?","CHANGE_SPACE_OWNERNAME":"Owner name:","I_COMMON_ACTION_LOGOUT":"Log out","I_COLUMN_RESIZER":"Resize bar","E_PUBLISH_PAGE_PUBLISH_FAILED_2":"Failed to publish page. ${0} Server response: ${1}","I_CHANGE_PAGE_OWNER_EDIT":"Edit permissions on this page","I_IMPORT_WIDGET_PROMPT":"Select a file to import:","I_WIRING_SWITCH_TO_TARGET_PAGE":"Switch page","THEMES_DEFAULT_THEME":"Default Theme","I_PAGE_PROPERTIES_PAGE_WIDTH_MODE_FLUID":"Fluid width","I_CATALOG_PANE_TITLE":"Catalog","I_AUTO_WIRING_INTERFACE_TIP":"This widget ( ${0} )  can be automatically wired with other widgets on the page. You can ${1} open the automatic wiring properties ${2} to modify this setting.","I_WIRING_TEXT_FROM":"from","I_EMBED_PAGE_SCROLLS":"Scroll bars:","I_WIRINGGRAPH_BOTTOM_MESSAGE_AFTER":"are displayed.","I_ACL_ADD_TO_VIEW":"Add to View","I_FREEFORM_CONF_WIDGET_DEFAULT_SKIN":"Default skin","I_SPACE_MANAGER_SAVE_SPACE_AS_TEMPLATE_FAILED":"Failed to save space \"${0}\" as a template.","I_CONTEXT_MENU_WIDGET_WIDTH":"Widget width:","I_CONTEXT_MENU_MODE_PRINT":"Print","I_CONTEXT_MENU_SKIN":"Select Skin","I_WIRING_WIDGETS_RECEIVE":"Select a widget to send content","I_FREEFORM_CONF_PAGE_BACKGROUND_IMAGE":"Background Image","I_ACCOUNT_SETTINGS_DEFAULT_INFO":"Automatic wiring is disabled by default. To enable it, go to the Advanced section of the Page Settings dialog box.","I_SPACE_MANAGER_PAGES_NUM_COUNTING":"Counting...","I_PAGE_PROPERTIES_PAGE_TITLE":"Page name:","THEMES_TAB_COLUMN_THEME":"Tab Column Theme","I_CONTEXT_MENU_HIDE":"Hide","E_PUBLISH_SPACE_PUBLISH_FAILED_2":"Failed to publish space. ${0} Server response: ${1}","I_ACL_SHARESPACE_DIALOG_TITLE":"Share: ${0}","PAGE_MENU_EMBPAGE_CON_SAP":"Save","I_COLUMN_CONF_MOVEWIDGET_INFO":"To move this widget, select the column and the position within the column.","I_COLUMN_CONF_PAGE_BACKGROUND_COLOR":"Background color:","I_MODE_SELECTOR_CREATE_FEEDMASHUP":"Create Feed Mashup ...","COPY_SPACE_DESC":"Space description:"};dojo.provide("dojo.cldr.nls.number");dojo.cldr.nls.number._built=true;dojo.provide("dojo.cldr.nls.number.en");dojo.cldr.nls.number.en={"group":",","percentSign":"%","exponential":"E","percentFormat":"#,##0%","scientificFormat":"#E0","list":";","infinity":"∞","patternDigit":"#","minusSign":"-","decimal":".","nan":"NaN","nativeZeroDigit":"0","perMille":"‰","decimalFormat":"#,##0.###","currencyFormat":"¤#,##0.00;(¤#,##0.00)","plusSign":"+","currencySpacing-afterCurrency-currencyMatch":"[:letter:]","currencySpacing-beforeCurrency-surroundingMatch":"[:digit:]","currencySpacing-afterCurrency-insertBetween":" ","currencySpacing-afterCurrency-surroundingMatch":"[:digit:]","currencySpacing-beforeCurrency-currencyMatch":"[:letter:]","currencySpacing-beforeCurrency-insertBetween":" "};dojo.provide("dijit.nls.loading");dijit.nls.loading._built=true;dojo.provide("dijit.nls.loading.en");dijit.nls.loading.en={"loadingState":"Loading...","errorState":"Sorry, an error occurred"};dojo.provide("dijit.nls.common");dijit.nls.common._built=true;dojo.provide("dijit.nls.common.en");dijit.nls.common.en={"buttonOk":"OK","buttonCancel":"Cancel","buttonSave":"Save","itemClose":"Close"};dojo.provide("com.ibm.bundles.nls.Theme");com.ibm.bundles.nls.Theme._built=true;dojo.provide("com.ibm.bundles.nls.Theme.en");com.ibm.bundles.nls.Theme.en={"page_goTo_csa":"Switch to Client-Side Mode","theme_hiddenContentDesc":"Place content into the area below to prevent it from displaying when the page is viewed.","edit_wires_title":"Edit Wires","page_force_ssa_link":"Use server side mode.","layout_renderingError":"An error occurred rendering the assigned layout.","tagAndRate_description":"Tagging and Rating","rate_title":"Rate","theme_edit_wiring":"Edit Wiring","theme_maximize":"Maximize","theme_go_to_edit":"Go to Edit mode","dnd_not_instantiated":"Drag and drop could not be instantiated","theme_config_control":"Configure","theme_wire_widget":"Wire Widget","dnd_disabled":"Drag and drop is disabled","statusbar_messages_available":"messages are available for review","page_title":"Page","move_left":"Move Left","layout_error_contactAdmin":"If the problem persists, contact your administrator.","browseTags_description":"Browse Tags","theme_actions_menu":"Actions Button","theme_close_shelf_help":"Button will close customize shelf","editPageLayout_description":"Edit Page Layout","theme_sign_up":"Sign Up","page_goTo_ssa":"Switch to Server-Side Mode","theme_restore":"Restore","statusbar_items_available":"items are available for review","layout_missingError":"The assigned layout does not exist.","statusbar_show_details":"Show Details","a11y_skip_portlet":"Skip to next portlet","dnd_copy_failed":"An error occurred copying the resource.","theme_move_page":"Move Page","dnd_locked_container":"Cannot move a resource to a locked container.","advanced_description":"Advanced","statusbar_warning":"Warning","context_portlet_menu_renderingError":"An error occurred rendering the portlet menu.","editPage_description":"Edit Page","removePage_title":"Remove Page","theme_remove_page":"Are you sure you want to remove this page and all of its children?","move_down":"Move Down","create_child_page_link":"Click here to create a child page.","layout_error_explanation":"This could be a result of an error during the page creation process, manual changes made to the page layout, or the actions of an Administrator.","theme_global_page_closing_non_active":"You are trying to close a global page that is not currently open.","theme_hide_portlet":"Hide Portlet","sharePage_title":"Share Page","theme_more_pages":"More Pages","theme_display_shelf_help":"Button will display customize shelf below","theme_refresh_page":"Refresh Page","io_insufficient_permissionsError":"There are insufficient permissions to perform the requested operation.","editPageLayout_title":"Edit Page Layout","a11y_skip_widget":"Skip to next widget","move_up":"Move Up","theme_add_pages_shared":"Add Pages Shared with Me","theme_help":"Help","theme_login":"Log In","theme_global_page_active":"The global page is currently active. Close the global page before continuing.","theme_hiddenControl":"hidden","page_description":"Page","theme_refresh_description":"Refresh the page to show the most recent information.","page_save_operation_not_complete":"A save operation to the server has not yet completed.","theme_remove_page_name":"Are you sure you want to remove the page ${0} and all of its children?","statusbar_multiple":"Multiple Messages","sharing_description":"Sharing","statusbar_hide_details":"Hide Details","tagAndRate_title":"Tagging and Rating","sharing_title":"Sharing","page_initError":"An error occurred initializing the page.","theme_menu":"Menu","assignPagePermissions_description":"Assign Page Permissions","statusbar_clear":"Clear","theme_more_actions":"More Actions","currently_selected":"currently selected","theme_edit_settings_portal":"Edit Shared Settings","assignPagePermissions_title":"Assign Page Permissions","statusbar_error":"Error","theme_global_page_cannot_close":"The global page cannot be closed.","browseTags_title":"Browse Tags","ally_display_actions_menu":"Display actions menu","theme_delete":"Delete","theme_confirm_leave_edit":"Your changes have not been saved. Are you sure you want to leave Edit mode?","dnd_move_failed":"An error occurred moving the resource.","deletePage_title":"Delete Page","theme_share":"Share","movePage_description":"Move Page","aria_edit_mode":"Going to Edit mode. Options will be displayed below in the toolbar.","theme_logout":"Log Out","theme_customize":"Customize","deletePage_description":"Delete Page","theme_edit_my_profile":"Edit My Profile","edit_wires_description":"Add, modify, or remove wires.","theme_go_to_view":"Go to View mode","private_public_modelError":"Cannot place a public resource under a private resource.","statusbar_info":"Information","theme_edit_settings":"Edit Shared Settings","theme_view_wiring":"View Wiring Graph","aria_view_mode":"Going to view mode.","theme_global_page_already_opened":"The global page is already opened.","edit_description":"Edit","theme_delete_page":"Are you sure you want to delete this page and all of its children?","theme_actions":"Actions","layout_error_mismatch":"The assigned layout does not match the actual page layout.","removePage_description":"Remove Page","theme_share_this_page":"Share this Page","a11y_skip_region":"Skip to next region","context_page_menu_renderingError":"An error occurred rendering the page menu.","theme_delete_page_name":"Are you sure you want to delete the page ${0} and all of its children?","addSharedPages_description":"Add Shared Pages","theme_impersonation":"Impersonate","theme_hide":"Hide","advanced_title":"Advanced","layout_error_symptoms":"Until this problem is fixed, attempts to customize this page by adding content or changing the layout may not work properly.","theme_hide_widget":"Hide Widget","editPage_title":"Edit Page","io_serverError":"Internal server error.","theme_minimize":"Minimize","no_content_node":"This page does not support content.","sharePage_description":"Share Page","statusbar_status_error":"A runtime error occurred","theme_menu_cannot_render":"Menu cannot be rendered.","layout_error_heading":"Error with the Page Layout","layout_error_tryRecreate":"Try deleting the page and creating it again.","tag_title":"Tag","a11y_display_menu":"Display menu","theme_personalize_control":"Personalize","io_missingResource":"The requested resource does not exist.","move_right":"Move Right","theme_websphere_portal":"IBM WebSphere Portal","tag_description":"Tag","theme_back":"Back","theme_resize":"Resize","page_force_ssa_msg":"This page contains one or more portlets that do not support client-side mode.","theme_share_page":"Share Page","theme_refresh":"Refresh","rate_description":"Rate","editPageProperties_title":"Edit Page Properties","theme_global_page_not_opened":"The global page is not open.","editPageProperties_description":"Edit Page Properties","statusbar_print":"Print","newChildPage_title":"New Child Page","io_networkError":"An error occurred communicating with the server.","addSharedPages_title":"Add Shared Pages","a11y_skip_content":"Skip to main content link using access key S.","newChildPage_description":"New Child Page","a11y_display_user_menu":"Display user menu","theme_edit_control":"Edit","movePage_title":"Move Page","edit_title":"Edit"};dojo.provide("com.ibm.bundles.nls.Shelf");com.ibm.bundles.nls.Shelf._built=true;dojo.provide("com.ibm.bundles.nls.Shelf.en");com.ibm.bundles.nls.Shelf.en={"change_style_purpleStyle":"Purple","change_style_black":"Black","change_style_visionary":"Visionary","new_generic_add":"Add ${0} to page","shelf_searchPortlets":"Search Portlets","change_layout_1Row2ColDesc":"This layout has two rows. The second row contains two unequal columns.","shelf_previous":"Previous","shelf_badDatastoreError":"${0} cannot be loaded because the datastore for this content source is undefined.","change_style_lightGreyStyle":"Light Grey","shelf_saveChanges":"Save","add_content_missingRendererError":"Could not find the specified renderer.","new_feed_url":"URL","shelf_toolsCategory":"Tools","change_style_browseStyles":"Browse Styles","change_layout_templateSyncError":"Error with layout template sync.","new_wcm_nameInvalid":"Name must contain at least one alphanumeric (a-zA-Z0-9) character. Try a different name.","new_wcm_wikiDesc":"Quickly create and edit content in-line with a wiki. Instantly publish your work with the click of a button.","menu_unselected_text":"press enter to browse this category","change_layout_launchLabel":"Change Layout","new_wcm_wikiDescription":"Quickly create and edit content in-line with a wiki. Instantly publish your work with the click of a button.","add_content_label":"Content","new_blog_copyWcmLibrary":"Your blog is being created...","new_creatableCategory":"Creatable","shelf_searchCreate":"Search Create","shelf_searchAll":"Search All","new_wcm_addBlog":"Add blog to page","add_content_feedspace":"Feedspace","new_feed_enterUrl":"Specify a valid URL.","shelf_saveAndExit":"Save & Exit","shelf_session_timeout":"Your session has timed out.  Log in to continue.","change_style_restoreStyle":"Restore previous style","change_style_metal":"Metal","change_layout_templateSyncLong":"Update the layout of this page by syncing with the template from which it was based.  Note that personalizations made to this page will be lost.","change_layout_label":"Layouts","detail_dialog_instruction_text":"press enter to see details dialog","change_style_carbon":"Carbon","change_style_blueStyle":"Blue Lights","shelf_customize":"Customize","shelf_searchNew":"Search New","change_layout_col1Desc":"This layout has one column taking up 100% of the available space.","change_layout_col2LeftDesc":"This layout has one side bar on the right with the main content on the left.","change_layout_2RowDesc":"This layout has two rows.","change_style_white":"White","shelf_menu":"Menu","add_content_submit":"Submit","shelf_unsavedChanges":"The customization shelf has unsaved changes.","change_style_mojo":"Mojo","add_content_legacyError2":"Content cannot be added to pages with legacy layouts.  Assign a layout template before continuing.","shelf_submitSearch":"submit search","new_portletsCategoryLabel":"Portlets","shelf_all":"All","shelf_searchCollabCategory":"Search Collaboration","menu_selected_text":"currently selected category","change_style_red":"Red","shelf_adminCategory":"Administration","mashup_hub_feeds_label":"Feeds","add_content_tags":"tags: ${0}","add_content_rating":"rating: ${0}","add_content_all":"All","new_wcm_feedDescription":"Provide a feed URL and a feed reader portlet configured to that feed will be added to the page.","change_style_greyStyle":"Grey Stripes","add_content_addToPage":"Add to page","new_feed_feedDesc":"Provide a feed URL and a feed reader portlet configured to that feed will be added to the page.","change_layout_col1":"1 column","add_content_maximizedError2":"Content cannot be added to the page while there is an item maximized.","shelf_unspecified":"Unspecified","change_style_green":"Green","change_style_greenStyle":"Green Waves","mashup_hub_iwidgets_label":"Widgets - From Catalog","change_style_modern":"Modern","shelf_hideHiddenContainers":"Hide content","generic_browse":"Browse ${0}","shelf_saving":"Your changes are being saved...","change_style_defaultStyle":"Default","add_content_addSearch":"Add search results to page","change_layout_col3CenterDesc":"This layout has two side bars with the main content between them.","add_content_selectRenderer":"Select how to display the content","add_content_addContentError":"Error adding content to the page.","change_style_orangeStyle":"Orange","add_content_lastMod":"Last modified: ${0}","add_content_launchLabel":"Add Content","change_layout_customDesc":"This layout is a customized T-shaped layout.","add_content_legacyError":"Content cannot be added to pages with legacy layouts.  Assign a layout, and save your changes to use this feature.","new_wcm_blogDescription":"Add a blog to a page to collaborate with your team on a single topic. To collaborate with others on multiple topics, click Cancel > Blog Library.","new_wcm_addBlogLibrary":"Add blog library to page","add_content_noPreview":"This item does not support preview","change_layout_col3EqualDesc":"This layout has three columns each taking up 33% of the width.","shelf_searchToolsCategory":"Search Tools","change_style_contemporary":"Contemporary","add_content_portlets":"Portlets","shelf_searchFeeds":"Search Feeds","add_content_maximizedError":"Content cannot be added to the page while there is a portlet in maximized mode.","add_content_rss":"RSS","new_wcm_wiki":"Wiki","shelf_loading":"Loading...","change_layout_templateSyncConfirm":"Are you sure you want to sync the layout for this page?  All personalizations will be lost.","change_layout_col3Center":"3 column center","change_layout_col3Equal":"3 column equal","new_wcm_name":"Name","add_content_feedReader":"Feed Reader","change_layout_maximizedError2":"The layout cannot be changed while there is an item maximized.","change_layout_col2EqualDesc":"This layout has two columns each taking up 50% of the width.","change_layout_2Row":"2 row","change_layout_1Row3Col":"1 row 3 column equal","new_wcm_createGeneric":"Create ${0}","shelf_hiddenContainers":"Hidden Content","add_content_cancel":"Cancel","add_content_details":"Details","add_content_add":"Add","new_blog_library_copyWcmLibrary":"Your blog library is being created...","new_createCategory":"Create","shelf_closeDialog":"Close dialog","change_layout_restoreLayout":"Restore previous layout","shelf_serverError":"Internal server error.","new_wiki_copyWcmLibrary":"Your wiki is being created...","shelf_feedError":"${0} cannot be loaded. Check the internet connection and proxy settings.","change_layout_col2Right":"2 column right","mashup_hub_category_label":"Mashups","change_layout_custom":"Custom Layout","new_wcm_feed":"Feed","change_style_gold":"Gold","menu_back":"back","change_style_lightGreenStyle":"Light Green","shelf_untitled":"Untitled","new_feed_addFeed":"Add feed to page","new_categoryLabel":"New","change_style_dark":"Dark","new_wcm_addWiki":"Add wiki to page","new_wcm_wcmNameTaken":"This name is already being used. Try a different name.","shelf_searchAdminCategory":"Search Administration","shelf_search":"Search ${0}","add_content_browseContent":"Browse Content","change_layout_col2Left":"2 column left","change_layout_1Row3ColDesc":"This layout has two rows. The second row contains three equal columns.","add_content_restrictedContentError":"${0} is not allowed on this page","new_wcm_wcmNotCopied":"A WCM library is not finished being copied.","new_wcm_blogLibraryDescription":"Add a blog library to a page to collaborate with your team on multiple topics in a centralized view. To collaborate with your team on a single topic, click Cancel > Blog.","shelf_jumpTo":"Jump to page","new_feed_title":"Title","shelf_showHiddenContainers":"Show hidden content","add_content_noRating":"no rating","change_style_twilight":"Twilight","change_layout_1Row2Col":"1 row 2 column unequal","change_style_launchLabel":"Change Style","add_content_notLoaded":"This item has not yet loaded.","change_layout_col2Equal":"2 column equal","shelf_bundleUndefined":"The resource bundle ${0} could not be found","change_style_pinkStyle":"Pink","change_style_natural":"Natural","shelf_close":"close shelf","shelf_next":"Next","change_style_missingStyleError":"The specified style does not exist","new_wcm_blogDesc":"Add a blog to a page to collaborate with your team on a single topic. To collaborate with others on multiple topics, click Cancel > Blog Library.","new_wcm_blogLibrary":"Blog Library","add_content_ok":"OK","add_content_closeDialog":"Close this dialog","change_style_label":"Styles","new_feed_enterTitle":"Specify a title.","add_content_untitled":"Untitled","change_layout_col2RightDesc":"This layout has one side bar on the left with the main content on the right.","add_content_close":"close","new_wcm_createWcm":"Create WCM Library","shelf_configError":"Error reading configuration file or processing its content.","new_wcm_blogLibraryDesc":"Add a blog library to a page to collaborate with your team on multiple topics in a centralized view. To collaborate with your team on a single topic, click Cancel > Blog.","change_layout_browseLayouts":"Browse Layouts","new_wcm_blog":"Blog","shelf_page":"Page ${0} of ${1}","new_portalCategory":"Portal","change_style_light":"Light","change_layout_templateSync":"Sync assigned layout","change_style_blue":"Blue","shelf_bundleKeyUndefined":"The key ${0} was undefined in the resource bundle ${1}","change_layout_maximizedError":"The layout cannot be changed while there is a portlet in maximized mode.","selection_instructions":"press enter to select","new_wcm_wcmNameInvalid":"Names may contain only alphanumeric (a-zA-Z0-9) characters, spaces, or any of the following characters: \" $ - _ . ! ( ) ,.","shelf_collabCategory":"Collaboration","shelf_noResults":"No results"};dojo.provide("com.ibm.bundles.nls.NavWidget");com.ibm.bundles.nls.NavWidget._built=true;dojo.provide("com.ibm.bundles.nls.NavWidget.en");com.ibm.bundles.nls.NavWidget.en={"breadcrumb_new_page_label":"New Page","breadcrumb_intro":"You are in:","nav_new_page_nested_label":"Create a New Page","nav_invalid_drop_msg":"Make sure you have sufficient permissions to rearrange pages.","nav_new_page_label":"New Page","nav_renderingError":"An error occurred when rendering the navigation.","nav_new_page_title":"Page Title","nav_new_page_default_value":"Untitled","nav_invalid_drop_error":"This move operation is not allowed.","nav_new_page_empty_nested_label":"Create a child page","nav_new_page_invalid_message":"Title cannot be blank","nav_new_tab_label":"New Tab","nav_createPageError":"An error occurred creating the page.","nav_new_page_prompt_message":"Title cannot be blank"};dojo.provide("com.ibm.bundles.nls.PageCreatorDialog");com.ibm.bundles.nls.PageCreatorDialog._built=true;dojo.provide("com.ibm.bundles.nls.PageCreatorDialog.en");com.ibm.bundles.nls.PageCreatorDialog.en={"wcm_content_scope_label":"Content Scope:","page_dialog_go":"Go","hide_details":"Hide Details","page_dialog_fewer_options":"Fewer Options","cancel":"Cancel","remember_defaults":"Remember as Default Selection","display_details":"Display details view","page_dialog_page_name":"Page name:","link_internal":"Link to Portal Page","aggregation_mode":"Aggregation Rendering Mode","page_dialog_more_options":"More Options","page_dialog_share_desc":"Share it with others.","public_tags":"Public tags","wcm_use_page_acl":"Use the access control settings of this page for Web Content","page_dialog_no_templates_found":"No page templates found.","select":"Select","search_templates_label":"Search Templates:","all":"All","all_templates":"All Templates","page_dialog_page_type":"Page type:","page_dialog_properties_desc":"Edit properties for more advanced properties.","page_dialog_display_actions_option":"Do not show this again","created_by":"Created by ${0}","sort_by":"Sort by:","page_dialog_make_private":"Make this my private page","done":"Done","page_dialog_error_creating_page":"Error creating page.","wcm_site_section_label":"Site Section:","display_summary":"Display summary view","page_dialog_customize_page":"Customize Page","tags":"Tags:","page_dialog_create_link":"Create Link","page":"Page","page_dialog_view_properties_now":"View properties now","next":"Next","template_select":"Select Template","page_template":"Page From Template","page_dialog_no_template":"No template","show_details":"Show Details","default_text":"Default","aggregation_mode_csa":"Client-Side Aggregation Rendering","page_blank":"Blank Page","page_dialog_link_name":"Link Name:","most_recommendations":"Most Recommendations","jump_to_page_of":"Jump to page ${0} of ${1}","page_dialog_find_template":"Find a template:","page_dialog_close":"Close","page_dialog_select_template":"Select a template","page_dialog_page_template":"Page Template","select_page_label":"Select page:","page_dialog_type_template":"Choose a template","page_dialog_link_type":"Link Name:","page_dialog_type_blank":"Blank","link_external":"Link to URL","display_label":"Display:","page_dialog_share_now":"Share now","page_dialog_customize_desc":"Add content, or change the style and layout.","page_dialog_share_page":"Share Page","recent_templates":"Recent Templates","page_dialog_blank_page_intro":"Your page is blank. You can:","wcm_create_wcm_page":"Create a Web Content Page","url":"URL:","list":"list","search":"Search","template_dialog_title":"Select a Template","create_new_label":"Create New:","page_dialog_page_being_created":"Your page is being created...","page_upload":"Upload Page","create":"Create","title":"Title","template_label":"Template:","page_dialog_create_page":"Create Page","cloud":"cloud","page_dialog_label_name":"Label Name:","label":"Label","page_dialog_create_label":"Create Label","templates":"Templates","link":"Link","show_label":"Show:","page_dialog_friendly_url_name":"Friendly URL Name:","previous":"Previous","page_dialog_edit_page_properties":"Edit Page Properties","page_dialog_customize_now":"Customize now","page_dialog_page_template_label":"The new page will be based on the following page template:","view_as":"View as","used_in_section_templates":"Templates used by Pages in this section","aggregation_mode_ssa":"Server-Side Aggregation Rendering"};dojo.provide("com.ibm.bundles.nls.properties");com.ibm.bundles.nls.properties._built=true;dojo.provide("com.ibm.bundles.nls.properties.en");com.ibm.bundles.nls.properties.en={"page_dialog_no_template":"No template","page_dialog_page_template":"Page Template","page_dialog_page_template_label":"The new page will be based on the following page template:"};dojo.provide("com.ibm.bundles.nls.SharedMessages");com.ibm.bundles.nls.SharedMessages._built=true;dojo.provide("com.ibm.bundles.nls.SharedMessages.en");com.ibm.bundles.nls.SharedMessages.en={"change_style_missingStyleError_0":"BMWPB0024E: The specified style does not exist","javascript_loading_error_1":"BMWPB0026E: Javascript library ${0} did not load completely. Some parts of the page may not function.","nav_invalid_drop_error_0":"BMWPB0001E: This move operation is not allowed.","change_layout_maximizedError_0":"BMWPB0014E: The layout cannot be changed while there is a portlet in maximized mode.","shelf_bundleUndefined_1":"BMWPB0017E: The resource bundle ${0} could not be found","add_content_maximizedError2_0":"BMWPB0015E: Content cannot be added to the page while there is a component maximized.","page_dialog_no_templates_found_0":"BMWPB0005E: No page templates found.","change_layout_maximizedError2_0":"BMWPB0016E: The layout cannot be changed while there is a component maximized.","add_content_addContentError_0":"BMWPB0021E: Error adding content to the page.","shelf_bundleKeyUndefined_2":"BMWPB0018E: The key ${0} was undefined in the resource bundle ${1}","add_content_restrictedContentError_1":"BMWPB0023E: ${0} is not allowed on this page","shelf_session_timeout_0":"BMWPB0012E: Your session has timed out.  Log in to continue.","add_content_legacyError2_0":"BMWPB0020E: Content cannot be added to pages with legacy layouts.  Assign a layout template.","add_content_missingRendererError_0":"BMWPB0022E: Could not find the specified renderer.","change_layout_templateSyncError_0":"BMWPB0025E: Error with layout template sync.","nav_renderingError_0":"BMWPB0003E: An error occurred when rendering the navigation.","shelf_configError_0":"BMWPB0007E: Error reading configuration file or processing its content.","shelf_serverError_0":"BMWPB0011E: Internal server error.","add_content_maximizedError_0":"BMWPB0013E: Content cannot be added to the page while there is a portlet in maximized mode.","shelf_configError_1":"BMWPB0028E: Error reading configuration file ${0} or processing its content.","add_content_legacyError_0":"BMWPB0019E: Content cannot be added to pages with legacy layouts.  Assign a layout and save your changes to use this feature.","nav_createPageError_0":"BMWPB0004E: An error occurred creating the page.","shelf_badDatastoreError_1":"BMWPB0008E: ${0} cannot be loaded because the data store for this content source is undefined.","nav_invalid_drop_msg_0":"BMWPB0002E: Make sure you have sufficient permissions to rearrange pages.","javascript_disabled_error_0":"BMWPB0027E: Javascript is disabled in this browser. This page requires Javascript.","shelf_feedError_1":"BMWPB0009E: ${0} cannot be loaded. Check the internet connection and proxy settings."};dojo.provide("com.ibm.bundles.nls.Resolver");com.ibm.bundles.nls.Resolver._built=true;dojo.provide("com.ibm.bundles.nls.Resolver.en");com.ibm.bundles.nls.Resolver.en={"errorNoPocHandler":"No handler is registered for prefix ${0}","errorDataFormat":"Data format is invalid","errorInit":"An error occurred when initializing the resolver store.","errorWriteNotLoaded":"Item must be loaded before attempting to write to it","errorInvalidString":"${0} is not a string","errorReadOnlyPrefs":"Cannot write to read-only preference attribute with key ${0}","errorNullPrefsKey":"The preferences key cannot be null","errorNotInModel":"Item is not in this model","errorInvalidItem":"${0} is not an item in this store"};dojo.provide("com.ibm.widgets.nls.DoneCheckDialog");com.ibm.widgets.nls.DoneCheckDialog._built=true;dojo.provide("com.ibm.widgets.nls.DoneCheckDialog.en");com.ibm.widgets.nls.DoneCheckDialog.en={"text_want_to_close_without_saving":"Do you really want to close the dialog without saving your changes?","button_yes":"Yes","text_are_you_sure":"Are you sure?","link_no":"No","title_click_to_close":"Click to close","title_close":"Close"};dojo.provide("dijit.form.nls.validate");dijit.form.nls.validate._built=true;dojo.provide("dijit.form.nls.validate.en");dijit.form.nls.validate.en={"rangeMessage":"This value is out of range.","invalidMessage":"The value entered is not valid.","missingMessage":"This value is required."};dojo.provide("dijit.form.nls.ComboBox");dijit.form.nls.ComboBox._built=true;dojo.provide("dijit.form.nls.ComboBox.en");dijit.form.nls.ComboBox.en={"previousMessage":"Previous choices","nextMessage":"More choices"};dojo.provide("com.ibm.widgets.nls.AddTag");com.ibm.widgets.nls.AddTag._built=true;dojo.provide("com.ibm.widgets.nls.AddTag.en");com.ibm.widgets.nls.AddTag.en={"text_community_tags_for_this_resource":"Community tags for this resource:","link_done":"Done","text_no_tags_on_this_resource":"There are no tags assigned to this resource.","title_input_tag_names":"Input field for tag names","text_error_tags_rejected":"Your actions failed: ${0} tags were rejected by the server, either because of a filter rule, due to insufficient permissions or invalid characters.","text_info_changes_lost":"All changes made in a different tab will be lost.","text_invalid_tag_name":"Invalid tag name","title_delete_all_tags_of_name":"Delete all tags assigned to this resource with the name \"${0}\"","title_your_tags":"Your tags","button_public":"Public","title_community_tags":"Community tags","text_info_length_of_tag_invalid":"The length of one of the entered tags is either too long or too short.","text_info_max_number_of_community_tags_reached":"The maximum number of tags to be displayed (set by your administrator) has been reached. New tags will no more be listed in this section.","title_confirmation":"Confirmation","text_add_tags":"Add the following tag(s):","text_all_tags_deleted":"The selected community tags have been successfully deleted.","title_close_widget":"Close widget","button_private":"Private","text_error_renderMode_wsrp":"Please note that tagging is not fully supported in WSRP scenarios. Please contact your administrator for help.","text_tags_deleted":" tag(s) deleted","title_view_tags":"View tags","title_switch_to_priv_view":"Switch to private view","title_done_with_tagging":"Done with tagging (unsaved changes will be lost)","text_your_tags_for_this_resource":"Your tags for this resource:","title_submit_tags":"Submit tags","title_pub_tags":"Your public tags","title_error_message":"Error message","title_all_tags":"All tags","title_locale_picker":"The language your entries will be saved in: ","text_info_max_number_of_private_tags_reached":"You have reached the maximum number of private tags allowed for one user (${0} tags).","title_switch_to_community_view":"Switch to public view","text_tag":"Tag \"${0}\"","title_hide_tags":"Hide tags","text_loading":"Loading...","text_error_tag_already_assigned":"You have already assigned one or more of the entered tags to this resource.","title_open_widget":"Add tags","title_delete":"Delete \"${0}\"","title_priv_tags":"Your private tags","text_info_max_number_of_public_tags_reached":"You have reached the maximum number of public tags allowed for one user (${0} tags).","text_you_have_no_tags_on_this_resource":"You have no tags assigned to this resource.","text_tags_saved":" tag(s) created","text_success_changes_stored_successfully":"Your actions were successful: ","button_save":"Save"};dojo.provide("com.ibm.widgets.nls.AddRating");com.ibm.widgets.nls.AddRating._built=true;dojo.provide("com.ibm.widgets.nls.AddRating.en");com.ibm.widgets.nls.AddRating.en={"link_done":"Done","text_community_rating_for_this_resource":"Community rating for this resource:","text_stars_count":"${0} star(s)","text_info_changes_lost":"All changes made in a different tab will be lost.","text_rating_deleted":"Rating deleted.","button_public":"Public","title_rating_distribution":"Rated ${0} time(s) with ${1} star(s)","title_confirmation":"Confirmation","title_not_set":"No rating has been set, yet. ","title_click_to_add_ratings":"Click to add ratings.","title_your_rating":"Your rating","title_pub_rating":"Your public rating","title_close_widget":"Close widget","button_private":"Private","text_error_renderMode_wsrp":"Please note that rating is not fully supported in WSRP scenarios. Please contact your administrator for help.","title_hide_ratings":"Hide ratings","title_priv_rating":"Your private rating","title_switch_to_priv_view":"Switch to private view","title_community_rating":"Community rating","text_all_ratings_deleted":"All ratings have been successfully deleted.","title_switch_to_pub_view":"Switch to public view","title_all_rating":"All ratings","title_error_message":"Error message","title_community_rating_distribution":"Distribution of the community rating","title_delete_ratings_for_this_resource":"Delete all public ratings assigned to this resource","title_done_with_rating":"Done with rating (unsaved changes will be lost)","title_rating_percentage":"Rating: ${0} out of ${1}. ","title_open_widget":"Click to add ratings","text_rating_saved":"Rating saved.","title_info":"Information","title_delete_rating":"Delete rating","text_rate":"Rate \"${0}\"","link_delete":"Delete","title_submit_rating":"Save rating","text_success_changes_stored_successfully":"Your actions were successful: ","text_your_rating_for_this_resource":"Your rating for this resource:","button_save":"Save","title_view_ratings":"View ratings"};dojo.provide("com.ibm.widgets.nls.CPLauncher");com.ibm.widgets.nls.CPLauncher._built=true;dojo.provide("com.ibm.widgets.nls.CPLauncher.en");com.ibm.widgets.nls.CPLauncher.en={"tag":"Tag ","rate":"Rate "};dojo.provide("com.ibm.widgets.nls.TagCloud");com.ibm.widgets.nls.TagCloud._built=true;dojo.provide("com.ibm.widgets.nls.TagCloud.en");com.ibm.widgets.nls.TagCloud.en={"title_jump_to_page":"Type in a page number and press Enter to navigate to it","text_cloud":"cloud","title_pagepicker":"Click on a page number to navigate to it","text_list":"list","title_pageofpages":"Indicates which page is currently shown in the list","title_tagsshown":"Showing tags ${0} to ${1} of ${2}","text_private_tags":"Private","text_all_tags":"Community","text_error_insufficient_permissions":"You have insufficient permissions to view tags","alt_goto_page":"Go to page","title_slider":"Move slider to show less or more tags","text_jump_to_page":"Jump to page","title_loading_icon":"Loading...","text_my_tags":"Personal","text_latest_tags":"Latest","title_privatetags":"Show your private tags","text_next":"Next","text_page":"Page ${0}","title_click_to_collapse":"Click to collapse the scope selector section","title_scope_add_btn":"Click to add this scope to the list of selected scopes","title_click_to_expand":"Click to expand the scope selector section","title_alltags":"Show community tags from all users","text_previous":"Previous","text_times":"${0} times","text_select_scope":"Select scope","title_next":"Click to show next page","text_error":"Error","title_scope_selector":"Pick a scope that you want to add to the list of selected scopes","text_time":"${0} time","title_list_view":"Show tags in a list view","text_loading":"Loading tags","text_no_tags_found":"No tags found","title_mytags":"Show your personal community tags","title_tagged_times":"The tag '${0}' was used ${1} times","text_page_of_pages":"${0} - ${1} of ${2}","text_view_as":"View as","text_information":"Information","title_latesttags":"Show latest community tags from all users","title_cloud_view":"Show tags in a cloud view","title_goto_page":"Go to page ${0}","title_previous":"Click to show previous page","text_tags":"Tags","text_ellipsis":"...","title_remove_scope":"Click to remove this scope from the list of selected scopes"};
/** Licensed Materials - Property of IBM, 5724-U69, (C) Copyright IBM Corp. 2009, 2010 - All Rights reserved.  **/
dojo.provide("com.ibm.theme.PageBuilder2.theme");dojo.i18n._preloadLocalizations("com.ibm.themes.PageBuilder2.nls.theme",["ROOT","ar","ca","cs","da","de","el","en","es","fi","fr","he","hr","hu","it","ja","ko","nl","no","pl","pt","pt-br","ro","ru","sk","sl","sv","th","tr","uk","xx","zh","zh-tw"]);if(typeof (ExtensionRegistry)=="undefined"){this.ExtensionRegistry=function(_1){var _2=window;var _3={root:document.body,enabled:false,_queue:[],debug:function(_4){if(this.enabled){}},log:function(_5){if(this.enabled){}},_flushQueueIfNecessary:function(){var _6=(this._queue.length>0);while(this._queue.length>0){this.root.appendChild(this._queue.shift());}if(_6){this.log("----------------- END STMTS EXECUTED BEFORE ONLOAD ---------------");}}};var _7=function(_8){var _9=_8.split(".");var _a=null;var _b=window;var _c=null;for(var i=0;(i<_9.length&&_b);i++){_a=_b;_c=_9[i];_b=_a[_9[i]];}return [{object:_a,method:_c}];};if(!_1){_1=_7;}function forInLoop(_d,_e){for(var _f in _d){if(Object.prototype.hasOwnProperty.call(_d,_f)){_e(_f,_d[_f]);}}};function isArray(obj){return (obj&&obj.length&&typeof (obj.length)=="number");};function applyToObjectOrArray(obj,_10){if(isArray(obj)){for(var i=0;i<obj.length;i++){_10(obj[i]);}}else{_10(obj);}};function MethodDescriptor(obj,_11){this.method=_11;this.object=(obj.prototype&&obj.prototype[this.method])?obj.prototype:obj;this.originalValue=this.object[this.method];this.id=(this.object&&this.object.declaredClass)?this.object.declaredClass:this.originalValue.toString();};MethodDescriptor.prototype.getMethod=function(){return this.object[this.method];};MethodDescriptor.prototype.setMethod=function(_12){this.object[this.method]=_12;};MethodDescriptor.prototype.revert=function(){this.setMethod(this.originalValue);};MethodDescriptor.prototype.toString=function(){return "{ object: "+this.object+", method: "+this.method+", originalValue: "+(this.originalValue?this.originalValue.toString():this.originalValue)+", currentValue: "+this.getMethod().toString()+" }";};function ExtensionPointController(_13,_14){this.name=_13;this.fnDescriptor=_14;this.extensions={before:[],after:[]};};ExtensionPointController.prototype.addAroundAdvice=function(_15){var fn=this.fnDescriptor.getMethod();this.fnDescriptor.setMethod(function(){if(_3.enabled){_3.log("around advice entry ==> [ "+arguments+" ]");_3.log("handler to execute: "+_15.toString());_3.debug(_15);_3.log("next function in the chain (executor parameter): "+fn.toString());_3.debug(fn);}var me=this;var _16=_15.call(this,function(_17){return fn.apply(me,_17);},arguments);if(_3.enabled){_3.log("around advice exit ==> "+_16);}return _16;});};ExtensionPointController.prototype.execute=function(_18,_19){if(_3.enabled){_3.log("ExtensionPointController.execute entry ==> [ "+_18+", "+_19+" ] ");_3.debug(_18);_3.debug(_19);}function argumentsToArray(_1a){var arr=[];for(var i=0;i<_1a.length;i++){arr.push(_1a[i]);}return arr;};var _1b=null;if(_3.enabled){_3.log("Executing extensions for \""+this.name+"\"...");}var _1c=this.extensions;var _1d=this.fnDescriptor;function doExecution(_1e){if(_3.enabled){_3.log("doExecution entry ==> "+_1e);_3.debug(_1e);}if(_1e){_1e=argumentsToArray(_1e);}var _1f=null;var _20=_1d.getMethod();_1d.revert();var _21=_1c.before;if(_3.enabled){_3.log("Executing "+_21.length+" before advice extensions.");}for(var i=0;i<_21.length;i++){if(_3.enabled){_3.log("beforeAdvice["+i+"] = "+_21[i].toString());_3.debug(_21[i]);}_1e=_21[i].call(this,_1e);}if(_3.enabled){_3.log("Executing the original function: "+_1d.getMethod().toString());}_1f=_1d.getMethod().apply(this,_1e);var _22=_1c.after;if(_3.enabled){_3.log("Executing "+_22.length+" after advice extensions.");}if(_1e){for(var j=0;j<_22.length;j++){if(_3.enabled){_3.log("afterAdvice["+j+"] = "+_22[j].toString());_3.debug(_22[j]);_3.log("Return value: "+_1f);_3.debug(_1f);}_1f=_22[j].call(this,_1f,_1e);}}_1d.setMethod(_20);if(_3.enabled){_3.log("doExecution exit ==> "+_1f);}return _1f;};_1b=doExecution.apply(_18,[_19]);if(_3.enabled){_3.log("ExtensionPointController.execute exit ==> "+_1b);}return _1b;};if(!ExtensionRegistry.prototype.extensionPointControllers){ExtensionRegistry.prototype.extensionPointControllers={};}function getExtensionPointController(_23,_24){if(_3.enabled){_3.log("ExtensionRegistry.getExtensionPointController entry ==> [ "+_23+", "+_24+" ]");}var _25=ExtensionRegistry.prototype.extensionPointControllers[_23];if(!_25){_25={};ExtensionRegistry.prototype.extensionPointControllers[_23]=_25;}var _26=_25[_24.id];if(!_26){_26=new ExtensionPointController(_23,_24);ExtensionRegistry.prototype.extensionPointControllers[_23][_24.id]=_26;_24.setMethod(function(){if(_3.enabled){_3.log(_23+" entry ==> "+arguments);}var _27=_26.execute(this,arguments);if(_3.enabled){_3.log(_23+" exit ==> "+_27);}return _27;});}if(_3.enabled){_3.log("ExtensionRegistry.getExtensionPointController exit ==> "+_26);}return _26;};function processExtensionDefinition(_28,_29){if(_3.enabled){_3.log("processExtensionDefinition entry ==> [ "+_28+", "+_29+" ]");_3.log("Extension: "+_28+"; extension: { type: \""+_29.type+"\", handler: "+_29.handler+" }");}var _2a=_1(_28);_2a=_2a||null;if(_2a===null){_2a=_7(_28);}if(_3.enabled){_3.log("impls="+_2a);}for(var i=0;i<_2a.length;i++){var _2b=_2a[i];var md=new MethodDescriptor(_2b.object,_2b.method);if(md.originalValue){var _2c=getExtensionPointController(_28,md);if(_3.enabled){_3.log("Extension Point (after mapping function): "+md);}switch(_29.type){case "before":if(_3.enabled){_3.log("wrapping in a before extension");}_2c.extensions.before.push(_29.handler);break;case "after":if(_3.enabled){_3.log("wrapping in an after extension");}_2c.extensions.after.push(_29.handler);break;case "around":if(_3.enabled){_3.log("wrapping in an around extension");}_2c.addAroundAdvice(_29.handler);break;default:if(_3.enabled){_3.log("Unrecognized extension type: "+_29.type);}}}else{if(console&&console.log){console.log("WARNING! \""+_28+"\" does not exist! The provided extension will be ignored!");}}}if(_3.enabled){_3.log("processExtensionDefinition exit");}};function removeExtensionDefinition(_2d){if(_3.enabled){_3.log("removeExtensionDefinition entry ==> [ "+_2d+" ]");}var _2e=ExtensionRegistry.prototype.extensionPointControllers[_2d];forInLoop(_2e,function(_2f,_30){_30.fnDescriptor.revert();});delete ExtensionRegistry.prototype.extensionPointControllers[_2d];if(_3.enabled){_3.log("removeExtensionDefinition exit");}};this.process=function(_31){if(_3.enabled){_3.log("ExtensionRegistry.process entry ==>"+_31);}applyToObjectOrArray(_31,function(_32){forInLoop(_32,function(_33,_34){applyToObjectOrArray(_34,function(obj){processExtensionDefinition(_33,obj);});});});if(_3.enabled){_3.log("ExtensionRegistry.process exit");}};this.disconnect=function(_35){if(_3.enabled){_3.log("ExtensionRegistry.disconnect entry ==>"+_35);}removeExtensionDefinition(_35);if(_3.enabled){_3.log("ExtensionRegistry.disconnect exit");}};};}if(typeof ImplementationTracker=="undefined"){this.ImplementationTracker=function(_36){var _37={enabled:false,log:function(msg){if(this.enabled){}},debug:function(obj){if(this.enabled){}}};function forInLoop(obj,_38){for(var _39 in obj){if(Object.prototype.hasOwnProperty.call(obj,_39)){_38(_39,obj[_39]);}}};function getMethodImpl(_3a){var _3b=_3a.split(".");var _3c=null;var _3d=window;var _3e=null;for(var i=0,l=_3b.length;(i<l&&_3d);i++){_3c=_3d;_3e=_3b[i];_3d=_3c[_3b[i]];}return {object:_3c,method:_3e};};var _3f={};function ObjectInfo(_40){this.className=_40;this.parents=[];this.implementors=[];};ImplementationTracker.prototype.dumpObjects=function(){if(_37.enabled){forInLoop(_3f,function(_41,_42){var _43="\""+_41+"\" : [ ";for(var i=0,l=_42.implementors.length;i<l;i++){_43+=_42.implementors[i].className;if(i!=(l-1)){_43+=", ";}}_43+=" ];";_37.log(_43);});}};function processAncestors(_44,_45){if(_44){var len=_44.length,_46;for(var i=0;i<len;i++){_46=_3f[_44[i]];if(_46){_46.implementors.push(_45);}processAncestors(_44[i].parents,_45);}}};ImplementationTracker.prototype.add=function(_47,_48){if(_37.enabled){_37.log("ImplementationTracker.add entry ==> "+[_47,_48]);}if(!_3f[_47]){if(_48&&typeof _48=="function"){_48=[_48];}var _49=new ObjectInfo(_47);_3f[_47]=_49;for(var i=0,l=_48?_48.length:0;i<l;i++){if(_48[i].prototype){var _4a=_48[i].prototype.declaredClass;_49.parents.push(_4a);var _4b=_3f[_4a];if(_37.enabled){_37.log("Processing parent classname: "+_4a);_37.log("parent exists in object store? "+_4b);}if(_4b){_4b.implementors.push(_49);if(_36){processAncestors(_4b.parents,_49);}}else{_4b=new ObjectInfo(_4a);_4b.implementors.push(_49);}}}}if(_37.enabled){_37.log("ImplementationTracker.add exit");}};ImplementationTracker.prototype.getImpls=function(_4c){if(_37.enabled){_37.log("ImplementationTracker.getImpls entry ==> "+_4c);}var _4d=_4c.substring(0,_4c.lastIndexOf("."));var _4e=_4c.substring(_4c.lastIndexOf(".")+1);if(_37.enabled){_37.log("className = "+_4d+"; methodName = "+_4e);}var _4f=getMethodImpl(_4c);_4f=_4f||null;if(!_3f[_4d]||_4f===null){if(_37.enabled){_37.log("ImplementationTracker.getImpls exit ==> null ");}return null;}var _50=_3f[_4d].implementors;if(_37.enabled){_37.log("impls = "+_50);}var _51=[];for(var i=0,l=_50.length;i<l;i++){if(_37.enabled){_37.log("impls[i]="+_50[i].className);}_4f=getMethodImpl(_50[i].className+"."+_4e);_4f=_4f||null;if(_4f!==null){_51.push(_4f);}}if(_37.enabled){_37.log("ImplementationTracker.getImpls exit ==> "+_51);}return _51;};};}(function(){var _52=new ImplementationTracker(true);var _53={"dojo.declare":{type:"before",handler:function(_54){_52.add(_54[0],_54[1]);return _54;}}};var _55=new ExtensionRegistry();_55.process(_53);ibmConfig.mappingFunction=function(_56){return _52.getImpls(_56);};})();(function(){var ver="2.4.0.20150113-1447".split(".");var _57="enabler.minimal";if(_57){_57="_"+_57;}if(ver.length==4){dojo.setObject("com.ibm.mashups.enabler.version",{major:ver[0],minor:ver[1],patch:ver[2],"flag":_57,revision:ver[3],toString:function(){return this.major+"."+this.minor+"."+this.patch+(this.flag||"")+" ("+this.revision+")";}});}})();if(!dojo._hasResource["com.ibm.mashups.enabler.context.LocalizedContext_API"]){dojo._hasResource["com.ibm.mashups.enabler.context.LocalizedContext_API"]=true;dojo.provide("com.ibm.mashups.enabler.context.LocalizedContext_API");dojo.provide("com.ibm.mashups.enabler.context.LocalizedContext");dojo.declare("com.ibm.mashups.enabler.context.LocalizedContext",null,{getPreferredLocale:function(){},getDefaultLocale:function(){},getLocale:function(_58){},getDisplayLocale:function(_59){},getTitle:function(_5a){},getDescription:function(_5b){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.logging.LogLevel"]){dojo._hasResource["com.ibm.mashups.enabler.logging.LogLevel"]=true;dojo.provide("com.ibm.mashups.enabler.logging.LogLevel");dojo.declare("com.ibm.mashups.enabler.logging.LogLevel",null,{TRACE:500,INFO:800,WARNING:900,SEVERE:1000});com.ibm.mashups.enabler.logging.LogLevel=new com.ibm.mashups.enabler.logging.LogLevel();}if(!dojo._hasResource["com.ibm.mashups.enabler.logging.LogHandler"]){dojo._hasResource["com.ibm.mashups.enabler.logging.LogHandler"]=true;dojo.provide("com.ibm.mashups.enabler.logging.LogHandler");dojo.require("com.ibm.mashups.enabler.logging.LogLevel");dojo.declare("com.ibm.mashups.enabler.logging.LogHandler",null,{constructor:function(){},getHandlerID:function(){return null;},getLogLevel:function(){return null;},log:function(_5c,_5d,_5e,_5f){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.logging.Logger_API"]){dojo._hasResource["com.ibm.mashups.enabler.logging.Logger_API"]=true;dojo.provide("com.ibm.mashups.enabler.logging.Logger_API");dojo.provide("com.ibm.mashups.enabler.logging.Logger");dojo.require("com.ibm.mashups.enabler.logging.LogLevel");dojo.declare("com.ibm.mashups.enabler.logging.Logger",null,{constructor:function(){},getLogger:function(_60){return null;},addHandler:function(_61){},removeHandler:function(_62){},entering:function(_63,_64){},exiting:function(_65,_66){},info:function(_67,_68,_69){},warning:function(_6a,_6b,_6c){},severe:function(_6d,_6e,_6f){},trace:function(_70,_71,_72){},log:function(_73,_74,_75,_76){},isLoggable:function(_77){return false;}});}if(!dojo._hasResource["com.ibm.mm.enabler.logging.ConsoleHandler"]){dojo._hasResource["com.ibm.mm.enabler.logging.ConsoleHandler"]=true;dojo.provide("com.ibm.mm.enabler.logging.ConsoleHandler");dojo.declare("com.ibm.mm.enabler.logging.ConsoleHandler",[com.ibm.mashups.enabler.logging.LogHandler],{constructor:function(){this.handlerID="com.ibm.mm.enabler.logging.ConsoleHandler";this.logLevel=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},getHandlerID:function(){return this.handlerID;},getLogLevel:function(){return this.logLevel;},log:function(_78,_79,_7a,_7b){if(_79==com.ibm.mashups.enabler.logging.LogLevel.SEVERE){console.error(_78+" "+_7a+": "+_7b);}else{if(_79==com.ibm.mashups.enabler.logging.LogLevel.WARNING){console.warn(_78+" "+_7a+": "+_7b);}else{if(_79==com.ibm.mashups.enabler.logging.LogLevel.INFO){console.info(_78+" "+_7a+": "+_7b);}else{if(_79==com.ibm.mashups.enabler.logging.LogLevel.TRACE){console.debug(_78+" "+_7a+": "+_7b);}}}}}});}if(!dojo._hasResource["com.ibm.mm.enabler.logging.LoggerImpl"]){dojo._hasResource["com.ibm.mm.enabler.logging.LoggerImpl"]=true;dojo.provide("com.ibm.mm.enabler.logging.LoggerImpl");dojo.declare("com.ibm.mm.enabler.logging.LoggerImpl",[com.ibm.mashups.enabler.logging.Logger],{BASE_TOPIC:"com.ibm.mm.enabler.logging.",constructor:function(_7c,_7d){this.loggers={};this.handlers={};this.name=_7c?_7c:null;this.parentLogger=_7d?_7d:null;if(!this.parentLogger){if(ibmConfig&&ibmConfig.traceConfig){this._setTraceConfig(ibmConfig.traceConfig);}else{this._setTraceConfig();}}},getLogger:function(_7e){if(this.parentLogger){return this.parentLogger.getLogger(_7e);}if(!this.loggers[_7e]){this.loggers[_7e]=new com.ibm.mm.enabler.logging.LoggerImpl(_7e,this);}return this.loggers[_7e];},addHandler:function(_7f){if(this.parentLogger){return this.parentLogger.addHandler(_7f);}this.handlers[_7f.handlerID]={};var _80=this.handlers[_7f.handlerID];_80.handler=_7f;var _81=_7f.getLogLevel();var _82="log";_80.severeHandle=dojo.subscribe(this.BASE_TOPIC+com.ibm.mashups.enabler.logging.LogLevel.SEVERE,_7f,_82);if(_81<=com.ibm.mashups.enabler.logging.LogLevel.WARNING){_80.warningHandle=dojo.subscribe(this.BASE_TOPIC+com.ibm.mashups.enabler.logging.LogLevel.WARNING,_7f,_82);}if(_81<=com.ibm.mashups.enabler.logging.LogLevel.INFO){_80.infoHandle=dojo.subscribe(this.BASE_TOPIC+com.ibm.mashups.enabler.logging.LogLevel.INFO,_7f,_82);}if(_81<=com.ibm.mashups.enabler.logging.LogLevel.TRACE){_80.traceHandle=dojo.subscribe(this.BASE_TOPIC+com.ibm.mashups.enabler.logging.LogLevel.TRACE,_7f,_82);}},removeHandler:function(_83){var _84;var _85;if(dojo.isString(_83)){if(!_83 in this.handlers){return;}_84=this.handlers[_83];_85=_83;}else{if(dojo.isObject(_83)){_84=this.handlers[_83.getHandlerID()];_85=_83.getHandlerID();}else{return;}}if(_84){if(_84.severeHandle){dojo.unsubscribe(_84.severeHandle);}if(_84.warningHandle){dojo.unsubscribe(_84.warningHandle);}if(_84.infoHandle){dojo.unsubscribe(_84.infoHandle);}if(_84.traceHandle){dojo.unsubscribe(_84.traceHandle);}if(_84.handler){delete _84.handler;}}delete this.handlers[_85];},entering:function(_86,_87){var _88=com.ibm.mashups.enabler.logging.LogLevel.TRACE;if(this.isLoggable(_88)){var msg=this._getMessageString(_87);this._log(this.name,_88,_86,"ENTRY"+(msg?" "+msg:""));}},exiting:function(_89,_8a){var _8b=com.ibm.mashups.enabler.logging.LogLevel.TRACE;if(this.isLoggable(_8b)){var msg=this._getMessageString(_8a);this._log(this.name,_8b,_89,"RETURN"+(msg?" "+msg:""));}},info:function(_8c,_8d,_8e){var _8f=com.ibm.mashups.enabler.logging.LogLevel.INFO;this.log(_8f,_8c,_8d,_8e);},warning:function(_90,_91,_92){var _93=com.ibm.mashups.enabler.logging.LogLevel.WARNING;this.log(_93,_90,_91,_92);},severe:function(_94,_95,_96){var _97=com.ibm.mashups.enabler.logging.LogLevel.SEVERE;this.log(_97,_94,_95,_96);},trace:function(_98,_99,_9a){var _9b=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.log(_9b,_98,_99,_9a);},log:function(_9c,_9d,_9e,_9f){if(!this.parentLogger){this._log("com.ibm.mashups.enabler.logging.Logger",com.ibm.mashups.enabler.logging.LogLevel.WARNING,"{log|info|warning|severe|trace|entering|exiting}","You must not use the RootLogger (com.ibm.mashups.enabler.logging.Logger). Create your own logger for each class.");}if(this.isLoggable(_9c)){this._log(this.name,_9c,_9d,_9e,_9f);}},isLoggable:function(_a0){if(_a0!=com.ibm.mashups.enabler.logging.LogLevel.TRACE){return true;}if(!(ibmConfig&&ibmConfig.isDebug)){return false;}var _a1=this._getRegExp();if(_a1&&_a1.exec(this.name)){return true;}return false;},_log:function(_a2,_a3,_a4,_a5,_a6){if((_a6&&!dojo.isArray(_a6))||_a6===false){_a6=[_a6];}var _a7=_a6?dojo.string.substitute(_a5,_a6):_a5;dojo.publish(this.BASE_TOPIC+_a3,[_a2,_a3,_a4,_a7]);},_getMessageString:function(_a8){var _a9=0;var msg="";if(_a8||_a8===false){msg+="[ ";if(dojo.isArray(_a8)){for(var i=0;i<_a8.length;++i){var arg=_a8[i];if(msg.length>2){msg+=", ";}if(typeof arg=="undefined"){msg+="undefined";}if(arg&&arg.toString){msg+=arg.toString();}else{if(arg===null){msg+="null";}else{msg+="n/a";}}}}else{if(_a8&&_a8.toString){msg+=_a8.toString();}else{if(_a8===null){msg+="null";}else{msg+="n/a";}}}msg+=" ]";}return msg;},_setTraceConfig:function(_aa){if((dojo.isArray(_aa)||dojo.isString(_aa))&&_aa.length>0){this._log("RootLogger",com.ibm.mashups.enabler.logging.LogLevel.TRACE,"_setTraceConfig","Changing traceConfig: "+_aa);var _ab=dojo.isArray(_aa)?_aa.join("|"):_aa;if(_ab.length>0){this.regExp=new RegExp(_ab);return;}}this.regExp=null;},_disableTraceConfig:function(){this.regExp=null;},_getRegExp:function(){if(this.parentLogger){return this.parentLogger._getRegExp();}return this.regExp;}});com.ibm.mashups.enabler.logging.Logger=new com.ibm.mm.enabler.logging.LoggerImpl();com.ibm.mashups.enabler.logging.Logger.addHandler(new com.ibm.mm.enabler.logging.ConsoleHandler());}if(!dojo._hasResource["com.ibm.mashups.enabler.logging.Logger"]){dojo._hasResource["com.ibm.mashups.enabler.logging.Logger"]=true;dojo.provide("com.ibm.mashups.enabler.logging.Logger");}if(!dojo._hasResource["com.ibm.mashups.enabler.xml.XPath_API"]){dojo._hasResource["com.ibm.mashups.enabler.xml.XPath_API"]=true;dojo.provide("com.ibm.mashups.enabler.xml.XPath_API");dojo.provide("com.ibm.mashups.enabler.xml.XPath");dojo.declare("com.ibm.mashups.enabler.xml.XPath",null,{evaluateXPath:function(_ac,doc,_ad){},evaluateEntry:function(_ae,doc,_af){},evaluateBoolean:function(_b0,doc,_b1){},evaluateString:function(_b2,doc,_b3){},evaluateNumber:function(_b4,doc,_b5){}});}if(!dojo._hasResource["com.ibm.mm.enabler.utils.Dom"]){dojo._hasResource["com.ibm.mm.enabler.utils.Dom"]=true;dojo.provide("com.ibm.mm.enabler.utils.Dom");com.ibm.mm.enabler.utils.Dom={getAttributeWithNS:function(_b6,_b7,_b8,_b9){if(!_b6){return null;}if(!_b7){return null;}if(!_b8){return null;}if(!_b9){return null;}var _ba=null;if(dojo.isIE){_ba=_b6.getAttribute(_b7);if(_ba===null||_ba==""){var _bb=_b6.attributes;for(var i=_bb.length;i>0;i--){if(_bb[i-1].baseName==_b8&&_bb[i-1].namespaceURI==_b9){_ba=_bb[i-1].value;break;}}}}else{_ba=_b6.getAttributeNS(_b9,_b8);}return _ba;},setAttributeWithNS:function(dom,_bc,_bd,_be,_bf,_c0){if(!dojo.isObject(_bc)){throw new Error("element must be a DOMNode");}if(dojo.isIE){attribute=dom.createNode(2,_bd,_bf);attribute.nodeValue=_c0;_bc.setAttributeNode(attribute);}else{_bc.setAttributeNS(_bf,_bd,_c0);}},textContent:function(_c1,_c2){if(!_c1){return "";}if(arguments.length>1){var doc=_c1.ownerDocument;if(!_c2){_c2="";}var _c3=doc.createTextNode(_c2);com.ibm.mm.enabler.utils.Dom.replaceChildren(_c1,_c3);return;}else{var tc=dojox.xml.parser.textContent(_c1);if(tc){return tc;}var _c4="";for(var i=0,l=_c1.childNodes.length;i<l;i++){switch(_c1.childNodes[i].nodeType){case 1:case 3:_c4+=_c1.childNodes[i].nodeValue;break;case 2:case 4:_c4+=_c1.childNodes[i].nodeValue;break;default:break;}}return _c4;}},createElement:function(dom,_c5,ns){var _c6;if(dojo.isIE){if(ns){_c6=dom.createNode(1,_c5,ns);}else{_c6=dom.createElement(_c5);}}else{_c6=dom.createElementNS(ns,_c5);}return _c6;},destroyNode:function(_c7){var _c8=document.getElementById("IELeakGarbageBin");if(!_c8){_c8=document.createElement("DIV");_c8.id="IELeakGarbageBin";_c8.style.display="none";document.body.appendChild(_c8);}_c8.appendChild(_c7);_c8.innerHTML="";if(_c7.nodeType!=3){if(dojo.isIE){_c7.outerHTML="";}}},createDocument:function(str,_c9){return dojox.xml.parser.parse(str,_c9);},replaceChildren:function(_ca,_cb){return dojox.xml.parser.replaceChildren(_ca,_cb);},innerXML:function(_cc){return _cc?dojox.xml.parser.innerXML(_cc):null;},removeChildren:function(_cd){return dojox.xml.parser.removeChildren(_cd);},copyChildren:function(_ce,_cf,_d0){var _d1=_ce.cloneNode(true);return this.moveChildren(_d1,_cf,_d0);},moveChildren:function(_d2,_d3,_d4){var _d5=0;if(_d4){while(_d2.hasChildNodes()&&_d2.firstChild.nodeType==3){_d2.removeChild(_d2.firstChild);}while(_d2.hasChildNodes()&&_d2.lastChild.nodeType==3){_d2.removeChild(_d2.lastChild);}}while(_d2.hasChildNodes()){_d3.appendChild(_d2.firstChild);_d5++;}return _d5;},getLocalName:function(_d6){if(!_d6){return null;}switch(_d6.nodeType){case 3:return "#text";case 1:return _d6.localName||com.ibm.mm.enabler.utils.Dom.removeNodeNS(_d6.nodeName);}return null;},getNodeNSPrefix:function(_d7){var tN=""+_d7;var _d8=tN.indexOf(":");return (_d8!=-1)?tN.substring(0,_d8):null;},removeNodeNS:function(_d9){var tN=""+_d9;var _da=tN.indexOf(":");return (_da!=-1)?tN.substring(1+_da):_d9;},lookupNamespaceURI:function(_db,_dc){if(!dojo.isIE){return _db.lookupNamespaceURI(_dc);}var _dd=_db;while(_dd&&_dd.nodeType!=9){var _de=_dd.getAttribute("xmlns:"+_dc);if(_de){return _de;}_dd=_dd.parentNode;}return null;}};}if(!dojo._hasResource["com.ibm.mm.enabler.xml.xpath._Generic"]){dojo._hasResource["com.ibm.mm.enabler.xml.xpath._Generic"]=true;dojo.provide("com.ibm.mm.enabler.xml.xpath._Generic");dojo.declare("com.ibm.mm.enabler.xml.xpath._Generic",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.xml.xpath._Generic");},_evaluateXPath:function(_df,doc,_e0){if(dojo.isSafari){return this._safariEvaluateXPath(_df,doc,_e0);}else{if(dojo.isIE){return this._ieEvaluateXPath(_df,doc,_e0);}else{return this._geckoEvaluateXPath(_df,doc,_e0);}}},_transformNode:function(_e1,_e2){if(typeof XPathResult!="undefined"&&_e1 instanceof XPathResult){return this._xpathResultValue(_e1,_e2);}else{if(_e2==com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE){return _e1;}else{if(_e2==com.ibm.mm.enabler.xml.xpath._Generic.NUMBER_TYPE){return parseFloat(com.ibm.mm.enabler.utils.Dom.textContent(_e1));}else{if(_e2==com.ibm.mm.enabler.xml.xpath._Generic.STRING_TYPE){return com.ibm.mm.enabler.utils.Dom.textContent(_e1);}else{if(_e2==com.ibm.mm.enabler.xml.xpath._Generic.BOOLEAN_TYPE){return !!_e1;}}}}}return null;},_xpathResultValue:function(_e3,_e4){if(_e4==com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE){return _e3;}else{if(_e4==com.ibm.mm.enabler.xml.xpath._Generic.NUMBER_TYPE){return _e3.numberValue;}else{if(_e4==com.ibm.mm.enabler.xml.xpath._Generic.STRING_TYPE){return _e3.stringValue;}else{if(_e4==com.ibm.mm.enabler.xml.xpath._Generic.BOOLEAN_TYPE){return _e3.booleanValue;}}}}return null;},_evaluateXPathSingle:function(_e5,doc,_e6,_e7){_e7=_e7||com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE;var _e8;if(dojo.isSafari){_e8=this._safariEvaluateXPathRaw(_e5,doc,_e6,_e7);if(XPathResult&&_e8 instanceof XPathResult){if(_e7==com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE){return _e8.iterateNext();}return this._transformNode(_e8,_e7);}else{if(_e8){return this._transformNode(_e8[0],_e7);}}}else{if(dojo.isIE){_e8=this._ieEvaluateXPathRaw(_e5,doc,_e6);if(_e8){return this._transformNode(_e8[0],_e7);}}else{_e8=this._geckoEvaluateXPathRaw(_e5,doc,_e6,_e7);if(_e8&&_e7==com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE){return _e8.iterateNext();}else{return this._transformNode(_e8,_e7);}}}return _e8||null;},_geckoEvaluateXPath:function(_e9,doc,_ea){var _eb=this._geckoEvaluateXPathRaw(_e9,doc,_ea,com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE);var _ec=[];if(_eb){var _ed;while((_ed=_eb.iterateNext())){_ec.push(_ed);}}return _ec;},_geckoEvaluateXPathRaw:function(_ee,doc,_ef,_f0){var _f1=doc;if(doc.nodeType!=9){_f1=doc.ownerDocument;}return _f1.evaluate(_ee,doc,function(_f2){return _ef[_f2]?_ef[_f2].toString():null;},_f0,null);},_ieEvaluateXPath:function(_f3,doc,_f4){var _f5=this._ieEvaluateXPathRaw(_f3,doc,_f4);return _f5||[];},_ieEvaluateXPathRaw:function(_f6,doc,_f7){if(_f7){var ns=[];var _f8;for(var _f9 in _f7){_f8=_f7[_f9];if(!dojo.isFunction(_f8)&&_f9!="xml"){ns.push("xmlns:",_f9,"='",_f8,"' ");}}var _fa=doc.ownerDocument||doc;_fa.setProperty("SelectionNamespaces",ns.join(""));_fa.setProperty("SelectionLanguage","XPath");}return doc.selectNodes(_f6);},_safariEvaluateXPath:function(_fb,doc,_fc){var _fd=this._safariEvaluateXPathRaw(_fb,doc,_fc,com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE);if(XPathResult&&_fd instanceof XPathResult){var _fe=[];var _ff;while((_ff=_fd.iterateNext())){_fe.push(_ff);}return _fe;}return _fd||[];},_safariEvaluateXPathRaw:function(_100,doc,_101,type){if(typeof XPathResult!="undefined"){return document.evaluate(_100,doc,function(_102){return _101[_102]?_101[_102].toString():null;},type,null);}else{if(doc.selectNodes){return doc.selectNodes(_100);}}}});com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE=0;com.ibm.mm.enabler.xml.xpath._Generic.NUMBER_TYPE=1;com.ibm.mm.enabler.xml.xpath._Generic.STRING_TYPE=2;com.ibm.mm.enabler.xml.xpath._Generic.BOOLEAN_TYPE=3;}if(!dojo._hasResource["com.ibm.mm.enabler.xml.XPathImpl"]){dojo._hasResource["com.ibm.mm.enabler.xml.XPathImpl"]=true;dojo.provide("com.ibm.mm.enabler.xml.XPathImpl");dojo.declare("com.ibm.mm.enabler.xml.XPathImpl",[com.ibm.mashups.enabler.xml.XPath,com.ibm.mm.enabler.xml.xpath._Generic],{modelMessages:null,constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.xml.XPath");this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");},ANY_TYPE:com.ibm.mm.enabler.xml.xpath._Generic.ANY_TYPE,NUMBER_TYPE:com.ibm.mm.enabler.xml.xpath._Generic.NUMBER_TYPE,STRING_TYPE:com.ibm.mm.enabler.xml.xpath._Generic.STRING_TYPE,BOOLEAN_TYPE:com.ibm.mm.enabler.xml.xpath._Generic.BOOLEAN_TYPE,evaluateXPath:function(_103,doc,_104){var _105="evaluateXPath(xpathExpr,  doc, namespaces)";var _106=this.LOGGER.isLoggable(com.ibm.mashups.enabler.logging.LogLevel.TRACE);if(_106){this.LOGGER.entering(_105,[_103,doc,_104]);}if(!dojo.isString(_103)||_103.length===0){throw new Error(this.modelMessages.E_INVALID_XPATH_EXPR_0);}if(!doc){throw new Error(this.modelMessages.E_INVALID_DOCUMENT_0);}var ret=this._evaluateXPath(_103,doc,_104);if(_106){this.LOGGER.exiting(_105,ret);}return ret;},evaluateSingle:function(_107,doc,_108,type){if(!dojo.isString(_107)||_107.length===0){throw new Error(this.modelMessages.E_INVALID_XPATH_EXPR_0);}if(!doc){throw new Error(this.modelMessages.E_INVALID_DOCUMENT_0);}return this._evaluateXPathSingle(_107,doc,_108,type);},evaluateEntry:function(_109,doc,_10a){return this.evaluateSingle(_109,doc,_10a,com.ibm.mashups.enabler.xml.XPath.ANY_TYPE);},evaluateBoolean:function(_10b,doc,_10c){return this.evaluateSingle(_10b,doc,_10c,com.ibm.mashups.enabler.xml.XPath.BOOLEAN_TYPE);},evaluateString:function(_10d,doc,_10e){return this.evaluateSingle(_10d,doc,_10e,com.ibm.mashups.enabler.xml.XPath.STRING_TYPE);},evaluateNumber:function(_10f,doc,_110){return this.evaluateSingle(_10f,doc,_110,com.ibm.mashups.enabler.xml.XPath.NUMBER_TYPE);},createXPath:function(_111,node,_112){var _113=_111.split("/");var _114=_113[0];var _115=_114.split(":");var name,_116;if(_115.length>1){_116=_115[0];name=_115[1];}else{name=_115[0];}var _117=com.ibm.mashups.enabler.xml.XPath.evaluateXPath((_116?_116+":":"")+name,node,_112);var _118;if(_117&&_117.length>0){_118=_117[0];}else{_118=com.ibm.mm.enabler.utils.Dom.createElement(node.ownerDocument,name,_116?_112[_116]:null);node.appendChild(_118);}if(_113.length>1){_118=com.ibm.mashups.enabler.xml.XPath.createXPath(_111.substr(_111.indexOf("/")+1),_118,_112);}return _118;}});com.ibm.mashups.enabler.xml.XPath=new com.ibm.mm.enabler.xml.XPathImpl();com.ibm.mm.enabler.xml.xpath.evaluateXPath=function(_119,doc,_11a){var _11b=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.xml.xpath");var _11c="evaluateXPath";_11b.warning(_11c,"This method must not be used directly. Use com.ibm.mashups.enabler.xml.XPath.evaluateXPath instead.");dojo.deprecated("com.ibm.mm.enabler.xml.xpath.evaluateXPath","The method com.ibm.mm.enabler.xml.xpath.evaluateXPath is deprecated, please use com.ibm.mashups.enabler.xml.XPath.evaluateXPath instead");return com.ibm.mm.enabler.xml.xpath._Generic.evaluateXPath.apply(null,arguments);};}if(!dojo._hasResource["com.ibm.mashups.enabler.xml.XPath"]){dojo._hasResource["com.ibm.mashups.enabler.xml.XPath"]=true;dojo.provide("com.ibm.mashups.enabler.xml.XPath");}if(!dojo._hasResource["com.ibm.mm.enabler.utils.LocaleHelper"]){dojo._hasResource["com.ibm.mm.enabler.utils.LocaleHelper"]=true;dojo.provide("com.ibm.mm.enabler.utils.LocaleHelper");com.ibm.mm.enabler.utils.LocaleHelper={LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.utils.LocaleHelper"),getLocale:function(_11d,_11e,_11f){com.ibm.mm.enabler.utils.LocaleHelper.LOGGER.warning("com.ibm.mm.enabler.utils.LocaleHelper.getLocale","Deprecated. Use com.ibm.mashups.enabler.context.Factory.getLocalizedContext().getLocale() instead.");if(typeof _11d=="undefined"||_11d===null){return null;}var _120=_11d.getLocales();if(typeof _120=="undefined"||_120===null||!dojo.isArray(_120)){return null;}if(_120.length===0){return null;}var _121=null;if(_120.length===1){_121=_120[0];}var arr={};for(var i in _120){if(Object.prototype.hasOwnProperty.call(_120,i)){var temp=_120[i];arr[temp]=temp;}}var _122;if(_121===null){if(typeof _11e!="undefined"&&_11e!==null){_121=this.findMatchLocale(arr,_11e);if(_121===null){_122=_11e.split(/-|_/);if(_122.length==2){var _123=_122[0];if(typeof arr[_123]!="undefined"&&arr[_123]!==null){_121=_123;}}}}}if(_121===null){var _124=(dojo.isIE?navigator.userLanguage:navigator.language).toLowerCase();if(typeof ibmConfig!="undefined"&&ibmConfig&&typeof (ibmConfig.locale)!="undefined"&&ibmConfig.locale){_124=ibmConfig.locale;}if(_124!==null){_121=this.findMatchLocale(arr,_124);if(_121===null){_122=_124.split(/-|_/);if(_122.length==2){var _125=_122[0];if(typeof arr[_125]!="undefined"&&arr[_125]!==null){_121=_125;}}}}}if(_121===null){if(_11f){_121=_11f;}}if(_121===null){if(arr.en){_121="en";}}if(_121===null){_121=_120[0];}return _121;},findMatchLocale:function(arr,_126){com.ibm.mm.enabler.utils.LocaleHelper.LOGGER.warning("com.ibm.mm.enabler.utils.LocaleHelper.findMatchLocale","Deprecated. Use com.ibm.mm.enabler.utils.LocaleHelper.matchLocale() instead.");var _127=null;if(arr[_126]){_127=_126;}var _128=this.toServerLocale(_126);if(_127===null&&arr[_128]){_127=_128;}var _129=_128.toLowerCase();if(_127===null&&arr[_129]){_127=_129;}return _127;},matchLocale:function(_12a,_12b){return com.ibm.mm.enabler.utils.LocaleHelper._matchLocale(com.ibm.mm.enabler.utils.LocaleHelper._getLocaleObj(_12a),com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(_12b));},_matchLocale:function(_12c,_12d,stop){var _12e=_12c;var _12f=null;var _130=dojo.some(_12d,function(item){if(item==_12c.toString()){_12f=item;return true;}});if(_130&&_12f){return _12f;}if(_12c.variant){_12c.variant=null;return com.ibm.mm.enabler.utils.LocaleHelper._matchLocale(_12c,_12d);}if(_12c.country){_12c.country=null;return com.ibm.mm.enabler.utils.LocaleHelper._matchLocale(_12c,_12d);}if(!stop){_12c=_12e;switch(_12c.language){case "he":_12c.language="iw";break;case "iw":_12c.language="he";break;}return com.ibm.mm.enabler.utils.LocaleHelper._matchLocale(_12c,_12d,true);}return null;},toServerLocale:function(_131){com.ibm.mm.enabler.utils.LocaleHelper.LOGGER.warning("com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale","Deprecated. Use com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale() instead.");if(!_131){return null;}if(_131.indexOf("-")<0){return _131;}_131=_131.replace(/-/,"_");var _132=_131.split("_");var lang=_132[0];var _133=_132[1].toUpperCase();var _134=lang+"_"+_133;return _134;},_getLocaleObj:function(_135){if(dojo.isArray(_135)){return dojo.map(_135,function(item){return com.ibm.mm.enabler.utils.LocaleHelper._getLocaleObj(item);});}else{if(dojo.isString(_135)&&dojo.string.trim(_135).length>0){var _136={language:null,country:null,variant:null,toString:function(){return (this.language?this.language+(this.country?"_"+this.country+(this.variant?"_"+this.variant:""):""):"");},isValid:function(){return !!this.language;}};var _137=dojo.string.trim(_135).replace(/-/g,"_").split("_");switch(_137.length){case 3:_136.variant=_137[2];case 2:_136.country=_137[1].toUpperCase();case 1:_136.language=_137[0].toLowerCase();break;}return _136;}else{return null;}}},normalizeLocale:function(_138){if(dojo.isArray(_138)){return dojo.map(_138,function(item){return com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(item);});}else{if(_138){return com.ibm.mm.enabler.utils.LocaleHelper._getLocaleObj(_138).toString();}else{return null;}}}};}if(!dojo._hasResource["com.ibm.mm.enabler.model.NameSpaceFactory"]){dojo._hasResource["com.ibm.mm.enabler.model.NameSpaceFactory"]=true;dojo.provide("com.ibm.mm.enabler.model.NameSpaceFactory");dojo.declare("com.ibm.mm.enabler.model.NameSpaceFactoryImpl",null,{constructor:function(){this.NS_APP="app";this.NS_ATOM="atom";this.NS_THR="thr";this.NS_UM="um";this.NS_XHTML="xhtml";this.NS_XML="xml";this.NS_XSI="xsi";this.NS_OPENSEARCH="opensearch";this.NS_CM="cm";this.NS_CA="ca";this.NS_CREATION_CONTEXT="creation-context";this.NS_AC="ac";this.NS_EVENT_DATATYPES="event-datatypes";this.NS_XMLNS="xmlns";this.NS_XSD="xsd";this.NS_JS="js";this.namespaces={};this.namespaces[this.NS_APP]="http://www.w3.org/2007/app";this.namespaces[this.NS_ATOM]="http://www.w3.org/2005/Atom";this.namespaces[this.NS_THR]="http://purl.org/syndication/thread/1.0";this.namespaces[this.NS_UM]="http://www.ibm.com/xmlns/prod/websphere/um.xsd";this.namespaces[this.NS_XHTML]="http://www.w3.org/1999/xhtml";this.namespaces[this.NS_XML]="http://www.w3.org/XML/1998/namespace";this.namespaces[this.NS_XSI]="http://www.w3.org/2001/XMLSchema-instance";this.namespaces[this.NS_XMLNS]="http://www.w3.org/2000/xmlns/";this.namespaces[this.NS_OPENSEARCH]="http://a9.com/-/spec/opensearch/1.1/";this.namespaces[this.NS_CM]="http://www.ibm.com/xmlns/prod/composite-applications/v1.0";this.namespaces[this.NS_CA]="http://www.ibm.com/xmlns/prod/composite-applications/v1.0";this.namespaces[this.NS_AC]="http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0";this.namespaces[this.NS_EVENT_DATATYPES]="http://www.ibm.com/xmlns/prod/lotus/mashups/event-datatypes";this.namespaces[this.NS_XSD]="http://www.w3.org/2001/XMLSchema";this.namespaces[this.NS_JS]="text/javascript";},getNameSpaces:function(_139){var _13a={};var len=_139.length;for(var i=0;i<len;i++){var name=_139[i];_13a[name]=this.namespaces[name];}return _13a;},getNameSpaceUri:function(_13b){return this.namespaces[_13b];}});com.ibm.mm.enabler.model.NameSpaceFactory=new com.ibm.mm.enabler.model.NameSpaceFactoryImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.context.LocalizedContextImpl"]){dojo._hasResource["com.ibm.mm.enabler.context.LocalizedContextImpl"]=true;dojo.provide("com.ibm.mm.enabler.context.LocalizedContextImpl");dojo.declare("com.ibm.mm.enabler.context.LocalizedContextImpl",[com.ibm.mashups.enabler.context.LocalizedContext],{constructor:function(_13c,_13d){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.context.LocalizedContextImpl");this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML]);this.basicFallback=!(_13c||_13d);this.preferredLocale=_13c||null;if(this.preferredLocale===null){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&typeof (ibmConfig.locale)!="undefined"&&ibmConfig.locale!==null){this.preferredLocale=ibmConfig.locale;}else{this.preferredLocale=(dojo.isIE?navigator.userLanguage:navigator.language).toLowerCase();}}this.defaultLocale=_13d||"en";this._DEFAULT_TITLE="atom:title";this._DEFAULT_DESCRIPTION="atom:summary";this._DEFAULT_LOCALE=this._DEFAULT_TITLE+"/@xml:lang";},getPreferredLocale:function(){return this.preferredLocale;},getDefaultLocale:function(){return this.defaultLocale;},getLocale:function(_13e){if(typeof _13e=="undefined"||_13e===null){return null;}if(this.basicFallback&&dojo.isFunction(_13e.getXml)){return com.ibm.mashups.enabler.xml.XPath.evaluateString(this._DEFAULT_LOCALE,_13e.getXml(),this.ns)||null;}var _13f=_13e.getLocales();switch(_13f.length){case 0:return null;case 1:return com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(_13f[0]);default:var _140=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(this.preferredLocale,_13f);if(_140){return _140;}var _141=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(this.defaultLocale,_13f);if(_141){return _141;}return com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(_13f[0]);}},getTitle:function(_142){if(typeof _142=="undefined"||_142===null){return null;}var _143;if(this.basicFallback&&dojo.isFunction(_142.getXml)){_143=com.ibm.mashups.enabler.xml.XPath.evaluateString(this._DEFAULT_TITLE,_142.getXml(),this.ns);}if(!_143){var _144=this.getLocale(_142);if(_144){_143=_142.getTitle(_144);}}return _143||null;},getDescription:function(_145){if(typeof _145=="undefined"||_145===null){return null;}var _146;if(this.basicFallback&&dojo.isFunction(_145.getXml)){_146=com.ibm.mashups.enabler.xml.XPath.evaluateString(this._DEFAULT_DESCRIPTION,_145.getXml(),this.ns);}if(!_146){var _147=this.getLocale(_145);if(_147){_146=_145.getDescription(_147);}}return _146||null;},getDisplayLocale:function(_148){var _149=dojo.isArray(_148)?_148:[_148];if(ibmConfig&&ibmConfig.displayLocale){var _14a=ibmConfig.displayLocale.split(",");com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(_14a);for(var i=0;i<_14a.length;i++){var _14b=_14a[i];if(_14b){var _14c=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(_14b,_149);if(_14c){return _14b;}}}}return _149[0];}});}if(!dojo._hasResource["com.ibm.mashups.enabler.context.LocalizedContext"]){dojo._hasResource["com.ibm.mashups.enabler.context.LocalizedContext"]=true;dojo.provide("com.ibm.mashups.enabler.context.LocalizedContext");}if(!dojo._hasResource["com.ibm.mashups.enabler.context.PageContext_API"]){dojo._hasResource["com.ibm.mashups.enabler.context.PageContext_API"]=true;dojo.provide("com.ibm.mashups.enabler.context.PageContext_API");dojo.provide("com.ibm.mashups.enabler.context.PageContext");dojo.declare("com.ibm.mashups.enabler.context.PageContext",null,{setBrowserTitle:function(_14d){}});}if(!dojo._hasResource["com.ibm.mm.enabler.context.PageContextImpl"]){dojo._hasResource["com.ibm.mm.enabler.context.PageContextImpl"]=true;dojo.provide("com.ibm.mm.enabler.context.PageContextImpl");dojo.declare("com.ibm.mm.enabler.context.PageContextImpl",[com.ibm.mashups.enabler.context.PageContext],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.context.PageContextImpl");this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},setBrowserTitle:function(_14e){var _14f="setBrowserTitle(title)";var _150=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_150){this.LOGGER.entering(_14f,[_14e]);}dojo.doc.title=_14e;if(_150){this.LOGGER.exiting(_14f,[dojo.doc.title]);}}});com.ibm.mm.enabler.context.PageContext=new com.ibm.mm.enabler.context.PageContextImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.context.PageContext"]){dojo._hasResource["com.ibm.mashups.enabler.context.PageContext"]=true;dojo.provide("com.ibm.mashups.enabler.context.PageContext");}if(!dojo._hasResource["com.ibm.mashups.enabler.context.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.context.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.context.Factory_API");dojo.provide("com.ibm.mashups.enabler.context.Factory");dojo.declare("com.ibm.mashups.enabler.context.Factory",null,{getLocalizedContext:function(){},getLocalizedContext:function(_151,_152){},getPageContext:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.context.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.context.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.context.FactoryImpl");dojo.declare("com.ibm.mm.enabler.context.FactoryImpl",[com.ibm.mashups.enabler.context.Factory],{constructor:function(){},getLocalizedContext:function(_153,_154){return new com.ibm.mm.enabler.context.LocalizedContextImpl(_153,_154);},getPageContext:function(){return new com.ibm.mm.enabler.context.PageContextImpl();}});com.ibm.mashups.enabler.context.Factory=new com.ibm.mm.enabler.context.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.context.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.context.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.context.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.services.ConfigObject_API"]){dojo._hasResource["com.ibm.mashups.enabler.services.ConfigObject_API"]=true;dojo.provide("com.ibm.mashups.enabler.services.ConfigObject_API");dojo.provide("com.ibm.mashups.enabler.services.ConfigObject");dojo.declare("com.ibm.mashups.enabler.services.ConfigObject",null,{getValue:function(name){return null;},getValueDeferred:function(name){return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.services.ConfigObjectDefaultImpl"]){dojo._hasResource["com.ibm.mm.enabler.services.ConfigObjectDefaultImpl"]=true;dojo.provide("com.ibm.mm.enabler.services.ConfigObjectDefaultImpl");dojo.declare("com.ibm.mm.enabler.services.ConfigObjectDefaultImpl",[com.ibm.mashups.enabler.services.ConfigObject],{constructor:function(_155,_156){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.provider=_155;this.configService=_156;this.ns={};this.ns.app="http://www.w3.org/2007/app";this.ns.atom="http://www.w3.org/2005/Atom";},getPreferenceValue:function(name){if(this.provider=="all"){return this.configService.getValue(name);}else{return this._getValue(this.provider,name);}return null;},getValue:function(name){if(this.provider=="all"){return this.configService.getValue(name,internal);}else{return this._getValue(this.provider,name);}return null;},_getValue:function(_157,name){return null;},getValueDeferred:function(name){if(this.provider=="all"){return new com.ibm.mm.enabler.DeferredImpl(this,function(_158,sync,name){var _159=_158.getFinishedCallback();var _15a=this.configService.getValue(name,internal);if(_15a&&_159){_159(_15a,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_158.getFinishedCallbackParameters());}return _15a;});}else{return this._getValueDeferred(this.provider,name);}},_getValueDeferred:function(_15b,name){return null;}});if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"Base")>=0)){dojo["require"]("com.ibm.mm.enabler.services.ConfigObjectExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.enabler.services.ConfigObject"]){dojo._hasResource["com.ibm.mashups.enabler.services.ConfigObject"]=true;dojo.provide("com.ibm.mashups.enabler.services.ConfigObject");}if(!dojo._hasResource["com.ibm.mm.enabler.services.ConfigObjectExtendedImpl"]){dojo._hasResource["com.ibm.mm.enabler.services.ConfigObjectExtendedImpl"]=true;dojo.provide("com.ibm.mm.enabler.services.ConfigObjectExtendedImpl");dojo.declare("com.ibm.mm.enabler.services.ConfigObjectExtendedImpl",[com.ibm.mm.enabler.services.ConfigObjectDefaultImpl],{constructor:function(_15c,_15d){this.valuesArray=null;this.provider=_15c;this.configService=_15d;},_getValue:function(_15e,name){if(!this.valuesArray){this._loadConfigData(_15e);}return this.valuesArray[name];},_getValueDeferred:function(_15f,name){return new com.ibm.mm.enabler.DeferredImpl(this,function(_160,sync,name){var _161=_160.getFinishedCallback();if(!this.valuesArray){dojo["require"]("com.ibm.mashups.enabler.xml.XPath");dojo["require"]("com.ibm.mashups.enabler.model.url.ModelUrlFactory");dojo["require"]("com.ibm.mm.enabler.services.ModelRestServiceRequest");var _162="ConfigProvider."+_15f;var _163=ibmConfig[_162];if((typeof _163!="undefined")||(_163!==null)){_15f=_163;}var _164=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.CONFIG_URL,this);_164.setSchemeSpecificPart("/"+_15f+"/*");var _165=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_164,null,null,false,sync);var me=this;_165.read(function(type,data,xhr,args){if(!me.valuesArray){me.valuesArray={};}var _166=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("//atom:entry/atom:content/preferences/root/node/map/*",data,me.ns);if(_166&&_166.length>0){for(var i=0;i<_166.length;i++){var key=_166[i].getAttribute("key");var _167=_166[i].getAttribute("value");me.valuesArray[key]=_167;}}if(me.valuesArray[name]&&_161){_161(me.valuesArray[name],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_160.getFinishedCallbackParameters());}});}else{if(this.valuesArray[name]&&_161){_161(this.valuesArray[name],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_160.getFinishedCallbackParameters());}}return this.valuesArray&&this.valuesArray[name];},name);},_loadConfigData:function(_168){dojo["require"]("com.ibm.mashups.enabler.xml.XPath");dojo["require"]("com.ibm.mashups.enabler.model.url.ModelUrlFactory");dojo["require"]("com.ibm.mm.enabler.services.ModelRestServiceRequest");var _169="ConfigProvider."+_168;var _16a=ibmConfig[_169];if((typeof _16a!="undefined")||(_16a!==null)){_168=_16a;}var ret={};var _16b=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.CONFIG_URL,this);_16b.setSchemeSpecificPart("/"+_168+"/*");var _16c=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_16b,null,null,false,true);var me=this;_16c.read(function(type,data,xhr,args){var _16d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("//atom:entry/atom:content/preferences/root/node/map/*",data,me.ns);if(_16d&&_16d.length>0){for(var i=0;i<_16d.length;i++){var name=_16d[i].getAttribute("key");var _16e=_16d[i].getAttribute("value");ret[name]=_16e;}}});this.valuesArray=ret;}});}if(!dojo._hasResource["com.ibm.mashups.services.ServiceManager_API"]){dojo._hasResource["com.ibm.mashups.services.ServiceManager_API"]=true;dojo.provide("com.ibm.mashups.services.ServiceManager_API");dojo.provide("com.ibm.mashups.services.ServiceManager");dojo.declare("com.ibm.mashups.services.ServiceManager",null,{constructor:function(){},getService:function(_16f){}});}if(!dojo._hasResource["com.ibm.mashups.services.ServiceManager"]){dojo._hasResource["com.ibm.mashups.services.ServiceManager"]=true;dojo.provide("com.ibm.mashups.services.ServiceManager");}if(!dojo._hasResource["com.ibm.mm.services.ServiceManagerImpl"]){dojo._hasResource["com.ibm.mm.services.ServiceManagerImpl"]=true;dojo.provide("com.ibm.mm.services.ServiceManagerImpl");dojo.declare("com.ibm.mm.services.ServiceManagerImpl",com.ibm.mashups.services.ServiceManager,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this._serviceEntries={};ibmConfig=ibmConfig||{};ibmConfig.additionalServices=ibmConfig.additionalServices||null;if(ibmConfig.additionalServices){var _170=dojo.fromJson(ibmConfig.additionalServices);for(var i in _170){if(Object.prototype.hasOwnProperty.call(_170,i)){var _171=_170[i];this._serviceEntries[_171.name]=_171;}}}},getService:function(_172){var _173=this._serviceEntries[_172];_173=_173||null;if(_173!==null){var _174=_173.serviceHandler;_174=_174||null;if(_174===null){_174=this._createService(_173);_174=_174||null;if(_174===null){this._loadScript(_173);}else{this._serviceEntries[_172].serviceHandler=_174;}}}return this._serviceEntries[_172].serviceHandler;},setService:function(_175,_176){_176=_176||null;if(_176===null){return null;}var _177=this._serviceEntries[_175];_177=_177||null;if(_177!==null){delete this._serviceEntries[_175];}if(!this._serviceEntries[_175]){this._serviceEntries[_175]={};}if(dojo.isString(_176)){this._serviceEntries[_175].baseClass=_176;}else{this._serviceEntries[_175].serviceHandler=_176;}},_loadScript:function(_178){var me=this;dojo.xhrGet({url:_178.path,handleAs:"text",sync:true,load:function(_179){dojo.eval(_179);var _17a=me._createService(_178);if(typeof _17a!="undefined"&&_17a!==null){var _17b=_178.name;_178.serviceHandler=_17a;}},error:function(data,_17c){this.LOGGER.severe("_loadScript","error loading service:"+_178.name,data);}});},_createService:function(_17d){var _17e=null;try{_17e=new (dojo.getObject(_17d.baseClass))();}catch(err){}return _17e;}});com.ibm.mashups.services.ServiceManager=new com.ibm.mm.services.ServiceManagerImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.services.ConfigService_API"]){dojo._hasResource["com.ibm.mashups.enabler.services.ConfigService_API"]=true;dojo.provide("com.ibm.mashups.enabler.services.ConfigService_API");dojo.provide("com.ibm.mashups.enabler.services.ConfigService");dojo.declare("com.ibm.mashups.enabler.services.ConfigService",null,{SERVICE_NAME:"configService",getValue:function(name){return null;},getConfigObject:function(name){return null;},getConfigProviderNames:function(){return null;}});com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME="configService";}if(!dojo._hasResource["com.ibm.mashups.enabler.services.ConfigService"]){dojo._hasResource["com.ibm.mashups.enabler.services.ConfigService"]=true;dojo.provide("com.ibm.mashups.enabler.services.ConfigService");}if(!dojo._hasResource["com.ibm.mm.enabler.services.AbstractConfigServiceImpl"]){dojo._hasResource["com.ibm.mm.enabler.services.AbstractConfigServiceImpl"]=true;dojo.provide("com.ibm.mm.enabler.services.AbstractConfigServiceImpl");dojo.declare("com.ibm.mm.enabler.services.AbstractConfigServiceImpl",com.ibm.mashups.enabler.services.ConfigService,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);},getPreferenceValue:function(name){return this.getValue(name);},getValue:function(name,_17f){if(typeof _17f=="undefined"){this.LOGGER.warning("com.ibm.mm.enabler.services.ConfigService.getValue","This method must not be used directly. Use com.ibm.mashups.enabler.services.ConfigService.getValue instead.  name: ${0}",[name]);}var _180=ibmConfig[name];return _180;},getConfigObject:function(_181){return null;},getConfigProviderNames:function(){return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.services.ConfigServiceDefaultImpl"]){dojo._hasResource["com.ibm.mm.enabler.services.ConfigServiceDefaultImpl"]=true;dojo.provide("com.ibm.mm.enabler.services.ConfigServiceDefaultImpl");dojo.declare("com.ibm.mm.enabler.services.ConfigServiceDefaultImpl",[com.ibm.mm.enabler.services.AbstractConfigServiceImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.services.ConfigServiceDefaultImpl");},_getConfigObject:function(_182){if(!ibmConfig["CO_"+_182]){var co=new com.ibm.mm.enabler.services.ConfigObjectDefaultImpl(_182,this);ibmConfig["CO_"+_182]=co;}return ibmConfig["CO_"+_182];},_getConfigProviderNames:function(){var ret=[];ret.push("all");return ret;},getValue:function(name){var _183="getValue(name)";var _184=this.LOGGER.isLoggable(com.ibm.mashups.enabler.logging.LogLevel.TRACE);if(_184){this.LOGGER.entering(_183,name);}var ret=this.inherited(arguments,[name,true]);if(_184){this.LOGGER.exiting(_183,ret);}return ret;},getConfigObject:function(name){var _185="getConfigObject(name)";var _186=this.LOGGER.isLoggable(com.ibm.mashups.enabler.logging.LogLevel.TRACE);if(_186){this.LOGGER.entering(_185,name);}var ret=this._getConfigObject(name);if(_186){this.LOGGER.exiting(_185,ret);}return ret;},getConfigProviderNames:function(){var _187="getConfigProviderNames()";var _188=this.LOGGER.isLoggable(com.ibm.mashups.enabler.logging.LogLevel.TRACE);if(_188){this.LOGGER.entering(_187,name);}var ret=this._getConfigProviderNames();if(_188){this.LOGGER.exiting(_187,ret);}return ret;}});com.ibm.mashups.services.ServiceManager.setService("configService","com.ibm.mm.enabler.services.ConfigServiceDefaultImpl");if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"Base")>=0)){dojo["require"]("com.ibm.mm.enabler.services.ConfigServiceExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.enabler.services.ConfigConstants"]){dojo._hasResource["com.ibm.mashups.enabler.services.ConfigConstants"]=true;dojo.provide("com.ibm.mashups.enabler.services.ConfigConstants");dojo.declare("com.ibm.mashups.enabler.services.ConfigConstants",null,{PROXY_URL:"com.ibm.mashups.proxy.url",HUB_URL:"com.ibm.mashups.hub.url",LOGIN_URL:"com.ibm.mashups.url.login",LOGOUT_URL:"com.ibm.mashups.url.logout",CONTEXT_ROOT:"com.ibm.mashups.contextroot",CONTEXT_ROOT_ENABLER:"com.ibm.mashups.contextroot.enabler",CONTEXT_ROOT_BUILDER:"com.ibm.mashups.contextroot.builder",CONTENTHANDLER_PUBLIC:"com.ibm.mashups.contenthandler.public",CONTENTHANDLER_PRIVATE:"com.ibm.mashups.contenthandler.private",EMBEDDING_PUBLIC:"com.ibm.mashups.embedding.public",EMBEDDING_PRIVATE:"com.ibm.mashups.embedding.private",THEMES_FEEDS_EXPIRATION:"themes.feed.expiration",AVAILABLE_LOCALES:"availableLocales",DEFAULT_LOCALE:"default.locale",DISPLAY_LOCALE:"displayLocale",TUNNEL_MODE:"tunnel.mode",CLIENT_IS_DEBUG:"isDebug",CLIENT_IS_BIDI:"isBidi",WIDGETDEFID_SANDBOX_DISABLED:"com.ibm.mashups.sandbox.force.disable",TRACE_CONFIG:"traceConfig",CLIENT_POPUP_CONSOLE:"popupConsole",CLIENT_ALLOW_PUBLISH_LOGGING:"allowPublishLogging",CLIENT_ALLOW_PUBLISH_TRACING:"allowPublishTracing",CLIENT_ADDITIONAL_SERVICES:"additionalServices",CLIENT_DEFAULT_THEME_ID:"com.ibm.mashups.theme.defaultThemeId",CLIENT_PAGE_SOURCE_READ_ONLY:"pageSourceReadOnly",CLIENT_AUTO_ACCEPT_SHARED_GROUPNAME:"autoAcceptSharedGroupName",AUTO_WIRING_DEFAULT_ENABLED:"autoWiringDefaultEnabled",CLIENT_USER_ID_KEY:"userIdKey",CLIENT_GROUP_CN_KEY:"groupCNKey",SERVICE_DOCUMENT_URL:"serviceDocumentUrl",MULTIPART_ENABLED:"com.ibm.mashups.multipart.enabled",MULTIPART_CORRELATE_HOSTS:"com.ibm.mashups.multipart.correlatehosts",MULTIPART_CACHE_QUERIES:"com.ibm.mashups.multipart.cachequeries",ENDPOINTS:"endpointIDs",ENDPOINT_CONFIG_PROVIDER:"Endpoints",ANONYMOUS_USER:"anonymousUser",NAVIGATION_HIDDEN:"com.ibm.mashups.navigation.hidden",SPACE_HIDDEN:"com.ibm.mashups.space.hidden",USER:"user",SUBDOMAINS:"subdomains",SERVERDOMAIN:"serverdomain",SANDBOXENABLED:"sandboxenabled",SUBDOMAINREUSE:"subdomainreuse",NAVSTATE_PERSISTENCE_URL:"navstate.persistence.url",NAVSTATE_PERSISTENCE_PSTORE:"navstate.persistence.pstore",NAVSTATE_PERSISTENCE_URL_LIMIT:"navstate.persistence.url.limit",NAVSTATE_PERSISTENCE_URL_SPLIMIT:"navstate.persistence.url.splimit",NAVSTATE_HUFFMANNENCODE_ENABLED:"navstate.huffmannencode.enabled",LOADING_HTML:"loadingHTML",PAGE_LOAD_OPTIMIZATION:"pageLoadOptimization",PAGE_LOAD_OPTIMIZATION_THEME:"pageLoadOptimizationTheme",PAGE_LOAD_OPTIMIZATION_APP_WIDGETS:"pageLoadOptimizationAppWidgets",ANONYMOUS_ALLOW_CREATE:"com.ibm.mashups.anonymous.allow.create",DEFAULT_USER_DISPLAY_PROP:"com.ibm.mashups.default.user.display.prop",PRODUCT_NAME:"com.ibm.mashups.productname",DEFAULT_GROUP_DISPLAY_PROP:"com.ibm.mashups.default.group.display.prop",WELCOME_SPACE_ID:"com.ibm.mashups.welcome.space.name",BUILDER_TITLE_FILTER_REGEXP:"com.ibm.mashups.builder.filter.title.regexp",ANON_VIRTUAL_USER_ID:"com.ibm.mashups.anonUserId",ALL_AUTH_VIRTUAL_GROUP_ID:"com.ibm.mashups.allAuthGroupId",SERVER_TYPE:"com.ibm.mashups.server",SERVER_TYPE_MASHUPS:"Lotus_Mashups",SERVER_TYPE_PORTAL:"WebSphere_Portal",SERVER_TYPE_BSPACE:"Business_Space",ANON_MODE_ENABLED:"com.ibm.mashups.anonymous.mode",AUTO_WILDCARD_DISABLED:"com.ibm.mashups.autoWildcardSearchDisabled",CONTEXT_MENU_NAME:"com.ibm.mashups.contextmenu.name",WIDGET_BUILDER_ENABLED:"com.ibm.mashups.widgetBuilder.enabled",CREATE_SPACE_TEMPLATE_MODE:"createSpaceOnTemplateMode",FAVORITE_SPACES_MAXIMUM_NUMBER:"favorite.spaces.maximum.number",RECENT_SPACES_MAXIMUM_NUMBER:"recent.spaces.maximum.number",REGISTER_LOADEDRESOURCES:"register.loadedresources",PERSISTENCE_MODE:"com.ibm.mashups.enabler.icontext.persistence.mode",ICONTEXT_AUTO_COMMIT:"com.ibm.mashups.enabler.icontext.autocommit",ID_PREFIX:"com.ibm.mashups.iWidget.idPrefix",API_ENFORCEMENT_MODE:"com.ibm.mashups.enabler.enforcement",API_ENFORCEMENT_MODE_WARN:"warning",API_ENFORCEMENT_MODE_ERROR:"error",NON_PREVIEWABLE_WIDGET_LOCATION:"com.ibm.mashups.enabler.layout.widget.NonPreviewableContentWidget.location",LOCALAPPS_REGEX:"com.ibm.mashups.multipart.localapps.regex",LIMIT_PAGE_DESCRIPTION:"com.ibm.mashups.persistence.page.description.limit"});com.ibm.mashups.enabler.services.ConfigConstants=new com.ibm.mashups.enabler.services.ConfigConstants();}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.Strategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.Strategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.Strategy");dojo.declare("com.ibm.mashups.enabler.strategy.Strategy",null,{});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.Model_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.Model_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.Model_API");dojo.provide("com.ibm.mashups.enabler.model.Model");dojo.declare("com.ibm.mashups.enabler.model.Model",null,{setStrategy:function(_189){},getStrategies:function(){},getStrategy:function(_18a){},addStrategy:function(_18b){},removeStrategy:function(_18c){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.Model"]){dojo._hasResource["com.ibm.mashups.enabler.model.Model"]=true;dojo.provide("com.ibm.mashups.enabler.model.Model");}if(!dojo._hasResource["com.ibm.mm.enabler.utils.Misc"]){dojo._hasResource["com.ibm.mm.enabler.utils.Misc"]=true;dojo.provide("com.ibm.mm.enabler.utils.Misc");com.ibm.mm.enabler.utils.Misc={LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.utils.Misc"),forIn:function(obj,func,_18d){if(!obj||typeof obj!="object"){return;}_18d=_18d||null;var item;for(var idx in obj){if(Object.prototype.hasOwnProperty.call(obj,idx)){item=obj[idx];dojo.hitch(_18d,func)(item,idx,obj);}}},encodePath:function(path,_18e){if(path.length===0){return path;}var _18f=path.split("/");for(var i=0;i<_18f.length;++i){_18f[i]=_18e?com.ibm.mm.enabler.utils.Misc._pathPartUnescape(_18f[i]):com.ibm.mm.enabler.utils.Misc._pathPartEscape(com.ibm.mm.enabler.utils.Misc._pathPartUnescape(_18f[i]));}return _18f.join("/");},_pathPartUnescape:function(_190){_190=decodeURIComponent(_190);return _190;},_pathPartEscape:function(_191){_191=encodeURIComponent(_191);_191=_191.replace(/%3a/g,":");_191=_191.replace(/%3A/g,":");return _191;},inStringArray:function(str,_192){var rc=false;for(var i in _192){if(Object.prototype.hasOwnProperty.call(_192,i)){var _193=_192[i];if(_193==str){rc=true;break;}}}return rc;},isEmpty:function(_194){for(var i in _194){if(Object.prototype.hasOwnProperty.call(_194,i)){return false;}}return dojo.isString(_194)?_194.length===0:true;},encodeModelID4Uri:function(uri){var pos=uri.indexOf(":");if(pos!=-1){var _195=uri.slice(0,pos+1);var end=uri.slice(pos+1);uri=_195+encodeURIComponent(end);}return encodeURIComponent(uri);},preloadImage:function(path,_196,_197){var _198=(_196&&_197)?new Image(_196,_197):new Image();_198.src=path;return _198;},isInstanceOf:function(obj1,obj2){if(obj1&&obj2){if(typeof obj1.isInstanceOf=="function"){if(obj1.isInstanceOf(obj2)){return true;}}return (obj1 instanceof obj2);}return false;},isPocUrl:function(_199){var _19a={http:"http",https:"https",file:"file"};var rc=false;if(_199.indexOf(":")>0){if(_199.indexOf("/")===0){return false;}if(_199.indexOf("?")===0){return false;}var _19b=_199.substring(0,_199.indexOf(":"));if(!_19a[_19b]){rc=true;}}return rc;}};}if(!dojo._hasResource["com.ibm.mm.enabler.model.ModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.ModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.ModelImpl");dojo.declare("com.ibm.mm.enabler.model.ModelImpl",com.ibm.mashups.enabler.model.Model,{strategy:null,constructor:function(){this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");},_is25:function(){return com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_5===com.ibm.mm.enabler.model.ModelImpl._getModelRuntime();},setStrategy:function(_19c){if(_19c===null||typeof _19c=="undefined"){this.strategy=null;}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_19c,Array)){if(_19c.length>0){this.strategy=[];dojo.forEach(_19c,function(item,idx,arr){this.push(item);},this.strategy);}}else{this.strategy=[_19c];}}},getStrategies:function(){return this.strategy||[];},addStrategy:function(_19d){if(_19d===null||typeof _19d=="undefined"){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}if(null===this.strategy){this.strategy=[];}for(var i=0,l=this.strategy.length;i<l;i++){if(this.strategy[i].declaredClass){if(_19d instanceof (dojo.getObject(this.strategy[i].declaredClass))){this.strategy[i]=_19d;return i;}}}return (this.strategy.push(_19d)-1);},removeStrategy:function(s){if(s===null||typeof s=="undefined"){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}if(!this.strategy){return;}else{if(dojo.isString(s)){s=this._getIndexOfStrategyByType(s);}}if(!isNaN(s)&&(s<this.strategy.length)&&(s>=0)){this.strategy.splice(s,1+s);}},getStrategy:function(s){if(!this.strategy){return null;}else{if(dojo.isString(s)){return this._findStrategyByType(s);}else{if(!isNaN(s)&&(s<this.strategy.length)&&(s>=0)){return this.strategy[s];}else{return null;}}}},_findStrategyByType:function(type){var i=this._getIndexOfStrategyByType(type);return i>=0?this.strategy[i]:null;},_getIndexOfStrategyByType:function(type){if(this.strategy){for(var i=0,l=this.strategy.length;i<l;i++){if(this.strategy[i].declaredClass){if(type==this.strategy[i].declaredClass){return i;}}}}return -1;}});com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_0=2;com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_5=2.5;com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_DEFAULT=com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_0;com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_CURRENT=null;com.ibm.mm.enabler.model.ModelImpl._getModelRuntime=function(){if(com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_CURRENT===null&&ibmConfig&&ibmConfig.isCSA2){return com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_5;}return com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_CURRENT||com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_DEFAULT;};com.ibm.mm.enabler.model.ModelImpl._setModelRuntime=function(_19e){com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_CURRENT=_19e;};com.ibm.mm.enabler.model.ModelImpl._resetModelRuntime=function(){var def=com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_DEFAULT;if(ibmConfig&&ibmConfig.isCSA2){def=com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_5;}com.ibm.mm.enabler.model.ModelImpl._setModelRuntime(def);};}if(!dojo._hasResource["com.ibm.mm.enabler.services.ModelRestServiceRequest"]){dojo._hasResource["com.ibm.mm.enabler.services.ModelRestServiceRequest"]=true;dojo.provide("com.ibm.mm.enabler.services.ModelRestServiceRequest");dojo.declare("com.ibm.mm.enabler.services.ModelRestServiceRequest",null,{REQUEST_METHOD_POST:"POST",REQUEST_METHOD_PUT:"PUT",REQUEST_METHOD_DELETE:"DELETE",POST_ACTION_HEADER:"X-Method-Override",MODIFICATION_COOKIE:"modified.id",constructor:function(_19f,_1a0,_1a1,_1a2,sync){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _1a3="constructor";var _1a4=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1a4){this.LOGGER.entering(_1a3,arguments);}if(com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.getXRequestDigest()){_19f.setParameter("digest",com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.getXRequestDigest());}this._feedURI=_19f.toProxifiedString();this._textOnly=_1a2;this._sync=sync;this._formNode=_1a0;this._formFilter=_1a1;this._config=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);if(!this._sync){this._sync=false;}if(_1a4){this.LOGGER.exiting(_1a3);}},create:function(feed,_1a5,_1a6){var _1a7="create";var _1a8=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1a8){this.LOGGER.entering(_1a7,arguments);this.LOGGER.trace(_1a7,"Attempting to create: "+this._feedURI+"; synchronously? "+this._sync);}this._updateCookie();var me=this;var args={url:this._feedURI,headers:{"Content-Type":"application/atom+xml; charset=utf-8","X-IBM-XHR":"true"},load:function(_1a9,_1aa){var xhr=_1aa.xhr;var data=_1a9;var xrd=xhr.getResponseHeader("X-Request-Digest");if(xrd!==null){com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.setXRequestDigest(xrd);}var _1ab=xhr.getResponseHeader("Content-Type");if(typeof _1ab!="undefined"&&_1ab!==null&&_1ab.indexOf("text/html")>=0){me._doLogin();return;}if(dojo.isIE){data=dojox.xml.parser.parse(xhr.responseText);}_1a5(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD,data,xhr,_1a6);},error:function(_1ac,_1ad){var xhr=_1ad.xhr;var _1ae=xhr.status;if(_1ae==401){me._doLogin();return;}_1a5(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR,null,xhr,_1a6);},sync:this._sync,postData:feed.toString(),handleAs:"xml"};dojo.rawXhrPost(args);if(_1a8){this.LOGGER.exiting(_1a7);}},read:function(_1af,_1b0){var _1b1="read";var _1b2=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1b2){this.LOGGER.entering(_1b1,arguments);}if(this._textOnly){this._retrieveRawFeed(_1af,_1b0);}else{this._retrieve(_1af,_1b0);}if(_1b2){this.LOGGER.exiting(_1b1);}},update:function(feed,_1b3,_1b4){var _1b5="update";var _1b6=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1b6){this.LOGGER.entering(_1b5,arguments);this.LOGGER.trace(_1b5,"Attempting to update: "+this._feedURI+"; synchronously? "+this._sync);}this._updateCookie();var me=this;var args={url:this._feedURI,load:function(_1b7,_1b8){var xhr=_1b8.xhr;var xrd=xhr.getResponseHeader("X-Request-Digest");if(xrd!==null){com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.setXRequestDigest(xrd);}var _1b9=xhr.getResponseHeader("Content-Type");if(typeof _1b9!="undefined"&&_1b9!==null&&_1b9.indexOf("text/html")>=0){me._doLogin();return;}dojo.partial(_1b3)(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD,_1b7,xhr,_1b4);},error:function(_1ba,_1bb){var xhr=_1bb.xhr;var _1bc=xhr.status;if(_1bc==401){me._doLogin();return;}dojo.partial(_1b3)(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR,null,xhr,_1b4);},sync:this._sync,handleAs:"xml"};var _1bd={"Content-Type":"application/atom+xml; charset=utf-8","X-IBM-XHR":"true"};if(com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.TUNNEL_MODE)===true){_1bd[this.POST_ACTION_HEADER]=this.REQUEST_METHOD_PUT;args.headers=_1bd;args.postData=feed;dojo.rawXhrPost(args);}else{args.putData=feed;args.headers=_1bd;dojo.rawXhrPut(args);}if(_1b6){this.LOGGER.exiting(_1b5);}},remove:function(_1be,_1bf){var _1c0="remove";var _1c1=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1c1){this.LOGGER.entering(_1c0,arguments);this.LOGGER.trace(_1c0,"Attempting to remove: "+this._feedURI+"; synchronously? "+this._sync);}this._updateCookie();var me=this;var args={url:this._feedURI,load:function(_1c2,_1c3){var type=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD;var data=_1c2;var xhr=_1c3.xhr;var xrd=xhr.getResponseHeader("X-Request-Digest");if(xrd!==null){com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.setXRequestDigest(xrd);}var _1c4=xhr.getResponseHeader("Content-Type");if(typeof _1c4!="undefined"&&_1c4!==null&&_1c4.indexOf("text/html")>=0){me._doLogin();return;}if(dojo.isIE){data=dojox.xml.parser.parse(xhr.responseText);}_1be(type,data,xhr,_1bf);},error:function(_1c5,_1c6){var xhr=_1c6.xhr;var _1c7=xhr.status;if(_1c7==401){me._doLogin();return;}_1be(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR,null,xhr,_1bf);},sync:this._sync,handleAs:"xml"};var _1c8={"Content-Type":"application/atom+xml","X-IBM-XHR":"true"};if(com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.TUNNEL_MODE)===true){_1c8[this.POST_ACTION_HEADER]=this.REQUEST_METHOD_DELETE;args.headers=_1c8;dojo.rawXhrPost(args);}else{args.headers=_1c8;dojo.xhrDelete(args);}if(_1c1){this.LOGGER.exiting(_1c0);}},_retrieveRawFeed:function(_1c9,_1ca){var _1cb="_retrieveRawFeed";var _1cc=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1cc){this.LOGGER.entering(_1cb,arguments);}dojo.xhrGet({url:this._feedURI,headers:{"X-IBM-XHR":"true"},load:function(data,_1cd){var xhr=_1cd.xhr;var xrd=xhr.getResponseHeader("X-Request-Digest");if(xrd!==null){com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.setXRequestDigest(xrd);}_1c9(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD,data,_1cd.xhr,_1ca);},error:function(data,_1ce){_1c9(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR,data,_1ce.xhr,_1ca);},sync:this._sync});if(_1cc){this.LOGGER.exiting(_1cb);}},_retrieve:function(_1cf,_1d0,_1d1,_1d2){var _1d3="_retrieve";var _1d4=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1d4){this.LOGGER.entering(_1d3,arguments);this.LOGGER.trace(_1d3,"Attempting to retrieve: "+this._feedURI+"; synchronously? "+this._sync);}var _1d5={};var mt="xml";if(dojo.isIE){mt="text";}var me=this;var args={url:this._feedURI,content:_1d5,headers:{"X-IBM-XHR":"true"},load:function(_1d6,_1d7){var data=_1d6;var xhr=_1d7.xhr;var xrd=xhr.getResponseHeader("X-Request-Digest");if(xrd!==null){com.ibm.mm.enabler.services.ModelRestServiceRequestStatic.setXRequestDigest(xrd);}var _1d8=xhr.getResponseHeader("Content-Type");if(typeof _1d8!="undefined"&&_1d8!==null&&_1d8.indexOf("text/html")>=0){me._doLogin();return;}if(dojo.isIE){var doc=com.ibm.mm.enabler.utils.Dom.createDocument(data);_1cf(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD,doc,xhr,_1d0);}else{_1cf(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD,data,xhr,_1d0);}},error:function(_1d9,_1da){var data=_1d9;var xhr=_1da.xhr;var _1db=xhr.status;if(_1db==401){me._doLogin();return;}if(dojo.isIE){var doc=null;try{if(data){doc=com.ibm.mm.enabler.utils.Dom.createDocument(data);}}catch(e){}_1cf(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR,doc,xhr,_1d0);}else{_1cf(com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR,data,xhr,_1d0);}},sync:this._sync,handleAs:mt};var _1dc="Get";if(this._formNode){args.form=this._formNode;_1dc="Post";}if(this._formFilter){args.formFilter=this._formFilter;}dojo["xhr"+_1dc](args);if(_1d4){this.LOGGER.exiting(_1d3);}},_updateCookie:function(){var dt=new Date();var _1dd={};_1dd.path=this._config.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);dojo.cookie(this.MODIFICATION_COOKIE,dt.getTime(),_1dd);},_doLogin:function(){dojo["require"]("com.ibm.mashups.enabler.model.state.NavigationStateModelFactory");dojo["require"]("com.ibm.mashups.enabler.model.state.UrlGeneratorFactory");var pid=null;var url=document.location.href;var cb=function(url){if(url){top.location.href=url;}};var _1de=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();com.ibm.mashups.enabler.model.state.UrlGeneratorFactory.getURLGenerator().getUrl(_1de,cb,{nohash:"true"});},toString:function(){return this._feedURI;}});com.ibm.mm.enabler.services.ModelRestServiceRequestStatic={xRequestDigest:null,getXRequestDigest:function(){return this.xRequestDigest;},setXRequestDigest:function(_1df){this.xRequestDigest=_1df;}};com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD="load";com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR="error";}if(!dojo._hasResource["com.ibm.mm.enabler.EndpointUtils"]){dojo._hasResource["com.ibm.mm.enabler.EndpointUtils"]=true;dojo.provide("com.ibm.mm.enabler.EndpointUtils");dojo.declare("com.ibm.mm.enabler.EndpointUtilsDefaultImpl",null,{constructor:function(){},checkForEndpoints:function(url){return null;}});com.ibm.mm.enabler.EndpointUtils=new com.ibm.mm.enabler.EndpointUtilsDefaultImpl();if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.enabler.EndpointUtilsExtendedImpl");}}if(!dojo._hasResource["com.ibm.mm.enabler.endpoints.XHREndpointExtensionImpl"]){dojo._hasResource["com.ibm.mm.enabler.endpoints.XHREndpointExtensionImpl"]=true;dojo.provide("com.ibm.mm.enabler.endpoints.XHREndpointExtensionImpl");dojo.declare("com.ibm.mm.enabler.endpoints.XHREndpointExtensionImpl",null,{LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_METHOD="dojo.xhrGet()";this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this.originalDojoXHR=dojo.xhr;dojo.xhr=dojo.hitch(this,function(_1e0,args,_1e1){if(this.bIsLoggable){this.LOGGER.entering(this.LOG_METHOD,[args]);}var url=args.url;var url2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(url);url2=url2||null;if(url2!==null){args.url=url2;}var ret=this.originalDojoXHR(_1e0,args,_1e1);if(this.bIsLoggable){this.LOGGER.exiting(this.LOG_METHOD);}return ret;});}});com.ibm.mm.enabler.endpoints.XHREndpointExtension=new com.ibm.mm.enabler.endpoints.XHREndpointExtensionImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.services.ConfigServiceExtendedImpl"]){dojo._hasResource["com.ibm.mm.enabler.services.ConfigServiceExtendedImpl"]=true;dojo.provide("com.ibm.mm.enabler.services.ConfigServiceExtendedImpl");dojo.declare("com.ibm.mm.enabler.services.ConfigServiceExtendedImpl",[com.ibm.mm.enabler.services.ConfigServiceDefaultImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.services.ConfigServiceExtendedImpl");},_getConfigObject:function(_1e2){if(!ibmConfig["CO_"+_1e2]){var co=new com.ibm.mm.enabler.services.ConfigObjectExtendedImpl(_1e2,this);ibmConfig["CO_"+_1e2]=co;}return ibmConfig["CO_"+_1e2];},_getConfigProviderNames:function(){dojo["require"]("com.ibm.mashups.enabler.model.url.ModelUrlFactory");var ret=[];ret.push("all");var _1e3=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.CONFIG_URL,this);_1e3.setSchemeSpecificPart("/*");_1e3.setParameter("rep","compact");var _1e4=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_1e3,null,null,false,true);var me=this;_1e4.read(function(type,data,xhr,args){var _1e5=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("//atom:entry/atom:id",data,me.ns);if(_1e5&&_1e5.length>0){for(var i=0,l=_1e5.length;i<l;i++){var _1e6=com.ibm.mm.enabler.utils.Dom.textContent(_1e5[i]);var _1e7=_1e6.indexOf("/",9);_1e6=_1e6.substring(8,_1e7).trim();for(var _1e8 in ibmConfig){if(ibmConfig[_1e8]===_1e6){_1e6=_1e8.substring(15);}}ret.push(_1e6);}}});return ret;}});com.ibm.mashups.services.ServiceManager.setService("configService","com.ibm.mm.enabler.services.ConfigServiceExtendedImpl");}if(!dojo._hasResource["com.ibm.mashups.enabler.Deferred_API"]){dojo._hasResource["com.ibm.mashups.enabler.Deferred_API"]=true;dojo.provide("com.ibm.mashups.enabler.Deferred_API");dojo.provide("com.ibm.mashups.enabler.Deferred");dojo.declare("com.ibm.mashups.enabler.Deferred",null,{setFinishedCallback:function(_1e9,_1ea){},start:function(sync){return {};}});}if(!dojo._hasResource["dojox.collections._base"]){dojo._hasResource["dojox.collections._base"]=true;dojo.provide("dojox.collections._base");dojox.collections.DictionaryEntry=function(k,v){this.key=k;this.value=v;this.valueOf=function(){return this.value;};this.toString=function(){return String(this.value);};};dojox.collections.Iterator=function(arr){var a=arr;var _1eb=0;this.element=a[_1eb]||null;this.atEnd=function(){return (_1eb>=a.length);};this.get=function(){if(this.atEnd()){return null;}this.element=a[_1eb++];return this.element;};this.map=function(fn,_1ec){return dojo.map(a,fn,_1ec);};this.reset=function(){_1eb=0;this.element=a[_1eb];};};dojox.collections.DictionaryIterator=function(obj){var a=[];var _1ed={};for(var p in obj){if(!_1ed[p]){a.push(obj[p]);}}var _1ee=0;this.element=a[_1ee]||null;this.atEnd=function(){return (_1ee>=a.length);};this.get=function(){if(this.atEnd()){return null;}this.element=a[_1ee++];return this.element;};this.map=function(fn,_1ef){return dojo.map(a,fn,_1ef);};this.reset=function(){_1ee=0;this.element=a[_1ee];};};}if(!dojo._hasResource["dojox.collections.ArrayList"]){dojo._hasResource["dojox.collections.ArrayList"]=true;dojo.provide("dojox.collections.ArrayList");dojox.collections.ArrayList=function(arr){var _1f0=[];if(arr){_1f0=_1f0.concat(arr);}this.count=_1f0.length;this.add=function(obj){_1f0.push(obj);this.count=_1f0.length;};this.addRange=function(a){if(a.getIterator){var e=a.getIterator();while(!e.atEnd()){this.add(e.get());}this.count=_1f0.length;}else{for(var i=0;i<a.length;i++){_1f0.push(a[i]);}this.count=_1f0.length;}};this.clear=function(){_1f0.splice(0,_1f0.length);this.count=0;};this.clone=function(){return new dojox.collections.ArrayList(_1f0);};this.contains=function(obj){for(var i=0;i<_1f0.length;i++){if(_1f0[i]==obj){return true;}}return false;};this.forEach=function(fn,_1f1){dojo.forEach(_1f0,fn,_1f1);};this.getIterator=function(){return new dojox.collections.Iterator(_1f0);};this.indexOf=function(obj){for(var i=0;i<_1f0.length;i++){if(_1f0[i]==obj){return i;}}return -1;};this.insert=function(i,obj){_1f0.splice(i,0,obj);this.count=_1f0.length;};this.item=function(i){return _1f0[i];};this.remove=function(obj){var i=this.indexOf(obj);if(i>=0){_1f0.splice(i,1);}this.count=_1f0.length;};this.removeAt=function(i){_1f0.splice(i,1);this.count=_1f0.length;};this.reverse=function(){_1f0.reverse();};this.sort=function(fn){if(fn){_1f0.sort(fn);}else{_1f0.sort();}};this.setByIndex=function(i,obj){_1f0[i]=obj;this.count=_1f0.length;};this.toArray=function(){return [].concat(_1f0);};this.toString=function(_1f2){return _1f0.join((_1f2||","));};};}if(!dojo._hasResource["com.ibm.mm.enabler.DeferredImpl"]){dojo._hasResource["com.ibm.mm.enabler.DeferredImpl"]=true;dojo.provide("com.ibm.mm.enabler.DeferredImpl");dojo.declare("com.ibm.mm.enabler.DeferredImpl",[com.ibm.mashups.enabler.Deferred],{_chainedDeferred:null,_sync:false,_previous:null,constructor:function(_1f3,_1f4,_1f5){this.context=_1f3;this.startfn=_1f4;this.params=_1f5;},addErrorCallback:function(_1f6,_1f7){dojo.deprecated("com.ibm.mashups.enabler.Deferred.addErrorCallback()","use com.ibm.mashups.enabler.Deferred.setFinishedCallback() instead");this.errorCallback=_1f6;this.errorCallbackParameters=_1f7;},addFinishedCallback:function(_1f8,_1f9){dojo.deprecated("com.ibm.mashups.enabler.Deferred.addErrorCallback()","use com.ibm.mashups.enabler.Deferred.setFinishedCallback() instead");this.finishedCallback=_1f8;this.finishedCallbackParameters=_1f9;},setFinishedCallback:function(_1fa,_1fb){this.finishedCallback2=_1fa;this.finishedCallbackParameters2=_1fb;return this;},start:function(sync,_1fc){this._sync=(sync||typeof (sync)=="undefined");var ret=null;if(dojo.isFunction(this.startfn)){ret=dojo.hitch(this.context||null,this.startfn)(this,this._sync,this.params,_1fc||null);}return ret;},getFinishedCallback:function(){return this.finishedCallback2;},getFinishedCallbackParameters:function(){return this.finishedCallbackParameters2;},setChainedDeferred:function(_1fd){this._chainedDeferred=_1fd;},getChainedDeferred:function(){return this._chainedDeferred;},getPrevious:function(){return this._previous;},_setPreviousDeferred:function(_1fe,_1ff,_200){this._previous={deferred:_1fe,result:_1ff,status:_200};},removeChainedDeferred:function(){this._chainedDeferred=null;},finish:function(_201,_202){if(dojo.isFunction(this.getFinishedCallback())){dojo.partial(this.getFinishedCallback())(_201,_202,this.getFinishedCallbackParameters());}else{if(dojo.isFunction(this.finishedCallback)&&(""+_202).indexOf("2")===0){dojo.partial(this.finishedCallback)(_201,this.finishedCallbackParameters);}else{if(dojo.isFunction(this.errorCallback)&&_202>=400){dojo.partial(this.errorCallback)(_201,this.errorCallbackParameters);}}}if(this._chainedDeferred){this._chainedDeferred._setPreviousDeferred(this,_201,_202);this._chainedDeferred.start(this._sync);}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Deferred"]){dojo._hasResource["com.ibm.mashups.enabler.Deferred"]=true;dojo.provide("com.ibm.mashups.enabler.Deferred");dojo.require("com.ibm.mm.enabler.DeferredImpl");}if(!dojo._hasResource["com.ibm.mashups.enabler.Commitable"]){dojo._hasResource["com.ibm.mashups.enabler.Commitable"]=true;dojo.provide("com.ibm.mashups.enabler.Commitable");dojo.declare("com.ibm.mashups.enabler.Commitable",null,{isDirty:function(){return false;},commit:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Iterator"]){dojo._hasResource["com.ibm.mashups.enabler.Iterator"]=true;dojo.provide("com.ibm.mashups.enabler.Iterator");dojo.declare("com.ibm.mashups.enabler.Iterator",null,{hasNext:function(){},next:function(){},size:function(){},setCursorPosition:function(_203){},getCursorPosition:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.DeferredIterator_API"]){dojo._hasResource["com.ibm.mashups.enabler.DeferredIterator_API"]=true;dojo.provide("com.ibm.mashups.enabler.DeferredIterator_API");dojo.provide("com.ibm.mashups.enabler.DeferredIterator");dojo.declare("com.ibm.mashups.enabler.DeferredIterator",[com.ibm.mashups.enabler.Deferred,com.ibm.mashups.enabler.Iterator],{setForEachCallback:function(_204,_205){}});}if(!dojo._hasResource["com.ibm.mm.enabler.DeferredIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.DeferredIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.DeferredIteratorImpl");dojo.declare("com.ibm.mm.enabler.DeferredIteratorImpl",[com.ibm.mashups.enabler.DeferredIterator,com.ibm.mm.enabler.DeferredImpl],{setForEachCallback:function(_206,_207){this.foreachCallback=_206;this.foreachCallbackParameters=_207;return this;},setForeachCallback:function(_208,_209){return this.setForEachCallback(_208,_209);},getForeachCallback:function(){return this.foreachCallback;},getForeachCallbackParameters:function(){return this.foreachCallbackParameters;},nextFinish:function(_20a){if(dojo.isFunction(this.getForeachCallback())){dojo.partial(this.getForeachCallback())(_20a,this.getForeachCallbackParameters());}},start:function(sync){while(this.hasNext(this,sync)){this.next(this,sync);}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.DeferredIterator"]){dojo._hasResource["com.ibm.mashups.enabler.DeferredIterator"]=true;dojo.provide("com.ibm.mashups.enabler.DeferredIterator");}if(!dojo._hasResource["com.ibm.mashups.enabler.DeferredOperation_API"]){dojo._hasResource["com.ibm.mashups.enabler.DeferredOperation_API"]=true;dojo.provide("com.ibm.mashups.enabler.DeferredOperation_API");dojo.provide("com.ibm.mashups.enabler.DeferredOperation");dojo.declare("com.ibm.mashups.enabler.DeferredOperation",[com.ibm.mashups.enabler.Deferred],{OPERATION_GET:"GET",OPERATION_CREATE:"CREATE",OPERATION_MODIFY:"MODIFY",OPERATION_DELETE:"DELETE",setOperationCallback:function(_20b,_20c){}});com.ibm.mashups.enabler.DeferredOperation.OPERATION_GET="GET";com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE="CREATE";com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY="MODIFY";com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE="DELETE";}if(!dojo._hasResource["com.ibm.mm.enabler.model.HttpStatusCodes"]){dojo._hasResource["com.ibm.mm.enabler.model.HttpStatusCodes"]=true;dojo.provide("com.ibm.mm.enabler.model.HttpStatusCodes");dojo.provide("com.ibm.mm.enabler.model.HttpStatusCodesImpl");dojo.declare("com.ibm.mm.enabler.model.HttpStatusCodesImpl",null,{HTTP_CONTINUE:"100",HTTP_SWITCHING_PROTOCOLS:"101",HTTP_OK:"200",HTTP_CREATED:"201",HTTP_NOT_FOUND:"404",HTTP_REQUEST_TIMEOUT:"408",HTTP_INTERNAL_SERVER_ERROR:"500",HTTP_SERVICE_UNAVAILABLE:"503"});com.ibm.mm.enabler.model.HttpStatusCodes=new com.ibm.mm.enabler.model.HttpStatusCodesImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.DeferredOperationImpl"]){dojo._hasResource["com.ibm.mm.enabler.DeferredOperationImpl"]=true;dojo.provide("com.ibm.mm.enabler.DeferredOperationImpl");dojo.declare("com.ibm.mm.enabler.DeferredOperationImpl",[com.ibm.mashups.enabler.DeferredOperation,com.ibm.mm.enabler.DeferredImpl],{operationCallback:null,operationCallbackParameters:null,setOperationCallback:function(_20d,_20e){this.operationCallback=_20d;this.operationCallbackParameters=_20e;return this;},getOperationCallback:function(){return this.operationCallback;},getOperationCallbackParameters:function(){return this.operationCallbackParameters;},finishOperation:function(_20f,_210,_211){if(dojo.isFunction(this.getOperationCallback())){if(dojo.isOpera&&_211===0){_211=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;}dojo.partial(this.getOperationCallback())(_20f,_210,_211,this.getOperationCallbackParameters());}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.DeferredOperation"]){dojo._hasResource["com.ibm.mashups.enabler.DeferredOperation"]=true;dojo.provide("com.ibm.mashups.enabler.DeferredOperation");}if(!dojo._hasResource["com.ibm.mashups.enabler.Discardable_API"]){dojo._hasResource["com.ibm.mashups.enabler.Discardable_API"]=true;dojo.provide("com.ibm.mashups.enabler.Discardable_API");dojo.provide("com.ibm.mashups.enabler.Discardable");dojo.declare("com.ibm.mashups.enabler.Discardable",null,{discard:function(node){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Discardable"]){dojo._hasResource["com.ibm.mashups.enabler.Discardable"]=true;dojo.provide("com.ibm.mashups.enabler.Discardable");}if(!dojo._hasResource["com.ibm.mashups.enabler.Identifiable_API"]){dojo._hasResource["com.ibm.mashups.enabler.Identifiable_API"]=true;dojo.provide("com.ibm.mashups.enabler.Identifiable_API");dojo.provide("com.ibm.mashups.enabler.Identifiable");dojo.declare("com.ibm.mashups.enabler.Identifiable",null,{getID:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ServiceDocConsumer"]){dojo._hasResource["com.ibm.mm.enabler.ServiceDocConsumer"]=true;dojo.provide("com.ibm.mm.enabler.ServiceDocConsumer");dojo.declare("com.ibm.mm.enabler.ServiceDocConsumer",null,{_noop:function(){},_initServiceDoc:function(){this._initServiceDoc=this._noop;}});}if(!dojo._hasResource["com.ibm.mm.enabler.IdentifiableHelper"]){dojo._hasResource["com.ibm.mm.enabler.IdentifiableHelper"]=true;dojo.provide("com.ibm.mm.enabler.IdentifiableHelper");com.ibm.mm.enabler.IdentifiableHelper.getID=function(id){var aPos=id.indexOf("@");if(aPos!=-1){id=id.slice(0,aPos);}var _212=id.lastIndexOf(":");if(_212!=-1){id=id.slice(_212+1);}_212=id.toUpperCase().lastIndexOf("%3A");if(_212!=-1){id=id.slice(_212+3);}_212=id.lastIndexOf("/");if(_212!=-1){id=id.slice(_212+1);}return id;};com.ibm.mm.enabler.IdentifiableHelper.replaceID=function(_213,_214,_215){var aPos=_213.indexOf("@");var _216=(aPos!=-1)?_213.slice(aPos):"";var mPos=_213.indexOf(_214+":");var _217=(mPos>0)?_213.slice(0,mPos):"";var _218=_215.indexOf(_214+":");var _219=(_218>=0)?_215.slice(_218):_214+":"+_215;return _217+_219+_216;};}if(!dojo._hasResource["com.ibm.mm.enabler.DirtyFlagProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.DirtyFlagProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.DirtyFlagProviderImpl");dojo.declare("com.ibm.mm.enabler.DirtyFlagProviderImpl",null,{_dirty:false,_setDirty:function(){this._dirty=true;},_setClean:function(){this._dirty=false;},_isDirty:function(){return this._dirty;}});}if(!dojo._hasResource["com.ibm.mm.enabler.utils.HttpUrl"]){dojo._hasResource["com.ibm.mm.enabler.utils.HttpUrl"]=true;dojo.provide("com.ibm.mm.enabler.utils.HttpUrl");dojo.declare("com.ibm.mm.enabler.utils.HttpUrl",null,{constructor:function(_21a){var _21b=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(_21a);if(_21b){_21a=_21b;}this.pocurl=this._resolvePocUrl(_21a);if(!this.pocurl){this.scheme=this._extractScheme(_21a);this.server=this._extractServer(_21a);this.port=this._extractPort(_21a);this.path=this._extractPath(_21a);this.parameters=this._extractQuery(_21a);this.anchor=this._extractAnchor(_21a);}},_resolvePocUrl:function(_21c){var rv=null;if(com.ibm.mm.enabler.utils.Misc.isPocUrl(_21c)){var _21d=this._getPrefix();_21c=escape(unescape(_21c));rv=_21d.concat(_21c);}return rv;},_getPrefix:function(){var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _21e=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);var _21f=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ANONYMOUS_USER);var _220;if(_21f){_220=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PUBLIC);}else{_220=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PRIVATE);}var rv=_21e.concat(_220).concat("?uri=");return rv;},addParameter:function(name,_221){if(dojo.isString(this.parameters[name])){this.parameters[name]=[this.parameters[name],_221];}else{if(dojo.isArray(this.parameters[name])){this.parameters[name].push(_221);}else{this.parameters[name]=_221;}}},setParameter:function(name,_222){if(!this.parameters){this.parameters={};}this.parameters[name]=_222;},getParameter:function(name){if(!this.parameters){return false;}return this.parameters[name];},getParameters:function(){return this.parameters;},isProxyNeeded:function(){var loc=document.location;if(loc.protocol!=this.scheme){return true;}if(!this._equalsServer(loc.hostname)){return true;}if(loc.port==this.port){return false;}var _223;if(this.scheme=="http:"){_223="80";if((loc.port==""&&this.port==_223)||(loc.port==_223&&this.port=="")){return false;}}if(this.scheme=="https:"){_223="443";if((loc.port==""&&this.port==_223)||(loc.port==_223&&this.port=="")){return false;}}return true;},toServerRelativeString:function(){if(this.pocurl){return this.pocurl;}var str="";if(this.path!=""){str+="/"+com.ibm.mm.enabler.utils.Misc.encodePath(this.path);}if(!com.ibm.mm.enabler.utils.Misc.isEmpty(this.parameters)){str+="?"+dojo.objectToQuery(this.parameters);}if(this.anchor!=""){str+="#"+this.anchor;}return str;},toProxifiedString:function(){if(this.pocurl){return this.pocurl;}if(typeof ibmConfig=="undefined"){return this.toString();}var _224=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PROXY_URL);if(!_224){return this.toString();}_224+="/";if(window.location.protocol==this.scheme&&this._equalsServer(window.location.hostname)){if(window.location.port==this.port){return this.toString();}else{if(this.scheme=="http:"&&window.location.port==""&&this.port=="80"){return this.toString();}else{if(this.scheme=="https:"&&window.location.port==""&&this.port=="443"){return this.toString();}else{if(this.scheme=="http:"&&window.location.port=="80"&&this.port==""){return this.toString();}else{if(this.scheme=="https:"&&window.location.port=="443"&&this.port==""){return this.toString();}}}}}}if(this.scheme=="https:"){_224+="https/"+this.server+((this.port!="443"&&this.port!="")?"%3A"+this.port:"");}else{_224+="http/"+this.server+((this.port!="80"&&this.port!="")?"%3A"+this.port:"");}_224+="/";if(this.path!=""){_224+=com.ibm.mm.enabler.utils.Misc.encodePath(this.path);}if(!com.ibm.mm.enabler.utils.Misc.isEmpty(this.parameters)){_224+="?"+dojo.objectToQuery(this.parameters);}if(this.anchor!=""){_224+="#"+this.anchor;}return _224;},toString:function(){if(this.pocurl){return this.pocurl;}var str="";if(this.server!=""){str+=this.scheme+"//"+this.server;if(this.port!=""){if(this.scheme=="http:"&&this.port=="80"){str+="";}else{if(this.scheme=="https:"&&this.port=="443"){str+="";}else{str+=":"+this.port;}}}}str+="/";if(this.path!=""){str+=com.ibm.mm.enabler.utils.Misc.encodePath(this.path);}if(!com.ibm.mm.enabler.utils.Misc.isEmpty(this.parameters)){str+="?"+dojo.objectToQuery(this.parameters);}if(this.anchor!=""){str+="#"+this.anchor;}return str;},_extractScheme:function(_225){var _226=_225.indexOf("/")==0;if(_226){return window.location.protocol;}var _227=_225.indexOf("://");if(_227==-1){return window.location.protocol;}return _225.substring(0,_227+1);},_extractServer:function(_228){var _229=_228.indexOf(this.scheme);var _22a="";if(_229===0){var _22b;var _22c=_228.indexOf("/",_229+this.scheme.length+2);if(_22c!=-1){_22b=_228.substring(_229+this.scheme.length+2,_22c);}else{_22b=_228.substring(_229+this.scheme.length+2);}_22a=_22b.split(":")[0];}else{var _22d=window.location.hostname;_22a=this._isIPv6(_22d)?"["+_22d+"]":_22d;}return _22a;},_extractPort:function(_22e){var _22f=_22e.indexOf(this.server);var _230="";if(_22f>=0){var _231;var _232=_22e.indexOf("/",_22f);if(_232!=-1){_231=_22e.substring(_22f,_232);}else{_231=_22e.substring(_22f);}var _233=_231.split(":");if(_233.length>1){_230=_233[1];}}if(_230==""){if(_22e.indexOf("/")===0){_230=window.location.port;}else{_230="";}}return _230;},_extractPath:function(_234){var _235=_234.indexOf(this.scheme);var _236=0;if(_235===0){_236=this.scheme.length+2;}var _237="";var _238=_234.indexOf("/",_236);var _239=_234.indexOf("?");var _23a=_234.lastIndexOf("#");if(_239>=0){_237=_234.substring(_238+1,_239);}else{if(_23a>=0&&_238!=-1){_237=_234.substring(_238+1,_23a);}else{if(_238!=-1){_237=_234.substring(_238+1);}}}return _237;},_extractQuery:function(_23b){var _23c={};var _23d=_23b.split("?");if(_23d.length>1){_23c=dojo.queryToObject(_23d[1].split("#")[0]);}return _23c;},_extractAnchor:function(_23e){var _23f="";var _240=_23e.split("#");if(_240.length>1){_23f=_240[_240.length-1];}return _23f;},_isIPv6:function(_241){return _241.indexOf(":")!=-1;},_equalsServer:function(_242){return this.server==(this._isIPv6(_242)?"["+_242+"]":_242);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.ServiceDocumentModel"]){dojo._hasResource["com.ibm.mm.enabler.model.ServiceDocumentModel"]=true;dojo.provide("com.ibm.mm.enabler.model.ServiceDocumentModel");dojo.declare("com.ibm.mm.enabler.model.ServiceDocumentModelImpl",null,{SERVICE_NAVIGATION:"navigation",SERVICE_SPACE_NAVIGATION:"space-navigation",SERVICE_SHARED_NAVIGATION:"shared-navigation",SERVICE_CONTENT:"content",SERVICE_CATALOG:"catalog",SERVICE_RESOURCE:"resource",SERVICE_WIDGET:"widget",SERVICE_THEME:"theme",SERVICE_USER:"user",SERVICE_MODEL:"model",SERVICE_MULTIPART:"multipart",SERVICE_HUFFMAN:"huffman",SERVICE_SITEMAP:"sitemap",SERVICE_COMPOSITE:"composite-applications",SERVICE_SPACE:"application",SERVICE_SPACE_FAVORITE:"application-favorite",SERVICE_TEMPLATE:"template",SERVICE_CONFIG:"config",SERVICE_FILESTORE:"filestore",SERVICE_WEBDAV:"webdav",constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.prefix="service";this.ns={"atom":"http://www.w3.org/2005/Atom","app":"http://www.w3.org/2007/app","service":"http://www.ibm.com/xmlns/prod/sw/model/service/1.0"};this.xmlData=null;this.xmlDataAsString=null;this.max_version=null;this.cache=[];},getInstance:function(){var _243=com.ibm.mm.enabler.model.ServiceDocumentModelImpl._instance;return _243?_243:(com.ibm.mm.enabler.model.ServiceDocumentModelImpl._instance=new com.ibm.mm.enabler.model.ServiceDocumentModelImpl());},invalidate:function(){this.xmlData=null;this.max_version=null;},_loadAhead:function(){dojo["require"]("com.ibm.mashups.enabler.model.url.ModelUrlFactory");var _244="_loadAhead";var _245=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_245){this.LOGGER.entering(_244,arguments);}if(ibmConfig.servicedocument){if(this.xmlDataAsString!=ibmConfig.servicedocument){this.xmlData=null;}}if(this.xmlData){if(_245){this.LOGGER.exiting(_244);}return;}if(ibmConfig.servicedocument){this.xmlData=dojox.xml.parser.parse(ibmConfig.servicedocument);this.xmlDataAsString=ibmConfig.servicedocument;}else{var _246;if(ibmConfig.serviceDocumentUrl){_246=new com.ibm.mm.enabler.utils.HttpUrl(ibmConfig.serviceDocumentUrl);}else{_246=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL("service",null);_246.setNodes([{value:"collection",isID:false}]);}var _247=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_246,null,null,false,true);_247.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){this.xmlData=data;}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){}}}));}this._fillCache();if(_245){this.LOGGER.exiting(_244);}},_fillCache:function(){this.max_version=null;if(ibmConfig.servicedocument_version_max){this.max_version=parseInt(ibmConfig.servicedocument_version_max.replace(/\./g,""),10);}var _248=[];var i,_249;var expr="//app:collection";var _24a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);for(i=0;i<_24a.length;++i){_249=this._processCollection(i,_24a[i]);if(_249){this.cache[this.cache.length]=_249;}}expr="//service:collection";_24a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);for(i=0;i<_24a.length;++i){_249=this._processCollection(i,_24a[i]);if(_249){this.cache[this.cache.length]=_249;}}},getModelCollections:function(){this._loadAhead();var ret=[];var _24b=0;var expr="//atom:category[@term='enabler-ns-base']";var _24c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);for(var i=0;i<_24c.length;++i){var _24d=_24c[i].parentNode;var _24e="//atom:category[not (@term='enabler-ns-base' or @term='enabler-ns-model' or @term='enabler-ns-ext' or @term='enabler-ns-creationcontext' or @term='mashups')]";var _24f=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_24e,_24d,this.ns);if(_24f&&_24f.length>0){var _250=[];for(var ii=0;ii<_24f.length;++ii){if(_24f[ii].parentNode==_24d){_250.push(_24f[ii].getAttribute("term"));}}_250.sort();var dup=this._isDuplicate(ret,_250);if(!dup){ret[_24b]=_250;_24b++;}}}return ret;},_isDuplicate:function(_251,_252){var dup=false;for(var ii=0;ii<_251.length;ii++){if(_251[ii].length==_252.length){var _253=true;for(var c=0;c<_252.length;c++){if(_251[ii][c]!=_252[c]){_253=false;break;}}if(_253){dup=true;break;}}}return dup;},getMashupsCollections:function(){this._loadAhead();var ret=[];var _254=0;var expr="//atom:category[@term='mashups']";var _255=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);for(var i=0;i<_255.length;++i){var _256=_255[i].parentNode;var _257="//atom:category[not (@term='enabler-ns-base' or @term='enabler-ns-model' or @term='enabler-ns-ext' or @term='enabler-ns-creationcontext' or @term='mashups')]";var _258=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_257,_256,this.ns);if(_258&&_258.length>0){var _259=[];for(var ii=0;ii<_258.length;++ii){if(_258[ii].parentNode==_256){_259.push(_258[ii].getAttribute("term"));}}_259.sort();var dup=this._isDuplicate(ret,_259);if(!dup){ret[_254]=_259;_254++;}}}return ret;},getCollectionData:function(_25a){this._loadAhead();var ret={};this.xmlData=this.xmlData||null;if(!this.xmlData){return ret;}var ids=[];if(dojo.isArray(_25a)){ids=_25a;}else{ids=[_25a];}ret=this._getCachedValue(ids);return ret;},_getCachedValue:function(ids){var _25b=[];var i,cl,lo,m,l,scl;for(i=0,cl=this.cache.length;i<cl;i++){var _25c=this.cache[i].id;var _25d=0;for(j=0,lo=_25c.length;j<lo;j++){if(_25c[j]=="mashups"){_25d+=500;}for(m=0,l=ids.length;m<l;m++){if(_25c[j]==ids[m]){_25d+=1000;}}}var _25e=parseInt(this.cache[i].version.replace(/\./g,""),10);_25d+=_25e;if(this.max_version&&(_25e>this.max_version)){_25d=-1000;}_25b[i]=_25d;}var _25f=-1;var _260=1000;for(i=0,scl=_25b.length;i<scl;i++){if(_25b[i]>_260){_25f=i;_260=_25b[i];}}if(_25f==-1){return null;}return this.cache[_25f];},_processCollection:function(i,node){var ret={};var _261="app:categories//atom:category[@term]";var _262=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_261,node,this.ns);var _263=[];if(_262){for(var jj=0;jj<_262.length;jj++){var term=_262[jj].getAttribute("term");if(term.indexOf("enabler-ns-")===0){continue;}_263.push(term);}}ret.id=_263;ret.url=node.getAttribute("href");ret.version=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"service:version","version",this.ns.service);if(!ret.version){ret.version="1.0";}ret.template=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"service:template","template",this.ns.service);ret.idprefix="id";var ns={};_261="app:categories/atom:category[@term='enabler-ns-base']";_262=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_261,node,this.ns);if(_262&&_262.length>0){ns.base=_262[0].getAttribute("scheme");if(ns.base.indexOf("/mashups/")==-1){ret.idprefix="oid";}}_261="app:categories/atom:category[@term='enabler-ns-model']";_262=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_261,node,this.ns);if(_262&&_262.length>0){ns.model=_262[0].getAttribute("scheme");}_261="app:categories/atom:category[@term='enabler-ns-ext']";_262=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_261,node,this.ns);if(_262&&_262.length>0){ns.ext=_262[0].getAttribute("scheme");}_261="app:categories/atom:category[@term='enabler-ns-creationcontext']";_262=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_261,node,this.ns);if(_262&&_262.length>0){ns["creation-context"]=_262[0].getAttribute("scheme");}ret.namespaces=ns;_261="app:accept";_262=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_261,node,this.ns);if(_262&&_262.length>0){ret.accept=_262[0].firstChild.nodeValue;}return ret;}});com.ibm.mm.enabler.model.ServiceDocumentModel=com.ibm.mm.enabler.model.ServiceDocumentModelImpl.prototype.getInstance();}if(!dojo._hasResource["com.ibm.mm.enabler.IdentifiableImpl"]){dojo._hasResource["com.ibm.mm.enabler.IdentifiableImpl"]=true;dojo.provide("com.ibm.mm.enabler.IdentifiableImpl");dojo.declare("com.ibm.mm.enabler.IdentifiableImpl",[com.ibm.mashups.enabler.Identifiable,com.ibm.mm.enabler.DirtyFlagProviderImpl,com.ibm.mm.enabler.ServiceDocConsumer],{constructor:function(){this.ATOM_ID="atom:id";this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");},_initServiceDoc:function(){var _264=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.id_ns=dojo.delegate(_264.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH,nsf.NS_XHTML,nsf.NS_APP]));this.id_prefix=_264.idprefix;this.inherited("_initServiceDoc",arguments);},getID:function(){var id=this._getRawID();if(id){id=com.ibm.mm.enabler.IdentifiableHelper.getID(id);}return id;},_getRawID:function(){var _265=null;this._initServiceDoc();var _266=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.ATOM_ID,this.xmlData,this.id_ns);if(_266&&_266.length>0){_265=dojo.string.trim(com.ibm.mm.enabler.utils.Dom.textContent(_266[0]));}return _265;},equals:function(_267){return com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this)==com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_267);},setID:function(id){this._initServiceDoc();var _268=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.ATOM_ID,this.xmlData,this.id_ns);if(_268&&_268.length>0){var _269=com.ibm.mm.enabler.utils.Dom.textContent(_268[0]);var _26a=com.ibm.mm.enabler.IdentifiableHelper.replaceID(_269,this.id_prefix,id);if(_26a!=_269){com.ibm.mm.enabler.utils.Dom.textContent(_268[0],_26a);this._setDirty();}}else{throw new Error(dojo.string.substitute(this.modelMessages.E_ELEMENT_NOT_FOUND_2,[this.ATOM_ID,this.toString()]));}},_setRawID:function(id){this._initServiceDoc();var _26b=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.ATOM_ID,this.xmlData,this.id_ns);if(_26b&&_26b.length>0){var _26c=com.ibm.mm.enabler.utils.Dom.textContent(_26b[0]);if(id!=_26c){com.ibm.mm.enabler.utils.Dom.textContent(_26b[0],id);this._setDirty();}}else{throw new Error(dojo.string.substitute(this.modelMessages.E_ELEMENT_NOT_FOUND_2,[this.ATOM_ID,this.toString()]));}},_getUniqueName:function(){this._initServiceDoc();var name="";var res=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.ATOM_ID,this.xmlData,this.id_ns);if(res&&res.length>0){name=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(res[0],"ext:uniquename","uniquename",this.id_ns.ext);}return name;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Identifiable"]){dojo._hasResource["com.ibm.mashups.enabler.Identifiable"]=true;dojo.provide("com.ibm.mashups.enabler.Identifiable");}if(!dojo._hasResource["com.ibm.mashups.enabler.Invalidatable_API"]){dojo._hasResource["com.ibm.mashups.enabler.Invalidatable_API"]=true;dojo.provide("com.ibm.mashups.enabler.Invalidatable_API");dojo.provide("com.ibm.mashups.enabler.Invalidatable");dojo.declare("com.ibm.mashups.enabler.Invalidatable",null,{invalidate:function(node){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Invalidatable"]){dojo._hasResource["com.ibm.mashups.enabler.Invalidatable"]=true;dojo.provide("com.ibm.mashups.enabler.Invalidatable");}if(!dojo._hasResource["com.ibm.mashups.enabler.Locator"]){dojo._hasResource["com.ibm.mashups.enabler.Locator"]=true;dojo.provide("com.ibm.mashups.enabler.Locator");dojo.declare("com.ibm.mashups.enabler.Locator",null,{find:function(id){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ListModel"]){dojo._hasResource["com.ibm.mashups.enabler.ListModel"]=true;dojo.provide("com.ibm.mashups.enabler.ListModel");dojo.declare("com.ibm.mashups.enabler.ListModel",[com.ibm.mashups.enabler.model.Model,com.ibm.mashups.enabler.Locator],{iterator:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ListModelController"]){dojo._hasResource["com.ibm.mashups.enabler.ListModelController"]=true;dojo.provide("com.ibm.mashups.enabler.ListModelController");dojo.declare("com.ibm.mashups.enabler.ListModelController",com.ibm.mashups.enabler.ListModel,{create:function(_26d){},confirmCreate:function(_26e){},insert:function(node,_26f){},confirmInsert:function(node,_270){},remove:function(node){},confirmRemove:function(node){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Localized_API"]){dojo._hasResource["com.ibm.mashups.enabler.Localized_API"]=true;dojo.provide("com.ibm.mashups.enabler.Localized_API");dojo.provide("com.ibm.mashups.enabler.Localized");dojo.declare("com.ibm.mashups.enabler.Localized",null,{getLocales:function(){},getTitle:function(_271){},getDescription:function(_272){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ModifiableLocalized_API"]){dojo._hasResource["com.ibm.mashups.enabler.ModifiableLocalized_API"]=true;dojo.provide("com.ibm.mashups.enabler.ModifiableLocalized_API");dojo.provide("com.ibm.mashups.enabler.ModifiableLocalized");dojo.declare("com.ibm.mashups.enabler.ModifiableLocalized",com.ibm.mashups.enabler.Localized,{setTitle:function(_273,_274){},confirmSetTitle:function(_275,_276){},removeTitle:function(_277){},confirmRemoveTitle:function(_278){},removeTitles:function(){},confirmRemoveTitles:function(){},setDescription:function(desc,_279){},confirmSetDescription:function(desc,_27a){},removeDescription:function(_27b){},confirmRemoveDescription:function(_27c){},removeDescriptions:function(){},confirmRemoveDescriptions:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.RoleType"]){dojo._hasResource["com.ibm.mashups.enabler.ac.RoleType"]=true;dojo.provide("com.ibm.mashups.enabler.ac.RoleType");dojo.declare("com.ibm.mashups.enabler.ac.RoleType",null,{USER:"USER",PRIVILEGED_USER:"PRIVILEGED USER",EDITOR:"EDITOR",MANAGER:"MANAGER",ADMIN:"ADMINISTRATOR",UNKNOWN:"UNKNOWN"});com.ibm.mashups.enabler.ac.RoleType=new com.ibm.mashups.enabler.ac.RoleType();}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.EffectiveAccess_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.EffectiveAccess_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.EffectiveAccess_API");dojo.provide("com.ibm.mashups.enabler.ac.EffectiveAccess");dojo.declare("com.ibm.mashups.enabler.ac.EffectiveAccess",null,{hasRole:function(_27d){},isPrivate:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.EffectiveAccess"]){dojo._hasResource["com.ibm.mashups.enabler.ac.EffectiveAccess"]=true;dojo.provide("com.ibm.mashups.enabler.ac.EffectiveAccess");}if(!dojo._hasResource["com.ibm.mm.enabler.utils.Utils"]){dojo._hasResource["com.ibm.mm.enabler.utils.Utils"]=true;dojo.provide("com.ibm.mm.enabler.utils.Utils");dojo.declare("com.ibm.mm.enabler.utils.UtilsImpl",null,{constructor:function(){this.serviceJson=null;},_lazyInit:function(){if(this.serviceJson){return;}this.xmlDom=com.ibm.mm.enabler.utils.Dom.createDocument();this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM]));},createNode:function(name,ns){this._lazyInit();return com.ibm.mm.enabler.utils.Dom.createElement(this.xmlDom,name,ns);},createLinkNode:function(href,rel,ns){var _27e=this.createNode("atom:link",ns);_27e.setAttribute("href",href);_27e.setAttribute("rel",rel);return _27e;},createExtLinkNode:function(href,rel,_27f){this._lazyInit();var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;var _280=this.createNode("atom:link",this.ns[nsf.NS_ATOM]);_280.setAttribute("href",href);if(rel){_280.setAttribute("rel",rel);}com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlDom,_280,"ext:rel","rel",this.ns.ext,_27f);return _280;},getIdFromExtUri:function(_281,node){this._lazyInit();var id=null;var uri=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"ext:uri","uri",this.ns.ext);if(uri){var aPos=uri.indexOf("@");if(aPos!=-1){uri=uri.slice(0,aPos);}id=uri;var _282=id.lastIndexOf(":");if(_282!=-1){id=id.slice(_282+1);}_282=id.toUpperCase().lastIndexOf("%3A");if(_282!=-1){id=id.slice(_282+3);}_282=id.lastIndexOf("/");if(_282!=-1){id=id.slice(_282+1);}}return id;},getHrefFromIdentifiable:function(_283){return (_283&&(typeof _283._getParameters=="function"))?_283._getParameters().href:null;},getIdFromIdentifiable:function(_284){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_284,com.ibm.mashups.enabler.Identifiable)){return _284.getID();}else{if(dojo.isString(_284)){return dojo.string.trim(_284);}else{return _284;}}},setAttributeWithNS:function(_285,_286,_287,_288){this._lazyInit();com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlDom,_285,_286,null,_287,_288);},createFeed:function(id,_289,_28a,_28b){var ns="";for(var _28c in _28b){if(Object.prototype.hasOwnProperty.call(_28b,_28c)){ns+="xmlns:"+_28c+"=\""+_28b[_28c]+"\" ";}}var time=new Date();var feed="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"+"<atom:feed "+ns+" >\n"+"<atom:title>"+_289+"</atom:title>\n"+"<atom:id>"+id+"</atom:id>\n"+"<atom:updated>"+time.toGMTString()+"</atom:updated>\n"+_28a+"</atom:feed>";return feed;}});com.ibm.mm.enabler.utils.Utils=new com.ibm.mm.enabler.utils.UtilsImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.utils.APIEnforcementHelperImpl"]){dojo._hasResource["com.ibm.mm.enabler.utils.APIEnforcementHelperImpl"]=true;dojo.provide("com.ibm.mm.enabler.utils.APIEnforcementHelperImpl");dojo.declare("com.ibm.mm.enabler.utils.APIEnforcementHelperImpl",null,{constructor:function(){this.configService=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this._promptMode=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.API_ENFORCEMENT_MODE);},enforceDefined:function(_28d,msg){if(typeof _28d=="undefined"){this._promptViolation(msg);}},enforceDefinedNotNull:function(_28e,msg){if(_28e===null||typeof _28e=="undefined"){this._promptViolation(msg);}},_promptViolation:function(msg){if(this._promptMode==com.ibm.mashups.enabler.services.ConfigConstants.API_ENFORCEMENT_MODE_ERROR){throw new Error(msg);}else{console.warn(msg);}},invalidate:function(){this._promptMode=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.API_ENFORCEMENT_MODE);}});com.ibm.mm.enabler.utils.APIEnforcementHelper=new com.ibm.mm.enabler.utils.APIEnforcementHelperImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.ac.EffectiveAccessImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.EffectiveAccessImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.EffectiveAccessImpl");dojo.declare("com.ibm.mm.enabler.ac.EffectiveAccessImpl",com.ibm.mashups.enabler.ac.EffectiveAccess,{constructor:function(){var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns_ac=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_AC]);this.EDIT_LINK="atom:link[@rel='edit']";this.XPATH0="atom:content/*";this.XPATH1="atom:content/*/ac:allowed-access";this.XPATH2="atom:content/*/ac:allowed-access/ac:access-level";this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.enforcementHelper=com.ibm.mm.enabler.utils.APIEnforcementHelper;},_init:function(data){this.xmlData=data;this.XPATH0="atom:content";this.XPATH1="atom:content/ac:allowed-access";this.XPATH2="atom:content/ac:allowed-access/ac:access-level";},hasRole:function(_28f){this.enforcementHelper.enforceDefinedNotNull(_28f,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["roletype",this.declaredClass,"hasRole(roletype)"]));if(dojo.isString(_28f)){_28f=_28f.toUpperCase();}if(this._hasAllowedAccess()){var _290=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.XPATH2,this.xmlData,this.ns_ac);if(_290&&_290.length>0){for(var i=0,l=_290.length;i<l;i++){var type=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_290[i],"ac:type","type",this.ns_ac.ac);if(type&&type.toUpperCase()==_28f){return true;}}}return false;}else{return !!(_28f==com.ibm.mashups.enabler.ac.RoleType.USER||this._hasEditLink());}},_isPrivate:function(){var _291=false;var _292=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.XPATH1,this.xmlData,this.ns_ac);if(_292){_291=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_292,"ac:private","private",this.ns_ac.ac)=="true"?true:false;}return _291;},_hasEditLink:function(){return com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.EDIT_LINK,this.xmlData,this.ns_ac)?true:false;},_hasAllowedAccess:function(){return com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.XPATH1,this.xmlData,this.ns_ac)?true:false;},_setRole:function(_293){if(dojo.isString(_293)){_293=_293.toUpperCase();}var _294=this._createAllowedAccess();var expr=this.XPATH2+"[ac:type='"+_293+"']";var node=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,this.xmlData,this.ns_ac);if(!node){var _295=com.ibm.mm.enabler.utils.Utils.createNode("ac:access-level",this.ns_ac.ac);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,_295,"ac:type","type",this.ns_ac.ac,_293);_294.appendChild(_295);}},_setUserOwned:function(_296){var _297=this._createAllowedAccess();if(_297){com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,_297,"ac:user-owned","user-owned",this.ns_ac.ac,_296?"true":"false");}},_createAllowedAccess:function(){var _298=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.XPATH1,this.xmlData,this.ns_ac);if(!_298){_298=com.ibm.mm.enabler.utils.Utils.createNode("ac:allowed-access",this.ns_ac.ac);var _299=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.XPATH0,this.xmlData,this.ns_ac);if(_299){_299.appendChild(_298);}else{_298=null;}}return _298;}});}if(!dojo._hasResource["com.ibm.mm.enabler.LocalizedImpl"]){dojo._hasResource["com.ibm.mm.enabler.LocalizedImpl"]=true;dojo.provide("com.ibm.mm.enabler.LocalizedImpl");dojo.declare("com.ibm.mm.enabler.LocalizedImpl",[com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mm.enabler.ac.EffectiveAccessImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _29a=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.li_ns=dojo.delegate(_29a.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML]));this.NLS_TITLE="atom:content/*/model:title/base:nls-string";this.NLS_TITLE_TOP="atom:content/*/model:title";this.NLS_DESCRIPTION="atom:content/*/model:description/base:nls-string";this.NLS_DESCRIPTION_TOP="atom:content/*/model:description";this.BASE_TITLE="base:nls-string";this.BASE_DESCRIPTION="base:nls-string";this.BASE_NS=this.li_ns.base;},getLocales:function(){var _29b=[];var _29c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_TITLE,this.xmlData,this.li_ns);if(_29c){for(var i=0,l=_29c.length;i<l;i++){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_29c[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null){_29b.push(lang);}}}return _29b;},getTitle:function(loc){var _29d=null;var _29e=loc.replace(/-/g,"_").toLowerCase();var _29f=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_TITLE,this.xmlData,this.li_ns);if(_29f){for(var i=0,l=_29f.length;i<l;i++){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_29f[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_").toLowerCase()==_29e.toLowerCase()){_29d=com.ibm.mm.enabler.utils.Dom.textContent(_29f[i]);break;}}}return _29d;},getDescription:function(loc){var _2a0=null;var _2a1=loc.replace(/-/g,"_").toLowerCase();var _2a2=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_DESCRIPTION,this.xmlData,this.li_ns);if(_2a2){for(var i=0,l=_2a2.length;i<l;i++){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_2a2[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_").toLowerCase()==_2a1.toLowerCase()){_2a0=com.ibm.mm.enabler.utils.Dom.textContent(_2a2[i]);break;}}}return _2a0;},setTitle:function(_2a3,loc){if(_2a3&&loc){var _2a4=com.ibm.mashups.enabler.xml.XPath.createXPath(this.NLS_TITLE_TOP,this.xmlData,this.li_ns);var _2a5=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.BASE_TITLE,_2a4,this.li_ns);var _2a6=loc.replace(/-/g,"_").toLowerCase();var _2a7=false;var i=_2a5.length;while(--i>=0){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_2a5[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_").toLowerCase()==_2a6.toLowerCase()){com.ibm.mm.enabler.utils.Dom.textContent(_2a5[i],_2a3);_2a7=true;break;}}if(!_2a7){var _2a8=this.xmlData.ownerDocument;var node=com.ibm.mm.enabler.utils.Dom.createElement(_2a8,this.BASE_TITLE,this.BASE_NS);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2a8,node,"xml:lang","lang",this.li_ns.xml,loc);com.ibm.mm.enabler.utils.Dom.textContent(node,_2a3);_2a4.appendChild(node);}this._setDirty();}else{var _2a9="setTitle";this.LOGGER.warning(_2a9,"Make sure to not pass in undefined or null parameters.");}},confirmSetTitle:function(_2aa,_2ab){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},removeTitle:function(loc){if(loc){var _2ac=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_TITLE,this.xmlData,this.li_ns);if(_2ac&&_2ac.length>0){var _2ad=loc.replace(/-/g,"_").toLowerCase();for(var i=_2ac.length;i>0;i--){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_2ac[i-1],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_").toLowerCase()==_2ad.toLowerCase()){var _2ae=_2ac[i-1].parentNode;_2ae.removeChild(_2ac[i-1]);this._setDirty();break;}}}}else{var _2af="removeTitle";this.LOGGER.warning(_2af,"Make sure to not pass in undefined or null parameters.");}},confirmRemoveTitle:function(loc){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},removeTitles:function(){var _2b0=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_TITLE,this.xmlData,this.li_ns);if(_2b0&&_2b0.length>0){for(var i=_2b0.length;i>0;i--){var _2b1=_2b0[i-1].parentNode;_2b1.removeChild(_2b0[i-1]);}this._setDirty();}},confirmRemoveTitles:function(){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},setDescription:function(_2b2,loc){if(_2b2&&loc){var _2b3=com.ibm.mashups.enabler.xml.XPath.createXPath(this.NLS_DESCRIPTION_TOP,this.xmlData,this.li_ns);var _2b4=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.BASE_DESCRIPTION,_2b3,this.li_ns);var _2b5=loc.replace(/-/g,"_").toLowerCase();var _2b6=false;var i=_2b4.length;while(--i>=0){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_2b4[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_").toLowerCase()==_2b5.toLowerCase()){com.ibm.mm.enabler.utils.Dom.textContent(_2b4[i],_2b2);_2b6=true;break;}}if(!_2b6){var _2b7=this.xmlData.ownerDocument;var node=com.ibm.mm.enabler.utils.Dom.createElement(_2b7,this.BASE_DESCRIPTION,this.BASE_NS);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2b7,node,"xml:lang","lang",this.li_ns.xml,loc);com.ibm.mm.enabler.utils.Dom.textContent(node,_2b2);_2b3.appendChild(node);}this._setDirty();}else{var _2b8="setDescription";this.LOGGER.warning(_2b8,"Make sure to not pass in undefined or null parameters.");}},confirmSetDescription:function(_2b9,_2ba){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},removeDescription:function(loc){if(loc){var _2bb=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_DESCRIPTION,this.xmlData,this.li_ns);if(_2bb&&_2bb.length>0){var _2bc=loc.replace(/-/g,"_").toLowerCase();for(var i=_2bb.length;i>0;i--){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_2bb[i-1],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_").toLowerCase()==_2bc.toLowerCase()){var _2bd=_2bb[i-1].parentNode;_2bd.removeChild(_2bb[i-1]);break;}}this._setDirty();}}else{var _2be="removeDescription";this.LOGGER.warning(_2be,"Make sure to not pass in undefined or null parameters.");}},confirmRemoveDescription:function(loc){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},removeDescriptions:function(){var _2bf=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_DESCRIPTION,this.xmlData,this.li_ns);if(_2bf&&_2bf.length>0){for(var i=_2bf.length;i>0;i--){var _2c0=_2bf[i-1].parentNode;_2c0.removeChild(_2bf[i-1]);}this._setDirty();}},confirmRemoveDescriptions:function(){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ModifiableLocalized"]){dojo._hasResource["com.ibm.mashups.enabler.ModifiableLocalized"]=true;dojo.provide("com.ibm.mashups.enabler.ModifiableLocalized");}if(!dojo._hasResource["com.ibm.mashups.enabler.Localized"]){dojo._hasResource["com.ibm.mashups.enabler.Localized"]=true;dojo.provide("com.ibm.mashups.enabler.Localized");}if(!dojo._hasResource["com.ibm.mashups.enabler.MetaData_API"]){dojo._hasResource["com.ibm.mashups.enabler.MetaData_API"]=true;dojo.provide("com.ibm.mashups.enabler.MetaData_API");dojo.provide("com.ibm.mashups.enabler.MetaData");dojo.declare("com.ibm.mashups.enabler.MetaData",null,{getMetaDataNames:function(){},getMetaData:function(name){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ModifiableMetaData_API"]){dojo._hasResource["com.ibm.mashups.enabler.ModifiableMetaData_API"]=true;dojo.provide("com.ibm.mashups.enabler.ModifiableMetaData_API");dojo.provide("com.ibm.mashups.enabler.ModifiableMetaData");dojo.declare("com.ibm.mashups.enabler.ModifiableMetaData",com.ibm.mashups.enabler.MetaData,{setMetaData:function(name,_2c1){},confirmSetMetaData:function(name,_2c2){},removeMetaData:function(name){},confirmRemoveMetaData:function(name){}});}if(!dojo._hasResource["com.ibm.mm.enabler.MetaDataImpl"]){dojo._hasResource["com.ibm.mm.enabler.MetaDataImpl"]=true;dojo.provide("com.ibm.mm.enabler.MetaDataImpl");dojo.declare("com.ibm.mm.enabler.MetaDataImpl",[com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mm.enabler.ac.EffectiveAccessImpl],{constructor:function(){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_SPACE);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.mdi_ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_CA]));this.MODEL_METADATA="atom:content/ca:application/ca:meta-data";this.MODEL_METADATA_BASE="ca:meta-data";this.NAME_ATTR="ca:name";},getMetadataNames:function(){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.getMetadataNames","getMetadataNames() is deprecated, please use getMetaDataNames()");return this.getMetaDataNames();},getMetadata:function(name){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.getMetadata","getMetadata() is deprecated, please use getMetaData()");return this.getMetaData(name);},setMetadata:function(name,_2c3){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.setMetadata","setMetadata() is deprecated, please use setMetaData()");return this.setMetaData(name,_2c3);},removeMetadata:function(name){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.removeMetadata","removeMetadata() is deprecated, please use removeMetaData()");this.removeMetaData(name);},getMetaDataNames:function(){var _2c4=[];var expr=this.MODEL_METADATA+"[@"+this.NAME_ATTR+"]";var md=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.mdi_ns);if(md){for(var i=0,l=md.length;i<l;++i){_2c4.push(md[i].getAttribute(this.NAME_ATTR));}}return _2c4;},getMetaData:function(name){var expr=this.MODEL_METADATA+"[@"+this.NAME_ATTR+"='"+name+"']";var md=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.mdi_ns);return (md&&md.length>0)?com.ibm.mm.enabler.utils.Dom.textContent(md[0]):null;},setMetaData:function(name,_2c5){var _2c6=null;var expr=this.MODEL_METADATA+"[@"+this.NAME_ATTR+"='"+name+"']";var _2c7=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.mdi_ns);if(_2c7&&_2c7.length>0){_2c6=com.ibm.mm.enabler.utils.Dom.textContent(_2c7[0]);com.ibm.mm.enabler.utils.Dom.textContent(_2c7[0],_2c5);}else{var _2c8=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/*",this.xmlData,this.mdi_ns);if(_2c8&&_2c8.length>0){var _2c9=this.xmlData.ownerDocument;var _2ca=com.ibm.mm.enabler.utils.Dom.createElement(_2c9,this.MODEL_METADATA_BASE,this.mdi_ns.ca);var pos=this.NAME_ATTR.indexOf(":");var _2cb=this.NAME_ATTR.slice(pos+1);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2c9,_2ca,this.NAME_ATTR,_2cb,this.mdi_ns.ca,name);com.ibm.mm.enabler.utils.Dom.textContent(_2ca,_2c5);_2c8[0].appendChild(_2ca);}}this._setDirty();return _2c6;},confirmSetMetaData:function(name,_2cc){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},removeMetaData:function(name){var _2cd=null;var expr=this.MODEL_METADATA+"[@"+this.NAME_ATTR+"='"+name+"']";var _2ce=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.mdi_ns);if(_2ce&&_2ce.length>0){_2cd=com.ibm.mm.enabler.utils.Dom.textContent(_2ce[0]);var _2cf=_2ce[0].parentNode;_2cf.removeChild(_2ce[0]);this._setDirty();}return _2cd;},confirmRemoveMetaData:function(name){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);}});}if(!dojo._hasResource["com.ibm.mm.enabler.MetaDataImpl2"]){dojo._hasResource["com.ibm.mm.enabler.MetaDataImpl2"]=true;dojo.provide("com.ibm.mm.enabler.MetaDataImpl2");dojo.declare("com.ibm.mm.enabler.MetaDataImpl2",[com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mm.enabler.ac.EffectiveAccessImpl],{constructor:function(){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.mdi_ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML]));this.MODEL_METADATA="atom:content/*/model:metadata";this.BASE_VALUE="base:value";},getMetadataNames:function(){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.getMetadataNames","getMetadataNames() is deprecated, please use getMetaDataNames()");return this.getMetaDataNames();},getMetadata:function(name){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.getMetadata","getMetadata() is deprecated, please use getMetaData()");return this.getMetaData(name);},setMetadata:function(name,_2d0){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.setMetadata","setMetadata() is deprecated, please use setMetaData()");return this.setMetaData(name,_2d0);},removeMetadata:function(name){dojo.deprecated("com.ibm.mashups.enabler.ModifiableMetaData.removeMetadata","removeMetadata() is deprecated, please use removeMetaData()");this.removeMetaData(name);},getMetaDataNames:function(){var md=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.MODEL_METADATA+"/@name",this.xmlData,this.mdi_ns);if(md&&md.length>0){return dojo.map(md,function(item){return com.ibm.mm.enabler.utils.Dom.textContent(item);});}return [];},getMetaData:function(name,_2d1){var res=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.MODEL_METADATA+"[@name='"+name+"']/"+this.BASE_VALUE,this.xmlData,this.mdi_ns);if(res){res=res.getAttribute("value");}if(res&&_2d1){var _2d2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(res);if(_2d2){return _2d2;}}return res;},setMetaData:function(name,_2d3){var _2d4=null;var _2d5;var _2d6=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.MODEL_METADATA+"[@name='"+name+"']/"+this.BASE_VALUE,this.xmlData,this.mdi_ns);if(_2d6&&_2d6.length>0){_2d5=_2d6[0];for(var i=1,l=_2d6.length;i<l;i++){dojo.destroy(_2d6[i].parentNode);}}else{var _2d7=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:content/*",this.xmlData,this.mdi_ns);if(_2d7){var _2d8=this.xmlData.ownerDocument;var _2d9=com.ibm.mm.enabler.utils.Dom.createElement(_2d8,"model:metadata",this.mdi_ns.model);_2d9.setAttribute("name",name);_2d5=com.ibm.mm.enabler.utils.Dom.createElement(_2d8,this.BASE_VALUE,this.mdi_ns.base);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,_2d5,"xsi:type","type",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xsi"),"xsd:string");_2d9.appendChild(_2d5);_2d7.appendChild(_2d9);}}var _2d4=_2d5.getAttribute("value")||null;if(_2d4!=_2d3){_2d5.setAttribute("value",_2d3);this._setDirty();}return _2d4;},confirmSetMetaData:function(name,_2da){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},removeMetaData:function(name){var _2db;var _2dc=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.MODEL_METADATA+"[@name='"+name+"']",this.xmlData,this.mdi_ns);if(_2dc&&_2dc.length>0){_2db=this.getMetaData(name);dojo.forEach(_2dc,function(item){dojo.destroy(item);},this);this._setDirty();}return _2db||null;},confirmRemoveMetaData:function(name){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ModifiableMetaData"]){dojo._hasResource["com.ibm.mashups.enabler.ModifiableMetaData"]=true;dojo.provide("com.ibm.mashups.enabler.ModifiableMetaData");}if(!dojo._hasResource["com.ibm.mashups.enabler.MetaData"]){dojo._hasResource["com.ibm.mashups.enabler.MetaData"]=true;dojo.provide("com.ibm.mashups.enabler.MetaData");}if(!dojo._hasResource["com.ibm.mashups.enabler.Representation_API"]){dojo._hasResource["com.ibm.mashups.enabler.Representation_API"]=true;dojo.provide("com.ibm.mashups.enabler.Representation_API");dojo.provide("com.ibm.mashups.enabler.Representation");dojo.declare("com.ibm.mashups.enabler.Representation",com.ibm.mashups.enabler.Identifiable,{getID:function(){},getURL:function(){},getMimeType:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.RepresentationImpl"]){dojo._hasResource["com.ibm.mm.enabler.RepresentationImpl"]=true;dojo.provide("com.ibm.mm.enabler.RepresentationImpl");dojo.declare("com.ibm.mm.enabler.RepresentationImpl",com.ibm.mashups.enabler.Representation,{constructor:function(url,type){this.url=url;this.type=type;},getID:function(){return this.type;},getURL:function(){return this.url;},getMimeType:function(){return this.type;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Representation"]){dojo._hasResource["com.ibm.mashups.enabler.Representation"]=true;dojo.provide("com.ibm.mashups.enabler.Representation");}if(!dojo._hasResource["com.ibm.mashups.enabler.RepresentationProvider_API"]){dojo._hasResource["com.ibm.mashups.enabler.RepresentationProvider_API"]=true;dojo.provide("com.ibm.mashups.enabler.RepresentationProvider_API");dojo.provide("com.ibm.mashups.enabler.RepresentationProvider");dojo.declare("com.ibm.mashups.enabler.RepresentationProvider",null,{getAlternateModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.RepresentationModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.RepresentationModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.RepresentationModelImpl");dojo.declare("com.ibm.mm.enabler.RepresentationModelImpl",[com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.DeferredIteratorImpl],{constructor:function(_2dd){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.loadedNodes={};this.entries=[];this.cursor=0;this.size=null;this.start=null;this.num=null;this.strategy=null;if(_2dd&&_2dd.length>0){this.size=_2dd.length;for(var i=0;i<_2dd.length;i++){var link=_2dd[i];var url=link.getAttribute("href");var _2de=link.getAttribute("type");var uri=_2de;var node=new com.ibm.mm.enabler.RepresentationImpl(url,_2de);this.entries[i]=uri;this.loadedNodes[uri]=node;}}},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,uri);},_find:function(_2df,sync,uri){return this._load(uri,_2df,sync);},start:function(sync){while(this._hasNext(this,sync)){if(this._next(this,sync)){continue;}else{break;}}},hasNext:function(){return this._hasNext(null,true);},_hasNext:function(_2e0,sync){if(this.start===null||this.cursor<this.start||(this.cursor>=(this.start+this.num)&&(this.size>this.cursor))){this._loadAhead(_2e0,sync);}return (this.size>this.cursor);},next:function(){return this._next(null,true);},_next:function(_2e1,sync){return this._hasNext(_2e1,sync)?this.loadedNodes[this.entries[this.cursor++]]:null;},size:function(){return this.size;},setCursorPosition:function(_2e2){this.cursor=_2e2;},getCursorPosition:function(){return this.cursor;},setStrategy:function(_2e3){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_2e3,Array)){this.strategy=_2e3[0];}else{this.strategy=_2e3;}},_load:function(uri,_2e4,sync){var _2e5="_load";var _2e6=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_2e6){this.LOGGER.entering(_2e5,arguments);}if(uri in this.loadedNodes){if(_2e4){_2e4.finish(this.loadedNodes[uri],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}if(_2e6){this.LOGGER.exiting(_2e5,this.loadedNodes[uri]);}return this.loadedNodes[uri];},_loadAhead:function(_2e7,sync){}});}if(!dojo._hasResource["com.ibm.mm.enabler.RepresentationProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.RepresentationProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.RepresentationProviderImpl");dojo.declare("com.ibm.mm.enabler.RepresentationProviderImpl",com.ibm.mashups.enabler.RepresentationProvider,{constructor:function(){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.r_ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML]));this.XPATH="atom:link";},getAlternateModel:function(){var _2e8=[];var md=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.XPATH,this.xmlData,this.r_ns);if(md&&md.length>0){for(var i=0;i<md.length;i++){var link=md[i];var rel=link.getAttribute("rel");var _2e9=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(link,"ext:rel","rel",this.r_ns.ext);if(_2e9==""){_2e9=null;}if(((!rel)||(rel=="alternate"))&&(!_2e9)){_2e8[_2e8.length]=link;}}}var _2ea=new com.ibm.mm.enabler.RepresentationModelImpl(_2e8);return _2ea;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.RepresentationProvider"]){dojo._hasResource["com.ibm.mashups.enabler.RepresentationProvider"]=true;dojo.provide("com.ibm.mashups.enabler.RepresentationProvider");}if(!dojo._hasResource["com.ibm.mashups.enabler.ResourceLocator"]){dojo._hasResource["com.ibm.mashups.enabler.ResourceLocator"]=true;dojo.provide("com.ibm.mashups.enabler.ResourceLocator");dojo.declare("com.ibm.mashups.enabler.ResourceLocator",com.ibm.mashups.enabler.Locator,{findResourceUrl:function(node,name){},findResourceURL:function(node,name){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.SubmittableForm_API"]){dojo._hasResource["com.ibm.mashups.enabler.SubmittableForm_API"]=true;dojo.provide("com.ibm.mashups.enabler.SubmittableForm_API");dojo.provide("com.ibm.mashups.enabler.SubmittableForm");dojo.declare("com.ibm.mashups.enabler.SubmittableForm",com.ibm.mashups.enabler.Identifiable,{getURL:function(){},getMethod:function(){},submit:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.SubmittableFormImpl"]){dojo._hasResource["com.ibm.mm.enabler.SubmittableFormImpl"]=true;dojo.provide("com.ibm.mm.enabler.SubmittableFormImpl");dojo.declare("com.ibm.mm.enabler.SubmittableFormImpl",com.ibm.mashups.enabler.SubmittableForm,{constructor:function(url,_2eb,_2ec){this.url=url;this.method=_2eb;this.formId=_2ec;},getURL:function(){return this.url;},getMethod:function(){return this.method;},submit:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._submit);},_submit:function(_2ed){dojo.io.iframe.send({url:this.url,method:this.method,handleAs:"text",form:document.getElementsByName(this.formId)[0],load:function(data,_2ee){if(_2ed){_2ed.finish(data,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_CREATED);}},error:function(data,_2ef){if(_2ed){_2ed.finish(data,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}}});}});}if(!dojo._hasResource["com.ibm.mashups.enabler.SubmittableForm"]){dojo._hasResource["com.ibm.mashups.enabler.SubmittableForm"]=true;dojo.provide("com.ibm.mashups.enabler.SubmittableForm");}if(!dojo._hasResource["com.ibm.mashups.enabler.SubmittableFormProvider_API"]){dojo._hasResource["com.ibm.mashups.enabler.SubmittableFormProvider_API"]=true;dojo.provide("com.ibm.mashups.enabler.SubmittableFormProvider_API");dojo.provide("com.ibm.mashups.enabler.SubmittableFormProvider");dojo.declare("com.ibm.mashups.enabler.SubmittableFormProvider",null,{getSubmittableForm:function(id){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrl_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrl_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.url.ModelUrl_API");dojo.provide("com.ibm.mashups.enabler.model.url.ModelUrl");dojo.declare("com.ibm.mashups.enabler.model.url.ModelUrl",null,{constructor:function(){},setNodes:function(_2f0){},setSchemeSpecificPart:function(_2f1){},getSchemeSpecificPart:function(){return null;},addParameter:function(name,_2f2){},setParameter:function(name,_2f3){},getParameter:function(name){return null;},getParameters:function(){return null;},getAbsoluteURL:function(){return null;},getProxifiedAbsoluteURL:function(){return null;},getModelURI:function(){return null;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrl"]){dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrl"]=true;dojo.provide("com.ibm.mashups.enabler.model.url.ModelUrl");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrlFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrlFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.url.ModelUrlFactory_API");dojo.provide("com.ibm.mashups.enabler.model.url.ModelUrlFactory");dojo.declare("com.ibm.mashups.enabler.model.url.ModelUrlFactory",null,{NAVIGATION_URL:"nav",LAYOUT_URL:"layout",SHARED_NAVIGATION_URL:"sharednav",FRAGMENT_URL:"fragment",FRAGMENT_MEDIA_URL:"fragment-media",USER_URL:"user",THEME_URL:"theme",THEME_MEDIA_URL:"theme-media",CATALOG_URL:"cat",CONFIG_URL:"config",SPACE_URL:"space",SPACE_FAVORITE_URL:"space-favorite",AC_URL:"ac",AI_URL:"ai",TEMPLATE_URL:"template",WIDGET_URL:"widget",EVENT_URL:"event",SUBMODEL_MEMBER:"member",SUBMODEL_ROLE:"role",SUBMODEL_ACCESS:"access",SUBMODEL_RESOURCE:"resource",constructor:function(){},createModelUrl:function(_2f4,_2f5){return new com.ibm.mashups.enabler.model.url.ModelUrl(_2f4,_2f5);},createModelURL:function(_2f6,_2f7){return new com.ibm.mashups.enabler.model.url.ModelUrl(_2f6,_2f7);},getModelUrl:function(url,_2f8){return new com.ibm.mashups.enabler.model.url.ModelUrl(url,_2f8);},getModelURL:function(url,_2f9){return new com.ibm.mashups.enabler.model.url.ModelUrl(url,_2f9);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.BaseModelUrl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.BaseModelUrl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.BaseModelUrl");dojo.declare("com.ibm.mm.enabler.model.url.BaseModelUrl",[com.ibm.mashups.enabler.model.url.ModelUrl],{modelSchema:null,schemeSpecific:null,isMediaUrl:false,httpUrl:null,VALUE:"value",IS_ID:"isID",SUBMODEL:"submodel",constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.nodes=[];this.prefix=null;this.subModelSchemeMap={};this.subModelSchemeMap[com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_RESOURCE]="resource";this.subModelSchemeMap[com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE]="role";this.subModelSchemeMap[com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_MEMBER]="member";this.subModelSchemeMap[com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ACCESS]="access";},_loadPrefix:function(){if(!this.prefix){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);this.prefix=this.serviceJson.idprefix;}},setPrimaryNode:function(_2fa,isID,_2fb){if(typeof internal=="undefined"){var _2fc="setPrimaryNode";this.LOGGER.warning(_2fc,"This method must not be used anymore. Use setNodes instead.");}var _2fd={};_2fd.value=_2fa;_2fd.isID=(isID===false)?isID:true;_2fd.subModel=_2fb;this.nodes[0]=_2fd;this._updateURI();},setSecondaryNode:function(_2fe,isID,_2ff){if(typeof internal=="undefined"){var _300="setSecondaryNode";this.LOGGER.warning(_300,"This method must not be used anymore. Use setNodes instead.");}var _301={};_301.value=_2fe;_301.isID=(isID===false)?isID:true;_301.subModel=_2ff;this.nodes[1]=_301;this._updateURI();},setNodes:function(_302){this.nodes=_302;for(var i=0;i<_302.length;i++){_302[i].isID=(_302[i].isID===false)?_302[i].isID:true;}this._updateURI();},setSchemeSpecificPart:function(_303){this.nodes=[];this.schemeSpecific=_303;this._updateURI();},getSchemeSpecificPart:function(){if(this.schemeSpecific){return this.schemeSpecific;}var _304="";if(this.isMediaUrl){_304="/";}if(!this.nodes){return _304;}var i,node;if(this.isMediaUrl){for(i=0;i<this.nodes.length;i++){node=this.nodes[i];if(node.isID&&!this.prefix){this._loadPrefix();}if(i>0){if(i<this.nodes.length-1){_304+="@";}else{_304+="/";}}_304+=node.value;}}else{for(i=0;i<this.nodes.length;i++){node=this.nodes[i];if(node.isID&&!this.prefix){this._loadPrefix();}if(_304!=""){_304+="@";}if(node.subModel){_304+=this.subModelSchemeMap[node.subModel]+":";}if(node.isID){_304+=this.prefix+":";}_304+=node.value;}}return _304;},_updateURI:function(){var uri=this.modelSchema+":"+this.getSchemeSpecificPart();this.httpUrl.setParameter("uri",uri);},addParameter:function(name,_305){this.httpUrl.addParameter(name,_305);},setParameter:function(name,_306){this.httpUrl.setParameter(name,_306);},getParameter:function(name){return this.httpUrl.getParameter(name);},getParameters:function(){return this.httpUrl.getParameters();},getAbsoluteURL:function(){return this.httpUrl.toString();},getProxifiedAbsoluteURL:function(){return this.httpUrl.toProxifiedString();},getModelURI:function(){return this.httpUrl.getParameter("uri");},toProxifiedString:function(){return this.httpUrl.toProxifiedString();}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.SchemeBasedModelUrlImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.SchemeBasedModelUrlImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.SchemeBasedModelUrlImpl");dojo.declare("com.ibm.mm.enabler.model.url.SchemeBasedModelUrlImpl",[com.ibm.mm.enabler.model.url.BaseModelUrl],{constructor:function(_307,_308){this.modelSchema=_307;this.model=_308;var _309=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var url="";url+=_309.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);var _30a=_309.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ANONYMOUS_USER);var _30b;if(_30a){_30b=_309.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PUBLIC);}else{_30b=_309.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PRIVATE);}url+=_30b;this.httpUrl=new com.ibm.mm.enabler.utils.HttpUrl(url);this.httpUrl.setParameter("uri",this.modelSchema);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.SchemeBasedModelMediaUrlImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.SchemeBasedModelMediaUrlImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.SchemeBasedModelMediaUrlImpl");dojo.declare("com.ibm.mm.enabler.model.url.SchemeBasedModelMediaUrlImpl",[com.ibm.mm.enabler.model.url.SchemeBasedModelUrlImpl],{constructor:function(_30c,_30d){this.isMediaUrl=true;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.ThemeResourceUrlImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.ThemeResourceUrlImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.ThemeResourceUrlImpl");dojo.declare("com.ibm.mm.enabler.model.url.ThemeResourceUrlImpl",[com.ibm.mm.enabler.model.url.BaseModelUrl],{constructor:function(_30e,_30f){this.modelSchema=_30e;this.model=_30f;this.httpUrl=new com.ibm.mm.enabler.utils.HttpUrl("/");this.httpUrl.setParameter("uri",this.modelSchema);},_updateURI:function(){var _310,url;if(this.nodes.length==2){var _311=this.nodes[0].value;_310=this.nodes[1].value;var _312=this.model.find(_311).start();url=_312._getBaseUrl();this.httpUrl=new com.ibm.mm.enabler.utils.HttpUrl(url+_310);}else{if(this.nodes.length==3){var _313=this.nodes[0].value;_310=this.nodes[2].value;var _314=this.model.find(_313).start();url=_314._getBaseUrl();this.httpUrl=new com.ibm.mm.enabler.utils.HttpUrl(url+_310);}else{this.httpUrl=new com.ibm.mm.enabler.utils.HttpUrl("/");}}}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl");dojo.declare("com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl",[com.ibm.mm.enabler.model.url.BaseModelUrl],{constructor:function(url,_315){if(!com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT){com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.PRIVATE_HANDLER=com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT+com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PRIVATE);com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.PUBLIC_HANDLER=com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT+com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PUBLIC);}if(url.indexOf("?")===0){var _316=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.ANONYMOUS_USER);var _317;if(_316){_317=com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.PUBLIC_HANDLER;}else{_317=com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.PRIVATE_HANDLER;}var _318="";_318+=_317;url=_318+url;}this.httpUrl=new com.ibm.mm.enabler.utils.HttpUrl(url);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.ModelUrlFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.ModelUrlFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.ModelUrlFactoryImpl");dojo.declare("com.ibm.mm.enabler.model.url.ModelUrlFactoryImpl",[com.ibm.mashups.enabler.model.url.ModelUrlFactory],{WEBDAV_URL:"webdav",constructor:function(){this.schemeMap={};this.schemeMap[this.NAVIGATION_URL]="nm";this.schemeMap[this.SHARED_NAVIGATION_URL]="snm";this.schemeMap[this.FRAGMENT_URL]="fragment";this.schemeMap[this.FRAGMENT_MEDIA_URL]="fragment-media";this.schemeMap[this.USER_URL]="um";this.schemeMap[this.THEME_URL]="theme";this.schemeMap[this.THEME_MEDIA_URL]="theme-media";this.schemeMap[this.CATALOG_URL]="catalog";this.schemeMap[this.CONFIG_URL]="config";this.schemeMap[this.SPACE_URL]="space";this.schemeMap[this.SPACE_FAVORITE_URL]="space-favorite";this.schemeMap[this.AC_URL]="ac";this.schemeMap[this.AI_URL]="ai";this.schemeMap[this.TEMPLATE_URL]="template";this.schemeMap[this.LAYOUT_URL]="lm";this.schemeMap.service="service";this.schemeMap[this.WEBDAV_URL]="dav:mmdav";this.schemeMap[this.WIDGET_URL]="wm";this.schemeMap[this.EVENT_URL]="ce";},createModelUrl:function(_319,_31a){return this.createModelURL(_319,_31a);},createModelURL:function(_31b,_31c){var _31d="createModelURL(urlType, model)";var _31e=com.ibm.mashups.enabler.model.url.ModelUrlFactory.LOGGER.isLoggable(com.ibm.mashups.enabler.logging.LogLevel.TRACE);if(_31e){com.ibm.mashups.enabler.model.url.ModelUrlFactory.LOGGER.entering(_31d,[_31b,_31c]);}var _31f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.schemeMap[_31b];if(_31e){com.ibm.mashups.enabler.model.url.ModelUrlFactory.LOGGER.trace(_31d,"modelSchema found for specified urlType: ${0}",_31b);}if(!_31f){return null;}var _320;if(_31b==this.THEME_MEDIA_URL){_320=new com.ibm.mm.enabler.model.url.ThemeResourceUrlImpl(_31f,_31c);}else{if(_31b==this.FRAGMENT_MEDIA_URL){_320=new com.ibm.mm.enabler.model.url.SchemeBasedModelMediaUrlImpl(_31f,_31c);}else{_320=new com.ibm.mm.enabler.model.url.SchemeBasedModelUrlImpl(_31f,_31c);}}if(_31e){com.ibm.mashups.enabler.model.url.ModelUrlFactory.LOGGER.exiting(_31d,_320);}return _320;},getModelUrl:function(url,_321){return this.getModelURL(url,_321);},getModelURL:function(url,_322){return new com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl(url,_322);}});com.ibm.mm.enabler.model.UrlFactory=new com.ibm.mm.enabler.model.url.ModelUrlFactoryImpl();com.ibm.mashups.enabler.model.url.ModelUrlFactory=com.ibm.mm.enabler.model.UrlFactory;com.ibm.mashups.enabler.model.url.ModelUrlFactory.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mashups.enabler.model.url.ModelUrlFactory");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrlFactory"]){dojo._hasResource["com.ibm.mashups.enabler.model.url.ModelUrlFactory"]=true;dojo.provide("com.ibm.mashups.enabler.model.url.ModelUrlFactory");}if(!dojo._hasResource["com.ibm.mm.enabler.SubmittableFormProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.SubmittableFormProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.SubmittableFormProviderImpl");dojo.declare("com.ibm.mm.enabler.SubmittableFormProviderImpl",com.ibm.mashups.enabler.SubmittableFormProvider,{constructor:function(){},getSubmittableForm:function(id){var _323=null;var url;if(id=="spaceForm"){url=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.SPACE_URL,null);url.setNodes([{value:"collection",isID:false}]);url.setParameter("mode","import");url.setParameter("mime-type","text/html");url=url.toProxifiedString();_323=new com.ibm.mm.enabler.SubmittableFormImpl(url,"post",id);}else{if(id=="pageForm"){var _324=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_RESOURCE);url=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_324.url,this);url.setParameter("mode","import");url.setParameter("mime-type","text/html");if(arguments[1]){url.setParameter("spaceId",arguments[1]);}url=url.toProxifiedString();_323=new com.ibm.mm.enabler.SubmittableFormImpl(url,"post",id);}else{if(id=="spacePageForm"){url=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.SPACE_URL,null);url.setNodes([{value:"collection",isID:false}]);url.setParameter("mode","import");url.setParameter("mime-type","text/html");if(arguments[1]){url.setParameter("spaceId",arguments[1]);}var _325=null;if(arguments[2]){_325=arguments[2];}url=url.toProxifiedString();_323=new com.ibm.mm.enabler.SubmittableFormImpl(url,"post",_325);}}}return _323;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.SubmittableFormProvider"]){dojo._hasResource["com.ibm.mashups.enabler.SubmittableFormProvider"]=true;dojo.provide("com.ibm.mashups.enabler.SubmittableFormProvider");}if(!dojo._hasResource["com.ibm.mashups.enabler.TimeStamped_API"]){dojo._hasResource["com.ibm.mashups.enabler.TimeStamped_API"]=true;dojo.provide("com.ibm.mashups.enabler.TimeStamped_API");dojo.provide("com.ibm.mashups.enabler.TimeStamped");dojo.declare("com.ibm.mashups.enabler.TimeStamped",null,{getCreated:function(){},getLastModified:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.TimeStamped"]){dojo._hasResource["com.ibm.mashups.enabler.TimeStamped"]=true;dojo.provide("com.ibm.mashups.enabler.TimeStamped");}if(!dojo._hasResource["com.ibm.mashups.enabler.Transformable_API"]){dojo._hasResource["com.ibm.mashups.enabler.Transformable_API"]=true;dojo.provide("com.ibm.mashups.enabler.Transformable_API");dojo.provide("com.ibm.mashups.enabler.Transformable");dojo.declare("com.ibm.mashups.enabler.Transformable",null,{getXml:function(){},setXml:function(xml){}});}if(!dojo._hasResource["com.ibm.mm.enabler.TransformableImpl"]){dojo._hasResource["com.ibm.mm.enabler.TransformableImpl"]=true;dojo.provide("com.ibm.mm.enabler.TransformableImpl");dojo.declare("com.ibm.mm.enabler.TransformableImpl",[com.ibm.mashups.enabler.Transformable,com.ibm.mm.enabler.DirtyFlagProviderImpl],{constructor:function(){},getXml:function(){return this.xmlData;},setXml:function(xml,_326){this.xmlData=xml;if(!_326){this._setDirty();}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.Transformable"]){dojo._hasResource["com.ibm.mashups.enabler.Transformable"]=true;dojo.provide("com.ibm.mashups.enabler.Transformable");}if(!dojo._hasResource["com.ibm.mashups.enabler.TreeModel"]){dojo._hasResource["com.ibm.mashups.enabler.TreeModel"]=true;dojo.provide("com.ibm.mashups.enabler.TreeModel");dojo.declare("com.ibm.mashups.enabler.TreeModel",[com.ibm.mashups.enabler.model.Model,com.ibm.mashups.enabler.Locator],{getRoot:function(){},hasChildren:function(node){},getChildren:function(node){},getParent:function(node){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.TreeModelController"]){dojo._hasResource["com.ibm.mashups.enabler.TreeModelController"]=true;dojo.provide("com.ibm.mashups.enabler.TreeModelController");dojo.declare("com.ibm.mashups.enabler.TreeModelController",com.ibm.mashups.enabler.TreeModel,{create:function(_327){},confirmCreate:function(_328){},insert:function(node,_329,_32a){},confirmInsert:function(node,_32b,_32c){},remove:function(node){},confirmRemove:function(node){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipart_API"]){dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipart_API"]=true;dojo.provide("com.ibm.mashups.enabler.io.XHRMultipart_API");dojo.provide("com.ibm.mashups.enabler.io.XHRMultipart");dojo.declare("com.ibm.mashups.enabler.io.XHRMultipart",null,{constructor:function(){},startTransaction:function(){},endTransactionDeferred:function(){},endTransaction:function(_32d,_32e){},suspendTransaction:function(){},resumeTransaction:function(){},isTransaction:function(){return false;}});}if(!dojo._hasResource["com.ibm.mm.enabler.encode.huffman.ZEncoder"]){dojo._hasResource["com.ibm.mm.enabler.encode.huffman.ZEncoder"]=true;dojo.provide("com.ibm.mm.enabler.encode.huffman.ZEncoder");dojo.declare("com.ibm.mm.enabler.encode.huffman.ZEncoder",null,{HEX_CHARS:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],UNSAFE_CHARS:"$&+,/:;=?@ <>#%{}|\\^~[]`\"Z",constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);},isUnsafeChar:function(_32f){if(this.UNSAFE_CHARS.indexOf(_32f)>-1||_32f.charCodeAt(0)<=32||_32f.charCodeAt(0)>=123){return true;}return false;},zEncode:function(_330){var _331="";for(var i=0;i<_330.length;++i){var _332=_330.charAt(i);if(!this.isUnsafeChar(_332)){_331+=_332;continue;}_331+=this.zEncodeChar(_332);}return _331;},zEncodeChar:function(_333){var _334="Z";return _334+this.byteToHex(_333.charCodeAt(0));},byteToHex:function(_335){var _336=Math.floor(_335/16);var _337=_335%16;return this.HEX_CHARS[_336]+this.HEX_CHARS[_337];},zDecode:function(_338){var _339="";var _33a="Z";if(_338.indexOf(_33a)!=-1){for(var i=0,l=_338.length;i<l;i++){var _33b=_338.charAt(i);if(_33b==_33a){var hex="0x"+_338.substr(i+1,2);i=i+2;try{var _33c=parseInt(hex,16);_339=_339.concat(String.fromCharCode(_33c));}catch(e){continue;}}else{_339=_339.concat(_338.substr(i,1));}}}else{_339=_338;}return _339;}});com.ibm.mm.enabler.encode.huffman.ZEncoder=new com.ibm.mm.enabler.encode.huffman.ZEncoder();}if(!dojo._hasResource["com.ibm.mm.enabler.encode.huffman.HuffmanURL"]){dojo._hasResource["com.ibm.mm.enabler.encode.huffman.HuffmanURL"]=true;dojo.provide("com.ibm.mm.enabler.encode.huffman.HuffmanURL");dojo.declare("com.ibm.mm.enabler.encode.huffman.HuffmanURL",null,{URL_ALPHABET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_!",LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},_encodeTokens:function(_33d,_33e,_33f){var len=_33f.length;for(var i=0;i<len;++i){this._addBits(_33d,_33e[_33f[i]].prefix);}return this._encodeStream(_33d);},_encodeStream:function(_340){var len=_340.dwords.length*4;if(_340.bits>0){_340.dwords.push(_340.dword);len+=((_340.bits+7)>>3);_340.bits=0;}return this._encodeBase64(_340.dwords,0,len);},_initStream:function(_341){_341.dword=0;_341.mask=1;_341.bits=0;_341.dwords=[];return _341;},_addBits:function(_342,data){var mask=_342.mask,_343=_342.dword,bits=_342.bits;var len=data.length,off=0;while(len>0){var copy=Math.min(len,32-bits);for(var i=0;i<copy;++i){if(data[off+i]==1){_343|=mask;}mask<<=1;}bits+=copy;len-=copy;off+=copy;if(bits==32){_342.dwords.push(_343);bits=0;mask=1;_343=0;}}_342.mask=mask;_342.bits=bits;_342.dword=_343;},_addBit:function(_344,bit){if(bit==1){_344.dword|=_344.mask;}_344.mask<<=1;_344.bits++;if(_344.bits==32){_344.dwords.push(_344.dword);_344.dword=0;_344.mask=1;_344.bits=0;}},_encodeBase64:function(data,off,len){var ab=this.URL_ALPHABET;var _345=off>>2;var _346=off&3;var _347=data[_345++],_348;var c1,c2,c3,c4;var _349="";for(var i=len;i>0;i-=3){switch(_346){case 0:c1=((_347>>2)&63);c2=((_347<<4)&48)|((_347>>12)&15);c3=((_347>>6)&60)|((_347>>22)&3);c4=((_347>>16)&63);_346=3;break;case 1:c1=((_347>>10)&63);c2=((_347>>4)&48)|((_347>>20)&15);c3=((_347>>14)&60)|((_347>>30)&3);c4=((_347>>24)&63);_346=0;_347=data[_345++];break;case 2:_348=data[_345++];c1=((_347>>18)&63);c2=((_347>>12)&48)|((_347>>28)&15);c3=((_347>>22)&60)|((_348>>6)&3);c4=(_348&63);_347=_348;_346=1;break;case 3:_348=data[_345++];c1=((_347>>26)&63);c2=((_347>>20)&48)|((_348>>4)&15);c3=((_348<<2)&60)|((_348>>14)&3);c4=((_348>>8)&63);_347=_348;_346=2;break;}switch(i){case 1:c3=64;c4=64;break;case 2:c4=64;break;}_349+=ab.charAt(c1);_349+=ab.charAt(c2);_349+=ab.charAt(c3);_349+=ab.charAt(c4);}return _349;},_decodeBase64:function(_34a){var ab=this.URL_ALPHABET;var len=_34a.length/4;var i=0;var _34b=[];for(var j=0;j<len;j++){var _34c=0;indexC1=ab.indexOf(_34a.charAt(i++));indexC2=ab.indexOf(_34a.charAt(i++));indexC3=ab.indexOf(_34a.charAt(i++));if(indexC3==64){_34c++;}indexC4=ab.indexOf(_34a.charAt(i++));if(indexC4==64){_34c++;}c1=(indexC1<<2)|(indexC2>>4);c2=((indexC2&15)<<4)|(indexC3>>2);c3=((indexC3&3)<<6)|indexC4;_34b.push(c1);switch(_34c){case 0:_34b.push(c2);_34b.push(c3);break;case 1:_34b.push(c2);break;case 2:break;}}return _34b;},_frequencyCompare:function(n1,n2){return n1.frequency-n2.frequency;},_initTree:function(_34d,node,_34e){if(node.left&&node.right){this._addBit(_34d,1);this._initTree(_34d,node.left,_34e.concat(0));this._initTree(_34d,node.right,_34e.concat(1));}else{this._addBit(_34d,0);node.prefix=_34e;_34d.tokens.push(node.name);}return _34d;},_dumpTokens:function(tree,_34f){var _350=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_350){for(var i=0;i<tree.tokens.length;++i){this.LOGGER.trace("_dumpTokens()","["+_34f[tree.tokens[i]].frequency+", \""+tree.tokens[i]+"\"]");}}},_buildTree:function(_351){var _352={};var len=_351.length;var node,i;for(i=len-1;i>=0;--i){var _353=_351[i];node=_352[_353];if(node){node.frequency++;}else{node={frequency:1,name:_353};_352[_353]=node;}}var _354=[];for(node in _352){if(Object.prototype.hasOwnProperty.call(_352,node)){_354.push(_352[node]);}}_354.sort(this._frequencyCompare);while(_354.length>1){var left=_354.shift(),_355=_354.shift();_354.push({frequency:left.frequency+_355.frequency,left:left,right:_355});_354.sort(this._frequencyCompare);}var root=_354[0];var tree=this._initTree(this._initStream({tokens:[]}),_354.shift(),[]);this._dumpTokens(tree,_352);var url=this._encodeStream(tree);len=tree.tokens.length;for(i=0;i<len;++i){url+="/"+com.ibm.mm.enabler.encode.huffman.ZEncoder.zEncode(tree.tokens[i]);}url+="/"+this._encodeTokens(this._initStream({}),_352,_351);return url;},_buildTreeFromRegex:function(data,_356){var _357=new RegExp(_356,"g");var pos=[];var _358;while((_358=_357.exec(data))){pos.push(_358.index);}if(pos[0]){pos.unshift(0);}if(pos[pos.length-1]!=data.length){pos.push(data.length);}var _359=[];for(_358=1;_358<pos.length;++_358){_359.push(data.substring(pos[_358-1],pos[_358]));}return this._buildTree(_359);},createRawSchemeSpecificPartFromTokens:function(_35a){return this._buildTree(_35a);},createRawSchemeSpecificPartFromRegex:function(data,_35b){return this._buildTreeFromRegex(data,_35b);},getDataFromHuffmanTree:function(tree){return this._restoreData(tree);},_restoreData:function(tree){if(!tree){return null;}var i0=tree.indexOf("/");var i1=tree.lastIndexOf("/");if((i0>=0)&&(i1>=0)){var _35c=this._decodeBase64(tree.substring(0,i0));var _35d=tree.substring(i0+1,i1).split("/");var _35e=this._decodeBase64(tree.substring(i1+1));encodedTokens=this._decodeTokens(_35d);var root=this._readStructure(this._convertBitToChar(_35c),encodedTokens);var _35f=this._convertBitToChar(_35e);var _360="";while(_35f.length>0){_360=this._buildData(_360,_35f,root);}return _360;}return null;},_buildData:function(_361,_362,root){var _363=false;var node=null;while(!_363){var bit=_362.shift();if(typeof bit=="undefined"){node=null;break;}node=this._getNode(bit,root);if(node&&node.token&&node.token){_363=true;}else{if(!node){_363=true;}}root=node;}if(_363&&node){_361=_361.concat(node.token);}return _361;},_getNode:function(bit,_364){var node=null;node=(bit==1)?_364.right:_364.left;if(!node){return null;}return node;},_convertBitToChar:function(_365){var arr=[];var mask=1;var bit=0;for(var i=0;i<_365.length;i++){var _366=_365[i];for(var j=0;j<8;j++){bit=_366&mask;arr.push(bit);_366=(_366>>1);}}return arr;},_readStructure:function(_367,_368){var bit=_367.shift();var node={};if(bit==1){node.left=this._readStructure(_367,_368);node.right=this._readStructure(_367,_368);}else{var _369=_368.shift();node.token=_369;}return node;},_decodeTokens:function(_36a){var arr=[];for(var i in _36a){if(Object.prototype.hasOwnProperty.call(_36a,i)){arr.push(com.ibm.mm.enabler.encode.huffman.ZEncoder.zDecode(_36a[i]));}}return arr;}});com.ibm.mm.enabler.encode.huffman.HuffmanURL=new com.ibm.mm.enabler.encode.huffman.HuffmanURL();}if(!dojo._hasResource["com.ibm.mm.enabler.ArrayMap"]){dojo._hasResource["com.ibm.mm.enabler.ArrayMap"]=true;dojo.provide("com.ibm.mm.enabler.ArrayMap");dojo.declare("com.ibm.mm.enabler.ArrayMap",null,{constructor:function(){this.entries=[];this.keys={};},values:function(){return this.entries;},put:function(key,_36b){var _36c=this.keys[key];if(typeof _36c!="undefined"&&_36c!==null){this.entries[_36c]=_36b;}else{_36c=this.entries.length;this.entries.push(_36b);this.keys[key]=_36c;}},getKey:function(_36d){if(_36d<this.entries.length){for(var key in this.keys){if(Object.prototype.hasOwnProperty.call(this.keys,key)){var temp=this.keys[key];if(temp!==null&&temp==_36d){return temp;}}}}else{return null;}},getValue:function(_36e){return (_36e<this.entries.length)?this.entries[_36e]:null;},get:function(key){var _36f=this.keys[key];if(typeof _36f!="undefined"&&_36f!==null){var _370=this.entries[_36f];return _370;}return null;},remove:function(key){var _371=this.keys[key];if(typeof _371!="undefined"&&_371!==null){this.entries.splice(_371,1);this.keys[key]=null;}return _371;},size:function(){return this.entries.length;},keySet:function(){var arr=[];com.ibm.mm.enabler.utils.Misc.forIn(this.keys,function(_372,key){arr.push(key);});return arr;}});}if(!dojo._hasResource["com.ibm.mm.enabler.io.XHRWrapper"]){dojo._hasResource["com.ibm.mm.enabler.io.XHRWrapper"]=true;dojo.provide("com.ibm.mm.enabler.io.XHRWrapper");dojo.declare("com.ibm.mm.enabler.io.XHRWrapper",null,{constructor:function(_373,_374,_375,_376,_377){this.ioArgs=_373;this.xhr=_373.xhr;this.readyState=_373.xhr.readyState;this.responseText=_374;this.responseXML=_373.xhr.responseXML;this.status=_375;this.statusText=_373.xhr.statusText;this.contentType=_376;this.partHeaders=_377;},getAllResponseHeaders:function(){return this.xhr.getAllResponseHeaders();},getInterface:function(){return this.xhr.getInterface();},getResponseHeader:function(_378){var _379=_378+"";if(this.partHeaders[_379]){return this.partHeaders[_379];}else{if(_379.toLowerCase()=="content-type"){return (this.contentType);}}return this.xhr.getResponseHeader(_378);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.io.DynamicResolver_API"]){dojo._hasResource["com.ibm.mashups.enabler.io.DynamicResolver_API"]=true;dojo.provide("com.ibm.mashups.enabler.io.DynamicResolver_API");dojo.provide("com.ibm.mashups.enabler.io.DynamicResolver");dojo.declare("com.ibm.mashups.enabler.io.DynamicResolver",null,{SERVICE_NAME:"dynamicResolver",register:function(id,_37a,_37b,_37c){},unregister:function(id){}});com.ibm.mashups.enabler.io.DynamicResolver.SERVICE_NAME="dynamicResolver";}if(!dojo._hasResource["com.ibm.mashups.enabler.io.DynamicResolver"]){dojo._hasResource["com.ibm.mashups.enabler.io.DynamicResolver"]=true;dojo.provide("com.ibm.mashups.enabler.io.DynamicResolver");}if(!dojo._hasResource["com.ibm.mm.enabler.io.DynamicResolver"]){dojo._hasResource["com.ibm.mm.enabler.io.DynamicResolver"]=true;dojo.provide("com.ibm.mm.enabler.io.DynamicResolver");dojo.declare("com.ibm.mm.enabler.io.DynamicResolver",com.ibm.mashups.enabler.io.DynamicResolver,{constructor:function(){this._plugins=[];var me=this,_37d=dojo.xhr;dojo.xhr=function(){var fn=me.getResolver.apply(me,arguments)||_37d;return fn.apply(this,arguments);};},_buildDfdFn:function(_37e,obj,_37f){var func=obj[_37e];return func?function(val){return func.call(obj,val,_37f);}:null;},resolve:function(_380,_381,_382,args,_383){var data=null,_384=false,dfd=new dojo.Deferred(),_385={args:args,url:com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(args.url)||args.url,handleAs:args.handleAs||"text",xhr:{readyState:4,responseXML:null,statusText:""}};dfd.addCallback(this._buildDfdFn("load",args,_385)).addErrback(this._buildDfdFn("error",args,_385)).addBoth(this._buildDfdFn("handle",args,_385));_385.xhr=new com.ibm.mm.enabler.io.XHRWrapper(_385,"",200,"text",{});try{data=_380(_385.url,_381);_385.xhr.status=200;if(data){_385.xhr.responseText=data;if(args.handleAs==="xml"&&typeof data==="string"){_385.xhr.responseXML=com.ibm.mm.enabler.utils.Dom.createDocument(data);}}}catch(err){_385.xhr.status=500;data=err;_385.xhr.responseText=err.toString();_384=true;}dfd[_384?"errback":"callback"](data);return dfd;},_embedValidation:function(fn,_386){var me=this;return function(_387,args,_388){return me.resolve(fn,_386,_387,args,_388);};},getResolver:function(_389,args,_38a){if(_389&&_389.toLowerCase()=="get"){for(var i=0,plg;i<this._plugins.length,plg=this._plugins[i];i++){var ret=plg[1](args.url);if(ret){return this._embedValidation(plg[2],ret);}}}return null;},register:function(id,_38b,_38c,_38d){this._plugins[_38d?"unshift":"push"]([id,_38b,_38c]);},unregister:function(id){for(var i=0;i<this._plugins.length;i++){if(id===this._plugins[i][0]){this._plugins.splice(i,1);return;}}}});com.ibm.mashups.services.ServiceManager.setService(com.ibm.mashups.enabler.io.DynamicResolver.SERVICE_NAME,"com.ibm.mm.enabler.io.DynamicResolver");}if(!dojo._hasResource["com.ibm.mm.enabler.io.XHRMultipartImpl"]){dojo._hasResource["com.ibm.mm.enabler.io.XHRMultipartImpl"]=true;dojo.provide("com.ibm.mm.enabler.io.XHRMultipartImpl");dojo.declare("com.ibm.mm.enabler.io.XHRMultipartImpl",[com.ibm.mashups.enabler.io.XHRMultipart,com.ibm.mm.enabler.ServiceDocConsumer],{LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,DYN_RES:com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.io.DynamicResolver.SERVICE_NAME),statics:{semaphore:0,digest:null,suspendedXhr:null},constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);var _38e="constructor()";var _38f=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_38f){this.LOGGER.entering(_38e);}this.method="POST";this.partsArray=null;var _390=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.correlateHosts=_390.getValue(com.ibm.mashups.enabler.services.ConfigConstants.MULTIPART_CORRELATE_HOSTS);this.correlatedHosts=null;this.cacheQueries=false;var _391=_390.getValue(com.ibm.mashups.enabler.services.ConfigConstants.MULTIPART_CACHE_QUERIES);if(typeof (_391)!=="undefined"&&_391!==null&&_391===true){this.cacheQueries=true;}this.privateUrl=_390.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT)+_390.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PRIVATE);this.publicUrl=_390.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT)+_390.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PUBLIC);this.doSiteMap=true;this.urlMaxLength=2000;this.boundary="{EB2F8DA2-5B2C-F66A-CDD0-A2D42143F5AC}";this.newL="\r\n";this.sep="--";this.startB=this.newL+this.sep+this.boundary+this.newL;this.endB=this.sep+this.boundary+this.sep+this.newL;this.headerRegx=new RegExp(this.newL+"s*([^\r]*)s*","mg");this.headerPartsRegx=/\s*([^:]*):\s*(.+)/;this.boundaryRegx=/boundary\s*=\s*\"?([^\"]*)\"?/;this.multipartParts=false;if(_38f){this.LOGGER.trace(_38e,"Multipart is enabled - ${0}",this.doMultipart);this.LOGGER.exiting(_38e);}},_initServiceDoc:function(){this.doMultipart=com.ibm.mashups.enabler.io.XHRMultipartFactory.isMultipartEnabled();if(this.doMultipart){this.serviceMPJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData([com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_MODEL,com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_MULTIPART]);this.serviceSMJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData([com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_MODEL,com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_HUFFMAN]);}this.inherited("_initServiceDoc",arguments);},_urlToProxyUrl:function(url,_392){var ret=_392?_392:"/proxy";var _393="http";var _394=url.indexOf("://");if(_394>-1){_393=url.substring(0,_394);url=url.substring(_394+3);}url=url.replace(/:/g,"%3A");return ret+"/"+_393+"/"+url;},_partHandler:function(_395,_396,_397,_398){for(var x in _395){if(Object.prototype.hasOwnProperty.call(_395,x)){var work=dojo.hitch(_395[x],function(){try{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_396,Error)){if(this.error){this.error(_396,_397,_398);}}else{if(_397.xhr.status>=400){if(this.error){this.error(new Error(_397.xhr.status+":  "+_398.URI),_397,_398);}}else{if(this.load){this.load(_396,_397,_398);}}}if(this.handle){this.handle(_396,_397,_398);}}catch(err){try{if(this.error){this.error(_396,_397,_398);}}catch(err2){}}});work();}}},_handleMultiPartResponse:function(_399,_39a,_39b,_39c,_39d){var _39e=_39d.xhr.getResponseHeader("Content-Type").match(_39b.boundaryRegx);if(!_39e){throw new Error("No boundary specified in Content-Type response header");}var _39f=_39e[1];var _3a0=new RegExp(_39b.newL+_39b.sep+_39f,"mg");var _3a1=_39c.split(_3a0);var _3a2=null;if(_39a){_3a2=new com.ibm.mm.enabler.io.XHRMultipartImpl();_3a2.startTransaction();}var i=1;for(var _3a3 in _399){if(Object.prototype.hasOwnProperty.call(_399,_3a3)){var _3a4=_399[_3a3];var part=_3a1[i++];var _3a5={};var _3a6=null;var _3a7=null;var _3a8=null;_39b.headerRegx.lastIndex=0;while((_3a6=_39b.headerRegx.exec(part))!==null&&(_3a6[1].length>0)){if(-1==_3a6[1].indexOf(":")){continue;}if(-1==_3a6[1].indexOf("digest=")){var _3a9=_3a6[1].match(_39b.headerPartsRegx);_3a5[_3a9[1]]=_3a9[2];if(_3a9[1]=="X-Status-Code"){_3a7=_3a9[2];}else{if(_3a9[1]=="Content-Type"){_3a8=_3a9[2];}}}}part=dojo.string.trim(part.substr(_39b.headerRegx.lastIndex+_39b.newL.length));var _3aa=part;if(_3a4[0].handleAs=="xml"){part=com.ibm.mm.enabler.utils.Dom.createDocument(part);}else{part=dojo.contentHandlers[_3a4[0].handleAs]({responseText:part});}var _3ab=parseInt(_3a7,10);var _3ac=new com.ibm.mm.enabler.io.XHRWrapper(_39d,_3aa,_3ab,_3a8,_3a5);var xhr=_39d.xhr;_39d.xhr=_3ac;_39b._partHandler(_3a4,part,_39d,_3a5);_39d.xhr=xhr;}}if(_39a){_3a2.endTransactionDeferred().start();}},_multiPartXhr:function(_3ad,args,_3ae,_3af){var body="";var _3b0=null;for(var _3b1 in _3ae){if(Object.prototype.hasOwnProperty.call(_3ae,_3b1)){var part=_3ae[_3b1][0];part.handleAs=part.handleAs?part.handleAs.toLowerCase():"text";_3b0="";for(var x in part.headers){if(Object.prototype.hasOwnProperty.call(part.headers,x)){_3b0+=x+": "+part.headers[x]+this.newL;}}body+=this.startB+_3b0+this.newL;if(part.data&&part.data.length>1){body+=part.data+this.newL;}else{if(part.postData&&part.postData.length>1){body+=part.postData+this.newL;}else{if(part.putData&&part.putData.length>1){body+=part.putData+this.newL;}}}}}body+=this.endB;if(_3ad.toUpperCase()!="PUT"){_3ad="POST";}var me=this;var _3b2;var _3b3=dojo.mixin({},args,{load:function(_3b4,_3b5){me._handleMultiPartResponse(_3ae,_3af,me,_3b4,_3b5);_3b2=_3b5.xhr.status;},error:function(_3b6,_3b7){dojo.forEach(_3ae,function(part){me._partHandler(part,_3b6,_3b7,null);});_3b2=_3b7.xhr.status;},headers:{"Content-type":"multipart/mixed; boundary=\""+me.boundary+"\""},handleAs:"text",form:null,content:null,postData:null,putData:null});_3b3[_3ad.toLowerCase()+"Data"]=body;dojo.xhr(_3ad,_3b3,true);return _3b2;},suspendTransaction:function(){if(0===this.statics.semaphore){return;}if(this.statics.suspendedXhr){return;}this.statics.suspendedXhr=dojo.xhr;dojo.xhr=this.statics.oldXhr;},resumeTransaction:function(){if(0===this.statics.semaphore){return;}if(!this.statics.suspendedXhr){return;}dojo.xhr=this.statics.suspendedXhr;this.statics.suspendedXhr=null;},startTransaction:function(){var _3b8="startTransaction()";var _3b9=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3b9){this.LOGGER.entering(_3b8);}this._initServiceDoc();if(!this.doMultipart){if(_3b9){this.LOGGER.exiting(_3b8);}return;}this._acquire();if(1<this.statics.semaphore){if(_3b9){this.LOGGER.exiting(_3b8);}return;}if(this.correlateHosts){this.correlatedHosts=new com.ibm.mm.enabler.ArrayMap();}else{this.partsArray=[];}this.statics.oldXhr=dojo.xhr;dojo.xhr=dojo.hitch(this,function(_3ba,args,_3bb){var _3bc="mp - dojo.hitch()";var _3bd=this.LOGGER.isLoggable(this.LOG_LEVEL);var dfd;if(_3bd){this.LOGGER.entering(_3bc,[_3ba,args,_3bb]);}if(args.sync){dfd=this.statics.oldXhr(_3ba,args,_3bb);if(_3bd){this.LOGGER.exiting(_3bc);}return dfd;}var res=this.DYN_RES.getResolver.apply(this.DYN_RES,arguments);if(res){dfd=res.apply(this,arguments);if(_3bd){this.LOGGER.exiting(_3bc);}return dfd;}var _3be=new com.ibm.mm.enabler.utils.HttpUrl(args.url);var _3bf=_3be.getParameter("uri");if(this.doSiteMap&&_3ba!="GET"){this.doSiteMap=false;}else{if(this.doSiteMap&&(!this.cacheQueries)&&(_3ba=="GET")&&(_3bf)&&(null!==_3bf)){this.doSiteMap=false;}}args.method=_3ba;if(this.correlateHosts){var _3c0=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PROXY_URL);var _3c1=_3be.server;if(null!==_3c0){_3c0+="/";if(args.url.indexOf(_3c0)===0){var _3c2=args.url.indexOf("/",_3c0.length);_3c1=args.url.substring(0,_3c2);}}var _3c3=this.correlatedHosts.get(_3c1);if(!_3c3){_3c3=[];this.correlatedHosts.put(_3c1,_3c3);}this._addToPartsArray(_3c3,args);}else{this._addToPartsArray(this.partsArray,args);}if(_3bd){this.LOGGER.exiting(_3bc);}});if(_3b9){this.LOGGER.exiting(_3b8);}},isTransaction:function(){return (0<this.statics.semaphore);},_encodeUrl:function(url,_3c4){if(_3c4){return escape(url).replace(/\+/g,"%2B").replace(/%20/g,"+").replace(/\*/g,"%2A").replace(/\//g,"%2F").replace(/@/g,"%40").replace(/%21/g,"!");}return escape(url).replace(/\+/g,"%2B").replace(/%20/g,"+").replace(/\*/g,"%2A").replace(/\//g,"%2F").replace(/@/g,"%40");},_createHuffmanUrl:function(_3c5){var _3c6="_createHuffmanUrl(parts)";var _3c7=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3c7){this.LOGGER.entering(_3c6,[_3c5]);}var cxml=this._createSiteMap(_3c5);if(_3c7){this.LOGGER.trace(_3c6,"sitemap:  ${0}",cxml);}cxml=com.ibm.mm.enabler.encode.huffman.HuffmanURL.createRawSchemeSpecificPartFromRegex(cxml,"[/ ]");if(_3c7){this.LOGGER.trace(_3c6,"huffman encoded:  ${0}",cxml);}var url;this._initServiceDoc();if(this.serviceSMJson.template.indexOf("{uri_code}")!=-1){cxml=this._encodeUrl(cxml,true);if(_3c7){this.LOGGER.trace(_3c6,"code is a parameter, encoding:  ${0}",cxml);}url=this.serviceSMJson.template.replace(/\{uri_code\}/,cxml);}else{url=this.serviceSMJson.template.replace(/\{code\}/,cxml);}if(_3c7){this.LOGGER.exiting(_3c6,url);}return url;},_loadResources:function(_3c8){var _3c9="_loadResources(parts)";var _3ca=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3ca){this.LOGGER.entering(_3c9,[_3c8]);}var _3cb;if(this.doSiteMap){url=this._createHuffmanUrl(_3c8);if(_3ca){this.LOGGER.trace(_3c9,"url:  ${0}",url);}if(url.length>this.urlMaxLength){if(_3ca){this.LOGGER.trace(_3c9,"url is too long, falling back to POST");}_3cb=this._doMultipartPOSTRequest(this.method,_3c8,this.multipartParts);}else{var me=this;xhrArgs={url:url,load:function(_3cc,_3cd){me._handleMultiPartResponse(_3c8,me.multipartParts,me,_3cc,_3cd);_3cb=_3cd.xhr.status;},error:function(_3ce,_3cf){dojo.forEach(_3c8,function(part){me._partHandler(part,_3ce,_3cf,null);});_3cb=_3cf.xhr.status;},handleAs:"text"};dojo.xhrGet(xhrArgs,true);}}else{_3cb=this._doMultipartPOSTRequest(this.method,_3c8,this.multipartParts);}return _3cb;},endTransaction:function(_3d0,_3d1,_3d2){var _3d3="endTransaction(callback, parameters)";var _3d4=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3d4){this.LOGGER.entering(_3d3,[_3d0,_3d1,_3d2]);}if(!this.doMultipart){if(_3d4){this.LOGGER.exiting(_3d3);}return;}this._release();if(0<this.statics.semaphore){if(_3d4){this.LOGGER.exiting(_3d3);}return;}if(_3d4){this.LOGGER.trace(_3d3,"Putting back the XHR");}dojo.xhr=this.statics.oldXhr;var _3d5=false;if(_3d0!==undefined){_3d5=_3d0;}var url;var _3d6;var me=this;if(this.correlateHosts){var _3d7=this.correlatedHosts.values();for(var i in _3d7){if(Object.prototype.hasOwnProperty.call(_3d7,i)){this._loadResources(_3d7[i]);}}}else{if(0===this._assocArraySize(this.partsArray)){return;}this._loadResources(this.partsArray);}if(_3d1){_3d1(_3d2);}if(_3d4){this.LOGGER.exiting(_3d3);}},endTransactionDeferred:function(_3d8){if(typeof _3d8!=="undefined"&&true===_3d8){this.multipartParts=true;}return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._endTransaction);},_endTransaction:function(_3d9,sync){var _3da="_endTransaction(deferred, sync)";var _3db=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3db){this.LOGGER.entering(_3da,[_3d9,sync]);}if(!this.doMultipart){if(_3db){this.LOGGER.exiting(_3da);}return;}this._release();if(0<this.statics.semaphore){if(_3db){this.LOGGER.exiting(_3da);}return;}if(_3db){this.LOGGER.trace(_3da,"Putting back the XHR");}dojo.xhr=this.statics.oldXhr;var url;var _3dc;var me=this;var _3dd;if(this.correlateHosts){var _3de=this.correlatedHosts.values();for(var i in _3de){if(Object.prototype.hasOwnProperty.call(_3de,i)){_3dd=this._loadResources(_3de[i]);}}}else{if(0===this._assocArraySize(this.partsArray)){return;}_3dd=this._loadResources(this.partsArray);}if(_3d9){var _3df=_3d9.getOperationCallback();if(_3df){_3df(id,com.ibm.mashups.enabler.DeferredOperation.OPERATION_GET,xhr.status,myDeferred.getOperationCallbackParameters());}}if(_3db){this.LOGGER.exiting(_3da);}},_doMultipartPOSTRequest:function(_3e0,_3e1,_3e2){this._processMultipartBody(_3e1);this._initServiceDoc();var _3e3={url:this.serviceMPJson.url,sync:true};var _3e4=this._multiPartXhr(_3e0,_3e3,_3e1,_3e2);return _3e4;},_assocArraySize:function(_3e5){var size=0;for(var x in _3e5){if(Object.prototype.hasOwnProperty.call(_3e5,x)){size++;}}return size;},_addToPartsArray:function(_3e6,args){var _3e7=_3e6[args.url];if(!_3e7){_3e6[args.url]=[];_3e6[args.url][0]=args;}else{_3e7[_3e7.length]=args;}},_acquire:function(){this.statics.semaphore++;},_release:function(_3e8,_3e9){this.statics.semaphore--;},_createPocURI:function(args){var _3ea="_createPocURI(args)";var _3eb=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3eb){this.LOGGER.entering(_3ea,args);}var url=args.url;var _3ec=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PROXY_URL);var _3ed=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.LOCALAPPS_REGEX);_3ec+="/http/";if(url.indexOf(_3ec)===0){var _3ee="http://";var _3ef=url.indexOf("/",_3ec.length+1);if(_3ef>-1){_3ee+=unescape(url.substring(_3ec.length,_3ef));_3ee+=url.substring(_3ef);}else{_3ee="http://"+url.substring(_3ec.length);}url=_3ee;}var _3f0=new com.ibm.mm.enabler.utils.HttpUrl(url);if(args.content){for(var name in args.content){var _3f1=args.content[name];_3f0.addParameter(name,_3f1);}}var uri="";var _3f2=_3f0.isProxyNeeded();var _3f3=false;if(_3ed){var _3f4=new RegExp(_3ed);_3f3=url.match(_3f4);}if((_3f2)||(_3f3)){uri=_3f0.toString();}else{uri="res:"+_3f0.toServerRelativeString();}if(_3eb){this.LOGGER.trace(_3ea,"proxy? ${0}: ${1}",[_3f2,uri]);}if(_3eb){this.LOGGER.exiting(_3ea,uri);}return uri;},_processMultipartBody:function(_3f5){var _3f6="_processMultipartBody(parts)";var _3f7=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3f7){this.LOGGER.entering(_3f6,_3f5);}for(var w in _3f5){if(Object.prototype.hasOwnProperty.call(_3f5,w)){var args=_3f5[w][0];var uri=this._createPocURI(args);var _3f8=uri;args.headers=dojo.mixin({},args.headers,{"X-Method-Override":args.method,"Content-ID":_3f8});}}if(_3f7){this.LOGGER.exiting(_3f6);}},_createSiteMap:function(_3f9){var _3fa="_createSiteMap(parts)";var _3fb=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_3fb){this.LOGGER.entering(_3fa,_3f9);}var cxml="<mashup:sitemap xmlns:mashup=\"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.2/mashup-sitemap\">";for(var w in _3f9){if(Object.prototype.hasOwnProperty.call(_3f9,w)){var args=_3f9[w][0];args.handleAs=args.handleAs?args.handleAs.toLowerCase():"text";var uri=this._createPocURI(args).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;");cxml+="<mashup:entry uri=\""+uri+"\" mode=\"download\"/>";}}cxml+="</mashup:sitemap>";if(_3fb){this.LOGGER.exiting(_3fa,cxml);}return cxml;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipart"]){dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipart"]=true;dojo.provide("com.ibm.mashups.enabler.io.XHRMultipart");}if(!dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipartFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipartFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.io.XHRMultipartFactory_API");dojo.provide("com.ibm.mashups.enabler.io.XHRMultipartFactory");dojo.declare("com.ibm.mashups.enabler.io.XHRMultipartFactory",null,{create:function(){},isMultipartEnabled:function(){},isMultipartApplicationWidgets:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.io.XHRMultipartFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.io.XHRMultipartFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.io.XHRMultipartFactoryImpl");dojo.declare("com.ibm.mm.enabler.io.XHRMultipartFactoryImpl",[com.ibm.mashups.enabler.io.XHRMultipartFactory,com.ibm.mm.enabler.ServiceDocConsumer],{constructor:function(){this._init=false;this.serviceMPJson=null;this.doMultipart=false;var _3fc=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _3fd=_3fc.getValue(com.ibm.mashups.enabler.services.ConfigConstants.PAGE_LOAD_OPTIMIZATION_APP_WIDGETS);this.multipartAppWidgets=false;if(typeof (_3fd)=="undefined"||_3fd===null||_3fd===true){this.multipartAppWidgets=true;}},_initServiceDoc:function(){if(dojo.exists("com.ibm.mm.enabler.model.ServiceDocumentModel")){this.serviceMPJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData([com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_MODEL,com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_MULTIPART]);}if(this.serviceMPJson&&this.serviceMPJson.url){this.doMultipart=true;}this.inherited("_initServiceDoc",arguments);},create:function(){return new com.ibm.mm.enabler.io.XHRMultipartImpl();},isMultipartEnabled:function(){if(!this._init){this._init=true;var _3fe=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _3ff=_3fe.getValue(com.ibm.mashups.enabler.services.ConfigConstants.MULTIPART_ENABLED);if(dojo.isIE!=6&&_3ff){this._initServiceDoc();}}return this.doMultipart;},isMultipartApplicationWidgets:function(){return this.multipartAppWidgets;}});com.ibm.mashups.enabler.io.XHRMultipartFactory=new com.ibm.mm.enabler.io.XHRMultipartFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipartFactory"]){dojo._hasResource["com.ibm.mashups.enabler.io.XHRMultipartFactory"]=true;dojo.provide("com.ibm.mashups.enabler.io.XHRMultipartFactory");dojo.require("com.ibm.mm.enabler.io.XHRMultipartFactoryImpl");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.Accessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.Accessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.Accessor");dojo.declare("com.ibm.mashups.enabler.model.state.Accessor",null,{});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.PageAccessor_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.PageAccessor_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.PageAccessor_API");dojo.provide("com.ibm.mashups.enabler.model.state.PageAccessor");dojo.declare("com.ibm.mashups.enabler.model.state.PageAccessor",[com.ibm.mashups.enabler.model.state.Accessor],{getPageID:function(){},setPageID:function(_400){},confirmSetPageID:function(_401){return true;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.PageAccessorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.PageAccessorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.PageAccessorImpl");dojo.declare("com.ibm.mm.enabler.model.state.PageAccessorImpl",[com.ibm.mashups.enabler.model.state.PageAccessor],{constructor:function(_402,_403){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);if(this.bIsLoggable){this.LOGGER.entering("constructor");this.LOGGER.trace("constructor","spaceId:"+_403);}this.navStateModel=_402;if(_403){this.spaceid=_403;}},getPageID:function(){var _404=this.navStateModel._state;var rc=null;if(!_404){return null;}if(!this.spaceid){if(_404.pid){if(this.bIsLoggable){this.LOGGER.trace("getPageID","No required pace is defined, return Pageid"+_404.pid.value);}return _404.pid.value;}if(this.bIsLoggable){this.LOGGER.trace("getPageID","No required space is defined, no pid is defined in state  return null");}return null;}else{if(_404.pageselection&&_404.pageselection[this.spaceid]){if(this.bIsLoggable){this.LOGGER.trace("getPageID","return pid:"+_404.pageselection[this.spaceid]+" for space:"+this.spaceid);}return _404.pageselection[this.spaceid].value;}if(this.bIsLoggable){this.LOGGER.trace("getPageID","No page is found for required space "+this.spaceid+" return null");}return null;}if(this.bIsLoggable){this.LOGGER.trace("getPageID","return null");}return null;},setPageID:function(_405){if(this.bIsLoggable){this.LOGGER.trace("setPageID","pageId:"+_405);}var _406=this.navStateModel._state;if(!_406){this.navStateModel._state={};_406=this.navStateModel._state;}if(!_405){_406.pid=null;if(this.spaceid){if(_406.pageselection&&_406.pageselection[this.spaceid]){_406.pageselection[this.spaceid]=null;}}this.navStateModel.setDirty(true,"pid");return;}var lm=new Date().getTime();_406.pid=_406.pid?_406.pid:{};_406.pid.value=_405;_406.pid.params=_406.pid.params?_406.pid.params:{};_406.pid.params.lm=lm;if(this.spaceid){if(!_406.pageselection){_406.pageselection={};}if(!_406.pageselection[this.spaceid]){_406.pageselection[this.spaceid]={};}_406.pageselection[this.spaceid].value=_405;_406.pageselection[this.spaceid].params=_406.pageselection[this.spaceid].params?_406.pageselection[this.spaceid].params:{};_406.pageselection[this.spaceid].params.lm=lm;}this.navStateModel.setDirty(true,"pid");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.PageAccessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.PageAccessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.PageAccessor");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.SpaceAccessor_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.SpaceAccessor_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.SpaceAccessor_API");dojo.provide("com.ibm.mashups.enabler.model.state.SpaceAccessor");dojo.declare("com.ibm.mashups.enabler.model.state.SpaceAccessor",[com.ibm.mashups.enabler.model.state.Accessor],{getSpaceID:function(){},setSpaceID:function(_407){},confirmSetSpaceID:function(_408){return true;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.SpaceAccessorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.SpaceAccessorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.SpaceAccessorImpl");dojo.declare("com.ibm.mm.enabler.model.state.SpaceAccessorImpl",[com.ibm.mashups.enabler.model.state.SpaceAccessor],{constructor:function(_409){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);if(this.bIsLoggable){this.LOGGER.entering("constructor");}this.navStateModel=_409;},getSpaceID:function(){var _40a=this.navStateModel._state;if(!_40a){return null;}if(_40a.sid&&_40a.sid.value){if(this.bIsLoggable){this.LOGGER.trace("getSpaceID","sid:"+_40a.sid.value);}return _40a.sid.value;}if(this.bIsLoggable){this.LOGGER.trace("getSpaceID","sid:null");}return null;},setSpaceID:function(_40b){if(this.bIsLoggable){this.LOGGER.trace("setSpaceID","sid:"+_40b);}var _40c=this.navStateModel._state;if(!_40c){this.navStateModel._state={};_40c=this.navStateModel._state;}var lm=new Date().getTime();_40c.sid=_40c.sid?_40c.sid:{};_40c.sid.value=_40b;_40c.sid.params=_40c.sid.params?_40c.sid.params:{};_40c.sid.params.lm=lm;if(_40c.pid){_40c.pid=null;}this.navStateModel.setDirty(true,"sid");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.SpaceAccessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.SpaceAccessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.SpaceAccessor");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.WidgetAccessor_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.WidgetAccessor_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.WidgetAccessor_API");dojo.provide("com.ibm.mashups.enabler.model.state.WidgetAccessor");dojo.declare("com.ibm.mashups.enabler.model.state.WidgetAccessor",[com.ibm.mashups.enabler.model.state.Accessor],{constructor:function(_40d,id){},getWidgetID:function(){},getWidgetStateValues:function(key){},getWidgetState:function(key){},setWidgetState:function(key,_40e){},confirmSetWidgetState:function(key,_40f){return true;},setWidgetState:function(key,_410){},confirmSetWidgetState:function(key,_411){return true;},removeWidgetState:function(key){},confirmRemoveWidgetState:function(key){return true;},getWidgetStateNames:function(){},getWidgetMode:function(){},setWidgetMode:function(mode){},confirmSetWidgetMode:function(mode){return true;},getWindowState:function(){},setWindowState:function(_412){},confirmSetWindowState:function(_413){return true;},getSize:function(){},setSize:function(_414,_415){},confirmSetSize:function(_416,_417){return true;},MIN:"minimize",MAX:"maximize",NORMAL:"normal"});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.WidgetAccessorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.WidgetAccessorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.WidgetAccessorImpl");dojo.declare("com.ibm.mm.enabler.model.state.WidgetAccessorImpl",[com.ibm.mashups.enabler.model.state.WidgetAccessor],{constructor:function(_418,id){this.navStateModel=_418;this.wid=id;this.uniqueWid=this._getUniqueWid();this.widgetNavStateNode=_418._find(this.WIDGET_PREFIX+this.navStateModel.DELIMITER+this.uniqueWid);if(this.wid!=this.uniqueWid&&!this.widgetNavStateNode){this.widgetNavStateNodeFallback=_418._find(this.WIDGET_PREFIX+this.navStateModel.DELIMITER+this.wid);}},WIDGET_PREFIX:"wparams",WIDTH:"w",HEIGHT:"h",WINDOWSTATE:"st",SYSTEMSTATE:"rp",CUSTOMSTATE:"cp",VALUE:"value",PARAMS:"params",MODE:"md",RP:{w:"w",h:"h",st:"st",md:"md"},VIEW:"view",getWidgetID:function(){return this.wid;},_getUniqueWid:function(){return this.navStateModel._getUniqueWid(this.wid);},getWidgetStateSet:function(){var _419=null;if(!this.widgetNavStateNode&&!this.widgetNavStateNodeFallback){return null;}var _41a=this.widgetNavStateNode;if(!_41a){_41a=this.widgetNavStateNodeFallback;}var data=_41a.getRef();if(data&&data[this.VALUE]){if(data[this.VALUE][this.CUSTOMSTATE]){_419=data[this.VALUE][this.CUSTOMSTATE];}}if((_419!=null)&&(!dojo.isString(_419))){_419=dojo.toJson(_419);}return _419;},_createWidgetNavStateNode:function(){var _41b=this.navStateModel.create({key:this.uniqueWid});var _41c=this.navStateModel._find(this.WIDGET_PREFIX);if(!_41c){var temp=this.navStateModel.create({key:this.WIDGET_PREFIX});this.navStateModel.insert(temp,this.navStateModel._getRoot());_41c=this.navStateModel._find(this.WIDGET_PREFIX);}this.navStateModel.insert(_41b,_41c);_41b=this.navStateModel._find(this.WIDGET_PREFIX+this.navStateModel.DELIMITER+this.uniqueWid);return _41b;},setWidgetStateSet:function(_41d){var _41e=null;if(dojo.isString(_41d)){_41d=dojo.fromJson(_41d);}if(!this.widgetNavStateNode){this.widgetNavStateNode=this._createWidgetNavStateNode();}var data=this.widgetNavStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();if(data&&data[this.VALUE]){if(data[this.VALUE][this.CUSTOMSTATE]){_41e=dojo.clone(data[this.VALUE][this.CUSTOMSTATE]);}}data[this.VALUE]=data[this.VALUE]?data[this.VALUE]:{};var obj=_41d;if(_41e&&!dojo.isString(_41d)){obj=dojo.mixin(_41e,_41d);}data[this.VALUE][this.CUSTOMSTATE]=obj;this.navStateModel.setDirty(true);return this;},_getWidgetSystemState:function(key){var _41f=null;if(!this.widgetNavStateNode&&!this.widgetNavStateNodeFallback){return null;}var _420=this.widgetNavStateNode;if(!_420){_420=this.widgetNavStateNodeFallback;}var data=_420.getRef();if(data&&data[this.VALUE]){if(data[this.VALUE][this.SYSTEMSTATE]){data=data[this.VALUE][this.SYSTEMSTATE];if(data&&data[key]){_41f=data[key];}}}return _41f;},_setWidgetSystemState:function(key,_421){if(!this.widgetNavStateNode){this.widgetNavStateNode=this._createWidgetNavStateNode();}var data=this.widgetNavStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();var _422=null;data[this.VALUE]=data[this.VALUE]?data[this.VALUE]:{};data[this.VALUE][this.SYSTEMSTATE]=data[this.VALUE][this.SYSTEMSTATE]?data[this.VALUE][this.SYSTEMSTATE]:{};_422=data[this.VALUE][this.SYSTEMSTATE];_422[key]=_421;this.navStateModel.setDirty(true);return this;},getWidgetState:function(key){var rc=this._getWidgetStateValue(key)||null;if(!rc){return null;}if(!dojo.isString(rc)){rc=dojo.toJson(rc);}return rc;},_getWidgetStateValue:function(key){if(!key){return null;}if(key&&key=="cp"){return this.getWidgetStateSet();}if(this.RP[key]){return this._getWidgetSystemState(key);}var _423=null;if(!this.widgetNavStateNode&&!this.widgetNavStateNodeFallback){return null;}var _424=this.widgetNavStateNode;if(!_424){_424=this.widgetNavStateNodeFallback;}var data=_424.getRef();if(data&&data[this.VALUE]){if(data[this.VALUE][this.CUSTOMSTATE]){data=data[this.VALUE][this.CUSTOMSTATE];if(dojo.isString(data)){return null;}if(data&&data[key]){_423=data[key];}}}return _423;},getWidgetStateValues:function(key){var rc=this._getWidgetStateValue(key)||null;if(!rc){return null;}if(dojo.isString(rc)){var arr=[];arr.push(rc);return arr;}return rc;},getWidgetStateNames:function(){var _425=[];if(!this.widgetNavStateNode&&!this.widgetNavStateNodeFallback){return null;}var _426=this.widgetNavStateNode;if(!_426){_426=this.widgetNavStateNodeFallback;}var data=_426.getRef();if(data&&data[this.VALUE]){if(data[this.VALUE][this.CUSTOMSTATE]){data=data[this.VALUE][this.CUSTOMSTATE];if(dojo.isString(data)){return null;}if(data){for(var i in data){if(Object.prototype.hasOwnProperty.call(data,i)){if(data[i]){_425.push(i);}}}}}}if(_425.length===0){return null;}return _425;},setWidgetState:function(key,_427){if(!key||!_427){return null;}if(key&&key=="cp"){return this.setWidgetStateSet(_427);}var _428=false;if(dojo.isArray(_427)&&_427.length>=1){if(dojo.isString(_427[0])){_428=true;}}if(!_428){if(dojo.isString(_427)){_428=true;}}if(!_428){return null;}if(this.RP[key]){return this._setWidgetSystemState(key,_427);}if(key&&key=="cp"){return this.setWidgetStateSet(_427);}if(!this.widgetNavStateNode){this.widgetNavStateNode=this._createWidgetNavStateNode();}var data=this.widgetNavStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();var _429=null;data[this.VALUE]=data[this.VALUE]?data[this.VALUE]:{};data[this.VALUE][this.CUSTOMSTATE]=data[this.VALUE][this.CUSTOMSTATE]?data[this.VALUE][this.CUSTOMSTATE]:{};_429=data[this.VALUE][this.CUSTOMSTATE];_429[key]=_427;this.navStateModel.setDirty(true);return this;},removeWidgetState:function(key){if(!key){return false;}if(this.RP[key]){return this._removeWidgetSystemState(key);}if(!this.widgetNavStateNode){return false;}var data=this.widgetNavStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();if(key&&key=="cp"){if(data&&data[this.VALUE]&&data[this.VALUE][this.CUSTOMSTATE]){data[this.VALUE][this.CUSTOMSTATE]=null;this.navStateModel.setDirty(true);return true;}return false;}if(data&&data[this.VALUE]&&data[this.VALUE][this.CUSTOMSTATE]){var _42a=data[this.VALUE][this.CUSTOMSTATE];if(_42a&&_42a[key]){_42a[key]=null;this.navStateModel.setDirty(true);return true;}}return false;},_removeWidgetSystemState:function(key){if(!key){return false;}if(!this.widgetNavStateNode){return false;}var data=this.widgetNavStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();if(data&&data[this.VALUE]&&data[this.VALUE][this.SYSTEMSTATE]){var _42b=data[this.VALUE][this.SYSTEMSTATE];if(_42b&&_42b[key]){_42b[key]=null;this.navStateModel.setDirty(true);return true;}}return false;},getWindowState:function(){rc=this._getWidgetSystemState(this.WINDOWSTATE);return rc;},setWindowState:function(_42c){if(_42c&&(_42c==this.MIN||_42c==this.MAX||_42c==this.NORMAL)){this._setWidgetSystemState(this.WINDOWSTATE,_42c);}},getWidgetMode:function(){var rc=this._getWidgetSystemState(this.MODE);return rc;},setWidgetMode:function(_42d){if(_42d){this._setWidgetSystemState(this.MODE,_42d);return this;}return null;},getSize:function(){var size={};var _42e=this._getWidgetSystemState(this.HEIGHT);var _42f=this._getWidgetSystemState(this.WIDTH);if(_42e){size[this.HEIGHT]=_42e;}if(_42f){size[this.WIDTH]=_42f;}if(!size[this.HEIGHT]&&!size[this.WIDTH]){return null;}return size;},setSize:function(_430,_431){if(_430){this._setWidgetSystemState(this.WIDTH,_430);}if(_431){this._setWidgetSystemState(this.HEIGHT,_431);}return this;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.WidgetAccessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.WidgetAccessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.WidgetAccessor");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.PageModeAccessor_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.PageModeAccessor_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.PageModeAccessor_API");dojo.provide("com.ibm.mashups.enabler.model.state.PageModeAccessor");dojo.declare("com.ibm.mashups.enabler.model.state.PageModeAccessor",[com.ibm.mashups.enabler.model.state.Accessor],{VIEW:"view",EDIT:"edit",getPageMode:function(){},setPageMode:function(_432){},confirmSetPageMode:function(_433){return true;}});com.ibm.mashups.enabler.model.state.PageModeAccessor.VIEW="view";com.ibm.mashups.enabler.model.state.PageModeAccessor.EDIT="edit";}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.PageModeAccessorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.PageModeAccessorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.PageModeAccessorImpl");dojo.declare("com.ibm.mm.enabler.model.state.PageModeAccessorImpl",[com.ibm.mashups.enabler.model.state.PageModeAccessor],{constructor:function(_434){this.navStateModel=_434;},getPageMode:function(){var _435=this.navStateModel._getPageMode();if(!_435){return null;}return _435;},setPageMode:function(mode){if(mode){this.navStateModel._setPageMode(mode);}return;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.PageModeAccessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.PageModeAccessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.PageModeAccessor");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor_API");dojo.provide("com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor");dojo.declare("com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor",[com.ibm.mashups.enabler.model.state.Accessor],{getId:function(){},getScope:function(){},getAllNames:function(){},setItemValue:function(_436,_437){},confirmSetItemValue:function(_438,_439){return true;},removeItem:function(_43a){},confirmRemoveItem:function(_43b){return true;},getItemValue:function(_43c){},registerListener:function(_43d){},removeListener:function(_43e){},confirmRemoveListener:function(_43f){return true;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl");dojo.declare("com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl",[com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor],{DELETE_TOKEN:"DELETE_TOKEN",TYPE_NEW:"newItem",TYPE_UPDATE:"changedValue",TYPE_REMOVE:"removedItem",constructor:function(_440,name,_441){if(!_441){this.scope=com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl.GLOBAL_SCOPE;}else{this.scope=_441;}this.name=name;this.navStateModel=_440;this.navStateNode=_440._find("sparams"+this.navStateModel.DELIMITER+name+this.navStateModel.DELIMITER+this.scope);},_createNavStateNode:function(){var temp;var _442=this.navStateModel._find("sparams");if(!_442){temp=this.navStateModel.create({key:"sparams"});this.navStateModel.insert(temp,this.navStateModel._getRoot());_442=this.navStateModel._find("sparams");}var _443=this.navStateModel._find(this.name);if(!_443){temp=this.navStateModel.create({key:this.name});this.navStateModel.insert(temp,_442);_443=this.navStateModel._find("sparams"+this.navStateModel.DELIMITER+this.name);}var _444=this.navStateModel.create({key:this.scope});this.navStateModel.insert(_444,_443);_444=this.navStateModel._find("sparams"+this.navStateModel.DELIMITER+this.name+this.navStateModel.DELIMITER+this.scope);return _444;},getId:function(){return this.name;},getScope:function(){return this.scope;},getAllNames:function(){if(!this.navStateNode){return null;}var arr=[];var data=this.navStateNode.getRef();if(data&&data[this.navStateModel.VALUE]){for(var i in data[this.navStateModel.VALUE]){if(data[this.navStateModel.VALUE].hasOwnProperty(i)){var _445=data[this.navStateModel.VALUE][i][this.navStateModel.VALUE];if(_445&&_445!=this.DELETE_TOKEN){arr.push(i);}}}}return arr;},setItemValue:function(_446,_447){if(!this.navStateNode){this.navStateNode=this._createNavStateNode();}var data=this.navStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();data.value=data.value?data.value:{};var _448={};if(!data.value[_446]){data.value[_446]={};data.value[_446].value=_447;data.value[_446].params=data.value[_446].params?data.value[_446].params:{};data.value[_446].params._isDirty=true;_448.alias=_446;_448.type=this.TYPE_NEW;_448.newVal=_447;data.value[_446].params._change=_448;}else{if(data.value[_446]){var _449=dojo.clone(data.value[_446].value);data.value[_446].value=_447;data.value[_446].params=data.value[_446].params?data.value[_446].params:{};var _44a=data.value[_446].params._isDirty;if(_44a){_448=data.value[_446].params._change;if(_448.type==this.TYPE_NEW){_448.newVal=_447;}else{if(_448.type==this.TYPE_UPDATE){_448.newVal=_447;}else{if(_448.type==this.TYPE_REMOVE){if(_448.oldVal){_448.type=this.TYPE_UPDATE;}else{_448.type=this.TYPE_NEW;}_448.newVal=_447;}}}}else{_448.type=this.TYPE_UPDATE;_448.oldVal=_449;_448.newVal=_447;_448.alias=_446;data.value[_446].params._change=_448;}data.value[_446].params._isDirty=true;}}this.navStateModel.setDirty(true);return true;},removeItem:function(_44b){if(!this.navStateNode){return false;}var data=this.navStateNode.getRef();data.params=data.params?data.params:{};data.params.lm=new Date().getTime();if(data&&data[this.navStateModel.VALUE]){if(data[this.navStateModel.VALUE][_44b]){var _44c=data[this.navStateModel.VALUE][_44b];var _44d=dojo.clone(_44c.value);_44c.value=this.DELETE_TOKEN;_44c.params=_44c.params?_44c.params:{};var _44e=_44c.params._isDirty;var _44f={};if(_44e){_44f=_44c.params._change;if(_44f.type==this.TYPE_NEW){delete data[this.navStateModel.VALUE][_44b];}else{if(_44f.type==this.TYPE_UPDATE){_44f.type=this.TYPE_REMOVE;_44f.newVal=null;delete _44f.oldVal;}}}else{_44f.type=this.TYPE_REMOVE;_44f.alias=_44b;_44f.oldVal=_44d;_44c.params._change=_44f;_44c.params._isDirty=true;}this.navStateModel.setDirty(true);}else{return false;}}return true;},getItemValue:function(_450){if(!this.navStateNode){return null;}var data=this.navStateNode.getRef();if(data&&data[this.navStateModel.VALUE]){if(data[this.navStateModel.VALUE][_450]){var _451=data[this.navStateModel.VALUE][_450];var _452=_451[this.navStateModel.VALUE];if(_452&&_452!=this.DELETE_TOKEN){return _452;}}}return null;},registerListener:function(_453){if(!this.navStateNode){this.navStateNode=this._createNavStateNode();}var data=this.navStateNode.getRef();var _454=data[this.navStateModel.PARAMS];if(!_454){data[this.navStateModel.PARAMS]={};_454=data[this.navStateModel.PARAMS];}if(!_454._listeners){_454._listeners={};}var _455=this.navStateModel._generateListenerId();_454._listeners[_455]=_453;return _455;},removeListener:function(_456){if(!this.navStateNode){return null;}var data=this.navStateNode.getRef();var _457=data[this.navStateModel.PARAMS];if(_457&&_457._listeners){var _458=_457._listeners;if(_458[_456]){_458[_456]=null;delete _458[_456];return true;}}return false;},_setItems:function(_459){for(var i in _459){if(_459[i]&&_459[i]==this.DELETE_TOKEN){this.removeItem(i);}else{if(_459[i]){this.setItemValue(i,_459[i]);}}}}});com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl.GLOBAL_SCOPE="global";}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.ShareableParameterSetAccessor");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.AccessorFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.AccessorFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.AccessorFactory_API");dojo.provide("com.ibm.mashups.enabler.model.state.AccessorFactory");dojo.declare("com.ibm.mashups.enabler.model.state.AccessorFactory",null,{getPageAccessor:function(_45a,_45b){},getSpaceAccessor:function(_45c){},getWidgetAccessor:function(_45d,_45e){},getPageModeAccessor:function(_45f){},getShareableParameterSetAccessor:function(_460,id,_461){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.AccessorFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.AccessorFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.AccessorFactoryImpl");dojo.declare("com.ibm.mm.enabler.model.state.AccessorFactoryImpl",com.ibm.mashups.enabler.model.state.AccessorFactory,{constructor:function(){},getPageAccessor:function(_462,_463){return new com.ibm.mm.enabler.model.state.PageAccessorImpl(_462,_463);},getPageModeAccessor:function(_464){return new com.ibm.mm.enabler.model.state.PageModeAccessorImpl(_464);},getSpaceAccessor:function(_465){return new com.ibm.mm.enabler.model.state.SpaceAccessorImpl(_465);},getWidgetAccessor:function(_466,_467){return new com.ibm.mm.enabler.model.state.WidgetAccessorImpl(_466,_467);},getShareableParameterSetAccessor:function(_468,name,_469){return new com.ibm.mm.enabler.model.state.ShareableParameterSetAccessorImpl(_468,name,_469);}});com.ibm.mashups.enabler.model.state.AccessorFactory=new com.ibm.mm.enabler.model.state.AccessorFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.AccessorFactory"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.AccessorFactory"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.AccessorFactory");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateModel_API");dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateModel");dojo.declare("com.ibm.mashups.enabler.model.state.NavigationStateModel",null,{ONNAVSTATEUPDATED:"com.ibm.mashups.enabler.model.state.onNavStateUpdated",commit:function(_46a){return new com.ibm.mashups.enabler.Deferred();},discard:function(){return;},dispose:function(){return;}});}if(!dojo._hasResource["dojo.back"]){dojo._hasResource["dojo.back"]=true;dojo.provide("dojo.back");(function(){var back=dojo.back;function getHash(){var h=window.location.hash;if(h.charAt(0)=="#"){h=h.substring(1);}return dojo.isMozilla?h:decodeURIComponent(h);};function setHash(h){if(!h){h="";}window.location.hash=encodeURIComponent(h);_46b=history.length;};if(dojo.exists("tests.back-hash")){back.getHash=getHash;back.setHash=setHash;}var _46c=(typeof (window)!=="undefined")?window.location.href:"";var _46d=(typeof (window)!=="undefined")?getHash():"";var _46e=null;var _46f=null;var _470=null;var _471=null;var _472=[];var _473=[];var _474=false;var _475=false;var _46b;function handleBackButton(){var _476=_473.pop();if(!_476){return;}var last=_473[_473.length-1];if(!last&&_473.length==0){last=_46e;}if(last){if(last.kwArgs["back"]){last.kwArgs["back"]();}else{if(last.kwArgs["backButton"]){last.kwArgs["backButton"]();}else{if(last.kwArgs["handle"]){last.kwArgs.handle("back");}}}}_472.push(_476);};back.goBack=handleBackButton;function handleForwardButton(){var last=_472.pop();if(!last){return;}if(last.kwArgs["forward"]){last.kwArgs.forward();}else{if(last.kwArgs["forwardButton"]){last.kwArgs.forwardButton();}else{if(last.kwArgs["handle"]){last.kwArgs.handle("forward");}}}_473.push(last);};back.goForward=handleForwardButton;function createState(url,args,hash){return {"url":url,"kwArgs":args,"urlHash":hash};};function getUrlQuery(url){var _477=url.split("?");if(_477.length<2){return null;}else{return _477[1];}};function loadIframeHistory(){var url=(dojo.config["dojoIframeHistoryUrl"]||dojo.moduleUrl("dojo","resources/iframe_history.html"))+"?"+(new Date()).getTime();_474=true;if(_471){dojo.isWebKit?_471.location=url:window.frames[_471.name].location=url;}else{}return url;};function checkLocation(){if(!_475){var hsl=_473.length;var hash=getHash();if((hash===_46d||window.location.href==_46c)&&(hsl==1)){handleBackButton();return;}if(_472.length>0){if(_472[_472.length-1].urlHash===hash){handleForwardButton();return;}}if((hsl>=2)&&(_473[hsl-2])){if(_473[hsl-2].urlHash===hash){handleBackButton();return;}}if(dojo.isSafari&&dojo.isSafari<3){var _478=history.length;if(_478>_46b){handleForwardButton();}else{if(_478<_46b){handleBackButton();}}_46b=_478;}}};back.init=function(){if(dojo.byId("dj_history")){return;}var src=dojo.config["dojoIframeHistoryUrl"]||dojo.moduleUrl("dojo","resources/iframe_history.html");if(dojo._postLoad){console.error("dojo.back.init() must be called before the DOM has loaded. "+"If using xdomain loading or djConfig.debugAtAllCosts, include dojo.back "+"in a build layer.");}else{document.write("<iframe style=\"border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;\" name=\"dj_history\" id=\"dj_history\" src=\""+src+"\"></iframe>");}};back.setInitialState=function(args){_46e=createState(_46c,args,_46d);};back.addToHistory=function(args){_472=[];var hash=null;var url=null;if(!_471){if(dojo.config["useXDomain"]&&!dojo.config["dojoIframeHistoryUrl"]){console.warn("dojo.back: When using cross-domain Dojo builds,"+" please save iframe_history.html to your domain and set djConfig.dojoIframeHistoryUrl"+" to the path on your domain to iframe_history.html");}_471=window.frames["dj_history"];}if(!_470){_470=dojo.create("a",{style:{display:"none"}},dojo.body());}if(args["changeUrl"]){hash=""+((args["changeUrl"]!==true)?args["changeUrl"]:(new Date()).getTime());if(_473.length==0&&_46e.urlHash==hash){_46e=createState(url,args,hash);return;}else{if(_473.length>0&&_473[_473.length-1].urlHash==hash){_473[_473.length-1]=createState(url,args,hash);return;}}_475=true;setTimeout(function(){setHash(hash);_475=false;},1);_470.href=hash;if(dojo.isIE){url=loadIframeHistory();var _479=args["back"]||args["backButton"]||args["handle"];var tcb=function(_47a){if(getHash()!=""){setTimeout(function(){setHash(hash);},1);}_479.apply(this,[_47a]);};if(args["back"]){args.back=tcb;}else{if(args["backButton"]){args.backButton=tcb;}else{if(args["handle"]){args.handle=tcb;}}}var _47b=args["forward"]||args["forwardButton"]||args["handle"];var tfw=function(_47c){if(getHash()!=""){setHash(hash);}if(_47b){_47b.apply(this,[_47c]);}};if(args["forward"]){args.forward=tfw;}else{if(args["forwardButton"]){args.forwardButton=tfw;}else{if(args["handle"]){args.handle=tfw;}}}}else{if(!dojo.isIE){if(!_46f){_46f=setInterval(checkLocation,200);}}}}else{url=loadIframeHistory();}_473.push(createState(url,args,hash));};back._iframeLoaded=function(evt,_47d){var _47e=getUrlQuery(_47d.href);if(_47e==null){if(_473.length==1){handleBackButton();}return;}if(_474){_474=false;return;}if(_473.length>=2&&_47e==getUrlQuery(_473[_473.length-2].url)){handleBackButton();}else{if(_472.length>0&&_47e==getUrlQuery(_472[_472.length-1].url)){handleForwardButton();}}};})();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateProcessor_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateProcessor_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateProcessor_API");dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateProcessor");dojo.declare("com.ibm.mashups.enabler.model.state.NavigationStateProcessor",null,{getWidgetIdentifier:function(wid,_47f){},decode:function(url,_480){},encode:function(_481,_482,_483,_484){},generateUrl:function(_485,_486,_487){},generateURL:function(_488,_489,_48a){},preprocess:function(_48b,_48c){},dispose:function(_48d){},postprocess:function(_48e,_48f,_490,_491){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.CookieManager"]){dojo._hasResource["com.ibm.mm.enabler.model.state.CookieManager"]=true;dojo.provide("com.ibm.mm.enabler.model.state.CookieManager");dojo.declare("com.ibm.mm.enabler.model.state.CookieManager",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this._dirty=false;this.cookiePath=window.location.pathname;},COOKIE_PREFIX:"digest.ignore.state.",disposeState:function(){var id=this._getCookieID();if(id&&dojo.cookie(id)){if(dojo.isIE){dojo.cookie(id,null,{expires:-1});}else{dojo.cookie(id,null,{expires:-1,path:this.cookiePath});}}if(this._state){delete this._state;}this._dirty=false;},_getCookieID:function(){if(!this._cookieID){var _492=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var uid=_492.getValue(com.ibm.mashups.enabler.services.ConfigConstants.USER);if(!uid||(uid&&uid=="null")){return null;}this._cookieID=this.COOKIE_PREFIX+uid;}return this._cookieID;},_init:function(){if(!this._getCookieID()){this._state={};return;}if(dojo.cookie.isSupported()){if(dojo.cookie(this._getCookieID())&&dojo.fromJson(dojo.cookie(this._getCookieID()))){this._state=dojo.fromJson(dojo.cookie(this._getCookieID()));}}if(!this._state){this._state={};}},getState:function(id){if(!this._state){this._init();}if(!id){return this._state;}if(this._state[id]){return this._state[id];}return null;},setState:function(id,_493){if(!this._state){this._state={};}this._state[id]=_493;this._dirty=true;},removeState:function(id){if(this._state[id]){delete this._state[id];this._dirty=true;}},commit:function(){if(this._dirty){if(!this._getCookieID()){this._dirty=false;return;}if(dojo.cookie.isSupported()){if(dojo.isIE){dojo.cookie(this._getCookieID(),dojo.toJson(this._state),{expires:3652});}else{dojo.cookie(this._getCookieID(),dojo.toJson(this._state),{expires:3652,path:this.cookiePath});}}this._dirty=false;}}});com.ibm.mashups.enabler.model.state.CookieManager=new com.ibm.mm.enabler.model.state.CookieManager();}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateProcessorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateProcessorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.NavigationStateProcessorImpl");dojo.declare("com.ibm.mm.enabler.model.state.NavigationStateProcessorImpl",com.ibm.mashups.enabler.model.state.NavigationStateProcessor,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);if(this.bIsLoggable){this.LOGGER.entering("constructor");}this.configService=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _494=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NAVSTATE_PERSISTENCE_URL);if(_494){this.persistenceURL=this._getAssociativeArray(_494);}var _495=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NAVSTATE_PERSISTENCE_PSTORE);if(_495){this.persistencePSTORE=this._getAssociativeArray(_495);}var _496=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NAVSTATE_PERSISTENCE_URL_LIMIT);var _497=10;if(_496){_497=parseInt(_496,10);}this.urlpersistenceLIMIT=_497;var _498=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NAVSTATE_PERSISTENCE_URL_SPLIMIT);_497=2;if(_498){_497=parseInt(_498,10);}this.urlpersistenceSPLIMIT=_497;this.isHuffmannEnabled=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NAVSTATE_HUFFMANNENCODE_ENABLED);},PID:"pid",SHAREDPARAMETERSETS:"sps",SID:"sid",HUFFMANN_PREFIX:"mashup:huffman/",getWidgetIdentifier:function(wid,_499){return wid;},dispose:function(_49a){var _49b=com.ibm.mashups.enabler.model.state.CookieManager;var temp=_49b.disposeState();if(_49a){_49a();}},_getAssociativeArray:function(_49c){var obj={};if(dojo.isString(_49c)){obj[_49c]=_49c;return obj;}for(var i in _49c){if(Object.prototype.hasOwnProperty.call(_49c,i)){var _49d=_49c[i];obj[_49d]=_49d;}}return obj;},decode:function(url,_49e){if(this.bIsLoggable){this.LOGGER.entering("decode");this.LOGGER.trace("decode","url is "+url);}if(url.indexOf(this.HUFFMANN_PREFIX)!=-1){var arr=url.split(this.HUFFMANN_PREFIX);var _49f=com.ibm.mm.enabler.encode.huffman.HuffmanURL.getDataFromHuffmanTree(arr[1])||null;if(_49f){url=arr[0]+_49f;}}var hash=this._getHash(url)||null;if(hash){if(url.indexOf("#")!=-1){if(url.lastIndexOf("&")==(url.length-1)){url=url.concat(hash);}else{url=url.concat("#");url=url.concat(hash);}}else{url=url.concat("#");url=url.concat(hash);}}var _4a0={};var _4a1=new com.ibm.mm.enabler.utils.HttpUrl(url);var _4a2=_4a1.anchor;_4a2=unescape(_4a2);if(this.bIsLoggable){this.LOGGER.trace("decode","fragment is "+_4a2);}if(_4a2&&_4a2!=""){var _4a3=dojo.queryToObject(_4a2);var _4a4=new Date().getTime();if(_4a3.pid){_4a0.pid={};_4a0.pid.value=decodeURIComponent(_4a3.pid);_4a0.pid.params={};_4a0.pid.params.lm=_4a4;}if(_4a3.sid){_4a0.sid={};_4a0.sid.value=decodeURIComponent(_4a3.sid);_4a0.sid.params={};_4a0.sid.params.lm=_4a4;}if(_4a3.sps){_4a0.sparams={};rawValue=dojo.fromJson(decodeURIComponent(_4a3.sps));_4a0.sparams=rawValue;}_4a0.wparams={};for(var i in _4a3){if(i.indexOf("w")===0&&i.indexOf("cp")==-1&&i.indexOf("rp")==-1){var _4a5={};var _4a6=i.substr(1)*1+_4a4;var wID=_4a3[i];var _4a7=i+"cp";var _4a8=i+"rp";if(_4a3[_4a7]){_4a5.value=_4a5.value?_4a5.value:{};try{_4a5.value.cp=dojo.fromJson(decodeURIComponent(_4a3[_4a7]));}catch(e){_4a5.value.cp=decodeURIComponent(_4a3[_4a7]);}_4a5.params=_4a5.params?_4a5.params:{};_4a5.params.lm=_4a6;}if(_4a3[_4a8]){_4a5.value=_4a5.value?_4a5.value:{};try{_4a5.value.rp=dojo.fromJson(decodeURIComponent(_4a3[_4a8]));}catch(e2){_4a5.value.rp=decodeURIComponent(_4a3[_4a8]);}_4a5.params=_4a5.params?_4a5.params:{};_4a5.params.lm=_4a6;}_4a0.wparams[wID]=_4a5;}else{if(i.indexOf("w")!==0&&i!="pid"&&i!="sid"&&i!="sps"&&i!="pageselection"){var _4a9=_4a3[i];_4a0.params=_4a0.params?_4a0.params:{};_4a0.params[i]=decodeURIComponent(_4a9);}}}}if(_49e){_49e(_4a0);}if(!_49e){return _4a0;}},_getFragmentFromData:function(obj,_4aa,_4ab){var _4ac;if(dojo.isString(obj)){_4ac=obj;}else{_4ac=dojo.clone(obj);if(_4aa||_4ab){_4ac=this._filterData(obj,_4aa,_4ab);}}var _4ad=_4ac;if(!dojo.isString(_4ad)){if(this._isEmpty(_4ad)){_4ad=null;}else{try{_4ad=dojo.toJson(_4ad);}catch(e){_4ad=null;}}}return _4ad;},encode:function(_4ae,_4af,_4b0,_4b1){var _4b2="";var data;var pid;var sid;if(_4ae.pid&&_4ae.pid.value){pid=_4ae.pid.value;}if(!pid&&_4ae.sid&&_4ae.sid.value){sid=_4ae.sid.value;if(_4ae.pageselection&&_4ae.pageselection[sid]){pid=_4ae.pageselection[sid].value;}}if(pid&&this._contains("pid",this.persistenceURL)){_4b2=_4b2+"pid"+"="+encodeURIComponent(pid)+"&";}if(!sid&&_4ae.sid&&_4ae.sid.value){sid=_4ae.sid.value;}if(sid&&this._contains("sid",this.persistenceURL)){_4b2=_4b2+"sid"+"="+encodeURIComponent(sid)+"&";}for(var i in _4ae){if(Object.prototype.hasOwnProperty.call(_4ae,i)){if(i=="sparams"){if(_4ae[i]){var _4b3=dojo.clone(_4ae[i])||null;this._removeHiddenParameters(_4b3);this._removeEmptyObj(_4b3);if(_4b3&&this._contains("sparams",this.persistenceURL)){_4b2=_4b2+"sps"+"="+encodeURIComponent(dojo.toJson(_4b3))+"&";}}}if(i=="pageselection"&&_4ae[i]){data=dojo.clone(_4ae[i])||null;if(data&&this._contains("pageselection",this.persistenceURL)){_4b2=_4b2+"pageselection"+"="+encodeURIComponent(dojo.toJson(data))+"&";}}if(i=="wparams"&&_4ae[i]){var _4b4=this._sortData(dojo.clone(_4ae[i]));if(_4b4.length>this.urlpersistenceLIMIT){_4b4=_4b4.slice(_4b4.length-this.urlpersistenceLIMIT);}var _4b5=0;var _4b6;var _4b7;for(var j in _4b4){if(Object.prototype.hasOwnProperty.call(_4b4,j)){var _4b8=_4b4[j]||null;if(_4b8&&_4b8.value&&_4b8.value.cp&&this._contains("cp",this.persistenceURL)){_4b6=this._getFragmentFromData(_4b8.value.cp)||null;}if(_4b8&&_4b8.value&&_4b8.value.rp){_4b7=this._getFragmentFromData(_4b8.value.rp,this.persistenceURL)||null;}if(_4b6||_4b7){_4b2=_4b2+"w"+_4b5+"="+_4b8.wid+"&";if(_4b6){_4b2=_4b2+"w"+_4b5+"cp="+encodeURIComponent(_4b6)+"&";}if(_4b7){_4b2=_4b2+"w"+_4b5+"rp="+encodeURIComponent(_4b7)+"&";}_4b5++;if(_4b5>=this.urlpersistenceLIMIT){break;}}}}}if(i=="params"&&_4ae[i]){var _4b9=_4ae[i];for(var k in _4b9){if(Object.prototype.hasOwnProperty.call(_4b9,k)){_4b2=_4b2+k+"="+encodeURIComponent(_4b9[k])+"&";}}}}}if(this.isHuffmannEnabled){if(_4b2.indexOf("&")!=-1){data=_4b2.substr(_4b2.indexOf("&")+1);if(data.length>0){data=com.ibm.mm.enabler.encode.huffman.HuffmanURL.createRawSchemeSpecificPartFromRegex(data,"[%&c=]");_4b2=_4b2.substring(0,_4b2.indexOf("&")+1);_4b2=_4b2.concat(this.HUFFMANN_PREFIX);_4b2=_4b2.concat(data);}}}if(_4af){_4af(_4b2,_4b1);}if(!_4af){return _4b2;}},_removeHiddenParameters:function(obj){for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){if(i.indexOf("_")===0){obj[i]=null;delete obj[i];}else{if(!dojo.isString(obj[i])){this._removeHiddenParameters(obj[i]);}}}}},_removeEmptyObj:function(obj){if(com.ibm.mm.enabler.utils.Misc.isEmpty(obj)){return;}for(var _4ba in obj){if(Object.prototype.hasOwnProperty.call(obj,_4ba)){if(!dojo.isObject(obj[_4ba])){continue;}var _4bb=obj[_4ba];this._removeEmptyObj(_4bb);if(com.ibm.mm.enabler.utils.Misc.isEmpty(_4bb)){obj[_4ba]=null;delete obj[_4ba];}}}},_removeQueryState:function(wru){if(wru.indexOf("?")==-1){return wru;}var _4bc=wru.substring(wru.indexOf("?")+1);if(_4bc&&_4bc.indexOf("#")!=-1){_4bc=_4bc.substring(0,_4bc.indexOf("#"));}var _4bd=wru.substr(0,wru.indexOf("?"));var st=null;var _4be="";if(_4bc&&(_4bc.indexOf("nst=")===0||_4bc.indexOf("&nst=")>=0)){var temp=_4bc.substr(_4bc.indexOf("nst=")+3);var _4bf="";if(temp.indexOf("&")>0){st=temp.substring(0,temp.indexOf("&"));_4bf=temp.substring(temp.indexOf("&"));}else{st=temp;}if(_4bc.indexOf("&nst=")!=-1){_4be=_4bc.substring(0,_4bc.indexOf("&nst="));}if(_4be.length===0&&_4bf.length!==0){_4be=_4be.concat(_4bf.substring(1));}else{_4be=_4be.concat(_4bf);}}else{return wru;}var hash=wru.substr(wru.indexOf("#")+1);var _4c0=_4bd;if(_4be.length>0){_4c0=_4c0.concat("?").concat(_4be);}if(hash.length>0){_4c0=_4c0.concat("#").concat(hash);}return _4c0;},generateUrl:function(_4c1,_4c2,_4c3){return this.generateURL(_4c1,_4c2,_4c3);},generateURL:function(_4c4,_4c5,_4c6){var _4c7=this.encode(_4c4);var href=window.location.href;href=this._removeQueryState(href);var _4c8=href;if(href.indexOf("#")!=-1){_4c8=href.substr(0,href.indexOf("#"));}var url=_4c8.concat("#");url=url.concat(_4c7);if(_4c6&&_4c6.nohash&&_4c6.nohash=="true"){_4c7=encodeURIComponent(_4c7);if(_4c8.indexOf("?")==-1){url=_4c8.concat("?");url=url.concat("nst=");url=url.concat(_4c7);}else{if(_4c8.lastIndexOf("&")==(_4c8.length-1)){url=_4c8.concat("nst=");url=url.concat(_4c7);}else{url=_4c8.concat("&");url=url.concat("nst=");url=url.concat(_4c7);}}}if(_4c5){_4c5(url);}return url;},_getHash:function(wru){if(wru.indexOf("?")==-1){return null;}if(wru.indexOf("#")!=-1){var _4c9=wru.substr(wru.indexOf("#")+1);if(wru.indexOf("pid")!=-1||wru.indexOf("sid")!=-1){return null;}}var _4ca=wru.substring(wru.indexOf("?")+1);if(_4ca&&_4ca.indexOf("#")!=-1){_4ca=_4ca.substring(0,_4ca.indexOf("#"));}var st=null;if(_4ca&&(_4ca.indexOf("nst=")===0||_4ca.indexOf("&nst=")>=0)){var temp=_4ca.substr(_4ca.indexOf("nst=")+4);var _4cb="";if(temp.indexOf("&")>0){st=temp.substring(0,temp.indexOf("&"));}else{st=temp;}st=decodeURIComponent(st);}else{return null;}return st;},_sortData:function(_4cc){var arr=[];for(var i in _4cc){if(Object.prototype.hasOwnProperty.call(_4cc,i)){_4cc[i].wid=i;var _4cd=_4cc[i];if(_4cd.params&&_4cd.params.lm){arr.push(_4cd);}}}var _4ce=function(a,b){return (a.params.lm-b.params.lm);};arr.sort(_4ce);return arr;},_getLength:function(obj){var _4cf=0;for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){_4cf++;}}return _4cf;},_isEmpty:function(obj){if(!obj){return true;}for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){return false;}}return true;},_contains:function(_4d0,obj){if(!obj){return false;}if(obj[_4d0]){return true;}return false;},_filterData:function(data,_4d1,_4d2){if(!_4d1&&!_4d2){return data;}if(!_4d2){for(var i in data){if(Object.prototype.hasOwnProperty.call(data,i)){if(!this._contains(i,_4d1)){delete data[i];}}}return data;}for(var j in data){if(Object.prototype.hasOwnProperty.call(data,j)){if(!this._contains(j,_4d1)&&this._contains(j,_4d2)){delete data[j];}}}return data;},preprocess:function(_4d3,_4d4){if(this.bIsLoggable){this.LOGGER.entering("preprocess");if(_4d3){this.LOGGER.trace("preprocess","state is "+dojo.toJson(_4d3));}}var _4d5=com.ibm.mashups.enabler.model.state.CookieManager;var temp=_4d5.getState();if(!_4d3.pid&&temp.pid&&!_4d3.sid){_4d3.pid=temp.pid;}if(!_4d3.sid&&temp.sid){_4d3.sid=temp.sid;}if(!_4d3.pageselection&&temp.pageselection){_4d3.pageselection=temp.pageselection;}if(!_4d3.wparams){_4d3.wparams={};}var _4d6=_4d3.wparams;var _4d7=temp.wparams;for(var i in _4d7){if(Object.prototype.hasOwnProperty.call(_4d7,i)){var _4d8=i;var _4d9=_4d7[i];var _4da=_4d6[_4d8];if(_4da){_4d9=dojo.mixin(_4d9,dojo.clone(_4da));_4d6[_4d8]=_4d9;}else{_4d6[_4d8]=_4d9;}}}if(_4d4){_4d4(_4d3);}if(!_4d4){return _4d3;}},postprocess:function(_4db,_4dc,_4dd,_4de){var _4df=com.ibm.mashups.enabler.model.state.CookieManager;for(var i in _4db){if(Object.prototype.hasOwnProperty.call(_4db,i)){if(i=="pid"||i=="sid"||i=="pageselection"||i=="sparams"){if(this._contains(i,this.persistencePSTORE)){_4df.setState(i,_4db[i]);}}if(i=="wparams"&&_4db[i]){var _4e0={};var _4e1=_4db[i];for(var j in _4e1){if(Object.prototype.hasOwnProperty.call(_4e1,j)){var _4e2=_4e1[j]||null;var wID=j;var _4e3={};if(_4e2&&_4e2.value){if(_4e2.value.rp){var _4e4=this._filterData(dojo.clone(_4e2.value.rp),this.persistencePSTORE);if(!this._isEmpty(_4e4)){_4e3.value=_4e3.value?_4e3.value:{};_4e3.value.rp=_4e4;}}if(_4e2.value.cp&&this._contains("cp",this.persistencePSTORE)){var _4e5=this._filterData(dojo.clone(_4e2.value.cp),this.persistencePSTORE);if(!this._isEmpty(_4e5)){_4e3.value=_4e3.value?_4e3.value:{};_4e3.value.cp=_4e5;}}if(!this._isEmpty(_4e3)){if(_4e2.params){_4e3.params=_4e2.params;}_4e0[wID]=_4e3;}}}}if(!this._isEmpty(_4e0)){_4df.setState("wparams",_4e0);}}}}_4df.commit();if(_4dc){_4dc(_4db,_4de);}if(!_4dc){return _4db;}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateProcessor"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateProcessor"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateProcessor");}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateProcessorFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateProcessorFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.NavigationStateProcessorFactoryImpl");dojo.declare("com.ibm.mm.enabler.model.state.NavigationStateProcessorFactoryImpl",null,{constructor:function(){},getProcessor:function(){return new com.ibm.mm.enabler.model.state.NavigationStateProcessorImpl();}});com.ibm.mashups.enabler.model.state.NavigationStateProcessorFactory=new com.ibm.mm.enabler.model.state.NavigationStateProcessorFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateNode_API");dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateNode");dojo.declare("com.ibm.mashups.enabler.model.state.NavigationStateNode",com.ibm.mashups.enabler.Identifiable,{get:function(){},set:function(_4e6){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateNode"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateNode"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateNode");}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.NavigationStateNodeImpl");dojo.declare("com.ibm.mm.enabler.model.state.NavigationStateNodeImpl",[com.ibm.mashups.enabler.model.state.NavigationStateNode],{constructor:function(_4e7,key,_4e8,id,ref){this.model=_4e7;this.key=key;this.value=_4e8;if(id){this.id=id;}if(ref){this.ref=ref;}},setID:function(id){this.id=id;},setRef:function(ref){this.ref=ref;},getID:function(){return this.id;},getRef:function(){return this.ref;},getKey:function(){return this.key;},getValue:function(){return this.value;},get:function(){return dojo.clone(this._ref);},set:function(_4e9){this.ref=_4e9;this.model.setDirty(true);}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.EventService"]){dojo._hasResource["com.ibm.mashups.iwidget.services.EventService"]=true;dojo.provide("com.ibm.mashups.iwidget.services.EventService");dojo.declare("com.ibm.mashups.iwidget.services.EventService",null,{SERVICE_NAME:"eventService",constructor:function(){},fireEvent:function(_4ea,_4eb,_4ec,_4ed,_4ee){},broadcastEvent:function(_4ef,_4f0,_4f1,_4f2){},broadcastEvent:function(_4f3,_4f4,_4f5,_4f6,_4f7){},broadcastEvent:function(_4f8,_4f9,_4fa,_4fb,_4fc,_4fd){},broadcastEvents:function(_4fe,_4ff){},broadcastEvents:function(_500,_501,_502){},broadcastEvents:function(_503,_504,_505,_506){},publishEvent:function(_507,_508,_509,_50a){},subscribeEvent:function(_50b,_50c,_50d,_50e,_50f){},unsubscribeEvent:function(_510,_511){}});com.ibm.mashups.iwidget.services.EventService.SERVICE_NAME="eventService";}if(!dojo._hasResource["com.ibm.mashups.iwidget.Constants"]){dojo._hasResource["com.ibm.mashups.iwidget.Constants"]=true;dojo.provide("com.ibm.mashups.iwidget.Constants");dojo.declare("com.ibm.mashups.iwidget.Constants",null,{WIDGET_LOADED:"com.ibm.mashups.iwidget.widgetloaded",RESIZE_WIDGET:"com.ibm.mashups.iwidget.resizewidget",UNLOAD_WIDGETS:"com.ibm.mashups.iwidget.unloadwidgets",WIDGETS_UNLOADED:"com.ibm.mashups.iwidget.widgetsunloaded",WIDGET_MODECHANGED:"com.ibm.mashups.iwidget.widgetmodechanged",CHANGE_WIDGETMODE:"com.ibm.mashups.iwidget.changewidgetmode",WIDGET_WINDOWSTATECHANGED:"com.ibm.mashups.iwidget.widgetwindowstatechanged",CHANGE_WIDGETWINDOWSTATE:"com.ibm.mashups.iwidget.changewidgetwindowstate",NAVSTATE_UPDATED:"com.ibm.mashups.enabler.model.state.onNavStateUpdated"});com.ibm.mashups.iwidget.Constants=new com.ibm.mashups.iwidget.Constants();}if(!dojo._hasResource["com.ibm.mashups.iwidget.IEvent_API"]){dojo._hasResource["com.ibm.mashups.iwidget.IEvent_API"]=true;dojo.provide("com.ibm.mashups.iwidget.IEvent_API");dojo.provide("com.ibm.mashups.iwidget.IEvent");dojo.declare("com.ibm.mashups.iwidget.IEvent",null,{constructor:function(){},name:"",type:"",payload:null,source:""});}if(!dojo._hasResource["com.ibm.mashups.iwidget.IEvent"]){dojo._hasResource["com.ibm.mashups.iwidget.IEvent"]=true;dojo.provide("com.ibm.mashups.iwidget.IEvent");}if(!dojo._hasResource["com.ibm.mm.iwidget.IEventImpl"]){dojo._hasResource["com.ibm.mm.iwidget.IEventImpl"]=true;dojo.provide("com.ibm.mm.iwidget.IEventImpl");dojo.declare("com.ibm.mm.iwidget.IEventImpl",com.ibm.mashups.iwidget.IEvent,{constructor:function(name,type,_512,_513){this.name=name;if(typeof type!="undefined"){this.type=type;}else{this.type=null;}if(typeof _512!="undefined"){this.payload=_512;}else{this.payload=null;}if(typeof _513!="undefined"){this.source=_513;}else{this.source=null;}this.source=_513;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.Constants"]){dojo._hasResource["com.ibm.mm.iwidget.Constants"]=true;dojo.provide("com.ibm.mm.iwidget.Constants");dojo.declare("com.ibm.mm.iwidget.Constants",null,{constructor:function(){},WIDGETEVENT_PREFIX:"widgetevents.",WILDCARD_PREFIX:"*.",mode:{VIEW:"view",EDIT:"edit",PERSONALIZE:"personalize",CONFIG:"config",HELP:"help"},mode_view:"view",mode_edit:"edit",mode_help:"help",event:{TITLE:"title",DESCRIPTION:"description"},ATTRIBUTES:"attributes",IDESCRIPTOR:"idescriptor",USERPROFILE:"userprofile",windowstate:{NORMAL:"normal",MINIMIZE:"minimize",MAXIMIZE:"maximize"},status:{SUCCESS:200,TIMEOUT:408,NOTFOUND:404,INTERROR:500,OTHER:303},changeType:{CHANGEDVALUE:"changedValue",NEWITEM:"newItem",REMOVEDITEM:"removedItem"},iDescriptorItems:{title:"title",name:"name",description:"description",defaultHeight:"defaultHeight",defaultWidth:"defaultWidth",displayLocale:"displayLocale",mode:"mode",author:"author",email:"email",website:"website",version:"version",icon:"icon",windowState:"windowState",messageLocale:"messageLocale",availableMessageLocales:"availableMessageLocales",thumbnail:"thumbnail"},IW_PREFIX:"iw-",CSSCLASS_INSTANCE:{iwWidget:"iWidget",iwSandbox:"Sandbox",iwDefinition:"Definition",iwEventDescription:"EventDescription",iwPayloadType:"PayloadType",iwHandled:"Handled",iwPublished:"Published",iwDescription:"Description",iwTitle:"Title",iwEvent:"Event",iwDescRef:"DescRef",iwGlobalid:"Globalid",iwHandler:"Handler",iwNewWire:"NewWire",iwRemoveWire:"RemoveWire",iwReadOnly:"ReadOnly",iwItemSet:"ItemSet",iwItem:"Item",iwValue:"Value",iwContent:"Content",iwReceivedEvent:"ReceivedEvent",iwSourceEvent:"SourceEvent",iwTargetEvent:"TargetEvent",iwMappedName:"MappedName",iwStandalone:"Standalone"},CSSCLASS_PREFIXED_INSTANCE:{},RESOURCE:{src:"src",id:"id",globalid:"globalid",mimeType:"mimeType",callback:"callback",version:"version",blockInit:"blockInit",skipLoad:"skipLoad"},EVENTS:{onLoad:"onLoad",onUnLoad:"onUnload",onModeChanged:"onModeChanged",onItemSetChanged:"onItemSetChanged",unloadWidget:"/enabler/unloadWidget",unSubscribeWire:"/enabler/unSubscribeWire",modeChanged:"modeChanged",onSizeChanged:"onSizeChanged",onNavStateChanged:"onNavStateChanged",onAttributeSaved:"com.ibm.mashups.iwidget.onAttributeSaved",onWindowStateChanged:"onWindowStateChanged",onIncompleteEventDescription:"onIncompleteEventDescription"},eventservice:{type:{MAIN:"MAIN",IFRAME:"IFRAME"}}});com.ibm.mm.iwidget.Constants=new com.ibm.mm.iwidget.Constants();(function(){for(var key in com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE){if(Object.prototype.hasOwnProperty.call(com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE,key)){com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE[key]=com.ibm.mm.iwidget.Constants.IW_PREFIX+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE[key];}}})();iwConstants=com.ibm.mm.iwidget.Constants;}if(!dojo._hasResource["com.ibm.mm.enabler.hub.ManagedHubImpl"]){dojo._hasResource["com.ibm.mm.enabler.hub.ManagedHubImpl"]=true;dojo.provide("com.ibm.mm.enabler.hub.ManagedHubImpl");dojo.declare("com.ibm.mm.enabler.hub.ManagedHubImpl",null,{constructor:function(){},publishMgr:function(_514,data,_515,_516){var _517=_515?_515.getClientID():"manager";var _518=_516?_516.getClientID():"manager";var that=com.ibm.mm.enabler.hub.ManagedHubImpl._instance;if(that.bIsLoggable){that.LOGGER.trace("publishMgr","(MANAGER): PUB: "+_517+" -> "+_518+" || topic: '"+_514+"' data: '"+data+"'");}return true;},subscribeMgr:function(_519,_51a){var _51b=_51a?_51a.getClientID():"manager";var that=com.ibm.mm.enabler.hub.ManagedHubImpl._instance;if(that.bIsLoggable){that.LOGGER.trace("subscribeMgr","(MANAGER): SUB: id: '"+_51b+"' topic: '"+_519+"'");}return true;},securityMgr:function(_51c,_51d){var that=com.ibm.mm.enabler.hub.ManagedHubImpl._instance;if(that.bIsLoggable){that.LOGGER.trace("securityMgr","source:"+_51c+" alertType:"+_51d);}},getInstance:function(){var hub=com.ibm.mm.enabler.hub.ManagedHubImpl._instance;if(!hub){com.ibm.mm.enabler.hub.ManagedHubImpl._instance=new OpenAjax.hub.ManagedHub({onPublish:this.publishMgr,onSubscribe:this.subscribeMgr,onSecurityAlert:this.securityMgr});com.ibm.mm.enabler.hub.ManagedHubImpl._instance.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.hub.ManagedHubImpl");com.ibm.mm.enabler.hub.ManagedHubImpl._instance.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;com.ibm.mm.enabler.hub.ManagedHubImpl._instance.bIsLoggable=com.ibm.mm.enabler.hub.ManagedHubImpl._instance.LOGGER.isLoggable(com.ibm.mm.enabler.hub.ManagedHubImpl._instance.LOG_LEVEL);hub=com.ibm.mm.enabler.hub.ManagedHubImpl._instance;}return hub;}});com.ibm.mm.enabler.hub.ManagedHubImpl=new com.ibm.mm.enabler.hub.ManagedHubImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.hub.SubDomainPoolImpl"]){dojo._hasResource["com.ibm.mm.enabler.hub.SubDomainPoolImpl"]=true;dojo.provide("com.ibm.mm.enabler.hub.SubDomainPoolImpl");dojo.declare("com.ibm.mm.enabler.hub.SubDomainPoolImpl",null,{constructor:function(arr){if(arr){this._pool=arr;this._internalPool=dojo.clone(this._pool);}else{this._counter=0;this._reusedSubDomain=[];}this.configService=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.reuseSubDomain=this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.SUBDOMAINREUSE);},getSize:function(){if(this._internalPool){return this._internalPool.length;}return -1;},get:function(){if(this._pool){return this._getFromPool();}var cnt=this._counter;if(this.reuseSubDomain){if(this._reusedSubDomain.length>0){cnt=this._reusedSubDomain.shift();return cnt;}else{this._counter++;}}else{this._counter++;}return "w"+cnt;},add:function(_51e){if(!this.reuseSubDomain){return;}if(this._pool){return this._addToPool(_51e);}else{this._reusedSubDomain.push(_51e);}return;},_getFromPool:function(){if(this._pool.length===0){return null;}return this._pool.shift();},_addToPool:function(_51f){this._pool.push(_51f);}});}if(!dojo._hasResource["com.ibm.mm.enabler.hub.XHRHeaderExtensionImpl"]){dojo._hasResource["com.ibm.mm.enabler.hub.XHRHeaderExtensionImpl"]=true;dojo.provide("com.ibm.mm.enabler.hub.XHRHeaderExtensionImpl");dojo.declare("com.ibm.mm.enabler.hub.XHRHeaderExtensionImpl",null,{LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_METHOD="dojo.xhr()";this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this.originalDojoXHR=dojo.xhr;dojo.xhr=dojo.hitch(this,function(_520,args,_521){if(this.bIsLoggable){this.LOGGER.entering(this.LOG_METHOD,[_520,args,_521]);}if(!args.headers){args.headers={};}args.headers["com.ibm.lotus.openajax.virtualhost"]=document.location.hostname;args.headers["com.ibm.lotus.openajax.virtualport"]=document.location.port;if(this.bIsLoggable){this.LOGGER.trace(this.LOG_METHOD,"Adding headers: com.ibm.lotus.openajax.virtualhost="+document.location.hostname+" - com.ibm.lotus.openajax.virtualport="+document.location.port);}var ret=this.originalDojoXHR(_520,args,_521);if(this.bIsLoggable){this.LOGGER.exiting(this.LOG_METHOD);}return ret;});}});com.ibm.mm.enabler.hub.XHRHeaderExtension=new com.ibm.mm.enabler.hub.XHRHeaderExtensionImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.hub.MainHubAdapterImpl"]){dojo._hasResource["com.ibm.mm.enabler.hub.MainHubAdapterImpl"]=true;dojo.provide("com.ibm.mm.enabler.hub.MainHubAdapterImpl");dojo.declare("com.ibm.mm.enabler.hub.MainHubAdapterImpl",null,{constructor:function(_522){this._managedhub=_522;this._inlineHubClients={};this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},PREFIX_INLINE:"_inline_",PREFIX_IFRAME:"_iframe_",createInlineHubContainer:function(id){var _523=this.PREFIX_INLINE+id;var me=this;function onClientConnect(_524){if(me.bIsLoggable){me.LOGGER.trace("onClientConnect","++ "+_524.getClientID()+" connected");}};function onClientDisconnect(_525){if(me.bIsLoggable){me.LOGGER.trace("onClientDisconnect","-- "+_525.getClientID()+" disconnected");}};function onClientSecurityAlert(_526,_527){if(me.bIsLoggable){me.LOGGER.trace("onClientSecurityAlert","!! security alert - id: '"+_526.getClientID()+"' msg: '"+_527);}};function onClientError(_528,_529){if(me.bIsLoggable){me.LOGGER.trace("onClientError","!! error - id: '"+_528.getClientID()+"' msg: '"+_529);}};var _52a={Container:{onConnect:onClientConnect,onDisconnect:onClientDisconnect,onSecurityAlert:onClientSecurityAlert,onError:onClientError}};var _52b=new OpenAjax.hub.InlineContainer(this._managedhub,_523,_52a);return _52b;},createIframeHubContainer:function(id,_52c,uri,_52d,_52e,_52f,_530){var _531=this.PREFIX_IFRAME+id;var _532=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _533=_532.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT_ENABLER);var _534=_533+"/js/openajaxhub/tunnel.html";var _535=window.location.protocol;var host=window.location.hostname;var port=window.location.port;var _536=_535+"//"+host+":"+port+_534;if(port==""){_536=_535+"//"+host+_534;}var me=this;function onClientConnect(_537){if(me.bIsLoggable){me.LOGGER.trace("onClientConnect","++ "+_537.getClientID()+" connected");}};function onClientDisconnect(_538){if(me.bIsLoggable){me.LOGGER.trace("onClientDisconnect","-- "+_538.getClientID()+" disconnected");}};function onClientSecurityAlert(_539,_53a){if(me.bIsLoggable){me.LOGGER.trace("onClientSecurityAlert","!! security alert - id: '"+_539.getClientID()+"' msg: '"+_53a);}};try{var w,h;this.removeIframeHubContainer(id);if(_52d&&_52d=="true"){w="600px";h="400px";}else{w="400px";h="auto";}if(_52e){w=_52e;}if(_52f){h=_52f;}if(_530){onClientSecurityAlert=_530;}var _53b=new OpenAjax.hub.IframeContainer(this._managedhub,_531,{Container:{onConnect:onClientConnect,onDisconnect:onClientDisconnect,onSecurityAlert:onClientSecurityAlert},IframeContainer:{uri:uri,tunnelURI:_536,parent:_52c,iframeAttrs:{title:"iframe",style:{width:w,height:h,border:"0px",overflow:"auto"}},timeout:1200000}});}catch(e){if(me.bIsLoggable){me.LOGGER.trace("createIframeHubContainer","Creating iframe container exception:"+e.message);}}},createInlineHubClient:function(id){var _53c=this.PREFIX_INLINE+id;var me=this;var _53d=this._managedhub.getContainer(_53c);function onHubClientSecurityAlert(_53e,_53f){};var _540=new OpenAjax.hub.InlineHubClient({HubClient:{onSecurityAlert:onHubClientSecurityAlert},InlineHubClient:{container:_53d}});function onHubClientConnect(_541,_542,_543){if(!_542){if(me.bIsLoggable){me.LOGGER.trace("createIframeHubContainer","!! client connection error = id: '"+_541.getClientID()+"' msg: '"+_543);}}};_540.connect(onHubClientConnect);this._inlineHubClients[_53c]=_540;return _540;},_getInlineHubClient:function(id){if(!id){return null;}var _544=this.PREFIX_INLINE+id;var _545=this._inlineHubClients[_544];if(typeof _545=="undefined"){_545=null;}return _545;},getInlineHubClient:function(id){if(!id){return this._managedhub;}var _546=this._getInlineHubClient(id);return _546?_546:this._managedhub;},isInlineClient:function(id){var rc=false;var _547=this._getInlineHubClient(id);if(_547){rc=true;}return rc;},removeInlineHubClient:function(id){var _548=this._getInlineHubClient(id);var _549=this.PREFIX_INLINE+id;if(_548){var me=this;var _54a=function(_54b,_54c,_54d){if(!_54c){if(me.bIsLoggable){me.LOGGER.trace("onHubClientDisconnect","-- "+_54b.getClientID()+" msg:"+_54d);}}};_548.disconnect(_54a);delete this._inlineHubClients[_549];var _54e=this._managedhub.getContainer(_549);if(_54e){this._managedhub.removeContainer(_54e);}return;}},getContainer:function(id,_54f){_54f=_54f||false;if(_54f===true){id=this.PREFIX_IFRAME+id;}return this._managedhub.getContainer(id);},removeIframeHubContainer:function(id){var _550=this.PREFIX_IFRAME+id;var _551=this._managedhub.getContainer(_550);if(_551){this._managedhub.removeContainer(_551);}},returnSubDomain:function(_552){this.getSubDomainPool().add(_552);},getSubDomainSize:function(){return this.getSubDomainPool().getSize();},getSubDomain:function(){return this.getSubDomainPool().get();},getSubDomainPool:function(){if(!this.subDomainPool){var _553=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _554=_553.getValue(com.ibm.mashups.enabler.services.ConfigConstants.SUBDOMAINS);if(_554){if(dojo.isArray(_554)&&_554.length!==0){this.subDomainPool=new com.ibm.mm.enabler.hub.SubDomainPoolImpl(_554);}}if(!this.subDomainPool){this.subDomainPool=new com.ibm.mm.enabler.hub.SubDomainPoolImpl();}}return this.subDomainPool;}});}if(!dojo._hasResource["dojox.uuid.generateRandomUuid"]){dojo._hasResource["dojox.uuid.generateRandomUuid"]=true;dojo.provide("dojox.uuid.generateRandomUuid");dojox.uuid.generateRandomUuid=function(){var _555=16;function _generateRandomEightCharacterHexString(){var _556=Math.floor((Math.random()%1)*Math.pow(2,32));var _557=_556.toString(_555);while(_557.length<8){_557="0"+_557;}return _557;};var _558="-";var _559="4";var _55a="8";var a=_generateRandomEightCharacterHexString();var b=_generateRandomEightCharacterHexString();b=b.substring(0,4)+_558+_559+b.substring(5,8);var c=_generateRandomEightCharacterHexString();c=_55a+c.substring(1,4)+_558+c.substring(4,8);var d=_generateRandomEightCharacterHexString();var _55b=a+_558+b+_558+c+d;_55b=_55b.toLowerCase();return _55b;};}if(!dojo._hasResource["com.ibm.mm.iwidget.services.EventService"]){dojo._hasResource["com.ibm.mm.iwidget.services.EventService"]=true;dojo.provide("com.ibm.mm.iwidget.services.EventService");dojo.declare("com.ibm.mm.iwidget.services.EventServiceDefaultImpl",com.ibm.mashups.iwidget.services.EventService,{constructor:function(){this.subMgr={};this.managedhub=com.ibm.mm.enabler.hub.ManagedHubImpl.getInstance();this.hubAdapter=new com.ibm.mm.enabler.hub.MainHubAdapterImpl(this.managedhub);this._subscribeEventService();if(this.registerServices){this.registerServices();}if(this.registerExtServices){this.registerExtServices();}this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},getType:function(){return com.ibm.mm.iwidget.Constants.eventservice.type.MAIN;},registerServices:function(){var _55c=com.ibm.mashups.iwidget.Constants.CHANGE_WIDGETMODE;var me=this;var _55d=function(_55e){var _55f=_55e.id;var _560=_55e.newMode;var _561=_55e.parentNode;me.fireEvent(_55f,"onModeChanged",{newMode:_560,rootElementId:_561});};this.subscribeEvent(_55c,null,_55d,null,null);},setId:function(id){this.id=id;},getId:function(){return "main";},_subscribeEventService:function(){var that=this;function eventCallback(_562,_563,_564){var _565=_563.methodname;if(_565){var fn=that[_563.methodname];if(fn){that[_565].apply(that,_563.params);}}};this.managedhub.subscribe("eventservice."+this.getId(),eventCallback,that,that._subscribeCallback);},_subscribeCallback:function(_566,_567,_568){if(!_567){console.log("subscribe failed "+_566);}},_getHubAdapter:function(){return this.hubAdapter;},_getManagedHub:function(){return this.managedhub;},WIDGETEVENT_PREFIX:iwConstants.WIDGETEVENT_PREFIX,WILDCARD_PREFIX:iwConstants.WILDCARD_PREFIX,subscribeWire:function(_569,_56a,_56b,_56c){return false;},publishWire:function(_56d,_56e,_56f,_570){return false;},unSubscribeWire:function(_571,_572,_573,_574){return false;},addWire:function(_575,_576,_577,_578){return false;},removeWire:function(_579,_57a,_57b,_57c){return false;},fireEvent:function(_57d,_57e,_57f,_580,_581){var _582=new com.ibm.mm.iwidget.IEventImpl(_57e,_580,_57f,_581);var _583=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();var _584=_583.find(_57d);var cb=function(_585,_586,_587,_588){var _589=_585.hubAdapter.isInlineClient(_586.id);if(_589){_585._publishEvent(_585.WIDGETEVENT_PREFIX+_586.id,_587,_587.source);}else{var _58a={};if(_587.name==iwConstants.EVENTS.onModeChanged){_58a.methodname="_handleOnModeChange";_58a.params=[_57f];_586.handleEvent(_58a);return;}_58a.methodname="fireEvent";_58a.hubclient=_585.getId();_58a.params=[_586.id,_587.name,_587.payload,_587.type];_585._publishEvent("eventservice."+_586.id,_58a);}if(_588){var _58b=_585.subMgr[_588];if(_58b){_585.unsubscribeEvent(_58b);}delete _585.subMgr[_588];}};if(_584&&_584.isLoaded()){cb(this,_584,_582);}else{var that=this;var _58c=dojox.uuid.generateRandomUuid();var _58d=this.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_57d,null,function(){var _58e=_583.find(_57d);cb(that,_58e,_582,_58c);});this.subMgr[_58c]=_58d;}},publishEvent:function(_58f,_590,_591,_592){if(this.bIsLoggable){this.LOGGER.entering("eventService.publishEvent",[_58f,_590,_591,_592]);}if(typeof _58f=="undefined"||_58f===null){return;}var temp;if(_58f.indexOf(this.WILDCARD_PREFIX)===0){temp=this.WILDCARD_PREFIX;return this.broadcastEvent(_58f.substring(temp.length),_590,_591,_592);}else{if(_58f.indexOf(this.WIDGETEVENT_PREFIX)===0){temp=_58f.substring(this.WIDGETEVENT_PREFIX.length);var _593=temp.substring(0,temp.indexOf("."));var _594=temp.substring(temp.indexOf(".")+1);return this.fireEvent(_593,_594,_590,_591,_592);}}this._publishEvent(_58f,_590,_592);},_publishEvent:function(_595,_596,_597){var _598=this.hubAdapter.getInlineHubClient(_597);if(typeof _596=="undefined"||_596===null){_598.publish(_595);}else{_598.publish(_595,_596);}},BROADCAST_EVENTS_COOKIE_ID:"com.ibm.mashups.enabler.broadcastEvents",BROADCAST_EVENTS_SOURCE_ID_COOKIE_ID:"com.ibm.mashups.enabler.broadcastEventsSourceId",broadcastEvent:function(_599,_59a,_59b,_59c,_59d,_59e){var _59f={};_59f.targetEvent=_599;_59f.payload=_59a;_59f.payloadType=_59b;this.broadcastEvents([_59f],_59c,_59d,_59e);return;},broadcastEvents:function(_5a0,_5a1,_5a2,_5a3){if((_5a0===null)||!dojo.isArray(_5a0)){return;}var _5a4=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _5a5=com.ibm.mashups.enabler.model.state.AccessorFactory.getSpaceAccessor(_5a4);var _5a6=_5a5.getSpaceID();var _5a7=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(_5a4,_5a6);var _5a8=_5a7.getPageID();if((_5a2)&&(typeof _5a2=="string")&&(_5a2!=_5a8)){this.broadcastEventsCache=_5a0;this.broadcastEventsSourceIdCache=_5a1;if(dojo.cookie.isSupported()){dojo.cookie(this.BROADCAST_EVENTS_COOKIE_ID,dojo.toJson(_5a0),{expires:1});dojo.cookie(this.BROADCAST_EVENTS_SOURCE_ID_COOKIE_ID,_5a1,{expires:1});}if((_5a3)&&(typeof _5a3=="string")&&(_5a3!=_5a6)){_5a5.setSpaceID(_5a3);}var _5a9=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(_5a4);_5a9.setPageID(_5a2);var _5aa=_5a4.commit();_5aa.start();}else{var _5ab;var _5ac;var _5ad=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();var _5ae=_5ad.getAllWidgets();var that=this;var _5af=function(_5b0,_5b1,_5b2){var _5b3=_5b0.getWidgetHandledEvents();if(_5b3){for(var i=0;i<_5b1.length;i++){for(var j=0;j<_5b3.length;j++){if(_5b1[i].targetEvent==_5b3[j].name){that.fireEvent(_5b0.getID(),_5b1[i].targetEvent,_5b1[i].payload,_5b1[i].payloadType,_5a1);break;}}}}if(_5b2){var _5b4=that.subMgr[_5b2];if(_5b4){that.unsubscribeEvent(_5b4);}delete that.subMgr[_5b2];}};var _5b5=false;for(var i in _5ae){if(Object.prototype.hasOwnProperty.call(_5ae,i)){var _5b6=_5ae[i];if(_5b6.isLoaded()){_5af(_5b6,_5a0);}else{if(!_5b6.lazyLoad){_5b5=true;_5ab=dojox.uuid.generateRandomUuid();_5ac=this.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_5b6.getID(),null,dojo.partial(_5af,_5b6,_5a0,_5ab));this.subMgr[_5ab]=_5ac;}}}}if(!_5b5&&(_5a0.length>0)&&(_5a0[0].targetEvent==="com.ibm.mashups.builder.skinLoaded")){_5ab=dojox.uuid.generateRandomUuid();_5ac=this.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_5a0[0].payload.widgetId,null,function(){that._handleBroadcastEventsCache();var _5b7=that.subMgr[_5ab];if(_5b7){that.unsubscribeEvent(_5b7);}});this.subMgr[_5ab]=_5ac;}for(var j=0;j<_5a0.length;j++){this._publishEvent(_5a0[j].targetEvent,_5a0[j].payload,_5a1);}}return;},_handleBroadcastEventsCache:function(){if(this.broadcastEventsCache===null||typeof this.broadcastEventsCache=="undefined"){if(dojo.cookie.isSupported()){this.broadcastEventsCache=dojo.fromJson(dojo.cookie(this.BROADCAST_EVENTS_COOKIE_ID));}}if(this.broadcastEventsCache&&dojo.isArray(this.broadcastEventsCache)){if(this.broadcastEventsSourceIdCache===null||typeof this.broadcastEventsSourceIdCache=="undefined"){if(dojo.cookie.isSupported()){this.broadcastEventsSourceIdCache=dojo.cookie(this.BROADCAST_EVENTS_SOURCE_ID_COOKIE_ID);}}this.broadcastEvents(dojo.map(this.broadcastEventsCache,function(item){return item;}),this.broadcastEventsSourceIdCache);this.broadcastEventsCache=null;this.broadcastEventsSourceIdCache=null;dojo.cookie(this.BROADCAST_EVENTS_COOKIE_ID,null,{expires:-1});dojo.cookie(this.BROADCAST_EVENTS_SOURCE_ID_COOKIE_ID,null,{expires:-1});}},_subscribeEvent:function(_5b8,_5b9,_5ba,_5bb,_5bc){var _5bd=this._getHubAdapter().getInlineHubClient(_5bc);var _5be=_5bd.subscribe(_5b8,function(_5bf,data,_5c0){var ec=_5ba;if(_5b9&&_5ba){ec=dojo.hitch(_5b9,_5ba);}if(ec){ec(data);}},null,function(_5c1,_5c2,_5c3){if(_5b9&&_5bb){_5bb=dojo.hitch(_5b9,_5bb);}if(_5bb){_5bb.apply(this,[_5c1,_5c2,_5c3]);}if(!_5c2){console.log("subscription for "+_5c1+" failed");return;}});return _5be;},subscribeEvent:function(_5c4,_5c5,_5c6,_5c7,_5c8){return this._subscribeEvent(_5c4,_5c5,_5c6,_5c7,_5c8);},_unsubscribeEvent:function(_5c9,_5ca){var _5cb=this._getHubAdapter().getInlineHubClient(_5ca);try{if(_5cb){_5cb.unsubscribe(_5c9);}}catch(e){console.log("unsubscribe failure:"+e);}},unsubscribeEvent:function(_5cc,_5cd){if(!_5cc){return;}this._unsubscribeEvent(_5cc,_5cd);},_generateWireId:function(_5ce,_5cf,_5d0,_5d1){return _5ce+"_"+_5cf+"_"+_5d0+"_"+_5d1;}});if(!ibmConfig.insideSandbox){com.ibm.mashups.services.ServiceManager.setService("eventService","com.ibm.mm.iwidget.services.EventServiceDefaultImpl");}if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.services.EventServiceExtended");dojo["require"]("com.ibm.mm.iwidget.services.IFrameEventServiceImpl");}}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.NavigationStateModelImpl");dojo.declare("com.ibm.mm.enabler.model.state.NavigationStateModelImpl",[com.ibm.mashups.enabler.model.state.NavigationStateModel],{DELIMITER:"#",ROOT:"ROOT",DELETE_TOKEN:"DELETE_TOKEN",VALUE:"value",PARAMS:"params",constructor:function(_5d2){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this.processor=com.ibm.mashups.enabler.model.state.NavigationStateProcessorFactory.getProcessor();if(_5d2){this._state=_5d2;this._loaded=true;}else{dojo.back.setInitialState({back:this._loadCurrentPage,forward:this._loadCurrentPage});this._loaded=false;this.processor.decode(window.location.href,dojo.hitch(this,"_preprocess"));}this._sync=true;},_getUniqueWid:function(wid){return this.processor.getWidgetIdentifier(wid,this);},_refreshPage:function(){var cb=function(url){if(url){top.location.href=url;}};var _5d3=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();com.ibm.mashups.enabler.model.state.UrlGeneratorFactory.getURLGenerator().getUrl(_5d3,cb,{nohash:"true"});},_getFullUrl:function(cb,_5d4){return this.processor.generateURL(this._state,cb,_5d4);},clone:function(){var _5d5=dojo.clone(this._state);return new com.ibm.mm.enabler.model.state.NavigationStateModelImpl(_5d5);},_preprocess:function(_5d6){if(this.bIsLoggable){this.LOGGER.entering("_preprocess");if(_5d6){this.LOGGER.trace("_preprocess","state:"+dojo.toJson(_5d6));}}this.processor.preprocess(_5d6,dojo.hitch(this,"_initializeState"));},_initialize:function(){this.processor.decode(window.location.href,dojo.hitch(this,"_preprocess"));},_initializeState:function(_5d7){if(this.bIsLoggable){this.LOGGER.entering("_initializeState");if(_5d7){this.LOGGER.trace("_initializeState","state:"+dojo.toJson(_5d7));}}this._state=_5d7;this._stateInternal=dojo.clone(_5d7);this._rootNode=new com.ibm.mm.enabler.model.state.NavigationStateNodeImpl(this,this.ROOT,this._state,this.ROOT,this._state);this._isDirty=false;this._loaded=true;},_postprocess:function(_5d8,_5d9){if(this._isDirty&&(!this._pagemode||(this._pagemode&&this._pagemode!="unload"&&this._pagemode!="edit"))){this.processor.encode(_5d8,dojo.hitch(this,"_finishCommit"),this._stateInternal,_5d9);}else{if(this._deferred){this._deferred.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);delete this._deferred;}}},_loadCurrentPage:function(){var nsm=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();nsm._initialize();var _5da=com.ibm.mashups.services.ServiceManager.getService("eventService");_5da.publishEvent(nsm.ONNAVSTATEUPDATED);},_finishCommit:function(_5db,_5dc,_5dd){try{var _5de=window.location.hash.substring(1);if(_5dc&&_5dc.addToHistory){if(_5db&&_5de!=_5db){dojo.back.addToHistory({back:this._loadCurrentPage,forward:this._loadCurrentPage,changeUrl:_5db});}}}catch(e){this.LOGGER.warning("_finishCommit","failed to update window.location.href error:"+e.message+" length of fragment:"+_5db.length);}if(this._isDirty){var _5df=com.ibm.mashups.services.ServiceManager.getService("eventService");_5df.publishEvent(this.ONNAVSTATEUPDATED);}this._isDirty=false;this._removeDirty(this._state);this._stateInternal=dojo.clone(this._state);if(_5dc&&_5dc.allowRedirect&&_5dd&&_5dd.doRedirect&&!this._sync){this._refreshPage();}else{if(this._deferred){this._deferred.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);delete this._deferred;}}},_removeDirty:function(obj){for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){if(i.params&&i.params._isDirty){i.params._isDirty=false;if(i.value&&i.value==this.DELETE_TOKEN){obj[i]=null;delete obj[i];}}if(obj[i]&&!dojo.isString(obj[i])){this._removeDirty(obj[i]);}}}},setDirty:function(_5e0){this._isDirty=_5e0;},isDirty:function(){return this._isDirty;},_find:function(id){id=id||null;if(!id){return null;}if(id==this.ROOT){return this._rootNode;}else{var _5e1=this._findReference(id)||null;if(_5e1){var _5e2=new com.ibm.mm.enabler.model.state.NavigationStateNodeImpl(this);_5e2.setID(id);_5e2.setRef(_5e1);return _5e2;}}return null;},create:function(_5e3){var key=_5e3.key?_5e3.key:null;var _5e4=_5e3.value?_5e3.value:null;var _5e5=new com.ibm.mm.enabler.model.state.NavigationStateNodeImpl(this,key,_5e4);return _5e5;},insert:function(_5e6,_5e7){var _5e8=_5e7.getRef();var key=_5e6.getKey();var _5e9=_5e6.getValue()||null;if(!_5e9){_5e9={};}var _5ea=_5e7.getID();_5e8[key]=_5e9;return;},_getIndex:function(_5eb){var _5ec=0;for(var i in _5eb){if(Object.prototype.hasOwnProperty.call(_5eb,i)){_5ec++;}}return _5ec;},remove:function(_5ed){var id=_5ed.getID();var arr=id.split("#");if(arr.length==1){if(this._state[id]){delete this._state[id];}}if(arr.length>1){var key=id.substring(id.lastIndexOf("#")+1);var _5ee=id.substring(0,id.lastIndexOf("#"));var _5ef=this._find(_5ee);if(_5ef){var ref=_5ef.getRef();if(ref[key]){delete ref[key];}}}return;},_getRoot:function(){return this._rootNode;},_findReference:function(id){if(id==this.ROOT){return this._state;}var _5f0=false;var arr=id.split("#");var node=this._state;if(!node){return null;}for(var i in arr){if(Object.prototype.hasOwnProperty.call(arr,i)){var j=arr[i];_5f0=false;if(this._findMatch(node,j)){node=node[j];_5f0=true;}else{break;}}}if(!_5f0){return null;}return node;},_findMatch:function(node,key){if(node[key]){return true;}return false;},commit:function(_5f1){return new com.ibm.mm.enabler.DeferredImpl(this,this._commit,_5f1);},_commit:function(_5f2,sync,_5f3){this._deferred=_5f2;this._sync=sync;if(_5f3&&_5f3.allowRedirect&&this._sync){this.LOGGER.warning("_commit","additionalParams.allowRedirect set to true will be ignored since sync is true.  The page will not be refreshed");}this._processShareableParameters();if(this._isDirty&&(!this._pagemode||(this._pagemode&&this._pagemode!="edit"))){this.processor.postprocess(this._state,dojo.hitch(this,this._postprocess),this._stateInternal,_5f3);}else{_5f2.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}},_processShareableParameters:function(){var _5f4=this._state.sparams;if(!_5f4){return;}var _5f5=null;for(var i in _5f4){if(Object.prototype.hasOwnProperty.call(_5f4,i)){var _5f6={};_5f6.itemSetName=i;var _5f7=[];for(var _5f8 in _5f4[i]){if(Object.prototype.hasOwnProperty.call(_5f4[i],_5f8)){var _5f9=_5f4[i][_5f8].value;for(var j in _5f9){if(Object.prototype.hasOwnProperty.call(_5f9,j)){var _5fa=_5f9[j].params;if(_5fa&&_5fa._isDirty){_5f7.push(_5fa._change);if(_5f9[j].value==this.DELETE_TOKEN){_5f9[j]=null;delete _5f9[j];}else{_5f9[j].params=null;delete _5f9[j].params;}}}}if(_5f7.length>0){_5f6.changes=_5f7;if(_5f4[i][_5f8].params&&_5f4[i][_5f8].params._listeners){var _5fb=_5f4[i][_5f8].params._listeners;for(var t in _5fb){if(Object.prototype.hasOwnProperty.call(_5fb,t)){_5fb[t](_5f6);}}}}}}}}},discard:function(){this._state=dojo.clone(this._stateInternal);this._isDirty=false;},_getPageMode:function(){if(!this._pagemode){return null;}return this._pagemode;},_setPageMode:function(_5fc){if(_5fc){this._pagemode=_5fc;}},dispose:function(){this._state={};this._stateInternal={};this._rootNode=new com.ibm.mm.enabler.model.state.NavigationStateNodeImpl(this,this.ROOT,this._state,this.ROOT,this._state);this._isDirty=false;this._loaded=true;this.processor.dispose();},_generateListenerId:function(){if(!this._listenerCounter){this._listenerCounter=1;}else{this._listenerCounter++;}return this._listenerCounter;}});dojo.back.init();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModelFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModelFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateModelFactory_API");dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateModelFactory");dojo.declare("com.ibm.mashups.enabler.model.state.NavigationStateModelFactory",null,{getNavigationStateModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateModelFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.NavigationStateModelFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.NavigationStateModelFactoryImpl");dojo.declare("com.ibm.mm.enabler.model.state.NavigationStateModelFactoryImpl",[com.ibm.mashups.enabler.model.state.NavigationStateModelFactory],{constructor:function(){},getNavigationStateModel:function(){if(!this.navigationstatemodel){this.navigationstatemodel=new com.ibm.mm.enabler.model.state.NavigationStateModelImpl();}return this.navigationstatemodel;}});com.ibm.mashups.enabler.model.state.NavigationStateModelFactory=new com.ibm.mm.enabler.model.state.NavigationStateModelFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModelFactory"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.NavigationStateModelFactory"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.NavigationStateModelFactory");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGenerator_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGenerator_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.UrlGenerator_API");dojo.provide("com.ibm.mashups.enabler.model.state.UrlGenerator");dojo.declare("com.ibm.mashups.enabler.model.state.UrlGenerator",null,{getUrl:function(_5fd,_5fe,_5ff){},getURL:function(_600,_601,_602){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.UrlGeneratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.UrlGeneratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.UrlGeneratorImpl");dojo.declare("com.ibm.mm.enabler.model.state.UrlGeneratorImpl",com.ibm.mashups.enabler.model.state.UrlGenerator,{constructor:function(){},getUrl:function(_603,_604,_605){return this.getURL(_603,_604,_605);},getURL:function(_606,_607,_608){if(!_606){return null;}var _609=_606.clone();return _609._getFullUrl(_607,_608);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGenerator"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGenerator"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.UrlGenerator");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGeneratorFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGeneratorFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.UrlGeneratorFactory_API");dojo.provide("com.ibm.mashups.enabler.model.state.UrlGeneratorFactory");dojo.declare("com.ibm.mashups.enabler.model.state.UrlGeneratorFactory",null,{getUrlGenerator:function(){},getURLGenerator:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.state.UrlGeneratorFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.state.UrlGeneratorFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.state.UrlGeneratorFactoryImpl");dojo.declare("com.ibm.mm.enabler.model.state.UrlGeneratorFactoryImpl",com.ibm.mashups.enabler.model.state.UrlGeneratorFactory,{constructor:function(){this._urlGenerator=new com.ibm.mm.enabler.model.state.UrlGeneratorImpl();},getUrlGenerator:function(){return this.getURLGenerator();},getURLGenerator:function(){return this._urlGenerator;}});com.ibm.mashups.enabler.model.state.UrlGeneratorFactory=new com.ibm.mm.enabler.model.state.UrlGeneratorFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGeneratorFactory"]){dojo._hasResource["com.ibm.mashups.enabler.model.state.UrlGeneratorFactory"]=true;dojo.provide("com.ibm.mashups.enabler.model.state.UrlGeneratorFactory");}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.HiddenMetaDataLoadingStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.HiddenMetaDataLoadingStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.HiddenMetaDataLoadingStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.HiddenMetaDataLoadingStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(_60a){this.names=_60a;},getHiddenMetaDataToLoad:function(){return this.names;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(_60b){this.interval=_60b;},getInterval:function(){return this.interval;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(_60c,_60d){this.parentLevel=_60c;this.childrenLevel=_60d;},getChildrenLevel:function(){return this.childrenLevel;},getParentLevel:function(){return this.parentLevel;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.SyncMetaDataStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.SyncMetaDataStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.SyncMetaDataStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.SyncMetaDataStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.utils.EventTransformer_API"]){dojo._hasResource["com.ibm.mashups.enabler.utils.EventTransformer_API"]=true;dojo.provide("com.ibm.mashups.enabler.utils.EventTransformer_API");dojo.provide("com.ibm.mashups.enabler.utils.EventTransformer");dojo.declare("com.ibm.mashups.enabler.utils.EventTransformer",null,{isTransformable:function(_60e,_60f,_610){}});}if(!dojo._hasResource["com.ibm.mm.data.datatypes"]){dojo._hasResource["com.ibm.mm.data.datatypes"]=true;dojo.provide("com.ibm.mm.data.datatypes");dojo.declare("com.ibm.mm.data.datatypes",null,{_alltypes:{"text":1,"url":1,"html":1,"image":1,"number":1,"countrycode":1,"languagecode":1,"currency":1,"boolean":1,"date":1,"time":1,"timestamp":1,"email":1,"postalcode":1,"phone":1,"address":1,"person":1,"table":1,"atom":1,"xml":1,"json":1,"modeldata":1,"xsd:string":1,"xsd:boolean":1,"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"xsd:duration":1,"xsd:datetime":1,"xsd:time":1,"xsd:date":1,"xsd:gyearmonth":1,"xsd:gyear":1,"xsd:gmonthday":1,"xsd:gday":1,"xsd:gmonth":1,"xsd:hexbinary":1,"xsd:base64binary":1,"xsd:anyuri":1,"xsd:qname":1,"xsd:notation":1,"js:string":1,"js:number":1,"js:date":1,"js:boolean":1},_simpleTypes:{"text":1,"url":1,"html":1,"image":1,"number":1,"countrycode":1,"languagecode":1,"currency":1,"boolean":1,"date":1,"time":1,"timestamp":1,"email":1,"postalcode":1,"phone":1,"address":1,"person":1,"xsd:string":1,"xsd:boolean":1,"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"xsd:duration":1,"xsd:datetime":1,"xsd:time":1,"xsd:date":1,"xsd:gyearmonth":1,"xsd:gyear":1,"xsd:gmonthday":1,"xsd:gday":1,"xsd:gmonth":1,"xsd:hexbinary":1,"xsd:base64binary":1,"xsd:anyuri":1,"xsd:qname":1,"xsd:notation":1,"js:string":1,"js:number":1,"js:date":1,"js:boolean":1},_complexTypes:{"table":1,"atom":1,"xml":1,"json":1,"modeldata":1},specialTypes:{"mashupdata":1},_mappings:{text:{"url":1,"html":1,"number":1,"countrycode":1,"languagecode":1,"currency":1,"boolean":1,"date":1,"time":1,"timestamp":1,"email":1,"postalcode":1,"phone":1,"address":1,"person":1,"xsd:string":1,"xsd:boolean":1,"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"xsd:duration":1,"xsd:datetime":1,"xsd:time":1,"xsd:date":1,"xsd:gyearmonth":1,"xsd:gyear":1,"xsd:gmonthday":1,"xsd:gday":1,"xsd:gmonth":1,"xsd:hexbinary":1,"xsd:base64binary":1,"xsd:anyuri":1,"xsd:qname":1,"xsd:notation":1,"js:string":1,"js:number":1,"js:date":1,"js:boolean":1},"url":{"xsd:anyuri":1,"text":1,"xsd:string":1,"js:string":1},"html":{"text":1,"xsd:string":1,"js:string":1},"image":{},"number":{"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"js:number":1,"text":1,"xsd:string":1,"js:string":1},"countrycode":{"text":1,"xsd:string":1,"js:string":1},"languagecode":{"text":1,"xsd:string":1,"js:string":1},"currency":{"text":1,"xsd:string":1,"js:string":1},"boolean":{"xsd:boolean":1,"js:boolean":1,"text":1,"xsd:string":1,"js:string":1},"date":{"timestamp":1,"xsd:date":1,"js:date":1,"text":1,"xsd:string":1,"js:string":1},"time":{"timestamp":1,"xsd:time":1,"text":1,"xsd:string":1,"js:string":1},"timestamp":{"date":1,"time":1,"xsd:datetime":1,"text":1,"xsd:string":1,"js:string":1},"email":{"text":1,"xsd:string":1,"js:string":1},"postalcode":{"text":1,"xsd:string":1,"js:string":1},"phone":{"text":1,"xsd:string":1,"js:string":1},"address":{"text":1,"xsd:string":1,"js:string":1},"person":{"text":1,"xsd:string":1,"js:string":1},"json":{},"xsd:string":{"text":1,"url":1,"html":1,"number":1,"countrycode":1,"languagecode":1,"currency":1,"boolean":1,"date":1,"time":1,"timestamp":1,"email":1,"postalcode":1,"phone":1,"address":1,"person":1,"xsd:boolean":1,"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"xsd:duration":1,"xsd:datetime":1,"xsd:time":1,"xsd:date":1,"xsd:gyearmonth":1,"xsd:gyear":1,"xsd:gmonthday":1,"xsd:gday":1,"xsd:gmonth":1,"xsd:hexbinary":1,"xsd:base64binary":1,"xsd:anyuri":1,"xsd:qname":1,"xsd:notation":1,"js:string":1,"js:number":1,"js:date":1,"js:boolean":1},"xsd:boolean":{"boolean":1,"js:boolean":1,"text":1,"xsd:string":1,"js:string":1},"xsd:decimal":{"number":1,"js:number":1,"text":1,"xsd:string":1,"js:string":1},"xsd:float":{"number":1,"js:number":1,"text":1,"xsd:string":1,"js:string":1},"xsd:double":{"number":1,"js:number":1,"text":1,"xsd:string":1,"js:string":1},"xsd:duration":{"text":1,"xsd:string":1,"js:string":1},"xsd:gmonthday":{"text":1,"xsd:string":1,"js:string":1},"xsd:gday":{"text":1,"xsd:string":1,"js:string":1},"xsd:gmonth":{"text":1,"xsd:string":1,"js:string":1},"xsd:hexbinary":{"text":1,"xsd:string":1,"js:string":1},"xsd:base64binary":{"text":1,"xsd:string":1,"js:string":1},"xsd:qname":{"text":1,"xsd:string":1,"js:string":1},"xsd:notation":{"text":1,"xsd:string":1,"js:string":1},"xsd:anyuri":{"url":1,"text":1,"xsd:string":1,"js:string":1},"xsd:time":{"time":1,"text":1,"xsd:string":1,"js:string":1},"xsd:date":{"date":1,"js:date":1,"text":1,"xsd:string":1,"js:string":1},"xsd:datetime":{"timestamp":1,"text":1,"xsd:string":1,"js:string":1},"xsd:gyear":{"date":1,"text":1,"xsd:string":1,"js:string":1},"xsd:gyearmonth":{"date":1,"text":1,"xsd:string":1,"js:string":1},"js:string":{"text":1,"url":1,"html":1,"number":1,"countrycode":1,"languagecode":1,"currency":1,"boolean":1,"date":1,"time":1,"timestamp":1,"email":1,"postalcode":1,"phone":1,"address":1,"person":1,"xsd:string":1,"xsd:boolean":1,"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"xsd:duration":1,"xsd:datetime":1,"xsd:time":1,"xsd:date":1,"xsd:gyearmonth":1,"xsd:gyear":1,"xsd:gmonthday":1,"xsd:gday":1,"xsd:gmonth":1,"xsd:hexbinary":1,"xsd:base64binary":1,"xsd:anyuri":1,"xsd:qname":1,"xsd:notation":1,"js:number":1,"js:date":1,"js:boolean":1},"js:date":{"date":1,"xsd:date":1,"text":1,"xsd:string":1,"js:string":1},"js:number":{"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"number":1,"text":1,"xsd:string":1,"js:string":1},"js:boolean":{"xsd:boolean":1,"boolean":1,"text":1,"xsd:string":1,"js:string":1}},_semanticMappings:{text:{"xsd:string":1,"js:string":1},"url":{"xsd:anyuri":1},"html":{},"image":{},"number":{"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"js:number":1},"countrycode":{},"languagecode":{},"currency":{},"boolean":{"xsd:boolean":1,"js:boolean":1},"date":{"xsd:date":1,"js:date":1},"time":{"xsd:time":1},"timestamp":{"xsd:datetime":1},"email":{},"postalcode":{},"phone":{},"address":{},"person":{},"json":{},"xsd:string":{"text":1,"js:string":1},"xsd:boolean":{"boolean":1,"js:boolean":1},"xsd:decimal":{"number":1,"js:number":1},"xsd:float":{"number":1,"js:number":1},"xsd:double":{"number":1,"js:number":1},"xsd:duration":{},"xsd:gmonthday":{},"xsd:gday":{},"xsd:gmonth":{},"xsd:hexbinary":{},"xsd:base64binary":{},"xsd:qname":{},"xsd:notation":{},"xsd:anyuri":{"url":1},"xsd:time":{"time":1},"xsd:date":{"date":1,"js:date":1},"xsd:datetime":{"timestamp":1},"xsd:gyear":{"date":1},"xsd:gyearmonth":{"date":1},"js:string":{"text":1,"xsd:string":1},"js:date":{"date":1,"xsd:date":1},"js:number":{"xsd:decimal":1,"xsd:float":1,"xsd:double":1,"number":1},"js:boolean":{"xsd:boolean":1,"boolean":1}},_SIMPLE_DATA_TYPE:1,_COMBINED_DATA_TYPE:2,_COMPLEX_DATA_TYPE:3,resourceBundle:null,constructor:function(_611){this.resourceBundle=dojo.i18n.getLocalization("com.ibm.mm.data","dataTypeStrings");this.xsdNS=com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri(com.ibm.mm.enabler.model.NameSpaceFactory.NS_XSD);this.nsNS=com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri(com.ibm.mm.enabler.model.NameSpaceFactory.NS_EVENT_DATATYPES);this.jsNS=com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri(com.ibm.mm.enabler.model.NameSpaceFactory.NS_JS);this.xsdPrefix="xsd:";this.nsPrefix="";this.jsPrefix="js:";},addDataType:function(_612,_613){if(!_612){return;}this._alltypes.typename=1;if(!_613||_613==this._SIMPLE_DATA_TYPE){this._simpleTypes.typename=1;}else{this._complexTypes.typename=1;}},removeDataType:function(_614){delete this._alltypes[_614];},addDataMapping:function(_615,_616){if(this._mappings.typename1===null){this._mappings.typename1={};}this._mappings[_615][_616]=1;},removeDataMapping:function(_617,_618){if(this._mappings[_617]!==null){if(this._mappings[_617][_618]!==null){delete this._mappings[_617][_618];}}},getAllTypes:function(){return dojo.clone(this._alltypes);},doesTypeMatch:function(_619,_61a){var _61b=false;if(!_619||!_61a){return _61b;}_619=_619.toLowerCase();_61a=_61a.toLowerCase();if(_619==_61a||_619=="any"||_61a=="any"){_61b=true;}else{var _61c=this.checkDataType(_619);switch(_61c){case this._SIMPLE_DATA_TYPE:var _61d=this.checkDataType(_61a);switch(_61d){case this._SIMPLE_DATA_TYPE:if(this._mappings[_619][_61a]==1){_61b=true;}break;case this._COMBINED_DATA_TYPE:var _61e=this.getMainType(_61a);if(_619==_61e||this._mappings[_619][_61e]==1){_61b=true;}break;default:break;}break;case this._COMBINED_DATA_TYPE:break;case this._COMPLEX_DATA_TYPE:break;default:break;}}return _61b;},doesTypeFlexMatch:function(_61f,_620,_621){var _622=false;if(_61f===null||_620===null){return _622;}if((_621===null)||(typeof _621=="undefined")){_621=true;}_61f=this.getNormalizedPayload(_61f);_620=this.getNormalizedPayload(_620);_61f=_61f.toLowerCase();_620=_620.toLowerCase();if(_61f==_620||_61f=="any"||_620=="any"){_622=true;}else{var _623=this.checkDataType(_61f);var _624,_625;switch(_623){case this._SIMPLE_DATA_TYPE:_624=this.checkDataType(_620);switch(_624){case this._SIMPLE_DATA_TYPE:if(_621){if(this._mappings[_61f][_620]==1){_622=true;}}else{if(this._semanticMappings[_61f][_620]==1){_622=true;}}break;case this._COMBINED_DATA_TYPE:_625=this.getMainType(_620);if(_621){if(_61f==_625||this._mappings[_61f][_625]==1){_622=true;}}else{if(_61f==_625||this._semanticMappings[_61f][_625]==1){_622=true;}}break;default:break;}break;case this._COMBINED_DATA_TYPE:_624=this.checkDataType(_620);var _626=this.getMainType(_61f);switch(_624){case this._SIMPLE_DATA_TYPE:if(_621){if(_626==_620||this._mappings[_626][_620]==1){_622=true;}}else{if(_626==_620||this._semanticMappings[_626][_620]==1){_622=true;}}break;case this._COMBINED_DATA_TYPE:_625=this.getMainType(_620);if(_626==_625||this._mappings[_626][_625]==1){_622=true;}break;default:break;}break;default:break;}}return _622;},getMainType:function(_627){var _628=_627.indexOf(".");if(_628<0){return _627;}else{return _627.substring(0,_628);}},checkDataType:function(_629){_629=_629.toLowerCase();var _62a=_629.split(".");if(_62a.length==1){if(this._simpleTypes[_629]==1){return this._SIMPLE_DATA_TYPE;}else{return this._COMPLEX_DATA_TYPE;}}else{if(_62a.length==2||_62a.length==3){var _62b=_62a[0];var _62c=_62a[_62a.length-1];if(_62b=="url"||_62c=="languagecode"||_62c=="countrycode"){return this._COMBINED_DATA_TYPE;}else{return this._COMPLEX_DATA_TYPE;}}else{return this._COMPLEX_DATA_TYPE;}}},getTypeLabel:function(_62d,_62e){_62d=_62d.toLowerCase();var _62f=_62d;var _630=this.checkDataType(_62d);if(_630==this._COMBINED_DATA_TYPE){var _631=_62d.indexOf(".");var main=_62d.substring(0,_631);var _632=this.getSimpleTypeLabel(main,_62e);var sub=_62d.substring(_631+1,_62d.length);var _633=this.getSimpleTypeLabel(sub,_62e);_62f=_632+" ("+_633+")";}else{_62f=this.getSimpleTypeLabel(_62d,_62e);}return _62f;},getNormalizedPayload:function(_634){var _635=_634;var _636=_634;var _637=_634.indexOf("{");var _638=_634.indexOf("}");var _639="";if(_638>_637){_635=_634.substring(_637+1,_638);_636=_634.substring(_638+1,_634.length);if(_635===this.xsdNS){_639=this.xsdPrefix;}else{if(_635===this.jsNS){_639=this.jsPrefix;}else{if(_635===this.nsNS){_639=this.nsPrefix;}}}_636=_639+_636;}return _636;},getSimpleTypeLabel:function(_63a,_63b){var _63c;if(this.resourceBundle[_63a]){_63c=this.resourceBundle[_63a];}else{_63c=_63a.charAt(0).toUpperCase()+_63a.substring(1);}return _63c;}});}if(!dojo._hasResource["com.ibm.mm.enabler.utils.EventTransformerImpl"]){dojo._hasResource["com.ibm.mm.enabler.utils.EventTransformerImpl"]=true;dojo.provide("com.ibm.mm.enabler.utils.EventTransformerImpl");dojo.declare("com.ibm.mm.enabler.utils.EventTransformerImpl",[com.ibm.mashups.enabler.utils.EventTransformer],{constructor:function(){this.dataTypes=new com.ibm.mm.data.datatypes();},_transform:function(_63d,_63e,_63f){var _640=null;if(_63d.type==_63e.type||_63d.type=="any"||_63e.type=="any"){_640=new com.ibm.mm.iwidget.IEventImpl(_63d.name,_63d.type,_63d.payload,_63d.source);}else{var _641=this.isTransformable(_63d,_63e,_63f);if(_641){var _642=null;switch(_63e.type.toLowerCase()){case "time":if(_63d.type.toLowerCase()=="xsd:time"){_642=this._xsdTimeToMmTime(_63d.payload);}break;case "date":switch(_63d.type.toLowerCase()){case "xsd:date":_642=this._xsdDateToMmDate(_63d.payload);break;case "js:date":_642=this._jsDateToMmDate(_63d.payload);break;}break;case "timestamp":if(_63d.type.toLowerCase()=="xsd:datetime"){_642=this._xsdDateTimeToMmTimestamp(_63d.payload);}break;case "xsd:time":if(_63d.type.toLowerCase()=="time"){_642=this._mmTimeToXsdTime(_63d.payload);}break;case "xsd:date":switch(_63d.type.toLowerCase()){case "date":_642=this._mmDateToXsdDate(_63d.payload);break;case "js:date":_642=this._jsDateToXsdDate(_63d.payload);break;}break;case "xsd:datetime":if(_63d.type.toLowerCase()=="timestamp"){_642=this._mmTimestampToXsdDatetime(_63d.payload);}break;case "js:date":switch(_63d.type.toLowerCase()){case "xsd:date":_642=this._xsdDateToJsDate(_63d.payload);break;case "date":_642=this._mmDateToJsDate(_63d.payload);break;}break;}if(_642!==null){_640=new com.ibm.mm.iwidget.IEventImpl(_63d.name,_63e.type,_642,_63d.source);}else{_640=new com.ibm.mm.iwidget.IEventImpl(_63d.name,_63e.type,_63d.payload,_63d.source);}}}return _640;},isTransformable:function(_643,_644,_645){return this.dataTypes.doesTypeFlexMatch(_643.type,_644.type,_645);},_mmTimestampToXsdDatetime:function(_646){var _647="T";var _648="-";var _649=":";var _64a=/^([\d]{4})-([\d]{2})-([\d]{2})\s([\d]{2}):([\d]{2}):([\d]{2})$/;var _64b=/^([\d]{4})-([\d]{2})-([\d]{2})\s([\d]{2}):([\d]{2}):([\d]{2})\.([\d]{4})$/;var _64c=/^([\d]{4})([\d]{2})([\d]{2})\s([\d]{2})([\d]{2})([\d]{2})$/;var _64d=false;_64d=_64b.test(_646);if(_64d){var _64e=_646.split(new RegExp("[.]{1}"))[0];return _64e.replace(/\s/,_647);}else{_64d=_64a.test(_646);if(_64d){return _646.replace(/\s/,_647);}else{_64d=_64c.test(_646);if(_64d){var _64f=_64c.exec(_646);var yyyy=_64f[1];var _650=_64f[2];var dd=_64f[3];var hh=_64f[4];var _651=_64f[5];var ss=_64f[6];return yyyy+_648+_650+_648+dd+_647+hh+_649+_651+_649+ss;}else{return null;}}}},_mmDateToXsdDate:function(date){var _652="-";var _653="01";var _654="01";var _655=/^([\d]{4})-([\d]{2})-([\d]{2})$/;var _656=/^([\d]{4})([\d]{2})([\d]{2})$/;var _657=/^([\d]{4})([\d]{2})$/;var _658=/^([\d]{4})$/;var _659=false;_659=_655.test(date);if(_659){return date;}else{_659=_656.test(date);var yyyy,mm,_65a;if(_659){_65a=_656.exec(date);yyyy=_65a[1];mm=_65a[2];var dd=_65a[3];return yyyy+_652+mm+_652+dd;}else{_659=_657.test(date);if(_659){_65a=_657.exec(date);yyyy=_65a[1];mm=_65a[2];return yyyy+_652+mm+_652+_654;}else{_659=_658.test(date);if(_659){_65a=_658.exec(date);yyyy=_65a[1];return yyyy+_652+_653+_652+_654;}else{return null;}}}}},_mmTimeToXsdTime:function(time){var _65b=":";var _65c="00";var _65d="00";var _65e=/^\d{2}\:\d{2}\:\d{2}\.\d{4}$/;var _65f=/^\d{2}\:\d{2}\:\d{2}$/;var _660=/^\d{2}\:\d{2}$/;var _661=/^\d{2}$/;var _662=false;_662=_65e.test(time);if(_662){return time.split(new RegExp("[.]{1}"))[0];}else{_662=_65f.test(time);if(_662){return time;}else{_662=_660.test(time);if(_662){return time+_65b+_65d;}else{_662=_661.test(time);if(_662){return time+_65b+_65c+_65b+_65d;}else{return null;}}}}},_xsdDateTimeToMmTimestamp:function(_663){var _664=" ";var _665=/^\d{4}\-\d{2}\-\d{2}\T\d{2}\:\d{2}\:\d{2}/;var _666=false;_666=_665.test(_663);if(_666){var _667=_663.match(_665)[0];return _667.replace(/T/,_664);}else{return null;}},_xsdDateToMmDate:function(date){var _668=/^\d{4}\-\d{2}\-\d{2}/;var _669=false;_669=_668.test(date);if(_669){return date.match(_668)[0];}else{return null;}},_xsdTimeToMmTime:function(time){var _66a=/^\d{2}\:\d{2}\:\d{2}/;var _66b=false;_66b=_66a.test(time);if(_66b){return time.match(_66a)[0];}else{return null;}},_jsDateToMmDate:function(date){if(date){var year=date.getFullYear();var _66c=date.getMonth();var day=date.getDate();_66c=this._format(_66c.toString());day=this._format(day.toString());return year+"-"+_66c+"-"+day;}else{return null;}},_jsDateToXsdDate:function(date){var _66d=null;if(date){var year=date.getFullYear();var _66e=date.getMonth();var day=date.getDate();var _66f=date.getTimezoneOffset();_66e=this._format(_66e.toString());day=this._format(day.toString());_66d=year+"-"+_66e+"-"+day;if(_66f!==0){var _670;var _671;var _672;if(_66f<0){_671=Math.ceil(_66f/60);_672=(_66f*-1)%60;if(_672===0){_670="-"+this._format((_671*-1).toString())+":00";}else{_670="-"+this._format((_671*-1).toString())+this._format(_672);}_66d=_66d+_670;}else{_671=Math.floor(_66f/60);_672=_66f%60;if(_672===0){_670="+"+this._format((_671).toString())+":00";}else{_670="+"+this._format((_671).toString())+this._format(_672);}_66d=_66d+_670;}}}return _66d;},_xsdDateToJsDate:function(date){var _673=/^([\d]{4})-(\d\d)-(\d\d)/;var _674=false;_674=_673.test(date);if(_674){var _675=new Date(NaN);var _676;var _677=_673.exec(date);if(_677){_676=_677[2];_675.setFullYear(_677[1],_676-1,_677[3]);if(_676!=_675.getMonth()+1){_675.setTime(NaN);}}return _675;}else{return null;}},_mmDateToJsDate:function(date){return this._xsdDateToJsDate(this._mmDateToXsdDate(date));},_format:function(_678){if(_678.length==1){_678="0"+_678;}return _678;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.utils.EventTransformer"]){dojo._hasResource["com.ibm.mashups.enabler.utils.EventTransformer"]=true;dojo.provide("com.ibm.mashups.enabler.utils.EventTransformer");}if(!dojo._hasResource["com.ibm.mashups.iwidget.iEvents_API"]){dojo._hasResource["com.ibm.mashups.iwidget.iEvents_API"]=true;dojo.provide("com.ibm.mashups.iwidget.iEvents_API");dojo.provide("com.ibm.mashups.iwidget.iEvents");dojo.declare("com.ibm.mashups.iwidget.iEvents",null,{constructor:function(){},fireEvent:function(_679,_67a,_67b){},setEvent:function(_67c){},setEvents:function(_67d){},removeEvent:function(_67e){},removeEvents:function(_67f){},getEvents:function(_680){},createEventDescription:function(_681){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.IEventDescription_API"]){dojo._hasResource["com.ibm.mashups.iwidget.IEventDescription_API"]=true;dojo.provide("com.ibm.mashups.iwidget.IEventDescription_API");dojo.provide("com.ibm.mashups.iwidget.IEventDescription");dojo.declare("com.ibm.mashups.iwidget.IEventDescription",null,{constructor:function(){},alias:"",name:"",type:"",handlingFn:"",getDescription:function(_682){return null;},lang:"",isHandled:false,isPublished:false,getAttribute:function(_683,_684){return null;},setAttribute:function(_685,_686,_687){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.IEventDescription"]){dojo._hasResource["com.ibm.mashups.iwidget.IEventDescription"]=true;dojo.provide("com.ibm.mashups.iwidget.IEventDescription");}if(!dojo._hasResource["com.ibm.mm.iwidget.IEventDescriptionImpl"]){dojo._hasResource["com.ibm.mm.iwidget.IEventDescriptionImpl"]=true;dojo.provide("com.ibm.mm.iwidget.IEventDescriptionImpl");dojo.declare("com.ibm.mm.iwidget.IEventDescriptionImpl",com.ibm.mashups.iwidget.IEventDescription,{constructor:function(name,_688,type,_689,_68a,_68b,_68c){if(dojo.isString(name)){var obj={};obj.name=name;_688=_688||null;if(_688){obj.handlingFn=_688;obj.isHandled=true;obj.isPublished=false;}else{obj.isPublished=true;}type=type||null;if(type){obj.type=type;}_68b=_68b||null;if(_68b){obj.lang=_68b;}else{obj.lang="en";}obj.attributes={};obj.localizedAttributes={};_68a=_68a||null;if(_68a){obj.attributes.aliases=_68a;}_68c=_68c||null;if(_68c){obj.localizedAttributes=_68c;}if(_689){if(!obj.localizedAttributes[obj.lang]){obj.localizedAttributes[obj.lang]={};}obj.localizedAttributes[obj.lang].description=_689;}this._internalJsonObj=obj;}else{this._internalJsonObj=name;}this.initPredefinedFields(this._internalJsonObj);},initPredefinedFields:function(obj){this.name=obj.name;this.type=obj.type;this.lang=obj.lang;this.handlingFn=obj.handlingFn;this.isHandled=obj.isHandled;this.isPublished=obj.isPublished;},getDescription:function(_68d){return this._getLocalizedAttribute("description",_68d);},getTitle:function(_68e){return this._getLocalizedAttribute("title",_68e);},_getLocalizedAttribute:function(_68f,_690){var _691=null,_692=null;var lc=com.ibm.mashups.enabler.context.Factory.getLocalizedContext(_690,this.lang);var _693=lc.getLocale(this);if(this.localemapping&&this.localemapping[_693]){_693=this.localemapping[_693];}if(this._internalJsonObj.localizedAttributes){_692=this._internalJsonObj.localizedAttributes[_693];if(_692){_691=_692[_68f];}}if(!_691){_691=this[_68f];}if(typeof _691=="undefined"){_691=null;}return _691;},setOnRemoveWire:function(_694){if(typeof _694=="undefined"||_694===null){_694="onRemoveWire";}if(typeof this._internalJsonObj.attributes=="undefined"){this._internalJsonObj.attributes={};}this._internalJsonObj.attributes.onRemoveWire=_694;return this;},getOnRemoveWire:function(){if(typeof this._internalJsonObj.attributes!="undefined"&&this._internalJsonObj.attributes.onRemoveWire){return this._internalJsonObj.attributes.onRemoveWire;}return null;},setOnNewWire:function(_695){if(typeof _695=="undefined"||_695===null){_695="onNewWire";}if(typeof this._internalJsonObj.attributes=="undefined"){this._internalJsonObj.attributes={};}this._internalJsonObj.attributes.onNewWire=_695;return this;},getOnNewWire:function(){if(typeof this._internalJsonObj.attributes!="undefined"&&this._internalJsonObj.attributes.onNewWire){return this._internalJsonObj.attributes.onNewWire;}return null;},getLocales:function(){var _696=[];var _697={};if(this._internalJsonObj.localizedAttributes){for(var i in this._internalJsonObj.localizedAttributes){if(Object.prototype.hasOwnProperty.call(this._internalJsonObj.localizedAttributes,i)){_696.push(i);var _698=com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(i);if(_698!=i){_697[_698]=i;}}}}this.localemapping=_697;return _696;},toString:function(){var temp=this.toJson();return dojo.toJson(temp);},_getInternalJsonObj:function(){return this._internalJsonObj;},toJson:function(){var _699={};for(var i in this._internalJsonObj){if(Object.prototype.hasOwnProperty.call(this._internalJsonObj,i)){if(i=="handlingFn"){if(dojo.isFunction(this._internalJsonObj[i])){_699[i]="HANDLEFN";continue;}}_699[i]=dojo.clone(this._internalJsonObj[i]);}}return _699;},clone:function(){var temp=dojo.toJson(this._internalJsonObj);if(temp){return new com.ibm.mm.iwidget.IEventDescriptionImpl(dojo.fromJson(temp));}else{return null;}},getAttribute:function(_69a,_69b){if(!_69a){return null;}if(!_69b){if(this._internalJsonObj.attributes&&this._internalJsonObj.attributes[_69a]){return this._internalJsonObj.attributes[_69a];}if(this._internalJsonObj.localizedAttributes&&this._internalJsonObj.localizedAttributes[this.lang]){var _69c=this._internalJsonObj.localizedAttributes[this.lang][_69a];if(_69c){return _69c;}}return null;}else{return this._getLocalizedAttribute(_69a,_69b);}},setAttribute:function(_69d,_69e,_69f){if(!_69d){return null;}if(typeof _69e=="undefined"){return null;}if(!_69f){if(typeof this._internalJsonObj.attributes=="undefined"){this._internalJsonObj.attributes={};}this._internalJsonObj.attributes[_69d]=_69e;if(_69e===null){delete this._internalJsonObj.attributes[_69d];}return this;}if(!this._internalJsonObj.localizedAttributes[_69f]){this._internalJsonObj.localizedAttributes[_69f]={};}this._internalJsonObj.localizedAttributes[_69f][_69d]=_69e;if(_69e===null){delete this._internalJsonObj.localizedAttributes[_69f][_69d];}return this;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextIEventsImpl"]){dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextIEventsImpl"]=true;dojo.provide("com.ibm.mm.iwidget.icontext.IContextIEventsImpl");dojo.declare("com.ibm.mm.iwidget.icontext.IContextIEventsImpl",com.ibm.mashups.iwidget.iEvents,{constructor:function(_6a0){this.widget=_6a0;this.id=_6a0.id;this.svc=com.ibm.mashups.services.ServiceManager.getService("eventService");},createEventDescription:function(_6a1){return new com.ibm.mm.iwidget.IEventDescriptionImpl(_6a1);},getEvents:function(_6a2){var _6a3=this.widget._getPublicEvents();var _6a4=_6a3.getEvents(_6a2);if(!_6a4){return null;}var arr=[];for(var i in _6a4){if(Object.prototype.hasOwnProperty.call(_6a4,i)){arr.push(_6a4[i].clone());}}return arr;},setEvent:function(_6a5){var _6a6=this.widget._getPublicEvents();var rc=_6a6.eventExists(_6a5.name);if(rc){if(this.widget._inIframe()){this.svc._publishEvent(this.svc.WIDGETEVENT_PREFIX+"_stub_"+this.id,{"scope":"eventmodel","methodname":"updateEvent","params":[_6a5.toJson()]},this.id);}rc=_6a6.updateEvent(_6a5);}else{if(this.widget._inIframe()){this.svc._publishEvent(this.svc.WIDGETEVENT_PREFIX+"_stub_"+this.id,{"scope":"eventmodel","methodname":"createEvent","params":[_6a5.toJson()]},this.id);}rc=_6a6.createEvent(_6a5);}return rc;},removeEvent:function(_6a7){if(this.widget._inIframe()){this.svc._publishEvent(this.svc.WIDGETEVENT_PREFIX+"_stub_"+this.id,{"scope":"eventmodel","methodname":"removeEvent","params":[_6a7]},this.id);}var _6a8=this.widget._getPublicEvents();var rc=_6a8.removeEvent(_6a7);return rc;},publishEvent:function(_6a9,_6aa,_6ab){return this.fireEvent(_6a9,_6ab,_6aa);},fireEvent:function(_6ac,_6ad,_6ae){var _6af=this.widget._getPublicEvents();var _6b0=false;var temp;if(_6af){temp=_6af.find(_6ac);if(temp){_6ad=temp.type;}if(temp&&temp.handlingFn){_6b0=true;}}var _6b1=new com.ibm.mm.iwidget.IEventImpl(_6ac,_6ad,_6ae,null);if(!_6b0){this.widget.handleEvent(_6b1);}if(_6af){temp=_6af.find(_6ac);if(temp&&temp.isPublished){this.svc.publishWire(this.id,_6ac,_6ae,_6ad);}}},setEvents:function(_6b2){var _6b3=this.widget._getPublicEvents();if(this.widget._inIframe()){var arr=[];for(var i=0;i<_6b2.length;i++){arr.push(_6b2[i].toJson());}this.svc._publishEvent(this.svc.WIDGETEVENT_PREFIX+"_stub_"+this.id,{"scope":"eventmodel","methodname":"setEvents","params":[arr]},this.id);}rc=_6b3.setEvents(_6b2);return rc;},removeEvents:function(_6b4){if(this.widget._inIframe()){this.svc._publishEvent(this.svc.WIDGETEVENT_PREFIX+"_stub_"+this.id,{"scope":"eventmodel","methodname":"removeEvents","params":[_6b4]},this.id);}var _6b5=this.widget._getPublicEvents();var rc=_6b5.removeEvents(_6b4);return rc;}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.iEvents"]){dojo._hasResource["com.ibm.mashups.iwidget.iEvents"]=true;dojo.provide("com.ibm.mashups.iwidget.iEvents");}if(!dojo._hasResource["com.ibm.mashups.iwidget.io_API"]){dojo._hasResource["com.ibm.mashups.iwidget.io_API"]=true;dojo.provide("com.ibm.mashups.iwidget.io_API");dojo.provide("com.ibm.mashups.iwidget.io");dojo.declare("com.ibm.mashups.iwidget.io",null,{constructor:function(){},XMLHttpRequest:function(){},rewriteURI:function(uri,_6b6){return null;},xhrReq:function(args){return;}});}if(!dojo._hasResource["com.ibm.mm.enabler.utils.URLHelper"]){dojo._hasResource["com.ibm.mm.enabler.utils.URLHelper"]=true;dojo.provide("com.ibm.mm.enabler.utils.URLHelper");com.ibm.mm.enabler.utils.URLHelper={rewriteURL:function(_6b7){var _6b8=new com.ibm.mm.enabler.utils.HttpUrl(_6b7);return _6b8.toProxifiedString();}};}if(!dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextIOImpl"]){dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextIOImpl"]=true;dojo.provide("com.ibm.mm.iwidget.icontext.IContextIOImpl");dojo.declare("com.ibm.mm.iwidget.icontext.IContextIOImpl",com.ibm.mashups.iwidget.io,{constructor:function(_6b9){this.id=_6b9.id;this.widget=_6b9;this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},XMLHttpRequest:function(){return dojo._xhrObj();},rewriteURI:function(uri,_6ba){if(this.bIsLoggable){this.LOGGER.entering("com.ibm.mm.iwidget.io.rewriteURI",[uri,_6ba]);}var _6bb=this.widget._rewriteURI(uri,_6ba);if(this.bIsLoggable){this.LOGGER.exiting("com.ibm.mm.iwidget.io.rewriteURI",[_6bb]);}return _6bb;},getWebAppRootPath:function(){if(this.rootPath){return this.rootPath;}var _6bc=this.widget.getIWidgetInstance().widgetXMLUrl;_6bc=this.widget._getRawBaseUri(_6bc);_6bc=this.widget._getResolvedPocUri(_6bc);var _6bd=null;if(_6bc&&_6bc.indexOf("/")===0){var temp=_6bc.substring(1);if(temp.indexOf("/")>0){_6bd="/"+temp.substring(0,temp.indexOf("/"));}else{_6bd=_6bc;}}if(_6bd){this.rootPath=_6bd;return _6bd;}if(_6bc&&_6bc.indexOf("://")>0){var _6be=_6bc.split("/");if(_6be.length>=4){_6bd=_6be[0]+"//"+_6be[2]+"/"+_6be[3];}}if(_6bd){this.rootPath=_6bd;return _6bd;}return null;},request:function(_6bf,uri,_6c0,_6c1,_6c2){var xhr=dojo._xhrObj();var _6c3=this.rewriteURI(uri);var _6c4=false;if(_6c0){xhr.onreadystatechange=_6c0;_6c4=true;}var _6c5=_6bf||null;if(!_6bf){_6c5=this.httpmethods.GET;}if(_6bf){if(!this.httpmethods[_6bf]){_6c5=this.httpmethods.GET;}}xhr.open(_6c5,_6c3,_6c4);var _6c6=null;var _6c7="application/x-www-form-urlencoded";if(_6c2){for(var i=0;i<_6c2.length;i++){var _6c8=_6c2[i];var _6c9=_6c8[_6c9];var _6ca=_6c8[_6ca];if(_6c9=="Content-Type"){_6c6=_6ca;}else{xhr.setRequestHeader(_6c9,_6ca);}}}xhr.setRequestHeader("Content-Type",(_6c6||_6c7));if(_6c5==this.httpmethods.PUT||_6c5==this.httpmethods.POST){if(_6c1){xhr.send(_6c1);}}else{xhr.send(null);}return xhr;},xhrReq:function(args){if(!args){return;}if(!args.requestVerb||!args.url||!args.handleAs){return;}var _6cb=args.requestVerb;if(_6cb&&!this.requestVerbs[_6cb]){_6cb=this.requestVerbs.get;}if(_6cb&&_6cb==this.requestVerbs.get){var obj=args;delete obj.requestVerb;dojo.xhrGet(obj);return;}if(_6cb&&_6cb==this.requestVerbs.put){var obj1=args;delete obj1.requestVerb;if(obj1.msgData){obj1.putData=obj1.msgData;delete obj1.msgData;}dojo.xhrPut(obj1);return;}if(_6cb&&_6cb==this.requestVerbs["delete"]){var obj2=args;delete obj2.requestVerb;dojo.xhrDelete(obj2);return;}if(_6cb&&_6cb==this.requestVerbs.post){var obj3=args;delete obj3.requestVerb;if(obj3.msgData){obj3.postData=obj3.msgData;delete obj3.msgData;}dojo.xhrPost(obj3);return;}},httpmethods:{GET:"GET",PUT:"PUT",POST:"POST",DELETE:"DELETE"},requestVerbs:{get:"get",put:"put",post:"post","delete":"delete"}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.io"]){dojo._hasResource["com.ibm.mashups.iwidget.io"]=true;dojo.provide("com.ibm.mashups.iwidget.io");}if(!dojo._hasResource["com.ibm.mashups.iwidget.iContext_API"]){dojo._hasResource["com.ibm.mashups.iwidget.iContext_API"]=true;dojo.provide("com.ibm.mashups.iwidget.iContext_API");dojo.provide("com.ibm.mashups.iwidget.iContext");dojo.declare("com.ibm.mashups.iwidget.iContext",null,{constructor:function(){},constants:{mode:{VIEW:"view",EDIT:"edit",PERSONALIZE:"personalize",CONFIG:"config",HELP:"help"},event:{TITLE:"title",DESCRIPTION:"description"},ATTRIBUTES:"attributes",IDESCRIPTOR:"idescriptor",USERPROFILE:"userprofile",keys:{SHIFT:1,ALT:2,CTRL:4,META:8,CAPSLOCK:16},windowstate:{NORMAL:"normal",MINIMIZE:"minimize",MAXIMIZE:"maximize"},status:{SUCCESS:200,TIMEOUT:408,NOTFOUND:404,INTERROR:500,OTHER:303},changeType:{CHANGEDVALUE:"changedValue",NEWITEM:"newItem",REMOVEDITEM:"removedItem"}},getWidgetId:function(){return null;},getRootElement:function(){return null;},getElementById:function(id,root){return null;},getiWidgetAttributes:function(){return {};},getItemSet:function(name,_6cc){return null;},getShareableItemSet:function(name){return null;},requires:function(_6cd,_6ce,uri,cb,_6cf){},iScope:function(){return null;},processMarkup:function(_6d0){return null;},processiWidgets:function(root){},getElementByClass:function(_6d1,root){return null;},getUserProfile:function(){return null;},getiDescriptor:function(){return null;},io:{},iEvents:{}});}if(!dojo._hasResource["com.ibm.mm.iwidget.Utils"]){dojo._hasResource["com.ibm.mm.iwidget.Utils"]=true;dojo.provide("com.ibm.mm.iwidget.Utils");dojo.declare("com.ibm.mm.iwidget.UtilsDefaultImpl",null,{widgetClassRE:new RegExp("(mm:|mm_|iw-)iWidget"),findElementByAttribute:function(att,_6d2,root,_6d3,_6d4){var _6d5=root;if(!root.childNodes){return false;}if(att=="class"){dojo.query("."+_6d2,root).forEach(function(ele){_6d3.push(ele);});return _6d3.length!==0;}if(root.getElementsByTagName){var _6d6=root.getElementsByTagName("*");for(var i=0,l=_6d6.length;i<l;i++){var _6d7=_6d6[i];if(_6d7&&_6d7.getAttribute){var _6d8=_6d7.getAttribute(att);if(_6d8==_6d2){_6d3.push(_6d7);if(!_6d4){return true;}}}}}return false;},getClass:function(node){var _6d9=node.getAttribute("class");_6d9=_6d9?_6d9:node.getAttribute("className");return _6d9;},checkParentElement:function(_6da,_6db){if(_6da){var _6dc=_6da.parentNode;if(_6dc){if(_6dc.className){if(_6dc.className.match(_6db)){return _6dc.id;}}return this.checkParentElement(_6dc,_6db);}}return null;},getWidgetParent:function(node,_6dd){if(dojo.isString(node)){node=dojo.byId(node);}if(!_6dd){_6dd=this.widgetClassRE;}return this.checkParentElement(node,_6dd);},getParents:function(_6de,arr){var _6df=_6de.getParent();if(_6df){arr.push(_6df);this.getParents(_6df,arr);}return;},getModelID:function(id){var ret=id;var _6e0=ibmConfig[com.ibm.mashups.enabler.services.ConfigConstants.ID_PREFIX];if(_6e0&&dojo.isString(ret)){var indx=ret.indexOf(_6e0);if(indx===0){ret=ret.substring(_6e0.length);}}return ret;},getMarkupID:function(id){var ret=id;var _6e1=ibmConfig[com.ibm.mashups.enabler.services.ConfigConstants.ID_PREFIX];if(_6e1&&dojo.isString(ret)){ret=_6e1+ret;}return ret;},stripHashPrefix:function(str){if(dojo.isString(str)){var pos=str.indexOf("#");if(pos!==-1){return str.substr(1+pos);}}return str;}});com.ibm.mm.iwidget.Utils=new com.ibm.mm.iwidget.UtilsDefaultImpl();if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.UtilsExtended");}}if(!dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextDefaultImpl"]){dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextDefaultImpl"]=true;dojo.provide("com.ibm.mm.iwidget.icontext.IContextDefaultImpl");dojo.declare("com.ibm.mm.iwidget.icontext.IContextDefaultImpl",com.ibm.mashups.iwidget.iContext,{constructor:function(_6e2){this.widgetwrapper=_6e2;this.widgetId=_6e2.id;this.scope={};this.rootElement=dojo.byId(this.widgetId);this.ns=this.rootElement.className.substr(0,3);this._initEvents();this._initIO();this._initMMExtension();},getWidgetId:function(){if(this.widgetId){return this.widgetId;}return null;},_initEvents:function(){this.iEvents=null;},_initMMExtension:function(){this._mm=null;},getRootElement:function(){return dojo.byId(this.widgetId);},getElementById:function(id,root){if(!root){root=this._getContentRoot();}var _6e3=[];var rc=com.ibm.mm.iwidget.Utils.findElementByAttribute("id",id,root,_6e3,false);if(rc){return _6e3[0];}else{return null;}},getiWidgetAttributes:function(){var _6e4=this.widgetwrapper.getAttributes();return _6e4;},getItemSet:function(name,_6e5){if(typeof name=="undefined"||name===null){return null;}if(name==iwConstants.ATTRIBUTES){return this.getiWidgetAttributes();}if(name==iwConstants.USERPROFILE){return this.getUserProfile();}if(name==iwConstants.IDESCRIPTOR){return this.getiDescriptor();}var _6e6=this.widgetwrapper.getWidgetItemSet(name);return _6e6;},iScope:function(){return this.scope;},processMarkup:function(_6e7){var _6e8=_6e7.replace(/_IWID_/g,"_"+this.widgetId+"_");var _6e9=_6e8.replace(/iContext(?=\.|\s|\(|\))/g,"_"+this.widgetId+"_iContext");return _6e9;},getElementByClass:function(_6ea,root){if(!root){root=this._getContentRoot();}var _6eb=dojo.query("."+_6ea,root);if(typeof _6eb!="undefined"&&_6eb!==null){if(_6eb.length===0){return null;}else{var _6ec=[];for(var i=0;i<_6eb.length;i++){_6ec.push(_6eb[i]);}return _6ec;}}return null;},getWidgetXMLPath:function(){var url=this.widgetwrapper.getIWidgetInstance().widgetXMLUrl;var _6ed=url.indexOf("?");if(0<_6ed){url=url.substring(0,_6ed);}var url2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(url);if(url2){url=url2;}return url;},_getWidgetBaseUri:function(){var _6ee=this.widgetwrapper.getIWidgetInstance().widgetXMLUrl;var _6ef=_6ee.indexOf("?");if(0<_6ef){_6ee=_6ee.substring(0,_6ef);}return _6ee.substring(0,_6ee.lastIndexOf("/")+1);},_getContentRoot:function(){var _6f0=this.getRootElement();var _6f1=this.widgetwrapper.currentMode;if(!_6f1){_6f1="view";}var _6f2=this.widgetwrapper.windowManager[_6f1];if(_6f2){var temp=_6f2.root;if(temp){_6f0=temp;}}return _6f0;},getiDescriptor:function(){var _6f3=this.widgetwrapper.getIDescriptorItems();return _6f3;},_initIO:function(){this.io=new com.ibm.mm.iwidget.icontext.IContextIOImpl(this.widgetwrapper);},getUserProfile:function(){return null;},requires:function(_6f4,_6f5,uri,cb,_6f6){return;},processiWidgets:function(root){return;}});com.ibm.mm.iwidget.icontext.IContextImpl=com.ibm.mm.iwidget.icontext.IContextDefaultImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.icontext.IContextExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.iwidget.iContext"]){dojo._hasResource["com.ibm.mashups.iwidget.iContext"]=true;dojo.provide("com.ibm.mashups.iwidget.iContext");}if(!dojo._hasResource["com.ibm.mashups.iwidget.itemset.ItemSet"]){dojo._hasResource["com.ibm.mashups.iwidget.itemset.ItemSet"]=true;dojo.provide("com.ibm.mashups.iwidget.itemset.ItemSet");dojo.declare("com.ibm.mashups.iwidget.itemset.ItemSet",null,{constructor:function(){},setLocalizedItemValue:function(_6f7,_6f8,_6f9){return this;},setItemValue:function(_6fa,_6fb,_6fc){return this;},setItemValue:function(_6fd,_6fe){return this;},getLocalizedItemValue:function(_6ff,_700){return null;},getItemValue:function(_701){return null;},getAllNames:function(){return null;},removeItem:function(_702){return null;},removeItemValue:function(_703){return null;},removeLocalizedItemValue:function(_704,_705){return null;},getLocalesWithValues:function(_706){return null;},clone:function(){return null;},isReadOnly:function(_707){return false;},getItemSetDescription:function(){return null;},addListener:function(_708){return null;},removeListener:function(_709){return true;}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.itemset.ManagedItemSetCallbackModel"]){dojo._hasResource["com.ibm.mashups.iwidget.itemset.ManagedItemSetCallbackModel"]=true;dojo.provide("com.ibm.mashups.iwidget.itemset.ManagedItemSetCallbackModel");dojo.declare("com.ibm.mashups.iwidget.itemset.ManagedItemSetCallbackModel",null,{constructor:function(){},postSaveCallbackFn:function(_70a,_70b){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.itemset.ManagedItemSet_API"]){dojo._hasResource["com.ibm.mashups.iwidget.itemset.ManagedItemSet_API"]=true;dojo.provide("com.ibm.mashups.iwidget.itemset.ManagedItemSet_API");dojo.provide("com.ibm.mashups.iwidget.itemset.ManagedItemSet");dojo.declare("com.ibm.mashups.iwidget.itemset.ManagedItemSet",null,{constructor:function(){},save:function(_70c){},commit:function(_70d){},setItemValue:function(_70e,_70f,_710){return this;},setItemValue:function(_711,_712){return this;},getItemValue:function(_713){return null;},getAllNames:function(){return null;},removeItem:function(_714){return null;},clone:function(){return null;},isReadOnly:function(_715){return null;},getItemSetDescription:function(){return null;},addListener:function(_716){return null;},removeListener:function(_717){return true;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.manageditemset.IDescriptorDefaultImpl"]){dojo._hasResource["com.ibm.mm.iwidget.manageditemset.IDescriptorDefaultImpl"]=true;dojo.provide("com.ibm.mm.iwidget.manageditemset.IDescriptorDefaultImpl");dojo.declare("com.ibm.mm.iwidget.manageditemset.IDescriptorDefaultImpl",com.ibm.mashups.iwidget.itemset.ManagedItemSet,{constructor:function(_718,_719,_71a){this.widget=_718;this.defiDescriptorItems=_719;this.instanceiDescriptorItems=_71a;this.navStateModel=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();this._updatedItems={};},readOnlyItems:{defaultHeight:"defaultHeight",defaultWidth:"defaultWidth",displayLocale:"displayLocale",messageLocale:"messageLocale",author:"author",email:"email",website:"website",version:"version",icon:"icon"},writableItems:{title:"title",name:"name",description:"description",availableMessageLocales:"availableMessageLocales",mode:"mode",windowState:"windowState"},localizedItems:{title:"title",name:"name",description:"description"},getItemValue:function(name){if(typeof name=="undefined"||name===null){return null;}var _71b=null;if(name==iwConstants.iDescriptorItems.mode){var _71c=this.widget;if(_71c){_71b=_71c.currentMode;}}else{if(name==iwConstants.iDescriptorItems.displayLocale){var _71d=ibmConfig.locale;var _71e=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var temp=_71e.getValue(com.ibm.mashups.enabler.services.ConfigConstants.DISPLAY_LOCALE);if(temp){_71d=temp;}_71b=_71d;}else{if(name==iwConstants.iDescriptorItems.messageLocale){_71b=this._getMessageLocale();}else{if(name==iwConstants.iDescriptorItems.windowState){_71b=this._getWindowState();}else{_71b=this._getItemValue(name);}}}}return _71b;},_getWindowState:function(){return "normal";},_getItemValue:function(_71f){var _720=null;if(this.localizedItems[_71f]){_720=this._getMessageLocale();}var _721=null;if(this.defiDescriptorItems){_721=this.defiDescriptorItems.getItemValue(_71f,_720);if(typeof _721=="undefined"){_721=null;}}var _722=null;if(this.instanceiDescriptorItems){_722=this.instanceiDescriptorItems.getItemValue(_71f,_720);}if(_722){return _722;}return _721;},_setDynamicTitleOrIcon:function(name,_723){},setItemValue:function(name,_724){if(typeof name=="undefined"||name===null){return null;}if(typeof _724=="undefined"||_724===null){return null;}if(this.readOnlyItems[name]){return null;}if(name==iwConstants.iDescriptorItems.mode){var _725=this._getWidgetDef().getSupportedModes();if(this._contains(_725,_724)){this._updatedItems[name]=_724;}else{return null;}}if(name==iwConstants.iDescriptorItems.windowState){var _726=this._getWidgetDef().getSupportedWindowStates();if(this._contains(_726,_724)){this._updatedItems[name]=_724;}else{return null;}}if(this.widget.id&&(name==iwConstants.iDescriptorItems.title||name==iwConstants.iDescriptorItems.icon)){this._setDynamicTitleOrIcon(name,_724);}var _727=null;if(this.localizedItems[name]){_727=this._getMessageLocale();}if(name==this.writableItems.title||name==this.writableItems.name||name==this.writableItems.description){this.instanceiDescriptorItems.setItemValue(name,_724,false,_727);}if(name==iwConstants.iDescriptorItems.availableMessageLocales){this.instanceiDescriptorItems.setItemValue(name,_724,false);}return this;},isReadOnly:function(name){if(typeof name=="undefined"||name===null){return false;}if(this.readOnlyItems[name]){return true;}else{return false;}},removeItem:function(name){return null;},getAllNames:function(){var arr={};if(this.defiDescriptorItems){var _728=this.defiDescriptorItems.getAllNames();for(var i in _728){if(Object.prototype.hasOwnProperty.call(_728,i)){arr[_728[i]]=true;}}}if(this.instanceiDescriptorItems){var _729=this.instanceiDescriptorItems.getAllNames();for(var j in _729){if(Object.prototype.hasOwnProperty.call(_729,j)){arr[_729[j]]=true;}}}var _72a=[];for(var name in arr){if(Object.prototype.hasOwnProperty.call(arr,name)){_72a.push(name);}}return _72a;},save:function(cb){return this.commit(cb);},commit:function(_72b){if(this.serverless){this._saveMicroformat();}if(this._updatedItems[iwConstants.iDescriptorItems.mode]){var _72c=this._updatedItems[iwConstants.iDescriptorItems.mode];this.widget._handleOnModeChange(_72c);}if(this._updatedItems[iwConstants.iDescriptorItems.windowState]){var _72d=this._updatedItems[iwConstants.iDescriptorItems.windowState];var _72e=this._getWindowState();var _72f=com.ibm.mashups.services.ServiceManager.getService("eventService");_72f.publishEvent(com.ibm.mashups.iwidget.Constants.CHANGE_WIDGETWINDOWSTATE,{id:this.widget.id,newWindowState:_72d,oldWindowState:_72e});}if(_72b){_72b(iwConstants.IDESCRIPTOR,true);}},_saveMicroformat:function(){this.widget.commit();var _730={};_730.wid=this.widget.id;this.widget.eventSvr._publishEvent(iwConstants.EVENTS.onAttributeSaved,_730,this.widget.hubId);},addListener:function(fn){var _731=this.widget;var _732=_731._registerListener(iwConstants.IDESCRIPTOR,fn);return _732;},removeListener:function(_733){var _734=this.widget;return _734._removeListener(iwConstants.IDESCRIPTOR,_733);},_getWidgetDef:function(){return this.widget.widgetDef;},_contains:function(arr,_735){var rc=false;for(var i=0;i<arr.length;i++){if(_735==arr[i]){rc=true;break;}}return rc;},_getMessageLocale:function(){if(this.messageLocale){return this.messageLocale;}var _736=null;var _737=this._getItemValue(iwConstants.iDescriptorItems.messageLocale);if(_737){var _738=_737.split(" ");var _739=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var temp=_739.getValue(com.ibm.mashups.enabler.services.ConfigConstants.DISPLAY_LOCALE);if(temp){_736=this._getLocale(_738,temp,ibmConfig.locale);}}if(!_736){_736=ibmConfig.locale;}this.messageLocale=_736;return this.messageLocale;},_getLocale:function(_73a,_73b,_73c){switch(_73a.length){case 0:return null;case 1:return com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(_73a[0]);default:var _73d=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(_73b,_73a);if(_73d){return _73d;}var _73e=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(_73c,_73a);if(_73e){return _73e;}return com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(_73a[0]);}}});com.ibm.mm.iwidget.manageditemset.IDescriptorImpl=com.ibm.mm.iwidget.manageditemset.IDescriptorDefaultImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.manageditemset.IDescriptorExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.iwidget.itemset.ManagedItemSet"]){dojo._hasResource["com.ibm.mashups.iwidget.itemset.ManagedItemSet"]=true;dojo.provide("com.ibm.mashups.iwidget.itemset.ManagedItemSet");}if(!dojo._hasResource["com.ibm.mashups.iwidget.itemset.PersistentAttributesFactory"]){dojo._hasResource["com.ibm.mashups.iwidget.itemset.PersistentAttributesFactory"]=true;dojo.provide("com.ibm.mashups.iwidget.itemset.PersistentAttributesFactory");dojo.declare("com.ibm.mashups.iwidget.itemset.PersistentAttributesFactory",null,{createPersistentAttributes:function(_73f,_740){},getSupportedPersistenceMode:function(){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.itemset.ShareableItemSet"]){dojo._hasResource["com.ibm.mashups.iwidget.itemset.ShareableItemSet"]=true;dojo.provide("com.ibm.mashups.iwidget.itemset.ShareableItemSet");dojo.declare("com.ibm.mashups.iwidget.itemset.ShareableItemSet",null,{constructor:function(){},setItemValue:function(_741,_742){return this;},getItemValue:function(_743){return null;},getAllNames:function(){return null;},removeItem:function(_744){return null;},commit:function(){return null;},addListener:function(_745){return null;},removeListener:function(_746){return true;}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.model.Factory_API"]){dojo._hasResource["com.ibm.mashups.iwidget.model.Factory_API"]=true;dojo.provide("com.ibm.mashups.iwidget.model.Factory_API");dojo.provide("com.ibm.mashups.iwidget.model.Factory");dojo.declare("com.ibm.mashups.iwidget.model.Factory",null,{constructor:function(){},getGlobalWidgetModel:function(){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.Wire_API"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.Wire_API"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.Wire_API");dojo.provide("com.ibm.mashups.iwidget.widget.Wire");dojo.declare("com.ibm.mashups.iwidget.widget.Wire",null,{constructor:function(){},getSourceWidgetID:function(){},getSourceEventName:function(){},getTargetWidgetID:function(){},getTargetEventName:function(){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.WireImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.WireImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.WireImpl");dojo.declare("com.ibm.mm.iwidget.widget.WireImpl",com.ibm.mashups.iwidget.widget.Wire,{constructor:function(_747,obj){if(obj){this.SourceWidget=obj.SourceWidget;this.SourceEvent=obj.SourceEvent;this.TargetEvent=obj.TargetEvent;}this.TargetWidget=_747;this._isDirty=false;this._type=null;},TYPE_NEW:"NEW",TYPE_DELETE:"DELETE",getID:function(){return this.SourceWidget+"_"+this.SourceEvent+"_"+this.TargetWidget+"_"+this.TargetEvent;},getSourceWidgetID:function(){return this.SourceWidget;},getSourceEventName:function(){return this.SourceEvent;},getTargetWidgetID:function(){return this.TargetWidget;},getTargetEventName:function(){return this.TargetEvent;},setDirty:function(_748){this._isDirty=_748;},isDirty:function(){return this._isDirty;},setType:function(type){this._type=type;},getType:function(){return this._type;},setSubHandler:function(_749){this._subHandle=_749;},getSubHandler:function(){return this._subHandle;},toString:function(){return this.getID();}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.Wire"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.Wire"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.Wire");}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.WireProvider"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.WireProvider"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.WireProvider");dojo.declare("com.ibm.mashups.iwidget.widget.WireProvider",null,{constructor:function(id){},getWires:function(){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.EventProvider"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.EventProvider"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.EventProvider");dojo.declare("com.ibm.mashups.iwidget.widget.EventProvider",null,{constructor:function(){},getWidgetPublishedEvents:function(){},getWidgetHandledEvents:function(){},getPublicEvent:function(name){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.Properties_API"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.Properties_API"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.Properties_API");dojo.provide("com.ibm.mashups.iwidget.widget.Properties");dojo.declare("com.ibm.mashups.iwidget.widget.Properties",null,{constructor:function(){},getItemValue:function(_74a,_74b){},getAllNames:function(){return null;},getItemLocales:function(_74c){},isReadOnly:function(_74d){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.PropertiesImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.PropertiesImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.PropertiesImpl");dojo.declare("com.ibm.mm.iwidget.widget.PropertiesImpl",com.ibm.mashups.iwidget.widget.Properties,{DELETE_TOKEN:"com.ibm.mm.iwidget.widget.DELETE_TOKEN",TYPE_NEW:"newItem",TYPE_UPDATE:"updatedValue",TYPE_REMOVE:"removedItem",constructor:function(_74e,_74f){this._defaultProperties=_74f;this._items={};if(_74e){this._items=_74e;}this._localizedItems={};this.DEFAULT_LOCALE=ibmConfig[com.ibm.mashups.enabler.services.ConfigConstants.DEFAULT_LOCALE];if(!this.DEFAULT_LOCALE){this.DEFAULT_LOCALE="en";}},_getItemDefaultLocale:function(_750){var _751=null;if(this._items[_750]){if(this._items[_750].defaultLocale){_751=this._items[_750].defaultLocale;}}if(!_751){_751=null;}return _751;},getLocalizedItemValue:function(_752,_753){if(!_752||!_753){return;}if(!(_752 in this._items)&&!this._defaultProperties){return null;}var item=this._items[_752];var _754=null;if(!item.values){return null;}var _755=[];for(var i in item.values){if(Object.prototype.hasOwnProperty.call(item.values,i)){_755.push(i);}}var _756;_756=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(_753,_755);for(var j in item.values){if(_756==com.ibm.mm.enabler.utils.LocaleHelper.normalizeLocale(j)){_754=item.values[j];break;}}if(_754==this.DELETE_TOKEN){return null;}return _754;},getItemValue:function(_757,_758){if(!(_757 in this._items)&&!this._defaultProperties){return null;}if(!(_757 in this._items)){return this._defaultProperties.getItemValue(_757,_758);}var item=this._items[_757];var _759=null;if((typeof _758=="undefined"||_758===null)&&typeof item.value!="undefined"&&item.value!==null){if(item.value==this.DELETE_TOKEN){return null;}return item.value;}if(!item.values){return null;}var _75a=[];for(var i in item.values){if(Object.prototype.hasOwnProperty.call(item.values,i)){_75a.push(i);}}var _75b;if(_758){_75b=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(_758,_75a);if(_75b in item.values){_759=item.values[_75b];}}if(item.defaultLocale&&_759===null){_75b=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(item.defaultLocale,_75a);if(_75b in item.values){_759=item.values[_75b];}}if(this.DEFAULT_LOCALE&&_759===null){_75b=com.ibm.mm.enabler.utils.LocaleHelper.matchLocale(this.DEFAULT_LOCALE,_75a);if(_75b in item.values){_759=item.values[_75b];}}if(_759===null){for(var lang in item.values){if(Object.prototype.hasOwnProperty.call(item.values,lang)){_759=item.values[lang];break;}}}if(_759==this.DELETE_TOKEN){return null;}return _759;},getItemLocales:function(_75c){var _75d=[];if(_75c in this._items&&this._items[_75c].values){for(var _75e in this._items[_75c].values){if(Object.prototype.hasOwnProperty.call(this._items[_75c].values,_75e)){_75d.push(_75e);}}}if(_75d.length===0){return null;}return _75d;},getAllNames:function(){var _75f=[];if(this._defaultProperties){_75f=this._defaultProperties.getAllNames();}var _760={};for(var i=0;i<_75f.length;i++){_760[_75f[i]]=null;}for(var _761 in this._items){if(this._items[_761]&&this._items[_761]._change&&this._items[_761]._change.changeType==this.TYPE_REMOVE){if(_761 in _760){delete _760[_761];}}else{_760[_761]=null;}}var _762=[];for(var _763 in _760){if(Object.prototype.hasOwnProperty.call(_760,_763)){_762.push(_763);}}return _762;},isReadOnly:function(_764){var item=this._items[_764];return (this._defaultProperties&&this_defaultProperties.isReadOnly(_764))||(item&&item.readOnly);}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.Properties"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.Properties"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.Properties");}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.PropertiesProvider"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.PropertiesProvider"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.PropertiesProvider");dojo.declare("com.ibm.mashups.iwidget.widget.PropertiesProvider",null,{constructor:function(){},getIDescriptorItems:function(){},getAttributes:function(){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetDefinition_API"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetDefinition_API"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetDefinition_API");dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetDefinition");dojo.declare("com.ibm.mashups.iwidget.widget.IWidgetDefinition",[com.ibm.mashups.iwidget.widget.EventProvider,com.ibm.mashups.iwidget.widget.PropertiesProvider],{constructor:function(){},getSupportedModes:function(){},toSpecObject:function(){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetDefinitionDefaultImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetDefinitionDefaultImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetDefinitionDefaultImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetDefinitionDefaultImpl",com.ibm.mashups.iwidget.widget.IWidgetDefinition,{namespaces:{"iw":"http://www.ibm.com/xmlns/prod/iWidget"},reservedAttributes:{iScope:"iScope",supportedModes:"supportedModes",id:"id",allowInstanceContent:"allowInstanceContent",lang:"language","xml_lang":"_xml_lang","xmlns_iw":"_xmlns_iw",supportedWindowStates:"supportedWindowStates","xml_base":"_xml_base",sandbox:"sandbox"},constructor:function(_765,_766,_767){this.widgetDef=_765;if(_766){this.xmlStr=_766;}if(_767){this.specObject=_767;this._specObjectToWidgetDef();}},getXmlBase:function(){if(this.widgetDef.xmlBase){return this.widgetDef.xmlBase;}return null;},getAllowInstanceContent:function(){return this.widgetDef.allowInstanceContent;},getResources:function(){if(!this.resources){this.resources=[];}return this.resources;},getIScope:function(){return this.widgetDef.iScope;},getWidgetEvents:function(){return this.widgetDef.widgetEvents;},getMarkupByMode:function(mode){if(this.widgetDef.markup){if(!mode){mode="view";}var temp=this.widgetDef.markup[mode];return temp;}else{return null;}},setMarkupByMode:function(mode,elem){if(this.widgetDef.markup){if(!mode){mode="view";}this.widgetDef.markup[mode]=elem;return this;}return null;},_getManagedItemSetListener:function(_768){if(!_768){return null;}if(_768!=iwConstants.ATTRIBUTES&&_768!=iwConstants.IDESCRIPTOR){return null;}if(this.widgetDef.itemSetsArr){var _769=this.widgetDef.itemSetsArr[_768];if(_769&&_769.onItemSetChanged){return _769.onItemSetChanged;}}return null;},_getManagedItemSetItems:function(_76a,_76b){var _76c={};if(this.widgetDef.itemSetsArr){var _76d=this.widgetDef.itemSetsArr[_76a];if(_76d){for(var _76e in _76d.items){if(Object.prototype.hasOwnProperty.call(_76d.items,_76e)){_76c[_76e]=_76d.items[_76e];}}}}_76b=_76b||null;if(_76b){for(var _76f in _76b){if(Object.prototype.hasOwnProperty.call(_76b,_76f)){var _770=_76b[_76f];if(typeof _770!="undefined"&&_770!==null){var _771={};_771.readOnly=false;_771.value=_770;_771.id=_76f;_76c[_76f]=_771;}}}}return new com.ibm.mm.iwidget.widget.PropertiesImpl(_76c);},getAttributes:function(){if(!this.attributeProperties){this.attributeProperties=this._getManagedItemSetItems(iwConstants.ATTRIBUTES,this.widgetDef.simpleAttributes);}return this.attributeProperties;},getIDescriptorItems:function(){if(!this.idescriptorProperties){this.idescriptorProperties=this._getManagedItemSetItems(iwConstants.IDESCRIPTOR,this.widgetDef.iDescriptor);}return this.idescriptorProperties;},getAllItemSetNames:function(){var _772=[];if(!this.widgetDef.itemSetsArr){return _772;}for(var _773 in this.widgetDef.itemSetsArr){if(Object.prototype.hasOwnProperty.call(this.widgetDef.itemSetsArr,_773)){var _774=this.widgetDef.itemSetsArr[_773];if(typeof (_774)!="undefined"&&_773!=iwConstants.ATTRIBUTES&&_773!=iwConstants.IDESCRIPTOR){_772.push(_774.id);}}}return _772;},getItemSet:function(name){if(name=="attributes"){return this.getAttributes();}var _775=this.widgetDef.itemSetsArr[name]||null;if(!_775){return null;}return _775;},getWidgetId:function(){return this.widgetDef.id;},getWidgetName:function(){return this.widgetDef.id;},getPayloadDefs:function(){return null;},getPayloadDef:function(name){return null;},getPayloadDefNames:function(){var arr=[];return arr;},getSupportedModes:function(){var temp=this.widgetDef.supportedModes;if(!temp){return null;}var arr=temp.split(" ");return arr;},getSupportedWindowStates:function(){var temp=this.widgetDef.supportedWindowStates;if(!temp){return null;}var arr=temp.split(" ");return arr;},getDefaultLanguage:function(){return this.widgetDef.lang;},getMarkup:function(){return this.widgetDef.markup;},_specObjectToWidgetDef:function(){this.widgetDef={};if(null===this.specObject){return;}var temp=this.specObject._id;if(!temp){temp=this.specObject._name;}this.widgetDef.id=null;this.widgetDef.name=null;if(temp){this.widgetDef.id=temp;this.widgetDef.name=temp;}this.widgetDef.allowInstanceContent=false;temp=this.specObject._allowInstanceContent;if(temp&&temp=="true"){this.widgetDef.allowInstanceContent=true;}temp=this.specObject._iScope;this.widgetDef.iScope=null;if(temp){this.widgetDef.iScope=temp;}temp=this.specObject._supportedModes;if(!temp){temp="view";}this.widgetDef.supportedModes=temp;temp=this.specObject._supportedWindowStates;if(!temp){temp="normal";}this.widgetDef.supportedWindowStates=temp;temp=this.specObject._lang;if(!temp){temp=this.specObject._xml_lang;}if(!temp){temp="en";}this.widgetDef.lang=temp;temp=this.specObject._xml_base;if(temp){this.widgetDef.xmlBase=temp;}var _776=iwConstants.iDescriptorItems;var _777={};for(var i in _776){if(Object.prototype.hasOwnProperty.call(_776,i)){var name=_776[i];var _778=this.specObject["_"+name];if(typeof _778=="undefined"){_778=null;}_777[name]=_778;}}this.widgetDef.iDescriptor=_777;var _779={};var _77a={};for(var j in this.specObject){if(Object.prototype.hasOwnProperty.call(this.specObject,j)){if(0!==j.indexOf("_")){continue;}var attr=j;attr=attr.substr(1);if(attr.indexOf("on")!==0&&!iwConstants.iDescriptorItems[attr]&&!this.reservedAttributes[attr]){_779[attr]=this.specObject[j];}else{if(attr.indexOf("on")===0){_77a[attr]=this.specObject[j];}}}}this.widgetDef.simpleAttributes=_779;this.widgetDef.widgetEvents=_77a;this.widgetDef.markup=this._extractMarkupFromSpecObject();var _77b=this._extractItemSetsFromSpecObject(this.widgetDef);if(null!==_77b){this.widgetDef.itemSetsArr=_77b;}this.widgetDef.publicEvents=this._extractEventsFromSpecObject();this.widgetDef.resources=this._extractResourcesFromSpecObject();this.widgetDef.eventDescriptions=this._extractEventDescFromSpecObject();},_extractMarkupFromSpecObject:function(){var _77c=this.specObject.contents;var _77d={};for(var mode in _77c){if(Object.prototype.hasOwnProperty.call(_77c,mode)){if(_77c[mode]){_77d[mode]={};if(_77c[mode]._uri){_77d[mode].uri=_77c[mode]._uri;}if(_77c[mode].value){_77d[mode].content=_77c[mode].value;}}}}return _77d;},_extractItemSetsFromSpecObject:function(_77e){var _77f=this.specObject.itemSets;if(_77f){var _780={};var _781={};for(var i in _77f){if(Object.prototype.hasOwnProperty.call(_77f,i)){var _782=_77f[i];var id=i;var _783=_782._onItemSetChanged;var temp=_782._private;var _784=true;if(temp&&temp=="false"){_784=false;}var _785=_782._alias?_782._alias:null;var _786=_782._description;var _787={id:id,onItemSetChanged:_783,isPrivate:_784};if(_785){_787.alias=_785;}_787.items={};var _788=_782.items;for(var j in _788){if(Object.prototype.hasOwnProperty.call(_788,j)){var item=_788[j];var _789=false;var _78a=item._readOnly;if(_78a&&_78a=="true"){_789=true;}var id2=item._id;var _78b=item._alias?item._alias:null;var _78c=item._value;var lang=item._lang;if(!lang){lang=item._xml_lang;}var _78d={};_78d.id=id2;if(_78b){_78d.alias=_78b;}_78d.readOnly=_789;if(lang){_78d.defaultLocale=lang;}if(typeof _78c!="undefined"&&_78c!==null&&!lang){_78d.value=_78c;}if(typeof _78c!="undefined"&&_78c!==null&&lang){_78d.values={};_78d.values[lang]=_78c;}var _78e=item.alts;for(var v in _78e){if(Object.prototype.hasOwnProperty.call(_78e,v)){var _78f=_78e[v];var _790=v;var _791=_78f._value;if(!_78d.values){_78d.values={};}_78d.values[_790]=_791;if(lang&&_790==lang&&_78d.value){delete _78d.value;}}}_787.items[id2]=_78d;}}if(_784===true){_780[id]=_787;}else{_781[id]=_787;}}}_77e.shareableItemSetsArr=_781;return _780;}return null;},_extractEventsFromSpecObject:function(){var _792=this.specObject.events;var _793={};if(_792&&_792.length!==0){for(var j in _792){if(Object.prototype.hasOwnProperty.call(_792,j)){var _794=_792[j];var _795={};for(var i in _794){if(Object.prototype.hasOwnProperty.call(_794,i)){var name=i;if(0===i.indexOf("_")){name=name.substr(1);}var _796=_794[i];if(name=="eventDescName"){name="description";}if(name=="handled"){name="isHandled";}if(name=="published"){name="isPublished";}if(_796){_795[name]=_796;}}}_793[_795.id]=_795;}}}return _793;},_extractResourcesFromSpecObject:function(){var _797=[];var _798=this.specObject.resources;var j=0;if(_798&&_798.length!==0){for(var i in _798){if(Object.prototype.hasOwnProperty.call(_798,i)){var node=_798[i];var _799={};var id=node._id;if(!id){id=node._globalid;}_799[iwConstants.RESOURCE.id]=id?id:null;var src=node._src;if(!src){src=node._uri;}_799[iwConstants.RESOURCE.src]=src;_799[iwConstants.RESOURCE.version]=node._version?node._version:null;_799[iwConstants.RESOURCE.callback]=node._callback?node._callback:null;_799[iwConstants.RESOURCE.mimeType]=node._mimeType?node._mimeType:null;_799[iwConstants.RESOURCE.blockInit]=node._blockInit?node._blockInit:null;_799[iwConstants.RESOURCE.globalid]=node._globalid?node._globalid:null;_799[iwConstants.RESOURCE.skipLoad]=node._skipLoad?node._skipLoad:null;_797[j]=_799;j++;}}}return _797;},_extractPayloadDefsFromSpecObject:function(){var _79a={};var _79b=this.specObject.payloadDefs;for(var i in _79b){if(Object.prototype.hasOwnProperty.call(_79b,i)){var _79c=payloadDef[i];}}},_extractEventDescFromSpecObject:function(){var _79d={};var _79e=this.specObject.eventDescriptions;if(_79e&&_79e.length!==0){for(var i in _79e){if(Object.prototype.hasOwnProperty.call(_79e,i)){var node=_79e[i];var _79f={};var id=i;_79f.id=id;_79f.payloadType=node._payloadType;_79f.description=node._description;_79f.title=node._title;_79f.descriptionURI=node._descriptionURI?node._descriptionURI:null;var lang=node._lang;if(!lang){lang=node._xml_lang;}if(lang){_79f.lang=lang;}var _7a0=node.alts;for(var j in _7a0){if(Object.prototype.hasOwnProperty.call(_7a0,j)){var _7a1=_7a0[j];var temp={};temp.description=_7a1._description;temp.title=_7a1._title;temp.descriptionURI=_7a1._descriptionURI?aNode_descriptionURI:null;if(!_79f.descriptions){_79f.descriptions={};}_79f.descriptions[j]=temp;}}_79d[id]=_79f;}}}return _79d;},toSpecObject:function(){if(this.specObject){return this.specObject;}var _7a2={};return _7a2;}});com.ibm.mm.iwidget.widget.IWidgetDefinitionImpl=com.ibm.mm.iwidget.widget.IWidgetDefinitionDefaultImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.widget.IWidgetDefinitionExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetDefinition"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetDefinition"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetDefinition");}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiableProperties_API"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiableProperties_API"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.ModifiableProperties_API");dojo.provide("com.ibm.mashups.iwidget.widget.ModifiableProperties");dojo.declare("com.ibm.mashups.iwidget.widget.ModifiableProperties",[com.ibm.mashups.iwidget.widget.Properties],{constructor:function(){},setItemValue:function(_7a3,_7a4,_7a5,_7a6){},removeItem:function(_7a7){},removeItemValue:function(_7a8,_7a9){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl");dojo.declare("com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl",[com.ibm.mashups.iwidget.widget.ModifiableProperties,com.ibm.mm.iwidget.widget.PropertiesImpl],{constructor:function(_7aa,_7ab){this._dirty=false;},_buildChange:function(item,_7ac,_7ad,_7ae,_7af){var _7b0=item._dirty;if(!_7b0){item._dirty=true;}var _7b1=item._change?item._change:{};_7b1.id=_7ac;if(_7af){if(_7b0&&_7b1.changeType&&_7b1.changeType==this.TYPE_NEW){item._dirty=false;delete item._change;return;}else{if(_7b0){_7b1.changeType=this.TYPE_REMOVE;return;}}item._change.changeType=this.TYPE_REMOVE;item._change.oldVal=_7ad;return;}if(_7b0&&_7b1.changeType){if(_7b1.changeType==this.TYPE_NEW){_7b1.newVal=_7ae;}else{_7b1.changeType=this.TYPE_UPDATE;_7b1.newVal=_7ae;}}else{if(_7ad){_7b1.oldVal=_7ad;}if(_7ae){_7b1.newVal=_7ae;}if(_7ad){_7b1.changeType=this.TYPE_UPDATE;}else{_7b1.changeType=this.TYPE_NEW;}}item._change=_7b1;return;},setItemValue:function(_7b2,_7b3,_7b4,_7b5){if(!_7b2||!_7b3){return null;}if(_7b2 in this._items){if(this._defaultProperties&&this._defaultProperties.isReadOnly(_7b2)){return null;}}var _7b6={};var _7b7={};var _7b8;if(!_7b5||(_7b5&&_7b5=="")){if(_7b2 in this._items){_7b6={};_7b7={};if(this._items[_7b2].values){_7b6=dojo.clone(this._items[_7b2].values);if(this._items[_7b2].value){_7b6[""]=this._items[_7b2].value;}_7b7=dojo.clone(this._items[_7b2].values);_7b7[""]=_7b3;}else{if(this._items[_7b2].value){_7b6[""]=this._items[_7b2].value;}_7b7[""]=_7b3;}this._items[_7b2].value=_7b3;this._buildChange(this._items[_7b2],_7b2,_7b6,_7b7);}else{var _7b9={};_7b9.id=_7b2;_7b9.value=_7b3;_7b8=!!_7b4;_7b9.readOnly=_7b8;this._items[_7b2]=_7b9;_7b7={};_7b7[""]=_7b3;this._items[_7b2]=this._items[_7b2]?this._items[_7b2]:{};this._buildChange(this._items[_7b2],_7b2,null,_7b7);}if(this._items[_7b2]._dirty){this._dirty=true;}return this;}var _7ba=_7b5.replace(/-/g,"_");if(_7b2 in this._items){_7b6={};_7b7={};if(this._items[_7b2].values){_7b6=dojo.clone(this._items[_7b2].values);}this._items[_7b2].values[_7ba]=_7b3;_7b7=dojo.clone(this._items[_7b2].values);if(this._items[_7b2].value){_7b6[""]=this._items[_7b2].value;_7b7[""]=this._items[_7b2].value;}this._items[_7b2].readOnly=_7b4;this._buildChange(this._items[_7b2],_7b2,_7b6,_7b3);if(this._items[_7b2]._dirty){this._dirty=true;}return this;}var item={};item.values={};item.values[_7ba]=_7b3;item.id=_7b2;_7b8=!!_7b4;item.readOnly=_7b8;this._items[_7b2]=item;_7b7=dojo.clone(item.values);this._buildChange(this._items[_7b2],_7b2,null,_7b7);if(this._items[_7b2]._dirty){this._dirty=true;}return this;},removeItem:function(_7bb){if(this._defaultProperties&&this._defaultProperties.isReadOnly(_7bb)){throw "The specified item ["+_7bb+"] is readOnly!";}var _7bc={};var _7bd=false;if(_7bb in this._items){if(this._items[_7bb]._dirty){this._items[_7bb].value=this.DELETE_TOKEN;this._items[_7bb].values=this.DELETE_TOKEN;_7bc=this._items[_7bb]._change?this._items[_7bb]._change:{};if(_7bc.changeType==this.TYPE_NEW){delete this._items[_7bb];return this;}else{_7bc.changeType=this.TYPE_REMOVE;}}else{var _7be={};if(this._items[_7bb].values){_7be=dojo.clone(this._items[_7bb].values);}if(this._items[_7bb].value){_7be[""]=this._items[_7bb].value;}this._items[_7bb].value=this.DELETE_TOKEN;this._items[_7bb].values=this.DELETE_TOKEN;_7bc={};_7bc.changeType=this.TYPE_REMOVE;_7bc.itemName=_7bb;_7bc.oldVal=_7be;this._items[_7bb]._change=_7bc;this._items[_7bb]._dirty=true;}_7bd=true;}if(_7bd){this._dirty=true;return this;}else{return null;}},removeItemValue:function(_7bf,_7c0){if(!_7c0){_7c0="";}if(this._defaultProperties&&this._defaultProperties.isReadOnly(_7bf)){throw "The specified item ["+_7bf+"] is readOnly!";}var _7c1=_7c0.replace(/-/g,"_");var _7c2=false;var _7c3={};if(_7bf in this._items){if(this._items[_7bf]._dirty){_7c3=this._items[_7bf]._change?this._items[_7bf]._change:{};if(_7c3.changeType==this.TYPE_REMOVE){return null;}else{if(_7c3.changeType==this.TYPE_NEW){if(_7c1==""&&this._items[_7bf].value&&this._items[_7bf].value!=this.DELETE_TOKEN){delete this._items[_7bf].value;if(this._items[_7bf]._change.newVal[""]){delete this._items[_7bf]._change.newVal[""];}_7c2=true;}if(_7c1!=""){if(this._items[_7bf].values[_7c1]){delete this._items[_7bf].values[_7c1];if(this._items[_7bf]._change.newVal[_7c1]){delete this._items[_7bf]._change.newVal[_7c1];}_7c2=true;}}if(this._isEmpty(this._items[_7bf]._change.newVal)){delete this._items[_7bf]._dirty;delete this._items[_7bf]._change;}}else{if(_7c1==""&&this._items[_7bf].value&&this._items[_7bf].value!=this.DELETE_TOKEN){delete this._items[_7bf].value;if(this._items[_7bf]._change.newVal[""]){delete this._items[_7bf]._change.newVal[""];}_7c2=true;}if(this._items[_7bf].values[_7c1]){delete this._items[_7bf].values[_7c1];if(this._items[_7bf]._change.newVal[_7c1]){delete this._items[_7bf]._change.newVal[_7c1];}_7c2=true;}}}}else{var _7c4={};var _7c5={};if(_7c1==""&&this._items[_7bf].value){_7c3={};_7c3.id=_7bf;_7c4={};_7c5={};if(this._items[_7bf].values){_7c3.changeType=this.TYPE_UPDATE;_7c4=dojo.clone(this._items[_7bf].values);_7c4[""]=this._items[_7bf][""];_7c3.oldVal=_7c4;_7c3.newVal=dojo.clone(this._items[_7bf].values);delete this._items[_7bf].value;}else{_7c3.changeType=this.TYPE_REMOVE;_7c4[""]=this._items[_7bf][""];_7c3.oldVal=_7c4;delete this._items[_7bf].value;}this._items[_7bf]._change=_7c3;this._items[_7bf]._dirty=true;_7c2=true;}if(_7c1 in this._items[_7bf].values){_7c3={};_7c3.id=_7bf;_7c4={};_7c5={};if(this._items[_7bf].value){_7c3.changeType=this.TYPE_UPDATE;_7c4=dojo.clone(this._items[_7bf].values);_7c4[""]=this._items[_7bf][""];_7c3.oldVal=_7c4;_7c3.newVal=dojo.clone(this._items[_7bf].values);_7c3.newVal[""]=this._items[_7bf].value;delete _7c3.newVal[_7c1];delete this._items[_7bf].value;}else{_7c4=dojo.clone(this._items[_7bf].values);delete this._items[_7bf].values[_7c1];if(this._isEmpty(this._items[_7bf].values)){_7c3.changeType=this.TYPE_REMOVE;}else{_7c3.changeType=this.TYPE_UPDATE;_7c3.newVal=dojo.clone(this._items[_7bf].values);}_7c3.oldVal=_7c4;}this._items[_7bf]._change=_7c3;this._items[_7bf]._dirty=true;_7c2=true;}}}if(_7c2){this._dirty=true;return this;}else{return null;}},_isDirty:function(){return this._dirty;},_setDirty:function(_7c6){this._dirty=_7c6;},_isItemDirty:function(_7c7){if(!_7c7){return false;}var _7c8=false;if(this._items[_7c7]){_7c8=this._items[_7c7]._dirty;}return _7c8;},_setItemDirty:function(_7c9,_7ca){if(!_7c9){return;}if(this._items[_7c9]){this._items[_7c9]._dirty=_7ca;if(typeof _7ca!="undefined"&&!_7ca){delete this._items[_7c9]._dirty;delete this._items[_7c9]._change;}if(this._items[_7c9].values&&this._items[_7c9].values==this.DELETE_TOKEN){delete this._items[_7c9].values;}if(this._items[_7c9].value&&this._items[_7c9].value==this.DELETE_TOKEN){delete this._items[_7c9].value;}if(!this._items[_7c9].value&&!this._items[_7c9].values){delete this._items[_7c9];}}},_getInternalItemValue:function(_7cb){if(this._items[_7cb]){return this._items[_7cb];}return null;},_isEmpty:function(obj){for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){return false;}}return true;},_getRequiredValue:function(obj,_7cc){if(!obj){return null;}if(dojo.isString(obj)){return obj;}if(_7cc){if(obj[_7cc]){return obj[_7cc];}else{return null;}}var _7cd=null;var j=0;for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){if(i==""){_7cd=obj[i];}j++;}}if(_7cd&&j==1){return _7cd;}return obj;},_updateProperties:function(_7ce){var _7cf=dojo.mixin(this._items,_7ce);this._items=_7cf;this._dirty=true;},toJson:function(){return this._items;}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiableProperties"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiableProperties"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.ModifiableProperties");}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiablePropertiesProvider"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiablePropertiesProvider"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.ModifiablePropertiesProvider");dojo.declare("com.ibm.mashups.iwidget.widget.ModifiablePropertiesProvider",null,{constructor:function(){},getIDescriptorItems:function(){},getAttributes:function(){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiableWireProvider"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.ModifiableWireProvider"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.ModifiableWireProvider");dojo.declare("com.ibm.mashups.iwidget.widget.ModifiableWireProvider",com.ibm.mashups.iwidget.widget.WireProvider,{constructor:function(id){},addWire:function(_7d0,_7d1,_7d2){},removeWire:function(_7d3,_7d4,_7d5){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetInstance_API"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetInstance_API"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetInstance_API");dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetInstance");dojo.declare("com.ibm.mashups.iwidget.widget.IWidgetInstance",[com.ibm.mashups.iwidget.widget.ModifiablePropertiesProvider,com.ibm.mashups.iwidget.widget.ModifiableWireProvider],{constructor:function(){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetInstanceDefaultImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetInstanceDefaultImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetInstanceDefaultImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetInstanceDefaultImpl",com.ibm.mashups.iwidget.widget.IWidgetInstance,{constructor:function(_7d6,id){this.rootElement=_7d6;this.id=id;this.ns=_7d6.className.substr(0,3);var _7d7=[];var _7d8=this.ns+"Definition";com.ibm.mm.iwidget.Utils.findElementByAttribute("class",_7d8,this.rootElement,_7d7,false);if(_7d7&&_7d7.length>0){var node=_7d7[0];var url=node.getAttribute("href");if(typeof (url)!="undefined"&&url!==null){this.widgetXMLUrl=url;}}this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},getDefaultViewContent:function(){if(this.defaultViewContent){return this.defaultViewContent;}var _7d9=this.ns+"Content";var node=null;var _7da=dojo.query("span."+_7d9,this.rootElement);if(_7da){node=_7da[0];}if(node){this.defaultViewContent=node.innerHTML;return this.defaultViewContent;}else{return null;}},getWidgetEvents:function(){if(this.widgetEvents){return this.widgetEvents;}var _7db={};var _7dc=this.rootElement.attributes;for(var i=0;i<_7dc.length;i++){var _7dd=_7dc[i];if(_7dd.name!==null&&_7dd.name.indexOf("on")===0){var _7de=this.rootElement.getAttribute(_7dd.name);if(typeof _7de!="undefined"&&_7de!==null){_7db[_7dd.name]=_7de;if(this.bIsLoggable){this.LOGGER.trace("iWidgetInstance.getWidgetEvents","eventName:"+_7dd.name+" handler:"+_7db[_7dd.name]);}}}}this.widgetEvents=_7db;return this.widgetEvents;},_addWire:function(wire){},_removeWire:function(id){},addWire:function(_7df,_7e0,_7e1){},removeWire:function(_7e2,_7e3,_7e4){},_getPublicEvents:function(){return null;},getWires:function(){return [];},getWireModel:function(){return null;},getAttributes:function(){if(!this.attributeProperties){var _7e5=this.getItemSets()[iwConstants.ATTRIBUTES];var _7e6={};if(_7e5){for(var _7e7 in _7e5){if(Object.prototype.hasOwnProperty.call(_7e5,_7e7)){_7e6[_7e7]=_7e5[_7e7];}}}this.attributeProperties=new com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl(_7e6);}return this.attributeProperties;},getIDescriptorItems:function(){if(!this.idescriptorProperties){var _7e8=this.getItemSets()[iwConstants.IDESCRIPTOR];var _7e9={};if(_7e8){for(var _7ea in _7e8){if(Object.prototype.hasOwnProperty.call(_7e8,_7ea)){_7e9[_7ea]=_7e8[_7ea];}}}this.idescriptorProperties=new com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl(_7e9);}return this.idescriptorProperties;},_getItemSets:function(){if(this.itemSets){return this.itemSets;}this.loadItemSets();return this.itemSets;},getItemSets:function(){return this._getItemSets();},getItemSet:function(_7eb){if(!_7eb){return null;}var _7ec=this._getItemSets();if(_7ec&&_7ec[_7eb]){return _7ec[_7eb];}},loadItemSets:function(){this.itemSets=this._loadItemSetsOptimized(this.rootElement,this.ns);},_loadItemSetsOptimized:function(_7ed,ns){var _7ee={};if(_7ed.childNodes.length){dojo.query("."+ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwItem,_7ed).forEach(function(item){var _7ef=dojo.attr(item.parentNode,"title");if(_7ef){if(!_7ee[_7ef]){_7ee[_7ef]={};}var _7f0=this._loadItemOptimized(item,ns);_7ee[_7ef][_7f0.id]=_7f0;}},this);}return _7ee;},_loadItemOptimized:function(elem,ns){var css=com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE;var item={id:com.ibm.mm.iwidget.Utils.stripHashPrefix(dojo.attr(elem,"href")),readOnly:dojo.hasClass(elem,ns+css.iwReadOnly)};var lang=dojo.attr(elem,"lang");if(lang){item.defaultLocale=lang;}var _7f1;var _7f2=dojo.query("."+ns+css.iwValue,elem);if(_7f2.length){item.values={};_7f2.forEach(function(_7f3){var _7f4=dojo.attr(_7f3,"lang")||lang;item.values[_7f4]=com.ibm.mm.enabler.utils.Dom.textContent(_7f3);});}else{_7f1=com.ibm.mm.enabler.utils.Dom.textContent(elem);if(dojo.isString(_7f1)){item.value=dojo.string.trim(_7f1);}}return item;},_invalidateItemSets:function(name){if(!name){this.itemSets={};}else{this.itemSets[name]={};}},_getInstanceMarkup:function(){var node=dojo.clone(this.rootElement);dojo.query("."+this.ns+"Content",node).forEach(function(_7f5){com.ibm.mm.enabler.utils.Dom.destroyNode(_7f5);});dojo.query("."+this.ns+"loading",node).forEach(function(_7f6){com.ibm.mm.enabler.utils.Dom.destroyNode(_7f6);});var _7f7=document.createElement("div");_7f7.appendChild(node);var html=_7f7.innerHTML;return html;}});com.ibm.mm.iwidget.widget.IWidgetInstanceImpl=com.ibm.mm.iwidget.widget.IWidgetInstanceDefaultImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.widget.IWidgetInstanceExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetInstance"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetInstance"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetInstance");}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetWrapper_API"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetWrapper_API"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetWrapper_API");dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetWrapper");dojo.declare("com.ibm.mashups.iwidget.widget.IWidgetWrapper",[com.ibm.mashups.iwidget.widget.WireProvider,com.ibm.mashups.iwidget.widget.EventProvider],{constructor:function(){},getIWidgetDefinition:function(){},setIWidgetDefinition:function(_7f8){},getIWidgetInstance:function(){},getMarkup:function(){},isLoaded:function(){},isStandalone:function(){},doRender:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.Filter"]){dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.Filter"]=true;dojo.provide("com.ibm.mm.enabler.aggregation.javascript.Filter");function com_ibm_enabler_aggregation_javascript_globalEvalNonIE(_7f9){eval.call(self,_7f9);};dojo.declare("com.ibm.mm.enabler.aggregation.javascript.Filter",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},doFilter:function(_7fa){},evalGlobal:function(_7fb){if(window.execScript){window.execScript(this._stripHTMLComments(_7fb),"JavaScript");}else{com_ibm_enabler_aggregation_javascript_globalEvalNonIE(_7fb);}},_stripHTMLComments:function(str){if(this.bIsLoggable){this.LOGGER.entering("com.ibm.mm.enabler.aggregation.javascript.Filter._stripHTMLComments",[str]);}var _7fc=str;_7fc=_7fc.replace(/<!--[^(-->)]+-->/g,"");if(this.bIsLoggable){this.LOGGER.exiting("com.ibm.mm.enabler.aggregation.javascript.Filter._stripHTMLComments",[_7fc]);}return _7fc;},prepareDocumentWrite:function(_7fd){if(this.bIsLoggable){this.LOGGER.entering("com.ibm.mm.enabler.aggregation.javascript.Filter.prepareDocumentWrite");}var me=this;document.write=function(){me._documentWrite(_7fd,document.write.arguments);};document.writeln=function(str){me._documentWrite(_7fd,document.writeln.arguments);};if(this.bIsLoggable){this.LOGGER.exiting("com.ibm.mm.enabler.aggregation.javascript.Filter.prepareDocumentWrite");}},_documentWrite:function(_7fe,args){for(var i=0,l=args.length;i<l;i++){_7fe.content+=args[i];}},applyDocumentWrite:function(_7ff,_800){if(this.bIsLoggable){this.LOGGER.entering("com.ibm.mm.enabler.aggregation.javascript.Filter.applyDocumentWrite",[_7ff,_800.content]);}var cont=_800.content||null;if(cont!==null&&cont.length>0){var i=0;if(dojo.isIE){cont="<br>"+cont;i++;}var div=dojo.create("div",{innerHTML:cont});var _801=dojo.isIE||dojo.isWebKit||dojo.isOpera;var _802=div.childNodes||null;if(_802!==null&&_802.length>0){var pred=_7ff;var l;var _803=[];while(i<(l=_802.length)){var node=_802[l-1];dojo.place(node,pred,"before");if(_801&&node.tagName&&node.tagName.toLowerCase()=="script"){_803.unshift(node);}pred=node;}if(_801){dojo.forEach(_803,function(scr){com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER.handle(scr);});}}dojo.destroy(div);}if(this.bIsLoggable){this.LOGGER.exiting("com.ibm.mm.enabler.aggregation.javascript.Filter.applyDocumentWrite");}}});}if(!dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter"]){dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter"]=true;dojo.provide("com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter");dojo.declare("com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter",com.ibm.mm.enabler.aggregation.javascript.Filter,{doFilter:function(_804){var url=this._getScriptUrl(_804);var _805=false;if(url){var _806=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PROXY_URL);_806=_806||null;if(_806!==null){_806+="/";url=this._rewriteURL(url,_806);}var _807={content:""};this.prepareDocumentWrite(_807);this._loadExternalScript(url);this.applyDocumentWrite(_804,_807);_805=true;}return _805;},_getScriptUrl:function(_808){var url=null;if(_808.getAttribute){url=_808.getAttribute("src");}else{var _809=_808.toLowerCase().indexOf("<script");var end=_808.toLowerCase().indexOf(">");var _80a=_808.substring(_809,end);var _80b=_80a.toLowerCase().indexOf("src");if(_80b!=-1){var _80c=_80a.indexOf("'",_80b);var _80d=_80a.indexOf("\"",_80b);var _80e="\"";var _80f=_80d;if(_80d==-1||(_80c!=-1&&_80c<_80d)){_80e="'";_80f=_80c;}var _810=_80a.indexOf(_80e,_80f+1);url=_80a.substring(_80f+1,_810);}}return url;},loadExternalScript:function(url){var _811=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PROXY_URL);_811=_811||null;if(_811!==null){_811+="/";url=this._rewriteURL(url,_811);}this._loadExternalScript(url);},_loadExternalScript:function(url){var me=this;dojo.xhrGet({url:url,load:function(data,_812){if(this.bIsLoggable){this.LOGGER.trace("com.ibm.mm.enabler.aggregation.javascript.Filter._loadExternalScript","Retrieved JS file: ${0}",[data]);}me.evalGlobal(data);},sync:true,handleAs:"text"});},_rewriteURL:function(_813,_814){var _815=_814;var host=window.location.host;var _816=window.location.protocol;if(_813.indexOf("://")<0||_813.indexOf(_816)===0&&_813.indexOf(host)==_816.length+2){return _813;}if(_813.indexOf("https")===0){_815+="https/";}else{_815+="http/";}_815+=_813.substr(_813.indexOf("://")+3);return _815;}});}if(!dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.FilterChain"]){dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.FilterChain"]=true;dojo.provide("com.ibm.mm.enabler.aggregation.javascript.FilterChain");dojo.declare("com.ibm.mm.enabler.aggregation.javascript.FilterChain",null,{constructor:function(){this._filters=[];},addFilter:function(_817){if(!this._filters){this._filters=[];}this._filters.push(_817);},applyFilters:function(_818){var _819=false;for(var i=0,l=this._filters.length;i<l&&!_819;i++){_819=this._filters[i].doFilter(_818);}return _819;}});}if(!dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter"]){dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter"]=true;dojo.provide("com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter");dojo.declare("com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter",com.ibm.mm.enabler.aggregation.javascript.Filter,{doFilter:function(_81a){var _81b=false,_81c="";if(!dojo.isString(_81a)){_81c=_81a.innerHTML;}else{var _81d=_81a;var _81e=_81d.indexOf(">");var _81f=_81d.lastIndexOf("<");_81c=_81d.substring(_81e+1,_81f);}if(this.bIsLoggable){this.LOGGER.trace("com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter.doFilter","Stripped HTML tags out: "+_81c);}if(_81c){var _820={content:""};this.prepareDocumentWrite(_820);this.evalGlobal(_81c);_81b=true;this.applyDocumentWrite(_81a,_820);}return _81b;}});}if(!dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler"]){dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler"]=true;dojo.provide("com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler");dojo.declare("com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler",null,{constructor:function(){this.filterChain=new com.ibm.mm.enabler.aggregation.javascript.FilterChain();this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},handle:function(_821){if(this.bIsLoggable){this.LOGGER.entering("WidgetJavascriptHandler.handle",[_821]);}var val=this.filterChain.applyFilters(_821);if(this.bIsLoggable){this.LOGGER.exiting("WidgetJavascriptHandler.handle");}}});}if(!dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript"]){dojo._hasResource["com.ibm.mm.enabler.aggregation.javascript"]=true;dojo.provide("com.ibm.mm.enabler.aggregation.javascript");com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER=new com.ibm.mm.enabler.aggregation.javascript.WidgetJavascriptHandler();com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER.filterChain.addFilter(new com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter());com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER.filterChain.addFilter(new com.ibm.mm.enabler.aggregation.javascript.InlineScriptFilter());}if(!dojo._hasResource["com.ibm.mm.iwidget.manageditemset.PersistentAttributes"]){dojo._hasResource["com.ibm.mm.iwidget.manageditemset.PersistentAttributes"]=true;dojo.provide("com.ibm.mm.iwidget.manageditemset.PersistentAttributes");dojo.declare("com.ibm.mm.iwidget.manageditemset.InternalPersistentAttributesToPreferenceModelAdapter",com.ibm.mashups.iwidget.itemset.ManagedItemSet,{constructor:function(_822,_823,_824){if(_823){this.serverless=true;}else{this.serverless=false;}this.modes=iwConstants.mode;this.widget=_822;this.widgetInstance=this.widget.getIWidgetInstance();this.instanceAttributes=this.widgetInstance.getAttributes();this.defAttributes=this.widget.widgetDef.getAttributes();this.parent=_824;this.mode=this._getMode(null);},setItemValue:function(_825,_826,_827){if(!_825){return null;}if(!_826){return null;}if(this.isReadOnly(_825)){return null;}if(this.serverless){if(this.mode==this.modes.EDIT){this.instanceAttributes.setItemValue(_825,_826);if(this.parent){return this.parent;}}}return null;},getItemValue:function(_828,_829){if(!_828){return null;}var _82a;if(this.serverless){if(typeof _829==="undefined"){_829=true;}if(this.mode==this.modes.CONFIG){_82a=this.defAttributes.getItemValue(_828);if(typeof _82a==="undefined"){_82a=null;}return _82a;}if(this.mode==this.modes.EDIT&&!_829){_82a=this.instanceAttributes.getItemValue(_828);if(typeof _82a==="undefined"){_82a=null;}return _82a;}if(_829){_82a=this.instanceAttributes.getItemValue(_828);if(!_82a){_82a=this.defAttributes.getItemValue(_828);}if(typeof _82a==="undefined"){_82a=null;}return _82a;}}return null;},getAllNames:function(_82b){if(this.serverless){if(typeof _82b==="undefined"){_82b=true;}var _82c;if(this.mode==this.modes.CONFIG){_82c=this.defAttributes.getAllNames();if(_82c&&_82c.length&&_82c.length===0){return null;}return _82c;}if(this.mode==this.modes.EDIT&&!_82b){_82c=this.instanceAttributes.getAllNames();if(_82c&&_82c.length&&_82c.length===0){return null;}return _82c;}var name;if(_82b){_82c=this.instanceAttributes.getAllNames();var obj={};if(_82c&&_82c.length&&_82c.length>0){for(var i in _82c){if(Object.prototype.hasOwnProperty.call(_82c,i)){name=_82c[i];obj[name]=name;}}}_82c=this.defAttributes.getAllNames();if(_82c&&_82c.length&&_82c.length>0){for(var j in _82c){if(Object.prototype.hasOwnProperty.call(_82c,j)){name=_82c[j];obj[name]=name;}}}return this._getNamesArray(obj);}}return null;},removeItem:function(_82d){if(!_82d){return null;}if(this.isReadOnly(_82d)){return null;}if(this.serverless){if(this.mode==this.modes.EDIT){this.instanceAttributes.removeItem(_82d);if(this.parent){return this.parent;}}}return null;},isReadOnly:function(_82e,_82f){if(!_82e){return false;}if(this.serverless){if(typeof _82f==="undefined"){_82f=true;}if(this.mode==this.modes.CONFIG){return this.defAttributes.isReadOnly(_82e);}if(this.mode==this.modes.EDIT&&_82f){var _830=this.defAttributes.isReadOnly(_82e);if(!_830){_830=this.instanceAttributes.isReadOnly(_82e);}return _830;}if(this.mode==this.modes.EDIT){return this.instanceAttributes.isReadOnly(_82e);}}return false;},commit:function(_831){if(this.serverless){this._saveMicroformat();}else{return null;}if(_831){_831(iwConstants.ATTRIBUTES,true);}return (this);},_getNamesArray:function(_832){var i=0;var _833=[];var name;for(name in _832){if(Object.prototype.hasOwnProperty.call(_832,name)){_833.push(name);i++;}}if(i===0){return null;}return _833;},_saveMicroformat:function(){this.widget.commit();var _834={};_834.wid=this.widget.id;this.widget.eventSvr._publishEvent(iwConstants.EVENTS.onAttributeSaved,_834,this.widget.hubId);},_getMode:function(_835){var mode=this.modes.EDIT;if(_835){mode=_835;}else{mode=this.widget.currentMode;}if(mode==this.modes.VIEW){mode=this.modes.EDIT;}return mode;},addListener:function(fn){var _836=this.widget._registerListener(iwConstants.ATTRIBUTES,fn);return _836;},removeListener:function(_837){return this.widget._removeListener(iwConstants.ATTRIBUTES,_837);}});dojo.declare("com.ibm.mm.iwidget.manageditemset.PersistentAttributes",com.ibm.mashups.iwidget.itemset.ManagedItemSet,{constructor:function(_838,_839){this._internalPersistentAttributesToPreferenceModelAdapter=new com.ibm.mm.iwidget.manageditemset.InternalPersistentAttributesToPreferenceModelAdapter(_838,_839,this);},setItemValue:function(_83a,_83b){return this._internal().setItemValue(_83a,_83b,true);},getItemValue:function(_83c){return this._internal().getItemValue(_83c,true);},getAllNames:function(){return this._internal().getAllNames(true);},removeItem:function(_83d){return this._internal().removeItem(_83d);},isReadOnly:function(_83e){return this._internal().isReadOnly(_83e,true);},save:function(_83f){return this.commit(_83f);},commit:function(_840){return this._internal().commit(_840);},_internal:function(){return this._internalPersistentAttributesToPreferenceModelAdapter;},addListener:function(fn){return this._internal().addListener(fn);},removeListener:function(_841){return this._internal().removeListener(_841);}});}if(!dojo._hasResource["com.ibm.mm.iwidget.itemset.ItemsetDefaultImpl"]){dojo._hasResource["com.ibm.mm.iwidget.itemset.ItemsetDefaultImpl"]=true;dojo.provide("com.ibm.mm.iwidget.itemset.ItemsetDefaultImpl");dojo.declare("com.ibm.mm.iwidget.itemset.ItemSetDefaultImpl",com.ibm.mashups.iwidget.itemset.ItemSet,{constructor:function(_842,_843,name){this.widget=_842;this.name=name;var _844=this.widget.getIWidgetInstance();var _845=null;if(_844){_845=_844.getItemSet(name);}var _846={};if(_843){if(_843){for(var _847 in _843.items){if(Object.prototype.hasOwnProperty.call(_843.items,_847)){_846[_847]=dojo.clone(_843.items[_847]);}}}this.properties=new com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl(_846);}if(!this.properties){this.properties=new com.ibm.mm.iwidget.widget.ModifiablePropertiesImpl(_846);}if(_845){for(var _848 in _845){if(Object.prototype.hasOwnProperty.call(_845,_848)){var _849=_845[_848];if(_849.values){for(var j in _849.values){if(Object.prototype.hasOwnProperty.call(_849.values,j)){this.properties.setItemValue(_848,_849.values[j],false,j);}}}if(_849.value){this.properties.setItemValue(_848,_849.value);}}}}this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},_getResourceBundle:function(){if(!this.iwMessages){this.iwMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwMessages");}return this.iwMessages;},_logDeprecated:function(_84a,fn1,fn2){this._getResourceBundle();var _84b=dojo.string.substitute(this.iwMessages.W_DEPRECATE_2,[fn1,fn2]);this.LOGGER.warning(_84a,_84b);},getLocalesWithValues:function(_84c){return this.properties.getItemLocales(_84c);},setLocalizedItemValue:function(_84d,_84e,_84f){if(!_84d||!_84f){return null;}if(!(typeof _84e!="undefined"&&_84e!==null)){return null;}rc=this.properties.setItemValue(_84d,_84e,false,_84f);if(rc){return this;}return null;},setItemValue:function(_850,_851,_852){if(!_850){return null;}if(!(typeof _851!="undefined"&&_851!==null)){return null;}if(!_852){rc=this.properties.setItemValue(_850,_851,false);}else{if(_852&&!dojo.isString(_852)){this._logDeprecated("setItemValue","ItemSet.setItemValue(itemName,value,readOnly)","ItemSet.setItemValue(item,value)");rc=this.properties.setItemValue(_850,_851,false);}else{this._logDeprecated("setItemValue","ItemSet.setItemValue(itemName,value,locale)","ItemSet.setLocalizedItemValue(item,value,locale)");return this.setLocalizedItemValue(_850,_851,_852);}}if(rc){return this;}return null;},getLocalizedItemValue:function(_853,_854){if(!_853||!_854){return null;}return this.properties.getLocalizedItemValue(_853,_854);},getItemValue:function(_855,_856){if(!_855){return null;}if(_856){this._logDeprecated("getItemValue","ItemSet.getItemValue(itemName,locale)","ItemSet.getLocalizedItemValue(item,locale)");return this.getLocalizedItemValue(_855,_856);}return this.properties.getItemValue(_855);},getAllNames:function(){rc=this.properties.getAllNames();if(rc&&rc.length===0){return null;}return rc;},removeItem:function(_857,_858){if(!_857){return null;}if(_858){this._logDeprecated("removeItem","ItemSet.removeItem(itemName,locale)","ItemSet.removeLocalizedItemValue(itemName,locale)");return this.removeLocalizedItemValue(_857,_858);}rc=this.properties.removeItem(_857);if(rc){return this;}return null;},removeLocalizedItemValue:function(_859,_85a){if(!_859||!_85a){return null;}rc=this.properties.removeItemValue(_859,_85a);if(rc){return this;}return null;},removeItemValue:function(_85b){if(!_85b){return null;}rc=this.properties.removeItemValue(_85b);if(rc){return this;}return null;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.DeferredLiveTextUnprocessStubImpl"]){dojo._hasResource["com.ibm.mm.iwidget.DeferredLiveTextUnprocessStubImpl"]=true;dojo.provide("com.ibm.mm.iwidget.DeferredLiveTextUnprocessStubImpl");dojo.declare("com.ibm.mm.iwidget.DeferredLiveTextUnprocessStubImpl",com.ibm.mm.enabler.DeferredImpl,{constructor:function(_85c){this.wrapper=_85c;},start:function(sync){if(sync){return;}var _85d=this.wrapper.getIWidgetInstance();var _85e=dojo.clone(this.wrapper.rootElement);this._unchangeCompleteCallback(_85e);},setIncludeParent:function(_85f){this.includeParent=_85f;},getIncludeParent:function(){return this.includeParent;},_unchangeCompleteCallback:function(node){if(dojo.isFunction(this.getFinishedCallback())){this.finish(node,200);}}});}if(!dojo._hasResource["com.ibm.mm.iwidget.manageditemset.AttributesModeDelegate"]){dojo._hasResource["com.ibm.mm.iwidget.manageditemset.AttributesModeDelegate"]=true;dojo.provide("com.ibm.mm.iwidget.manageditemset.AttributesModeDelegate");dojo.declare("com.ibm.mm.iwidget.manageditemset.AttributesModeDelegate",com.ibm.mashups.iwidget.itemset.ManagedItemSet,{constructor:function(_860,_861){this.persistentAttributesFactoryService=_860;this.wrapper=_861;this.widgetAttributes=[];this._getAttributes();},_getAttributes:function(){var _862=this.wrapper._getCurrentMode();var _863=iwConstants.mode.PERSONALIZE;if(_862==iwConstants.mode.CONFIG||_862==iwConstants.mode.EDIT){_863=_862;}this.widgetAttributes[_863]=this.widgetAttributes[_863]||null;if(this.widgetAttributes[_863]===null){this.widgetAttributes[_863]=this.persistentAttributesFactoryService.createPersistentAttributes(this.wrapper);}return this.widgetAttributes[_863];},setItemValue:function(_864,_865){return this._getAttributes().setItemValue(_864,_865);},getItemValue:function(_866){return this._getAttributes().getItemValue(_866,true);},getAllNames:function(){return this._getAttributes().getAllNames(true);},removeItem:function(_867){return this._getAttributes().removeItem(_867);},isReadOnly:function(_868){return this._getAttributes().isReadOnly(_868,true);},save:function(_869){return this._getAttributes().save(_869);},commit:function(_86a){return this._getAttributes().commit(_86a);},addListener:function(fn){return this._getAttributes().addListener(fn);},removeListener:function(_86b){return this._getAttributes().removeListener(_86b);}});}if(!dojo._hasResource["com.ibm.mm.iwidget.DeferredLoadImpl"]){dojo._hasResource["com.ibm.mm.iwidget.DeferredLoadImpl"]=true;dojo.provide("com.ibm.mm.iwidget.DeferredLoadImpl");dojo.declare("com.ibm.mm.iwidget.DeferredLoadImpl",com.ibm.mm.enabler.DeferredImpl,{constructor:function(uri,id,_86c){this.uri=uri;if(typeof id=="undefined"){id=null;}this.id=id;if(typeof _86c=="undefined"){_86c=null;}this.widgetDef=_86c;},start:function(sync){if(this.widgetDef){this._handleCallback(this.widgetDef,200);return this.widgetDef;}var mode=(sync||typeof (sync)=="undefined")?false:true;var _86d=com.ibm.mashups.services.ServiceManager.getService("widgetLoadService");_86d.getWidgetXML(this.uri,mode,dojo.hitch(this,"_handleLoad"),this.id);if(sync){return this.widgetDef;}return null;},_handleLoad:function(data,_86e,xhr){if(xhr){_86e=xhr.status;}if(_86e!=200){data=null;}this.widgetDef=data;this._handleCallback(data,status);},_handleCallback:function(_86f,_870){this.finish(_86f,_870);}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetWrapperDefaultImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetWrapperDefaultImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetWrapperDefaultImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetWrapperDefaultImpl",com.ibm.mashups.iwidget.widget.IWidgetWrapper,{constructor:function(_871,id){this._internalIbmModes=iwConstants._INTERNALIBMMODES;this.rootElement=_871;this.id=id||dojo.attr(_871,"id");this.hubId=this.id;this.simpleWidgetEvents={};this.loaded=false;this.standalone=null;this.widgetAttributes=null;this.widgetItemSets=null;this.ns=_871.className.substr(0,3);this.windowManager={};this.iwMessages=null;this.eventSvr=com.ibm.mashups.services.ServiceManager.getService("eventService");this._jsHandler=com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER;this.eventHandlers=[];this.publishedEvents={};this.handledEvents={};this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},getID:function(){return this.id;},getIWidgetInstance:function(){if(this.widgetInstance){return this.widgetInstance;}this.widgetInstance=new com.ibm.mm.iwidget.widget.IWidgetInstanceImpl(this.rootElement,this.id);return this.widgetInstance;},setIWidgetDefinition:function(_872){this.widgetDef=_872;},getIWidgetDefinition:function(){if(this.loaded){return new com.ibm.mm.iwidget.DeferredLoadImpl(this.getIWidgetInstance().widgetXMLUrl,this.id,this.widgetDef);}else{return new com.ibm.mm.iwidget.DeferredLoadImpl(this.getIWidgetInstance().widgetXMLUrl,this.id);}},getMarkup:function(){return new com.ibm.mm.iwidget.DeferredLiveTextUnprocessStubImpl(this);},doRender:function(){try{this.prepare();this.execute();}catch(e){this.LOGGER.severe("IWidgetWrapper.doRender","widget: ${0} OnloadingException: ${1}",[this.hubId,e]);}},prepare:function(){var _873="_"+this.id+"_"+"iContext";if(!this.isModal()){dojo.global[_873]=new com.ibm.mm.iwidget.icontext.IContextImpl(this,this.ns);}else{var _874=this._mainframeId;var _875=parent[_874][_873];dojo.global[_873]=_875;}var _876=this.eventSvr._subscribeEvent(this.eventSvr.WIDGETEVENT_PREFIX+this.hubId,this,"handleEvent",null,this.hubId);if(!this._inIframe()){this.eventHandlers.push(_876);}},execute:function(){this._initialize();this._doRender();},_initialize:function(){var lang=this.widgetDef.getDefaultLanguage();if(typeof lang!="undefined"&&lang!==null){this.defaultLanguage=lang;}else{this.defaultLanguage="en";}var _877=this._getInitDefaultMode();if(_877===null){_877=iwConstants.mode_view;}this.currentMode=_877;if(this._handleSaveMode){this._handleSaveMode();}this._initManagedItemSet();},_getResourceBundle:function(){return null;},_logUpdateMarkupError:function(mode){},_getMarkupByMode:function(mode){var _878=this.widgetDef;var elem=_878.getMarkupByMode(mode);if(elem&&elem.uri){var uri=this._rewriteURI(elem.uri);dojo.xhrGet({url:uri,handleAs:"text",sync:true,load:function(_879){if(_879){var _87a={};_87a.content=_879;_878.setMarkupByMode(mode,_87a);}},error:function(data,_87b){this.LOGGER.severe("_getMarkupByMode","error loading content for mode:"+mode,data);delete elem.uri;}});}var _87c=null;if(_878.getMarkupByMode(mode)){_87c=_878.getMarkupByMode(mode).content;}return _87c;},_updateMarkup:function(mode,_87d){var _87e=this._getMarkupByMode(mode);if(mode==iwConstants.mode_view){if(this.widgetDef.getAllowInstanceContent()){var temp=this.getIWidgetInstance().getDefaultViewContent();if(temp&&temp!==null){_87e=temp;}}}if(typeof _87e=="undefined"||_87e===null){this._logUpdateMarkupError(mode);return true;}var _87f=this._prepareMarkup(_87e);_87f=_87f.replace(/^\s+|\s+$/,"");if(_87f.indexOf("<script")===0){_87f="&nbsp;"+_87f;}var _880=document.createElement("DIV");_880.innerHTML=_87f;var _881=_880.getElementsByTagName("script");if(_881!==null){for(var i=0,l=_881.length;i<l;i++){var _882=_881[i];var id=_882.getAttribute("id");if(id===null||id==""){_882.setAttribute("id","_scr#"+i);}}}_87d.innerHTML=_880.innerHTML;com.ibm.mm.enabler.utils.Dom.destroyNode(_880);return true;},_prepareMarkup:function(_883){var _884=_883.replace(/_IWID_/g,"_"+this.id+"_");var _885=_884.replace(/iContext(?=\.|\s|\(|\))/g,"_"+this.id+"_iContext");return _885;},destroy:function(){if(this.loaded&&!this.isModal()){this._handleEventInternal(iwConstants.EVENTS.onUnLoad);}if(!this._inIframe()){var _886=this.getIWidgetInstance().getWireModel();var _887=null;if(_886){_887=_886.getTargets();}if(_887){var _888=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();for(var i in _887){if(Object.prototype.hasOwnProperty.call(_887,i)){var _889=_888.find(i);if(_889){var _88a=_889.getIWidgetInstance().getWireModel();_88a.removeWire(this.id);_889.commit();}}}}for(var x in this.eventHandlers){if(Object.prototype.hasOwnProperty.call(this.eventHandlers,x)){this.eventSvr._unsubscribeEvent(this.eventHandlers[x],this.hubId);}}this.eventSvr._getHubAdapter(this.hubId).removeInlineHubClient(this.hubId);if(dojo.global["_"+this.id+"_"+"iContext"]){dojo.global["_"+this.id+"_"+"iContext"]=null;}}else{if(!this.isModal()){this.eventSvr.disconnectHubClient();if(dojo.global["_"+this.id+"_"+"iContext"]){dojo.global["_"+this.id+"_"+"iContext"]=null;}}}if(this.rootElement){this.rootElement=null;}if(this.windowManager){this.windowManager=null;}},_doRender:function(){var _88b=document.createElement("div");_88b.className=this.ns+"Content";this.rootElement.appendChild(_88b);var _88c=this.rootElement.lastChild;dojo.addClass(_88c,this.currentMode);_88c.style.visibility="hidden";if(this._inIframe()){dojo.style(_88c,"height","100%");}var _88d=this.widgetDef.getIDescriptorItems();var _88e=_88d.getItemValue(iwConstants.iDescriptorItems.mode);if(this.isModal()&&this.currentMode!=_88e){var _88f=document.createElement("div");_88f.className=this.ns+"Content";this.rootElement.appendChild(_88f);contentDiv1=this.rootElement.lastChild;dojo.addClass(contentDiv1,_88e);contentDiv1.style.visibility="hidden";contentDiv1.style.display="none";this._updateMarkup(_88e,contentDiv1);}this._updateMarkup(this.currentMode,_88c);this._loadWidgetSharedResource(dojo.partial(this._finishRender,_88c,this));},_finishRender:function(_890,_891){try{var _892=_891.eventSvr._subscribeEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+_891.id,_891,"handleSizeChanged",null,_891.id);_891.eventHandlers.push(_892);_891._createiScope();_891._evalScripts(_890);_891.windowManager[_891.currentMode]={id:_891.currentMode,root:_890,active:true,external:false};_891.onLoad();if(typeof _891._eventqueue!="undefined"&&_891._eventqueue!==null){for(var _893 in _891._eventqueue){if(Object.prototype.hasOwnProperty.call(_891._eventqueue,_893)){_891.handleEvent(_891._eventqueue[_893]);}}}}catch(e){if(_891._logInlineMessage){_891._logInlineMessage(_891,e);}if(_891.bIsLoggable){_891.LOGGER.trace("iWidget._finishRender","failed to render widget:"+_891.id+" Error:"+e.message);}return;}dojo.query("."+_891.ns+"loading",_891.rootElement).forEach(function(elem){com.ibm.mm.enabler.utils.Dom.destroyNode(elem);});dojo.query("."+_891.currentMode,_891.rootElement).style({"visibility":""});},_evalScripts:function(_894){dojo.query("script",_894).forEach(function(_895){this._jsHandler.handle(_895);},this);},onLoad:function(){if(!this.isModal()){this._handleEventInternal(iwConstants.EVENTS.onLoad);}this.updateState();var _896=new com.ibm.mm.iwidget.IEventImpl("on"+this.currentMode,null,{oldMode:null});this._handleEventInternal("on"+this.currentMode,_896);this.loaded=true;try{dojo.publish(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+this.id,[this.id]);}catch(e){throw e;}this.eventSvr._publishEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+this.hubId,this.hubId);},updateState:function(){return;},_getSimpleEventHandler:function(_897){if(this.simpleWidgetEvents&&this.simpleWidgetEvents[_897]){return this.simpleWidgetEvents[_897];}var _898=this.widgetDef.getWidgetEvents()[_897];if(!_898){_898=_897;}var _899=this._getHandlerScope(_898);var _89a=null;if(_899){_89a=dojo.hitch(_899,_898);this.simpleWidgetEvents[_897]=_89a;}else{if(_898.indexOf("on")===0){var _89b="on"+_898.substr(2,1).toUpperCase()+_898.substr(3);if(_89b!=_898){_899=this._getHandlerScope(_89b);if(_899){_89a=dojo.hitch(_899,_89b);this.simpleWidgetEvents[_897]=_89a;}}}}return _89a;},_getHandlerScope:function(_89c){var fn=dojo.global["_"+this.id+"_"+_89c];if(typeof (fn)=="undefined"){widgetScope=dojo.global["_"+this.id+"_iContext"].iScope();if(widgetScope&&widgetScope[_89c]){fn=widgetScope;}}if(typeof fn=="undefined"||fn===null){fn=dojo.global[_89c];}if(typeof fn=="undefined"||fn===null){return null;}else{return fn;}},handleEvent:function(_89d){var _89e=_89d.declaredClass;if(_89e=="com.ibm.mm.iwidget.IEventImpl"){var _89f=_89d.name;return this._handleEvent(_89f,_89d);}},_handleEvent:function(_8a0,_8a1){_8a1=this._deserializePayload(_8a1);if(typeof _8a0=="undefined"||_8a0===null){return false;}if(!this.loaded){if(!this._eventqueue){this._eventqueue={};}this._eventqueue[_8a0]=_8a1;return;}try{if(_8a0==iwConstants.EVENTS.onModeChanged){if(this._inIframe()){var _8a2={};_8a2.methodname="_handleOnModeChange";_8a2.hubclient=this.hubId;_8a2.params=[_8a1.payload];var id="_stub_"+this.id;this.eventSvr._publishEvent(iwConstants.WIDGETEVENT_PREFIX+id,_8a2,this.hubId);return;}return this._handleModeChange(_8a1);}return this._handleEventInternal(_8a0,_8a1);}catch(e){this.LOGGER.severe("IWidgetWrapper.handleEvent","widget: ${0}, eventName: ${1}, HandleEventException: ${2}",[this.hubId,_8a0,e]);throw e;}},_deserializePayload:function(_8a3){if(typeof _8a3.payload=="string"&&_8a3.payload.indexOf("className")!=-1&&_8a3.payload.indexOf("json")!=-1){try{var _8a4=dojo.fromJson(_8a3.payload);if(_8a4.className&&typeof _8a4.className=="string"&&_8a4.className.length>0&&_8a4.json&&typeof _8a4.json=="string"){_8a3.payload=new (dojo.getObject(_8a4.className))(_8a4.json);}}catch(e){this.LOGGER.severe("IWidgetWrapper._deserializePayload","widget: ${0}, eventName: ${1}, PayloadDeserializeException: ${2}",[this.hubId,_8a3.payload,e]);throw e;}}return _8a3;},_handleOnModeChange:function(_8a5){var _8a6=new com.ibm.mm.iwidget.IEventImpl("onModeChanged",null,{newMode:_8a5},null);this._handleModeChange(_8a6);},_handleModeChange:function(_8a7){var _8a8=false;var _8a9=this.currentMode;var _8aa=_8a7.payload;if(typeof _8aa=="undefined"||_8aa===null){return false;}if(dojo.isString(_8aa)){_8aa=dojo.fromJson(_8aa);}if(typeof _8aa=="undefined"||_8aa===null){return false;}var _8ab=_8aa.newMode||null;var _8ac=_8aa.rootElementId||null;if(_8ab!==null&&_8ab==this.currentMode){return false;}if(_8ab===null){return false;}var _8ad=_8ac!==null;var _8ae=_8ac;var _8af=this._getDefaultMode();if(!_8af){_8af="view";}if(this._inIframe()&&_8af==_8ab){this.currentMode=_8ab;if(this._handleSaveMode){this._handleSaveMode();}this.windowManager[_8ab]={id:_8ab,root:_8ae,active:true,external:false};this._handleOnModeEvent(_8ab,_8a9);return;}var _8b0=this.windowManager[_8ab];var _8b1=false;if(typeof _8b0!="undefined"&&_8b0!==null){var _8b2=_8b0.root;if(!_8b0.external&&_8b2!==null&&_8ac===null){_8ae=_8b2;_8b1=true;_8a8=true;dojo.style(_8b2,"display","");}}if(!_8b1){if(_8ae===null){var _8b3=document.createElement("div");_8b3.className=this.ns+"Content";this.rootElement.appendChild(_8b3);_8ae=this.rootElement.lastChild;dojo.addClass(_8ae,_8ab);}_8a8=this._updateMarkup(_8ab,_8ae);}if(_8a8){var _8b4=this.windowManager[this.currentMode];var _8b5=_8b4.root;if(_8b4.external){dojo.style(_8b5,"display","none");this.windowManager[this.currentMode]=null;}else{if(_8ac!==null){_8b4.active=false;}else{_8b4.active=false;dojo.style(_8b5,"display","none");}}_8a9=this.currentMode;this.currentMode=_8ab;if(this._handleSaveMode){this._handleSaveMode();}this.windowManager[_8ab]={id:_8ab,root:_8ae,active:true,external:_8ad};if(!_8b1){this._evalScripts(_8ae);}this._handleOnModeEvent(_8ab,_8a9);}if(_8a8&&!this._inIframe()){dojo.publish(iwConstants.EVENTS.modeChanged,[this.id,_8a9,_8ab]);_8aa={};_8aa.id=this.id;_8aa.oldMode=_8a9;_8aa.newMode=_8ab;this.eventSvr._publishEvent(com.ibm.mashups.iwidget.Constants.WIDGET_MODECHANGED,_8aa,this.hubId);}if(this._inIframe()){var _8b6={};_8b6.methodname="_handleOnModeUpdated";_8b6.hubclient=this.hubId;_8b6.params=[_8a7.payload];var id="_stub_"+this.id;this.eventSvr._publishEvent(iwConstants.WIDGETEVENT_PREFIX+id,_8b6,this.hubId);}return _8a8;},_handleOnModeUpdated:function(mode){this.currentMode=mode;if(this._handleSaveMode){this._handleSaveMode();}this.windowManager[mode]={id:mode,active:true,external:true};},_handleOnModeEvent:function(mode,_8b7){if(this._inIframe()){dojo.setContext(com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().global,com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().doc);if(dojo.isIE){if(document._mmcreateElement){document.createElement=document._mmcreateElement;}if(document._mmgetElementsByTagName){document.getElementsByTagName=document._mmgetElementsByTagName;}}}var _8b8=false;var _8b9="on"+mode;if(!_8b7){_8b7=null;}var _8ba=new com.ibm.mm.iwidget.IEventImpl(_8b9,null,{oldMode:_8b7});_8b8=this._handleEventInternal(_8b9,_8ba);return _8b8;},_handleEventInternal:function(_8bb,_8bc){if(typeof _8bb=="undefined"||_8bb===null){return false;}var _8bd=false;var _8be=null;if(_8bb.indexOf("on")===0){var _8bf=this._getSimpleEventHandler(_8bb);if(_8bf!==null){_8be=_8bf;}}if(_8be===null){_8be=this.getPublicEventHandler(_8bb);}if(dojo.isFunction(_8be)){try{if(_8bc){if(this._transform){_8bc=this._transform(_8bb,_8bc);}dojo.partial(_8be)(_8bc);}else{dojo.partial(_8be)();}}catch(e){this.LOGGER.severe("IWidgetWrapper._handleEventInternal","widget: ${0}, eventName: ${1}, HandleEventException: ${2}",[this.hubId,_8bb,e]);throw e;}_8bd=true;}return _8bd;},getPublicEventHandler:function(_8c0){return null;},_getParent:function(){if(!this.parent){this.parent=com.ibm.mm.iwidget.Utils.getWidgetParent(this.rootElement);}this.parent=this.parent||null;return this.parent;},_setParent:function(_8c1){this.parent=_8c1;},getAttributes:function(){if(!this.widgetAttributes){var _8c2=com.ibm.mashups.services.ServiceManager.getService("persistentAttributesFactoryService");this.widgetAttributes=new com.ibm.mm.iwidget.manageditemset.AttributesModeDelegate(_8c2,this);}return this.widgetAttributes;},getWidgetItemSets:function(){if(this.widgetItemSets){return this.widgetItemSets;}this.widgetItemSets={};if(this.widgetDef){var _8c3=this.widgetDef.getAllItemSetNames();for(var i=0,l=_8c3.length;i<l;i++){var id=_8c3[i];var _8c4=this.widgetDef.getItemSet(id);var _8c5=new com.ibm.mm.iwidget.itemset.ItemSetDefaultImpl(this,_8c4,id);this.widgetItemSets[id]=_8c5;}}return this.widgetItemSets;},getWidgetItemSet:function(name){var _8c6=this.getWidgetItemSets();var _8c7=null;if(_8c6){_8c7=_8c6[name];if(!_8c7){_8c7=new com.ibm.mm.iwidget.itemset.ItemSetDefaultImpl(this,null,name);this.widgetItemSets[name]=_8c7;}}return _8c7;},_loadWidgetSharedResource:function(cb2){if(cb2){cb2();}},_createiScope:function(){if(!this.isModal()){var _8c8=this.widgetDef.getIScope();var _8c9=null;if(typeof _8c8!="undefined"&&_8c8!==null){try{_8c9=new (dojo.getObject(_8c8))();}catch(err){if(this.bIsLoggable){this.LOGGER.trace("iWidget._createiScope","iScope"+_8c8,"Error",err);}}}this.iScope=_8c9||{};dojo.global["_"+this.id+"_iContext"].scope=this.iScope;this._executeCallbackQueue();}else{this.iScope=dojo.global["_"+this.id+"_iContext"].scope;}this.iScope.iContext=dojo.global["_"+this.id+"_iContext"];},getIDescriptorItems:function(){if(this.iDescriptor){return this.iDescriptor;}this.iDescriptor=new com.ibm.mm.iwidget.manageditemset.IDescriptorImpl(this,this.widgetDef.getIDescriptorItems(),this.getIWidgetInstance().getIDescriptorItems());return this.iDescriptor;},_getInitDefaultMode:function(){if(this._getModeFromNavStateModel){var _8ca=this._getModeFromNavStateModel();if(typeof _8ca!="undefined"&&_8ca!==null){return _8ca;}}return this._getDefaultMode();},_getDefaultMode:function(){var _8cb=this.getIWidgetInstance().getIDescriptorItems();if(typeof _8cb!="undefined"&&_8cb!==null){var _8cc=_8cb.getItemValue(iwConstants.iDescriptorItems.mode);if(_8cc){return _8cc;}}var _8cd=this.widgetDef.getIDescriptorItems();var _8ce=null;if(typeof _8cd!="undefined"&&_8cd!==null){_8ce=_8cd.getItemValue(iwConstants.iDescriptorItems.mode);}return _8ce||null;},_getMarkup:function(_8cf){var that=this;var cb=function(node,_8d0){that.eventSvr._publishEvent(that.eventSvr.WIDGETEVENT_PREFIX+that.id+".onMarkupReturned",node);};var _8d1=this.getMarkup();_8d1.setIncludeParent(_8cf);_8d1.setFinishedCallback(cb);_8d1.start();},_inIframe:function(){return false;},commit:function(_8d2){var _8d3=this.getIWidgetInstance();var _8d4=null;if(this._inIframe()&&!_8d2){var _8d5={};_8d4=_8d3.getAttributes();if(_8d4&&_8d4._isDirty()){_8d5.attributes=dojo.clone(_8d4.toJson());}var _8d6=_8d3.getWireModel();if(_8d6&&_8d6.isDirty()){_8d5.wiremodel=_8d6.toJson();}var _8d7={};_8d7.methodname="_handleDataSync";_8d7.hubclient=this.hubId;_8d7.params=[_8d5];var id="_stub_"+this.id;this.eventSvr._publishEvent(iwConstants.WIDGETEVENT_PREFIX+id,_8d7,this.hubId);return;}_8d4=_8d3.getAttributes();if(_8d4&&_8d4._isDirty()){this._notifyWidget(this,"attributes",_8d4);this._writePropertiesToDOM(this,"attributes",_8d4);_8d4._setDirty(false);}var _8d8=_8d3.getIDescriptorItems();if(_8d8&&_8d8._isDirty()){this._notifyWidget(this,"idescriptor",_8d8);this._writePropertiesToDOM(this,"idescriptor",_8d8);_8d8._setDirty(false);}var _8d9=_8d3.getWireModel();if(_8d9&&_8d9.isDirty()){_8d9.commit();}},_writePropertiesToDOM:function(_8da,_8db,_8dc){var ns=_8da.ns;var root=_8da.rootElement;var _8dd=dojo.query("span."+ns+"ItemSet[title=\""+_8db+"\"]",root);for(var i=0,l=_8dd.length;i<l;i++){var _8de=_8dd[i];if(root==_8de.parentNode){root.removeChild(_8de);}}var _8df=document.createElement("span");_8df.className=ns+"ItemSet";_8df.title=_8db;_8df.style.display="none";_8df.style.visibility="hidden";root.appendChild(_8df);var _8e0=_8dc.getAllNames();if(!_8e0){return;}for(var k=0,l2=_8e0.length;k<l2;k++){var _8e1=_8e0[k];var _8e2=document.createElement("a");_8e2.className=ns+"Item";_8e2.style.visibility="hidden";_8e2.style.display="none";_8e2.href="#"+_8e1;if(_8dc.isReadOnly(_8e1)){dojo.addClass(_8e2,ns+"ReadOnly");}var _8e3=_8dc.getItemLocales(_8e1);if(!_8e3||(_8e3!==null&&_8e3.length==1&&_8e3[0]=="")){var _8e4=_8dc.getItemValue(_8e1);if(_8e4){_8e2.appendChild(document.createTextNode(_8e4));}_8df.appendChild(_8e2);}else{if(_8e3!==null){var _8e5=_8dc._getItemDefaultLocale(_8e1);if(!_8e5){_8e5=_8dc.DEFAULT_LOCALE;}_8e2.setAttribute("lang",_8e5);for(var j=0;j<_8e3.length;j++){var _8e6=document.createElement("span");_8e6.setAttribute("class",ns+"Value");_8e6.setAttribute("lang",_8e3[j]);var _8e7=_8dc.getItemValue(_8e1,_8e3[j]);_8e6.appendChild(document.createTextNode(_8e7));_8e2.appendChild(_8e6);}_8df.appendChild(_8e2);}}}},_notifyWidget:function(_8e8,_8e9,_8ea){var _8eb=_8ea.getAllNames();if(!_8eb){return;}var _8ec={};_8ec.itemSetName=_8e9;_8ec.changes=[];for(var i=0,l=_8eb.length;i<l;i++){var _8ed=_8eb[i];if(_8ea._isItemDirty&&_8ea._isItemDirty(_8ed)){var _8ee=_8ea._getInternalItemValue(_8ed);if(_8ee&&_8ee._change){var _8ef=dojo.clone(_8ee._change);if(_8ef.newVal){_8ef.newVal=_8ea._getRequiredValue(_8ef.newVal);}if(_8ef.oldVal){_8ef.oldVal=_8ea._getRequiredValue(_8ef.oldVal);}_8ec.changes.push(_8ef);}_8ea._setItemDirty(_8ed,false);}}var _8f0=this._getListeners(_8e9);for(var x in _8f0){if(Object.prototype.hasOwnProperty.call(_8f0,x)){_8f0[x](_8ec);}}},isModal:function(){return false;},isLoaded:function(){return this.loaded;},isStandalone:function(){if(this.standalone===null){this.standalone=dojo.hasClass(this.rootElement,com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone);}return this.standalone;},handleSizeChanged:function(_8f1){if(_8f1.newWidth){this.width=_8f1.newWidth;}if(_8f1.newHeight){this.height=_8f1.newHeight;}var _8f2=new com.ibm.mm.iwidget.IEventImpl(iwConstants.EVENTS.onSizeChanged,null,_8f1,null);this._handleEvent(iwConstants.EVENTS.onSizeChanged,_8f2);},_isEmpty:function(_8f3){for(var i in _8f3){if(Object.prototype.hasOwnProperty.call(_8f3,i)){return false;}}return true;},_getListeners:function(_8f4){if(!this.listenerManager){return null;}if(!this.listenerManager[_8f4]){return null;}return this.listenerManager[_8f4];},_registerListener:function(_8f5,fn){if(!this.listenerManager){this.listenerManager={};}this.listenerManager[_8f5]=this.listenerManager[_8f5]?this.listenerManager[_8f5]:{};var _8f6=this._generateListenerId();var me=this;var _8f7=function(_8f8){var _8f9=_8f8.changes?_8f8.changes:null;if(_8f9.length>0){var _8fa=new com.ibm.mm.iwidget.IEventImpl("onItemSetChanged",null,_8f8);if(dojo.isString(fn)){var _8fb=me._getHandlerScope(fn);if(_8fb){fn=dojo.hitch(_8fb,fn);}}if(dojo.isFunction(fn)){dojo.partial(fn)(_8fa);}}};this.listenerManager[_8f5][_8f6]=_8f7;return _8f6;},_removeListener:function(_8fc,id){if(!_8fc||typeof id=="undefined"||id===null){return false;}if(!this.listenerManager){return false;}if(!this.listenerManager[_8fc]){return false;}if(this.listenerManager[_8fc][id]){delete this.listenerManager[_8fc][id];return true;}return false;},_generateListenerId:function(){if(typeof this._listenerCt=="undefined"){this._listenerCt=0;}else{this._listenerCt++;}return this._listenerCt;},_initManagedItemSet:function(){var _8fd=null;if(typeof (this.widgetDef)!="undefined"){_8fd=this.widgetDef._getManagedItemSetListener(iwConstants.ATTRIBUTES);if(_8fd!==null){this._registerListener(iwConstants.ATTRIBUTES,_8fd);}_8fd=this.widgetDef._getManagedItemSetListener(iwConstants.IDESCRIPTOR);if(_8fd!==null){this._registerListener(iwConstants.IDESCRIPTOR,_8fd);}}},_getRawUri:function(){var _8fe=this.getIWidgetInstance().widgetXMLUrl;if(this.widgetDef.getXmlBase()){_8fe=this.widgetDef.getXmlBase();}return _8fe;},_initBaseUri:function(_8ff){if(!_8ff){return;}this.rawBaseUri=this._getRawBaseUri(_8ff);this.widgetBaseUri=this._getResolvedPocUri(this.rawBaseUri);this.widgetBaseUriXhr=this._getXhrUri(this.widgetBaseUri);if(this.rawBaseUri.indexOf(":/")!=-1){var _900=this._getServerRoot(this.rawBaseUri);if(_900){this.serverRoot=this._getResolvedPocUri(_900);this.serverRootXhr=this._getXhrUri(this.serverRoot);}}},_rewriteURI:function(uri,_901){if(!this.widgetBaseUri){var _902=this._getRawUri();this._initBaseUri(_902);}return this._rewriteURIWithContext(uri,_901,this.widgetBaseUri,this.widgetBaseUriXhr,this.serverRoot,this.serverRootXhr);},_rewriteURIWithContext:function(uri,_903,_904,_905,_906,_907){if(typeof _903=="undefined"){_903=true;}var uri2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(uri);if(uri2){uri=uri2;}var _908=uri;var _909,_90a;if(_903){if(uri.indexOf(":/")!=-1){_908=com.ibm.mm.enabler.utils.URLHelper.rewriteURL(uri);}else{if(_907!==null&&uri.indexOf(_907)===0){_908=uri;}else{_909=uri.split("?");_90a=com.ibm.mm.enabler.utils.Misc.encodePath(_909[0]);_908=_90a;if(uri.indexOf("/")===0){if(_907){_908=_907+_90a.substring(1);}}else{if(_905){_908=_905+_90a;}}if(_909.length==2){_908+="?"+_909[1];}}}}else{if(uri.indexOf(":/")===-1){_909=uri.split("?");_90a=com.ibm.mm.enabler.utils.Misc.encodePath(_909[0]);if(uri.indexOf("/")===0){if(_906){_908=_906+_90a.substring(1);}}else{if(_904){_908=_904+_90a;}}if(_909.length===2){_908+="?"+_909[1];}}}return _908;},_getRawBaseUri:function(_90b){if(!_90b){return null;}var _90c=_90b.indexOf("?");if(0<_90c){_90b=_90b.substring(0,_90c);}var uri2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(_90b);if(uri2){_90b=uri2;}var rc=_90b.substring(0,_90b.lastIndexOf("/")+1);return rc;},_getResolvedPocUri:function(_90d){if(!_90d){return null;}var rc=_90d;if(com.ibm.mm.enabler.utils.Misc.isPocUrl(_90d)===true){rc=com.ibm.mm.enabler.utils.URLHelper.rewriteURL(_90d);}return rc;},_getXhrUri:function(_90e){if(!_90e){return null;}var rc=_90e;if(_90e.indexOf("/")!==0){rc=com.ibm.mm.enabler.utils.URLHelper.rewriteURL(_90e);}return rc;},_getServerRoot:function(_90f){if(!_90f){return null;}if(_90f.indexOf(":/")==-1){return null;}var _910=null;var _911=_90f.indexOf(":/");_910=_90f.substring(0,_911+2);if(_90f.indexOf(":///")!==-1){_910=_90f.substring(0,_911+4);}else{if(_90f.indexOf("://")!==-1){var _912=_90f.indexOf("/",_911+4);_910=_90f.substring(0,_912+1);}}return _910;},_executeCallbackQueue:function(){return;},_getCurrentMode:function(){return this.currentMode;}});com.ibm.mm.iwidget.widget.IWidgetWrapperImpl=com.ibm.mm.iwidget.widget.IWidgetWrapperDefaultImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.widget.IWidgetWrapperExtendedImpl");}}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetWrapper"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.IWidgetWrapper"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.IWidgetWrapper");}if(!dojo._hasResource["com.ibm.mashups.iwidget.model.WidgetModel"]){dojo._hasResource["com.ibm.mashups.iwidget.model.WidgetModel"]=true;dojo.provide("com.ibm.mashups.iwidget.model.WidgetModel");dojo.declare("com.ibm.mashups.iwidget.model.WidgetModel",null,{constructor:function(id){},find:function(id){},hasChildren:function(_913){},getChildren:function(_914,_915){},getParent:function(_916){},getWidgetDefinitionByUrl:function(url){},getWidgetDefinitionByURL:function(url){},commit:function(){},createIWidgetDefinition:function(json){},createWidget:function(span){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.model.WidgetModel"]){dojo._hasResource["com.ibm.mm.iwidget.model.WidgetModel"]=true;dojo.provide("com.ibm.mm.iwidget.model.WidgetModel");dojo.declare("com.ibm.mm.iwidget.model.WidgetModelDefaultImpl",com.ibm.mashups.iwidget.model.WidgetModel,{constructor:function(){this.widgetArr={};this.parentMap={};this.eventService=com.ibm.mashups.services.ServiceManager.getService("eventService");this.eventService.subscribeEvent(com.ibm.mashups.iwidget.Constants.UNLOAD_WIDGETS,this,"_unloadWidgets");if(!ibmConfig||(ibmConfig&&typeof ibmConfig.loadingHTML!="string")){var url=new dojo.moduleUrl("com.ibm.mm.iwidget","image/");url=url+"progress-anim.gif";this.processAnim=com.ibm.mm.enabler.utils.Misc.preloadImage(url,20,20);}dojo.addOnWindowUnload(this,"_onWindowUnload");this.global=dojo.global;this.doc=dojo.doc;this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},_onWindowUnload:function(){try{var arr=[];for(var i in this.widgetArr){if(Object.prototype.hasOwnProperty.call(this.widgetArr,i)){this._unloadWidget(i);}}}catch(e){console.log("_onWindowUnload "+e.message);}},createWidget:function(_917){var id=_917.getAttribute("id");if(typeof (id)=="undefined"){return;}var _918=this.widgetArr[id];if(typeof _918!="undefined"&&_918!==null){var _919=_918.rootElement;if(_919==_917){return _918;}else{this._unloadWidget(id);}}var _91a=new com.ibm.mm.iwidget.widget.IWidgetWrapperImpl(_917,id);this.widgetArr[id]=_91a;this.parentMap[id]="DEFER_TOKEN";return _91a;},createIWidgetDefinition:function(json){return new com.ibm.mm.iwidget.widget.IWidgetDefinitionImpl(null,null,json);},find:function(id){var _91b=this.widgetArr[id];if(typeof _91b!="undefined"){if(_91b.lazyLoad&&!_91b.loaded){this.renderWidget(_91b);delete _91b.lazyLoad;}return _91b;}return null;},getWidgetById:function(id){return this.find(id);},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_91c,sync){for(var _91d in this.widgetArr){if(Object.prototype.hasOwnProperty.call(this.widgetArr,_91d)){var _91e=this.widgetArr[_91d];var _91f=_91e.getIWidgetInstance();if(!_91f){continue;}_91e.commit();}}},_unloadWidgets:function(arr){var _920;if(typeof arr!="undefined"||arr!==null){if(dojo.isArray(arr)){for(var i in arr){if(Object.prototype.hasOwnProperty.call(arr,i)){_920=arr[i];this._unloadWidget(_920);}}dojo.publish(com.ibm.mashups.iwidget.Constants.WIDGETS_UNLOADED,[arr]);this.eventService.publishEvent(com.ibm.mashups.iwidget.Constants.WIDGETS_UNLOADED,arr);}else{if(dojo.isString(arr)){this._unloadWidget(arr);}}}},_unloadWidget:function(_921){if(typeof this.widgetArr[_921]!="undefined"&&this.widgetArr[_921]!==null){var _922=this.widgetArr[_921];try{_922.destroy();}catch(e){}delete this.widgetArr[_921];if(this.parentMap[_921]){delete this.parentMap[_921];}}},getParent:function(_923){var _924=this.parentMap[_923.getID()];if(_924&&_924=="DEFER_TOKEN"){_924=_923._getParent();this.parentMap[_923.getID()]=_924;}if(_924){parent=this.find(_924);}return parent||null;},hasChildren:function(_925){return (this.getChildren(_925,false).length===0)?false:true;},getChildren:function(_926,_927){this._checkParentMap();var _928=[];var _929=(typeof _927=="undefined")?true:_927;this._getChildren(_926,_929,_928);return _928;},_checkParentMap:function(){for(var id in this.widgetArr){if(Object.prototype.hasOwnProperty.call(this.widgetArr,id)){var _92a=this.parentMap[id];if(_92a&&_92a=="DEFER_TOKEN"){var _92b=this.widgetArr[id];_92a=_92b._getParent();this.parentMap[id]=_92a;}}}},_getChildren:function(_92c,_92d,_92e){for(var id in this.parentMap){if(this.parentMap[id]==_92c.getID()){var _92f=this.find(id);if(_92f){_92e.push(_92f);if(_92d){this._getChildren(_92f,_92d,_92e);}}}}},getWidgetDefinitionByUrl:function(url){return this.getWidgetDefinitionByURL(url);},getWidgetDefinitionByURL:function(url){return new com.ibm.mm.iwidget.DeferredLoadImpl(url);},getAllWidgets:function(){return this.widgetArr;},renderWidget:function(_930){if(typeof _930=="undefined"){return;}if(_930.loaded){return;}_930.doRender();}});com.ibm.mm.iwidget.model.WidgetModelImpl=com.ibm.mm.iwidget.model.WidgetModelDefaultImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"iWidget")>=0)){dojo["require"]("com.ibm.mm.iwidget.model.WidgetModelExtended");}}if(!dojo._hasResource["com.ibm.mm.iwidget.model.FactoryImpl"]){dojo._hasResource["com.ibm.mm.iwidget.model.FactoryImpl"]=true;dojo.provide("com.ibm.mm.iwidget.model.FactoryImpl");dojo.declare("com.ibm.mm.iwidget.model.FactoryImpl",com.ibm.mashups.iwidget.model.Factory,{constructor:function(){},getGlobalWidgetModel:function(){if(!this._globalWidgetModel){this._globalWidgetModel=new com.ibm.mm.iwidget.model.WidgetModelImpl();}return this._globalWidgetModel;}});com.ibm.mashups.iwidget.model.Factory=new com.ibm.mm.iwidget.model.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.iwidget.model.Factory"]){dojo._hasResource["com.ibm.mashups.iwidget.model.Factory"]=true;dojo.provide("com.ibm.mashups.iwidget.model.Factory");}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService_API"]){dojo._hasResource["com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService_API"]=true;dojo.provide("com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService_API");dojo.provide("com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService");dojo.declare("com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService",null,{createPersistentAttributes:function(_931){},setFactory:function(_932,_933){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.Constants_API"]){dojo._hasResource["com.ibm.mashups.enabler.widget.Constants_API"]=true;dojo.provide("com.ibm.mashups.enabler.widget.Constants_API");dojo.provide("com.ibm.mashups.enabler.widget.Constants");dojo.declare("com.ibm.mashups.enabler.widget.Constants",null,{FILTER_HANDLED_EVENTS:"HandledEvents",FILTER_PUBLISHED_EVENTS:"PublishedEvents"});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.Constants"]){dojo._hasResource["com.ibm.mm.enabler.widget.Constants"]=true;dojo.provide("com.ibm.mm.enabler.widget.Constants");dojo.declare("com.ibm.mm.enabler.widget.Constants",com.ibm.mashups.enabler.widget.Constants,{constructor:function(){},PERSISTENCE_MODE_MODEL:"Model",PERSISTENCE_MODE_MODEL_PREFERENCES:"ModelPreferences",PERSISTENCE_MODE_DOM:"DOM"});com.ibm.mashups.enabler.widget.Constants=new com.ibm.mm.enabler.widget.Constants();}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.Constants"]){dojo._hasResource["com.ibm.mashups.enabler.widget.Constants"]=true;dojo.provide("com.ibm.mashups.enabler.widget.Constants");}if(!dojo._hasResource["com.ibm.mm.iwidget.manageditemset.DOMPersistentAttributesFactoryImpl"]){dojo._hasResource["com.ibm.mm.iwidget.manageditemset.DOMPersistentAttributesFactoryImpl"]=true;dojo.provide("com.ibm.mm.iwidget.manageditemset.DOMPersistentAttributesFactoryImpl");dojo.declare("com.ibm.mm.iwidget.manageditemset.DOMPersistentAttributesFactoryImpl",com.ibm.mashups.iwidget.itemset.PersistentAttributesFactory,{constructor:function(){this.modes=["DOM"];},createPersistentAttributes:function(_934,_935){return new com.ibm.mm.iwidget.manageditemset.PersistentAttributes(_934,true);},getSupportedPersistenceMode:function(){return this.modes;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl",com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService,{constructor:function(){this._factories={};this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},createPersistentAttributes:function(_936){var _937;var wID=_936.id;_937=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PERSISTENCE_MODE);var _938=_936.rootElement;if(dojo.hasClass(_938,com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl.STANDALONE_CLASS)||!_937){_937=com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl.DEFAULT_PERSISTENCE;}if(typeof _937!=="undefined"&&_937==com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL){var _939=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _93a=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();var _93b=com.ibm.mm.iwidget.Utils.getModelID(wID);var _93c=new com.ibm.mm.enabler.IdentifierImpl(_93b);var _93d=_93a.find(_93c).start();if(typeof _93d==="undefined"||_93d===null){_937=com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl.DEFAULT_PERSISTENCE;if(dojo.isFunction(_936._getResourceBundle)){_936._getResourceBundle();this.LOGGER.warning("createPersistentAttributes",_936.iwMessages.W_STANDALONECLASS_MISSING_1,[wID]);}else{this.LOGGER.warning("createPersistentAttributes","widget "+wID+" is missing class "+com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone);}}}if(!(_937 in this._factories)){return null;}ret=this._factories[_937].createPersistentAttributes(_936,_937);return ret;},setFactory:function(_93e,_93f){this._factories[_93e]=_93f;}});com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl.DEFAULT_PERSISTENCE=com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_DOM;com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl.STANDALONE_CLASS=com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone;com.ibm.mashups.services.ServiceManager.setService("persistentAttributesFactoryService",new com.ibm.mm.iwidget.services.PersistentAttributesFactoryServiceImpl());com.ibm.mashups.services.ServiceManager.getService("persistentAttributesFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_DOM,new com.ibm.mm.iwidget.manageditemset.DOMPersistentAttributesFactoryImpl());}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService"]){dojo._hasResource["com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService"]=true;dojo.provide("com.ibm.mashups.iwidget.services.PersistentAttributesFactoryService");}if(!dojo._hasResource["com.ibm.mm.iwidget.services.IWidgetFragmentServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.IWidgetFragmentServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.IWidgetFragmentServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.IWidgetFragmentServiceImpl",null,{createItem:function(_940,_941,_942,ns){if(!ns){ns="iw-";}var item=document.createElement("a");dojo.addClass(item,ns+iwConstants.CSSCLASS_INSTANCE.iwItem);dojo.style(item,"visibility","hidden");dojo.style(item,"display","none");item.setAttribute("href","#"+_940);if(_942){item.setAttribute("lang",_942);}if(_941&&!_942){item.innerHTML=_941;}return item;},createItemSet:function(_943,ns){if(!ns){ns="iw-";}var _944=document.createElement("span");dojo.addClass(_944,ns+iwConstants.CSSCLASS_INSTANCE.iwItemSet);_944.setAttribute("title",_943);dojo.style(_944,"visibility","hidden");dojo.style(_944,"display","none");return _944;},createWidgetDefRef:function(_945,ns){if(!ns){ns="iw-";}var aTag=document.createElement("a");dojo.addClass(aTag,ns+iwConstants.CSSCLASS_INSTANCE.iwDefinition);aTag.setAttribute("href",_945);dojo.style(aTag,"visibility","hidden");dojo.style(aTag,"display","none");return aTag;},getItemSet:function(_946,name,ns){if(!ns){ns="iw-";}var rc=null;var _947=dojo.byId(_946);var _948=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwItemSet,_947);for(var i=0;i<_948.length;i++){var _949=_948[i];var _94a=_949.getAttribute("title");if(name==_94a){rc=_949;break;}}return rc;},getItem:function(_94b,name,ns){if(!ns){ns="iw-";}var rc=null;var _94c=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwItem,_94b);for(var i=0;i<_94c.length;i++){var _94d=_94c[i];var _94e=this.getKeyFromHref(_94d);if(_94e&&_94e==name){rc=_94d;break;}}return rc;},getItems:function(_94f,ns){if(!ns){ns="iw-";}var _950=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwItem,_94f);if(typeof _950=="undefined"||_950===null||_950.length===0){_950=null;}return _950;},getWidgetDefRef:function(_951,ns){if(!ns){ns="iw-";}var rc=null;var _952=dojo.byId(_951);var def=dojo.query("."+ns+iwConstants.CSSCLASS_INSTANCE.iwDefinition,_952)[0];var ref=def.getAttribute("href");if(ref){rc=ref;}return rc;},getKeyFromHref:function(node){var _953=node.getAttribute("href");if(!_953){return null;}var pos=_953.indexOf("#");if(pos<0){return null;}return _953.substring(pos+1);}});com.ibm.mashups.services.ServiceManager.setService("iwidgetFragmentService",new com.ibm.mm.iwidget.services.IWidgetFragmentServiceImpl());}if(!dojo._hasResource["com.ibm.mashups.enabler.utils.EndpointHelper_API"]){dojo._hasResource["com.ibm.mashups.enabler.utils.EndpointHelper_API"]=true;dojo.provide("com.ibm.mashups.enabler.utils.EndpointHelper_API");dojo.provide("com.ibm.mashups.enabler.utils.EndpointHelper");dojo.declare("com.ibm.mashups.enabler.utils.EndpointHelper",null,{resolve:function(url){return null;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.utils.EndpointHelper"]){dojo._hasResource["com.ibm.mashups.enabler.utils.EndpointHelper"]=true;dojo.provide("com.ibm.mashups.enabler.utils.EndpointHelper");}if(!dojo._hasResource["com.ibm.mm.enabler.utils.EndpointHelperImpl"]){dojo._hasResource["com.ibm.mm.enabler.utils.EndpointHelperImpl"]=true;dojo.provide("com.ibm.mm.enabler.utils.EndpointHelperImpl");dojo.declare("com.ibm.mm.enabler.utils.EndpointHelperImpl",null,{resolve:function(url){if(!url){return url;}var url2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(url);if(url2){return url2;}return url;}});com.ibm.mashups.enabler.utils.EndpointHelper=new com.ibm.mm.enabler.utils.EndpointHelperImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.EndpointUtilsExtendedImpl"]){dojo._hasResource["com.ibm.mm.enabler.EndpointUtilsExtendedImpl"]=true;dojo.provide("com.ibm.mm.enabler.EndpointUtilsExtendedImpl");dojo.declare("com.ibm.mm.enabler.EndpointUtilsExtendedImpl",com.ibm.mm.enabler.EndpointUtilsDefaultImpl,{constructor:function(){},checkForEndpoints:function(url){if(!url){return null;}var _954=url.toString();if(_954){var _955=_954.indexOf("endpoint://",0);if(_955===0){var _956=_954.indexOf("/",11);if(_956>0){var _957=_954.substring(11,_956);var _958=_954.substring(_956+1);var _959=this._resolveEndpoint(_957);if(_959.charAt(_959.length-1)=="/"){_954=_959+_958;}else{_954=_959+"/"+_958;}return _954;}}else{if(_955>0){var _95a=_954.substring(0,_955);var _95b=_954.substring(_955);var _95c=this.checkForEndpoints(_95b);if(_95c){return _95a+_95c.substring(1);}}}}return null;},_resolveEndpoint:function(_95d){if(!this.co){this._init();}var _95e=decodeURIComponent(_95d);var url=this.co.getValue(_95e+".url");if(!url){if(_95e=="{contenthandler}"){url=this.urlContentHandler;}else{if(_95e=="{webdavroot}"){url=this.urlWebDavRoot;}else{return null;}}}if((url)&&(url.charAt(0)!="/")&&(url.substr(0,4)!="http")){url="/"+url;}return url;},_init:function(){this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.co=this.cs.getConfigObject(com.ibm.mashups.enabler.services.ConfigConstants.ENDPOINT_CONFIG_PROVIDER);this.urlContentHandler="";this.urlContentHandler+=this.cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);var _95f=this.cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ANONYMOUS_USER);var _960;if(_95f){_960=this.cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PUBLIC);}else{_960=this.cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PRIVATE);}this.urlContentHandler+=_960;if(com.ibm.mm.enabler.remote.WebDavUrlFactory){this.urlWebDavRoot=com.ibm.mm.enabler.remote.WebDavUrlFactory.createUrl()+"/";}else{this.urlWebDavRoot=null;}}});com.ibm.mm.enabler.EndpointUtils=new com.ibm.mm.enabler.EndpointUtilsExtendedImpl();}if(!dojo._hasResource["com.ibm.mm.iwidget.payloadDef"]){dojo._hasResource["com.ibm.mm.iwidget.payloadDef"]=true;dojo.provide("com.ibm.mm.iwidget.payloadDef");dojo.declare("com.ibm.mm.iwidget.payloadDef",null,{constructor:function(name,type,_961,_962,_963){this.name=name;this.attributes=_963||null;if(!this.attributes){this.attributes={};}if(typeof type!="undefined"&&type!==null){this.attributes.type=type;}if(typeof _961!="undefined"&&_961!==null){this.attributes.defaultValue=_961;}if(typeof _962!="undefined"&&_962!==null){this.attributes.description=_962;}this.attributeNames=[];this.attributeNames.push("type");this.attributeNames.push("defaultValue");this.attributeNames.push("description");var _964;for(_964 in _963){if(Object.prototype.hasOwnProperty.call(_963,_964)){this.attributeNames.push(_964);}}this.children=new com.ibm.mm.enabler.ArrayMap();},setAttribute:function(name,_965){this.attributes[name]=_965;if(typeof (this.attributeNames[name])!="undefined"){this.attributeNames.push(name);}},getAttribute:function(name){var _966=this.attributes[name];if(typeof _966=="undefined"){_966=null;}return _966;},getAttributeNames:function(){return this.attributeNames;},getChildren:function(){return this.children.values();},getChild:function(name){return this.children.get(name);},setChild:function(name,_967){this.children.put(name,_967);},getChildrenNames:function(){this.children.keySet();},getName:function(){return this.name;},getType:function(){return this.attributes.type;},getDefaultValue:function(){return this.attributes.defaultValue;},getDescription:function(){return this.attributes.description;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.UtilsExtended"]){dojo._hasResource["com.ibm.mm.iwidget.UtilsExtended"]=true;dojo.provide("com.ibm.mm.iwidget.UtilsExtended");dojo.declare("com.ibm.mm.iwidget.UtilsExtendedImpl",com.ibm.mm.iwidget.UtilsDefaultImpl,{getPayloadDef:function(_968){var name=_968.getAttribute("name");var _969=new com.ibm.mm.iwidget.payloadDef(name);var _96a=_968.attributes;for(var i=0;i<_96a.length;i++){var _96b=_96a[i];if(_96b.name!="name"){_969.setAttribute(_96b.name,_96b.value);}}var _96c=_968.childNodes;for(var j=0;j<_96c.length;j++){var _96d=_96c[j];if(_96d.nodeType==1){var _96e=this.getPayloadDef(_96d);_969.setChild(_96e.name,_96e);}}return _969;}});com.ibm.mm.iwidget.Utils=new com.ibm.mm.iwidget.UtilsExtendedImpl();}if(!dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextMMExtensionImpl"]){dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextMMExtensionImpl"]=true;dojo.provide("com.ibm.mm.iwidget.icontext.IContextMMExtensionImpl");dojo.declare("com.ibm.mm.iwidget.icontext.IContextMMExtensionImpl",null,{constructor:function(_96f){this.widget=_96f;this.widgetId=_96f.id;},getSupportedModes:function(){var _970=this.widgetwrapper.widgetDef.getSupportedModes();return _970;},getPayloadDef:function(name){var _971=this.widget.widgetDef.payloadDefs;var _972=_971[name];if(typeof _972=="undefined"){return null;}return _972;},getPayloadDefNames:function(){var _973=this.widget.widgetDef.payloadDefs;var arr=[];for(var a in _973){if(Object.prototype.hasOwnProperty.call(_973,a)){arr.push(a);}}return arr;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.user.AnonymousMode"]){dojo._hasResource["com.ibm.mashups.enabler.user.AnonymousMode"]=true;dojo.provide("com.ibm.mashups.enabler.user.AnonymousMode");dojo.declare("com.ibm.mashups.enabler.user.AnonymousMode",null,{USER:"user",ANONYMOUS:"anonymous"});com.ibm.mashups.enabler.user.AnonymousMode=new com.ibm.mashups.enabler.user.AnonymousMode();}if(!dojo._hasResource["com.ibm.mashups.enabler.user.VirtualType"]){dojo._hasResource["com.ibm.mashups.enabler.user.VirtualType"]=true;dojo.provide("com.ibm.mashups.enabler.user.VirtualType");dojo.declare("com.ibm.mashups.enabler.user.VirtualType",null,{ALL_AUTHENTICATED_GROUP:"all authenticated group",ANONYMOUS_USER:"anonymous user",UNKNOWN:"unknown"});com.ibm.mashups.enabler.user.VirtualType=new com.ibm.mashups.enabler.user.VirtualType();}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Entity_API"]){dojo._hasResource["com.ibm.mashups.enabler.user.Entity_API"]=true;dojo.provide("com.ibm.mashups.enabler.user.Entity_API");dojo.provide("com.ibm.mashups.enabler.user.Entity");dojo.declare("com.ibm.mashups.enabler.user.Entity",[com.ibm.mashups.enabler.Identifiable],{getDisplayName:function(){},getCN:function(){},getAttribute:function(name){},getReadOnlyAttributeNames:function(){},getReadWriteAttributeNames:function(){},getAttributeNames:function(){},isVirtual:function(){},getVirtualType:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.user.EntityImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.EntityImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.EntityImpl");dojo.declare("com.ibm.mm.enabler.user.EntityImpl",[com.ibm.mashups.enabler.user.Entity,com.ibm.mm.enabler.IdentifiableImpl],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Entity"]){dojo._hasResource["com.ibm.mashups.enabler.user.Entity"]=true;dojo.provide("com.ibm.mashups.enabler.user.Entity");}if(!dojo._hasResource["com.ibm.mashups.enabler.user.User_API"]){dojo._hasResource["com.ibm.mashups.enabler.user.User_API"]=true;dojo.provide("com.ibm.mashups.enabler.user.User_API");dojo.provide("com.ibm.mashups.enabler.user.User");dojo.declare("com.ibm.mashups.enabler.user.User",[com.ibm.mashups.enabler.user.Entity],{getLoginName:function(){},getSN:function(){},getEmail:function(){},setAttribute:function(name,_974){},removeAttribute:function(name){}});}if(!dojo._hasResource["com.ibm.mm.enabler.user.UserImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.UserImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.UserImpl");dojo.declare("com.ibm.mm.enabler.user.UserImpl",[com.ibm.mashups.enabler.user.User,com.ibm.mm.enabler.user.EntityImpl],{constructor:function(data,_975,_976){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.anonUserID=_975;this.anonUserIDEncoded=_976;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_UM]);this.xmlData=data;this.changedAttributes={};this.addedAttributes={};this.removedAttributes={};},getAttribute:function(_977){if(typeof _977=="undefined"||_977===null){return null;}if(this.removedAttributes[_977]){return null;}else{if(this.changedAttributes[_977]){return this.changedAttributes[_977];}else{if(this.addedAttributes[_977]){return this.addedAttributes[_977];}}}var expr="atom:content/um:profile/um:attribute[@name='"+_977+"']/um:attributeValue";var _978=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_978.length===0){return null;}var _979=com.ibm.mm.enabler.utils.Dom.textContent(_978[0]);return _979;},getReadOnlyAttributeNames:function(){this.getAttributeNames();return this.readOnlyAttNames;},getReadWriteAttributeNames:function(){this.getAttributeNames();return this.lookasideAttNames;},getAttributeNames:function(){if(typeof this.attNames!="undefined"&&this.attNames!==null){return this.attNames;}var _97a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute",this.xmlData,this.ns);if(_97a.length===0){return null;}this.attNames=[];this.lookasideAttNames=[];this.readOnlyAttNames=[];for(var i=0;i<_97a.length;i++){var _97b=_97a[i];var _97c=_97b.getAttribute("name");if(typeof _97c!="undefined"&&_97c!==null&&_97c!==""){if(_97c.indexOf("com.ibm.mashups.user.")===0){this.lookasideAttNames.push(_97c);}else{this.readOnlyAttNames.push(_97c);}this.attNames.push(_97c);}}return this.attNames;},getID:function(){var _97d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:id",this.xmlData,this.ns);if((_97d===null)||(_97d.length===0)){return null;}var _97e=com.ibm.mm.enabler.utils.Dom.textContent(_97d[0]);if((_97e===null)||(_97e.length===0)){return null;}var pos=_97e.indexOf("profiles/");if(pos==-1){pos=_97e.indexOf("profiles:");}var id=_97e.slice(pos+"profiles:".length);return decodeURIComponent(id);},getLoginName:function(){var _97f=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='principalName']/um:attributeValue",this.xmlData,this.ns);if((_97f===null)||(_97f.length===0)){return null;}var _980=com.ibm.mm.enabler.utils.Dom.textContent(_97f[0]);return _980;},getSN:function(){var _981=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='sn']/um:attributeValue",this.xmlData,this.ns);if((_981===null)||(_981.length===0)){return null;}var sn=com.ibm.mm.enabler.utils.Dom.textContent(_981[0]);return sn;},getCN:function(){var _982=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='cn']/um:attributeValue",this.xmlData,this.ns);if((_982===null)||(_982.length===0)){return null;}var cn=com.ibm.mm.enabler.utils.Dom.textContent(_982[0]);return cn;},getEmail:function(){var _983=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='email']/um:attributeValue",this.xmlData,this.ns);if((_983===null)||(_983.length===0)){_983=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='mail']/um:attributeValue",this.xmlData,this.ns);if((_983===null)||(_983.length===0)){return null;}}var _984=com.ibm.mm.enabler.utils.Dom.textContent(_983[0]);return _984;},getDisplayName:function(){if((this.getID()==this.anonUserID)||(this.getID()==this.anonUserIDEncoded)){this.iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");return this.iwStr.ANON;}var _985=null;var _986=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='displayName']/um:attributeValue",this.xmlData,this.ns);_986=_986||null;if((_986!==null)&&(_986.length>0)){_985=com.ibm.mm.enabler.utils.Dom.textContent(_986[0]);}if((typeof _985=="undefined")||(_985===null)||(_985.length===0)){var _987=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _988=_987.getValue(com.ibm.mashups.enabler.services.ConfigConstants.DEFAULT_USER_DISPLAY_PROP);if((typeof _988!="undefined")&&(_988!==null)){_985=this.getAttribute(_988);}}if((typeof _985=="undefined")||(_985===null)||(_985.length===0)){_985=this.getLoginName();}return _985;},getEntityType:function(){return "user";},setAttribute:function(name,_989){var _98a=null;var expr="atom:content/*/um:attribute"+"[@name='"+name+"']/"+"um:attributeValue";var _98b=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_98b&&_98b.length>0){com.ibm.mm.enabler.utils.Dom.textContent(_98b[0],_989);this.changedAttributes[name]=_989;this.removedAttributes[name]=null;}else{var _98c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile",this.xmlData,this.ns);if(_98c&&_98c.length>0){var _98d=this.xmlData.ownerDocument;var _98e=com.ibm.mm.enabler.utils.Dom.createElement(_98d,"um:attribute",this.ns.um);_98e.setAttribute("name",name);_98e.setAttribute("type","xs:string");_98e.setAttribute("multiValued","false");var _98f=com.ibm.mm.enabler.utils.Dom.createElement(_98d,"um:attributeValue",this.ns.um);com.ibm.mm.enabler.utils.Dom.textContent(_98f,_989);_98e.appendChild(_98f);_98c[0].appendChild(_98e);this.changedAttributes[name]=null;this.addedAttributes[name]=_989;this.removedAttributes[name]=null;}}return _98a;},removeAttribute:function(name){var expr="atom:content/*/um:attribute"+"[@name='"+name+"']";var _990=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_990&&_990.length>0){var _991=_990[0].parentNode;_991.removeChild(_990[0]);this.changedAttributes[name]=null;this.addedAttributes[name]=null;this.removedAttributes[name]="";return "";}},getChangedAttributeNames:function(){return this.changedAttributes;},getAddedAttributeNames:function(){return this.addedAttributes;},getRemovedAttributeNames:function(){return this.removedAttributes;},clearChangedAttributeNames:function(){this.changedAttributes={};this.addedAttributes={};this.removedAttributes={};},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);},isVirtual:function(){if((this.getID()==this.anonUserID)||(this.getID()==this.anonUserIDEncoded)){return true;}return false;},getVirtualType:function(){if((this.getID()==this.anonUserID)||(this.getID()==this.anonUserIDEncoded)){return com.ibm.mashups.enabler.user.VirtualType.ANONYMOUS_USER;}return null;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.user.User"]){dojo._hasResource["com.ibm.mashups.enabler.user.User"]=true;dojo.provide("com.ibm.mashups.enabler.user.User");}if(!dojo._hasResource["com.ibm.mashups.enabler.user.CurrentUser_API"]){dojo._hasResource["com.ibm.mashups.enabler.user.CurrentUser_API"]=true;dojo.provide("com.ibm.mashups.enabler.user.CurrentUser_API");dojo.provide("com.ibm.mashups.enabler.user.CurrentUser");dojo.declare("com.ibm.mashups.enabler.user.CurrentUser",[com.ibm.mashups.enabler.user.User],{getJ2EEPrincipalName:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.user.CurrentUserImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.CurrentUserImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.CurrentUserImpl");dojo.declare("com.ibm.mm.enabler.user.CurrentUserImpl",[com.ibm.mashups.enabler.user.CurrentUser,com.ibm.mm.enabler.user.UserImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},getJ2EEPrincipalName:function(){var _992=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='j2ee_principialname']/um:attributeValue",this.xmlData,this.ns);_992=_992||null;if(_992!==null&&_992.length>0){return com.ibm.mm.enabler.utils.Dom.textContent(_992[0]);}else{return this.getLoginName();}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.user.CurrentUser"]){dojo._hasResource["com.ibm.mashups.enabler.user.CurrentUser"]=true;dojo.provide("com.ibm.mashups.enabler.user.CurrentUser");}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Group_API"]){dojo._hasResource["com.ibm.mashups.enabler.user.Group_API"]=true;dojo.provide("com.ibm.mashups.enabler.user.Group_API");dojo.provide("com.ibm.mashups.enabler.user.Group");dojo.declare("com.ibm.mashups.enabler.user.Group",[com.ibm.mashups.enabler.user.Entity],{});}if(!dojo._hasResource["com.ibm.mm.enabler.user.GroupImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.GroupImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.GroupImpl");dojo.declare("com.ibm.mm.enabler.user.GroupImpl",[com.ibm.mashups.enabler.user.Group,com.ibm.mm.enabler.user.EntityImpl],{constructor:function(data,_993,_994){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.allAuthID=_993;this.allAuthIDEncoded=_994;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_UM]);this.xmlData=data;},getID:function(){var _995=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:id",this.xmlData,this.ns);if((_995===null)||(_995.length===0)){return null;}var _996=com.ibm.mm.enabler.utils.Dom.textContent(_995[0]);if((_996===null)||(_996.length===0)){return null;}if(com.ibm.mm.enabler.model.UserModel.iConfig.getID){return com.ibm.mm.enabler.model.UserModel.iConfig.getID(_996);}var pos=_996.indexOf("profiles/");if(pos==-1){pos=_996.indexOf("profiles:");}var id=_996.slice(pos+"profiles:".length);return decodeURIComponent(id);},getCN:function(){var _997=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='cn']/um:attributeValue",this.xmlData,this.ns);if((_997===null)||(_997.length===0)){return null;}var cn=com.ibm.mm.enabler.utils.Dom.textContent(_997[0]);return cn;},getDisplayName:function(){if((this.getID()==this.allAuthID)||(this.getID()==this.allAuthIDEncoded)){this.iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");return this.iwStr.ALL_AUTH;}var _998=null;var _999=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:profile/um:attribute[@name='displayName']/um:attributeValue",this.xmlData,this.ns);_999=_999||null;if((_999!==null)&&(_999.length>0)){_998=com.ibm.mm.enabler.utils.Dom.textContent(_999[0]);}if((typeof _998=="undefined")||(_998===null)||(_998.length===0)){var _99a=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _99b=_99a.getValue(com.ibm.mashups.enabler.services.ConfigConstants.DEFAULT_GROUP_DISPLAY_PROP);if((typeof _99b!="undefined")&&(_99b!==null)){_998=this.getAttribute(_99b);}}if((typeof _998=="undefined")||(_998===null)||(_998.length===0)){_998=this.getCN();}return _998;},getEntityType:function(){return "group";},getAttribute:function(_99c){var expr="atom:content/um:profile/um:attribute[@name='"+_99c+"']/um:attributeValue";var _99d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_99d.length===0){return null;}var _99e=com.ibm.mm.enabler.utils.Dom.textContent(_99d[0]);return _99e;},isVirtual:function(){if((this.getID()==this.allAuthID)||(this.getID()==this.allAuthIDEncoded)){return true;}return false;},getVirtualType:function(){if((this.getID()==this.allAuthID)||(this.getID()==this.allAuthIDEncoded)){return com.ibm.mashups.enabler.user.VirtualType.ALL_AUTHENTICATED_GROUP;}return null;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Group"]){dojo._hasResource["com.ibm.mashups.enabler.user.Group"]=true;dojo.provide("com.ibm.mashups.enabler.user.Group");}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Attribute_API"]){dojo._hasResource["com.ibm.mashups.enabler.user.Attribute_API"]=true;dojo.provide("com.ibm.mashups.enabler.user.Attribute_API");dojo.provide("com.ibm.mashups.enabler.user.Attribute");dojo.declare("com.ibm.mashups.enabler.user.Attribute",null,{getName:function(){},getType:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.user.AttributeImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.AttributeImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.AttributeImpl");dojo.declare("com.ibm.mm.enabler.user.AttributeImpl",com.ibm.mashups.enabler.user.Attribute,{constructor:function(data){var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_UM]);this.xmlData=data;},getName:function(){var _99f=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:title",this.xmlData,this.ns);if((_99f===null)||(_99f.length===0)){return null;}var name=com.ibm.mm.enabler.utils.Dom.textContent(_99f[0]);return name;},getType:function(){var _9a0=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/um:attribute",this.xmlData,this.ns);if((_9a0===null)||(_9a0.length===0)){return null;}return _9a0[0].getAttribute("type");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Attribute"]){dojo._hasResource["com.ibm.mashups.enabler.user.Attribute"]=true;dojo.provide("com.ibm.mashups.enabler.user.Attribute");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.UserModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.UserModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.UserModel_API");dojo.provide("com.ibm.mashups.enabler.model.UserModel");dojo.declare("com.ibm.mashups.enabler.model.UserModel",[com.ibm.mashups.enabler.Commitable,com.ibm.mashups.enabler.ListModel,com.ibm.mashups.enabler.Locator],{getAnonymousMode:function(){},findCurrentUser:function(){},findUsersByAttribute:function(_9a1,_9a2){},findGroupByID:function(id){return new Deferred();},findGroupsByAttribute:function(_9a3,_9a4){return new Deferred();},findGroupAttributes:function(){return [];},findUserAttributes:function(){return [];},getVirtualUsers:function(){return [];},getVirtualGroups:function(){return [];},getLookasideAttributeNames:function(){return [];}});}if(!dojo._hasResource["com.ibm.mm.enabler.AnonymousHelper"]){dojo._hasResource["com.ibm.mm.enabler.AnonymousHelper"]=true;dojo.provide("com.ibm.mm.enabler.AnonymousHelper");dojo.declare("com.ibm.mm.enabler.AnonymousHelper",null,{constructor:function(){},_isAnonymous:function(){return ibmConfig.anonymousUser?true:false;},_isAnonymousLockedOnMode:function(){return ibmConfig["com.ibm.mashups.anonymous.mode.locked.on"]?true:false;},_isAnonymousLockedDown:function(){if(!this._isAnonymous()){return false;}return !this._isAnonymousLockedOnMode();},_isAnonymousLockedOn:function(){if(!this._isAnonymous()){return false;}return this._isAnonymousLockedOnMode();},getAnonymousMode:function(){if(this._isAnonymousLockedDown()){return com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS;}else{return com.ibm.mashups.enabler.user.AnonymousMode.USER;}}});com.ibm.mm.enabler.AnonymousHelper=new com.ibm.mm.enabler.AnonymousHelper();}if(!dojo._hasResource["com.ibm.mm.enabler.user.AllAuthGroupImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.AllAuthGroupImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.AllAuthGroupImpl");dojo.declare("com.ibm.mm.enabler.user.AllAuthGroupImpl",[com.ibm.mm.enabler.user.EntityImpl],{constructor:function(_9a5,_9a6){this.allAuthID=_9a5;this.allAuthIDEncoded=_9a6;},getID:function(){return this.allAuthID;},getCN:function(){return "all authenticated portal users";},getDisplayName:function(){this.iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");return this.iwStr.ALL_AUTH;},getEntityType:function(){return "group";},getAttribute:function(_9a7){return null;},isVirtual:function(){return true;},getVirtualType:function(){return com.ibm.mashups.enabler.user.VirtualType.ALL_AUTHENTICATED_GROUP;}});}if(!dojo._hasResource["com.ibm.mm.enabler.user.AnonUserImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.AnonUserImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.AnonUserImpl");dojo.declare("com.ibm.mm.enabler.user.AnonUserImpl",[com.ibm.mm.enabler.user.EntityImpl],{constructor:function(_9a8,_9a9){this.anonUserID=_9a8;this.anonUserIDEncoded=_9a9;},getAttribute:function(_9aa){return null;},getAttributeNames:function(){return [];},getID:function(){return this.anonUserID;},getLoginName:function(){return "anonymous portal user";},getSN:function(){return "anonymous portal user";},getCN:function(){return "anonymous portal user";},getEmail:function(){return null;},getDisplayName:function(){this.iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");return this.iwStr.ANON;},getEntityType:function(){return "user";},setAttribute:function(name,_9ab){return null;},removeAttribute:function(name){return null;},getChangedAttributeNames:function(){return {};},getAddedAttributeNames:function(){return {};},getRemovedAttributeNames:function(){return {};},clearChangedAttributeNames:function(){},isVirtual:function(){return true;},getVirtualType:function(){return com.ibm.mashups.enabler.user.VirtualType.ANONYMOUS_USER;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.UserModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.UserModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.UserModelImpl");dojo.provide("com.ibm.mm.enabler.model.UserModel.iConfig");dojo.declare("com.ibm.mm.enabler.model.UserModelImpl",[com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.model.ModelImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.root=null;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_UM]);this.currentUser=null;var _9ac=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var eps=_9ac.getValue("ConfigProvider.Endpoints");this.anonUserID=_9ac.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ANON_VIRTUAL_USER_ID);if((typeof this.anonUserID=="undefined")||(this.anonUserID===null)){this.anonUserID="anonymous portal user";}this.allAuthID=_9ac.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ALL_AUTH_VIRTUAL_GROUP_ID);if((typeof this.allAuthID=="undefined")||(this.allAuthID===null)){this.allAuthID="all authenticated portal users";}this.anonEnabled=false;var _9ad=_9ac.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ANON_MODE_ENABLED)||false;if(_9ad===true||_9ad=="true"||_9ad=="on"||_9ad=="TRUE"||_9ad=="ON"){this.anonEnabled=true;}this.anonUserIDEncoded=encodeURIComponent(this.anonUserID);this.allAuthIDEncoded=encodeURIComponent(this.allAuthID);this.anonUser=new com.ibm.mm.enabler.user.AnonUserImpl(this.anonUserID,this.anonUserIDEncoded);this.allAuth=new com.ibm.mm.enabler.user.AllAuthGroupImpl(this.allAuthID,this.allAuthIDEncoded);this.loadedUsers={};},getInstance:function(){var _9ae=com.ibm.mm.enabler.model.UserModelImpl._instance;return _9ae?_9ae:(com.ibm.mm.enabler.model.UserModelImpl._instance=new com.ibm.mm.enabler.model.UserModelImpl());},getAnonymousMode:function(){return com.ibm.mm.enabler.AnonymousHelper.getAnonymousMode();},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,uri);},_find:function(dfr,sync,id){var _9af="_find";var _9b0=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9b0){this.LOGGER.entering(_9af,arguments);}if(this.currentUser!==null&&this.currentUser.getID()==id){if(dfr){dfr.finish(this.currentUser,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.currentUser;}if((id===this.anonUserID)||(id===this.anonUserIDEncoded)){this.entry=this.anonUser;return this.anonUser;}if((id===this.allAuthID)||(id===this.allAuthIDEncoded)){this.entry=this.allAuth;return this.allAuth;}if(id in this.loadedUsers){this.entry=this.loadedUsers[id];return this.entry;}var _9b1=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9b1.setSchemeSpecificPart("users:profiles:"+encodeURIComponent(id));_9b1.setParameter("expandRefs","true");var _9b2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9b1,null,null,false,sync);this.entry=null;var _9b3={};_9b3.node=null;_9b2.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _9b4=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:entry",data,this.ns);if(_9b4&&_9b4.length>0){this.entry=new com.ibm.mm.enabler.user.UserImpl(_9b4[0],this.anonUserID,this.anonUserIDEncoded);}else{_9b4=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(_9b4&&_9b4.length>0){this.entry=new com.ibm.mm.enabler.user.UserImpl(_9b4[0],this.anonUserID,this.anonUserIDEncoded);}}this.entry=this.entry||null;if(this.entry!==null){this.loadedUsers[this.entry.getID()]=this.entry;_9b3.node=this.entry;}else{if(sync){_9b3.status=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;}}}if(dfr){dfr.finish(_9b3.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_9b3.status=xhr.status;}}}));if(_9b3.status){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_9b3.status]));}retVal=_9b3.node;if(_9b0){this.LOGGER.exiting(_9af);}return retVal;},findUsersByAttribute:function(_9b5,_9b6){return new com.ibm.mm.enabler.DeferredImpl(this,this._findUsersByAttribute,{name:_9b5,value:_9b6});},_findUsersByAttribute:function(dfr,sync,attr){var _9b7="_findUsersByAttributes";var _9b8=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9b8){this.LOGGER.entering(_9b7,arguments);}var _9b9=attr.name;var _9ba=attr.value;var _9bb=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9bb.setSchemeSpecificPart("users:profiles");_9bb.setParameter("expandRefs","true");_9bb.setParameter("searchAttributes",_9b9+"="+_9ba);var _9bc=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9bb,null,null,false,sync);this.entry=null;_9bc.read(dojo.hitch(this,function(type,data,xhr,args){var _9bd=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);var _9be=[];for(var i=0;i<_9bd.length;i++){var user=new com.ibm.mm.enabler.user.UserImpl(_9bd[i],this.anonUserID,this.anonUserIDEncoded);_9be.push(user);}this.entry=_9be;if(dfr){dfr.finish(this.entry,xhr.status);}}));if(_9b8){this.LOGGER.exiting(_9b7);}return this.entry;},findGroupByID:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._findGroupByID,id);},_findGroupByID:function(dfr,sync,id){var _9bf="_findGroupByID";var _9c0=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9c0){this.LOGGER.entering(_9bf,arguments);}if((id===this.allAuthID)||(id===this.allAuthIDEncoded)){this.entry=this.allAuth;return this.allAuth;}var _9c1=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9c1.setSchemeSpecificPart("groups:profiles:"+encodeURIComponent(id));_9c1.setParameter("expandRefs","true");var _9c2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9c1,null,null,false,sync);this.entry=null;_9c2.read(dojo.hitch(this,function(type,data,xhr,args){var _9c3=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:entry",data,this.ns);if(_9c3&&_9c3.length>0){this.entry=new com.ibm.mm.enabler.user.GroupImpl(_9c3[0],this.allAuthID,this.allAuthIDEncoded)||null;}else{_9c3=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(_9c3&&_9c3.length>0){this.entry=new com.ibm.mm.enabler.user.GroupImpl(_9c3[0],this.allAuthID,this.allAuthIDEncoded)||null;}}if(dfr){dfr.finish(this.entry,xhr.status);}}));if(_9c0){this.LOGGER.exiting(_9bf);}return this.entry;},findGroupsByAttribute:function(_9c4,_9c5){return new com.ibm.mm.enabler.DeferredImpl(this,this._findGroupsByAttribute,{name:_9c4,value:_9c5});},_findGroupsByAttribute:function(dfr,sync,attr){var _9c6="_findGroupsByAttribute";var _9c7=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9c7){this.LOGGER.entering(_9c6,arguments);}var _9c8=attr.name;var _9c9=attr.value;var _9ca=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9ca.setSchemeSpecificPart("groups:profiles");_9ca.setParameter("expandRefs","true");_9ca.setParameter("searchAttributes",_9c8+"="+_9c9);var _9cb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9ca,null,null,false,sync);this.entry=null;_9cb.read(dojo.hitch(this,function(type,data,xhr,args){var _9cc=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);var _9cd=[];for(var i=0;i<_9cc.length;i++){var _9ce=new com.ibm.mm.enabler.user.GroupImpl(_9cc[i],this.allAuthID,this.allAuthIDEncoded);_9cd.push(_9ce);}this.entry=_9cd;if(dfr){dfr.finish(this.entry,xhr.status);}}));if(_9c7){this.LOGGER.exiting(_9c6);}return this.entry;},findCurrentUser:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._findCurrentUser);},_findCurrentUser:function(dfr,sync){var _9cf="_findCurrentUser";var _9d0=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9d0){this.LOGGER.entering(_9cf,arguments);}if(this.currentUser!==null){if(dfr){dfr.finish(this.currentUser,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.currentUser;}var _9d1=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9d1.setSchemeSpecificPart("currentuser:profile");_9d1.setParameter("expandRefs","true");var _9d2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9d1,null,null,false,sync);_9d2.read(dojo.hitch(this,function(type,data,xhr,args){var _9d3=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:entry",data,this.ns);if(_9d3&&_9d3.length>0){this.currentUser=new com.ibm.mm.enabler.user.CurrentUserImpl(_9d3[0],this.anonUserID,this.anonUserIDEncoded);this.entry=_9d3[0];}else{_9d3=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(_9d3&&_9d3.length>0){this.currentUser=new com.ibm.mm.enabler.user.CurrentUserImpl(_9d3[0],this.anonUserID,this.anonUserIDEncoded);this.entry=_9d3[0];}}if(dfr){dfr.finish(this.currentUser,xhr.status);}}));if(_9d0){this.LOGGER.exiting(_9cf);}return this.currentUser;},findGroupAttributes:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._findGroupAttributes);},_findGroupAttributes:function(dfr,sync){var _9d4="findGroupAttributes";var _9d5=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9d5){this.LOGGER.entering(_9d4,arguments);}var _9d6=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9d6.setSchemeSpecificPart("attributes:groups");_9d6.setParameter("expandRefs","true");var _9d7=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9d6,null,null,false,sync);this.entry=null;_9d7.read(dojo.hitch(this,function(type,data,xhr,args){var _9d8=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);var _9d9=[];for(var i=0;i<_9d8.length;i++){var _9da=new com.ibm.mm.enabler.user.AttributeImpl(_9d8[i]);_9d9.push(_9da);}this.entry=_9d9;if(dfr){dfr.finish(this.entry,xhr.status);}}));if(_9d5){this.LOGGER.exiting(_9d4);}return this.entry;},findUserAttributes:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._findUserAttributes);},_findUserAttributes:function(dfr,sync){var _9db="_findUserAttributes";var _9dc=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9dc){this.LOGGER.entering(_9db,arguments);}var _9dd=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9dd.setSchemeSpecificPart("attributes:users");_9dd.setParameter("expandRefs","true");var _9de=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9dd,null,null,false,sync);this.attEntry=null;_9de.read(dojo.hitch(this,function(type,data,xhr,args){var _9df=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);var _9e0=[];for(var i=0;i<_9df.length;i++){var _9e1=new com.ibm.mm.enabler.user.AttributeImpl(_9df[i]);_9e0.push(_9e1);}this.attEntry=_9e0;if(dfr){dfr.finish(this.attEntry,xhr.status);}}));if(_9dc){this.LOGGER.exiting(_9db);}return this.attEntry;},isDirty:function(){var _9e2="isDirty()";var _9e3=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_9e3){this.LOGGER.entering(_9e2);}if(this.currentUser){if(this.currentUser.getAddedAttributeNames()||this.currentUser.getChangedAttributeNames()||this.currentUser.getChangedAttributeNames()){if(_9e3){this.LOGGER.exiting(_9e2,true);}return true;}}if(_9e3){this.LOGGER.exiting(_9e2,false);}return false;},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_9e4,sync){if(this.currentUser){if(this.currentUser.getAddedAttributeNames()||this.currentUser.getChangedAttributeNames()||this.currentUser.getChangedAttributeNames()){var _9e5=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.USER_URL,this);_9e5.setSchemeSpecificPart("currentuser:profile");_9e5.setParameter("expandRefs","true");this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this.requestCount=0;this._acquire();var _9e6=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_9e5,null,null,false,true);_9e6.update(this.currentUser.toString(),dojo.hitch(this,function(type,data,xhr,args){if(_9e4&&_9e4.operationCallback){_9e4.operationCallback(null,com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_9e4.operationCallbackParameters);}this._release(_9e4,xhr.status);this.currentUser.clearChangedAttributeNames();var _9e7=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:entry",data,this.ns);if(_9e7&&_9e7.length>0){this.currentUser=new com.ibm.mm.enabler.user.UserImpl(_9e7[0],this.anonUserID,this.anonUserIDEncoded);this.entry=_9e7[0];}else{_9e7=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(_9e7&&_9e7.length>0){this.currentUser=new com.ibm.mm.enabler.user.UserImpl(_9e7[0]);this.entry=_9e7[0];}}if(this.currentUser.getID() in this.loadedUsers){this.loadedUsers[this.currentUser.getID()]=user;}}));}}},_acquire:function(){this.requestCount++;},_release:function(_9e8,_9e9){this.statusCode=Math.max(parseInt(_9e9,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_9e8){_9e8.finish(null,this.statusCode);}}},getVirtualUsers:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getVirtualUsers);},_getVirtualUsers:function(dfr,sync){var _9ea=[];if(this.anonEnabled){_9ea.push(this.anonUser);}return _9ea;},getVirtualGroups:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getVirtualGroups);},_getVirtualGroups:function(dfr,sync){var _9eb=[];_9eb.push(this.allAuth);return _9eb;},getLookasideAttributeNames:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getLookasideAttributeNames);},_getLookasideAttributeNames:function(dfr,sync){if(!this.lookasideAttributes){this.lookasideAttributes=[];var _9ec=this.findUserAttributes().start();for(var i=0;i<_9ec.length;i++){var _9ed=_9ec[i].getName()||"";if(_9ed.indexOf("com.ibm.mashups.user.")===0){this.lookasideAttributes.push(_9ed);}}}return this.lookasideAttributes;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.UserModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.UserModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.UserModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.user.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.user.Factory_API");dojo.provide("com.ibm.mashups.enabler.user.Factory");dojo.declare("com.ibm.mashups.enabler.user.Factory",null,{getUserModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.user.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.user.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.user.FactoryImpl");dojo.declare("com.ibm.mm.enabler.user.FactoryImpl",com.ibm.mashups.enabler.user.Factory,{getUserModel:function(){return com.ibm.mm.enabler.model.UserModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.user.Factory=new com.ibm.mm.enabler.user.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.user.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.user.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.user.Factory");}if(!dojo._hasResource["com.ibm.mm.iwidget.manageditemset.UserProfileImpl"]){dojo._hasResource["com.ibm.mm.iwidget.manageditemset.UserProfileImpl"]=true;dojo.provide("com.ibm.mm.iwidget.manageditemset.UserProfileImpl");dojo.declare("com.ibm.mm.iwidget.manageditemset.UserProfileImpl",com.ibm.mashups.iwidget.itemset.ManagedItemSet,{constructor:function(_9ee,user){this.widgetId=_9ee;this.user=user;},getItemValue:function(name){if(!name){return null;}var _9ef=this.user.getAttribute(name);if(typeof _9ef=="undefined"){_9ef=null;}return _9ef;},setItemValue:function(name,_9f0){if(!name||!_9f0){return null;}if(this.isReadOnly(name)){return null;}this.user.setAttribute(name,_9f0);return this;},isReadOnly:function(name){if(typeof name=="undefined"||name===null){return false;}var _9f1=this.user.getReadOnlyAttributeNames();var rc=this._contains(_9f1,name);return rc;},_contains:function(_9f2,_9f3){if(!_9f3){return false;}if(!_9f2){return false;}if(_9f2&&!dojo.isArray(_9f2)){return false;}for(var i=0;i<_9f2.length;i++){if(_9f2[i]&&_9f2[i]==_9f3){return true;}}return false;},removeItem:function(name){if(!name){return null;}if(this.isReadOnly(name)){return null;}this.user.removeAttribute(name);return this;},getAllNames:function(){var _9f4=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _9f5=_9f4.getValue("com.ibm.mashups.hideLookaside");if(dojo.isString(_9f5)&&_9f5.toLowerCase()=="true"){return this.user.getReadOnlyAttributeNames();}return this.user.getAttributeNames();},save:function(cb){return this.commit(cb);},commit:function(cb){var _9f6=com.ibm.mashups.enabler.user.Factory.getUserModel();var _9f7=_9f6.commit();var fn=function(_9f8,_9f9,_9fa){if(cb){var rc=false;var _9fb=iwConstants.USERPROFILE;if(_9f9&&_9f9==iwConstants.status.SUCCESS){rc=true;}cb(_9fb,rc);}};_9f7.setFinishedCallback(fn);_9f7.start();},addListener:function(fn){var _9fc=this._getWidget();if(!_9fc){return null;}var _9fd=_9fc._registerListener(iwConstants.USERPROFILE,fn);return _9fd;},removeListener:function(_9fe){var _9ff=this._getWidget();if(!_9ff){return null;}return _9ff._removeListener(iwConstants.USERPROFILE,_9fe);},_getWidget:function(){var _a00=com.ibm.mashups.iwidget.model.Factory.getGlobalModel();return _a00.find(this.widget)||null;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.ResourceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.ResourceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.ResourceImpl");dojo.declare("com.ibm.mm.iwidget.widget.ResourceImpl",null,{constructor:function(obj){if(obj){for(var i in obj){if(Object.prototype.hasOwnProperty.call(obj,i)){this[i]=obj[i];}}}},IMAGE:{"bmp":"bmp","cod":"cod","gif":"gif","ief":"ief","jpe":"jpe","jpeg":"jpeg","jpg":"jpg","jfif":"jfif","svg":"svg","tif":"tif","tiff":"tiff","ras":"ras","cmx":"cmx","ico":"ico","pnm":"pnm","pbm":"pbm","pgm":"pgm","ppm":"ppm","rgb":"rgb","xbm":"xbm","xpm":"xpm","xwd":"xwd"},isCSS:function(){var rc=false;var _a01=this._getExtension();if(_a01&&_a01=="css"){rc=true;}if(!rc&&this.getMimeType()){if(this.getMimeType()=="text/stylesheet"||this.getMimeType()=="text/css"){rc=true;}}return rc;},isImage:function(){var rc=false;var _a02=this._getExtension();if(_a02&&_a02 in this.IMAGE){rc=true;}if(!rc&&this.getMimeType()){if(this.getMimeType().indexOf("image/")===0){rc=true;}}return rc;},isJS:function(){var rc=false;var _a03=this._getExtension();if(_a03&&_a03=="js"){rc=true;}if(!rc&&this.getMimeType()){var _a04=this.getMimeType();if(_a04=="text/javascript"||_a04=="application/x-javascript"||_a04=="application/javascript"){rc=true;}}return rc;},getGlobalId:function(){var id=this[iwConstants.RESOURCE.globalid];if(!id){id=this[iwConstants.RESOURCE.id];}if(!id){id=null;}return id;},getSrc:function(){return this[iwConstants.RESOURCE.src];},getMimeType:function(){var _a05=this[iwConstants.RESOURCE.mimeType];if(!_a05){_a05=null;}return _a05;},_getExtension:function(){var uri=this.getSrc();if(!uri){return null;}var _a06=uri.substring(uri.lastIndexOf(".")+1,uri.length);if(!_a06){return null;}return _a06;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextExtendedImpl"]){dojo._hasResource["com.ibm.mm.iwidget.icontext.IContextExtendedImpl"]=true;dojo.provide("com.ibm.mm.iwidget.icontext.IContextExtendedImpl");dojo.declare("com.ibm.mm.iwidget.icontext.IContextExtendedImpl",com.ibm.mm.iwidget.icontext.IContextDefaultImpl,{_initEvents:function(){this.iEvents=new com.ibm.mm.iwidget.icontext.IContextIEventsImpl(this.widgetwrapper);},_initIO:function(){this.io=new com.ibm.mm.iwidget.icontext.IContextIOImpl(this.widgetwrapper);},_initMMExtension:function(){this._mm=new com.ibm.mm.iwidget.icontext.IContextMMExtensionImpl(this.widgetwrapper);},getUserProfile:function(){var _a07=com.ibm.mashups.enabler.user.Factory.getUserModel();var user=_a07.findCurrentUser().start();var _a08=null;if(user){_a08=new com.ibm.mm.iwidget.manageditemset.UserProfileImpl(this.widgetId,user);}return _a08;},requires:function(_a09,_a0a,uri,cb,_a0b){_a0b=_a0b||null;if(!_a0b){_a0b="text/plain";}uri=uri||null;if(uri){var obj={};obj[iwConstants.RESOURCE.mimeType]=_a0b;obj[iwConstants.RESOURCE.id]=_a09;obj[iwConstants.RESOURCE.version]=_a0a;obj[iwConstants.RESOURCE.src]=uri;obj[iwConstants.RESOURCE.callback]=cb;var _a0c=new com.ibm.mm.iwidget.widget.ResourceImpl(obj);com.ibm.mashups.services.ServiceManager.getService("resourceLoadService").loadResource(_a0c,this.widgetId);}},processiWidgets:function(root){dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[root,true]);},getShareableItemSet:function(name){name=name||null;if(!name){return null;}var _a0d=this.widgetwrapper._getShareableItemSet(name);return _a0d;}});com.ibm.mm.iwidget.icontext.IContextImpl=com.ibm.mm.iwidget.icontext.IContextExtendedImpl;}if(!dojo._hasResource["com.ibm.mashups.enabler.Primeable"]){dojo._hasResource["com.ibm.mashups.enabler.Primeable"]=true;dojo.provide("com.ibm.mashups.enabler.Primeable");dojo.declare("com.ibm.mashups.enabler.Primeable",null,{setPrimingData:function(data){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SelectionLocator"]){dojo._hasResource["com.ibm.mashups.enabler.model.SelectionLocator"]=true;dojo.provide("com.ibm.mashups.enabler.model.SelectionLocator");dojo.declare("com.ibm.mashups.enabler.model.SelectionLocator",null,{findDefaultAcceptParent:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.Constants"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.Constants"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.Constants");dojo.declare("com.ibm.mashups.enabler.navigation.Constants",null,{NAVIGATION_PAGE:"NavigationPage",NAVIGATION_LABEL:"NavigationLabel",NAVIGATION_URL:"NavigationURL"});com.ibm.mashups.enabler.navigation.Constants=new com.ibm.mashups.enabler.navigation.Constants();}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.Constants"]){dojo._hasResource["com.ibm.mashups.enabler.layout.Constants"]=true;dojo.provide("com.ibm.mashups.enabler.layout.Constants");dojo.declare("com.ibm.mashups.enabler.layout.Constants",null,{LAYOUT_CONTROL:"LayoutControl",LAYOUT_CONTAINER:"LayoutContainer",CONTEXT_WIDGET_DEFINITION_ID:"WidgetDefinitionID",CONTEXT_WIDGET_DEFINITION_URL:"WidgetDefinitionURL",CONTEXT_TYPE:"type"});com.ibm.mashups.enabler.layout.Constants=new com.ibm.mashups.enabler.layout.Constants();}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutNode_API");dojo.provide("com.ibm.mashups.enabler.layout.LayoutNode");dojo.declare("com.ibm.mashups.enabler.layout.LayoutNode",[com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.Identifiable],{getLayoutNodeType:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.layout.LayoutNode.getLayoutNodeType");}});}if(!dojo._hasResource["com.ibm.mm.enabler.EditLinkProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.EditLinkProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.EditLinkProviderImpl");dojo.declare("com.ibm.mm.enabler.EditLinkProviderImpl",null,{constructor:function(node){this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns_elp=nsf.getNameSpaces([nsf.NS_ATOM]);this.ELP_EDIT_LINK="atom:link[@rel='edit']";},getEditLink:function(){var _a0e=null;var _a0f=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.ELP_EDIT_LINK,this.xmlData,this.ns_elp);if(_a0f&&_a0f.length>0){_a0e=_a0f[0].getAttribute("href");}else{throw new Error(dojo.string.substitute(this.modelMessages.E_ELEMENT_NOT_FOUND_2,[this.ELP_EDIT_LINK,this.toString()]));}return _a0e;}});}if(!dojo._hasResource["com.ibm.mm.enabler.layout.LayoutNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.layout.LayoutNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.layout.LayoutNodeImpl");dojo.declare("com.ibm.mm.enabler.layout.LayoutNodeImpl",[com.ibm.mashups.enabler.layout.LayoutNode,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.TransformableImpl,com.ibm.mm.enabler.MetaDataImpl2,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.ac.EffectiveAccessImpl],{constructor:function(node,_a10){this.setXml(node,true);this.layoutModel=_a10;},_getLayoutModel:function(){return this.layoutModel;},getLayoutNodeType:function(){return this._type;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutNode"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutNode"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.content.RuntimeContent_API"]){dojo._hasResource["com.ibm.mashups.enabler.content.RuntimeContent_API"]=true;dojo.provide("com.ibm.mashups.enabler.content.RuntimeContent_API");dojo.provide("com.ibm.mashups.enabler.content.RuntimeContent");dojo.declare("com.ibm.mashups.enabler.content.RuntimeContent",null,{getRuntimeMarkup:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.RuntimeContent.getRuntimeMarkup");}});}if(!dojo._hasResource["com.ibm.mm.enabler.content.RuntimeContentImpl"]){dojo._hasResource["com.ibm.mm.enabler.content.RuntimeContentImpl"]=true;dojo.provide("com.ibm.mm.enabler.content.RuntimeContentImpl");dojo.declare("com.ibm.mm.enabler.content.RuntimeContentImpl",com.ibm.mashups.enabler.content.RuntimeContent,{_scope:null,constructor:function(_a11,func){this._scope=_a11;this._getRuntimeMarkup=func||(function(){});},getRuntimeMarkup:function(){return new com.ibm.mm.enabler.DeferredImpl(this._scope||null,this._getRuntimeMarkup);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.RuntimeContent"]){dojo._hasResource["com.ibm.mashups.enabler.content.RuntimeContent"]=true;dojo.provide("com.ibm.mashups.enabler.content.RuntimeContent");}if(!dojo._hasResource["com.ibm.mashups.enabler.content.RuntimeContentProvider"]){dojo._hasResource["com.ibm.mashups.enabler.content.RuntimeContentProvider"]=true;dojo.provide("com.ibm.mashups.enabler.content.RuntimeContentProvider");dojo.declare("com.ibm.mashups.enabler.content.RuntimeContentProvider",null,{getRuntimeContent:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.RuntimeContentProvider.getRuntimeContent");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutContainer_API"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutContainer_API"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutContainer_API");dojo.provide("com.ibm.mashups.enabler.layout.LayoutContainer");dojo.declare("com.ibm.mashups.enabler.layout.LayoutContainer",[com.ibm.mashups.enabler.layout.LayoutNode,com.ibm.mashups.enabler.content.RuntimeContentProvider],{});}if(!dojo._hasResource["com.ibm.mm.enabler.DeferredSetImpl"]){dojo._hasResource["com.ibm.mm.enabler.DeferredSetImpl"]=true;dojo.provide("com.ibm.mm.enabler.DeferredSetImpl");dojo.declare("com.ibm.mm.enabler.DeferredSetImpl",com.ibm.mm.enabler.DeferredImpl,{_deferreds:null,_returns:null,_started:false,_status:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,constructor:function(){this._deferreds=new dojox.collections.ArrayList();this._returns=new dojox.collections.ArrayList();},addDeferred:function(_a12){if(this._started){throw new Error();}var _a13=_a12.getFinishedCallback();var _a14=_a12.getFinishedCallbackParameters();_a12.setFinishedCallback(dojo.hitch(this,"_return"),{adtlCallback:_a13,adtlParameters:_a14,deferred:_a12});this._deferreds.add(_a12);},_return:function(_a15,_a16,args){var _a17=args.adtlCallback;var _a18=args.adtlParameters;var _a19=args.deferred;if(_a17){_a17(_a15,_a16,_a18);}this._status=Math.max(this._status,_a16);this._returns.add({deferred:_a19,result:_a15,status:_a16});if(this._deferreds.count==this._returns.count){this._finish();}},_finish:function(){var _a1a=this.getFinishedCallback();if(_a1a){_a1a(this._returns,this._status,this.getFinishedCallbackParameters());}},start:function(sync){if(!this._started){this._started=true;this.inherited(arguments);sync=(sync||typeof (sync)=="undefined");if(this._deferreds.count>0){this._deferreds.forEach(function(_a1b){_a1b.start(sync);},this);}else{this._finish();}}}});}if(!dojo._hasResource["com.ibm.mm.enabler.DeferredSet"]){dojo._hasResource["com.ibm.mm.enabler.DeferredSet"]=true;dojo.provide("com.ibm.mm.enabler.DeferredSet");dojo.declare("com.ibm.mm.enabler.DeferredSet",com.ibm.mm.enabler.DeferredSetImpl,{});}if(!dojo._hasResource["dijit._base.manager"]){dojo._hasResource["dijit._base.manager"]=true;dojo.provide("dijit._base.manager");dojo.declare("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0;},add:function(_a1c){if(this._hash[_a1c.id]){throw new Error("Tried to register widget with id=="+_a1c.id+" but that id is already registered");}this._hash[_a1c.id]=_a1c;this.length++;},remove:function(id){if(this._hash[id]){delete this._hash[id];this.length--;}},forEach:function(func,_a1d){_a1d=_a1d||dojo.global;var i=0,id;for(id in this._hash){func.call(_a1d,this._hash[id],i++,this._hash);}return this;},filter:function(_a1e,_a1f){_a1f=_a1f||dojo.global;var res=new dijit.WidgetSet(),i=0,id;for(id in this._hash){var w=this._hash[id];if(_a1e.call(_a1f,w,i++,this._hash)){res.add(w);}}return res;},byId:function(id){return this._hash[id];},byClass:function(cls){var res=new dijit.WidgetSet(),id,_a20;for(id in this._hash){_a20=this._hash[id];if(_a20.declaredClass==cls){res.add(_a20);}}return res;},toArray:function(){var ar=[];for(var id in this._hash){ar.push(this._hash[id]);}return ar;},map:function(func,_a21){return dojo.map(this.toArray(),func,_a21);},every:function(func,_a22){_a22=_a22||dojo.global;var x=0,i;for(i in this._hash){if(!func.call(_a22,this._hash[i],x++,this._hash)){return false;}}return true;},some:function(func,_a23){_a23=_a23||dojo.global;var x=0,i;for(i in this._hash){if(func.call(_a23,this._hash[i],x++,this._hash)){return true;}}return false;}});dijit.registry=new dijit.WidgetSet();dijit._widgetTypeCtr={};dijit.getUniqueId=function(_a24){var id;do{id=_a24+"_"+(_a24 in dijit._widgetTypeCtr?++dijit._widgetTypeCtr[_a24]:dijit._widgetTypeCtr[_a24]=0);}while(dijit.byId(id));return dijit._scopeName=="dijit"?id:dijit._scopeName+"_"+id;};dijit.findWidgets=function(root){var _a25=[];function getChildrenHelper(root){for(var node=root.firstChild;node;node=node.nextSibling){if(node.nodeType==1){var _a26=node.getAttribute("widgetId");if(_a26){var _a27=dijit.byId(_a26);_a25.push(_a27);}else{getChildrenHelper(node);}}}};getChildrenHelper(root);return _a25;};dijit._destroyAll=function(){dijit._curFocus=null;dijit._prevFocus=null;dijit._activeStack=[];dojo.forEach(dijit.findWidgets(dojo.body()),function(_a28){if(!_a28._destroyed){if(_a28.destroyRecursive){_a28.destroyRecursive();}else{if(_a28.destroy){_a28.destroy();}}}});};if(dojo.isIE){dojo.addOnWindowUnload(function(){dijit._destroyAll();});}dijit.byId=function(id){return typeof id=="string"?dijit.registry._hash[id]:id;};dijit.byNode=function(node){return dijit.registry.byId(node.getAttribute("widgetId"));};dijit.getEnclosingWidget=function(node){while(node){var id=node.getAttribute&&node.getAttribute("widgetId");if(id){return dijit.byId(id);}node=node.parentNode;}return null;};dijit._isElementShown=function(elem){var _a29=dojo.style(elem);return (_a29.visibility!="hidden")&&(_a29.visibility!="collapsed")&&(_a29.display!="none")&&(dojo.attr(elem,"type")!="hidden");};dijit.isTabNavigable=function(elem){if(dojo.attr(elem,"disabled")){return false;}else{if(dojo.hasAttr(elem,"tabIndex")){return dojo.attr(elem,"tabIndex")>=0;}else{switch(elem.nodeName.toLowerCase()){case "a":return dojo.hasAttr(elem,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return true;case "iframe":if(dojo.isMoz){return elem.contentDocument.designMode=="on";}else{if(dojo.isWebKit){var doc=elem.contentDocument,body=doc&&doc.body;return body&&body.contentEditable=="true";}else{try{doc=elem.contentWindow.document;body=doc&&doc.body;return body&&body.firstChild&&body.firstChild.contentEditable=="true";}catch(e){return false;}}}default:return elem.contentEditable=="true";}}}};dijit._getTabNavigable=function(root){var _a2a,last,_a2b,_a2c,_a2d,_a2e;var _a2f=function(_a30){dojo.query("> *",_a30).forEach(function(_a31){var _a32=dijit._isElementShown(_a31);if(_a32&&dijit.isTabNavigable(_a31)){var _a33=dojo.attr(_a31,"tabIndex");if(!dojo.hasAttr(_a31,"tabIndex")||_a33==0){if(!_a2a){_a2a=_a31;}last=_a31;}else{if(_a33>0){if(!_a2b||_a33<_a2c){_a2c=_a33;_a2b=_a31;}if(!_a2d||_a33>=_a2e){_a2e=_a33;_a2d=_a31;}}}}if(_a32&&_a31.nodeName.toUpperCase()!="SELECT"){_a2f(_a31);}});};if(dijit._isElementShown(root)){_a2f(root);}return {first:_a2a,last:last,lowest:_a2b,highest:_a2d};};dijit.getFirstInTabbingOrder=function(root){var _a34=dijit._getTabNavigable(dojo.byId(root));return _a34.lowest?_a34.lowest:_a34.first;};dijit.getLastInTabbingOrder=function(root){var _a35=dijit._getTabNavigable(dojo.byId(root));return _a35.last?_a35.last:_a35.highest;};dijit.defaultDuration=dojo.config["defaultDuration"]||200;}if(!dojo._hasResource["dijit._base.focus"]){dojo._hasResource["dijit._base.focus"]=true;dojo.provide("dijit._base.focus");dojo.mixin(dijit,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return dijit.getBookmark().isCollapsed;},getBookmark:function(){var bm,rg,tg,sel=dojo.doc.selection,cf=dijit._curFocus;if(dojo.global.getSelection){sel=dojo.global.getSelection();if(sel){if(sel.isCollapsed){tg=cf?cf.tagName:"";if(tg){tg=tg.toLowerCase();if(tg=="textarea"||(tg=="input"&&(!cf.type||cf.type.toLowerCase()=="text"))){sel={start:cf.selectionStart,end:cf.selectionEnd,node:cf,pRange:true};return {isCollapsed:(sel.end<=sel.start),mark:sel};}}bm={isCollapsed:true};if(sel.rangeCount){bm.mark=sel.getRangeAt(0).cloneRange();}}else{rg=sel.getRangeAt(0);bm={isCollapsed:false,mark:rg.cloneRange()};}}}else{if(sel){tg=cf?cf.tagName:"";tg=tg.toLowerCase();if(cf&&tg&&(tg=="button"||tg=="textarea"||tg=="input")){if(sel.type&&sel.type.toLowerCase()=="none"){return {isCollapsed:true,mark:null};}else{rg=sel.createRange();return {isCollapsed:rg.text&&rg.text.length?false:true,mark:{range:rg,pRange:true}};}}bm={};try{rg=sel.createRange();bm.isCollapsed=!(sel.type=="Text"?rg.htmlText.length:rg.length);}catch(e){bm.isCollapsed=true;return bm;}if(sel.type.toUpperCase()=="CONTROL"){if(rg.length){bm.mark=[];var i=0,len=rg.length;while(i<len){bm.mark.push(rg.item(i++));}}else{bm.isCollapsed=true;bm.mark=null;}}else{bm.mark=rg.getBookmark();}}else{console.warn("No idea how to store the current selection for this browser!");}}return bm;},moveToBookmark:function(_a36){var _a37=dojo.doc,mark=_a36.mark;if(mark){if(dojo.global.getSelection){var sel=dojo.global.getSelection();if(sel&&sel.removeAllRanges){if(mark.pRange){var r=mark;var n=r.node;n.selectionStart=r.start;n.selectionEnd=r.end;}else{sel.removeAllRanges();sel.addRange(mark);}}else{console.warn("No idea how to restore selection for this browser!");}}else{if(_a37.selection&&mark){var rg;if(mark.pRange){rg=mark.range;}else{if(dojo.isArray(mark)){rg=_a37.body.createControlRange();dojo.forEach(mark,function(n){rg.addElement(n);});}else{rg=_a37.body.createTextRange();rg.moveToBookmark(mark);}}rg.select();}}}},getFocus:function(menu,_a38){var node=!dijit._curFocus||(menu&&dojo.isDescendant(dijit._curFocus,menu.domNode))?dijit._prevFocus:dijit._curFocus;return {node:node,bookmark:(node==dijit._curFocus)&&dojo.withGlobal(_a38||dojo.global,dijit.getBookmark),openedForWindow:_a38};},focus:function(_a39){if(!_a39){return;}var node="node" in _a39?_a39.node:_a39,_a3a=_a39.bookmark,_a3b=_a39.openedForWindow,_a3c=_a3a?_a3a.isCollapsed:false;if(node){var _a3d=(node.tagName.toLowerCase()=="iframe")?node.contentWindow:node;if(_a3d&&_a3d.focus){try{_a3d.focus();}catch(e){}}dijit._onFocusNode(node);}if(_a3a&&dojo.withGlobal(_a3b||dojo.global,dijit.isCollapsed)&&!_a3c){if(_a3b){_a3b.focus();}try{dojo.withGlobal(_a3b||dojo.global,dijit.moveToBookmark,null,[_a3a]);}catch(e2){}}},_activeStack:[],registerIframe:function(_a3e){return dijit.registerWin(_a3e.contentWindow,_a3e);},unregisterIframe:function(_a3f){dijit.unregisterWin(_a3f);},registerWin:function(_a40,_a41){var _a42=function(evt){dijit._justMouseDowned=true;setTimeout(function(){dijit._justMouseDowned=false;},0);dijit._onTouchNode(_a41||evt.target||evt.srcElement,"mouse");};var doc=dojo.isIE?_a40.document.documentElement:_a40.document;if(doc){if(dojo.isIE){doc.attachEvent("onmousedown",_a42);var _a43=function(evt){if(evt.srcElement.tagName.toLowerCase()!="#document"&&dijit.isTabNavigable(evt.srcElement)){dijit._onFocusNode(_a41||evt.srcElement);}else{dijit._onTouchNode(_a41||evt.srcElement);}};doc.attachEvent("onactivate",_a43);var _a44=function(evt){dijit._onBlurNode(_a41||evt.srcElement);};doc.attachEvent("ondeactivate",_a44);return function(){doc.detachEvent("onmousedown",_a42);doc.detachEvent("onactivate",_a43);doc.detachEvent("ondeactivate",_a44);doc=null;};}else{doc.addEventListener("mousedown",_a42,true);var _a45=function(evt){dijit._onFocusNode(_a41||evt.target);};doc.addEventListener("focus",_a45,true);var _a46=function(evt){dijit._onBlurNode(_a41||evt.target);};doc.addEventListener("blur",_a46,true);return function(){doc.removeEventListener("mousedown",_a42,true);doc.removeEventListener("focus",_a45,true);doc.removeEventListener("blur",_a46,true);doc=null;};}}},unregisterWin:function(_a47){_a47&&_a47();},_onBlurNode:function(node){dijit._prevFocus=dijit._curFocus;dijit._curFocus=null;if(dijit._justMouseDowned){return;}if(dijit._clearActiveWidgetsTimer){clearTimeout(dijit._clearActiveWidgetsTimer);}dijit._clearActiveWidgetsTimer=setTimeout(function(){delete dijit._clearActiveWidgetsTimer;dijit._setStack([]);dijit._prevFocus=null;},100);},_onTouchNode:function(node,by){if(dijit._clearActiveWidgetsTimer){clearTimeout(dijit._clearActiveWidgetsTimer);delete dijit._clearActiveWidgetsTimer;}var _a48=[];try{while(node){var _a49=dojo.attr(node,"dijitPopupParent");if(_a49){node=dijit.byId(_a49).domNode;}else{if(node.tagName&&node.tagName.toLowerCase()=="body"){if(node===dojo.body()){break;}node=dijit.getDocumentWindow(node.ownerDocument).frameElement;}else{var id=node.getAttribute&&node.getAttribute("widgetId");if(id){_a48.unshift(id);}node=node.parentNode;}}}}catch(e){}dijit._setStack(_a48,by);},_onFocusNode:function(node){if(!node){return;}if(node.nodeType==9){return;}dijit._onTouchNode(node);if(node==dijit._curFocus){return;}if(dijit._curFocus){dijit._prevFocus=dijit._curFocus;}dijit._curFocus=node;dojo.publish("focusNode",[node]);},_setStack:function(_a4a,by){var _a4b=dijit._activeStack;dijit._activeStack=_a4a;for(var _a4c=0;_a4c<Math.min(_a4b.length,_a4a.length);_a4c++){if(_a4b[_a4c]!=_a4a[_a4c]){break;}}var _a4d;for(var i=_a4b.length-1;i>=_a4c;i--){_a4d=dijit.byId(_a4b[i]);if(_a4d){_a4d._focused=false;_a4d._hasBeenBlurred=true;if(_a4d._onBlur){_a4d._onBlur(by);}if(_a4d._setStateClass){_a4d._setStateClass();}dojo.publish("widgetBlur",[_a4d,by]);}}for(i=_a4c;i<_a4a.length;i++){_a4d=dijit.byId(_a4a[i]);if(_a4d){_a4d._focused=true;if(_a4d._onFocus){_a4d._onFocus(by);}if(_a4d._setStateClass){_a4d._setStateClass();}dojo.publish("widgetFocus",[_a4d,by]);}}}});dojo.addOnLoad(function(){var _a4e=dijit.registerWin(window);if(dojo.isIE){dojo.addOnWindowUnload(function(){dijit.unregisterWin(_a4e);_a4e=null;});}});}if(!dojo._hasResource["dojo.AdapterRegistry"]){dojo._hasResource["dojo.AdapterRegistry"]=true;dojo.provide("dojo.AdapterRegistry");dojo.AdapterRegistry=function(_a4f){this.pairs=[];this.returnWrappers=_a4f||false;};dojo.extend(dojo.AdapterRegistry,{register:function(name,_a50,wrap,_a51,_a52){this.pairs[((_a52)?"unshift":"push")]([name,_a50,wrap,_a51]);},match:function(){for(var i=0;i<this.pairs.length;i++){var pair=this.pairs[i];if(pair[1].apply(this,arguments)){if((pair[3])||(this.returnWrappers)){return pair[2];}else{return pair[2].apply(this,arguments);}}}throw new Error("No match found");},unregister:function(name){for(var i=0;i<this.pairs.length;i++){var pair=this.pairs[i];if(pair[0]==name){this.pairs.splice(i,1);return true;}}return false;}});}if(!dojo._hasResource["dijit._base.place"]){dojo._hasResource["dijit._base.place"]=true;dojo.provide("dijit._base.place");dijit.getViewport=function(){var _a53=(dojo.doc.compatMode=="BackCompat")?dojo.body():dojo.doc.documentElement;var _a54=dojo._docScroll();return {w:_a53.clientWidth,h:_a53.clientHeight,l:_a54.x,t:_a54.y};};dijit.placeOnScreen=function(node,pos,_a55,_a56){var _a57=dojo.map(_a55,function(_a58){var c={corner:_a58,pos:{x:pos.x,y:pos.y}};if(_a56){c.pos.x+=_a58.charAt(1)=="L"?_a56.x:-_a56.x;c.pos.y+=_a58.charAt(0)=="T"?_a56.y:-_a56.y;}return c;});return dijit._place(node,_a57);};dijit._place=function(node,_a59,_a5a){var view=dijit.getViewport();if(!node.parentNode||String(node.parentNode.tagName).toLowerCase()!="body"){dojo.body().appendChild(node);}var best=null;dojo.some(_a59,function(_a5b){var _a5c=_a5b.corner;var pos=_a5b.pos;if(_a5a){_a5a(node,_a5b.aroundCorner,_a5c);}var _a5d=node.style;var _a5e=_a5d.display;var _a5f=_a5d.visibility;_a5d.visibility="hidden";_a5d.display="";var mb=dojo.marginBox(node);_a5d.display=_a5e;_a5d.visibility=_a5f;var _a60=Math.max(view.l,_a5c.charAt(1)=="L"?pos.x:(pos.x-mb.w)),_a61=Math.max(view.t,_a5c.charAt(0)=="T"?pos.y:(pos.y-mb.h)),endX=Math.min(view.l+view.w,_a5c.charAt(1)=="L"?(_a60+mb.w):pos.x),endY=Math.min(view.t+view.h,_a5c.charAt(0)=="T"?(_a61+mb.h):pos.y),_a62=endX-_a60,_a63=endY-_a61,_a64=(mb.w-_a62)+(mb.h-_a63);if(best==null||_a64<best.overflow){best={corner:_a5c,aroundCorner:_a5b.aroundCorner,x:_a60,y:_a61,w:_a62,h:_a63,overflow:_a64};}return !_a64;});node.style.left=best.x+"px";node.style.top=best.y+"px";if(best.overflow&&_a5a){_a5a(node,best.aroundCorner,best.corner);}return best;};dijit.placeOnScreenAroundNode=function(node,_a65,_a66,_a67){_a65=dojo.byId(_a65);var _a68=_a65.style.display;_a65.style.display="";var _a69=dojo.position(_a65,true);_a65.style.display=_a68;return dijit._placeOnScreenAroundRect(node,_a69.x,_a69.y,_a69.w,_a69.h,_a66,_a67);};dijit.placeOnScreenAroundRectangle=function(node,_a6a,_a6b,_a6c){return dijit._placeOnScreenAroundRect(node,_a6a.x,_a6a.y,_a6a.width,_a6a.height,_a6b,_a6c);};dijit._placeOnScreenAroundRect=function(node,x,y,_a6d,_a6e,_a6f,_a70){var _a71=[];for(var _a72 in _a6f){_a71.push({aroundCorner:_a72,corner:_a6f[_a72],pos:{x:x+(_a72.charAt(1)=="L"?0:_a6d),y:y+(_a72.charAt(0)=="T"?0:_a6e)}});}return dijit._place(node,_a71,_a70);};dijit.placementRegistry=new dojo.AdapterRegistry();dijit.placementRegistry.register("node",function(n,x){return typeof x=="object"&&typeof x.offsetWidth!="undefined"&&typeof x.offsetHeight!="undefined";},dijit.placeOnScreenAroundNode);dijit.placementRegistry.register("rect",function(n,x){return typeof x=="object"&&"x" in x&&"y" in x&&"width" in x&&"height" in x;},dijit.placeOnScreenAroundRectangle);dijit.placeOnScreenAroundElement=function(node,_a73,_a74,_a75){return dijit.placementRegistry.match.apply(dijit.placementRegistry,arguments);};dijit.getPopupAlignment=function(_a76,_a77){var _a78={};dojo.forEach(_a76,function(pos){switch(pos){case "after":_a78[_a77?"BR":"BL"]=_a77?"BL":"BR";break;case "before":_a78[_a77?"BL":"BR"]=_a77?"BR":"BL";break;case "below":_a78[_a77?"BL":"BR"]=_a77?"TL":"TR";_a78[_a77?"BR":"BL"]=_a77?"TR":"TL";break;case "above":default:_a78[_a77?"TL":"TR"]=_a77?"BL":"BR";_a78[_a77?"TR":"TL"]=_a77?"BR":"BL";break;}});return _a78;};dijit.getPopupAroundAlignment=function(_a79,_a7a){var _a7b={};dojo.forEach(_a79,function(pos){switch(pos){case "after":_a7b[_a7a?"BR":"BL"]=_a7a?"BL":"BR";break;case "before":_a7b[_a7a?"BL":"BR"]=_a7a?"BR":"BL";break;case "below":_a7b[_a7a?"BL":"BR"]=_a7a?"TL":"TR";_a7b[_a7a?"BR":"BL"]=_a7a?"TR":"TL";break;case "above":default:_a7b[_a7a?"TL":"TR"]=_a7a?"BL":"BR";_a7b[_a7a?"TR":"TL"]=_a7a?"BR":"BL";break;}});return _a7b;};}if(!dojo._hasResource["dijit._base.window"]){dojo._hasResource["dijit._base.window"]=true;dojo.provide("dijit._base.window");dijit.getDocumentWindow=function(doc){if(dojo.isIE&&window!==document.parentWindow&&!doc._parentWindow){doc.parentWindow.execScript("document._parentWindow = window;","Javascript");var win=doc._parentWindow;doc._parentWindow=null;return win;}return doc._parentWindow||doc.parentWindow||doc.defaultView;};}if(!dojo._hasResource["dijit._base.popup"]){dojo._hasResource["dijit._base.popup"]=true;dojo.provide("dijit._base.popup");dijit.popup=new function(){var _a7c=[],_a7d=1000,_a7e=1;this.moveOffScreen=function(node){var s=node.style;s.visibility="hidden";s.position="absolute";s.top="-9999px";if(s.display=="none"){s.display="";}dojo.body().appendChild(node);};var _a7f=function(){for(var pi=_a7c.length-1;pi>0&&_a7c[pi].parent===_a7c[pi-1].widget;pi--){}return _a7c[pi];};var _a80=[];this.open=function(args){var _a81=args.popup,_a82=args.orient||(dojo._isBodyLtr()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"}),_a83=args.around,id=(args.around&&args.around.id)?(args.around.id+"_dropdown"):("popup_"+_a7e++);var _a84=_a80.pop(),_a85,_a86;if(!_a84){_a85=dojo.create("div",{"class":"dijitPopup"},dojo.body());dijit.setWaiRole(_a85,"presentation");}else{_a85=_a84[0];_a86=_a84[1];}dojo.attr(_a85,{id:id,style:{zIndex:_a7d+_a7c.length,visibility:"hidden",top:"-9999px"},dijitPopupParent:args.parent?args.parent.id:""});var s=_a81.domNode.style;s.display="";s.visibility="";s.position="";s.top="0px";_a85.appendChild(_a81.domNode);if(!_a86){_a86=new dijit.BackgroundIframe(_a85);}else{_a86.resize(_a85);}var best=_a83?dijit.placeOnScreenAroundElement(_a85,_a83,_a82,_a81.orient?dojo.hitch(_a81,"orient"):null):dijit.placeOnScreen(_a85,args,_a82=="R"?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],args.padding);_a85.style.visibility="visible";var _a87=[];_a87.push(dojo.connect(_a85,"onkeypress",this,function(evt){if(evt.charOrCode==dojo.keys.ESCAPE&&args.onCancel){dojo.stopEvent(evt);args.onCancel();}else{if(evt.charOrCode===dojo.keys.TAB){dojo.stopEvent(evt);var _a88=_a7f();if(_a88&&_a88.onCancel){_a88.onCancel();}}}}));if(_a81.onCancel){_a87.push(dojo.connect(_a81,"onCancel",args.onCancel));}_a87.push(dojo.connect(_a81,_a81.onExecute?"onExecute":"onChange",function(){var _a89=_a7f();if(_a89&&_a89.onExecute){_a89.onExecute();}}));_a7c.push({wrapper:_a85,iframe:_a86,widget:_a81,parent:args.parent,onExecute:args.onExecute,onCancel:args.onCancel,onClose:args.onClose,handlers:_a87});if(_a81.onOpen){_a81.onOpen(best);}return best;};this.close=function(_a8a){while(dojo.some(_a7c,function(elem){return elem.widget==_a8a;})){var top=_a7c.pop(),_a8b=top.wrapper,_a8c=top.iframe,_a8d=top.widget,_a8e=top.onClose;if(_a8d.onClose){_a8d.onClose();}dojo.forEach(top.handlers,dojo.disconnect);if(_a8d&&_a8d.domNode){this.moveOffScreen(_a8d.domNode);}_a8b.style.top="-9999px";_a8b.style.visibility="hidden";_a80.push([_a8b,_a8c]);if(_a8e){_a8e();}}};}();dijit._frames=new function(){var _a8f=[];this.pop=function(){var _a90;if(_a8f.length){_a90=_a8f.pop();_a90.style.display="";}else{if(dojo.isIE<9){var burl=dojo.config["dojoBlankHtmlUrl"]||(dojo.moduleUrl("dojo","resources/blank.html")+"")||"javascript:\"\"";var html="<iframe src='"+burl+"'"+" style='position: absolute; left: 0px; top: 0px;"+"z-index: -1; filter:Alpha(Opacity=\"0\");'>";_a90=dojo.doc.createElement(html);}else{_a90=dojo.create("iframe");_a90.src="javascript:\"\"";_a90.className="dijitBackgroundIframe";dojo.style(_a90,"opacity",0.1);}_a90.tabIndex=-1;}return _a90;};this.push=function(_a91){_a91.style.display="none";_a8f.push(_a91);};}();dijit.BackgroundIframe=function(node){if(!node.id){throw new Error("no id");}if(dojo.isIE||dojo.isMoz){var _a92=dijit._frames.pop();node.appendChild(_a92);if(dojo.isIE<7){this.resize(node);this._conn=dojo.connect(node,"onresize",this,function(){this.resize(node);});}else{dojo.style(_a92,{width:"100%",height:"100%"});}this.iframe=_a92;}};dojo.extend(dijit.BackgroundIframe,{resize:function(node){if(this.iframe&&dojo.isIE<7){dojo.style(this.iframe,{width:node.offsetWidth+"px",height:node.offsetHeight+"px"});}},destroy:function(){if(this._conn){dojo.disconnect(this._conn);this._conn=null;}if(this.iframe){dijit._frames.push(this.iframe);delete this.iframe;}}});}if(!dojo._hasResource["dijit._base.scroll"]){dojo._hasResource["dijit._base.scroll"]=true;dojo.provide("dijit._base.scroll");dijit.scrollIntoView=function(node,pos){try{node=dojo.byId(node);var doc=node.ownerDocument||dojo.doc,body=doc.body||dojo.body(),html=doc.documentElement||body.parentNode,isIE=dojo.isIE,isWK=dojo.isWebKit;if((!(dojo.isMoz||isIE||isWK||dojo.isOpera)||node==body||node==html)&&(typeof node.scrollIntoView!="undefined")){node.scrollIntoView(false);return;}var _a93=doc.compatMode=="BackCompat",_a94=(isIE>=9&&node.ownerDocument.parentWindow.frameElement)?((html.clientHeight>0&&html.clientWidth>0&&(body.clientHeight==0||body.clientWidth==0||body.clientHeight>html.clientHeight||body.clientWidth>html.clientWidth))?html:body):(_a93?body:html),_a95=isWK?body:_a94,_a96=_a94.clientWidth,_a97=_a94.clientHeight,rtl=!dojo._isBodyLtr(),_a98=pos||dojo.position(node),el=node.parentNode,_a99=function(el){return ((isIE<=6||(isIE&&_a93))?false:(dojo.style(el,"position").toLowerCase()=="fixed"));};if(_a99(node)){return;}while(el){if(el==body){el=_a95;}var _a9a=dojo.position(el),_a9b=_a99(el);if(el==_a95){_a9a.w=_a96;_a9a.h=_a97;if(_a95==html&&isIE&&rtl){_a9a.x+=_a95.offsetWidth-_a9a.w;}if(_a9a.x<0||!isIE){_a9a.x=0;}if(_a9a.y<0||!isIE){_a9a.y=0;}}else{var pb=dojo._getPadBorderExtents(el);_a9a.w-=pb.w;_a9a.h-=pb.h;_a9a.x+=pb.l;_a9a.y+=pb.t;var _a9c=el.clientWidth,_a9d=_a9a.w-_a9c;if(_a9c>0&&_a9d>0){_a9a.w=_a9c;_a9a.x+=(rtl&&(isIE||el.clientLeft>pb.l))?_a9d:0;}_a9c=el.clientHeight;_a9d=_a9a.h-_a9c;if(_a9c>0&&_a9d>0){_a9a.h=_a9c;}}if(_a9b){if(_a9a.y<0){_a9a.h+=_a9a.y;_a9a.y=0;}if(_a9a.x<0){_a9a.w+=_a9a.x;_a9a.x=0;}if(_a9a.y+_a9a.h>_a97){_a9a.h=_a97-_a9a.y;}if(_a9a.x+_a9a.w>_a96){_a9a.w=_a96-_a9a.x;}}var l=_a98.x-_a9a.x,t=_a98.y-Math.max(_a9a.y,0),r=l+_a98.w-_a9a.w,bot=t+_a98.h-_a9a.h;if(r*l>0){var s=Math[l<0?"max":"min"](l,r);if(rtl&&((isIE==8&&!_a93)||isIE>=9)){s=-s;}_a98.x+=el.scrollLeft;el.scrollLeft+=s;_a98.x-=el.scrollLeft;}if(bot*t>0){_a98.y+=el.scrollTop;el.scrollTop+=Math[t<0?"max":"min"](t,bot);_a98.y-=el.scrollTop;}el=(el!=_a95)&&!_a9b&&el.parentNode;}}catch(error){console.error("scrollIntoView: "+error);node.scrollIntoView(false);}};}if(!dojo._hasResource["dijit._base.sniff"]){dojo._hasResource["dijit._base.sniff"]=true;dojo.provide("dijit._base.sniff");(function(){var d=dojo,html=d.doc.documentElement,ie=d.isIE,_a9e=d.isOpera,maj=Math.floor,ff=d.isFF,_a9f=d.boxModel.replace(/-/,""),_aa0={dj_ie:ie,dj_ie6:maj(ie)==6,dj_ie7:maj(ie)==7,dj_ie8:maj(ie)==8,dj_ie9:maj(ie)==9,dj_iequirks:ie&&d.isQuirks,dj_opera:_a9e,dj_khtml:d.isKhtml,dj_webkit:d.isWebKit,dj_safari:d.isSafari,dj_chrome:d.isChrome,dj_gecko:d.isMozilla,dj_ff3:maj(ff)==3};_aa0["dj_"+_a9f]=true;for(var p in _aa0){if(_aa0[p]){if(html.className){html.className+=" "+p;}else{html.className=p;}}}dojo._loaders.unshift(function(){if(!dojo._isBodyLtr()){html.className+=" dijitRtl";for(var p in _aa0){if(_aa0[p]){html.className+=" "+p+"-rtl";}}}});})();}if(!dojo._hasResource["dijit._base.typematic"]){dojo._hasResource["dijit._base.typematic"]=true;dojo.provide("dijit._base.typematic");dijit.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(this._currentTimeout<0?this._initialDelay:(this._subsequentDelay>1?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay)),10);this._timer=setTimeout(dojo.hitch(this,"_fireEventAndReload"),this._currentTimeout);},trigger:function(evt,_aa1,node,_aa2,obj,_aa3,_aa4){if(obj!=this._obj){this.stop();this._initialDelay=_aa4||500;this._subsequentDelay=_aa3||0.9;this._obj=obj;this._evt=evt;this._node=node;this._currentTimeout=-1;this._count=-1;this._callback=dojo.hitch(_aa1,_aa2);this._fireEventAndReload();}},stop:function(){if(this._timer){clearTimeout(this._timer);this._timer=null;}if(this._obj){this._callback(-1,this._node,this._evt);this._obj=null;}},addKeyListener:function(node,_aa5,_aa6,_aa7,_aa8,_aa9){if(_aa5.keyCode){_aa5.charOrCode=_aa5.keyCode;dojo.deprecated("keyCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}else{if(_aa5.charCode){_aa5.charOrCode=String.fromCharCode(_aa5.charCode);dojo.deprecated("charCode attribute parameter for dijit.typematic.addKeyListener is deprecated. Use charOrCode instead.","","2.0");}}return [dojo.connect(node,"onkeypress",this,function(evt){if(evt.charOrCode==_aa5.charOrCode&&(_aa5.ctrlKey===undefined||_aa5.ctrlKey==evt.ctrlKey)&&(_aa5.altKey===undefined||_aa5.altKey==evt.altKey)&&(_aa5.metaKey===undefined||_aa5.metaKey==(evt.metaKey||false))&&(_aa5.shiftKey===undefined||_aa5.shiftKey==evt.shiftKey)){dojo.stopEvent(evt);dijit.typematic.trigger(_aa5,_aa6,node,_aa7,_aa5,_aa8,_aa9);}else{if(dijit.typematic._obj==_aa5){dijit.typematic.stop();}}}),dojo.connect(node,"onkeyup",this,function(evt){if(dijit.typematic._obj==_aa5){dijit.typematic.stop();}})];},addMouseListener:function(node,_aaa,_aab,_aac,_aad){var dc=dojo.connect;return [dc(node,"mousedown",this,function(evt){dojo.stopEvent(evt);dijit.typematic.trigger(evt,_aaa,node,_aab,node,_aac,_aad);}),dc(node,"mouseup",this,function(evt){dojo.stopEvent(evt);dijit.typematic.stop();}),dc(node,"mouseout",this,function(evt){dojo.stopEvent(evt);dijit.typematic.stop();}),dc(node,"mousemove",this,function(evt){dojo.stopEvent(evt);}),dc(node,"dblclick",this,function(evt){dojo.stopEvent(evt);if(dojo.isIE){dijit.typematic.trigger(evt,_aaa,node,_aab,node,_aac,_aad);setTimeout(dojo.hitch(this,dijit.typematic.stop),50);}})];},addListener:function(_aae,_aaf,_ab0,_ab1,_ab2,_ab3,_ab4){return this.addKeyListener(_aaf,_ab0,_ab1,_ab2,_ab3,_ab4).concat(this.addMouseListener(_aae,_ab1,_ab2,_ab3,_ab4));}};}if(!dojo._hasResource["dijit._base.wai"]){dojo._hasResource["dijit._base.wai"]=true;dojo.provide("dijit._base.wai");dijit.wai={onload:function(){var div=dojo.create("div",{id:"a11yTestNode",style:{cssText:"border: 1px solid;"+"border-color:red green;"+"position: absolute;"+"height: 5px;"+"top: -999px;"+"background-image: url(\""+(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif"))+"\");"}},dojo.body());var cs=dojo.getComputedStyle(div);if(cs){var _ab5=cs.backgroundImage;var _ab6=(cs.borderTopColor==cs.borderRightColor)||(_ab5!=null&&(_ab5=="none"||_ab5=="url(invalid-url:)"));dojo[_ab6?"addClass":"removeClass"](dojo.body(),"dijit_a11y");if(dojo.isIE){div.outerHTML="";}else{dojo.body().removeChild(div);}}}};if(dojo.isIE||dojo.isMoz){dojo._loaders.unshift(dijit.wai.onload);}dojo.mixin(dijit,{_XhtmlRoles:/banner|contentinfo|definition|main|navigation|search|note|secondary|seealso/,hasWaiRole:function(elem,role){var _ab7=this.getWaiRole(elem);return role?(_ab7.indexOf(role)>-1):(_ab7.length>0);},getWaiRole:function(elem){return dojo.trim((dojo.attr(elem,"role")||"").replace(this._XhtmlRoles,"").replace("wairole:",""));},setWaiRole:function(elem,role){var _ab8=dojo.attr(elem,"role")||"";if(!this._XhtmlRoles.test(_ab8)){dojo.attr(elem,"role",role);}else{if((" "+_ab8+" ").indexOf(" "+role+" ")<0){var _ab9=dojo.trim(_ab8.replace(this._XhtmlRoles,""));var _aba=dojo.trim(_ab8.replace(_ab9,""));dojo.attr(elem,"role",_aba+(_aba?" ":"")+role);}}},removeWaiRole:function(elem,role){var _abb=dojo.attr(elem,"role");if(!_abb){return;}if(role){var t=dojo.trim((" "+_abb+" ").replace(" "+role+" "," "));dojo.attr(elem,"role",t);}else{elem.removeAttribute("role");}},hasWaiState:function(elem,_abc){return elem.hasAttribute?elem.hasAttribute("aria-"+_abc):!!elem.getAttribute("aria-"+_abc);},getWaiState:function(elem,_abd){return elem.getAttribute("aria-"+_abd)||"";},setWaiState:function(elem,_abe,_abf){elem.setAttribute("aria-"+_abe,_abf);},removeWaiState:function(elem,_ac0){elem.removeAttribute("aria-"+_ac0);}});}if(!dojo._hasResource["dijit._base"]){dojo._hasResource["dijit._base"]=true;dojo.provide("dijit._base");}if(!dojo._hasResource["dijit._Widget"]){dojo._hasResource["dijit._Widget"]=true;dojo.provide("dijit._Widget");dojo.require("dijit._base");dojo.connect(dojo,"_connect",function(_ac1,_ac2){if(_ac1&&dojo.isFunction(_ac1._onConnect)){_ac1._onConnect(_ac2);}});dijit._connectOnUseEventHandler=function(_ac3){};dijit._lastKeyDownNode=null;if(dojo.isIE){(function(){var _ac4=function(evt){dijit._lastKeyDownNode=evt.srcElement;};dojo.doc.attachEvent("onkeydown",_ac4);dojo.addOnWindowUnload(function(){dojo.doc.detachEvent("onkeydown",_ac4);});})();}else{dojo.doc.addEventListener("keydown",function(evt){dijit._lastKeyDownNode=evt.target;},true);}(function(){var _ac5={},_ac6=function(_ac7){var dc=_ac7.declaredClass;if(!_ac5[dc]){var r=[],_ac8,_ac9=_ac7.constructor.prototype;for(var _aca in _ac9){if(dojo.isFunction(_ac9[_aca])&&(_ac8=_aca.match(/^_set([a-zA-Z]*)Attr$/))&&_ac8[1]){r.push(_ac8[1].charAt(0).toLowerCase()+_ac8[1].substr(1));}}_ac5[dc]=r;}return _ac5[dc]||[];};dojo.declare("dijit._Widget",null,{id:"",lang:"",dir:"","class":"",style:"",title:"",tooltip:"",srcNodeRef:null,domNode:null,containerNode:null,attributeMap:{id:"",dir:"",lang:"","class":"",style:"",title:""},_deferredConnects:{onClick:"",onDblClick:"",onKeyDown:"",onKeyPress:"",onKeyUp:"",onMouseMove:"",onMouseDown:"",onMouseOut:"",onMouseOver:"",onMouseLeave:"",onMouseEnter:"",onMouseUp:""},onClick:dijit._connectOnUseEventHandler,onDblClick:dijit._connectOnUseEventHandler,onKeyDown:dijit._connectOnUseEventHandler,onKeyPress:dijit._connectOnUseEventHandler,onKeyUp:dijit._connectOnUseEventHandler,onMouseDown:dijit._connectOnUseEventHandler,onMouseMove:dijit._connectOnUseEventHandler,onMouseOut:dijit._connectOnUseEventHandler,onMouseOver:dijit._connectOnUseEventHandler,onMouseLeave:dijit._connectOnUseEventHandler,onMouseEnter:dijit._connectOnUseEventHandler,onMouseUp:dijit._connectOnUseEventHandler,_blankGif:(dojo.config.blankGif||dojo.moduleUrl("dojo","resources/blank.gif")).toString(),postscript:function(_acb,_acc){this.create(_acb,_acc);},create:function(_acd,_ace){this.srcNodeRef=dojo.byId(_ace);this._connects=[];this._subscribes=[];this._deferredConnects=dojo.clone(this._deferredConnects);for(var attr in this.attributeMap){delete this._deferredConnects[attr];}for(attr in this._deferredConnects){if(this[attr]!==dijit._connectOnUseEventHandler){delete this._deferredConnects[attr];}}if(this.srcNodeRef&&(typeof this.srcNodeRef.id=="string")){this.id=this.srcNodeRef.id;}if(_acd){this.params=_acd;dojo.mixin(this,_acd);}this.postMixInProperties();if(!this.id){this.id=dijit.getUniqueId(this.declaredClass.replace(/\./g,"_"));}dijit.registry.add(this);this.buildRendering();if(this.domNode){this._applyAttributes();var _acf=this.srcNodeRef;if(_acf&&_acf.parentNode){_acf.parentNode.replaceChild(this.domNode,_acf);}for(attr in this.params){this._onConnect(attr);}}if(this.domNode){this.domNode.setAttribute("widgetId",this.id);}this.postCreate();if(this.srcNodeRef&&!this.srcNodeRef.parentNode){delete this.srcNodeRef;}this._created=true;},_applyAttributes:function(){var _ad0=function(attr,_ad1){if((_ad1.params&&attr in _ad1.params)||_ad1[attr]){_ad1.attr(attr,_ad1[attr]);}};for(var attr in this.attributeMap){_ad0(attr,this);}dojo.forEach(_ac6(this),function(a){if(!(a in this.attributeMap)){_ad0(a,this);}},this);},postMixInProperties:function(){},buildRendering:function(){this.domNode=this.srcNodeRef||dojo.create("div");},postCreate:function(){},startup:function(){this._started=true;},destroyRecursive:function(_ad2){this._beingDestroyed=true;this.destroyDescendants(_ad2);this.destroy(_ad2);},destroy:function(_ad3){this._beingDestroyed=true;this.uninitialize();var d=dojo,dfe=d.forEach,dun=d.unsubscribe;dfe(this._connects,function(_ad4){dfe(_ad4,d.disconnect);});dfe(this._subscribes,function(_ad5){dun(_ad5);});dfe(this._supportingWidgets||[],function(w){if(w.destroyRecursive){w.destroyRecursive();}else{if(w.destroy){w.destroy();}}});this.destroyRendering(_ad3);dijit.registry.remove(this.id);this._destroyed=true;},destroyRendering:function(_ad6){if(this.bgIframe){this.bgIframe.destroy(_ad6);delete this.bgIframe;}if(this.domNode){if(_ad6){dojo.removeAttr(this.domNode,"widgetId");}else{dojo.destroy(this.domNode);}delete this.domNode;}if(this.srcNodeRef){if(!_ad6){dojo.destroy(this.srcNodeRef);}delete this.srcNodeRef;}},destroyDescendants:function(_ad7){dojo.forEach(this.getChildren(),function(_ad8){if(_ad8.destroyRecursive){_ad8.destroyRecursive(_ad7);}});},uninitialize:function(){return false;},onFocus:function(){},onBlur:function(){},_onFocus:function(e){this.onFocus();},_onBlur:function(){this.onBlur();},_onConnect:function(_ad9){if(_ad9 in this._deferredConnects){var _ada=this[this._deferredConnects[_ad9]||"domNode"];this.connect(_ada,_ad9.toLowerCase(),_ad9);delete this._deferredConnects[_ad9];}},_setClassAttr:function(_adb){var _adc=this[this.attributeMap["class"]||"domNode"];dojo.removeClass(_adc,this["class"]);this["class"]=_adb;dojo.addClass(_adc,_adb);},_setStyleAttr:function(_add){var _ade=this[this.attributeMap.style||"domNode"];if(dojo.isObject(_add)){dojo.style(_ade,_add);}else{if(_ade.style.cssText){_ade.style.cssText+="; "+_add;}else{_ade.style.cssText=_add;}}this.style=_add;},setAttribute:function(attr,_adf){dojo.deprecated(this.declaredClass+"::setAttribute() is deprecated. Use attr() instead.","","2.0");this.attr(attr,_adf);},_attrToDom:function(attr,_ae0){var _ae1=this.attributeMap[attr];dojo.forEach(dojo.isArray(_ae1)?_ae1:[_ae1],function(_ae2){var _ae3=this[_ae2.node||_ae2||"domNode"];var type=_ae2.type||"attribute";switch(type){case "attribute":if(dojo.isFunction(_ae0)){_ae0=dojo.hitch(this,_ae0);}var _ae4=_ae2.attribute?_ae2.attribute:(/^on[A-Z][a-zA-Z]*$/.test(attr)?attr.toLowerCase():attr);dojo.attr(_ae3,_ae4,_ae0);break;case "innerText":_ae3.innerHTML="";_ae3.appendChild(dojo.doc.createTextNode(_ae0));break;case "innerHTML":_ae3.innerHTML=_ae0;break;case "class":dojo.removeClass(_ae3,this[attr]);dojo.addClass(_ae3,_ae0);break;}},this);this[attr]=_ae0;},attr:function(name,_ae5){var args=arguments.length;if(args==1&&!dojo.isString(name)){for(var x in name){this.attr(x,name[x]);}return this;}var _ae6=this._getAttrNames(name);if(args>=2){if(this[_ae6.s]){args=dojo._toArray(arguments,1);return this[_ae6.s].apply(this,args)||this;}else{if(name in this.attributeMap){this._attrToDom(name,_ae5);}this[name]=_ae5;}return this;}else{return this[_ae6.g]?this[_ae6.g]():this[name];}},_attrPairNames:{},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={n:name+"Node",s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},toString:function(){return "[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]";},getDescendants:function(){return this.containerNode?dojo.query("[widgetId]",this.containerNode).map(dijit.byNode):[];},getChildren:function(){return this.containerNode?dijit.findWidgets(this.containerNode):[];},nodesWithKeyClick:["input","button"],connect:function(obj,_ae7,_ae8){var d=dojo,dc=d._connect,_ae9=[];if(_ae7=="ondijitclick"){if(!this.nodesWithKeyClick[obj.tagName.toLowerCase()]){var m=d.hitch(this,_ae8);_ae9.push(dc(obj,"onkeydown",this,function(e){if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){dijit._lastKeyDownNode=e.target;d.stopEvent(e);}}),dc(obj,"onkeyup",this,function(e){if((e.keyCode==d.keys.ENTER||e.keyCode==d.keys.SPACE)&&e.target===dijit._lastKeyDownNode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey){dijit._lastKeyDownNode=null;return m(e);}}));}_ae7="onclick";}_ae9.push(dc(obj,_ae7,this,_ae8));this._connects.push(_ae9);return _ae9;},disconnect:function(_aea){for(var i=0;i<this._connects.length;i++){if(this._connects[i]==_aea){dojo.forEach(_aea,dojo.disconnect);this._connects.splice(i,1);return;}}},subscribe:function(_aeb,_aec){var d=dojo,_aed=d.subscribe(_aeb,this,_aec);this._subscribes.push(_aed);return _aed;},unsubscribe:function(_aee){for(var i=0;i<this._subscribes.length;i++){if(this._subscribes[i]==_aee){dojo.unsubscribe(_aee);this._subscribes.splice(i,1);return;}}},isLeftToRight:function(){return dojo._isBodyLtr();},isFocusable:function(){return this.focus&&(dojo.style(this.domNode,"display")!="none");},placeAt:function(_aef,_af0){if(_aef.declaredClass&&_aef.addChild){_aef.addChild(this,_af0);}else{dojo.place(this.domNode,_aef,_af0);}return this;},_onShow:function(){this.onShow();},onShow:function(){},onHide:function(){}});})();}if(!dojo._hasResource["dojo.cache"]){dojo._hasResource["dojo.cache"]=true;dojo.provide("dojo.cache");(function(){var _af1={};dojo.cache=function(_af2,url,_af3){if(typeof _af2=="string"){var _af4=dojo.moduleUrl(_af2,url);}else{_af4=_af2;_af3=url;}var key=_af4.toString();var val=_af3;if(_af3!==undefined&&!dojo.isString(_af3)){val=("value" in _af3?_af3.value:undefined);}var _af5=_af3&&_af3.sanitize?true:false;if(val||val===null){if(val==null){delete _af1[key];}else{val=_af1[key]=_af5?dojo.cache._sanitize(val):val;}}else{if(!(key in _af1)){val=dojo._getText(key);_af1[key]=_af5?dojo.cache._sanitize(val):val;}val=_af1[key];}return val;};dojo.cache._sanitize=function(val){if(val){val=val.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var _af6=val.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(_af6){val=_af6[1];}}else{val="";}return val;};})();}if(!dojo._hasResource["dijit._Templated"]){dojo._hasResource["dijit._Templated"]=true;dojo.provide("dijit._Templated");dojo.declare("dijit._Templated",null,{templateString:null,templatePath:null,widgetsInTemplate:false,_skipNodeCache:false,_earlyTemplatedStartup:false,constructor:function(){this._attachPoints=[];},_stringRepl:function(tmpl){var _af7=this.declaredClass,_af8=this;return dojo.string.substitute(tmpl,this,function(_af9,key){if(key.charAt(0)=="!"){_af9=dojo.getObject(key.substr(1),false,_af8);}if(typeof _af9=="undefined"){throw new Error(_af7+" template:"+key);}if(_af9==null){return "";}return key.charAt(0)=="!"?_af9:_af9.toString().replace(/"/g,"&quot;");},this);},buildRendering:function(){var _afa=dijit._Templated.getCachedTemplate(this.templatePath,this.templateString,this._skipNodeCache);var node;if(dojo.isString(_afa)){node=dojo._toDom(this._stringRepl(_afa));if(node.nodeType!=1){throw new Error("Invalid template: "+_afa);}}else{node=_afa.cloneNode(true);}this.domNode=node;this._attachTemplateNodes(node);if(this.widgetsInTemplate){var _afb=dojo.parser,qry,attr;if(_afb._query!="[dojoType]"){qry=_afb._query;attr=_afb._attrName;_afb._query="[dojoType]";_afb._attrName="dojoType";}var cw=(this._startupWidgets=dojo.parser.parse(node,{noStart:!this._earlyTemplatedStartup}));if(qry){_afb._query=qry;_afb._attrName=attr;}this._supportingWidgets=dijit.findWidgets(node);this._attachTemplateNodes(cw,function(n,p){return n[p];});}this._fillContent(this.srcNodeRef);},_fillContent:function(_afc){var dest=this.containerNode;if(_afc&&dest){while(_afc.hasChildNodes()){dest.appendChild(_afc.firstChild);}}},_attachTemplateNodes:function(_afd,_afe){_afe=_afe||function(n,p){return n.getAttribute(p);};var _aff=dojo.isArray(_afd)?_afd:(_afd.all||_afd.getElementsByTagName("*"));var x=dojo.isArray(_afd)?0:-1;for(;x<_aff.length;x++){var _b00=(x==-1)?_afd:_aff[x];if(this.widgetsInTemplate&&_afe(_b00,"dojoType")){continue;}var _b01=_afe(_b00,"dojoAttachPoint");if(_b01){var _b02,_b03=_b01.split(/\s*,\s*/);while((_b02=_b03.shift())){if(dojo.isArray(this[_b02])){this[_b02].push(_b00);}else{this[_b02]=_b00;}this._attachPoints.push(_b02);}}var _b04=_afe(_b00,"dojoAttachEvent");if(_b04){var _b05,_b06=_b04.split(/\s*,\s*/);var trim=dojo.trim;while((_b05=_b06.shift())){if(_b05){var _b07=null;if(_b05.indexOf(":")!=-1){var _b08=_b05.split(":");_b05=trim(_b08[0]);_b07=trim(_b08[1]);}else{_b05=trim(_b05);}if(!_b07){_b07=_b05;}this.connect(_b00,_b05,_b07);}}}var role=_afe(_b00,"waiRole");if(role){dijit.setWaiRole(_b00,role);}var _b09=_afe(_b00,"waiState");if(_b09){dojo.forEach(_b09.split(/\s*,\s*/),function(_b0a){if(_b0a.indexOf("-")!=-1){var pair=_b0a.split("-");dijit.setWaiState(_b00,pair[0],pair[1]);}});}}},startup:function(){dojo.forEach(this._startupWidgets,function(w){if(w&&!w._started&&w.startup){w.startup();}});this.inherited(arguments);},destroyRendering:function(){dojo.forEach(this._attachPoints,function(_b0b){delete this[_b0b];},this);this._attachPoints=[];this.inherited(arguments);}});dijit._Templated._templateCache={};dijit._Templated.getCachedTemplate=function(_b0c,_b0d,_b0e){var _b0f=dijit._Templated._templateCache;var key=_b0d||_b0c;var _b10=_b0f[key];if(_b10){try{if(!_b10.ownerDocument||_b10.ownerDocument==dojo.doc){return _b10;}}catch(e){}dojo.destroy(_b10);}if(!_b0d){_b0d=dojo.cache(_b0c,{sanitize:true});}_b0d=dojo.string.trim(_b0d);if(_b0e||_b0d.match(/\$\{([^\}]+)\}/g)){return (_b0f[key]=_b0d);}else{var node=dojo._toDom(_b0d);if(node.nodeType!=1){throw new Error("Invalid template: "+_b0d);}return (_b0f[key]=node);}};if(dojo.isIE){dojo.addOnWindowUnload(function(){var _b11=dijit._Templated._templateCache;for(var key in _b11){var _b12=_b11[key];if(typeof _b12=="object"){dojo.destroy(_b12);}delete _b11[key];}});}dojo.extend(dijit._Widget,{dojoAttachEvent:"",dojoAttachPoint:"",waiRole:"",waiState:""});}if(!dojo._hasResource["com.ibm.mm.enabler.layout.LayoutContainerImpl"]){dojo._hasResource["com.ibm.mm.enabler.layout.LayoutContainerImpl"]=true;dojo.provide("com.ibm.mm.enabler.layout.LayoutContainerImpl");dojo.declare("com.ibm.mm.enabler.layout.LayoutContainerImpl",[com.ibm.mashups.enabler.layout.LayoutContainer,com.ibm.mm.enabler.layout.LayoutNodeImpl,com.ibm.mashups.enabler.content.RuntimeContentProvider],{constructor:function(){this._type=com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTAINER;},_getContent:function(){return this._getLayoutModel()._getNavigationNode().getContent().start(true);},getRuntimeContent:function(){return new com.ibm.mm.enabler.content.RuntimeContentImpl(this,this._getRuntimeMarkup);},_templateFunc:function(_b13,sync,_b14){var ret=null;var _b15=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout","templates/LayoutContainerFragment.html"));ret=dojo.string.substitute(_b15,{containerClass:"",containerId:com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this),containerName:"",childrenMarkup:_b14||""});if(_b13){_b13.finish(ret,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return ret;},_getRuntimeMarkup:function(_b16,sync){var _b17=new com.ibm.mm.enabler.DeferredSet();if(this._getLayoutModel().hasChildren(this)){var _b18=this._getLayoutModel().getChildren(this);while(_b18.hasNext()){var _b19=_b18.next();var _b1a=_b19.getRuntimeContent().getRuntimeMarkup();_b17.addDeferred(_b1a);}}_b17.setFinishedCallback(dojo.hitch(this,function(_b1b,_b1c,args){var ret=null;var _b1d=args.origDf;if(_b1c==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){var _b1e=[];_b1b.forEach(function(item,idx,arr){this.push(item.result);},_b1e);ret=this._templateFunc(_b1d,sync,_b1e.join("\n"));}else{if(_b1d){_b1d.finish(null,_b1c);}}return ret;}),{origDf:_b16});_b17.start(sync);},getLayoutNodeType:function(){return this._type;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutContainer"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutContainer"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutContainer");}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutControl_API"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutControl_API"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutControl_API");dojo.provide("com.ibm.mashups.enabler.layout.LayoutControl");dojo.declare("com.ibm.mashups.enabler.layout.LayoutControl",[com.ibm.mashups.enabler.layout.LayoutNode,com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mashups.enabler.content.RuntimeContentProvider],{getSkin:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.layout.LayoutControl.getSkin");},setSkin:function(id){throw new Error("Unimplemented API: com.ibm.mashups.enabler.layout.LayoutControl.setSkin");}});}if(!dojo._hasResource["com.ibm.mm.enabler.IdentifierImpl"]){dojo._hasResource["com.ibm.mm.enabler.IdentifierImpl"]=true;dojo.provide("com.ibm.mm.enabler.IdentifierImpl");dojo.declare("com.ibm.mm.enabler.IdentifierImpl",com.ibm.mm.enabler.IdentifiableImpl,{_id:null,_params:null,constructor:function(id,_b1f){if(dojo.isString(id)){this._id=id;}else{this.xmlData=id;}this._params=_b1f;},setID:function(id){if(this._id){this._id=id;}else{this.inherited(arguments);}},getID:function(){return this._id?com.ibm.mm.enabler.IdentifiableHelper.getID(this._id):this.inherited(arguments);},_getParameters:function(){return this._params;},_getRawID:function(){return this._id?this._id:this.inherited(arguments);},_setRawID:function(id){if(!this._id){var _b20=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.ATOM_ID,this.xmlData,this.id_ns);if(_b20){com.ibm.mm.enabler.utils.Dom.textContent(_b20,id);}}}});}if(!dojo._hasResource["com.ibm.mm.enabler.layout.SkinIdentifiable"]){dojo._hasResource["com.ibm.mm.enabler.layout.SkinIdentifiable"]=true;dojo.provide("com.ibm.mm.enabler.layout.SkinIdentifiable");dojo.declare("com.ibm.mm.enabler.layout.SkinIdentifiable",com.ibm.mm.enabler.IdentifierImpl,{});}if(!dojo._hasResource["dojox.collections.Dictionary"]){dojo._hasResource["dojox.collections.Dictionary"]=true;dojo.provide("dojox.collections.Dictionary");dojox.collections.Dictionary=function(_b21){var _b22={};this.count=0;var _b23={};this.add=function(k,v){var b=(k in _b22);_b22[k]=new dojox.collections.DictionaryEntry(k,v);if(!b){this.count++;}};this.clear=function(){_b22={};this.count=0;};this.clone=function(){return new dojox.collections.Dictionary(this);};this.contains=this.containsKey=function(k){if(_b23[k]){return false;}return (_b22[k]!=null);};this.containsValue=function(v){var e=this.getIterator();while(e.get()){if(e.element.value==v){return true;}}return false;};this.entry=function(k){return _b22[k];};this.forEach=function(fn,_b24){var a=[];for(var p in _b22){if(!_b23[p]){a.push(_b22[p]);}}dojo.forEach(a,fn,_b24);};this.getKeyList=function(){return (this.getIterator()).map(function(_b25){return _b25.key;});};this.getValueList=function(){return (this.getIterator()).map(function(_b26){return _b26.value;});};this.item=function(k){if(k in _b22){return _b22[k].valueOf();}return undefined;};this.getIterator=function(){return new dojox.collections.DictionaryIterator(_b22);};this.remove=function(k){if(k in _b22&&!_b23[k]){delete _b22[k];this.count--;return true;}return false;};if(_b21){var e=_b21.getIterator();while(e.get()){this.add(e.element.key,e.element.value);}}};}if(!dojo._hasResource["com.ibm.mashups.enabler.model.staticSkin.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.staticSkin.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.staticSkin.Factory_API");dojo.provide("com.ibm.mashups.enabler.model.staticSkin.Factory");dojo.declare("com.ibm.mashups.enabler.model.staticSkin.Factory",null,{getStaticSkinModel:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.StaticSkinModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.StaticSkinModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.StaticSkinModel_API");dojo.provide("com.ibm.mashups.enabler.model.StaticSkinModel");dojo.declare("com.ibm.mashups.enabler.model.StaticSkinModel",[com.ibm.mashups.enabler.Locator],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SkinModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.SkinModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.SkinModel_API");dojo.provide("com.ibm.mashups.enabler.model.SkinModel");dojo.declare("com.ibm.mashups.enabler.model.SkinModel",[com.ibm.mashups.enabler.ListModel,com.ibm.mashups.enabler.ResourceLocator],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SkinModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.SkinModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.SkinModel");}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.ModelUrlConstantsImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.url.ModelUrlConstantsImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.url.ModelUrlConstantsImpl");dojo.declare("com.ibm.mm.enabler.model.url.ModelUrlConstantsImpl",null,{PARAMETER_ASPECT:"aspect",PARAMETER_ASPECT_VALUE_ACCESS_CONTROL:"ac",PARAMETER_ASPECT_VALUE_COMPOSITE_APPLICATION:"ca",PARAMETER_REPRESENTATION:"rep",PARAMETER_REPRESENTATION_VALUE_FULL:"full",PARAMETER_LEVELS:"levels",PARAMETER_MDNAME:"mdname",PARAMETER_MODE:"mode",PARAMETER_MODE_VALUE_REFRESH:"refresh",PARAMETER_STATE_URL:"stateURL",PARAMETER_UPDATE:"update",PARAMETER_UPDATE_VALUE_REPLACE:"replace"});}if(!dojo._hasResource["com.ibm.mm.enabler.model.url.ModelUrlConstants"]){dojo._hasResource["com.ibm.mm.enabler.model.url.ModelUrlConstants"]=true;dojo.provide("com.ibm.mm.enabler.model.url.ModelUrlConstants");com.ibm.mm.enabler.model.url.ModelUrlConstants=new com.ibm.mm.enabler.model.url.ModelUrlConstantsImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl"]){dojo._hasResource["com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl"]=true;dojo.provide("com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl");dojo.declare("com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl",null,{_applyHiddenMetaDataLoadingStrategyToModelURL:function(_b27){var s=this._findStrategyByType("com.ibm.mashups.enabler.strategy.HiddenMetaDataLoadingStrategy");if(s){dojo.forEach(s.getHiddenMetaDataToLoad(),function(name){_b27.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MDNAME,name);});}}});}if(!dojo._hasResource["com.ibm.mm.enabler.ModelIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.ModelIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.ModelIteratorImpl");dojo.declare("com.ibm.mm.enabler.ModelIteratorImpl",[com.ibm.mm.enabler.DeferredIteratorImpl],{constructor:function(url,_b28,_b29){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.parentId=_b29;this.model=_b28;this.entries=[];this.cursor=0;this.sizeValue=null;this.ATOM_FEED="atom:feed";this.ATOM_ENTRY=this.ATOM_FEED+"/atom:entry";this.ATOM_NEXT=this.ATOM_FEED+"/atom:link[@rel='next']";this.OPENSEARCH_TOTALRESULTS=this.ATOM_FEED+"/opensearch:totalResults";if(url){this.collectionUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(url,_b28);if(_b28.strategy){for(var x in _b28.strategy){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_b28.strategy[x],com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy)){this.collectionUrl.setParameter("num",_b28.strategy[x].getInterval());this.collectionUrl.setParameter("start",this.getCursorPosition());break;}}}this._customizeUrl(this.collectionUrl);}this.numCreatedNodes=0;this._createdNodes={};com.ibm.mm.enabler.utils.Misc.forIn(this.model.createdNodes,function(_b2a,_b2b){var _b2c=this.model.getParent(_b2b).start();if(_b2c&&this.parentId==_b2c.getID()){var _b2d=this.model.find(_b2b).start();var next=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:link[@rel='next']",_b2d.getXml(),this.model.ns);this._createdNodes[_b2b]=next?com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.model.prefix,next):null;this.numCreatedNodes++;}},this);this.numRemovedNodes=0;if(url){com.ibm.mm.enabler.utils.Misc.forIn(this.model.deletedNodes,function(_b2e,_b2f){var _b30=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("thr:in-reply-to[@ext:uri]",this.model.deletedNodes[_b2f].getXml(),this.model.ns);if(_b30){if(this.parentId==com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.model.prefix,_b30)){this.numRemovedNodes++;}}},this);}},_createNode:function(_b31){return null;},_customizeUrl:function(url){},hasNext:function(dfr,sync){if(typeof this.entries[this.cursor]=="undefined"){var _b32=0;if(this.collectionUrl){this._loadAhead(dfr||null,true);_b32=this.cursor;}else{this.entries[0]=null;}this._insertCreated(this.entries,_b32);this.sizeValue=this.sizeValue+this.numCreatedNodes-this.numRemovedNodes;}var _b33=this.entries[this.cursor];var _b34=_b33?true:false;if(_b34&&this.model.deletedNodes&&this.model.deletedNodes[_b33]){this.cursor++;return this.hasNext(dfr,sync);}return _b34;},next:function(dfr,sync){return this.hasNext(dfr||null,typeof sync=="undefined"?true:sync)?this.model.loadedNodes[this.entries[this.cursor++]]:null;},_insertCreated:function(_b35,_b36){while(_b35[_b36]){var _b37=_b35[_b36];for(var _b38 in this._createdNodes){if(_b37==this._createdNodes[_b38]){if(_b36>0&&_b35[_b36-1]!=_b38){_b35.splice(_b36,0,_b38);}}}_b36++;}if(_b35[_b36]===null){for(var _b39 in this._createdNodes){if(null===this._createdNodes[_b39]){_b35.splice(_b36,0,_b39);_b36++;}}}},setCursorPosition:function(_b3a){this.cursor=_b3a;this.collectionUrl.setParameter("start",_b3a);},getCursorPosition:function(){return this.cursor;},size:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._size);},_size:function(dfr,sync){if(!this.sizeValue){this.hasNext(null,true);}if(dfr){dfr.finish(this.sizeValue,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.sizeValue;},start:function(sync){this._loadAhead(this,sync,true);},_loadAhead:function(_b3b,sync,_b3c){var _b3d="_loadAhead";var _b3e=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_b3e){this.LOGGER.entering(_b3d,arguments);}if(!this.collectionUrl){this.entries[this.cursor]=null;if(_b3b){_b3b.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return;}var _b3f=new com.ibm.mm.enabler.services.ModelRestServiceRequest(this.collectionUrl,null,null,false,sync);_b3f.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){this.sizeValue=com.ibm.mashups.enabler.xml.XPath.evaluateNumber(this.OPENSEARCH_TOTALRESULTS,data,this.model.ns);var c=0;var _b40=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.ATOM_ENTRY,data,this.model.ns);if(_b40){for(var i=0,l=_b40.length;i<l;i++){var node=this._createNode(_b40[i]);if(node){this.entries[this.cursor+c++]=node.getID();if(_b3b){_b3b.nextFinish(node);}}else{this.sizeValue--;}}}var next=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this.ATOM_NEXT,data,this.model.ns);if(next){var url=next.getAttribute("href");this.collectionUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(url,this.model);this._customizeUrl(this.collectionUrl);if(_b40&&_b3c){this._loadAhead(_b3b,sync,_b3c);}}else{this.entries[this.cursor+c]=null;if(_b3b){_b3b.finish(null,xhr.status);}}}else{if(_b3b){_b3b.finish(null,xhr.status);}}}));if(_b3e){this.LOGGER.exiting(_b3d);}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.theme.Skin"]){dojo._hasResource["com.ibm.mashups.enabler.theme.Skin"]=true;dojo.provide("com.ibm.mashups.enabler.theme.Skin");dojo.declare("com.ibm.mashups.enabler.theme.Skin",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.Localized,com.ibm.mashups.enabler.MetaData],{getBaseUrl:function(){},getPreviewUrl:function(){},getPreviewURL:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.theme.SkinImpl"]){dojo._hasResource["com.ibm.mm.enabler.theme.SkinImpl"]=true;dojo.provide("com.ibm.mm.enabler.theme.SkinImpl");dojo.declare("com.ibm.mm.enabler.theme.SkinImpl",[com.ibm.mashups.enabler.theme.Skin,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.MetaDataImpl2],{constructor:function(node){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.xmlData=node;var _b41=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_THEME);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_b41.namespaces,nsf.getNameSpaces([nsf.NS_ATOM]));},getBaseUrl:function(_b42){if(typeof _b42=="undefined"){var _b43="getBaseUrl";this.LOGGER.warning(_b43,"Deprecated. Use com.ibm.mashups.enabler.model.ThemeModel.findResourceURL instead.");}return this._getBaseUrl();},_getBaseUrl:function(){var _b44=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/model:skin/model:link[@ext:rel='baseUrl']",this.xmlData,this.ns);return (_b44&&_b44.length>0)?_b44[0].getAttribute("href"):null;},getPreviewUrl:function(){return this.getPreviewURL();},getPreviewURL:function(){var _b45=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/model:skin/model:link[@ext:rel='previewUrl']",this.xmlData,this.ns);return (_b45&&_b45.length>0)?_b45[0].getAttribute("href"):null;},_getMediaURL:function(){var _b46=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ext:rel=\"media\"]",this.xmlData,this.ns);return (_b46&&_b46.length>0)?_b46[0].getAttribute("href"):null;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mm.enabler.theme.SkinModelIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.theme.SkinModelIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.theme.SkinModelIteratorImpl");dojo.declare("com.ibm.mm.enabler.theme.SkinModelIteratorImpl",[com.ibm.mashups.enabler.Iterator,com.ibm.mm.enabler.DeferredIteratorImpl,com.ibm.mm.enabler.ModelIteratorImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},_createNode:function(_b47){var node=new com.ibm.mm.enabler.theme.SkinImpl(_b47);this.model.loadedNodes[node.getID()]=node;return node;},_customizeUrl:function(url){url.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);url.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this.model._applyHiddenMetaDataLoadingStrategyToModelURL(url);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.SkinModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.SkinModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.SkinModelImpl");dojo.declare("com.ibm.mm.enabler.model.SkinModelImpl",[com.ibm.mashups.enabler.model.SkinModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl],{constructor:function(url,_b48){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _b49=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_THEME);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_b49.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH]));this.loadedNodes={};this.collectionUrl=url;this.themeId=_b48;},iterator:function(){return new com.ibm.mm.enabler.theme.SkinModelIteratorImpl(this.collectionUrl,this);},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._load,uri);},_load:function(_b4a,sync,uri){uri=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(uri);var _b4b="_load";var _b4c=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_b4c){this.LOGGER.entering(_b4b,arguments);}if(uri in this.loadedNodes){if(_b4a){_b4a.finish(this.loadedNodes[uri],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}else{var _b4d=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_URL,this);var _b4e=[{value:uri,isID:true}];if(this.themeId){_b4e.push({value:this.themeId,isID:true});}_b4d.setNodes(_b4e);_b4d.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);_b4d.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this._applyHiddenMetaDataLoadingStrategyToModelURL(_b4d);var _b4f=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_b4d,null,null,false,sync);_b4f.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed/atom:entry";var _b50=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(_b50&&_b50.length>0){this.loadedNodes[uri]=new com.ibm.mm.enabler.theme.SkinImpl(_b50[0]);}}if(_b4a&&_b4a.getFinishedCallback()){var _b51=_b4a.getFinishedCallback();_b51(this.loadedNodes[uri]||null,xhr.status,_b4a.getFinishedCallbackParameters());}}));}if(_b4c){this.LOGGER.exiting(_b4b);}return this.loadedNodes[uri]||null;},findResourceUrl:function(node,name){return this.findResourceURL(node,name);},findResourceURL:function(node,name){var _b52=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_MEDIA_URL,this);var _b53=[{value:node.getID(),isID:true},{value:this.themeId,isID:true},{value:name,isID:false}];_b52.setNodes(_b53);return _b52.getAbsoluteURL();}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.StaticSkinModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.StaticSkinModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.StaticSkinModelImpl");dojo.declare("com.ibm.mm.enabler.model.StaticSkinModelImpl",com.ibm.mashups.enabler.model.StaticSkinModel,{getInstance:function(){if(!com.ibm.mm.enabler.model.StaticSkinModelImpl._instance){com.ibm.mm.enabler.model.StaticSkinModelImpl._instance=new com.ibm.mm.enabler.model.StaticSkinModelImpl();}return com.ibm.mm.enabler.model.StaticSkinModelImpl._instance;},_skinModel:null,constructor:function(){this._skinModel=new com.ibm.mm.enabler.model.SkinModelImpl();},find:function(id){return this._skinModel.find(id);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.StaticSkinModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.StaticSkinModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.StaticSkinModel");}if(!dojo._hasResource["com.ibm.mm.enabler.model.staticSkin.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.staticSkin.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.staticSkin.FactoryImpl");dojo.declare("com.ibm.mm.enabler.model.staticSkin.FactoryImpl",com.ibm.mashups.enabler.model.staticSkin.Factory,{getStaticSkinModel:function(){return com.ibm.mm.enabler.model.StaticSkinModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.model.staticSkin.Factory=new com.ibm.mm.enabler.model.staticSkin.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.staticSkin.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.model.staticSkin.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.model.staticSkin.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.Preferences"]){dojo._hasResource["com.ibm.mashups.enabler.widget.Preferences"]=true;dojo.provide("com.ibm.mashups.enabler.widget.Preferences");dojo.declare("com.ibm.mashups.enabler.widget.Preferences",null,{getValue:function(name){},getValues:function(name){},isReadOnly:function(name){},getNames:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.ModifiablePreferences"]){dojo._hasResource["com.ibm.mashups.enabler.widget.ModifiablePreferences"]=true;dojo.provide("com.ibm.mashups.enabler.widget.ModifiablePreferences");dojo.declare("com.ibm.mashups.enabler.widget.ModifiablePreferences",com.ibm.mashups.enabler.widget.Preferences,{confirmRemove:function(name){},confirmSetValue:function(name,_b54){},confirmSetValues:function(name,_b55){},confirmSetReadOnly:function(name){},setValue:function(name,_b56){},setValue:function(name,_b57,_b58){},setValues:function(name,_b59){},setValues:function(name,_b5a,_b5b){},remove:function(name){}});com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_BASE="/"+("com.ibm.mashups.enabler.widget.ModifiablePreferences".replace(/\./ig,"/"))+"/";com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_SET=com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_BASE+"set";com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_REMOVE=com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_BASE+"remove";}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.PreferencesProvider_API"]){dojo._hasResource["com.ibm.mashups.enabler.widget.PreferencesProvider_API"]=true;dojo.provide("com.ibm.mashups.enabler.widget.PreferencesProvider_API");dojo.provide("com.ibm.mashups.enabler.widget.PreferencesProvider");dojo.declare("com.ibm.mashups.enabler.widget.PreferencesProvider",null,{getPreferences:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.PreferencesImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.PreferencesImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.PreferencesImpl");dojo.declare("com.ibm.mm.enabler.widget.PreferencesImpl",[com.ibm.mashups.enabler.widget.Preferences],{constructor:function(node,_b5c,_b5d){this.xmlData=node;this.prefProvider=_b5c;this.defaultPreferences=_b5d;var _b5e=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.li_ns=dojo.delegate(_b5e.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_XSI]));this.PREFERENCES="atom:content/*/model:portletpreferences[@name='${0}']/base:value";this.PREFERENCES_BY_NAME="atom:content/*/model:portletpreferences[@name='${0}']";this.PREFERENCES_TOP="atom:content/*/model:portletpreferences";this.STAR_NODE="atom:content/*";this.BASE_NS=this.li_ns.base;this.BASE_VALUE="base:value";this.BASE_STRING="base:String";this.XSI_NS=this.li_ns.xsi;this.XSI_TYPE="xsi:type";this.MODEL_NS=this.li_ns.model;this.MODEL_PORTLETPREFERENCES="model:portletpreferences";},_getPrefNode:function(name){if(!name){return null;}var _b5f=null;var expr=dojo.string.substitute(this.PREFERENCES_BY_NAME,[name]);var _b60=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.li_ns);if(_b60&&_b60.length>0){return _b60[0];}return _b5f;},getValue:function(name){var _b61=this._getPrefNode(name);if(_b61){var _b62="base:value[@xsi:type='base:String' and position()=1]/@value";var _b63=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_b62,_b61,this.li_ns);if(_b63&&_b63.length==1){return com.ibm.mm.enabler.utils.Dom.textContent(_b63[0]);}}if(this.defaultPreferences){return this.defaultPreferences.getValue(name);}return null;},getValues:function(name){var _b64=this._getPrefNode(name);if(_b64){var _b65="base:value[@xsi:type='base:String']/@value";var _b66=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_b65,_b64,this.li_ns);if(_b66&&_b66.length>0){return dojo.map(_b66,function(node){return com.ibm.mm.enabler.utils.Dom.textContent(node);});}}if(this.defaultPreferences){return this.defaultPreferences.getValues(name);}return null;},isReadOnly:function(name){var _b67=false;var _b68=this._getPrefNode(name);if(_b68){var _b69=_b68.getAttribute("read-only");if(_b69=="true"){_b67=true;}}else{if(this.defaultPreferences){_b67=this.defaultPreferences.isReadOnly(name);}}return _b67;},getNames:function(){var _b6a=[];var _b6b={};var _b6c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.PREFERENCES_TOP,this.xmlData,this.li_ns);var i;if(_b6c){var _b6d=_b6c.length;for(i=0;i<_b6d;i++){_b6b[_b6c[i].getAttribute("name")]=null;}}if(this.defaultPreferences){var _b6e=this.defaultPreferences.getNames();var _b6f=_b6e.length;for(i=0;i<_b6f;++i){_b6b[_b6e[i]]=null;}}for(var name in _b6b){if(Object.prototype.hasOwnProperty.call(_b6b,name)){_b6a.push(name);}}return _b6a;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.ModifiablePreferencesImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.ModifiablePreferencesImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.ModifiablePreferencesImpl");dojo.declare("com.ibm.mm.enabler.widget.PreferencesUpdateContext",null,{source:"<instance>",type:"<context>"});dojo.declare("com.ibm.mm.enabler.widget.ModifiablePreferencesImpl",[com.ibm.mashups.enabler.widget.ModifiablePreferences,com.ibm.mm.enabler.widget.PreferencesImpl,com.ibm.mm.enabler.DirtyFlagProviderImpl],{setValue:function(name,_b70,_b71,_b72){if(_b70===null){return false;}if(!this.confirmSetValue(name,_b70)){return false;}var _b73=this.getValue(name);var _b74=this._setValuesInternally(name,[_b70],_b71);if(_b74){var _b75=null;if(_b72){_b75=_b72;}dojo.publish(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_SET,[this,name,_b73,_b70,_b75]);}return _b74;},setValues:function(name,_b76,_b77){if(_b76===null){return false;}if(!this.confirmSetValues(name,_b76)){return false;}return this._setValuesInternally(name,_b76,_b77);},_setValuesInternally:function(name,_b78,_b79){if(!dojo.isArray(_b78)){return false;}if(this.defaultPreferences&&this.defaultPreferences.isReadOnly(name)){return false;}var _b7a=this._getPrefNode(name);var _b7b=this.xmlData.ownerDocument;if(_b7a){if(_b7a.hasChildNodes()){var _b7c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.BASE_VALUE,_b7a,this.li_ns);dojo.forEach(_b7c,dojo.destroy);}}else{var _b7d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.STAR_NODE,this.xmlData,this.li_ns);if(!_b7d||_b7d.length===0){return false;}_b7a=com.ibm.mm.enabler.utils.Dom.createElement(_b7b,this.MODEL_PORTLETPREFERENCES,this.MODEL_NS);_b7a.setAttribute("name",name);_b7d[0].appendChild(_b7a);_b7a.setAttribute("read-only","false");}if(this.confirmSetReadOnly(name)){if(_b79===true){_b7a.setAttribute("read-only","true");}else{if(_b79===false){_b7a.setAttribute("read-only","false");}}}var _b7e=_b78.length;for(var i=0;i<_b7e;++i){var _b7f=_b78[i];var node=com.ibm.mm.enabler.utils.Dom.createElement(_b7b,this.BASE_VALUE,this.BASE_NS);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_b7b,node,this.XSI_TYPE,"type",this.XSI_NS,this.BASE_STRING);node.setAttribute("value",_b7f);_b7a.appendChild(node);}this._setDirty();return true;},remove:function(name,_b80){if(!this.confirmRemove(name)){return false;}var _b81=this._getPrefNode(name);if(!_b81){return false;}var _b82=this.getValue(name);var _b83=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.STAR_NODE,this.xmlData,this.li_ns);if(!_b83||_b83.length===0){return false;}_b83[0].removeChild(_b81);this._setDirty();var _b84=null;if(_b80){_b84=_b80;}dojo.publish(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_REMOVE,[this,name,_b82,null,_b84]);return true;},confirmRemove:function(name){var _b85=this._getPrefNode(name);if(!_b85){return false;}return true;},confirmSetValue:function(name,_b86){return true;},confirmSetValues:function(name,_b87){return true;},confirmSetReadOnly:function(name){return true;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.HierarchicalPreferencesImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.HierarchicalPreferencesImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.HierarchicalPreferencesImpl");dojo.declare("com.ibm.mm.enabler.widget.HierarchicalPreferencesImpl",com.ibm.mashups.enabler.widget.ModifiablePreferences,{constructor:function(_b88){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _b89="constructor(basePreferences)";var _b8a=this.LOGGER.isLoggable(this.LOG_LEVEL,_b88);if(_b8a){this.LOGGER.entering(_b89);}this.basePrefs=_b88;this.prefProvider=this.basePrefs.prefProvider;this.parentPrefs=this.prefProvider._getParentHierarchicalPreferences();dojo.subscribe(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_SET,this,"_setValueHandler");dojo.subscribe(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_REMOVE,this,"_removeHandler");this.eventContext={source:this,type:"hierachyUpdate",provider:this.prefProvider.getID()};if(_b8a){this.LOGGER.exiting(_b89);}},isReadOnly:function(name){if(this.basePrefs.getValue(name)!==null){return this.basePrefs.isReadOnly(name);}if(this.parentPrefs){return this.parentPrefs.isReadOnly(name);}return false;},getValue:function(name){var _b8b=this.basePrefs.getValue(name);if(_b8b!==null){return _b8b;}if(this.parentPrefs){return this.parentPrefs.getValue(name);}return null;},getValues:function(name){var _b8c=this.basePrefs.getValues(name);if(_b8c!==null){return _b8c;}if(this.parentPrefs){return this.parentPrefs.getValues(name);}return null;},setValue:function(name,_b8d,_b8e,_b8f){var _b90="setValue(name, value, readOnly, _context)";var _b91=this.LOGGER.isLoggable(this.LOG_LEVEL,[name,_b8d,_b8e,_b8f]);if(_b91){this.LOGGER.entering(_b90);}if(!this.confirmSetValue(name,_b8d)){if(_b91){this.LOGGER.trace(_b90,"confirmSetValue is false");}if(_b91){this.LOGGER.exiting(_b90,false);}return false;}if(_b91){this.LOGGER.trace(_b90,"Setting the new value");}var _b92=this.getValue(name);var _b93=this.basePrefs.setValue(name,_b8d,_b8e,_b8f);if(_b91){this.LOGGER.exiting(_b90,_b93);}return _b93;},setValues:function(name,_b94,_b95){var _b96="setValues(name, values, readOnly)";var _b97=this.LOGGER.isLoggable(this.LOG_LEVEL,[name,_b94,_b95]);if(_b97){this.LOGGER.entering(_b96);}if(!this.confirmSetValues(name,_b94)){if(_b97){this.LOGGER.trace(_b96,"confirmSetValues is false");}if(_b97){this.LOGGER.exiting(_b96,false);}return false;}if(_b97){this.LOGGER.trace(_b96,"Setting the new values");}var _b98=this.basePrefs.setValues(name,_b94,_b95);if(_b97){this.LOGGER.exiting(_b96,_b98);}return _b98;},remove:function(name,_b99){var _b9a=this.basePrefs.remove(name,_b99);return _b9a;},getNames:function(){var _b9b="getNames()";var _b9c=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_b9c){this.LOGGER.entering(_b9b);}var _b9d=[];var _b9e={};var i;if(this.parentPrefs){if(_b9c){this.LOGGER.trace(_b9b,"Getting names from parent preference");}var _b9f=this.parentPrefs.getNames();var _ba0=_b9f.length;for(i=0;i<_ba0;++i){_b9e[_b9f[i]]=null;}}if(_b9c){this.LOGGER.trace(_b9b,"Getting own names");}var _ba1=this.basePrefs.getNames();var _ba2=_ba1.length;for(i=0;i<_ba2;++i){_b9e[_ba1[i]]=null;}for(var name in _b9e){if(Object.prototype.hasOwnProperty.call(_b9e,name)){_b9d.push(name);}}if(_b9c){this.LOGGER.exiting(_b9b);}return _b9d;},confirmRemove:function(name){return this.basePrefs.confirmRemove(name);},confirmSetValue:function(name,_ba3){var _ba4="confirmSetValue(name, value)";var _ba5=this.LOGGER.isLoggable(this.LOG_LEVEL,[name,_ba3]);if(_ba5){this.LOGGER.entering(_ba4);}if(this.parentPrefs&&this.parentPrefs.isReadOnly(name)){if(_ba5){this.LOGGER.trace(_ba4,"Preference is read only on parent");}if(_ba5){this.LOGGER.exiting(_ba4,false);}return false;}var _ba6=this.basePrefs.confirmSetValue(name,_ba3);if(_ba5){this.LOGGER.trace(_ba4,"Confirm on base preferences is ${0}",_ba6);}if(_ba5){this.LOGGER.exiting(_ba4,_ba6);}return _ba6;},confirmSetValues:function(name,_ba7){return this.confirmSetValue(name,_ba7);},confirmSetReadOnly:function(name){return false;},_valueExistsOnHierarchy:function(_ba8){},_setValueHandler:function(_ba9,_baa,_bab,_bac,_bad){if(_ba9!==this.basePrefs&&_ba9!==this.parentPrefs){return;}var myOV=_bab;if(_ba9===this.basePrefs){if(_bab===null&&this.parentPrefs){myOV=this.parentPrefs.getValue(_baa);}}else{if(_ba9===this.parentPrefs){var _bae=this.basePrefs.getValue(_baa);if(_bae!==null){return;}}}if(_bad===null){_bad=this.eventContext;}dojo.publish(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_SET,[this,_baa,myOV,_bac,_bad]);},_removeHandler:function(_baf,_bb0,_bb1,_bb2,_bb3){if(_baf!==this.basePrefs&&_baf!==this.parentPrefs){return;}if(_bb3===null){_bb3=this.eventContext;}var _bb4;if(_baf===this.parentPrefs){_bb4=this.basePrefs.getValue(_bb0);if(_bb4!==null){return;}}if(_baf===this.basePrefs){if(this.parentPrefs){_bb4=this.parentPrefs.getValue(_bb0);if(_bb4!==null){dojo.publish(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_SET,[this,_bb0,_bb1,_bb4,_bb3]);return;}}}dojo.publish(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_REMOVE,[this,_bb0,_bb1,_bb2,_bb3]);}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.PreferencesProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.PreferencesProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.PreferencesProviderImpl");dojo.declare("com.ibm.mm.enabler.widget.PreferencesProviderImpl",com.ibm.mashups.enabler.widget.PreferencesProvider,{getPreferences:function(){if(!this.preferences){var _bb5=this._getPreferencesXML();if(!_bb5){return null;}var _bb6=null;var _bb7=null;if(this._getDefaultPreferencesXML){_bb6=this._getDefaultPreferencesXML();if(_bb6){_bb7=new com.ibm.mm.enabler.widget.PreferencesImpl(_bb6,this);}}this.preferences=new com.ibm.mm.enabler.widget.ModifiablePreferencesImpl(_bb5,this,_bb7);}return this.preferences;},_getParentPreferences:function(){var _bb8=this.model._getParent(this);if(_bb8&&_bb8.getPreferences){return _bb8.getPreferences();}else{return null;}},_getHierarchicalPreferences:function(){if(!this.hierarchicalPrefs){this.hierarchicalPrefs=new com.ibm.mm.enabler.widget.HierarchicalPreferencesImpl(this.getPreferences());}return this.hierarchicalPrefs;},_getParentHierarchicalPreferences:function(){var _bb9=this.model._getParent(this);if(_bb9&&_bb9._getParentHierarchicalPreferences){return _bb9._getHierarchicalPreferences();}else{return null;}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.PreferencesProvider"]){dojo._hasResource["com.ibm.mashups.enabler.widget.PreferencesProvider"]=true;dojo.provide("com.ibm.mashups.enabler.widget.PreferencesProvider");}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.Event"]){dojo._hasResource["com.ibm.mashups.enabler.widget.Event"]=true;dojo.provide("com.ibm.mashups.enabler.widget.Event");dojo.declare("com.ibm.mashups.enabler.widget.Event",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.Localized],{getName:function(){},isPublished:function(){},isHandled:function(){},getPayloadType:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.EventProvider"]){dojo._hasResource["com.ibm.mashups.enabler.widget.EventProvider"]=true;dojo.provide("com.ibm.mashups.enabler.widget.EventProvider");dojo.declare("com.ibm.mashups.enabler.widget.EventProvider",null,{getEvents:function(_bba){},getEvent:function(name){},getEventByID:function(id){},HANDLED_NAME_PREFIX:"handled_",PUBLISHED_NAME_PREFIX:"published_"});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.ModifiableEvent"]){dojo._hasResource["com.ibm.mashups.enabler.widget.ModifiableEvent"]=true;dojo.provide("com.ibm.mashups.enabler.widget.ModifiableEvent");dojo.declare("com.ibm.mashups.enabler.widget.ModifiableEvent",[com.ibm.mashups.enabler.widget.Event,com.ibm.mashups.enabler.ModifiableLocalized],{setName:function(name){},setPayloadType:function(_bbb){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.ModifiableEventProvider"]){dojo._hasResource["com.ibm.mashups.enabler.widget.ModifiableEventProvider"]=true;dojo.provide("com.ibm.mashups.enabler.widget.ModifiableEventProvider");dojo.declare("com.ibm.mashups.enabler.widget.ModifiableEventProvider",com.ibm.mashups.enabler.widget.EventProvider,{createEvent:function(name,_bbc){},getEvents:function(_bbd){},getEvent:function(name){},addEvent:function(_bbe){},removeEvent:function(_bbf){},confirmAddEvent:function(_bc0){},confirmRemoveEvent:function(_bc1){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetWindow"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetWindow"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetWindow");dojo.declare("com.ibm.mashups.enabler.widget.WidgetWindow",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.widget.PreferencesProvider,com.ibm.mashups.enabler.widget.ModifiableEventProvider],{_type:"window"});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetDefinition_API"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetDefinition_API"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetDefinition_API");dojo.provide("com.ibm.mashups.enabler.widget.WidgetDefinition");dojo.declare("com.ibm.mashups.enabler.widget.WidgetDefinition",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.widget.PreferencesProvider,com.ibm.mashups.enabler.widget.ModifiableEventProvider],{_type:"definition",getSupportedModes:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetDefinition"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetDefinition"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetDefinition");}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetInstance_API"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetInstance_API"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetInstance_API");dojo.provide("com.ibm.mashups.enabler.widget.WidgetInstance");dojo.declare("com.ibm.mashups.enabler.widget.WidgetInstance",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.widget.PreferencesProvider,com.ibm.mashups.enabler.widget.ModifiableEventProvider],{_type:"instance"});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetInstance"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetInstance"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetInstance");}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetModel_API");dojo.provide("com.ibm.mashups.enabler.widget.WidgetModel");dojo.declare("com.ibm.mashups.enabler.widget.WidgetModel",[com.ibm.mashups.enabler.Commitable,com.ibm.mashups.enabler.model.Model,com.ibm.mashups.enabler.Locator,com.ibm.mashups.enabler.Discardable],{find:function(id){},getWidgetDefinitionByWindow:function(_bc2){},getWidgetDefinitionByInstance:function(_bc3){},getWidgetWindow:function(_bc4){},getWidgetInstance:function(_bc5){},getHierarchicalPreferences:function(_bc6){},getHierarchicalEventProvider:function(_bc7){}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.ModifiableEventImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.ModifiableEventImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.ModifiableEventImpl");dojo.declare("com.ibm.mm.enabler.widget.ModifiableEventImpl",[com.ibm.mashups.enabler.widget.ModifiableEvent,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.DirtyFlagProviderImpl],{constructor:function(node,_bc8){this.xmlData=node;this.eventProvider=_bc8;var _bc9=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.li_ns=dojo.delegate(_bc9.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_XSI,nsf.NS_EVENT_DATATYPES]));this.QNAME_XPATH="model:qname";this.PAYLOAD_TYPE_XPATH="model:payload-type";this.PUBLISHED_LNAME="publish-event";this.PROCESSED_LNAME="process-event";this.MODEL_QNAME="model:qname";this.MODEL_PAYLOAD_TYPE="model:payload-type";this.STAR_NODE="atom:content/*";this.BASE_NS=this.li_ns.base;this.BASE_VALUE="base:value";this.BASE_STRING="base:String";this.XSI_NS=this.li_ns.xsi;this.XSI_TYPE="xsi:type";this.MODEL_NS=this.li_ns.model;this.NLS_TITLE="model:title/base:nls-string";this.NLS_TITLE_TOP="model:title";this.NLS_DESCRIPTION="model:description/base:nls-string";this.NLS_DESCRIPTION_TOP="model:description";this.DEFAULT_PAYLOAD_PREFIX="mmpayload";this.DEFAULT_NAME_PREFIX="mmname";this.DATATYPE_NS=this.li_ns[nsf.NS_EVENT_DATATYPES];this.XMLNS_NS=nsf.getNameSpaces([nsf.NS_XMLNS])[nsf.NS_XMLNS];},getID:function(){var _bca=this.xmlData.getAttribute("id");return com.ibm.mm.enabler.IdentifiableHelper.getID(_bca);},getName:function(){var expr=this.QNAME_XPATH;var _bcb=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.li_ns);if(!_bcb||_bcb.length===0){return null;}var _bcc=_bcb[0];var _bcd=com.ibm.mm.enabler.utils.Dom.textContent(_bcc);var _bce=com.ibm.mm.enabler.utils.Dom.getNodeNSPrefix(_bcd);var _bcf=com.ibm.mm.enabler.utils.Dom.removeNodeNS(_bcd);if(_bce===null){return _bcf;}var ns=com.ibm.mm.enabler.utils.Dom.lookupNamespaceURI(_bcc,_bce);if(ns===null){return _bcf;}return "{"+ns+"}"+_bcf;},isPublished:function(){var _bd0=com.ibm.mm.enabler.utils.Dom.getLocalName(this.xmlData);return (_bd0==this.PUBLISHED_LNAME);},isHandled:function(){var _bd1=com.ibm.mm.enabler.utils.Dom.getLocalName(this.xmlData);return (_bd1==this.PROCESSED_LNAME);},getPayloadType:function(){var expr=this.PAYLOAD_TYPE_XPATH;var _bd2=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.li_ns);if(!_bd2||_bd2.length===0){return null;}var _bd3=_bd2[0];var _bd4=com.ibm.mm.enabler.utils.Dom.textContent(_bd3);var _bd5=com.ibm.mm.enabler.utils.Dom.getNodeNSPrefix(_bd4);var _bd6=com.ibm.mm.enabler.utils.Dom.removeNodeNS(_bd4);if(_bd5===null){return _bd6;}var ns=com.ibm.mm.enabler.utils.Dom.lookupNamespaceURI(_bd3,_bd5);if(ns===null){return _bd6;}return "{"+ns+"}"+_bd6;},_setQNameNode:function(_bd7,_bd8,_bd9,_bda){var expr=_bd8;var _bdb=this.xmlData.ownerDocument;var _bdc=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.li_ns);var _bdd;if(!_bdc||_bdc.length===0){_bdd=com.ibm.mm.enabler.utils.Dom.createElement(_bdb,_bd7,this.li_ns.model);this.xmlData.appendChild(_bdd);}else{_bdd=_bdc[0];}var _bde=null;var _bdf=null;var _be0=_bd9.indexOf("{");if(_be0===0){var _be1=_bd9.indexOf("}");if(_be1==-1){throw new Error("Name is not a valid qName");}_bde=_bd9.substring(_be0+1,_be1);_bdf=_bd9.substring(_be1+1);}else{_bdf=_bd9;}if(_bde!==null){com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_bdd.ownerDocument,_bdd,"xmlns:"+_bda,_bda,this.XMLNS_NS,_bde);com.ibm.mm.enabler.utils.Dom.textContent(_bdd,_bda+":"+_bdf);}else{com.ibm.mm.enabler.utils.Dom.textContent(_bdd,_bdf);}},setName:function(name){this._setQNameNode(this.MODEL_QNAME,this.QNAME_XPATH,name,this.DEFAULT_NAME_PREFIX);this._setDirty();},setPayloadType:function(_be2){var _be3=_be2;var _be4=_be2.indexOf("{");if(_be4==-1){_be3="{"+this.DATATYPE_NS+"}"+_be2;}this._setQNameNode(this.MODEL_PAYLOAD_TYPE,this.PAYLOAD_TYPE_XPATH,_be3,this.DEFAULT_PAYLOAD_PREFIX);this._setDirty();},_getXML:function(){return this.xmlData;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.HierarchicalEventProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.HierarchicalEventProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.HierarchicalEventProviderImpl");dojo.declare("com.ibm.mm.enabler.widget.HierarchicalEventProviderImpl",com.ibm.mashups.enabler.widget.EventProvider,{constructor:function(_be5){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _be6="constructor(baseEventProvider)";var _be7=this.LOGGER.isLoggable(this.LOG_LEVEL,_be5);if(_be7){this.LOGGER.entering(_be6);}this.baseEP=_be5;this.parentEP=this.baseEP._getParentHierarchicalEventProvider();if(_be7){this.LOGGER.exiting(_be6);}},createEvent:function(name,_be8){var _be9="createEvent(name, handled)";var _bea=this.LOGGER.isLoggable(this.LOG_LEVEL,[name,_be8]);if(_bea){this.LOGGER.entering(_be9);}var _beb=this.baseEP.createEvent(name,_be8);if(_bea){this.LOGGER.exiting(_be9,_beb);}return _beb;},getEvents:function(_bec){var _bed="getEvents()";var _bee=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_bee){this.LOGGER.entering(_bed);}var _bef=[];var _bf0={};var i;var _bf1;if(_bee){this.LOGGER.trace(_bed,"Getting own events");}var _bf2=this.baseEP.getEvents(_bec);var _bf3=_bf2.length;for(i=0;i<_bf3;++i){var _bf4=_bf2[i];if(_bf4.isHandled()){_bf1=this.HANDLED_NAME_PREFIX;}else{_bf1=this.PUBLISHED_NAME_PREFIX;}_bf0[_bf1+_bf4.getName()]=_bf2[i];}if(this.parentEP){if(_bee){this.LOGGER.trace(_bed,"Getting events from parent event provider");}var _bf5=this.parentEP.getEvents(_bec);var _bf6=_bf5.length;var name;for(i=0;i<_bf6;++i){var _bf7=_bf5[i];name=_bf7.getName();if(_bf7.isHandled()){_bf1=this.HANDLED_NAME_PREFIX;}else{_bf1=this.PUBLISHED_NAME_PREFIX;}var _bf8=_bf1+name;if(!(_bf8 in _bf0)){_bf0[_bf8]=_bf5[i];}}}for(var _bf9 in _bf0){if(Object.prototype.hasOwnProperty.call(_bf0,_bf9)){_bef.push(_bf0[_bf9]);}}if(_bee){this.LOGGER.exiting(_bed);}return _bef;},getEvent:function(name){var _bfa=this.baseEP.getEvent(name);if(_bfa!==null){return _bfa;}if(this.parentEP){return this.parentEP.getEvent(name);}return null;},addEvent:function(_bfb){var _bfc="addEvent(event)";var _bfd=this.LOGGER.isLoggable(this.LOG_LEVEL,[_bfb]);if(_bfd){this.LOGGER.entering(_bfc);}if(!this.confirmAddEvent(_bfb)){if(_bfd){this.LOGGER.trace(_bfc,"confirmAddEvent is false");}if(_bfd){this.LOGGER.exiting(_bfc);}return;}this.baseEP.addEvent(_bfb);if(_bfd){this.LOGGER.exiting(_bfc);}},removeEvent:function(_bfe){var _bff="removeEvent(event)";var _c00=this.LOGGER.isLoggable(this.LOG_LEVEL,[_bfe]);if(_c00){this.LOGGER.entering(_bff);}if(!this.confirmRemoveEvent(_bfe)){if(_c00){this.LOGGER.trace(_bff,"confirmRemoveEvent is false");}if(_c00){this.LOGGER.exiting(_bff);}return;}this.baseEP.removeEvent(_bfe);if(_c00){this.LOGGER.exiting(_bff);}},confirmAddEvent:function(_c01){return this.baseEP.confirmAddEvent(_c01);},confirmRemoveEvent:function(_c02){return this.baseEP.confirmRemoveEvent(_c02);},getEventByID:function(id){var _c03=this.baseEP.getEventByID(id);if(_c03!==null){return _c03;}if(this.parentEP){return this.parentEP.getEventByID(id);}return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.ModifiableEventProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.ModifiableEventProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.ModifiableEventProviderImpl");dojo.declare("com.ibm.mm.enabler.widget.ModifiableEventProviderImpl",com.ibm.mashups.enabler.widget.ModifiableEventProvider,{constructor:function(){this._events=null;this.EVENTS_TOP_XPATH="atom:content/*/model:events";this.EVENTS_XPATH=this.EVENTS_TOP_XPATH+"/*";this.PARENT_XPATH="atom:content/*";this.MODEL_PUBLISH_EVENT="model:publish-event";this.MODEL_PROCESS_EVENT="model:process-event";this.MODEL_EVENTS="model:events";this._eventProviderIsDirty=false;},createEvent:function(name,_c04){var _c05=this._getEventXML().ownerDocument;var _c06=this.MODEL_PUBLISH_EVENT;if(_c04){_c06=this.MODEL_PROCESS_EVENT;}var node=com.ibm.mm.enabler.utils.Dom.createElement(_c05,_c06,this.ns.model);node.setAttribute("id","cid:0");var _c07=new com.ibm.mm.enabler.widget.ModifiableEventImpl(node,this);_c07.setName(name);_c07.setPayloadType("{"+this.ns.xsi+"}String");_c07._setDirty();return _c07;},getEvents:function(_c08){var _c09=true;var _c0a=false;var _c0b=false;if(typeof _c08!="undefined"&&_c08!==null){if(_c08[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]!==null&&_c08[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]===true){_c0a=true;_c09=false;}if(_c08[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS]!==null&&_c08[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS]===true){_c0b=true;_c09=false;}if(_c0b&&_c0a){_c09=true;}}if(this._events===null){this._loadEventsFromXML();}var _c0c=[];for(var _c0d in this._events){if(Object.prototype.hasOwnProperty.call(this._events,_c0d)){_c0c.push(this._events[_c0d]);}}var _c0e;if(this._defaultEventProvider){var _c0f=this._defaultEventProvider.getEvents();var _c10=_c0f.length;for(var i=0;i<_c10;++i){_c0e=_c0f[i];if(_c0e.isHandled()){namePrefix=this.HANDLED_NAME_PREFIX;}else{namePrefix=this.PUBLISHED_NAME_PREFIX;}if(!(namePrefix+_c0e.getName() in this._events)){_c0c.push(_c0e);}}}var _c11=[];if(!_c09){var _c12=_c0c.length;for(var j=0;j<_c12;++j){_c0e=_c0c[j];if(_c0a&&_c0e.isHandled()){_c11.push(_c0e);}else{if(_c0b&&_c0e.isPublished()){_c11.push(_c0e);}}}_c0c=_c11;}return _c0c;},_loadEventsFromXML:function(){var expr=this.EVENTS_XPATH;var _c13=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this._getEventXML(),this.ns);this._events={};if(!_c13){return;}var _c14=_c13.length;var _c15;for(var i=0;i<_c14;++i){var _c16=new com.ibm.mm.enabler.widget.ModifiableEventImpl(_c13[i],this);var _c17;if(_c16.isHandled()){_c17=this.HANDLED_NAME_PREFIX;}else{_c17=this.PUBLISHED_NAME_PREFIX;}var _c18=_c17+_c16.getName();this._events[_c18]=_c16;}},getEvent:function(name){if(this._events===null){this._loadEventsFromXML();}if(name===null){return null;}var _c19=this.HANDLED_NAME_PREFIX+name;if(_c19 in this._events){return this._events[_c19];}_c19=this.PUBLISHED_NAME_PREFIX+name;if(_c19 in this._events){return this._events[_c19];}if(this._defaultEventProvider){return this._defaultEventProvider.getEvent(name);}return null;},addEvent:function(_c1a){if(!_c1a){return;}if(!this.confirmAddEvent(_c1a)){return;}var expr=this.EVENTS_TOP_XPATH;var _c1b=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this._getEventXML(),this.ns);var _c1c;if(_c1b&&_c1b.length>0){_c1c=_c1b[0];}else{var _c1d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.PARENT_XPATH,this._getEventXML(),this.ns);if(!_c1d||_c1d.length===0){return;}_c1c=com.ibm.mm.enabler.utils.Dom.createElement(this._getEventXML().ownerDocument,this.MODEL_EVENTS,this.ns.model);_c1d[0].appendChild(_c1c);}_c1c.appendChild(_c1a._getXML());if(this._events===null){this._loadEventsFromXML();}var _c1e;if(_c1a.isHandled()){_c1e=this.HANDLED_NAME_PREFIX;}else{_c1e=this.PUBLISHED_NAME_PREFIX;}var _c1f=_c1e+_c1a.getName();this._events[_c1f]=_c1a;this._eventProviderIsDirty=true;},removeEvent:function(_c20){if(!_c20){return;}if(!this.confirmRemoveEvent(_c20)){return;}var expr=this.EVENTS_TOP_XPATH;var _c21=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this._getEventXML(),this.ns);if(!_c21||_c21.length===0){return;}_c21[0].removeChild(_c20._getXML());if(this._events!==null){var _c22;if(_c20.isHandled()){_c22=this.HANDLED_NAME_PREFIX;}else{_c22=this.PUBLISHED_NAME_PREFIX;}var _c23=_c22+_c20.getName();if(_c23 in this._events){delete this._events[_c23];}}this._eventProviderIsDirty=true;},confirmAddEvent:function(_c24){return true;},confirmRemoveEvent:function(_c25){return true;},_getHierarchicalEventProvider:function(){if(!this.hierarchicalEvents){this.hierarchicalEvents=new com.ibm.mm.enabler.widget.HierarchicalEventProviderImpl(this);}return this.hierarchicalEvents;},_getParentHierarchicalEventProvider:function(){var _c26=this.model._getParent(this);if(_c26&&_c26._getParentHierarchicalEventProvider){return _c26._getHierarchicalEventProvider();}else{return null;}},_getEventXML:function(){return this.xmlData;},_isEventProviderDirty:function(){if(this._eventProviderIsDirty){return true;}if(this._events===null){return false;}for(var _c27 in this._events){if(Object.prototype.hasOwnProperty.call(this._events,_c27)){var _c28=this._events[_c27];if(_c28._isDirty()){return true;}}}return false;},_setEventProviderClean:function(){this._eventProviderIsDirty=false;if(this._events===null){return;}for(var _c29 in this._events){if(Object.prototype.hasOwnProperty.call(this._events,_c29)){var _c2a=this._events[_c29];_c2a._setClean();}}},_isEmpty:function(obj){return obj===null||typeof obj=="undefined";},getEventByID:function(id){if(this._events===null){this._loadEventsFromXML();}if(id===null){return null;}var _c2b=this.getEvents(null);if(_c2b&&_c2b!==null){for(var i=0,l=_c2b.length;i<l;i++){if(_c2b[i].getID()===id){return _c2b[i];}}}return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.utils"]){dojo._hasResource["com.ibm.mm.enabler.widget.utils"]=true;dojo.provide("com.ibm.mm.enabler.widget.utils");dojo.declare("com.ibm.mm.enabler.widget.ChildNodeImpl",null,{_getParentID:function(){var _c2c=this._getParentLink();var _c2d=null;if(_c2c){_c2d=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,_c2c);}return _c2d;},_setParent:function(node,_c2e,_c2f){if(_c2e!==null){var _c30=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_c2f,this);_c30.setNodes([{value:_c2e.getID(),isID:true}]);var thr=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("thr:in-reply-to",node.xmlData,this.ns);if(!thr||thr.length===0){thr=com.ibm.mm.enabler.utils.Utils.createNode("thr:in-reply-to",this.ns.thr);node.xmlData.appendChild(thr);}else{thr=thr[0];}com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.xmlData.ownerDocument,thr,"ext:uri","uri",this.ns.ext,_c30.getModelURI());thr.setAttribute("ref",_c30.getModelURI());thr.setAttribute("href",_c30.getAbsoluteURL());}},_getParentHref:function(){var _c31=this._getParentLink();var _c32=null;if(_c31){_c32=_c31.getAttribute("href");}return _c32;},_getRelationXML:function(){return this.xmlData;},_getParentLink:function(){var _c33=this._getRelationXML();return com.ibm.mm.enabler.widget.utils.getParentLink(_c33,this.ns);}});com.ibm.mm.enabler.widget.utils.getParentLink=function(_c34,ns){var expr="thr:in-reply-to";var _c35=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_c34,ns);if(_c35&&_c35.length>0){return _c35[0];}return null;};}if(!dojo._hasResource["com.ibm.mm.enabler.widget.WidgetWindowImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.WidgetWindowImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.WidgetWindowImpl");dojo.declare("com.ibm.mm.enabler.widget.WidgetWindowImpl",[com.ibm.mashups.enabler.widget.WidgetWindow,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.widget.PreferencesProviderImpl,com.ibm.mm.enabler.widget.ChildNodeImpl,com.ibm.mm.enabler.widget.ModifiableEventProviderImpl],{constructor:function(_c36,_c37,_c38){this.xmlData=_c36;if(_c37){this.entity=new com.ibm.mm.enabler.IdentifierImpl(_c37);}this.model=_c38;this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XSI]));},_setXMLData:function(_c39,_c3a){this.xmlData=_c39;this.entity.xmlData=_c3a;this._setClean();},_getPreferencesXML:function(){if(this.entity){return this.entity.xmlData;}},_getRawEntityID:function(){if(this.entity){return this.entity._getRawID();}return null;},_setRawEntityID:function(_c3b){if(this.entity){this.entity._setRawID(_c3b);}},_setEntityParent:function(_c3c,_c3d){this._setParent(this.entity,_c3c,_c3d);},_getRelationXML:function(){if(this.entity){return this.entity.xmlData;}return this.xmlData;},_getEventXML:function(){if(this.entity){return this.entity.xmlData;}return this.xmlData;},_isDirty:function(){return this.getPreferences()._isDirty()||this._isEventProviderDirty();},_setClean:function(){this.getPreferences()._setClean();this._setEventProviderClean();}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.WidgetInstanceImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.WidgetInstanceImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.WidgetInstanceImpl");dojo.declare("com.ibm.mm.enabler.widget.WidgetInstanceImpl",[com.ibm.mashups.enabler.widget.WidgetInstance,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.MetaDataImpl2,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.widget.PreferencesProviderImpl,com.ibm.mm.enabler.widget.ChildNodeImpl,com.ibm.mm.enabler.widget.ModifiableEventProviderImpl],{constructor:function(node,_c3e){this.xmlData=node;this.model=_c3e;this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XSI]));},_setXMLData:function(_c3f){this.xmlData=_c3f;this._setClean();},_getPreferencesXML:function(){return this.xmlData;},_isDirty:function(){return this.getPreferences()._isDirty()||this._isEventProviderDirty();},_setClean:function(){this.getPreferences()._setClean();this._setEventProviderClean();}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.SimpleEventProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.SimpleEventProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.SimpleEventProviderImpl");dojo.declare("com.ibm.mm.enabler.widget.SimpleEventProviderImpl",com.ibm.mashups.enabler.widget.EventProvider,{constructor:function(_c40){this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR]));this._events=null;this.EVENTS_XPATH="atom:content/*/model:events/*";this.PARENT_XPATH="atom:content/*";this.MODEL_PUBLISH_EVENT="model:publish-event";this.MODEL_PROCESS_EVENT="model:process-event";this.xmlData=_c40;},getEvents:function(_c41){var _c42=true;var _c43=false;var _c44=false;if(typeof _c41!="undefined"&&_c41!==null){if(_c41[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]!==null&&_c41[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]===true){_c43=true;_c42=false;}if(_c41[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS]!==null&&_c41[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS]===true){_c44=true;_c42=false;}if(_c44&&_c43){_c42=true;}}if(this._events===null){this._loadEventsFromXML();}var _c45=[];for(var _c46 in this._events){if(Object.prototype.hasOwnProperty.call(this._events,_c46)){_c45.push(this._events[_c46]);}}var _c47;if(this._defaultEventProvider){var _c48=this._defaultEventProvider.getEvents(_c41);var _c49=_c48.length;for(var i=0;i<_c49;++i){_c47=_c48[i];if(_c47.isHandled()){namePrefix=this.HANDLED_NAME_PREFIX;}else{namePrefix=this.PUBLISHED_NAME_PREFIX;}if(!(namePrefix+_c47.getName() in this._events)){_c45.push(_c47);}}}var _c4a=[];if(!_c42){var _c4b=_c45.length;for(var j=0;j<_c4b;++j){_c47=_c45[j];if(_c43&&_c47.isHandled()){_c4a.push(_c47);}else{if(_c44&&_c47.isPublished()){_c4a.push(_c47);}}}_c45=_c4a;}return _c45;},getEvent:function(name){if(this._events===null){this._loadEventsFromXML();}if(name===null){return null;}var _c4c=this.HANDLED_NAME_PREFIX+name;if(_c4c in this._events){return this._events[_c4c];}_c4c=this.PUBLISHED_NAME_PREFIX+name;if(_c4c in this._events){return this._events[_c4c];}return null;},_loadEventsFromXML:function(){var expr=this.EVENTS_XPATH;var _c4d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this._getEventXML(),this.ns);this._events={};if(!_c4d){return;}var _c4e=_c4d.length;var _c4f;for(var i=0;i<_c4e;++i){var _c50=new com.ibm.mm.enabler.widget.ModifiableEventImpl(_c4d[i],this);var _c51;if(_c50.isHandled()){_c51=this.HANDLED_NAME_PREFIX;}else{_c51=this.PUBLISHED_NAME_PREFIX;}var _c52=_c51+_c50.getName();this._events[_c52]=_c50;}},getEventByID:function(id){if(this._events===null){this._loadEventsFromXML();}if(id===null){return null;}var _c53=this.getEvents(null);if(_c53&&_c53!==null){for(var i=0,l=_c53.length;i<l;i++){if(_c53[i].getID()===id){return _c53[i];}}}return null;},_getEventXML:function(){return this.xmlData;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.WidgetDefinitionImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.WidgetDefinitionImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.WidgetDefinitionImpl");dojo.declare("com.ibm.mm.enabler.widget.WidgetDefinitionImpl",[com.ibm.mashups.enabler.widget.WidgetDefinition,com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.MetaDataImpl2,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.widget.PreferencesProviderImpl,com.ibm.mm.enabler.widget.ModifiableEventProviderImpl],{constructor:function(_c54,_c55,_c56){this.xmlData=_c54;this.portletXML=_c55;this.model=_c56;this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XSI]));this.modes=null;this._defaultEventProvider=new com.ibm.mm.enabler.widget.SimpleEventProviderImpl(this.portletXML);this.MODEL_NS=this.ns.model;this.MODEL_SUPPORTS="model:supports";this.MODEL_MIME_TYPE="model:mime-type";this.MODEL_PORTLET_MODE="model:portlet-mode";},_setXMLData:function(_c57,_c58){this.xmlData=_c57;this.portletXML=_c58;this._setClean();},_getPreferencesXML:function(){return this.xmlData;},_getDefaultPreferencesXML:function(){return this.portletXML;},_isDirty:function(){return this.getPreferences()._isDirty()||this._isEventProviderDirty();},_setClean:function(){this.getPreferences()._setClean();this._setEventProviderClean();},_createModeMap:function(){this.portlet2WidgetModesMap={view:"view",edit_defaults:"edit",edit:"personalize",config:"config",help:"help"};this.widget2PortletModesMap={view:"view",edit:"edit_defaults",personalize:"edit",config:"config",help:"help"};},getSupportedModes:function(){if(!this.portlet2WidgetModesMap){this._createModeMap();}var expr="atom:content/model:portlet-definition/model:supports[model:mime-type='html']/model:portlet-mode";var _c59=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _c5a=this.portlet2WidgetModesMap;return dojo.map(_c59||[],function(node){var _c5b=com.ibm.mm.enabler.utils.Dom.textContent(node);if(_c5b in _c5a){return _c5a[_c5b];}return _c5b;});},_setSupportedModes:function(_c5c){if(!this.widget2PortletModesMap){this._createModeMap();}var _c5d=this.xmlData.ownerDocument;var expr="atom:content/model:portlet-definition/model:supports[model:mime-type='html']";var _c5e=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _c5f=null;if(_c5e&&_c5e.length>0){_c5f=_c5e[0];if(_c5f.hasChildNodes()){var _c60=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("*",_c5f,this.ns);dojo.forEach(_c60,dojo.destroy);}}else{expr="atom:content/model:portlet-definition";var _c61=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.li_ns);if(!_c61||_c61.length===0){return;}_c5f=com.ibm.mm.enabler.utils.Dom.createElement(_c5d,this.MODEL_SUPPORTS,this.MODEL_NS);_c61[0].appendChild(_c5f);}if(!_c5f){return;}var _c62=com.ibm.mm.enabler.utils.Dom.createElement(_c5d,this.MODEL_MIME_TYPE,this.MODEL_NS);com.ibm.mm.enabler.utils.Dom.textContent(_c62,"html");_c5f.appendChild(_c62);if(!dojo.isArray(_c5c)){return;}var _c63=this.widget2PortletModesMap;for(var i=0,l=_c5c.length;i<l;i++){var _c64=_c5c[i];var _c65=_c64;if(_c64 in _c63){_c65=_c63[_c64];}var _c66=com.ibm.mm.enabler.utils.Dom.createElement(_c5d,this.MODEL_PORTLET_MODE,this.MODEL_NS);com.ibm.mm.enabler.utils.Dom.textContent(_c66,_c65);_c5f.appendChild(_c66);}}});}if(!dojo._hasResource["com.ibm.mm.iwidget.parser.WidgetParser"]){dojo._hasResource["com.ibm.mm.iwidget.parser.WidgetParser"]=true;dojo.provide("com.ibm.mm.iwidget.parser.WidgetParser");dojo.declare("com.ibm.mm.iwidget.parser.WidgetParser",null,{parseWidgetDefinition:function(){return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.xslt"]){dojo._hasResource["com.ibm.mm.enabler.xslt"]=true;dojo.provide("com.ibm.mm.enabler.xslt");com.ibm.mm.enabler.xslt.ie={};com.ibm.mm.enabler.xslt.gecko={};com.ibm.mm.enabler.xslt.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);com.ibm.mm.enabler.xslt.getXmlHttpRequest=function(){var oXml=null;if(typeof ActiveXObject!="undefined"){oXml=new ActiveXObject("Microsoft.XMLHTTP");}else{oXml=new XMLHttpRequest();}return oXml;};com.ibm.mm.enabler.xslt.loadXml=function(sUrl){if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.loadXml(sUrl);}else{return com.ibm.mm.enabler.xslt.gecko.loadXml(sUrl);}};com.ibm.mm.enabler.xslt.loadXmlString=function(sXml){if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.loadXmlString(sXml);}else{var _c67=new DOMParser();return com.ibm.mm.enabler.xslt.gecko.loadXmlString(sXml);}};com.ibm.mm.enabler.xslt.loadXsl=function(sUrl){if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.loadXsl(sUrl);}else{return com.ibm.mm.enabler.xslt.gecko.loadXsl(sUrl);}};com.ibm.mm.enabler.xslt.transform=function(xml,xsl,_c68,_c69,_c6a){var _c6b=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _c6c="transform";var _c6d=com.ibm.mm.enabler.xslt.LOGGER.isLoggable(_c6b);if(_c6d){com.ibm.mm.enabler.xslt.LOGGER.entering(_c6c,arguments);}if(typeof ActiveXObject!="undefined"){return com.ibm.mm.enabler.xslt.ie.transform(xml,xsl,_c68,_c69,_c6a);}else{return com.ibm.mm.enabler.xslt.gecko.transform(xml,xsl,_c68,_c69,_c6a);}};com.ibm.mm.enabler.xslt.transformAndUpdate=function(_c6e,xml,xsl,_c6f,_c70){var _c71=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _c72="transformAndUpdate";var _c73=com.ibm.mm.enabler.xslt.LOGGER.isLoggable(_c71);if(_c73){com.ibm.mm.enabler.xslt.LOGGER.entering(_c72,arguments);}var _c74;if(typeof ActiveXObject!="undefined"){_c74=com.ibm.mm.enabler.xslt.ie.transform(xml,xsl,_c6f,_c70,true);if(_c73){com.ibm.mm.enabler.xslt.LOGGER.trace(_c72,"XSLT result: "+_c74);}_c6e.innerHTML+=_c74;}else{_c74=com.ibm.mm.enabler.xslt.gecko.transform(xml,xsl,_c6f,_c70,false);if(_c73){com.ibm.mm.enabler.xslt.LOGGER.trace(_c72,"XSLT result: "+(new XMLSerializer()).serializeToString(_c74));}var _c75=_c74.documentElement;if(_c74.documentElement.tagName=="transformiix:result"){_c75=_c74.documentElement.childNodes;com.ibm.mm.enabler.utils.Dom.copyChildren(_c74.documentElement,_c6e,true);}else{if(_c73){com.ibm.mm.enabler.xslt.LOGGER.trace(_c72,"Appending: "+(new XMLSerializer()).serializeToString(_c75));}_c6e.appendChild(_c75);}}if(_c73){com.ibm.mm.enabler.xslt.LOGGER.exiting(_c72);}};com.ibm.mm.enabler.xslt.ie.loadXml=function(sUrl){var _c76=new ActiveXObject("MSXML2.DOMDocument");_c76.async=0;_c76.resolveExternals=0;if(!_c76.load(sUrl)){throw new Error("Error loading xml file "+sUrl);}return _c76;};com.ibm.mm.enabler.xslt.ie.loadXmlString=function(sXml){var _c77=new ActiveXObject("MSXML2.DOMDocument");_c77.async=0;_c77.resolveExternals=0;if(!_c77.loadXML(sXml)){throw new Error("Error loading xml string "+sXml);}return _c77;};com.ibm.mm.enabler.xslt.ie.loadXsl=function(sUrl){var _c78=new ActiveXObject("MSXML2.FreeThreadedDOMDocument");_c78.async=0;_c78.resolveExternals=0;if(!_c78.load(sUrl)){throw new Error("Error loading xsl file "+sUrl);}return _c78;};com.ibm.mm.enabler.xslt.ie.transform=function(_c79,xsl,_c7a,_c7b,_c7c){var oXml=_c79;var oXsl=xsl;try{if(!oXsl.documentElement){oXsl=this.loadXsl(xsl);}}catch(e){var sMsg=e.message;throw new Error(""+sMsg,""+sMsg);}var _c7d=new ActiveXObject("Msxml2.XSLTemplate");_c7d.stylesheet=oXsl;var _c7e=_c7d.createProcessor();_c7e.input=oXml;if(_c7b){com.ibm.mm.enabler.utils.Misc.forIn(_c7b,function(_c7f,key,obj){this.addParameter(key,_c7f);},_c7e);}if(_c7a){_c7e.addParameter("mode",_c7a);}if(_c7c){if(!_c7e.transform()){throw new Error("Error transforming xml doc "+oXml);}return _c7e.output;}else{var _c80=new ActiveXObject("MSXML2.DOMDocument");_c80.async=0;_c80.validateOnParse=1;oXml.transformNodeToObject(oXsl,_c80);return _c80;}};com.ibm.mm.enabler.xslt.gecko.loadXml=function(sUrl){};com.ibm.mm.enabler.xslt.gecko.loadXmlString=function(sXml){var _c81=new DOMParser();var _c82;try{_c82=_c81.parseFromString(sXml,"text/xml");}catch(exc){throw new Error("Error loading xml string "+sXml);}return _c82;};com.ibm.mm.enabler.xslt.gecko.loadXsl=function(sUrl){var _c83=document.implementation.createDocument("","",null);_c83.async=0;_c83.load(sUrl);return _c83;};com.ibm.mm.enabler.xslt.gecko.transform=function(_c84,xsl,_c85,_c86,_c87){try{var _c88=xsl;if(!_c88.documentElement){_c88=this.loadXsl(xsl);}var proc=new XSLTProcessor();proc.importStylesheet(_c88);if(_c86){com.ibm.mm.enabler.utils.Misc.forIn(_c86,function(_c89,key,obj){this.setParameter(null,key,_c89);},proc);}if(_c85){proc.setParameter(null,"mode",_c85);}var _c8a=proc.transformToDocument(_c84);if(!_c87){return _c8a;}resultStr=_c8a.documentElement.childNodes[0].textContent;}catch(exc){throw new Error("Error transforming xml doc "+exc);}return resultStr;};com.ibm.mm.enabler.xslt.setLayerContentByXml=function(_c8b,xml,xsl,_c8c,_c8d){var _c8e=com.ibm.mm.enabler.xslt.transform(xml,xsl,null,_c8c,_c8d);if(_c8b.innerHTML){_c8b.innerHTML=_c8e;}else{var obj=document.getElementById(_c8b);obj.innerHTML=_c8e;}};}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetDefinitionLegacyImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetDefinitionLegacyImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetDefinitionLegacyImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetDefinitionLegacyImpl",com.ibm.mashups.iwidget.widget.IWidgetDefinition,{constructor:function(name,_c8f,_c90,_c91,_c92,uri,_c93,_c94,_c95,_c96,_c97,_c98){var arg1=name;if(dojo.isString(arg1)){this.name=name;this.markup=_c8f;this.iScope=_c90;this.itemSetsArr=_c91;this.uri=uri;this.widgetEvents=_c92;this.publishedEvents=_c94;this.handledEvents=_c95;this.supportedModes=_c93;this.resources=_c96;this.payloadDefs=_c97;this.iDescriptor=_c98;}else{this.name=arg1.name;this.markup=arg1.markup;this.metaData=arg1.metaData;this.events=arg1.events;this.itemSets=arg1.itemSets;this.resources=arg1.resources;this.payloadDefs=arg1.payloadDefs;this.iScope=this.metaData.iScope;this.supportedModes=this.metaData.supportedModes;this.uri=this.metaData.contentURI;var _c99;this.widgetEvents={};for(_c99 in this.metaData){if(_c99.indexOf("on")===0){this.widgetEvents[_c99]=this.metaData[_c99];}}var _c9a=arg1.events.publishedEvents;this.publishedEvents={};this.handledEvents={};var _c9b;var _c9c;for(_c9b in _c9a){if(Object.prototype.hasOwnProperty.call(_c9a,_c9b)){_c99=_c9a[_c9b];_c9c=new com.ibm.mm.iwidget.IEventDescriptionImpl(_c99.eventName,_c99.payloadType,_c99.description,_c99.onEvent);if(!this.publishedEvents[_c9b]){this.publishedEvents[_c9b]=[];}this.publishedEvents[_c9b].push(_c9c);}}var _c9d=arg1.events.handledEvents;for(_c9b in _c9d){if(Object.prototype.hasOwnProperty.call(_c9d,_c9b)){_c99=_c9d[_c9b];_c9c=new com.ibm.mm.iwidget.IEventDescriptionImpl(_c99.eventName,_c99.payloadType,_c99.description,_c99.onEvent);if(!this.handledEvents[_c9b]){this.handledEvents[_c9b]=[];}this.handledEvents[_c9b].push(_c9c);}}var _c9e;this.itemSetsArr={};for(_c9e in arg1.itemSets){if(Object.prototype.hasOwnProperty.call(arg1.itemSets,_c9e)){var _c9f=arg1.itemSets[_c9e];var _ca0;if(_c9e=="attributes"){_ca0=new com.ibm.mm.iwidget.itemset.ItemSetDefaultImpl(_c9f.name,_c9f.onItemSetChanged);}else{_ca0=new com.ibm.mm.iwidget.itemset.ItemSetDefaultImpl(_c9f.name,_c9f.onItemSetChanged);}_ca0.itemLists.items=_c9f.itemLists;this.itemSetsArr[_c9e]=_ca0;}}}},_getPublishedEvents:function(){return this.publishedEvents;},_getHandledEvents:function(){return this.handledEvents;},getPublishedEvents:function(){var arr=[];for(var i in this.publishedEvents){if(Object.prototype.hasOwnProperty.call(this.publishedEvents,i)){arr.push(this.publishedEvents[i]);}}return arr;},getHandledEvents:function(){var arr=[];for(var i in this.handledEvents){if(Object.prototype.hasOwnProperty.call(this.handledEvents,i)){arr.push(this.handledEvents[i]);}}return arr;},getAttributes:function(){var _ca1=this.itemSetsArr.attributes;if(!_ca1){_ca1={name:"attributes",items:{}};}if(typeof (this.uri)!="undefined"&&_ca1){_ca1.items.contentURI={id:"contentURI",value:this.uri,readOnly:false};}if(typeof (this.supportedModes)!="undefined"&&_ca1){_ca1.items.supportedModes={id:"supportedModes",value:this.uri,readOnly:false};}return _ca1;},getAllItemSetNames:function(){var _ca2=[];if(!this.itemSetsArr){return _ca2;}var i=0;for(var _ca3 in this.itemSetsArr){if(Object.prototype.hasOwnProperty.call(this.itemSetsArr,_ca3)){var _ca4=this.itemSetsArr[_ca3];if(typeof (_ca4)!="undefined"){_ca2[i]=_ca4.name;}i++;}}return _ca2;},getItemSet:function(name){if(name=="attributes"){return this.getAttributes();}var _ca5=this.itemSetsArr[name];if(typeof (_ca5)!="undefined"){return _ca5;}return null;},getPublishedEventsNames:function(){if(!this.publishedEvents){return null;}var _ca6=[];var _ca7;for(_ca7 in this.publishedEvents){if(Object.prototype.hasOwnProperty.call(this.publishedEvents,_ca7)){_ca6.push(_ca7);}}return _ca6;},getHandledEventsNames:function(){if(!this.handledEvents){return null;}var _ca8=[];var _ca9;for(_ca9 in this.handledEvents){if(Object.prototype.hasOwnProperty.call(this.handledEvents,_ca9)){_ca8.push(_ca9);}}return _ca8;},getPublishedEvent:function(_caa){if(!this.publishedEvents){return null;}return this.publishedEvents[_caa];},getHandledEvent:function(_cab){if(!this.handledEvents){return null;}return this.handledEvents[_cab];},getWidgetName:function(){return this.name;},getPayloadDefs:function(){return this.payloadDefs;},getPayloadDef:function(name){var _cac=this.payloadDefs[name];if(typeof _cac=="undefined"){return null;}return _cac;},getPayloadDefNames:function(){var arr=[];var a;for(a in this.payloadDefs){if(Object.prototype.hasOwnProperty.call(this.payloadDefs,a)){arr.push(a);}}return arr;},getSupportedModes:function(){var temp=this.supportedModes;if(!temp){return null;}var arr=temp.split(" ");return arr;},getIDescriptorItems:function(){return null;},getMarkupByMode:function(mode){return this.markup;},getWidgetEvents:function(){return this.widgetEvents;},getIScope:function(){return this.iScope;},getResources:function(){return this.resources;},getDefaultLanguage:function(){return "en";},getMarkup:function(){return this.markup;},getAllowInstanceContent:function(){return false;},_getShareableItemSets:function(){return null;},_getManagedItemSetListener:function(_cad){return null;},getXmlBase:function(){return null;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.parser.LegacyXMLParser"]){dojo._hasResource["com.ibm.mm.iwidget.parser.LegacyXMLParser"]=true;dojo.provide("com.ibm.mm.iwidget.parser.LegacyXMLParser");dojo.declare("com.ibm.mm.iwidget.parser.LegacyXMLParser",com.ibm.mm.iwidget.parser.WidgetParser,{constructor:function(_cae){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.xmlStr=_cae;},namespaces:{"iw":"http://www.ibm.com/iWidget"},parseWidgetDefinition:function(){var _caf=com.ibm.mm.enabler.xslt.loadXmlString(this.xmlStr);var _cb0=this.readMarkup(_caf);var _cb1=this.readItemSets(_caf);var uri=this.readContentURI(_caf);var _cb2=this.readWidgetEvents(_caf);var name=this.readName(_caf);var _cb3=this.readiScope(_caf);var _cb4=this.readSupportedModes(_caf);var _cb5=this.readPublicEvents(_caf,"iw:handledEvents");var _cb6=this.readPublicEvents(_caf,"iw:publishedEvents");var _cb7=this.readResources(_caf);var _cb8=this.readPayloadDefs(_caf);var _cb9=this.readIDescriptor(_caf);return new com.ibm.mm.iwidget.widget.IWidgetDefinitionLegacyImpl(name,_cb0,_cb3,_cb1,_cb2,uri,_cb4,_cb6,_cb5,_cb7,_cb8,_cb9);},readMarkup:function(_cba){var _cbb="readMarkup";var _cbc=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_cbc){this.LOGGER.entering(_cbb,arguments);}var _cbd="/iw:iwidget/iw:content";var _cbe=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_cbd,_cba,this.namespaces);var _cbf="";if(_cbe&&_cbe.length>0){var _cc0=_cbe[0];var _cc1=_cc0.childNodes;for(var j=0;j<_cc1.length;j++){var _cc2=_cc1[j];if(_cc2.nodeType==4){_cbf=_cbf.concat(_cc2.nodeValue);}else{if(_cc2.nodeType==3){_cbf=_cbf.concat(_cc2.nodeValue);}}}}if(_cbc){this.LOGGER.exiting(_cbb,_cbf);}return _cbf;},readSupportedModes:function(_cc3){var root=_cc3.documentElement;var _cc4=root.getAttribute("supportedModes");if(typeof _cc4=="undefined"||_cc4===null){return null;}return _cc4;},readItemSets:function(_cc5){var _cc6="readItemSets";var _cc7=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_cc7){this.LOGGER.entering(_cc6,arguments);}var _cc8={};var _cc9="/iw:iwidget/iw:itemSet";var _cca=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_cc9,_cc5,this.namespaces);for(var i=0;i<_cca.length;i++){var _ccb=_cca[i];var id=_ccb.getAttribute("name");var _ccc=_ccb.getAttribute("onItemSetChanged");var _ccd={id:id,onItemSetChanged:_ccc};_ccd.items={};var _cce=_ccb.childNodes;for(var j=0;j<_cce.length;j++){var _ccf=_cce[j];if(_ccf.nodeType==1){var _cd0=_ccf.getAttribute("readOnly");var _cd1={id:_ccf.getAttribute("name"),value:_ccf.getAttribute("value"),readOnly:_cd0};_ccd.items[_cd1.id]=_cd1;}}_cc8[id]=_ccd;}if(_cc7){this.LOGGER.exiting(_cc6);}return _cc8;},readPayloadDefs:function(_cd2){var _cd3="readPayloadDefs";var _cd4=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_cd4){this.LOGGER.entering(_cd3,arguments);}var _cd5={};var _cd6="/iw:iwidget/iw:payloadDef";var _cd7=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_cd6,_cd2,this.namespaces);for(var i=0;i<_cd7.length;i++){var _cd8=_cd7[i];var _cd9=com.ibm.mm.iwidget.Utils.getPayloadDef(_cd8);_cd5[_cd9.name]=_cd9;}if(_cd4){this.LOGGER.exiting(_cd3,_cd5);}return _cd5;},readName:function(_cda){var root=_cda.documentElement;var name=root.getAttribute("name");if(typeof name=="undefined"||name===null){return null;}return name;},readContentURI:function(_cdb){var root=_cdb.documentElement;var uri=root.getAttribute("contentURI");if(typeof uri=="undefined"||uri===null){return null;}return uri;},readiScope:function(_cdc){var root=_cdc.documentElement;var _cdd=root.getAttribute("iScope");if(typeof _cdd=="undefined"||_cdd===null){return null;}return _cdd;},readWidgetEvents:function(_cde){var root=_cde.documentElement;var _cdf={};var _ce0=root.attributes;for(var i=0;i<_ce0.length;i++){var _ce1=_ce0[i];if(_ce1.name.indexOf("on")===0){var _ce2=_ce1.value;if(typeof _ce2!="undefined"&&_ce2!==null){_cdf[_ce1.name]=_ce2;}}}return _cdf;},readPublicEvents:function(_ce3,_ce4){var _ce5="/iw:iwidget/"+_ce4;var _ce6=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_ce5,_ce3,this.namespaces);var _ce7={};if(typeof _ce6!="undefined"&&_ce6!==null&&_ce6.length!==0){var node=_ce6[0];var _ce8=node.childNodes;for(var j=0;j<_ce8.length;j++){var _ce9=_ce8[j];if(_ce9.nodeType==1){var _cea=new com.ibm.mm.iwidget.IEventDescriptionImpl(_ce9.getAttribute("eventName"),_ce9.getAttribute("onEvent"),_ce9.getAttribute("payloadType"),_ce9.getAttribute("description"));_ce7[_ce9.getAttribute("eventName")]=_cea;}}}if(!_ce7){return null;}return _ce7;},readResources:function(_ceb){var _cec="/iw:iwidget/iw:resource";var _ced=[];var _cee=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_cec,_ceb,this.namespaces);if(typeof _cee!="undefined"&&_cee!==null&&_cee.length!==0){for(var i=0;i<_cee.length;i++){var node=_cee[i];var _cef={};_cef.name=node.getAttribute("resourceName");_cef.src=node.getAttribute("uri");_cef.version=node.getAttribute("version");_cef.callback=node.getAttribute("callback");_cef.mimetype=node.getAttribute("mimetype");_ced[i]=_cef;}}return _ced;},readIDescriptor:function(_cf0){return null;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.parser.StandardXMLParser"]){dojo._hasResource["com.ibm.mm.iwidget.parser.StandardXMLParser"]=true;dojo.provide("com.ibm.mm.iwidget.parser.StandardXMLParser");dojo.declare("com.ibm.mm.iwidget.parser.StandardXMLParser",com.ibm.mm.iwidget.parser.WidgetParser,{constructor:function(_cf1){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.xmlStr=_cf1;},namespaces:{"iw":"http://www.ibm.com/xmlns/prod/iWidget"},reservedAttributes:{iScope:"iScope",supportedModes:"supportedModes",id:"id",allowInstanceContent:"allowInstanceContent",lang:"lang","xmlns:iw":"xmlns:iw",supportedWindowStates:"supportedWindowStates","xml:lang":"xml:lang","xml:base":"xml:base"},parseWidgetDefinition:function(){var _cf2=com.ibm.mm.enabler.xslt.loadXmlString(this.xmlStr);var _cf3=this.readRootElement(_cf2);_cf3.markup=this.readMarkup(_cf2);_cf3.itemSetsArr=this.readItemSets(_cf2,_cf3);_cf3.publicEvents=this.readPublicEvents(_cf2);_cf3.resources=this.readResources(_cf2);var _cf4=this.readPayloadDefs(_cf2);if(_cf4){_cf3.payloadDefs=_cf4;}_cf3.eventDescriptions=this.readEventDescriptions(_cf2);_cf3.xmlStr=this.xmlStr;return new com.ibm.mm.iwidget.widget.IWidgetDefinitionImpl(_cf3,this.xmlStr);},readRootElement:function(_cf5){var _cf6={};var root=_cf5.documentElement;var _cf7=root.getAttribute("supportedModes");if(!_cf7){_cf7="view";}_cf6.supportedModes=_cf7;var _cf8;var name=root.getAttribute("id");if(!name){name=null;}_cf6.id=name;_cf6.name=name;var temp=root.getAttribute("allowInstanceContent");var _cf9=false;if(temp&&temp=="true"){_cf9=true;}_cf6.allowInstanceContent=_cf9;var lang=root.getAttribute("lang");if(!lang){lang=root.getAttribute("xml:lang");}if(!lang){lang="en";}_cf6.lang=lang;var _cfa={};var _cfb=root.attributes;var i;for(i=0;i<_cfb.length;i++){var _cfc=_cfb[i];if(_cfc.name.indexOf("on")===0){var _cfd=_cfc.value;if(_cfd){_cfa[_cfc.name]=_cfd;}}}_cf6.widgetEvents=_cfa;var _cfe=root.getAttribute("iScope");if(!_cfe){_cfe=null;}_cf6.iScope=_cfe;var _cff=iwConstants.iDescriptorItems;var _d00={};for(var j in _cff){if(Object.prototype.hasOwnProperty.call(_cff,j)){name=_cff[j];_cf8=root.getAttribute(name);_d00[name]=_cf8;}}_cf6.iDescriptor=_d00;var _d01={};_cfb=root.attributes;for(i=0;i<_cfb.length;i++){var att=_cfb[i];if(att.name.indexOf("on")!==0&&!iwConstants.iDescriptorItems[att.name]&&!this.reservedAttributes[att.name]){_cf8=att.value;if(typeof _cf8!="undefined"&&_cf8!==null){_d01[att.name]=_cf8;}}}_cf6.simpleAttributes=_d01;var _d02=root.getAttribute("supportedWindowStates");if(!_d02){_d02="normal";}_cf6.supportedWindowStates=_d02;var _d03=root.getAttribute("xml:base");if(_d03){_cf6.xmlBase=_d03;}return _cf6;},readMarkup:function(_d04){var _d05="readMarkup";var _d06=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_d06){this.LOGGER.entering(_d05,arguments);}var _d07="/iw:iwidget/iw:content";var _d08=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_d07,_d04,this.namespaces);var _d09={};var _d0a="";var mode=null;if(_d08&&_d08.length>0){for(var i=0;i<_d08.length;i++){var _d0b=_d08[i];var _d0c=_d0b.childNodes;for(var j=0;j<_d0c.length;j++){var _d0d=_d0c[j];if(_d0d.nodeType==4){_d0a=_d0a.concat(_d0d.nodeValue);}else{if(_d0d.nodeType==3){_d0a=_d0a.concat(_d0d.nodeValue);}}}mode=_d0b.getAttribute("mode");if(!mode){mode="view";break;}uri=_d0b.getAttribute("uri");_d09[mode]={};if(uri){_d09[mode].uri=uri;}_d09[mode].content=_d0a;_d0a="";}}if(_d06){this.LOGGER.exiting(_d05,_d09);}return _d09;},readItemSets:function(_d0e,_d0f){var _d10="readItemSets";var _d11=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_d11){this.LOGGER.entering(_d10,arguments);}var _d12={};var _d13={};var _d14="/iw:iwidget/iw:itemSet";var _d15=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_d14,_d0e,this.namespaces);for(var i=0;i<_d15.length;i++){var _d16=_d15[i];var _d17=_d16.getAttribute("id");var _d18=_d16.getAttribute("alias")?_d16.getAttribute("alias"):null;if(!_d18){_d18=_d16.getAttribute("globalid")?_d16.getAttribute("globalid"):null;if(_d18){this.LOGGER.warning(_d10,"globalid is deprecated please use alias instead");}}var _d19=_d16.getAttribute("onItemSetChanged");var temp=_d16.getAttribute("private");var _d1a=true;if(temp&&temp=="false"){_d1a=false;}var _d1b=_d16.getAttribute("description");var _d1c={id:_d17,onItemSetChanged:_d19,isPrivate:_d1a};if(_d18){_d1c.alias=_d18;}_d1c.items={};var _d1d=_d16.childNodes;for(var j=0;j<_d1d.length;j++){var _d1e=_d1d[j];if(_d1e.nodeType==1){var _d1f=false;var _d20=_d1e.getAttribute("readOnly");if(_d20&&_d20=="true"){_d1f=true;}var id=_d1e.getAttribute("id");var _d21=_d1e.getAttribute("alias")?_d1e.getAttribute("alias"):null;if(!_d21){_d21=_d1e.getAttribute("globalid")?_d1e.getAttribute("globalid"):null;if(_d21){this.LOGGER.warning(_d10,"globalid is deprecated please use alias instead");}}var _d22=_d1e.getAttribute("value");var lang=_d1e.getAttribute("lang");if(!lang){lang=_d1e.getAttribute("xml:lang");}var _d23={};_d23.id=id;if(_d21){_d23.alias=_d21;}_d23.readOnly=_d1f;if(!lang&&(typeof _d22!="undefined"&&_d22!==null)){_d23.value=_d22;}if(lang){_d23.defaultLocale=lang;}if(lang&&(typeof _d22!="undefined"&&_d22!==null)){_d23.values={};_d23.values[lang]=_d22;}var _d24=_d1e.childNodes;if(_d24.length>0||(lang&&_d22)){for(var v=0;v<_d24.length;v++){var _d25=_d24[v];if(_d25.nodeType==1){var _d26=_d25.getAttribute("lang");if(!_d26){_d26=_d25.getAttribute("xml:lang");}if(!_d26){_d26="en";}var _d27=_d25.getAttribute("value");_d23.values=_d23.values?_d23.values:{};_d23.values[_d26]=_d27;}}}_d1c.items[id]=_d23;}}if(_d1a){_d13[_d17]=_d1c;}else{_d12[_d17]=_d1c;}}_d0f.shareableItemSetsArr=_d12;if(_d11){this.LOGGER.exiting(_d10,_d13);}return _d13;},readPayloadDefs:function(_d28){var _d29="readPayloadDefs";var _d2a=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_d2a){this.LOGGER.entering(_d29,arguments);}var _d2b={};var _d2c="/iw:iwidget/iw:payloadDef";var _d2d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_d2c,_d28,this.namespaces);for(var i=0,l=_d2d.length;i<l;i++){var _d2e=_d2d[i];var _d2f=com.ibm.mm.iwidget.Utils.getPayloadDef(_d2e);_d2b[_d2f.name]=_d2f;}if(com.ibm.mm.enabler.utils.Misc.isEmpty(_d2b)===true){_d2b=null;}if(_d2a){this.LOGGER.exiting(_d29,_d2b);}return _d2b;},readPublicEvents:function(_d30,_d31){var _d32={};var _d33="/iw:iwidget/iw:event";var _d34=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_d33,_d30,this.namespaces);if(_d34&&_d34.length!==0){for(var j=0;j<_d34.length;j++){var _d35=_d34[j];if(_d35.nodeType==1){var _d36={};var _d37=_d35.attributes;for(var i=0;i<_d37.length;i++){var att=_d37[i];var name=att.name;var _d38=att.value;if(name=="eventDescName"){name="description";}if(name=="handled"){name="isHandled";}if(name=="published"){name="isPublished";}if(_d38){_d36[name]=_d38;}}_d32[_d36.id]=_d36;}}}return _d32;},readResources:function(_d39){var _d3a="/iw:iwidget/iw:resource";var _d3b=[];var _d3c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_d3a,_d39,this.namespaces);if(_d3c&&_d3c.length!==0){for(var i=0;i<_d3c.length;i++){var node=_d3c[i];var _d3d={};var id=node.getAttribute("id");if(!id){id=node.getAttribute("globalid");}_d3d[iwConstants.RESOURCE.id]=id;_d3d[iwConstants.RESOURCE.globalid]=node.getAttribute("globalid")?node.getAttribute("globalid"):null;var src=node.getAttribute("src");if(!src){src=node.getAttribute("uri");}_d3d[iwConstants.RESOURCE.src]=src;_d3d[iwConstants.RESOURCE.version]=node.getAttribute("version");_d3d[iwConstants.RESOURCE.blockInit]=node.getAttribute("blockInit");_d3d[iwConstants.RESOURCE.callback]=node.getAttribute("callback");_d3d[iwConstants.RESOURCE.mimeType]=node.getAttribute("mimeType");_d3d[iwConstants.RESOURCE.skipLoad]=node.getAttribute("skipLoad");if(!_d3d[iwConstants.RESOURCE.skipLoad]){var _d3e=node.childNodes;var _d3f=null;for(var j=0;j<_d3e.length;j++){_d3f=_d3e[j];if(_d3f.nodeType==1){break;}}if(_d3f){_d3e=_d3f.childNodes;for(var h=0;h<_d3e.length;h++){if(_d3e[h].nodeType==4){_d3d[iwConstants.RESOURCE.skipLoad]=_d3e[h].nodeValue;}}}}_d3b[i]=_d3d;}}return _d3b;},readEventDescriptions:function(_d40){var _d41="iw:iwidget/iw:eventDescription";var _d42={};var _d43=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_d41,_d40,this.namespaces);if(_d43&&_d43.length!==0){for(var i=0;i<_d43.length;i++){var node=_d43[i];var _d44={};var id=node.getAttribute("id");_d44.id=id;_d44.payloadType=node.getAttribute("payloadType");_d44.description=node.getAttribute("description");_d44.title=node.getAttribute("title");_d44.descriptionURI=node.getAttribute("descriptionURI");var lang=node.getAttribute("lang");if(!lang){lang=node.getAttribute("xml:lang");}_d44.lang=lang;_d44.aliases=node.getAttribute("aliases");_d44.descriptions={};var _d45=node.childNodes;for(var j=0;j<_d45.length;j++){var _d46=_d45[j];if(_d46.nodeType==1){var temp={};var _d47=_d46.getAttribute("lang");if(!_d47){_d47=_d46.getAttribute("xml:lang");}temp.description=_d46.getAttribute("description");temp.title=_d46.getAttribute("title");temp.descriptionURI=_d46.getAttribute("descriptionURI");_d44.descriptions[_d47]=temp;}}_d42[id]=_d44;}}return _d42;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.parser.WidgetParserFactory"]){dojo._hasResource["com.ibm.mm.iwidget.parser.WidgetParserFactory"]=true;dojo.provide("com.ibm.mm.iwidget.parser.WidgetParserFactory");dojo.declare("com.ibm.mm.iwidget.parser.WidgetParserFactory",null,{getWidgetParser:function(_d48){var _d49=_d48.replace(/^\s+/,"").replace(/\s+$/,"");var _d4a=this._isXML(_d49);var _d4b=this._isLegacy(_d49);if(_d4a&&_d4b){return new com.ibm.mm.iwidget.parser.LegacyXMLParser(_d49);}else{if(_d4a&&!_d4b){return new com.ibm.mm.iwidget.parser.StandardXMLParser(_d49);}}return null;},_isXML:function(_d4c){var _d4d=true;var _d4e=_d4c.indexOf("=\"http://www.w3.org/1999/xhtml\"");if(_d4e!=-1){_d4d=false;}return _d4d;},_isLegacy:function(_d4f){var _d50=true;var _d51=_d4f.indexOf("=\"http://www.ibm.com/xmlns/prod/iWidget\"");if(_d51!=-1){_d50=false;}return _d50;}});com.ibm.mm.iwidget.parser.WidgetParserFactory=new com.ibm.mm.iwidget.parser.WidgetParserFactory();}if(!dojo._hasResource["com.ibm.mm.iwidget.services.WidgetLoadServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.WidgetLoadServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.WidgetLoadServiceImpl");dojo.provide("com.ibm.mm.iwidget.services.WidgetLoadServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.WidgetLoadServiceImpl",null,{constructor:function(){this.widgetDef={};this.LOADING_TOKEN="LOADING_TOKEN";this.LOADING_ERROR_TOKEN="LOADING_ERROR_TOKEN";this.waitingqueue={};},getWidgetXML:function(_d52,sync,_d53,_d54){if(ibmConfig.dojotest){sync=true;}var _d55=this.widgetDef[_d52];if(_d55&&_d55==this.LOADING_TOKEN){if(!this.waitingqueue[_d52]){this.waitingqueue[_d52]=[];}var _d56={id:_d54,cb:_d53};this.waitingqueue[_d52].push(_d56);return;}else{if(_d55&&_d55.error&&_d55.error==this.LOADING_ERROR_TOKEN){return this.handleCallback(_d53,_d55.data,_d55.status);}else{if(_d55){return this.handleCallback(_d53,_d55,"200");}}}this.widgetDef[_d52]=this.LOADING_TOKEN;var me=this;var _d57=_d52;if(_d57.indexOf("http")===0){_d57=com.ibm.mm.enabler.utils.URLHelper.rewriteURL(_d57);}var args={url:_d57,load:function(data,_d58){var xhr=_d58.xhr;var _d59=com.ibm.mm.iwidget.parser.WidgetParserFactory.getWidgetParser(xhr.responseText);var _d5a=_d59.parseWidgetDefinition();me.widgetDef[_d52]=_d5a;me.handleCallback(_d53,_d5a,xhr.status,xhr);var _d5b=me.waitingqueue[_d52];if(_d5b){for(var i in _d5b){if(Object.prototype.hasOwnProperty.call(_d5b,i)){me.handleCallback(_d5b[i].cb,_d5a,xhr.status,xhr);}}me.waitingqueue[_d52]=null;}},error:function(data,_d5c){var xhr=_d5c.xhr;me.widgetDef[_d52]={error:me.LOADING_ERROR_TOKEN,data:data,status:xhr.status};me.handleCallback(_d53,data,xhr.status,xhr);var _d5d=me.waitingqueue[_d52];if(_d5d){for(var i in _d5d){if(Object.prototype.hasOwnProperty.call(_d5d,i)){me.handleCallback(_d5d[i].cb,data,xhr.status,xhr);}}me.waitingqueue[_d52]=null;}},handleAs:"text",sync:sync};dojo.xhrGet(args);return;},handleCallback:function(_d5e,data,_d5f,xhr){if(_d5e){_d5e(data,_d5f,xhr);}}});com.ibm.mashups.services.ServiceManager.setService("widgetLoadService",new com.ibm.mm.iwidget.services.WidgetLoadServiceImpl());}if(!dojo._hasResource["com.ibm.mm.enabler.utils.Model"]){dojo._hasResource["com.ibm.mm.enabler.utils.Model"]=true;dojo.provide("com.ibm.mm.enabler.utils.Model");com.ibm.mm.enabler.utils.Model={LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.utils.Model"),LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,getCurrentPageDeferred:function(){var _d60="getCurrentPageDeferred()";var _d61=com.ibm.mm.enabler.utils.Model.LOGGER.isLoggable(this.LOG_LEVEL);if(_d61){com.ibm.mm.enabler.utils.Model.LOGGER.entering(_d60);}var _d62=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _d63=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(_d62,null);var _d64=_d63.getPageID();if(_d61){com.ibm.mm.enabler.utils.Model.LOGGER.trace(_d60,"page id is "+_d64);}if(typeof _d64=="undefined"||null===_d64){if(_d61){com.ibm.mm.enabler.utils.Model.LOGGER.exiting(_d60,null);}return null;}var _d65=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _d66=_d65.find(_d64);if(_d61){this.LOGGER.exiting(_d60,_d66);}return _d66;},getCurrentPageLayoutModel:function(){var _d67="getCurrentPageLayoutModel()";var _d68=com.ibm.mm.enabler.utils.Model.LOGGER.isLoggable(this.LOG_LEVEL);if(_d68){com.ibm.mm.enabler.utils.Model.LOGGER.entering(_d67);}var _d69=com.ibm.mm.enabler.utils.Model.getCurrentPageDeferred().start();if(!_d69){return null;}if(_d68){com.ibm.mm.enabler.utils.Model.LOGGER.trace(_d67,"page id is "+_d69.getID());}var _d6a=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _d6b=_d6a.getLayoutModel(_d69);if(_d68){this.LOGGER.exiting(_d67,_d6b);}return _d6b;}};}if(!dojo._hasResource["com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl");dojo.declare("com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl",com.ibm.mashups.iwidget.itemset.ManagedItemSet,{constructor:function(_d6c){this.widgetWrapper=_d6c;this.widgetModel=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();this.layoutModel=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();this.modelId=com.ibm.mm.iwidget.Utils.getModelID(_d6c.getID());var _d6d=new com.ibm.mm.enabler.IdentifierImpl(this.modelId);var _d6e=this.layoutModel.find(_d6d).start();this.widgetWindow=this.widgetModel.getWidgetWindow(_d6e).start();this.widgetInstance=this.widgetModel.getWidgetInstance(this.widgetWindow).start();this.widgetDefinition=this.widgetModel.getWidgetDefinitionByInstance(this.widgetInstance).start();this.preferences=this._getPreferences();this._items={};this._initItems();this.listeners=new dojox.collections.ArrayList();this.uuid=dojox.uuid.generateRandomUuid();this.autoCommit=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.ICONTEXT_AUTO_COMMIT);dojo.subscribe(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_SET,this,"_preferencesSetCallback");dojo.subscribe(com.ibm.mashups.enabler.widget.ModifiablePreferences.TOPIC_PREFERENCES_REMOVE,this,"_preferencesRemoveCallback");},_initItems:function(){var _d6f=this.preferences.getNames();var _d70=_d6f.length;for(var i=0;i<_d70;++i){var name=_d6f[i];this._items[name]={value:this.preferences.getValue(name),change:null};}},setItemValue:function(_d71,_d72){if(!this.preferences.confirmSetValue(_d71,_d72)){return null;}if(_d71 in this._items){var _d73=this._items[_d71];_d73.value=_d72;_d73.change=com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_CHANGEDVALUE;}else{this._items[_d71]={"value":_d72,"change":com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_NEWITEM};}return this;},getItemValue:function(_d74){if(!(_d74 in this._items)){return null;}var _d75=this._items[_d74];if(_d75.change==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_REMOVEDITEM){return null;}return _d75.value;},getAllNames:function(){var _d76=[];for(var _d77 in this._items){if(Object.prototype.hasOwnProperty.call(this._items,_d77)){var _d78=this._items[_d77];if(_d78.change!==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_REMOVEDITEM){_d76.push(_d77);}}}if(_d76.length===0){return null;}return _d76;},removeItem:function(_d79){if(!(_d79 in this._items)){return null;}var _d7a=this._items[_d79].change;if(_d7a==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_NEWITEM||(_d7a==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_CHANGEDVALUE&&!this.preferences.confirmRemove(_d79))){delete this._items[_d79];return this;}if(!this.preferences.confirmRemove(_d79)){return null;}this._items[_d79].change=com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_REMOVEDITEM;this._items[_d79].value=null;return this;},isReadOnly:function(_d7b){return this.preferences.isReadOnly(_d7b);},save:function(_d7c){return this.commit(_d7c);},commit:function(_d7d){var _d7e=true;var _d7f={source:this,type:"iContext"};var _d80=[];for(var _d81 in this._items){if(Object.prototype.hasOwnProperty.call(this._items,_d81)){var _d82=this._items[_d81].change;if(_d82===null){continue;}var _d83=this.preferences.getValue(_d81);var _d84=this._items[_d81].value;if(_d82==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_NEWITEM||_d82==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_CHANGEDVALUE){if(!this.preferences.setValue(_d81,_d84,false,_d7f)){_d7e=false;}}else{if(_d82==com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_REMOVEDITEM){if(!this.preferences.remove(_d81,_d7f)){_d7e=false;}}}_d80.push({"id":_d81,"alias":null,"changeType":_d82,"oldVal":_d83,"newVal":_d84});}}var self=this;if(this.autoCommit===true){var dfr=this.widgetModel.commit();dfr.setFinishedCallback(function(){if(!_d7e){if(dojo.isFunction(_d7d)){_d7d("attributes",false);}return;}var _d85=self._createIEvent([_d80]);self._callListeners(_d85);self.preferences=self._getPreferences();self._initItems();if(_d7e){if(dojo.isFunction(_d7d)){_d7d("attributes",true);}}});dfr.start(false);}else{if(!_d7e){if(dojo.isFunction(_d7d)){_d7d("attributes",false);}return;}var _d86=this._createIEvent([_d80]);this._callListeners(_d86);this.preferences=this._getPreferences();this._initItems();if(_d7e){if(dojo.isFunction(_d7d)){_d7d("attributes",true);}}}},addListener:function(fn){if(!dojo.isFunction(fn)){return null;}this.listeners.add(fn);var _d87=this.listeners.indexOf(fn);return this.uuid+"_"+_d87;},removeListener:function(_d88){if(dojo.isFunction(_d88)){if(this.listeners.contains(fn)){this.listeners.remove(fn);}}else{if(dojo.isString(_d88)){var _d89=_d88.split(_d88);if(_d89.length!=2){return;}var _d8a=_d89[1];this.listeners.removeAt(parseInt(_d8a,10));}}return this._internal().removeListener(_d88);},_getPreferences:function(){var mode=this.widgetWrapper.currentMode;if(mode===iwConstants.mode.CONFIG){return this.widgetDefinition.getPreferences();}if(mode===iwConstants.mode.EDIT){return this.widgetModel.getHierarchicalPreferences(this.widgetInstance).start();}return this.widgetModel.getHierarchicalPreferences(this.widgetWindow).start();},_preferencesSetCallback:function(_d8b,_d8c,_d8d,_d8e,_d8f){if(_d8b!==this.preferences){return;}var type=null;if(_d8f.source===this){return;}if(_d8f.type=="iContext"){if(this._items[_d8c]&&this._items[_d8c].change===null){this._items[_d8c].value=_d8e;}else{this._items[_d8c]={value:_d8e,change:null};}}var _d90=com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_CHANGEDVALUE;if(_d8d===null){_d90=com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_NEWITEM;}var _d91={id:_d8c,alias:null,changeType:_d90,oldVal:_d8d,newVal:_d8e};var _d92=this._createIEvent([_d91]);this._callListeners(_d92);},_preferencesRemoveCallback:function(_d93,_d94,_d95,_d96,_d97){if(_d93!==this.preferences){return;}var type=null;if(_d97.source===this){return;}if(_d97.type=="iContext"){if(this._items[_d94]&&this._items[_d94].change===null){delete this._items[_d94];}}if(_d97&&_d97.type=="iContext"){return;}var _d98=com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_REMOVEDITEM;var _d99={itemName:_d94,alias:null,changeType:_d98,oldVal:_d95,newVal:_d96};var _d9a=this._createIEvent([_d99]);this._callListeners(_d9a);},_createIEvent:function(_d9b){var _d9c={name:"onItemSetChanged",type:null,source:null,payload:{itemSetName:"attributes",alias:null,changes:_d9b}};return _d9c;},_callListeners:function(_d9d){var _d9e=this.listeners.count;for(var i=0;i<_d9e;++i){var cbFn=this.listeners.item(i);if(cbFn){cbFn(_d9d);}}}});com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_NEWITEM="newItem";com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_REMOVEDITEM="removedItem";com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl.CHANGE_CHANGEDVALUE="changedValue";}if(!dojo._hasResource["com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesFactoryImpl");dojo.declare("com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesFactoryImpl",com.ibm.mashups.iwidget.itemset.PersistentAttributesFactory,{constructor:function(){this.modes=[com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL,com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL_PREFERENCES];},createPersistentAttributes:function(_d9f,_da0){return new com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesImpl(_d9f);},getSupportedPersistenceMode:function(){return this.modes;}});com.ibm.mashups.services.ServiceManager.getService("persistentAttributesFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL,new com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesFactoryImpl());com.ibm.mashups.services.ServiceManager.getService("persistentAttributesFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL_PREFERENCES,new com.ibm.mm.enabler.widget.attributes.WidgetModelPersistentAttributesFactoryImpl());}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService_API"]){dojo._hasResource["com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService_API"]=true;dojo.provide("com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService_API");dojo.provide("com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService");dojo.declare("com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService",null,{createEventModel:function(_da1,_da2){},setFactory:function(_da3,_da4){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService"]){dojo._hasResource["com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService"]=true;dojo.provide("com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService");}if(!dojo._hasResource["com.ibm.mashups.iwidget.model.EventModelFactory"]){dojo._hasResource["com.ibm.mashups.iwidget.model.EventModelFactory"]=true;dojo.provide("com.ibm.mashups.iwidget.model.EventModelFactory");dojo.declare("com.ibm.mashups.iwidget.model.EventModelFactory",null,{createEventModel:function(_da5,_da6){},getSupportedPersistenceMode:function(){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.model.EventModel"]){dojo._hasResource["com.ibm.mashups.iwidget.model.EventModel"]=true;dojo.provide("com.ibm.mashups.iwidget.model.EventModel");dojo.declare("com.ibm.mashups.iwidget.model.EventModel",null,{constructor:function(_da7){this.wrapper=_da7;},find:function(id){return null;},eventExists:function(id){return false;},createEvent:function(_da8){return null;},removeEvent:function(_da9){},updateEvent:function(_daa){},getEvents:function(_dab){}});}if(!dojo._hasResource["com.ibm.mm.enabler.utils.EventModelHelperImpl"]){dojo._hasResource["com.ibm.mm.enabler.utils.EventModelHelperImpl"]=true;dojo.provide("com.ibm.mm.enabler.utils.EventModelHelperImpl");dojo.declare("com.ibm.mm.enabler.utils.EventModelHelperImpl",null,{_PredefinedFields:{alias:"alias",name:"name",type:"type",lang:"lang",isPublished:"isPublished",isHandled:"isHandled",handlingFn:"handlingFn"},checkMatch:function(_dac,_dad){var rc=true;var _dae=[];var _daf;for(var i in _dad){if(Object.prototype.hasOwnProperty.call(_dad,i)){if(!_dad[i]){continue;}if(typeof (this._PredefinedFields[i])!="undefined"){if(i==this._PredefinedFields.isPublished&&(_dad[i]===true||_dad[i]=="true")){_daf=_dac.isPublished;if(!(_daf&&(_daf===true||_daf=="true"))){rc=false;break;}}else{if(i==this._PredefinedFields.isPublished&&(_dad[i]=="false"||_dad[i]===false)){_daf=_dac.isPublished;if(!(_daf&&(_daf===false||_daf=="false"))){rc=false;break;}}else{if(i==this._PredefinedFields.isPublished&&(_dad[i]=="false"||_dad[i]===false)){if(!this._checkBoolean(dojo.toJson(_dac),i,"false")){rc=false;break;}}else{if(i==this._PredefinedFields.isHandled&&(_dad[i]===true||_dad[i]=="true")){if(!_dac[this._PredefinedFields.handlingFn]){rc=false;break;}}else{if(i==this._PredefinedFields.isHandled&&(_dad[i]=="false"||_dad[i]===false)){if(_dac[this._PredefinedFields.handlingFn]){rc=false;break;}}else{if(!(_dac[i]&&_dac[i]==_dad[i])){rc=false;break;}}}}}}}else{if(!(_dac.attributes&&_dac.attributes[i]&&_dac.attributes[i]==_dad[i])){rc=false;break;}}}}return rc;},_checkBoolean:function(str,name,_db0){var rc=false;var temp="\""+name+"\""+":"+_db0;if(str.indexOf(temp)!=-1){return true;}temp="\""+name+"\""+":\""+_db0+"\"";if(str.indexOf(temp)!=-1){return true;}return false;}});dojo.declare("com.ibm.mashups.enabler.utils.EventModelHelper",null,{});com.ibm.mashups.enabler.utils.EventModelHelper=new com.ibm.mm.enabler.utils.EventModelHelperImpl();}if(!dojo._hasResource["com.ibm.mm.iwidget.model.DOMEventModelImpl"]){dojo._hasResource["com.ibm.mm.iwidget.model.DOMEventModelImpl"]=true;dojo.provide("com.ibm.mm.iwidget.model.DOMEventModelImpl");dojo.declare("com.ibm.mm.iwidget.model.DOMEventModelImpl",com.ibm.mashups.iwidget.model.EventModel,{constructor:function(_db1){this.wrapper=_db1;this.eventDescriptionPool={};var _db2=_db1.widgetDef._getPublicEvents();var _db3=_db1.getIWidgetInstance()._getPublicEvents();var _db4=_db2?_db2:null;if(_db3){for(var j in _db3){if(Object.prototype.hasOwnProperty.call(_db3,j)){_db4[j]=_db3[j];}}}if(_db4){var _db5={};for(var i in _db4){if(Object.prototype.hasOwnProperty.call(_db4,i)){_db5[i]=_db4[i];}}this.eventDescriptionPool=_db5;}},find:function(id){var _db6=this.eventDescriptionPool[id];if(_db6){return _db6;}if(this.wrapper.handledEvents){if(this.wrapper.handledEvents[id]){return this.wrapper.handledEvents[id][0];}}if(this.wrapper.publishedEvents){if(this.wrapper.publishedEvents[id]){return this.wrapper.publishedEvents[id][0];}}return null;},eventExists:function(_db7){var temp=this.eventDescriptionPool[_db7];if(temp){return true;}else{return false;}},_getEventDescObj:function(_db8){var obj=_db8;var _db9=_db8.declaredClass;if(typeof _db9=="undefined"||_db9===null){obj=new com.ibm.mm.iwidget.IEventDescriptionImpl(_db8);}return obj;},createEvent:function(_dba){var _dbb=this._getEventDescObj(_dba);var _dbc=this.eventExists(_dbb.name);if(_dbc){return false;}else{this.eventDescriptionPool[_dbb.name]=_dbb;return true;}},removeEvent:function(_dbd){var _dbe=this.eventExists(_dbd);if(_dbe){delete this.eventDescriptionPool[_dbd];return true;}else{return true;}},removeEvents:function(_dbf){for(var i=0;i<_dbf.length;i++){this.removeEvent(_dbf[i]);}return true;},updateEvent:function(_dc0){var _dc1=this._getEventDescObj(_dc0);var _dc2=this.eventExists(_dc1.name);if(_dc2){this.eventDescriptionPool[_dc1.name]=_dc1;}else{return false;}return true;},setEvents:function(_dc3){var rc=true;for(var i=0;i<_dc3.length;i++){var _dc4=_dc3[i];var _dc5=this.createEvent(_dc4);_dc5=_dc5||false;if(_dc5===false){_dc5=this.updateEvent(_dc4);}_dc5=_dc5||false;if(rc===true){rc=_dc5;}}return rc;},getEvents:function(_dc6){if(typeof _dc6=="undefined"||_dc6===null){return this._getEventsInArray(this.eventDescriptionPool);}var _dc7=[];if(_dc6.isHandled&&_dc6.isHandled=="true"){if(this.wrapper.handledEvents){this._addEvents(_dc7,this.wrapper.handledEvents);}}if(_dc6.isPublished&&_dc6.isPublished=="true"){if(this.wrapper.publishedEvents){this._addEvents(_dc7,this.wrapper.publishedEvents);}}if(dojo.isString(_dc6)){try{_dc6=dojo.fromJson(_dc6);}catch(e){return null;}}for(var j in this.eventDescriptionPool){if(Object.prototype.hasOwnProperty.call(this.eventDescriptionPool,j)){var _dc8=this.eventDescriptionPool[j];var rc=com.ibm.mashups.enabler.utils.EventModelHelper.checkMatch(_dc8._getInternalJsonObj(),_dc6);if(rc){_dc7.push(_dc8);}}}if(_dc7.length===0){return null;}else{return _dc7;}},_getEventsInArray:function(arr){var _dc9=[];for(var j in arr){if(Object.prototype.hasOwnProperty.call(arr,j)){_dc9.push(arr[j]);}}if(_dc9.length===0){return null;}else{return _dc9;}},_addEvents:function(arr,_dca){for(var i in _dca){if(Object.prototype.hasOwnProperty.call(_dca,i)){var _dcb=_dca[i];for(var j in _dcb){if(Object.prototype.hasOwnProperty.call(_dcb,j)){arr.push(_dcb[j]);}}}}}});}if(!dojo._hasResource["com.ibm.mm.iwidget.model.DOMEventModelFactoryImpl"]){dojo._hasResource["com.ibm.mm.iwidget.model.DOMEventModelFactoryImpl"]=true;dojo.provide("com.ibm.mm.iwidget.model.DOMEventModelFactoryImpl");dojo.declare("com.ibm.mm.iwidget.model.DOMEventModelFactoryImpl",com.ibm.mashups.iwidget.model.EventModelFactory,{constructor:function(){this.modes=["DOM"];},createEventModel:function(_dcc,_dcd){return new com.ibm.mm.iwidget.model.DOMEventModelImpl(_dcc);},getSupportedPersistenceMode:function(){return this.modes;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl",com.ibm.mashups.iwidget.services.WidgetEventModelFactoryService,{constructor:function(){this._factories={};this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},createEventModel:function(_dce,_dcf){var wID=_dce.id;if(typeof _dcf==="undefined"||_dcf===null){_dcf=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PERSISTENCE_MODE);var _dd0=_dce.rootElement;if(dojo.hasClass(_dd0,com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl.STANDALONE_CLASS)||!_dcf){_dcf=com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl.DEFAULT_PERSISTENCE;}if(typeof _dcf!=="undefined"&&_dcf==com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL){var _dd1=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _dd2=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();var _dd3=com.ibm.mm.iwidget.Utils.getModelID(wID);var _dd4=new com.ibm.mm.enabler.IdentifierImpl(_dd3);var _dd5=_dd2.find(_dd4).start();if(typeof _dd5==="undefined"||_dd5===null){_dcf=com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl.DEFAULT_PERSISTENCE;if(dojo.isFunction(_dce._getResourceBundle)){_dce._getResourceBundle();this.LOGGER.warning("createEventModel",_dce.iwMessages.W_STANDALONECLASS_MISSING_1,[wID]);}else{this.LOGGER.warning("createEventModel","widget "+wID+" is missing class "+com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone);}}}}if(!(_dcf in this._factories)){return null;}return this._factories[_dcf].createEventModel(_dce,_dcf);},setFactory:function(_dd6,_dd7){this._factories[_dd6]=_dd7;}});com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl.DEFAULT_PERSISTENCE=com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_DOM;com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl.STANDALONE_CLASS=com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone;com.ibm.mashups.services.ServiceManager.setService("WidgetEventModelFactoryService",new com.ibm.mm.iwidget.services.WidgetEventModelFactoryServiceImpl());com.ibm.mashups.services.ServiceManager.getService("WidgetEventModelFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_DOM,new com.ibm.mm.iwidget.model.DOMEventModelFactoryImpl());}if(!dojo._hasResource["com.ibm.mm.enabler.widget.icontext.WidgetModelEventsImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.icontext.WidgetModelEventsImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.icontext.WidgetModelEventsImpl");dojo.declare("com.ibm.mm.enabler.widget.icontext.WidgetModelEventsImpl",com.ibm.mashups.iwidget.model.EventModel,{constructor:function(_dd8){this.widgetWrapper=_dd8;this.widgetModel=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();this.layoutModel=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();this.modelID=com.ibm.mm.iwidget.Utils.getModelID(_dd8.getID());var _dd9=new com.ibm.mm.enabler.IdentifierImpl(this.modelID);var _dda=this.layoutModel.find(_dd9).start();this.widgetWindow=this.widgetModel.getWidgetWindow(_dda).start();this.widgetInstance=this.widgetModel.getWidgetInstance(this.widgetWindow).start();this.widgetDefinition=this.widgetModel.getWidgetDefinitionByInstance(this.widgetInstance).start();this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.xml.XPath");this._runtimeIEventModels={};this._runtimeIEventModels[iwConstants.mode.CONFIG]={};this._runtimeIEventModels[iwConstants.mode.EDIT]={};this._runtimeIEventModels[iwConstants.mode.VIEW]={};this.autoCommit=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.ICONTEXT_AUTO_COMMIT);this._initRuntimeModel();},_initRuntimeModel:function(){var _ddb=this.widgetWrapper.widgetDef._getPublicEvents();if(_ddb){for(var i in _ddb){if(Object.prototype.hasOwnProperty.call(_ddb,i)){this._runtimeIEventModels[iwConstants.mode.CONFIG][i]=_ddb[i];}}}},_getHierarchicalRuntimeModel:function(mode){if(mode&&mode==iwConstants.mode.CONFIG){return this._runtimeIEventModels[iwConstants.mode.CONFIG];}if(mode&&mode==iwConstants.mode.EDIT){return dojo.mixin(this._runtimeIEventModels[iwConstants.mode.CONFIG],this._runtimeIEventModels[iwConstants.mode.EDIT]);}var _ddc=dojo.mixin(this._runtimeIEventModels[iwConstants.mode.CONFIG],this._runtimeIEventModels[iwConstants.mode.EDIT]);return dojo.mixin(_ddc,this._runtimeIEventModels[iwConstants.mode.VIEW]);},_getEventProvider:function(mode){if(!mode){mode=this._getMode();}if(mode==iwConstants.mode.CONFIG){return this.widgetDefinition;}return this.widgetModel.getHierarchicalEventProvider(this.widgetInstance).start();},_getRuntimeModel:function(mode){if(!mode){mode=iwConstants.mode.VIEW;}var _ddd=this._runtimeIEventModels[mode];if(typeof _ddd=="undefined"){_ddd=null;}return _ddd;},_getMode:function(){var mode=this.widgetWrapper.currentMode;if(mode&&mode==iwConstants.mode.CONFIG){return mode;}return iwConstants.mode.EDIT;},_getContext:function(mode){if(!mode){mode=this._getMode();}if(mode&&mode==iwConstants.mode.CONFIG){return this.widgetDefinition;}return this.widgetInstance;},_find:function(name){if(!name){return null;}var mode=this._getMode();var _dde=this._getHierarchicalRuntimeModel(mode);if(_dde===null){return null;}if(_dde[name]&&_dde[name]!==null){return _dde[name];}return this._findInWidgetModel(name,mode);},_findInWidgetModel:function(name,mode){var _ddf=this._getEventProvider(mode);var _de0=_ddf.getEvent(name);if(!_de0){return null;}return _de0;},find:function(name){var _de1=this._find(name);if(!_de1){return null;}return this._toIEventDescription(_de1);},eventExists:function(id){var _de2=this.find(id);if(!_de2){return false;}return true;},_getEventDescObj:function(_de3){var obj=_de3;var _de4=_de3.declaredClass;if(!_de4){obj=new com.ibm.mm.iwidget.IEventDescriptionImpl(_de3);}return obj;},_createEvent:function(_de5,_de6){var _de7=this._getEventDescObj(_de5);var _de8=this.eventExists(_de7.name);if(_de8){return false;}else{var mode=this._getMode();var _de9=this._getRuntimeModel(mode);_de7.setAttribute("isComplete",true);_de9[_de7.name]=_de7;var _dea=this._getContext(mode);var _deb=_de7.isHandled=="true"?true:false;var _dec=_dea.createEvent(_de7.name,_deb);_dec=this._addEvent(_dec,_de7);_dea.addEvent(_dec);if(_de6){this._commit();}return true;}},createEvent:function(_ded){return this._createEvent(_ded,true);},_addEvent:function(_dee,_def){var _df0=_def.type;if(_df0){_dee.setPayloadType(_df0);}var _df1=_def.getLocales();for(var i=0;i<_df1.length;i++){var _df2=_df1[i];var _df3=_def.getAttribute("title",_df2);var desc=_def.getAttribute("description",_df2);if(_df3){_dee.setTitle(_df3,_df2);}if(desc){_dee.setDescription(desc,_df2);}}return _dee;},removeEvent:function(_df4){return this._removeEvent(_df4);},_removeEvent:function(_df5,_df6){if(!name){return false;}var mode=this._getMode();var _df7=this._findInWidgetModel(_df5,mode);if(_df7===null){return true;}var _df8=this._getRuntimeModel(mode);if(typeof _df8[_df5]!="undefined"){delete _df8[_df5];}var _df9=this._getContext(mode);_df9.removeEvent(_df7);if(_df6){this._commit();}return true;},updateEvent:function(_dfa){return this._updateEvent(_dfa,true);},_updateEvent:function(_dfb,_dfc){if(!_dfb){return false;}var _dfd=this._getEventDescObj(_dfb);var mode=this._getMode();var _dfe=this._findInWidgetModel(_dfd.name,mode);if(_dfe===null){return false;}var _dff=this._getRuntimeModel(mode);_dfd.setAttribute("isComplete",true);_dff[_dfd.name]=_dfd;this._addEvent(_dfe,_dfd);if(_dfc){this._commit();}return true;},getEvents:function(_e00){var mode=this._getMode();var _e01=this._getEventProvider(mode).getEvents();var temp=this._toIEventDescriptions(_e01);var _e02=this._mergeRuntimeModel(temp,mode);if(_e02===null){return null;}if(!_e00){return _e02;}if(dojo.isString(_e00)){try{_e00=dojo.fromJson(_e00);}catch(e){return null;}}var _e03=[];if(typeof _e00.isHandled!="undefined"&&_e00.isHandled&&!_e00.handlingFn){for(var i=0,l=_e02.length;i<l;i++){var _e04=_e02[i];if(!!_e04.isHandled){if(!_e04.handlingFn){_e03.push(_e04);}}}if(_e03.length===0){return null;}return _e03;}for(var j in _e02){if(Object.prototype.hasOwnProperty.call(_e02,j)){var _e05=_e02[j];var rc=com.ibm.mashups.enabler.utils.EventModelHelper.checkMatch(_e05._getInternalJsonObj(),_e00);if(rc){_e03.push(_e05);}}}if(_e03.length===0){return null;}else{return _e03;}},setEvents:function(_e06){var _e07=true;for(var i in _e06){if(Object.prototype.hasOwnProperty.call(_e06,i)){var _e08=_e06[i];var temp=this._find(_e08.name);if(temp){rc=this._updateEvent(_e08);}else{rc=this._createEvent(_e08);}if(!rc){_e07=false;}}}this._commit();return _e07;},removeEvents:function(_e09){var _e0a=true;for(var i in _e09){if(_e09.hasOwnProperties(i)){var _e0b=_e09[i];rc=this._removeEvent(_e0b);if(!rc){_e0a=false;}}}this._commit();return _e0a;},commit:function(){this.widgetModel.commit().start();},_commit:function(){if(this.autoCommit===true){this.commit();}},_toIEventDescriptions:function(_e0c){if(!_e0c){return null;}if(!dojo.isArray(_e0c)){return null;}if(dojo.isArray(_e0c)&&_e0c.length===0){return null;}var rc=[];for(var i=0;i<_e0c.length;i++){rc.push(this._toIEventDescription(_e0c[i]));}return rc;},_toIEventDescription:function(_e0d){if(!_e0d.getName){return _e0d;}var obj={};obj.name=_e0d.getName();obj.isHandled=_e0d.isHandled();obj.isPublished=_e0d.isPublished();obj.type=_e0d.getPayloadType();obj.localizedAttributes={};var _e0e=_e0d.getLocales();for(var i=0;i<_e0e.length;i++){var _e0f=_e0e[i];if(_e0d.getTitle(_e0f)){obj.localizedAttributes[_e0f]=obj.localizedAttributes[_e0f]?obj.localizedAttributes[_e0f]:{};obj.localizedAttributes[_e0f][iwConstants.event.TITLE]=_e0d.getTitle(_e0f);}if(_e0d.getDescription(_e0f)){obj.localizedAttributes[_e0f]=obj.localizedAttributes[_e0f]?obj.localizedAttributes[_e0f]:{};obj.localizedAttributes[_e0f][iwConstants.event.DESCRIPTION]=_e0d.getDescription(_e0f);}}obj.attributes={};obj.attributes.isComplete=false;return new com.ibm.mm.iwidget.IEventDescriptionImpl(obj);},_mergeRuntimeModel:function(arr,mode){if(!arr){return null;}if(dojo.isArray(arr)&&arr.length===0){return null;}var _e10=this._getHierarchicalRuntimeModel(mode);var _e11=com.ibm.mm.enabler.utils.Misc.isEmpty(_e10);if(_e11){return arr;}for(var j=0;j<arr.length;j++){var _e12=arr[j];var name=_e12.name;if(_e10[name]){arr[j]=_e10[name];}}return arr;}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.icontext.WidgetModelEventsFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.icontext.WidgetModelEventsFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.icontext.WidgetModelEventsFactoryImpl");dojo.declare("com.ibm.mm.enabler.widget.icontext.WidgetModelEventsFactoryImpl",com.ibm.mashups.iwidget.model.EventModelFactory,{constructor:function(){this.modes=[com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL];},createEventModel:function(_e13,_e14){return new com.ibm.mm.enabler.widget.icontext.WidgetModelEventsImpl(_e13);},getSupportedPersistenceMode:function(){return this.modes;}});com.ibm.mashups.services.ServiceManager.getService("WidgetEventModelFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL,new com.ibm.mm.enabler.widget.icontext.WidgetModelEventsFactoryImpl());}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.WireProviderFactoryService_API"]){dojo._hasResource["com.ibm.mashups.iwidget.services.WireProviderFactoryService_API"]=true;dojo.provide("com.ibm.mashups.iwidget.services.WireProviderFactoryService_API");dojo.provide("com.ibm.mashups.iwidget.services.WireProviderFactoryService");dojo.declare("com.ibm.mashups.iwidget.services.WireProviderFactoryService",null,{createWireProvider:function(_e15){},setFactory:function(_e16,_e17){}});}if(!dojo._hasResource["com.ibm.mashups.iwidget.services.WireProviderFactoryService"]){dojo._hasResource["com.ibm.mashups.iwidget.services.WireProviderFactoryService"]=true;dojo.provide("com.ibm.mashups.iwidget.services.WireProviderFactoryService");}if(!dojo._hasResource["com.ibm.mashups.iwidget.widget.WireProviderFactory"]){dojo._hasResource["com.ibm.mashups.iwidget.widget.WireProviderFactory"]=true;dojo.provide("com.ibm.mashups.iwidget.widget.WireProviderFactory");dojo.declare("com.ibm.mashups.iwidget.widget.WireProviderFactory",null,{createWireProvider:function(_e18,_e19){},getSupportedPersistenceMode:function(){}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.ModifiableWireModelImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.ModifiableWireModelImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.ModifiableWireModelImpl");dojo.declare("com.ibm.mm.iwidget.widget.ModifiableWireModelImpl",null,{constructor:function(_e1a){this._dirty=false;this._instance=_e1a;this.svc=com.ibm.mashups.services.ServiceManager.getService("eventService");},toJson:function(){var _e1b={};_e1b._dirty=this._dirty;if(this._wires){_e1b._wires=dojo.clone(this._wires);}if(this._targets){_e1b._targets=dojo.clone(this._targets);}return _e1b;},isDirty:function(){return this._dirty;},setDirty:function(_e1c){this._dirty=_e1c;},registerTargets:function(tw,te,se){if(!this._targets){this._targets={};}if(!this._targets[tw]){this._targets[tw]=[];}var wire={tw:tw,te:te,sw:this._instance.id,se:se};this._targets[tw].push(wire);this._dirty=true;},getTargets:function(){if(!this._targets){return null;}return this._targets;},removeTargets:function(tw,te,se){if(this._targets){if(this._targets[tw]){if(!te&&!se){delete (this._targets[tw]);this._dirty=true;}}}},_addWire:function(wire,_e1d){var _e1e=this._findWire(wire.getID())||null;if(_e1e===null){if(!this._wires){this._wires=[];}if(!(_e1d&&_e1d===true)){wire.setDirty(true);wire.setType(wire.TYPE_NEW);this._dirty=true;}this._wires.push(wire);this.svc.subscribeWire(wire.SourceWidget,wire.SourceEvent,this._instance.id,wire.TargetEvent);}},_removeWire:function(id){var wire=this._findWire(id)||null;if(wire!==null){for(var i in this._wires){if(this._wires[i].getID()==id){this._wires[i].setDirty(true);this._wires[i].setType(this._wires[i].TYPE_DELETE);this.svc.unSubscribeWire(wire.SourceWidget,wire.SourceEvent,this._instance.id,wire.TargetEvent);this._dirty=true;break;}}}},addWire:function(_e1f,_e20,_e21){var _e22={};_e22.SourceWidget=_e1f;_e22.SourceEvent=_e20;_e22.TargetEvent=_e21;var wire=new com.ibm.mm.iwidget.widget.WireImpl(this._instance.id,_e22);this._addWire(wire);},removeWire:function(_e23,_e24,_e25){var _e26={};_e23=_e23||null;_e24=_e24||null;_e25=_e25||null;if(_e23!==null&&_e24!==null&&_e25!==null){_e26.SourceWidget=_e23;_e26.SourceEvent=_e24;_e26.TargetEvent=_e25;var _e27=new com.ibm.mm.iwidget.widget.WireImpl(this._instance.id,_e26);this._removeWire(_e27.getID());}else{if(_e23!==null){for(var w in this._wires){if(this._wires[w].getSourceWidgetID()==_e23){this._wires[w].setDirty(true);this._wires[w].setType(this._wires[w].TYPE_DELETE);var wire=this._wires[w];this.svc.unSubscribeWire(_e23,wire.SourceEvent,wire.TargetWidget,wire.TargetEvent);this._dirty=true;}}}}},_findWire:function(id){this._wires=this._wires||null;var wire=null;if(this._wires!==null){for(var w in this._wires){if(this._wires[w].getID()==id){wire=this._wires[w];if(wire.isDirty()&&wire.getType()!==null&&wire.getType()==wire.TYPE_DELETE){this._removeFromDOM(wire);delete this._wires[w];wire=null;}else{break;}}}}return wire||null;},getWires:function(){if(!this._wires){this._loadWires();}var arr=[];for(var i in this._wires){if(Object.prototype.hasOwnProperty.call(this._wires,i)){var _e28=this._wires[i];if(!(_e28.isDirty()===true&&(_e28.getType()!==null&&_e28.getType()==_e28.TYPE_DELETE))){arr.push(_e28);}}}return arr;},_loadWires:function(){this._wires=[];var ns=this._instance.ns;var _e29="ReceivedEvent";var _e2a=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",ns+_e29,this._instance.rootElement,_e2a,true);var _e2b=["SourceWidget","SourceEvent","TargetEvent"];var _e2c=["SourceEvent","TargetEvent"];for(var i=0;i<_e2a.length;i++){var _e2d=_e2a[i];var _e2e={};var _e2f=true;for(var j=0;j<2;j++){var _e30=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",ns+_e2c[j],_e2d,_e30,false);if(_e30.length===0){_e2f=false;}else{if(j===0){var temp=_e30[0].getAttribute("href")||null;if(temp!==null){var _e31=temp.indexOf("#");if(_e31!=-1){temp=temp.substring(_e31+1);}_e2e[_e2b[0]]=temp;_e2e[_e2b[1]]=_e30[0].innerHTML;}}else{_e2e[_e2b[2]]=_e30[0].innerHTML;}}}if(_e2f){this._addWire(new com.ibm.mm.iwidget.widget.WireImpl(this._instance.id,_e2e),true);}}},commit:function(){if(this.isDirty()===true){for(var i in this._wires){if(Object.prototype.hasOwnProperty.call(this._wires,i)){var _e32=this._wires[i];if(_e32.isDirty()&&_e32.getType()!==null&&_e32.getType()==_e32.TYPE_NEW){this._addToDOM(_e32);_e32.setDirty(false);_e32.setType(null);}else{if(_e32.isDirty()&&_e32.getType()!==null&&_e32.getType()==_e32.TYPE_DELETE){this._removeFromDOM(_e32);this._wires.splice(i,1);}}}}this.setDirty(false);}},_addToDOM:function(_e33){var _e34=_e33.getSourceWidgetID();var _e35=_e33.getSourceEventName();var _e36=_e33.getTargetEventName();var _e37=document.createElement("span");_e37.className=this._instance.ns+"ReceivedEvent";var _e38=document.createElement("a");_e38.className=this._instance.ns+"SourceEvent";_e38.setAttribute("href","#"+_e34);_e38.innerHTML=_e35;var _e39=document.createElement("span");_e39.className=this._instance.ns+"TargetEvent";_e39.innerHTML=_e36;_e37.appendChild(_e38);_e37.appendChild(_e39);this._instance.rootElement.appendChild(_e37);},_removeFromDOM:function(_e3a){var _e3b=_e3a.getSourceWidgetID();var _e3c=_e3a.getSourceEventName();var _e3d=_e3a.getTargetEventName();var _e3e=this._instance.rootElement;var _e3f=dojo.query("."+this._instance.ns+"ReceivedEvent",_e3e);var _e40=com.ibm.mashups.services.ServiceManager.getService("iwidgetFragmentService");for(var i=0;i<_e3f.length;i++){var _e41=_e3f[i];var _e42=dojo.query("."+this._instance.ns+"SourceEvent",_e41)[0];var _e43=_e42.innerHTML;var _e44=dojo.query("."+this._instance.ns+"TargetEvent",_e41)[0];if(_e40.getKeyFromHref(_e42)==_e3b&&_e43==_e3c&&_e44.innerHTML==_e3d){_e3e.removeChild(_e41);break;}}}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.DOMWireProviderFactoryImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.DOMWireProviderFactoryImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.DOMWireProviderFactoryImpl");dojo.declare("com.ibm.mm.iwidget.widget.DOMWireProviderFactoryImpl",com.ibm.mashups.iwidget.widget.WireProviderFactory,{constructor:function(){this.modes=["DOM"];},createWireProvider:function(_e45,_e46){return new com.ibm.mm.iwidget.widget.ModifiableWireModelImpl(_e45);},getSupportedPersistenceMode:function(){return this.modes;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl",com.ibm.mashups.iwidget.services.WireProviderFactoryService,{constructor:function(){this._factories={};this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},createWireProvider:function(_e47){var _e48;var wID=_e47.id;_e48=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.PERSISTENCE_MODE);var _e49=_e47.rootElement;if(dojo.hasClass(_e49,com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl.STANDALONE_CLASS)||!_e48){_e48=com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl.DEFAULT_PERSISTENCE;}if(typeof _e48!=="undefined"&&_e48==com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL){var _e4a=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _e4b=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();var _e4c=com.ibm.mm.iwidget.Utils.getModelID(wID);var _e4d=new com.ibm.mm.enabler.IdentifierImpl(_e4c);var _e4e=_e4b.find(_e4d).start();if(typeof _e4e==="undefined"||_e4e===null){_e48=com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl.DEFAULT_PERSISTENCE;if(dojo.isFunction(_e47._getResourceBundle)){_e47._getResourceBundle();this.LOGGER.warning("createWireProvider",_e47.iwMessages.W_STANDALONECLASS_MISSING_1,[wID]);}else{this.LOGGER.warning("createWireProvider","widget "+wID+" is missing class "+com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone);}}}if(!(_e48 in this._factories)){return null;}return this._factories[_e48].createWireProvider(_e47,_e48);},setFactory:function(_e4f,_e50){this._factories[_e4f]=_e50;}});com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl.DEFAULT_PERSISTENCE=com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_DOM;com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl.STANDALONE_CLASS=com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwStandalone;com.ibm.mashups.services.ServiceManager.setService("WireProviderFactoryService",new com.ibm.mm.iwidget.services.WireProviderFactoryServiceImpl());com.ibm.mashups.services.ServiceManager.getService("WireProviderFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_DOM,new com.ibm.mm.iwidget.widget.DOMWireProviderFactoryImpl());}if(!dojo._hasResource["com.ibm.mm.enabler.wire.icontext.ReadOnlyWireModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.wire.icontext.ReadOnlyWireModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.wire.icontext.ReadOnlyWireModelImpl");dojo.declare("com.ibm.mm.enabler.wire.icontext.ReadOnlyWireModelImpl",null,{constructor:function(_e51){this._instance=_e51;this.svc=com.ibm.mashups.services.ServiceManager.getService("eventService");this.modelID=com.ibm.mm.iwidget.Utils.getModelID(this._instance.id);dojo.subscribe(com.ibm.mashups.enabler.wire.WireModel.TOPIC_WIRE_ADDED,this,"_wireAddedCallback");dojo.subscribe(com.ibm.mashups.enabler.wire.WireModel.TOPIC_WIRE_REMOVED,this,"_wireRemovedeCallback");},toJson:function(){return null;},isDirty:function(){return false;},setDirty:function(_e52){throw "Cannot call setDirty on on Read Only WireModel";},registerTargets:function(tw,te,se){if(!this._targets){this._targets={};}if(!this._targets[tw]){this._targets[tw]=[];}var wire={tw:tw,te:te,sw:this._instance.id,se:se};this._targets[tw].push(wire);},getTargets:function(){if(!this._targets){return null;}return this._targets;},removeTargets:function(tw,te,se){if(this._targets){if(this._targets[tw]){if(!te&&!se){delete (this._targets[tw]);}}}},getEventName:function(_e53,_e54){if(_e53&&_e53!==null){for(var i=0,l=_e53.length;i<l;i++){if(_e53[i].getID()==_e54.getID()){return _e53[i].getName();}}}return null;},_addWire:function(wire,_e55){var _e56=this._findWire(wire.getID())||null;if(_e56===null){if(!this._wires){this._wires=[];}_e55=_e55||false;if(!_e55){wire.setType(wire.TYPE_NEW);}this._wires.push(wire);var _e57;var _e58=wire.SourceEvent;if(_e58){_e57=_e58.indexOf("publish.");if(_e57===0){_e58=_e58.substring(8);}}var _e59=wire.TargetEvent;if(_e59){_e57=_e59.indexOf("process.");if(_e57===0){_e59=_e59.substring(8);}}this.svc.subscribeWire(wire.SourceWidget,_e58,this._instance.id,_e59);}},_removeWire:function(id){var wire=this._findWire(id)||null;if(wire!==null){for(var i in this._wires){if(Object.prototype.hasOwnProperty.call(this._wires,i)){if(this._wires[i].getID()==id){this._wires[i].setType(this._wires[i].TYPE_DELETE);var _e5a;var _e5b=wire.SourceEvent;if(_e5b){_e5a=_e5b.indexOf("publish.");if(_e5a===0){_e5b=_e5b.substring(8);}}var _e5c=wire.TargetEvent;if(_e5c){_e5a=_e5c.indexOf("process.");if(_e5a===0){_e5c=_e5c.substring(8);}}this.svc.unSubscribeWire(wire.SourceWidget,_e5b,this._instance.id,_e5c);break;}}}}},addWire:function(_e5d,_e5e,_e5f){var _e60={};_e60.SourceWidget=_e5d;_e60.SourceEvent=_e5e;_e60.TargetEvent=_e5f;var wire=new com.ibm.mm.iwidget.widget.WireImpl(this._instance.id,_e60);this._addWire(wire);},removeWire:function(_e61,_e62,_e63){var _e64={};_e61=_e61||null;_e62=_e62||null;_e63=_e63||null;if(_e61!==null&&_e62!==null&&_e63!==null){_e64.SourceWidget=_e61;_e64.SourceEvent=_e62;_e64.TargetEvent=_e63;var _e65=new com.ibm.mm.iwidget.widget.WireImpl(this._instance.id,_e64);this._removeWire(_e65.getID());}else{if(_e61!==null){for(var w in this._wires){if(Object.prototype.hasOwnProperty.call(this._wires,w)){if(this._wires[w].getSourceWidgetID()==_e61){this._wires[w].setType(this._wires[w].TYPE_DELETE);var wire=this._wires[w];this.svc.unSubscribeWire(_e61,wire.SourceEvent,wire.TargetWidget,wire.TargetEvent);}}}}}},_findWire:function(id){var wire;this._wires=this._wires||null;if(this._wires!==null){for(var w in this._wires){if(Object.prototype.hasOwnProperty.call(this._wires,w)){if(this._wires[w].getID()==id){wire=this._wires[w]||null;if((wire.getType()!==null)&&(wire.getType()==wire.TYPE_DELETE)){delete this._wires[w];wire=null;}else{break;}}}}}return wire||null;},getWires:function(){if(!this._wires){this._loadWires();}var arr=[];for(var wire in this._wires){if(Object.prototype.hasOwnProperty.call(this._wires,wire)){var _e66=this._wires[wire];if(_e66.getType()!=_e66.TYPE_DELETE){arr.push(_e66);}}}return arr;},_loadWires:function(){this._wires=[];var _e67=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();var _e68=_e67.getWireModel();var _e69=_e68.findByTargetWidget(this.modelID).start(true);dojo.forEach(_e69||[],function(wire){var _e6a={};_e6a.SourceWidget=com.ibm.mm.iwidget.Utils.getMarkupID(wire.getSourceWidget().getID());_e6a.SourceEvent=wire.getSourceEventName();_e6a.TargetEvent=wire.getTargetEventName();this._addWire(new com.ibm.mm.iwidget.widget.WireImpl(this._instance.id,_e6a),true);},this);},commit:function(){throw "Cannot call commit on Read Only WireModel";},_addToDOM:function(_e6b){throw "Cannot call _addToDOM on Read Only WireModel";},_removeFromDOM:function(_e6c){throw "Cannot call _removeFromDOM on Read Only WireModel";},_wireAddedCallback:function(_e6d,wire){if(wire.getTargetWidget().getID()==this.modelID){var _e6e=com.ibm.mm.iwidget.Utils.getMarkupID(wire.getSourceWidget().getID());var _e6f=wire.getSourceWidget().getID();var _e70=wire.getTargetWidget().getID();var _e71=wire.getSourceEvent();var _e72=wire.getTargetEvent();var lm=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();var _e73=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _e74=lm.find(_e6f).start();var _e75=_e73.getWidgetWindow(_e74).start();var _e76=_e73.getHierarchicalEventProvider(_e75).start();var _e77=_e76.getEvents(null);var _e78=this.getEventName(_e77,_e71);var _e79=lm.find(_e70).start();var _e7a=_e73.getWidgetWindow(_e79).start();var _e7b=_e73.getHierarchicalEventProvider(_e7a).start();_e77=_e7b.getEvents(null);var _e7c=this.getEventName(_e77,_e72);var _e7d=_e78;var _e7e=_e7c;this.addWire(_e6e,_e7d,_e7e);}},_wireRemovedeCallback:function(_e7f,wire){if(wire.getTargetWidget().getID()==this.modelID){var _e80=com.ibm.mm.iwidget.Utils.getMarkupID(wire.getSourceWidget().getID());var _e81=wire.getSourceWidget().getID();var _e82=wire.getTargetWidget().getID();var _e83=wire.getSourceEvent();var _e84=wire.getTargetEvent();var lm=com.ibm.mm.enabler.utils.Model.getCurrentPageLayoutModel();var _e85=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _e86=lm.find(_e81).start();var _e87=_e85.getWidgetWindow(_e86).start();var _e88=_e85.getHierarchicalEventProvider(_e87).start();var _e89=_e88.getEvents(null);var _e8a=this.getEventName(_e89,_e83);var _e8b=lm.find(_e82).start();var _e8c=_e85.getWidgetWindow(_e8b).start();var _e8d=_e85.getHierarchicalEventProvider(_e8c).start();_e89=_e8d.getEvents(null);var _e8e=this.getEventName(_e89,_e84);var _e8f=_e8a;var _e90=_e8e;this.removeWire(_e80,_e8f,_e90);}}});}if(!dojo._hasResource["com.ibm.mm.enabler.wire.icontext.WireModelWireProviderFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.wire.icontext.WireModelWireProviderFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.wire.icontext.WireModelWireProviderFactoryImpl");dojo.declare("com.ibm.mm.enabler.wire.icontext.WireModelWireProviderFactoryImpl",com.ibm.mashups.iwidget.widget.WireProviderFactory,{constructor:function(){this.modes=[com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL];},createWireProvider:function(_e91,_e92){return new com.ibm.mm.enabler.wire.icontext.ReadOnlyWireModelImpl(_e91);},getSupportedPersistenceMode:function(){return this.modes;}});com.ibm.mashups.services.ServiceManager.getService("WireProviderFactoryService").setFactory(com.ibm.mashups.enabler.widget.Constants.PERSISTENCE_MODE_MODEL,new com.ibm.mm.enabler.wire.icontext.WireModelWireProviderFactoryImpl());}if(!dojo._hasResource["com.ibm.mm.enabler.widget.WidgetModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.WidgetModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.WidgetModelImpl");dojo.declare("com.ibm.mm.enabler.widget.WidgetModelImpl",[com.ibm.mashups.enabler.widget.WidgetModel,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ServiceDocConsumer],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;var _e93="constructor()";var _e94=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_e94){this.LOGGER.entering(_e93);}this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.definitions={};this.instances={};this.controls=new dojox.collections.ArrayList();this.windows={};this.urlType=com.ibm.mashups.enabler.model.url.ModelUrlFactory.WIDGET_URL;if(_e94){this.LOGGER.exiting(_e93);}},_initServiceDoc:function(){var _e95=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WIDGET);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_e95.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_XSI,nsf.NS_THR]));this.inherited("_initServiceDoc",arguments);},_getNS:function(){this._initServiceDoc();return this.ns;},getInstance:function(){var _e96=com.ibm.mm.enabler.widget.WidgetModelImpl._instance;return _e96?_e96:(com.ibm.mm.enabler.widget.WidgetModelImpl._instance=new com.ibm.mm.enabler.widget.WidgetModelImpl());},find:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,id);},getWidgetDefinitionByWindow:function(_e97){return new com.ibm.mm.enabler.DeferredImpl(this,this._getWidgetDefinitionByWindow,_e97);},getWidgetDefinitionByInstance:function(_e98){return new com.ibm.mm.enabler.DeferredImpl(this,this._getWidgetDefinitionByInstance,_e98);},getWidgetWindow:function(_e99){return new com.ibm.mm.enabler.DeferredImpl(this,this._getWidgetWindow,_e99);},getWidgetInstance:function(_e9a){return new com.ibm.mm.enabler.DeferredImpl(this,this._getWidgetInstance,_e9a);},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},isDirty:function(){var _e9b="isDirty()";var _e9c=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_e9c){this.LOGGER.entering(_e9b);}if(_e9c){this.LOGGER.trace(_e9b,"Checking for WidgetWindows");}for(var _e9d in this.windows){if(Object.prototype.hasOwnProperty.call(this.windows,_e9d)){var _e9e=this.windows[_e9d];if(_e9e._isDirty()){if(_e9c){this.LOGGER.trace(_e9b,"Window ${0} is dirty ...",_e9e.getID());}if(_e9c){this.LOGGER.exiting(_e9b,true);}return true;}}}if(_e9c){this.LOGGER.trace(_e9b,"Checking for WidgetInstances");}for(var _e9f in this.instances){if(Object.prototype.hasOwnProperty.call(this.instances,_e9f)){var _ea0=this.instances[_e9f];if(_ea0._isDirty()){if(_e9c){this.LOGGER.trace(_e9b,"Instance ${0} is dirty ...",_e9f);}if(_e9c){this.LOGGER.exiting(_e9b,true);}return true;}}}if(_e9c){this.LOGGER.trace(_e9b,"Checking for WidgetDefinitions");}for(var _ea1 in this.definitions){if(Object.prototype.hasOwnProperty.call(this.definitions,_ea1)){var _ea2=this.definitions[_ea1];if(_ea2._isDirty()){if(_e9c){this.LOGGER.trace(_e9b,"Definition ${0} is dirty ...",_ea1);}if(_e9c){this.LOGGER.exiting(_e9b,true);}return true;}}}if(_e9c){this.LOGGER.exiting(_e9b,false);}return false;},getHierarchicalPreferences:function(_ea3){return new com.ibm.mm.enabler.DeferredImpl(this,this._getHierarchicalPreferences,_ea3);},getHierarchicalEventProvider:function(_ea4){return new com.ibm.mm.enabler.DeferredImpl(this,this._getHierarchicalEventProvider,_ea4);},_find:function(_ea5,sync,id){var _ea6="_find(deferred, sync, id)";var _ea7=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_ea7){this.LOGGER.entering(_ea6,[_ea5,sync,id]);}if(!id||dojo.isString(id)){if(_ea7){this.LOGGER.trace(_ea6,"id is null or a string");}throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _ea8;var _ea9=id.getID();if(_ea9 in this.definitions){var _eaa=this.definitions[_ea9];if(_ea5){_ea5.finish(_eaa,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_ea8=_eaa;}else{var _eab=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_eab.setNodes([{value:_ea9,isID:true}]);_eab.setParameter("mode","download");_eab.setParameter("rep","full");_eab.setParameter("levels","-all");_eab.setParameter("events","single");this._applyHiddenMetaDataLoadingStrategyToModelURL(_eab);var _eac=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_eab,null,null,false,sync);var _ead={};_ead.node=null;_eac.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _eae=this._getDefinitionFromFeed(data);if(!_eae){throw new Error(dojo.string.substitute(this.modelMessages.E_LOAD_NAVNODE_1,[id]));}_ea8=_eae;_ead.node=_eae;}if(_ea5){_ea5.finish(_ead.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_ead.status=xhr.status;}}}));if(_ead.status){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_ead.status]));}}if(_ea7){this.LOGGER.exiting(_ea6,_ea8);}return _ea8;},_getWidgetDefinitionByWindow:function(_eaf,sync,_eb0){var _eb1="_getWidgetDefinitionByWindow(deferred, sync, widWindow)";var _eb2=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_eb2){this.LOGGER.entering(_eb1,[_eaf,sync,_eb0]);}if(!_eb0){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _eb3;var _eb4=this.getWidgetInstance(_eb0).start();if(_eb4){var _eb5=this.getWidgetDefinitionByInstance(_eb4).start();if(_eb5){if(_eaf){_eaf.finish(_eb5,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_eb3=_eb5;}}if(_eb2){this.LOGGER.exiting(_eb1,_eb3);}return _eb3;},_getWidgetDefinitionByID:function(_eb6,sync,_eb7){var _eb8="_getWidgetDefinitionByInstance(deferred, sync, instance)";var _eb9=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_eb9){this.LOGGER.entering(_eb8,[_eb6,sync,instance]);}if(!_eb7){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _eba=null;if(_eb7 in this.definitions){var _ebb=this.definitions[_eb7];if(_eb6){_eb6.finish(_ebb,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_eba=_ebb;}else{var _ebc=instance._getParentHref();var _ebd=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_ebc,this);_ebd.setParameter("mode","download");_ebd.setParameter("rep","full");_ebd.setParameter("levels","-all");_ebd.setParameter("events","single");this._applyHiddenMetaDataLoadingStrategyToModelURL(_ebd);var _ebe=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_ebd,null,null,false,sync);var _ebf={};_ebf.node=null;_ebe.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _ec0=this._getDefinitionFromFeed(data);if(!_ec0){throw new Error(dojo.string.substitute(this.modelMessages.E_LOAD_NAVNODE_1,[instance]));}_eba=_ec0;_ebf.node=_ec0;}if(_eb6){_eb6.finish(_ebf.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_ebf.status=xhr.status;}}}));if(_ebf.status){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_ebf.status]));}}if(_eb9){this.LOGGER.exiting(_eb8,_eba);}return _eba;},_getWidgetDefinitionByInstance:function(_ec1,sync,_ec2){var _ec3="_getWidgetDefinitionByInstance(deferred, sync, instance)";var _ec4=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_ec4){this.LOGGER.entering(_ec3,[_ec1,sync,_ec2]);}if(!_ec2){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _ec5=null;var _ec6;if(dojo.isString(_ec2)){_ec6=_ec2;}else{_ec6=_ec2._getParentID();}if(_ec6 in this.definitions){var _ec7=this.definitions[_ec6];if(_ec1){_ec1.finish(_ec7,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_ec5=_ec7;}else{var _ec8=null;if(dojo.isString(_ec2)){_ec8=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_ec8.setNodes([{value:_ec6,isID:true}]);}else{var _ec9=_ec2._getParentHref();_ec8=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_ec9,this);}_ec8.setParameter("mode","download");_ec8.setParameter("rep","full");_ec8.setParameter("levels","-all");_ec8.setParameter("events","single");this._applyHiddenMetaDataLoadingStrategyToModelURL(_ec8);var _eca=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_ec8,null,null,false,sync);var _ecb={};_ecb.node=null;_eca.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _ecc=this._getDefinitionFromFeed(data);if(!_ecc){throw new Error(dojo.string.substitute(this.modelMessages.E_LOAD_NAVNODE_1,[_ec2]));}_ec5=_ecc;_ecb.node=_ecc;}if(_ec1){_ec1.finish(_ecb.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_ecb.status=xhr.status;}}}));if(_ecb.status){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_ecb.status]));}}if(_ec4){this.LOGGER.exiting(_ec3,_ec5);}return _ec5;},_getWidgetWindow:function(_ecd,sync,_ece){var _ecf="_getWidgetWindow(deferred, sync, control)";var _ed0=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_ed0){this.LOGGER.entering(_ecf,[_ecd,sync,_ece]);}if(!_ece){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _ed1;var _ed2=this.controls.indexOf(_ece);if(_ed2>-1){var _ed3=this.windows[_ed2];if(_ecd){_ecd.finish(_ed3,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_ed1=_ed3;}else{var uri=_ece._getWidgetWindowURI();var _ed4=null;if(!uri){_ed4=_ece._getContext();if(!_ed4){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(!_ed4[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_ID]&&!_ed4[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_URL]){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}_ed1=this._getWidgetWindowByContext(_ed4,_ece);if(_ecd){_ecd.finish(_ed1,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}else{_ed1=this._loadFullWindowParentTree(_ecd,sync,_ece,false);}}if(_ed0){this.LOGGER.exiting(_ecf,_ed1);}return _ed1;},_loadFullWindowParentTree:function(_ed5,sync,_ed6,_ed7){if(typeof _ed7=="undefined"){_ed7=false;}var _ed8=null;var uri=_ed6._getWidgetWindowURI();var ids=this._splitFullWindowID(uri);if(ids.length!=2){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _ed9=ids[0];var _eda=ids[1];var _edb=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_edb.setNodes([{value:_ed9,isID:true},{value:_eda,isID:true}]);_edb.setParameter("mode","download");_edb.setParameter("rep","full");_edb.setParameter("levels","-all");_edb.setParameter("events","single");this._applyHiddenMetaDataLoadingStrategyToModelURL(_edb);var _edc=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_edb,null,null,false,sync);var _edd={};_edd.node=null;_edc.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _ede=this._getWindowFromFeed(data,_ed6,_ed7);if(!_ede){throw new Error(dojo.string.substitute(this.modelMessages.E_LOAD_NAVNODE_1,[_ed6]));}_ed8=_ede;_edd.node=_ede;this._getInstanceFromFeed(data,_ed7);this._getDefinitionFromFeed(data,_ed7);}if(_ed5){_ed5.finish(_edd.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_edd.status=xhr.status;}}}));if(_edd.status&&_edd.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_edd.status]));}return _ed8;},_getWidgetInstance:function(_edf,sync,_ee0){var _ee1="_getWidgetInstance(deferred, sync, widWindow)";var _ee2=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_ee2){this.LOGGER.entering(_ee1,[_edf,sync,_ee0]);}if(!_ee0){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _ee3;var _ee4=_ee0._getParentID();if(_ee4 in this.instances){var _ee5=this.instances[_ee4];if(_edf){_edf.finish(_ee5,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_ee3=_ee5;}else{var _ee6=_ee0._getParentHref();var _ee7=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_ee6,this);_ee7.setParameter("mode","download");_ee7.setParameter("rep","full");_ee7.setParameter("levels","-all");_ee7.setParameter("events","single");this._applyHiddenMetaDataLoadingStrategyToModelURL(_ee7);var _ee8=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_ee7,null,null,false,sync);var _ee9={};_ee9.node=null;_ee8.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _eea=this._getInstanceFromFeed(data);if(!_eea){throw new Error(dojo.string.substitute(this.modelMessages.E_LOAD_NAVNODE_1,[window]));}this._getDefinitionFromFeed(data);_ee3=_eea;_ee9.node=_eea;}if(_edf){_edf.finish(_ee9.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_ee9.status=xhr.status;}}}));if(_ee9.status){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_ee9.status]));}}if(_ee2){this.LOGGER.exiting(_ee1,_ee3);}return _ee3;},_commit:function(_eeb,sync){var _eec="_commit(deferred, sync)";var _eed=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_eed){this.LOGGER.entering(_eec,[_eeb,sync]);}if(!this.isDirty()){if(_eed){this.LOGGER.trace(_eec,"Model isn't dirty, exiting");}if(_eeb){_eeb.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}if(_eed){this.LOGGER.exiting(_eec);}return;}if(_eed){this.LOGGER.trace(_eec,"Checking for WidgetWindows to commit");}this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this.requestCount=0;for(var _eee in this.windows){if(Object.prototype.hasOwnProperty.call(this.windows,_eee)){var _eef=this.windows[_eee];if(_eef._isDirty()){if(_eed){this.LOGGER.trace(_eec,"Window ${0} is dirty, committing ...",_eef.getID());}this._commitWidgetModelNode(_eeb,sync,_eef);_eef._setClean();}}}if(_eed){this.LOGGER.trace(_eec,"Checking for WidgetInstances to commit");}for(var _ef0 in this.instances){if(Object.prototype.hasOwnProperty.call(this.instances,_ef0)){var _ef1=this.instances[_ef0];if(_ef1._isDirty()){if(_eed){this.LOGGER.trace(_eec,"Instance ${0} is dirty, committing ...",_ef0);}this._commitWidgetModelNode(_eeb,sync,_ef1);_ef1._setClean();}}}if(_eed){this.LOGGER.trace(_eec,"Checking for WidgetDefinitions to commit");}for(var _ef2 in this.definitions){if(Object.prototype.hasOwnProperty.call(this.definitions,_ef2)){var _ef3=this.definitions[_ef2];if(_ef3._isDirty()){if(_eed){this.LOGGER.trace(_eec,"Definition ${0} is dirty, committing ...",_ef2);}this._commitWidgetModelNode(_eeb,sync,_ef3);_ef3._setClean();}}}if(_eed){this.LOGGER.exiting(_eec);}},_commitWidgetModelNode:function(_ef4,sync,node){var _ef5="_commitWidgetModelNode(deferred, sync, node)";var _ef6=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_ef6){this.LOGGER.entering(_ef5,[_ef4,sync,node]);}var _ef7=null;var _ef8=null;var id=null;if(node._type=="window"){var _ef9=node._getRawEntityID();if(_ef9.indexOf("cid:")===0){var _efa=this._createNewPersNttyOnServer(_ef4,node);if(!_efa){return;}if(_ef6){this.LOGGER.trace(_ef5,"The ID for the newly created entity is ${0}",_efa);}node._setRawEntityID(_efa);}id=node.entity.getID();_ef7=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_ef7.setNodes([{value:id,isID:true}]);_ef8=node.entity.xmlData;}else{try{_ef7=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(node.getEditLink(),this);}catch(err){id=node.getID();_ef7=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_ef7.setNodes([{value:id,isID:true}]);}_ef8=node.xmlData;}_ef7.setParameter("update","replace");_ef7.setParameter("rep","full");_ef7.setParameter("events","single");var _efb=com.ibm.mm.enabler.utils.Dom.innerXML(_ef8);this._acquire();serviceReq=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_ef7,null,null,false,sync);serviceReq.update(_efb,dojo.hitch(this,function(type,data,xhr,args){var _efc=_ef4.getOperationCallback();if(_efc){_efc(node,com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_ef4.operationCallbackParameters);}this._release(_ef4,xhr.status);}),id);if(_ef6){this.LOGGER.exiting(_ef5);}},_createNewPersNttyOnServer:function(_efd,_efe){var ns=this._getNS();var _eff=_efe.xmlData.ownerDocument;var _f00=_efe._getParentID();var _f01=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",ns.atom);var id=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(id,"cid:0");_f01.appendChild(id);var _f02=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",ns.atom);_f02.setAttribute("type","application/xml");_f01.appendChild(_f02);var _f03=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_f03.setNodes([{value:_f00,isID:true}]);_f03.setParameter("rep","full");_f03.setParameter("events","single");var _f04=com.ibm.mm.enabler.utils.Utils.createNode("model:portlet-entity",ns.model);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_eff,_f04,"creation-context:portlet-entity","portlet-entity",ns["creation-context"],_f03.getModelURI());_f02.appendChild(_f04);var _f05=com.ibm.mm.enabler.utils.Dom.innerXML(_f01);var _f06=null;this._acquire();serviceReq=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_f03,null,null,false,true);serviceReq.create(_f05,dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var expr="atom:feed/atom:entry[atom:content/model:portlet-entity]";var _f07=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,ns);if(_f07&&_f07.length>0){var _f08=_f07[0];expr="atom:id";_f07=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_f08,ns);if(_f07&&_f07.length>0){_f06=com.ibm.mm.enabler.utils.Dom.textContent(_f07[0]);}}}var _f09=_efd.getOperationCallback();if(_f09){_f09(_f06,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_efd.operationCallbackParameters);}this._release(_efd,xhr.status);}),id);return _f06;},_getHierarchicalPreferences:function(_f0a,sync,_f0b){var _f0c;if(_f0b&&_f0b._getHierarchicalPreferences){preferences=_f0b._getHierarchicalPreferences();}else{preferences=_f0b.getPreferences();}if(_f0a){_f0a.finish(preferences,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return preferences;},_getHierarchicalEventProvider:function(_f0d,sync,_f0e){var ep;if(_f0e&&_f0e._getHierarchicalEventProvider){ep=_f0e._getHierarchicalEventProvider();}else{ep=_f0e;}if(_f0d){_f0d.finish(ep,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return ep;},_acquire:function(){this.requestCount++;},_release:function(_f0f,_f10){this.statusCode=Math.max(parseInt(_f10,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_f0f){_f0f.finish(null,this.statusCode);}}},_updateLayoutControl:function(_f11){var uri=_f11._getWidgetWindowURI();if(!uri){return;}var _f12=this.controls.indexOf(_f11);if(_f12==-1){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _f13=this.windows[_f12];this._updateFullWindowParentTree(_f13,_f11);},_updateFullWindowParentTree:function(_f14,_f15){var uri=_f15._getWidgetWindowURI();var ids=this._splitFullWindowID(uri);if(ids.length!=2){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _f16=ids[0];var _f17=ids[1];var _f18=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_f18.setNodes([{value:_f16,isID:true},{value:_f17,isID:true}]);_f18.setParameter("mode","download");_f18.setParameter("rep","full");_f18.setParameter("levels","-all");_f18.setParameter("events","single");this._applyHiddenMetaDataLoadingStrategyToModelURL(_f18);var _f19=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_f18,null,null,false,true);var _f1a={};_f1a.node=null;_f19.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var _f1b=this._getWindowFromFeed(data,_f15,true);if(!_f1b){throw new Error(dojo.string.substitute(this.modelMessages.E_LOAD_NAVNODE_1,[_f15]));}_f14._setRawID(_f1b._getRawID());var _f1c=this.getWidgetInstance(_f14).start();var _f1d=this._getInstanceFromFeed(data,true);delete this.instances[_f1c.getID()];_f1c._setRawID(_f1d._getRawID());this.instances[_f1c.getID()]=_f1c;_f14._setEntityParent(_f1c,this.urlType);var def=this.getWidgetDefinitionByInstance(_f1c).start();var _f1e=this._getDefinitionFromFeed(data,true);if(def.getID()!=_f1e.getID()){delete this.definitions[def.getID()];def._setRawID(_f1e._getRawID());this.definitions[def.getID()]=def;_f1c._setParent(_f1c,def,this.urlType);def._setXMLData(_f1e.xmlData,_f1e.portletXML);if(dojo.isFunction(def._setParent)){def._setParent(def,new com.ibm.mm.enabler.IdentifierImpl(_f1e.portletXML),this.urlType);}}}}));},_getWidgetWindowByContext:function(_f1f,_f20){var _f21="_getWidgetWindowByContext(context, control)";var _f22=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_f22){this.LOGGER.entering(_f21,[_f1f,_f20]);}var _f23=this._getWidgetDefinitionByContext(_f1f);var _f24=this._createWidgetInstance(_f23);var _f25=this._createWidgetWindow(_f24);var _f26=this.controls.indexOf(_f20);if(_f26>-1){throw new Error(this.modelMessages.E_PARAM_IS_SMALLER_ZERO_0);}else{this.controls.add(_f20);var _f27=_f20;var me=this;dojo.connect(_f20,"setXml",this,function(){me._updateLayoutControl(_f27);});_f26=this.controls.indexOf(_f20);this.windows[_f26]=_f25;}this.definitions[_f23.getID()]=_f23;this.instances[_f24.getID()]=_f24;var _f28=_f25;if(_f22){this.LOGGER.exiting(_f21,_f28);}return _f28;},_getWidgetDefinitionByContext:function(_f29){var _f2a="_getWidgetDefinitionByContext(context)";var _f2b=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_f2b){this.LOGGER.entering(_f2a,[_f29]);}var _f2c=null;var _f2d=_f29[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_ID];var url=_f29[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_URL];if(_f2d){_f2c=this._getWidgetDefinitionByInstance(null,true,_f2d.getID());}else{if(url){_f2c=this._getWidgetDefinitionFromURL(url);}}if(_f2b){this.LOGGER.exiting(_f2a,_f2c);}return _f2c;},_getWidgetDefinitionFromURL:function(url){var _f2e=com.ibm.mashups.services.ServiceManager.getService("widgetLoadService");var _f2f;_f2e.getWidgetXML(url,true,function(data,_f30,xhr){if(typeof xhr!="undefined"&&xhr!==null){_f30=xhr.status;}if(_f30!=200){data=null;}_f2f=data;},"bla");if(_f2f===null){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}return this._createWidgetDefinition(_f2f);},_createWidgetDefinition:function(_f31){var _f32="_createWidgetDefinition(iWidgetDefinition)";var _f33=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_f33){this.LOGGER.entering(_f32,[_f31]);}var _f34=_f31.toSpecObject();var _f35=this._createWidgetNode(_f31.getSupportedModes());var _f36=this._createDefinitionNode(new com.ibm.mm.enabler.IdentifierImpl(_f35));var def=new com.ibm.mm.enabler.widget.WidgetDefinitionImpl(_f36,_f35,this);var _f37=_f34.itemSets.attributes;if(_f37){var _f38=def.getPreferences();for(var _f39 in _f37.items){if(Object.prototype.hasOwnProperty.call(_f37.items,_f39)){var item=_f37.items[_f39];var _f3a=false;if(item._readOnly&&item._readOnly==="true"){_f3a=true;}_f38.setValue(_f39,item._value,_f3a);}}_f38._setClean();}for(var _f3b in _f34.events){if(Object.prototype.hasOwnProperty.call(_f34.events,_f3b)){var _f3c=_f34.events[_f3b];var name;var _f3d=null;var _f3e;if(_f3c._alias){_f3d=_f3c._alias;name=_f3c._id;}else{name=_f3c._id;}if(_f3c._published){_f3e=def.createEvent(name);}else{_f3e=def.createEvent(name,true);}var _f3f=_f3c._eventDescName;if(!_f3f){_f3f=_f3c._description;}if(_f3f){var _f40=_f34.eventDescriptions[_f3f];if(_f40){_f3e.setPayloadType(_f40._payloadType);_f3e._setClean();def.addEvent(_f3e);}}}}var _f41=_f34._supportedModes;var _f42=_f41.split(" ");def._setSupportedModes(_f42);if(_f33){this.LOGGER.exiting(_f32,retVal);}return def;},_createWidgetInstance:function(_f43){var _f44=this._createEntityNode(_f43);return new com.ibm.mm.enabler.widget.WidgetInstanceImpl(_f44,this);},_createWidgetWindow:function(_f45){var _f46=this._createEntityNode(_f45);var _f47=new com.ibm.mm.enabler.IdentifierImpl(_f46);var _f48=this._createWindowNode(_f47);return new com.ibm.mm.enabler.widget.WidgetWindowImpl(_f48,_f46,this);},_createModelNode:function(type,_f49){var ns=this._getNS();var _f4a=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",ns.atom);var _f4b=_f4a.ownerDocument;var id=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(id,"cid:"+dojox.uuid.generateRandomUuid());_f4a.appendChild(id);_f4a.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:title",ns.atom));var _f4c=com.ibm.mm.enabler.utils.Utils.createNode("atom:updated",ns.atom);var time=new Date();com.ibm.mm.enabler.utils.Dom.textContent(_f4c,time.toGMTString());_f4a.appendChild(_f4c);var _f4d=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",ns.atom);_f4d.setAttribute("type","application/xml");var _f4e=com.ibm.mm.enabler.utils.Utils.createNode("model:"+type,ns.model);_f4d.appendChild(_f4e);_f4a.appendChild(_f4d);if(_f49){var _f4f=com.ibm.mm.enabler.utils.Utils.createNode("thr:in-reply-to",ns.thr);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_f4b,_f4f,"ext:uri","uri",ns.ext,_f49._getRawID());_f4f.setAttribute("ref",_f49._getRawID());_f4f.setAttribute("href","#");var _f50=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",ns.atom);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_f4b,_f50,"ext:uri","uri",ns.ext,_f49._getRawID());_f50.setAttribute("rel","related");_f50.setAttribute("type","application/atom+xml");_f50.setAttribute("href","#");_f4a.appendChild(_f4f);_f4a.appendChild(_f50);}return _f4a;},_createWindowNode:function(_f51){return this._createModelNode("portlet-window",_f51);},_createEntityNode:function(_f52){return this._createModelNode("portlet-entity",_f52);},_createWidgetNode:function(_f53){if(_f53.length===0){return null;}var ns=this._getNS();var _f54=this._createModelNode("portlet");var expr="atom:content/model:portlet";var _f55=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_f54,ns);if(!_f55||_f55.length===0){return null;}var _f56=_f55[0];var _f57=com.ibm.mm.enabler.utils.Utils.createNode("model:supports",ns.model);_f56.appendChild(_f57);var _f58=com.ibm.mm.enabler.utils.Utils.createNode("model:mime-type",ns.model);com.ibm.mm.enabler.utils.Dom.textContent(_f58,"html");_f57.appendChild(_f58);var _f59=_f53.length;for(var i=0;i<_f59;++i){var _f5a=com.ibm.mm.enabler.utils.Utils.createNode("model:portlet-mode",ns.model);com.ibm.mm.enabler.utils.Dom.textContent(_f5a,_f53[i]);_f57.appendChild(_f5a);}return _f54;},_createDefinitionNode:function(_f5b){return this._createModelNode("portlet-definition",_f5b);},_createPersonalizedNttyNode:function(_f5c){var _f5d=this._createEntityNode();var ns=this._getNS();var expr="thr:in-reply-to";var _f5e=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_f5c,ns);var _f5f=null;if(_f5e&&_f5e.length>0){_f5f=_f5e[0];}expr="atom:link[@rel='related']";var _f60=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_f5c,ns);var _f61=null;if(_f60&&_f60.length>0){_f61=_f60[0];}if(dojo.isWebKit){_f5f=_f5f.cloneNode(true);_f61=_f61.cloneNode(true);}_f5d.appendChild(_f5f);_f5d.appendChild(_f61);return _f5d;},_splitFullWindowID:function(_f62){var _f63=_f62.split("@");if(_f63.length!=2){return null;}var _f64=_f63[0].split(":");var _f65=_f63[1].split(":");var _f66=_f64[_f64.length-1];var _f67=_f65[_f65.length-1];return [_f66,_f67];},_getPersonalizedEntity:function(feed,uri){var ns=this._getNS();var expr="atom:feed/atom:entry[atom:content/model:portlet-entity]";var _f68=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,feed,ns);var _f69=null;if(!_f68||_f68.length==1){return null;}expr="atom:feed/atom:entry[contains(atom:id/child::text(),'"+uri+"')]";var _f6a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,feed,ns);if(_f6a&&_f6a.length>0){return _f6a[0];}return null;},_getWindowFromFeed:function(feed,_f6b,_f6c){var ns=this._getNS();var expr="atom:feed/atom:entry[atom:content/model:portlet-window]";var _f6d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,feed,ns);var _f6e=null;if(_f6d){var _f6f=_f6d[0];expr="thr:in-reply-to";var _f70=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_f6f,ns);var _f71=null;if(_f70&&_f70.length>0){var uri=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_f70[0],"ext:uri","uri",ns.ext);_f71=this._getPersonalizedEntity(feed,uri);if(!_f71){_f71=this._createPersonalizedNttyNode(_f6f);}}if(!_f6c){var _f72=this.controls.indexOf(_f6b);if(_f72>-1){this.windows[_f72]._setXMLData(_f6f,_f71);}else{this.controls.add(_f6b);_f72=this.controls.indexOf(_f6b);this.windows[_f72]=new com.ibm.mm.enabler.widget.WidgetWindowImpl(_f6f,_f71,this);}_f6e=this.windows[_f72];}else{_f6e=new com.ibm.mm.enabler.widget.WidgetWindowImpl(_f6f,_f71,this);}}return _f6e;},_getInstanceFromFeed:function(feed,_f73){var ns=this._getNS();var expr="atom:feed/atom:entry[atom:content/model:portlet-entity]";var _f74=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,feed,ns);var _f75=null;if(!_f74){return null;}var _f76=null;var _f77;if(_f74.length==1){_f76=_f74[0];}else{var _f78={};var _f79=_f74.length;var i;for(i=0;i<_f79;++i){_f77=new com.ibm.mm.enabler.IdentifierImpl(_f74[i]);var id=_f77.getID();_f78[id]=null;}for(i=0;i<_f79;++i){var _f7a=_f74[i];var _f7b=com.ibm.mm.enabler.widget.utils.getParentLink(_f7a,ns);var _f7c=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,_f7b);if(!(_f7c in _f78)){_f76=_f7a;break;}}}if(!_f73){_f77=new com.ibm.mm.enabler.IdentifierImpl(_f76);var _f7d=_f77.getID();_f77=null;if(_f7d in this.instances){this.instances[_f7d]._setXMLData(_f76);}else{this.instances[_f7d]=new com.ibm.mm.enabler.widget.WidgetInstanceImpl(_f76,this);}return this.instances[_f7d];}return new com.ibm.mm.enabler.widget.WidgetInstanceImpl(_f76,this);},_getDefinitionFromFeed:function(feed,_f7e){var ns=this._getNS();var _f7f;var _f80;var expr="atom:feed/atom:entry[atom:content/model:portlet-definition]";var _f81=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,feed,ns);var _f82=null;if(_f81){_f7f=_f81[0];}expr="atom:feed/atom:entry[atom:content/model:portlet]";_f81=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,feed,ns);if(_f81){_f80=_f81[0];}if(_f7f&&_f80){if(!_f7e){var _f83=new com.ibm.mm.enabler.IdentifierImpl(_f7f);var _f84=_f83.getID();if(_f84 in this.definitions){this.definitions[_f84]._setXMLData(_f7f,_f80);}else{this.definitions[_f84]=new com.ibm.mm.enabler.widget.WidgetDefinitionImpl(_f7f,_f80,this);}_f82=this.definitions[_f84];}else{_f82=new com.ibm.mm.enabler.widget.WidgetDefinitionImpl(_f7f,_f80,this);}}return _f82;},_getParent:function(_f85){if(!_f85._type){return null;}var type=_f85._type;var _f86=null;if(type=="window"){_f86=this.getWidgetInstance(_f85).start();}else{if(type=="instance"){_f86=this.getWidgetDefinitionByInstance(_f85).start();}else{_f86=null;}}return _f86;},discard:function(){this.definitions={};this.instances={};this.controls.clear();this.windows={};}});}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetModel"]){dojo._hasResource["com.ibm.mashups.enabler.widget.WidgetModel"]=true;dojo.provide("com.ibm.mashups.enabler.widget.WidgetModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.widget.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.widget.Factory_API");dojo.provide("com.ibm.mashups.enabler.widget.Factory");dojo.declare("com.ibm.mashups.enabler.widget.Factory",null,{getWidgetModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.widget.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.widget.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.widget.FactoryImpl");dojo.declare("com.ibm.mm.enabler.widget.FactoryImpl",com.ibm.mashups.enabler.widget.Factory,{getWidgetModel:function(){return com.ibm.mm.enabler.widget.WidgetModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.widget.Factory=new com.ibm.mm.enabler.widget.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.widget.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.widget.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.widget.Factory");}if(!dojo._hasResource["com.ibm.mm.enabler.layout.LayoutControlImpl"]){dojo._hasResource["com.ibm.mm.enabler.layout.LayoutControlImpl"]=true;dojo.provide("com.ibm.mm.enabler.layout.LayoutControlImpl");dojo.declare("com.ibm.mm.enabler.layout.LayoutControlImpl",[com.ibm.mashups.enabler.layout.LayoutControl,com.ibm.mm.enabler.layout.LayoutNodeImpl,com.ibm.mashups.enabler.content.RuntimeContentProvider,com.ibm.mm.enabler.LocalizedImpl],{_skins:new dojox.collections.Dictionary(),configService:null,constructor:function(){var _f87=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);this.ns=dojo.delegate(_f87.namespaces,com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaces([com.ibm.mm.enabler.model.NameSpaceFactory.NS_ATOM]));this.id_prefix=_f87.idprefix;this.configService=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this._type=com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL;},_getWidgetFragment:function(_f88,_f89,_f8a,_f8b,_f8c,_f8d,_f8e){var _f8f=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/WidgetFragment.html"));return dojo.string.substitute(_f8f,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,instanceID:com.ibm.mm.iwidget.Utils.getMarkupID(_f88.getID()),sandboxEnabled:!!_f8a,widgetDefinitionURI:_f89||"",eventDescriptions:_f8b||"",events:_f8c||"",itemSets:_f8d||"",receivedEvents:_f8e||""});},_getValueFragment:function(_f90,_f91){var _f92=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/ValueFragment.html"));var ret=dojo.string.substitute(_f92,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,loc:_f90||"",val:_f91||""});return ret;},_getEventDescriptionFragment:function(_f93,_f94,_f95,_f96){var _f97=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/EventDescriptionFragment.html"));return dojo.string.substitute(_f97,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,eventDescName:_f93||"",payloadType:_f94||"",descriptions:_f95||"",titles:_f96||""});},_eventDescSuffix:"_desc",_getEventDescriptions:function(_f98){var _f99={};return dojo.map(_f98.getEvents(_f99)||[],function(_f9a){var _f9b=[];var _f9c=[];dojo.forEach(_f9a.getLocales()||[],function(_f9d){_f9b.push(this._getValueFragment(_f9d,_f9a.getTitle(_f9d)));_f9c.push(this._getValueFragment(_f9d,_f9a.getDescription(_f9d)));},this);return this._getEventDescriptionFragment(_f9a.getName()+this._eventDescSuffix,_f9a.getPayloadType(),_f9c.join("\n"),_f9b.join("\n"));},this);},_getMappedNameFragment:function(_f9e){var ret=null;if(_f9e){var _f9f=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/MappedNameFragment.html"));ret=dojo.string.substitute(_f9f,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,mappedName:_f9e||""});}return ret;},_getEventFragment:function(_fa0){var _fa1=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/EventFragment.html"));var _fa2=null;var _fa3=[];if(_fa0.isPublished()){_fa3.push(com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwPublished);}if(_fa0.isHandled()){_fa3.push(com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwHandled);}return dojo.string.substitute(_fa1,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,additionalClasses:_fa3.join(" "),eventName:_fa0.getName(),eventDescName:_fa0.getName()+this._eventDescSuffix,mappedName:this._getMappedNameFragment(_fa2)||""});},_getEvents:function(_fa4){var _fa5={};return dojo.map(_fa4.getEvents(_fa5)||[],this._getEventFragment,this);},_getReceivedEventFragment:function(wire){var _fa6=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/ReceivedEventFragment.html"));return dojo.string.substitute(_fa6,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,sourceWidgetID:wire.getSourceWidget().getID(),sourceEventName:wire.getSourceEventName(),targetEventName:wire.getTargetEventName()});},_getReceivedEvents:function(_fa7){var _fa8=[];var _fa9=this._getLayoutModel().getWireModel().iterator();while(_fa9.hasNext()){var wire=_fa9.next();if(wire.getTargetWidget().equals(_fa7)){_fa8.push(this._getReceivedEventFragment(wire));}}return _fa8;},_getItemSetItemFragment:function(name,_faa,_fab){var _fac=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/ItemSetItemFragment.html"));return dojo.string.substitute(_fac,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,readOnly:_fab?" "+com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwReadOnly:"",itemName:name||"",itemValue:(dojo.isArray(_faa)&&_faa.length===1)?_faa[0]:dojo.toJson(_faa)||""});},_getItemSetFragment:function(_fad){var _fae=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","templates/ItemSetFragment.html"));var _faf=dojo.map(_fad.getNames()||[],function(name){return this._getItemSetItemFragment(name,_fad.getValues(name),_fad.isReadOnly(name));},this);return dojo.string.substitute(_fae,{css:com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE,setName:"attributes",items:_faf.join("\n")});},_getWidgetBody:function(){return new com.ibm.mm.enabler.DeferredImpl(this,function(_fb0,sync){var wm=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _fb1=wm.getWidgetWindow(this);_fb1.setFinishedCallback(dojo.hitch(this,function(_fb2,_fb3,args){var _fb4=args.deferred;var sync=args.sync;var wm=args.wm;var ret=null;if(_fb3==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK&&_fb2){var _fb5=new com.ibm.mm.enabler.DeferredSetImpl();_fb5.addDeferred(wm.getHierarchicalPreferences(_fb2));_fb5.addDeferred(wm.getHierarchicalEventProvider(_fb2));_fb5.setFinishedCallback(dojo.hitch(this,function(_fb6,_fb7,args){var _fb8=args.deferred;var _fb9=args.wWindow;var ret=null;if(_fb7==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){var _fba=_fb6.item(0).result;var _fbb=_fb6.item(1).result;var _fbc=this._getEventDescriptions(_fbb);var _fbd=this._getEvents(_fbb);var _fbe=this._getItemSetFragment(_fba);var _fbf=this._getReceivedEvents(_fb9);ret=this._getWidgetFragment(_fb9,this._getWidgetDefinitionURL(),false,_fbc.join("\n"),_fbd.join("\n"),_fbe,_fbf.join("\n"));}if(_fb8){_fb8.finish(ret,ret?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return ret;}),{deferred:_fb4,wWindow:_fb2});ret=_fb5.start(sync);}else{if(_fb4){_fb4.finish(ret,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}}return ret;}),{deferred:_fb0,sync:sync,wm:wm});var ret=_fb1.start(sync);return ret;});},_getGenericWidgetURI:function(){return this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NON_PREVIEWABLE_WIDGET_LOCATION)||dojo.moduleUrl("com.ibm.mm.enabler.layout.widget","NonPreviewableContentWidget.xml").toString();},_getGenericWidgetBody:function(){return new com.ibm.mm.enabler.DeferredImpl(this,function(_fc0,sync){var wm=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _fc1=wm.getWidgetWindow(this);_fc1.setFinishedCallback(dojo.hitch(this,function(_fc2,_fc3,args){var _fc4=args.deferred;var sync=args.sync;var ret=null;if(_fc3==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK&&_fc2){ret=this._getWidgetFragment(_fc2,this._getGenericWidgetURI());}if(_fc4){_fc4.finish(ret,ret?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return ret;}),{deferred:_fc0,sync:sync});var ret=_fc1.start(sync);return ret;});},replaceControl:function(_fc5,_fc6){return _fc5.replace(com.ibm.mm.enabler.layout.LayoutControlImpl.REGEX_CONTROL,_fc6);},replaceTitle:function(_fc7,_fc8){return _fc7.replace(com.ibm.mm.enabler.layout.LayoutControlImpl.REGEX_TITLE,_fc8);},_templateFunc:function(_fc9,sync,_fca){var def;if(dojo.isString(_fca)&&!this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NON_PREVIEWABLE_WIDGET_LOCATION)){def=this._getWidgetBody();}else{def=this._getGenericWidgetBody();}def.setFinishedCallback(dojo.hitch(this,function(_fcb,_fcc,args){var _fcd=args.skinData;var _fce=args.deferred;var ret=null;var _fcf=dijit._Templated.getCachedTemplate(dojo.moduleUrl("com.ibm.mm.enabler.layout","templates/LayoutControlFragment.html"));if(dojo.isString(_fcd)&&!this.configService.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NON_PREVIEWABLE_WIDGET_LOCATION)){_fcd=this.replaceControl(_fcd,_fcb);var _fd0=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();_fcd=this.replaceTitle(_fcd,_fd0.getTitle(this));}else{_fcd=_fcb;}ret=dojo.string.substitute(_fcf,{controlId:com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this),skinMarkup:_fcd});if(_fce){_fce.finish(ret,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return ret;}),{deferred:_fc9,skinData:_fca});return def;},getRuntimeContent:function(){return new com.ibm.mm.enabler.content.RuntimeContentImpl(this,function(_fd1,sync){var self=this;var skin=this.getSkin();var _fd2=null;if(skin){var _fd3=com.ibm.mashups.enabler.model.staticSkin.Factory.getStaticSkinModel();var _fd4=_fd3.find(skin);_fd4.setFinishedCallback(function(_fd5,_fd6,_fd7){var ret=null;if(_fd6==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){var url=_fd5._getMediaURL();if(url){url=new com.ibm.mm.enabler.utils.HttpUrl(url);var req=new com.ibm.mm.enabler.services.ModelRestServiceRequest(url,null,null,true,sync);req.read(function(_fd8,_fd9,xhr,_fda){if(_fd8==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){ret=self._templateFunc(_fda,sync,_fd9).start(sync);}else{if(_fda){_fda.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}}},_fd7);}else{ret=self._templateFunc(_fd7,sync,null).start(sync);}}else{if(_fd7){_fd7.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}}return ret;},_fd1);_fd2=_fd4.start(sync);}else{_fd2=this._templateFunc(_fd1,sync,null).start(sync);}return _fd2;});},setMetaData:function(name,_fdb){var _fdc=this.inherited(arguments);dojo.publish(com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_SET,[this,name,_fdc,_fdb]);return _fdc;},removeMetaData:function(name){var _fdd=this.inherited(arguments);dojo.publish(com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_REMOVE,[this,name,_fdd,null]);return _fdd;},getSkin:function(){var node=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(com.ibm.mm.enabler.layout.LayoutControlImpl.XPATH_SKIN_ELEMENT,this.getXml(),this.ns);if(node){var id=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"ext:uri","uri",this.ns.ext);var skin=new com.ibm.mm.enabler.layout.SkinIdentifiable(id);if(this._skins.containsKey(skin.getID())){return this._skins.item(skin.getID());}else{this._skins.add(skin.getID(),skin);return skin;}}return null;},setSkin:function(id){if(this.layoutModel._isEmpty(id)){throw new Error(this.layoutModel.modelMessages.E_PARAM_ISNULL_0);}var node=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(com.ibm.mm.enabler.layout.LayoutControlImpl.XPATH_SKIN_ELEMENT,this.getXml(),this.ns);var _fde;if(!node){node=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);node.setAttribute("rel","related");node.setAttribute("type","application/atom+xml");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.getXml().ownerDocument,node,"ext:rel","rel",this.ns.ext,"skin");this.getXml().appendChild(node);}else{_fde=this.getSkin().getID();}var _fdf=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id);if(_fdf!=_fde){var _fe0=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_URL,this.layoutModel);_fe0.setNodes([{value:_fdf,isID:true}]);node.setAttribute("href",_fe0.getAbsoluteURL());com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.getXml().ownerDocument,node,"ext:uri","uri",this.ns.ext,_fe0.getModelURI());this._setDirty();if(this._skins.containsKey(_fde)){var it=this._skins.item(_fde);this._skins.remove(_fde);it.setID(_fe0.getModelURI());this._skins.add(_fdf,it);}dojo.publish(com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_SKIN_SET,[this,null,_fde||null,_fdf]);}},_getWidgetWindowURI:function(){var uri=com.ibm.mashups.enabler.xml.XPath.evaluateString("atom:link[@ext:rel='portlet']/@ext:uri",this.getXml(),this.ns);return uri?dojo.string.trim(uri):null;},_getWidgetDefinitionURL:function(){var xp2="atom:content/model:layout-control/@creation-context:widget-definition-url";return com.ibm.mashups.enabler.xml.XPath.evaluateString(xp2,this.getXml(),this.ns);},_getContext:function(){var _fe1={};var xp1="atom:content/model:layout-control/@creation-context:portlet-definition";var id=com.ibm.mashups.enabler.xml.XPath.evaluateString(xp1,this.getXml(),this.ns);if(id){_fe1[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_ID]=new com.ibm.mm.enabler.IdentifierImpl(id);_fe1[com.ibm.mashups.enabler.layout.Constants.CONTEXT_TYPE]=com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL;return _fe1;}var url=this._getWidgetDefinitionURL();if(url){_fe1[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_URL]=url;_fe1[com.ibm.mashups.enabler.layout.Constants.CONTEXT_TYPE]=com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL;return _fe1;}return null;}});com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_BASE="/"+"com.ibm.mashups.enabler.model.LayoutControl".replace(/\./ig,"/")+"/";com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_SKIN_BASE=com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_BASE+"skin/";com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_SKIN_SET=com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_SKIN_SET+"set";com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_BASE=com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_BASE+"meta/";com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_SET=com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_BASE+"set";com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_REMOVE=com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_METADATA_BASE+"remove";com.ibm.mm.enabler.layout.LayoutControlImpl.XPATH_SKIN_ELEMENT="atom:link[@ext:rel = 'skin' and @rel = 'related']";com.ibm.mm.enabler.layout.LayoutControlImpl._REGEX_START="<\\s*a\\s+rel\\s*=\\s*(\"|')dynamic-content(\"|')\\s+href\\s*=\\s*(\"|')";com.ibm.mm.enabler.layout.LayoutControlImpl._REGEX_END="(\"|')\\s*>.*?<\\s*/\\s*a\\s*>";com.ibm.mm.enabler.layout.LayoutControlImpl.REGEX_CONTROL=new RegExp(com.ibm.mm.enabler.layout.LayoutControlImpl._REGEX_START+"lm:control"+com.ibm.mm.enabler.layout.LayoutControlImpl._REGEX_END,"i");com.ibm.mm.enabler.layout.LayoutControlImpl.REGEX_TITLE=new RegExp(com.ibm.mm.enabler.layout.LayoutControlImpl._REGEX_START+"lm:title"+com.ibm.mm.enabler.layout.LayoutControlImpl._REGEX_END,"i");}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutControl"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutControl"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutControl");}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutFragment_API"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutFragment_API"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutFragment_API");dojo.provide("com.ibm.mashups.enabler.layout.LayoutFragment");dojo.declare("com.ibm.mashups.enabler.layout.LayoutFragment",[com.ibm.mashups.enabler.layout.LayoutNode],{getFragment:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.layout.LayoutFragment.getFragment");},setFragment:function(_fe2){throw new Error("Unimplemented API: com.ibm.mashups.enabler.layout.LayoutFragment.setFragment");},confirmSetFragment:function(_fe3){throw new Error("Unimplemented API: com.ibm.mashups.enabler.layout.LayoutFragment.confirmSetFragment");}});}if(!dojo._hasResource["com.ibm.mm.enabler.layout.LayoutFragmentImpl"]){dojo._hasResource["com.ibm.mm.enabler.layout.LayoutFragmentImpl"]=true;dojo.provide("com.ibm.mm.enabler.layout.LayoutFragmentImpl");dojo.declare("com.ibm.mm.enabler.layout.LayoutFragmentImpl",[com.ibm.mashups.enabler.layout.LayoutFragment,com.ibm.mm.enabler.layout.LayoutNodeImpl,com.ibm.mm.enabler.LocalizedImpl],{constructor:function(){this.fragment="";},getFragment:function(){return this.fragment;},setFragment:function(_fe4){this.fragment=_fe4;this._setDirty();},confirmSetFragment:function(_fe5){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutFragment"]){dojo._hasResource["com.ibm.mashups.enabler.layout.LayoutFragment"]=true;dojo.provide("com.ibm.mashups.enabler.layout.LayoutFragment");}if(!dojo._hasResource["com.ibm.mashups.enabler.wire.Wire_API"]){dojo._hasResource["com.ibm.mashups.enabler.wire.Wire_API"]=true;dojo.provide("com.ibm.mashups.enabler.wire.Wire_API");dojo.provide("com.ibm.mashups.enabler.wire.Wire");dojo.declare("com.ibm.mashups.enabler.wire.Wire",[com.ibm.mashups.enabler.Identifiable],{getSourceWidget:function(){},getSourceEvent:function(){},getSourceEventName:function(){},getSourcePage:function(){},getTargetWidget:function(){},getTargetEvent:function(){},getTargetEventName:function(){},getTargetPage:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.wire.WireImpl"]){dojo._hasResource["com.ibm.mm.enabler.wire.WireImpl"]=true;dojo.provide("com.ibm.mm.enabler.wire.WireImpl");dojo.declare("com.ibm.mm.enabler.wire.WireImpl",[com.ibm.mashups.enabler.wire.Wire,com.ibm.mm.enabler.IdentifiableImpl],{constructor:function(node,_fe6){this.xmlData=node;this.wireModel=_fe6;},_getWireModel:function(){return this.wireModel;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);},_getWireModelUrl:function(){return this.wireModel.href;},_getWireUri:function(){var expr="atom:id";var _fe7=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.wireModel.ns);if(_fe7&&_fe7.length>0){return dojo.string.trim(com.ibm.mm.enabler.utils.Dom.textContent(_fe7[0]));}return null;},_getNode:function(_fe8){var expr="atom:link[@ext:rel='"+_fe8+"']";var _fe9=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.wireModel.ns);if(_fe9&&_fe9.length>0){return _fe9[0];}return null;},_getIdentifier:function(_fea){var _feb=null;var node=this._getNode(_fea);if(node){var id=null;var uri=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"ext:uri","uri",this.wireModel.ns.ext);if(uri){var aPos=uri.indexOf("@");if(aPos!=-1){uri=uri.slice(0,aPos);}var _fec=uri.lastIndexOf(":");if(_fec!=-1){uri=uri.slice(_fec+1);}_fec=uri.toUpperCase().lastIndexOf("%3A");if(_fec!=-1){uri=uri.slice(_fec+3);}_fec=uri.lastIndexOf("/");if(_fec!=-1){uri=uri.slice(_fec+1);}id=uri;}if(id){_feb=new com.ibm.mm.enabler.IdentifierImpl(id,uri);}}return _feb;},_getName:function(_fed){var node=this._getNode(_fed);if(node){var name=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"model:internalName","internalName",this.wireModel.ns.model);if(name){return name;}}return null;},getSourceWidget:function(){var _fee="sourcePortletWindow";return this._getIdentifier(_fee);},getSourceEvent:function(){var _fef="communicationSource";return this._getIdentifier(_fef);},getSourceEventName:function(){var _ff0="communicationSource";return this._getName(_ff0);},getSourcePage:function(){var _ff1="sourcePage";return this._getIdentifier(_ff1);},getTargetWidget:function(){var _ff2="targetPortletWindow";return this._getIdentifier(_ff2);},getTargetEvent:function(){var _ff3="communicationTarget";return this._getIdentifier(_ff3);},getTargetEventName:function(){var _ff4="communicationTarget";return this._getName(_ff4);},getTargetPage:function(){var _ff5="targetPage";return this._getIdentifier(_ff5);},getXml:function(){return this.xmlData;},setXml:function(xml){this.xmlData=xml;this._setDirty();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.wire.Wire"]){dojo._hasResource["com.ibm.mashups.enabler.wire.Wire"]=true;dojo.provide("com.ibm.mashups.enabler.wire.Wire");}if(!dojo._hasResource["com.ibm.mashups.enabler.wire.WireModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.wire.WireModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.wire.WireModel_API");dojo.provide("com.ibm.mashups.enabler.wire.WireModel");dojo.declare("com.ibm.mashups.enabler.wire.WireModel",[com.ibm.mashups.enabler.ListModelController],{create:function(_ff6){},findByTargetWidget:function(id){},findBySourceWidget:function(id){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ConfirmableModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ConfirmableModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ConfirmableModelImpl");dojo.declare("com.ibm.mm.enabler.ConfirmableModelImpl",null,{constructor:function(){var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns_ac=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_AC]);this.helper=com.ibm.mm.enabler.AnonymousHelper;},_isAnonymous:function(){return (this.helper.getAnonymousMode()==com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS);},isAnonymous:function(){return this._isAnonymous();},getConfirmCreate:function(_ff7){return !this._isAnonymous();},getConfirmInsert:function(node,_ff8,_ff9){if(this._isAnonymous()){return false;}var _ffa=true,_ffb=true,_ffc=true;if(_ff9){_ffc=_ff9.hasRole(com.ibm.mashups.enabler.ac.RoleType.USER);}if(_ff8&&_ffc){_ffa=_ff8.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);}if(node&&_ffc&&_ffa){_ffb=node.hasRole(com.ibm.mashups.enabler.ac.RoleType.USER);}return _ffc&&_ffa&&_ffb;},getConfirmReparent:function(node,_ffd,_ffe,next){if(this._isAnonymous()){return false;}var _fff=false;if(node&&_ffd&&_ffe){if(node.isPrivate()){if(_ffe.isPrivate()){_fff=true;}else{_fff=_ffe.hasRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER);}}else{if(!_ffd.isPrivate()&&!_ffe.isPrivate()){_fff=_ffe.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR)&&node.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);}}}return _fff;},getConfirmReorder:function(node,_1000,next){if(this._isAnonymous()){return false;}var _1001=false;if(node&&_1000){if(_1000.isPrivate()){if(node.isPrivate()){_1001=true;}}else{if(node.isPrivate()){_1001=_1000.hasRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER);}else{_1001=_1000.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR)&&node.hasRole(com.ibm.mashups.enabler.ac.RoleType.USER);}}}return _1001;},getConfirmRemove:function(node){if(this._isAnonymous()){return false;}if(node){return node.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);}return false;}});}if(!dojo._hasResource["com.ibm.mm.enabler.utils.Atom"]){dojo._hasResource["com.ibm.mm.enabler.utils.Atom"]=true;dojo.provide("com.ibm.mm.enabler.utils.Atom");com.ibm.mm.enabler.utils.Atom={LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.utils.Atom"),createEntry:function(title,qname,_1002){var _1003={};var _1004="createEntry";var _1005=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1005){this.LOGGER.entering(_1004,[title,qname,_1002]);}var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;var ns=nsf.getNameSpaces([nsf.NS_ATOM]);var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",ns.atom);var _1006=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",ns.atom);entry.appendChild(_1006);var _1007=com.ibm.mm.enabler.utils.Utils.createNode("atom:title",ns.atom);if(title){com.ibm.mm.enabler.utils.Dom.textContent(_1007,title);}entry.appendChild(_1007);var _1008=com.ibm.mm.enabler.utils.Utils.createNode("atom:updated",ns.atom);var time=new Date();com.ibm.mm.enabler.utils.Dom.textContent(_1008,time.toGMTString());entry.appendChild(_1008);var _1009=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",ns.atom);_1009.setAttribute("type","application/xml");entry.appendChild(_1009);if(qname&&_1002){var elem=com.ibm.mm.enabler.utils.Utils.createNode(qname,_1002);_1009.appendChild(elem);_1003.modelElement=elem;}_1003.entryElement=entry;_1003.idElement=_1006;if(_1005){this.LOGGER.exiting(_1004,_1003);}return _1003;}};}if(!dojo._hasResource["com.ibm.mm.enabler.model.WireModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.WireModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.WireModelImpl");dojo.declare("com.ibm.mm.enabler.model.WireModelImpl",[com.ibm.mashups.enabler.wire.WireModel,com.ibm.mashups.enabler.ListModelController,com.ibm.mm.enabler.ConfirmableModelImpl,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.DeferredIteratorImpl],{_cidCounter:0,_cursor:0,_layoutModel:null,constructor:function(href,uri,_100a){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.uri=uri;this.href=href;this._layoutModel=_100a;var _100b=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);this.entryUrl=_100b.url;this.prefix=_100b.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_100b.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH,nsf.NS_XHTML,nsf.NS_XSI]));this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this._nodes=new dojox.collections.Dictionary();this._ids=[];this._insertedNodes=new dojox.collections.Dictionary();this._deletedNodes=new dojox.collections.Dictionary();},create:function(_100c){if(this._isEmpty(_100c)||this._isEmpty(_100c.sourceWidgetId||this._isEmpty(_100c.sourcePageId)||this._isEmpty(_100c.sourcePageId)||this._isEmpty(_100c.sourceEventId)||this._isEmpty(_100c.targetWidgetId)||this._isEmpty(_100c.targetPageId)||this._isEmpty(_100c.targetEventId))){throw new Error(this.modelMessages.E_INVALID_CONTEXT_SPECIFIED_0);}var _100d=com.ibm.mm.enabler.utils.Atom.createEntry("New Wire","model:wire",this.ns.model);var entry=_100d.entryElement;com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_100d.idElement,"ext:uniquename",this.ns.ext,"wire.orderDetails.orderId");com.ibm.mm.enabler.utils.Dom.textContent(_100d.idElement,"cid:"+this._cidCounter++);var _100e=com.ibm.mm.enabler.utils.Utils.createNode("model:isimmediateswitch",this.ns.model);_100e.setAttribute("value","false");_100d.modelElement.appendChild(_100e);var _100f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL;var _1010=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_100f,this);_1010.setNodes([{value:dojo.string.trim(_100c.sourcePageId.getID()),isID:true}]);var _1011=dojo.string.trim(_1010.getModelURI());var link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:rel",this.ns.ext,"sourcePage");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:uri",this.ns.ext,_1011);entry.appendChild(link);_100f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.WIDGET_URL;_1010=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_100f,this);_1010.setNodes([{value:dojo.string.trim(_100c.sourceWidgetId.getID()),isID:true}]);_1011=dojo.string.trim(_1010.getModelURI());link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:rel",this.ns.ext,"sourcePortletWindow");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:uri",this.ns.ext,_1011);entry.appendChild(link);_100f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL;_1010=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_100f,this);_1010.setNodes([{value:dojo.string.trim(_100c.targetPageId.getID()),isID:true}]);_1011=dojo.string.trim(_1010.getModelURI());link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:rel",this.ns.ext,"targetPage");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:uri",this.ns.ext,_1011);entry.appendChild(link);_100f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.WIDGET_URL;_1010=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_100f,this);_1010.setNodes([{value:dojo.string.trim(_100c.targetWidgetId.getID()),isID:true}]);_1011=dojo.string.trim(_1010.getModelURI());link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:rel",this.ns.ext,"targetPortletWindow");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:uri",this.ns.ext,_1011);entry.appendChild(link);_100f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.EVENT_URL;_1010=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_100f,this);_1010.setNodes([{value:dojo.string.trim(_100c.sourceEventId.getID()),isID:true}]);_1011=dojo.string.trim(_1010.getModelURI());link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:rel",this.ns.ext,"communicationSource");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:uri",this.ns.ext,_1011);entry.appendChild(link);_100f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.EVENT_URL;_1010=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_100f,this);_1010.setNodes([{value:dojo.string.trim(_100c.targetEventId.getID()),isID:true}]);_1011=dojo.string.trim(_1010.getModelURI());link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:rel",this.ns.ext,"communicationTarget");com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(link,"ext:uri",this.ns.ext,_1011);entry.appendChild(link);ret=new com.ibm.mm.enabler.wire.WireImpl(entry,this);return ret;},confirmCreate:function(_1012){var page=this._layoutModel._getNavigationNode();if(page){return page.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR)?true:false;}else{return this.getConfirmCreate();}},insert:function(node,_1013){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}this._getData();var id=node.getID();this._nodes.add(id,node);this._ids.push(id);this._insertedNodes.add(id,node);dojo.publish(com.ibm.mashups.enabler.wire.WireModel.TOPIC_WIRE_ADDED,[this,node]);},confirmInsert:function(node,_1014,_1015){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(this._isEmpty(_1014)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}return true;},remove:function(node){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}node=this.find(node).start(true);if(node){var id=node.getID();this._deleteNode(node.getXml());this._nodes.remove(id);for(var ds=0;ds<this._ids.length;ds++){if(this._ids[ds]==id){this._ids.splice(ds,1);break;}}if(!this._insertedNodes.remove(id)){this._deletedNodes.add(id,node);}dojo.publish(com.ibm.mashups.enabler.wire.WireModel.TOPIC_WIRE_REMOVED,[this,node]);}},confirmRemove:function(node){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var page=this._layoutModel._getNavigationNode();if(page){return page.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR)?true:false;}else{return this.getConfirmRemove();}},iterator:function(){return this;},_getData:function(_1016,sync){if(!this._data){this._loadAhead(_1016,true);}return this._data;},_loadAhead:function(_1017,sync){var _1018=null;if(_1017){_1018=_1017.getFinishedCallback();}if(this._data){if(_1018){_1018(this._data,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_1017.getFinishedCallbackParameters());}return this._data;}else{if(!this.href){if(_1018){_1018(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND,_1017.getFinishedCallbackParameters());}return null;}}var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.href,this);var _1019=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1019.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){this._data=data;var _101a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("/atom:feed/atom:entry[not(thr:in-reply-to)]",data,this.ns);if(_101a&&_101a.length>0){for(var i=0,l=_101a.length;i<l;i++){var node=new com.ibm.mm.enabler.wire.WireImpl(_101a[i],this);var id=node.getID();this._nodes.add(id,node);this._ids[i]=id;}}}else{if(_1017&&_1018){_1018(null,xhr.status,_1017.getFinishedCallbackParameters());}}}));return this._data;},_isEmpty:function(obj){return obj===null||typeof obj=="undefined";},_checkValidNode:function(id){if(this._isEmpty(id)&&!com.ibm.mm.enabler.utils.Misc.isInstanceOf(id,com.ibm.mashups.enabler.Identifiable)){throw new Error(dojo.string.substitute(this.modelMessages.E_WIRENODE_NOTFOUND_1,[id]));}return true;},_findNode:function(id){var node=null;this._checkValidNode(id);var xp="/atom:feed/atom:entry[contains(atom:id/text(),':"+com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id)+"')]";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(xp,this._getData(),this.ns);if(nodes&&nodes.length==1){node=new com.ibm.mm.enabler.wire.WireImpl(nodes[0],this);}return node;},find:function(id){if(this._isEmpty(id)){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}this._checkValidNode(id);if(id.getID){id=id.getID();}return new com.ibm.mm.enabler.DeferredImpl(this,function(_101b,sync,id){var _101c=_101b.getFinishedCallback();var node;if(this._nodes.containsKey(id)){node=this._nodes.entry(id).valueOf();}else{node=this._findNode(id);if(node){this._nodes.add(id,node);this._ids.push(id);}}if(node&&_101c){_101c(node,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_101b.getFinishedCallbackParameters());}else{if(_101c){_101c(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND,_101b.getFinishedCallbackParameters());}}return node;},id);},_replaceNodeXmlFromFeed:function(node,_101d){var _101e=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("//atom:entry",_101d,this.ns);if(_101e&&_101e.length==1){this._replaceNodeXml(node,_101e[0]);}},_replaceNodeXml:function(node,_101f){var _1020=node.getXml().parentNode;var oldId=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node);this._deleteNode(node.getXml());node.setXml(_101f);node._setClean();if(_1020){_1020.appendChild(node.getXml());}var newId=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node);if(oldId!=newId){this._nodes.remove(oldId);for(var ds=0;ds<this._ids.length;ds++){if(this._ids[ds]==oldId){this._ids.splice(ds,1);break;}}this._nodes.add(newId,node);this._ids.push(newId);}},_commit:function(_1021,sync,_1022){this._nodes.forEach(function(entry){var node=entry.valueOf();if(node._isDirty()&&!this._insertedNodes.containsKey(entry.key)&&!this._deletedNodes.containsKey(entry.key)){var i=this.href.indexOf("uri=");var _1023=this.href.substring(0,i+4);_1023=_1023+node._getWireUri();var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1023,this);var _1024=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1022._acquire();_1024.update(node.toString(),dojo.hitch(this,function(type,data,xhr,args){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(args.node);var _1025=args.deferred;if(xhr.status==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){this._replaceNodeXmlFromFeed(args.node,data);}var _1026;if(_1025){_1025.finishOperation(id,com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status);}_1022._release(_1021,xhr.status);}),{node:node,deferred:_1021});}},this);this._insertedNodes.forEach(function(entry){var node=entry.valueOf();var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.href,this);var _1027=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1022._acquire();_1027.create(node.toString(),dojo.hitch(this,function(type,data,xhr,args){var _1028=args.deferred;if(xhr.status==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_CREATED){this._replaceNodeXmlFromFeed(node,data);}if(_1028){_1028.finishOperation(node,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status);}_1022._release(_1028,xhr.status);}),{node:node,deferred:_1021});},this);this._insertedNodes.clear();this._deletedNodes.forEach(function(entry){var node=entry.valueOf();var i=this.href.indexOf("/wm");var _1029=this.href.substring(0,i+4);_1029=_1029+node._getWireUri();var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1029,this);var _102a=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1022._acquire();_102a.remove(dojo.hitch(this,function(type,data,xhr,_102b){var _102c;if(_102b){_102b.finishOperation(node.getID(),com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status);}_1022._release(_102b,xhr.status);}),_1021);},this);this._deletedNodes.clear();},hasNext:function(){return this.size().start(true)>this._cursor;},next:function(){var ret=null;if(this.hasNext()){var _102d=this._cursor++;var id=this._ids[_102d];ret=this._nodes.item(id).valueOf()||null;if(ret){var _102e=this.getForeachCallback();if(_102e){_102e(ret,this.getForeachCallbackParameters());}}}return ret;},size:function(){return new com.ibm.mm.enabler.DeferredImpl(this,function(_102f,sync){if(!this._data){this._getData();}var size=this._nodes.count;var _1030=_102f.getFinishedCallback();if(_1030){_1030(size,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_102f.getFinishedCallbackParameters());}return size;});},setCursorPosition:function(_1031){if(_1031<0){throw new Error(this.modelMessages.E_PARAM_IS_SMALLER_ZERO_0);}this._cursor=_1031||0;},getCursorPosition:function(){return this._cursor;},_deleteNode:function(node){if(node&&node.parentNode){node.parentNode.removeChild(node);}},findByTargetWidget:function(id){if(this._isEmpty(id)){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}this._checkValidNode(id);if(id.getID){id=id.getID();}return new com.ibm.mm.enabler.DeferredImpl(this,function(_1032,sync,id){var _1033=_1032.getFinishedCallback();var wires=[];var it=this.iterator();it.start(true);it.setCursorPosition(0);while(it&&it.hasNext()){var wire=it.next();if((wire.getTargetWidget())&&(wire.getTargetWidget().getID()==id)){wires.push(wire);}}if(wires&&_1033){_1033(wires,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_1032.getFinishedCallbackParameters());}else{if(_1033){_1033(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND,_1032.getFinishedCallbackParameters());}}return wires;},id);},findBySourceWidget:function(id){if(this._isEmpty(id)){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}this._checkValidNode(id);if(id.getID){id=id.getID();}return new com.ibm.mm.enabler.DeferredImpl(this,function(_1034,sync,id){var _1035=_1034.getFinishedCallback();var wires=[];var it=this.iterator();it.start(true);it.setCursorPosition(0);while(it&&it.hasNext()){var wire=it.next();if((wire.getSourceWidget())&&(wire.getSourceWidget().getID()==id)){wires.push(wire);}}if(wires&&_1035){_1035(wires,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,_1034.getFinishedCallbackParameters());}else{if(_1035){_1035(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND,_1034.getFinishedCallbackParameters());}}return wires;},id);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.wire.WireModel"]){dojo._hasResource["com.ibm.mashups.enabler.wire.WireModel"]=true;dojo.provide("com.ibm.mashups.enabler.wire.WireModel");com.ibm.mashups.enabler.wire.WireModel.TOPIC_BASE="/"+("com.ibm.mashups.enabler.wire.WireModel".replace(/\./ig,"/"))+"/";com.ibm.mashups.enabler.wire.WireModel.TOPIC_WIRE_ADDED=com.ibm.mashups.enabler.wire.WireModel.TOPIC_BASE+"add";com.ibm.mashups.enabler.wire.WireModel.TOPIC_WIRE_REMOVED=com.ibm.mashups.enabler.wire.WireModel.TOPIC_BASE+"remove";}if(!dojo._hasResource["com.ibm.mashups.enabler.wire.WireModelProvider"]){dojo._hasResource["com.ibm.mashups.enabler.wire.WireModelProvider"]=true;dojo.provide("com.ibm.mashups.enabler.wire.WireModelProvider");dojo.declare("com.ibm.mashups.enabler.wire.WireModelProvider",null,{getWireModel:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.LayoutModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.LayoutModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.LayoutModel_API");dojo.provide("com.ibm.mashups.enabler.model.LayoutModel");dojo.declare("com.ibm.mashups.enabler.model.LayoutModel",[com.ibm.mashups.enabler.TreeModelController,com.ibm.mashups.enabler.wire.WireModelProvider],{create:function(_1036){},getRoot:function(){},hasChildren:function(node){},getChildren:function(node){},getParent:function(node){},isModifiable:function(node){},isDeletable:function(node){},find:function(id){}});}if(!dojo._hasResource["com.ibm.mm.enabler.layout.LayoutModelIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.layout.LayoutModelIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.layout.LayoutModelIteratorImpl");dojo.declare("com.ibm.mm.enabler.layout.LayoutModelIteratorImpl",com.ibm.mm.enabler.DeferredIteratorImpl,{node:null,layoutModel:null,_cursor:0,_last:null,constructor:function(node,_1037){this.node=node;this.layoutModel=_1037;this._setEntries();},_setEntries:function(){var xp="/atom:feed/atom:entry[contains(thr:in-reply-to/@ref,':"+com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this.node)+"')]";this._entries=dojo.map(com.ibm.mashups.enabler.xml.XPath.evaluateXPath(xp,this.layoutModel._getData(),this.layoutModel.ns)||[],this._transform,this);},_getId:function(node){var xp="atom:id";var rawID=dojo.string.trim(com.ibm.mashups.enabler.xml.XPath.evaluateString(xp,node,this.layoutModel.ns));return com.ibm.mm.enabler.IdentifiableHelper.getID(rawID);},_getEntries:function(){return this._entries;},_transform:function(elem){var ret=null;var id=this._getId(elem);if(this.layoutModel._nodes.containsKey(id)){ret=this.layoutModel._nodes.item(id);}else{ret=this.layoutModel._transformNode(elem);this.layoutModel._nodes.add(ret.getID(),ret);}return ret;},hasNext:function(){return this.size().start(true)>this._cursor;},hasPrevious:function(){return this._cursor>0;},_findEntryById:function(id){var ret=null;if(id){dojo.forEach(this._getEntries(),function(node,idx,arr){if(node.getID()==id){ret=node;}},this);}return ret;},_firstEntry:function(){var _1038={};dojo.forEach(this._getEntries(),function(node,idx,arr){var _1039=this.layoutModel._getNextNodeID(node);if(_1039){_1038[_1039]=true;}},this);var ret=null;dojo.forEach(this._getEntries(),function(node,idx,arr){if(!(node.getID() in _1038)){ret=node;}},this);return ret;},_nextEntry:function(node){if(!node){return this._firstEntry();}else{return this._findEntryById(this.layoutModel._getNextNodeID(node));}},_lastEntry:function(){var ret=null;dojo.forEach(this._getEntries(),function(node,idx,arr){var _103a=this.layoutModel._getNextNodeID(node);if(!_103a){ret=node;}},this);return ret;},_previousEntry:function(node){if(!node){return this._lastEntry();}else{var _103b=this.layoutModel._findPointingNodeID(node);return this._findEntryById(_103b);}},previous:function(){if(!this.hasPrevious()){return null;}var elem=this._previousEntry(this._last);this._last=elem;this._cursor--;return elem||null;},next:function(){if(!this.hasNext()){return null;}var elem=this._nextEntry(this._last);this._last=elem;this._cursor++;return elem||null;},size:function(){return new com.ibm.mm.enabler.DeferredImpl(this,function(_103c,sync){var size=this._getEntries().length;if(_103c){_103c.finish(size,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return size;});},seekToEnd:function(){this.setCursorPosition(this.size().start(true));this._last=null;},setCursorPosition:function(_103d){if(_103d<0){throw new Error(this.layoutModel.modelMessages.E_PARAM_IS_SMALLER_ZERO_0);}this._cursor=_103d||0;var x;for(var i=0,size=this.size().start(true);i<this._cursor&&i<size;i++){x=this._nextEntry(x);}this._last=x;},getCursorPosition:function(){return this._cursor;},start:function(){while(this.hasNext()){this.nextFinish(this.next());}}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelBaseMixin"]){dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelBaseMixin"]=true;dojo.provide("com.ibm.mm.enabler.model.layout._LayoutModelBaseMixin");dojo.declare("com.ibm.mm.enabler.model.layout._LayoutModelBaseMixin",null,{_nodes:null,_cidPrefix:"cid:",constructor:function(){this._nodes=new dojox.collections.Dictionary();},_deleteNode:function(node){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.Transformable)){node=node.getXml();}dojo.destroy(node);},_isClientNode:function(node){return (node&&node._getRawID().indexOf(this._cidPrefix)===0);},_getData:function(){if(!this._data){this.getRoot().start(true);}return this._data;},_isEmpty:function(obj){return obj===null||typeof obj=="undefined";},isModifiable:function(node){var _103e="isModifiable(node)";var _103f=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_103f){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_103e,[node]);}if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(this._isClientNode(node)){return true;}var mod=com.ibm.mashups.enabler.xml.XPath.evaluateString("atom:content//model:modifiable",node.getXml(),this.ns);var ret=dojo.string.trim(mod).toLowerCase()=="true";if(_103f){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_103e,[ret]);}return ret;},isDeletable:function(node){var _1040="isDeletable(node)";var _1041=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1041){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1040,[node]);}if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(this._isClientNode(node)){return true;}var del=com.ibm.mashups.enabler.xml.XPath.evaluateString("atom:content//model:deletable",node.getXml(),this.ns);var ret=dojo.string.trim(del).toLowerCase()=="true";if(_1041){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1040,[ret]);}return ret;},_isContainer:function(node){if(this._isEmpty(node)){return false;}if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.Transformable)){node=node.getXml();}return com.ibm.mashups.enabler.xml.XPath.evaluateBoolean("atom:content/model:layout-container",node,this.ns);},_isControl:function(node){if(this._isEmpty(node)){return false;}if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.Transformable)){node=node.getXml();}return com.ibm.mashups.enabler.xml.XPath.evaluateBoolean("atom:content/model:layout-control",node,this.ns);},_transformNode:function(node){return this._isContainer(node)?new com.ibm.mm.enabler.layout.LayoutContainerImpl(node,this):new com.ibm.mm.enabler.layout.LayoutControlImpl(node,this);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelWireModelProviderMixin"]){dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelWireModelProviderMixin"]=true;dojo.provide("com.ibm.mm.enabler.model.layout._LayoutModelWireModelProviderMixin");dojo.declare("com.ibm.mm.enabler.model.layout._LayoutModelWireModelProviderMixin",null,{_wireModel:null,getWireModel:function(){var _1042="getWireModel()";var _1043=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1043){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1042,[]);}if(!this._wireModel&&this._getData()){var expr="/atom:feed/atom:link[@ext:rel='wire']";var node=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,this._getData(),this.ns);if(node){var href=node.getAttribute("href");var uri=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(node,"ext:uri","uri",this.ns.ext);this._wireModel=new com.ibm.mm.enabler.model.WireModelImpl(href,uri,this);}}if(!this._wireModel){this._wireModel=new com.ibm.mm.enabler.model.WireModelImpl(null,null,this);}if(_1043){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1042,[this._wireModel]);}return this._wireModel;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelLocatorMixin"]){dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelLocatorMixin"]=true;dojo.provide("com.ibm.mm.enabler.model.layout._LayoutModelLocatorMixin");dojo.declare("com.ibm.mm.enabler.model.layout._LayoutModelLocatorMixin",null,{find:function(id){var _1044="find(id)";var _1045=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1045){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1044,[id]);}var ret=this._is25()?this._25find(id):this.inherited(arguments);if(_1045){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1044,[ret]);}return ret;},_checkValidNode:function(id){if(this._isEmpty(id)&&!com.ibm.mm.enabler.utils.Misc.isInstanceOf(id,com.ibm.mashups.enabler.Identifiable)){throw new Error(dojo.string.substitute(this.modelMessages.E_LAYOUTNODE_NOTFOUND_1,[id]));}},_findNode:function(id){this._checkValidNode(id);var xp="/atom:feed/atom:entry[contains(atom:id/text(),':"+com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id)+"')]";return com.ibm.mashups.enabler.xml.XPath.evaluateEntry(xp,this._getData(),this.ns)||null;},_25find:function(id){if(this._isEmpty(id)){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}this._checkValidNode(id);return new com.ibm.mm.enabler.DeferredImpl(this,function(_1046,sync,id){var _1047=_1046.getFinishedCallback();var node=null;var tId=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id);if(this._nodes.containsKey(tId)){node=this._nodes.item(tId);}else{node=this._findNode(id);if(node){node=this._transformNode(node);this._nodes.add(tId,node);}}if(_1046){_1046.finish(node,node?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return node;},id);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelTreeModelMixin"]){dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelTreeModelMixin"]=true;dojo.provide("com.ibm.mm.enabler.model.layout._LayoutModelTreeModelMixin");dojo.declare("com.ibm.mm.enabler.model.layout._LayoutModelTreeModelMixin",null,{_root:null,getRoot:function(){var _1048="getRoot()";var _1049=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1049){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1048,arguments);}var ret=new com.ibm.mm.enabler.DeferredImpl(this,this._is25()?this._25getRoot:this._getRoot);if(_1049){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1048,[ret]);}return ret;},_25getRoot:function(_104a,sync){if(this._root){if(_104a){_104a.finish(this._root,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this._root;}else{if(!this.href){if(_104a){_104a.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}}var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.href,this);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);this._applyHiddenMetaDataLoadingStrategyToModelURL(myUrl);var _104b=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_104b.read(dojo.hitch(this,function(type,data,xhr,_104c){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){this._data=data;var node=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("/atom:feed/atom:entry[not(thr:in-reply-to)]",data,this.ns);if(node){this._root=new com.ibm.mm.enabler.layout.LayoutContainerImpl(node,this);}if(_104c){_104c.finish(this._root||null,this._root?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}}else{if(_104c){_104c.finish(null,xhr.status);}}}),_104a);return this._root;},_getRoot:function(_104d,sync){if(this.root){if(_104d){_104d.finish(this.root,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.root;}if(!this.href){if(_104d){_104d.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.href,this);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);var _104e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_104e.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(nodes&&nodes.length>0){this.root=new com.ibm.mm.enabler.layout.LayoutFragmentImpl(nodes[0],this);this.initialLayout[this.uri]=this.root.toString();var _104f=this._getMediaLink();var _1050=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_104f,this);var _1051=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_1050,null,null,true,sync);_1051.read(dojo.hitch(this,function(type2,data2,xhr2,args2){if(type2==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){this.root.setFragment(data2);this.initialContents[this.uri]=data2;}if(_104d){_104d.finish(this.root,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}));}else{if(_104d){_104d.finish(null,xhr.status);}}}else{if(_104d){_104d.finish(null,xhr.status);}}}));return this.root;},hasChildren:function(node){var _1052="hasChildren(node)";var _1053=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1053){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1052,arguments);}var ret=this._is25()?this._25hasChildren(node):this._pre25hasChildren(node);if(_1053){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1052,[ret]);}return ret;},_25hasChildren:function(node){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(!(node instanceof com.ibm.mashups.enabler.layout.LayoutNode)){throw new Error(dojo.string.substitute(this.modelMessages.E_LAYOUTNODE_NOTFOUND_1,[node]));}return this._findRepliesNode(node.getXml())!==null;},_pre25hasChildren:function(node){return false;},getChildren:function(node){var _1054="getChildren(node)";var _1055=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1055){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1054,arguments);}var ret=this._is25()?this._25getChildren(node):this._pre25getChildren(node);if(_1055){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1054,[ret]);}return ret;},_25getChildren:function(node){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(!(node instanceof com.ibm.mashups.enabler.layout.LayoutNode)){throw new Error(dojo.string.substitute(this.modelMessages.E_LAYOUTNODE_NOTFOUND_1,[node]));}return new com.ibm.mm.enabler.layout.LayoutModelIteratorImpl(node,this);},_pre25getChildren:function(node){throw new Error(this.modelMessages.E_UNSUPPORTED_OP_0);},getParent:function(node){var _1056="getParent(node)";var _1057=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1057){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1056,arguments);}var ret=this._is25()?this._25getParent(node):this._pre25getParent(node);if(_1057){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1056,[ret]);}return ret;},_pre25getParent:function(node){throw new Error(this.modelMessages.E_UNSUPPORTED_OP_0);},_25getParent:function(node){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(!(node instanceof com.ibm.mashups.enabler.layout.LayoutNode)){throw new Error(dojo.string.substitute(this.modelMessages.E_LAYOUTNODE_NOTFOUND_1,[node]));}return new com.ibm.mm.enabler.DeferredImpl(this,this._25getParentDeferredStart,{node:node});},_25getParentDeferredStart:function(_1058,sync,args){var node=args.node;var ret=null;var xid=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("thr:in-reply-to",node.getXml(),this.ns);if(xid){var rawId=xid.getAttribute("ref");var id=com.ibm.mm.enabler.IdentifiableHelper.getID(rawId);if(this._nodes.containsKey(id)){ret=this._nodes.item(id);}else{var xp="/atom:feed/atom:entry[contains(atom:id/text(),'"+rawId+"')]";var node2=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(xp,this._getData(),this.ns);if(node2){ret=new com.ibm.mm.enabler.layout.LayoutContainerImpl(node2,this);this._nodes.add(com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(ret),ret);}}}if(_1058){_1058.finish(ret,ret?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return ret;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelTreeModelControllerMixin"]){dojo._hasResource["com.ibm.mm.enabler.model.layout._LayoutModelTreeModelControllerMixin"]=true;dojo.provide("com.ibm.mm.enabler.model.layout._LayoutModelTreeModelControllerMixin");dojo.declare("com.ibm.mm.enabler.model.layout._LayoutModelTreeModelControllerMixin",[com.ibm.mm.enabler.model.layout._LayoutModelTreeModelMixin],{_deletedNodes:null,constructor:function(){this._deletedNodes=new dojox.collections.Dictionary();},_deParent:function(node){var _1059=this.getParent(node).start(true);if(_1059){var _105a=this.getChildren(_1059);if(_105a&&_105a.size().start(true)===1){this._deleteNode(this._findRepliesNode(_1059.getXml()));return true;}}return false;},_findRepliesNode:function(entry){return com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:link[@rel='replies']",entry,this.ns)||null;},_findPointingNodeID:function(node){var ret=null;var xp="/atom:feed/atom:entry[contains(atom:link[@rel=\"next\"]/@ext:uri,\":"+com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node)+"@\")]/atom:id";var id=com.ibm.mashups.enabler.xml.XPath.evaluateString(xp,this._getData(),this.ns);if(id){var rawID=dojo.string.trim(id);ret=com.ibm.mm.enabler.IdentifiableHelper.getID(rawID);}return ret;},_getPrevious:function(node){var _105b=this._findPointingNodeID(node);if(_105b){return this.find(_105b).start(true);}return null;},_setNext:function(node,_105c){if(node){var next=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:link[@rel='next']",node.getXml(),this.ns);if(!next&&_105c){next=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);next.setAttribute("rel","next");next.setAttribute("type","application/atom+xml");node.getXml().appendChild(next);}if(next&&_105c){var _105d=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_105d.setNodes([{value:_105c.getID(),isID:true},{value:this.navigationNode.getID(),isID:true}]);next.setAttribute("href","?uri="+_105d.getModelURI());com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.getXml().ownerDocument,next,"ext:uri","uri",this.ns.ext,_105d.getModelURI());}else{if(next){this._deleteNode(next);}}}},_getNextNodeRawID:function(node){var ret=null;if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.Transformable)){node=node.getXml();}var xp="atom:link[@rel='next']";var n=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(xp,node,this.ns);if(n){ret=dojo.string.trim(com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(n,"ext:uri","uri",this.ns.ext));}return ret;},_getNextNodeID:function(node){var ret=this._getNextNodeRawID(node);if(ret){ret=com.ibm.mm.enabler.IdentifiableHelper.getID(ret);}return ret;},_getNext:function(node){var _105e=this._getNextNodeID(node.getXml());if(_105e){return this.find(_105e).start(true);}return null;},_setParent:function(node,_105f){if(node&&_105f){var _1060=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_1060.setNodes([{value:_105f.getID(),isID:true},{value:this.navigationNode.getID(),isID:true}]);var thr=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("thr:in-reply-to",node.getXml(),this.ns);if(!thr){thr=com.ibm.mm.enabler.utils.Utils.createNode("thr:in-reply-to",this.ns.thr);node.xmlData.appendChild(thr);}var _1061=_1060.getModelURI();thr.setAttribute("ref",_1061);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.getXml().ownerDocument,thr,"ext:uri","uri",this.ns.ext,_1061);thr.setAttribute("href",_1060.getAbsoluteURL());}},_setReplies:function(node){var _1062=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_1062.setNodes([{value:node.getID(),isID:true}]);_1062.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);var reply=this._findRepliesNode(node.getXml());if(reply===null){reply=com.ibm.mm.enabler.utils.Dom.createElement(this._getData(),"atom:link",this.ns.atom);reply.setAttribute("rel","replies");reply.setAttribute("type","application/atom+xml");node.getXml().appendChild(reply);}reply.setAttribute("href",_1062.getAbsoluteURL());com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this._getData(),reply,"ext:uri","uri",this.ns.ext,_1062.getModelURI());},create:function(_1063){var _1064="create(context)";var _1065=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1065){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1064,arguments);}var ret=this._is25()?this._25create(_1063):this._pre25create(_1063);if(_1065){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1064,[ret]);}return ret;},_cidCounter:0,_25create:function(_1066){if(this._isEmpty(_1066)){throw new Error(this.modelMessages.E_PARAM_ISNULL_0);}var _1067=_1066[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_ID];var _1068=_1066[com.ibm.mashups.enabler.layout.Constants.CONTEXT_WIDGET_DEFINITION_URL];var type=_1066[com.ibm.mashups.enabler.layout.Constants.CONTEXT_TYPE];if(this._isEmpty(type)||(type!=com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL&&type!=com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTAINER)){throw new Error(this.modelMessages.E_INVALID_CONTEXT_MISSING_TYPE_0);}if(type==com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL&&!(this._isEmpty(_1067)^this._isEmpty(_1068))){throw new Error(this.modelMessages.E_INVALID_CONTEXT_SPECIFIED_0);}if(!this._isEmpty(_1067)&&(!dojo.isString(_1067)&&!com.ibm.mm.enabler.utils.Misc.isInstanceOf(_1067,com.ibm.mashups.enabler.Identifiable))){throw new Error(this.modelMessages.E_WIDGETDEF_MUST_BE_IDENTIFIABLE_0);}var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);var id=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(id,this._cidPrefix+this._cidCounter++);entry.appendChild(id);var _1069=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);_1069.setAttribute("type","application/xml");entry.appendChild(_1069);var mNode,ret;if(type==com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL){mNode=com.ibm.mm.enabler.utils.Utils.createNode("model:layout-control",this.ns.model);var attr,val;if(_1067){attr="portlet-definition";var _106a=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.WIDGET_URL,this);_106a.setNodes([{value:com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_1067),isID:true}]);val=_106a.getModelURI();}else{attr="widget-definition-url";val=_1068.toString();}com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this._getData(),mNode,"creation-context:"+attr,attr,this.ns["creation-context"],val);ret=new com.ibm.mm.enabler.layout.LayoutControlImpl(entry,this);}else{if(type==com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTAINER){mNode=com.ibm.mm.enabler.utils.Utils.createNode("model:layout-container",this.ns.model);ret=new com.ibm.mm.enabler.layout.LayoutContainerImpl(entry,this);}}_1069.appendChild(mNode);return ret;},_pre25create:function(_106b){var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);var id=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom);var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL,this);myUrl.setNodes([{value:this.uri,isID:true}]);com.ibm.mm.enabler.utils.Dom.textContent(id,myUrl.getModelURI());entry.appendChild(id);var _106c=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);var node2=com.ibm.mm.enabler.utils.Utils.createNode("model:static-content-page",this.ns.model);var _106d=com.ibm.mm.enabler.utils.Utils.createNode("model:title",this.ns.model);var _106e=com.ibm.mm.enabler.utils.Utils.createNode("model:description",this.ns.model);node2.appendChild(_106d);node2.appendChild(_106e);_106c.appendChild(node2);entry.appendChild(_106c);this.m_create=true;return new com.ibm.mm.enabler.layout.LayoutFragmentImpl(entry,this);},confirmCreate:function(_106f){var _1070="confirmCreate(context)";var _1071=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1071){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1070,arguments);}var ret=this._is25()?this._25confirmCreate(_106f):this._pre25confirmCreate(_106f);if(_1071){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1070,[ret]);}return ret;},_25confirmCreate:function(_1072){return this.getConfirmCreate();},_pre25confirmCreate:function(_1073){return this.getConfirmCreate();},insert:function(node,_1074,_1075){var _1076="insert(node,parentNode,nextNode)";var _1077=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1077){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1076,arguments);}var ret=this._is25()?this._25insert(node,_1074,_1075):this._pre25insert(node,_1074,_1075);if(_1077){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1076,[ret]);}return ret;},_25insert:function(node,_1078,_1079){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(this._isEmpty(_1078)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var _107a=this.getParent(node).start(true);var _107b=this.getChildren(_1078)._lastEntry();var _107c=this._getNext(node);var _107d=this._getPrevious(node);var _107e=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_107a)!=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_1078);if(_107e){if(_107a){this._deParent(node);}this._setParent(node,_1078);this._setReplies(_1078);}if(_1079){var _107f=this._getPrevious(_1079);if(_107f){this._setNext(_107f,node);}}else{if(_107b){this._setNext(_107b,node);}}if(_107d){}this._setNext(node,_1079||null);node._setDirty();this._nodes.add(com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node),node);_1078.getXml().parentNode.appendChild(node.getXml());},_pre25insert:function(node,_1080,_1081){this.root=node;},confirmInsert:function(node,_1082,_1083){var _1084="confirmInsert(node,parentNode,nextNode)";var _1085=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1085){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1084,arguments);}var ret=this._is25()?this._25confirmInsert(node,_1082,_1083):this._pre25confirmInsert(node,_1082,_1083);if(_1085){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1084,[ret]);}return ret;},_25confirmInsert:function(node,_1086,_1087){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(this._isEmpty(_1086)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}return this._isContainer(_1086)&&com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node)!=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_1086)&&this.getConfirmInsert(null,this.navigationNode,null)&&this.isModifiable(node)&&this.isModifiable(_1086);},_pre25confirmInsert:function(node,_1088,_1089){return true;},remove:function(node){var _108a="confirmInsert(node,parentNode,nextNode)";var _108b=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_108b){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_108a,arguments);}var ret=this._is25()?this._25remove(node):this._pre25remove(node);if(_108b){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_108a,[ret]);}return ret;},_25remove:function(node,_108c){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}node=this.find(node).start(true);if(node){var _108d=-1;if(this._isContainer(node)){var _108e=this.getChildren(node);var _108f=[];while(_108e.hasNext()){var child=_108e.next();_108f.push(child);}dojo.forEach(_108f,function(node){this._25remove(node,true);},this);}var _1090=this.getParent(node).start(true);if(_1090){_108d=this.getChildren(_1090).size().start(true)-1;}this._deleteNode(node.getXml());var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node);this._nodes.remove(id);if(!_108c&&!this._isClientNode(node)){this._deletedNodes.add(id,node);}if(id==com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this._root)){this._root=null;}if(_108d===0){this._deParent(node);}else{if(_108d>0){var _1091=this._getNext(node);var _1092=this._getPrevious(node);if(_1092){this._setNext(_1092,_1091);}}else{}}}},_pre25remove:function(node){this.root=null;},confirmRemove:function(node){var _1093="confirmRemove(node)";var _1094=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_1094){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_1093,arguments);}var ret=this._is25()?this._25confirmRemove(node):this._pre25confirmRemove(node);if(_1094){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_1093,[ret]);}return ret;},_25confirmRemove:function(node){if(this._isEmpty(node)){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}if(this.isDeletable(node)){if(this.navigationNode.isPrivate()){return this.navigationNode.hasRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER);}else{return this.navigationNode.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);}}else{return false;}},_pre25confirmRemove:function(node){return this.getConfirmRemove(node);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.LayoutModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.LayoutModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.LayoutModelImpl");dojo.declare("com.ibm.mm.enabler.model.LayoutModelImpl",[com.ibm.mashups.enabler.model.LayoutModel,com.ibm.mashups.enabler.TreeModelController,com.ibm.mashups.enabler.wire.WireModelProvider,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl,com.ibm.mm.enabler.ConfirmableModelImpl,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.model.layout._LayoutModelBaseMixin,com.ibm.mm.enabler.model.layout._LayoutModelWireModelProviderMixin,com.ibm.mm.enabler.model.layout._LayoutModelTreeModelControllerMixin,com.ibm.mm.enabler.model.layout._LayoutModelLocatorMixin],{ns:null,urlType:com.ibm.mashups.enabler.model.url.ModelUrlFactory.LAYOUT_URL,entryUrl:"",navigationNode:null,constructor:function(href,uri,_1095,_1096){this.uri=uri;this.href=href;this.navigationModel=_1095;this.navigationNode=_1096;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");var _1097=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);if(!this._is25()){this.prefix=_1097.idprefix;this.root=null;this.m_create=false;this.initialContents={};this.initialLayout={};this.entryUrl=_1097.url;}else{this.entryUrl=this.href;}this.ns=dojo.delegate(_1097.namespaces,com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaces([com.ibm.mm.enabler.model.NameSpaceFactory.NS_ATOM,com.ibm.mm.enabler.model.NameSpaceFactory.NS_THR,com.ibm.mm.enabler.model.NameSpaceFactory.NS_XML,com.ibm.mm.enabler.model.NameSpaceFactory.NS_OPENSEARCH,com.ibm.mm.enabler.model.NameSpaceFactory.NS_XHTML,com.ibm.mm.enabler.model.NameSpaceFactory.NS_XSI]));},_getNavigationNode:function(){return this.navigationNode;},_getNavigationModel:function(){return this.navigationModel;},getRootInternal:function(){if(!this.root){this.getRoot().start(true);}return this.root;},_commit:function(_1098,sync,_1099){return this._is25()?this._25commit(_1098,sync,_1099):this._pre25commit(_1098,sync,_1099);},_replaceNodeXmlFromFeed:function(node,_109a){var _109b=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("//atom:entry",_109a,this.ns);if(_109b&&_109b.length==1){this._replaceNodeXml(node,_109b[0]);}},_replaceNodeXml:function(node,_109c){if(dojo.isWebKit){_109c=_109c.cloneNode(true);}var _109d=node.getXml().parentNode;var _109e=this._getPrevious(node);var _109f=this._getNext(node);var _10a0=this._isClientNode(node);var oldId=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node);this._deleteNode(node.getXml());node.setXml(_109c);node._setClean();_109d.appendChild(node.getXml());if(_109e&&_10a0){this._setNext(_109e,node);}if(_109f&&this._isClientNode(_109f)){this._setNext(node,_109f);}var newId=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node);if(oldId!=newId){this._nodes.remove(oldId);this._nodes.add(newId,node);}},_commitWireModel:function(_10a1,sync,_10a2){if(this._wireModel){this._wireModel._commit(_10a1,sync,_10a2);}},_commitDelete:function(_10a3,sync,_10a4){this._deletedNodes.forEach(function(entry){var node=entry.valueOf();var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(node.getEditLink(),this);var _10a5=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_10a4._acquire();_10a5.remove(dojo.hitch(this,function(type,data,xhr,_10a6){if(_10a6){_10a6.finishOperation(node.getID(),com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status);}_10a4._release(_10a6,xhr.status);}),_10a3);},this);this._deletedNodes.clear();},_commitChanges:function(_10a7,sync,_10a8,_10a9){if(!_10a9){return;}var _10aa=this.getChildren(_10a9);_10aa.seekToEnd();while(_10aa.hasPrevious()){var node=_10aa.previous();if(this._isContainer(node)){this._commitChanges(_10a7,sync,_10a8,node);}else{if(this._isClientNode(node)){this._insertCommit(node,_10a7,sync,_10a8);}else{if(node&&node._isDirty()){this._updateCommit(node,_10a7,sync,_10a8);}}}}},_updateCommit:function(node,_10ab,sync,_10ac){var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(node.getEditLink(),this);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);if(this._isControl(node)){myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);}var _10ad=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_10ac._acquire();_10ad.update(node.toString(),dojo.hitch(this,function(type,data,xhr,args){var _10ae=args.deferred;if(xhr.status==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){this._replaceNodeXmlFromFeed(args.node,data);}if(_10ae){_10ae.finishOperation(com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(args.node),com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status);}_10ac._release(_10ae,xhr.status);}),{node:node,deferred:_10ab});},_insertCommit:function(node,_10af,sync,_10b0){var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.entryUrl,this);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);if(this._isControl(node)){myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);}var _10b1=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_10b0._acquire();_10b1.create(node.toString(),dojo.hitch(this,function(type,data,xhr,args){var _10b2=args.deferred;var node=args.node;if(xhr.status==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_CREATED){this._replaceNodeXmlFromFeed(node,data);}if(_10b2){_10b2.finishOperation(node,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status);}_10b0._release(_10b2,xhr.status);}),{node:node,deferred:_10af});},_25commit:function(_10b3,sync,_10b4){this._commitWireModel(_10b3,sync,_10b4);this._commitDelete(_10b3,sync,_10b4);this._commitChanges(_10b3,sync,_10b4,this.getRoot().start(true));},_pre25commit:function(_10b5,sync,_10b6){var _10b7="_pre25commit";var _10b8=com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.isLoggable(com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL);if(_10b8){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.entering(_10b7,[_10b5,sync,_10b6]);}if(this.root){var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL,this);myUrl.setNodes([{value:this.uri||"cid:0",isID:true}]);var clean=(this.initialLayout[this.uri]==this.root.toString())?true:false;var expr="atom:link";var _10b9,_10ba,_10bb,_10bc,_10bd;var links=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.root.xmlData,this.ns);for(var i=0,l=links.length;i<l;i++){var _10be=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(links[i],"ext:rel","rel",this.ns.ext);if(_10be&&_10be=="theme"){_10b9=links[i].parentNode;_10b9.removeChild(links[i]);if(clean){this.initialLayout[this.uri]=this.root.toString();}break;}}expr="atom:content/model:static-content-page/model:content";var _10bf=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.root.xmlData,this.ns);if(_10bf&&_10bf.length>0){_10b9=_10bf[0].parentNode;_10b9.removeChild(_10bf[0]);if(clean){this.initialLayout[this.uri]=this.root.toString();}}var entry=com.ibm.mm.enabler.utils.Utils.createFeed(myUrl.getModelURI(),"IBM Lotus Mashups Fragment Feed",this.root.toString(),this.ns);var _10c0=this.root.getFragment();if(this.m_create){_10b6._acquire();_10ba=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.entryUrl,this);_10bb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_10ba,null,null,false,sync);_10bb.create(entry,dojo.hitch(this,function(type,data,xhr,args){if(data!==null&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(nodes&&nodes.length>0){this.root=new com.ibm.mm.enabler.layout.LayoutFragmentImpl(nodes[0],this);this.initialLayout[this.uri]=this.root.toString();}}if(_10b5&&_10b5.operationCallback){_10b5.operationCallback(this.root,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_10b5.operationCallbackParameters);}if(_10c0===null){_10b6._release(_10b5,xhr.status);}}));if(_10c0!==null){_10bc=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_MEDIA_URL,this);_10bc.setNodes([{value:this.root.getID(),isID:true},{value:"index.html",isID:false}]);_10bd=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_10bc,null,null,false,sync);_10bd.create(_10c0,dojo.hitch(this,function(type,data,xhr,args){_10b6._release(_10b5,xhr.status);this.initialContents[this.uri]=_10c0;}));}}else{if(this.initialLayout[this.uri]!=this.root.toString()){_10b6._acquire();_10ba=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL,this);_10ba.setNodes([{value:this.root.getID(),isID:true}]);_10bb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_10ba,null,null,false,sync);_10bb.update(entry,dojo.hitch(this,function(type,data,xhr,args){if(_10b5&&_10b5.operationCallback){_10b5.operationCallback(this.root,com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_10b5.operationCallbackParameters);}_10b6._release(_10b5,xhr.status);}));this.initialLayout[this.uri]=this.root.toString();}var _10c1=this._getEditMediaLink();if(_10c0!==null&&this.initialContents[this.uri]!=_10c0&&_10c1){_10bc=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_10c1,this);_10bd=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_10bc,null,null,false,sync);_10b6._acquire();_10bd.update(_10c0,dojo.hitch(this,function(type,data,xhr,args){_10b6._release(_10b5,xhr.status);}));this.initialContents[this.uri]=_10c0;}}}this.m_create=false;if(_10b8){com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER.exiting(_10b7);}},_getMediaLink:function(){var _10c2=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ext:rel='media']",this.root.xmlData,this.ns);if(_10c2&&_10c2.length>0){return _10c2[0].getAttribute("href");}return null;},_getEditMediaLink:function(){var _10c3=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@rel='edit-media']",this.root.xmlData,this.ns);if(_10c3&&_10c3.length>0){return _10c3[0].getAttribute("href");}return null;},switchUri:function(uri){this.initialLayout[uri]=this.initialLayout[this.uri];this.initialContents[uri]=this.initialContents[this.uri];delete this.initialLayout[this.uri];delete this.initialContents[this.uri];this.uri=uri;}});com.ibm.mm.enabler.model.LayoutModelImpl.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.model.LayoutModelImpl");com.ibm.mm.enabler.model.LayoutModelImpl.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;}if(!dojo._hasResource["com.ibm.mashups.enabler.model.LayoutModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.LayoutModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.LayoutModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.NavigationModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.NavigationModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.NavigationModel_API");dojo.provide("com.ibm.mashups.enabler.model.NavigationModel");dojo.declare("com.ibm.mashups.enabler.model.NavigationModel",[com.ibm.mashups.enabler.TreeModelController,com.ibm.mashups.enabler.model.SelectionLocator,com.ibm.mashups.enabler.Discardable,com.ibm.mashups.enabler.Invalidatable,com.ibm.mashups.enabler.Primeable],{setPrimingData:function(data){},hasLayoutModel:function(page){},getLayoutModel:function(page){},getSharedRoot:function(){},confirmExport:function(page){},create:function(_10c4){},commit:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ThemeProvider"]){dojo._hasResource["com.ibm.mashups.enabler.ThemeProvider"]=true;dojo.provide("com.ibm.mashups.enabler.ThemeProvider");dojo.declare("com.ibm.mashups.enabler.ThemeProvider",null,{getTheme:function(){},setTheme:function(theme){},getThemeIdentifier:function(){},setThemeIdentifier:function(theme){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationElement_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationElement_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationElement_API");dojo.provide("com.ibm.mashups.enabler.navigation.NavigationElement");dojo.declare("com.ibm.mashups.enabler.navigation.NavigationElement",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mashups.enabler.ThemeProvider,com.ibm.mashups.enabler.ac.EffectiveAccess,com.ibm.mashups.enabler.Transformable],{isHidden:function(){},setHidden:function(hide){},confirmSetHidden:function(hide){},getNavigationElementType:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.NextLinkProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.NextLinkProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.NextLinkProviderImpl");dojo.declare("com.ibm.mm.enabler.NextLinkProviderImpl",null,{constructor:function(node){this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns_nlp=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM]));this.NLP_NEXT_LINK="atom:link[@rel='next']";},_getNextURI:function(){var _10c5=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLP_NEXT_LINK,this.xmlData,this.ns_nlp);if(nodes&&nodes.length>0){_10c5=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(link,"ext:rel","rel",this.ns_nlp.ext);}else{throw new Error(dojo.string.substitute(this.modelMessages.E_ELEMENT_NOT_FOUND_2,[this.NLP_NEXT_LINK,this.toString()]));}return _10c5;}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationElementImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationElementImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.NavigationElementImpl");dojo.declare("com.ibm.mm.enabler.navigation.NavigationElementImpl",[com.ibm.mashups.enabler.navigation.NavigationElement,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.TransformableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.MetaDataImpl2,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.NextLinkProviderImpl,com.ibm.mm.enabler.ac.EffectiveAccessImpl],{constructor:function(node){this.xmlData=node;this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns_nav=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_CA]));this._THEME_LINK="atom:link[@ext:rel='theme']";this._theme_changed=false;},isPrivate:function(){return this._isPrivate();},isHidden:function(){var ret1=(this.getMetaData("com.ibm.mashups.navigation.hidden")=="true")?true:false;var ret2=(this.getMetaData("com.ibm.portal.Hidden")=="true")?true:false;return (ret1||ret2);},setHidden:function(hide){var name=this.cs.getValue("com.ibm.mashups.navigation.hidden");this.setMetaData(name,(hide)?"true":"false");},confirmSetHidden:function(hide){var ret1=this.confirmSetMetaData("com.ibm.mashups.navigation.hidden",(hide)?"true":"false");var ret2=this.confirmSetMetaData("com.ibm.portal.Hidden",(hide)?"true":"false");return (ret1&&ret2);},_getSpaceIdentifier:function(){var _10c6=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ca:rel='application']",this.xmlData,this.ns_nav);if(nodes&&nodes.length>0){var id=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,nodes[0]);var href=nodes[0].getAttribute("href");_10c6=new com.ibm.mm.enabler.IdentifierImpl(id,{"href":href});}return _10c6;},getThemeIdentifier:function(){var _10c7=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._THEME_LINK,this.xmlData,this.ns_nav);if(nodes&&nodes.length>0){var id=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,nodes[0]);var href=nodes[0].getAttribute("href");_10c7=new com.ibm.mm.enabler.IdentifierImpl(id,{"href":href});}return _10c7||null;},isThemeChanged:function(){return this._theme_changed;},setThemeIdentifier:function(_10c8){var _10c9=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this._THEME_LINK,this.xmlData,this.ns_nav);if(!_10c8){if(_10c9&&"true"==com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_10c9,"ext:inherited","inherited",this.ns_nav.ext)){dojo.destroy(_10c9);}return;}if(!_10c9){_10c9=com.ibm.mm.enabler.utils.Dom.createElement(this.xmlData.ownerDocument,"atom:link",this.ns_nav.atom);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,_10c9,"ext:rel","rel",this.ns_nav.ext,"theme");this.xmlData.appendChild(_10c9);}var _10ca=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_URL,this);_10ca.setNodes([{value:_10c8.getID(),isID:true}]);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,_10c9,"ext:uri","uri",this.ns_nav.ext,_10ca.getModelURI());this._setDirty();this._theme_changed=true;},getNavigationElementType:function(){return this._type;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationElement"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationElement"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationElement");}if(!dojo._hasResource["com.ibm.mashups.enabler.content.ContentNode"]){dojo._hasResource["com.ibm.mashups.enabler.content.ContentNode"]=true;dojo.provide("com.ibm.mashups.enabler.content.ContentNode");dojo.declare("com.ibm.mashups.enabler.content.ContentNode",[com.ibm.mashups.enabler.Identifiable],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.ContentPage"]){dojo._hasResource["com.ibm.mashups.enabler.content.ContentPage"]=true;dojo.provide("com.ibm.mashups.enabler.content.ContentPage");dojo.declare("com.ibm.mashups.enabler.content.ContentPage",[com.ibm.mashups.enabler.content.ContentNode,com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.Transformable],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.ContentProvider"]){dojo._hasResource["com.ibm.mashups.enabler.content.ContentProvider"]=true;dojo.provide("com.ibm.mashups.enabler.content.ContentProvider");dojo.declare("com.ibm.mashups.enabler.content.ContentProvider",null,{getContent:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.ContentProvider.getContent");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.ServerRuntimeContent"]){dojo._hasResource["com.ibm.mashups.enabler.content.ServerRuntimeContent"]=true;dojo.provide("com.ibm.mashups.enabler.content.ServerRuntimeContent");dojo.declare("com.ibm.mashups.enabler.content.ServerRuntimeContent",null,{getServerRuntimeMarkup:function(_10cb){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.ServerRuntimeContent.getServerRuntimeMarkup");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.ServerRuntimeContentProvider"]){dojo._hasResource["com.ibm.mashups.enabler.content.ServerRuntimeContentProvider"]=true;dojo.provide("com.ibm.mashups.enabler.content.ServerRuntimeContentProvider");dojo.declare("com.ibm.mashups.enabler.content.ServerRuntimeContentProvider",null,{getServerRuntimeContent:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.ServerRuntimeContentProvider.getServerRuntimeContent");},primeServerRuntimeContent:function(_10cc){throw new Error("Unimplemented SPI: com.ibm.mashups.enabler.content.ServerRuntimeContentProvider.primeServerRuntimeContent");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationNode_API");dojo.provide("com.ibm.mashups.enabler.navigation.NavigationNode");dojo.declare("com.ibm.mashups.enabler.navigation.NavigationNode",[com.ibm.mashups.enabler.navigation.NavigationElement,com.ibm.mashups.enabler.content.ContentProvider,com.ibm.mashups.enabler.content.ServerRuntimeContentProvider,com.ibm.mashups.enabler.RepresentationProvider],{getExportPageURL:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.content.ContentPageImpl"]){dojo._hasResource["com.ibm.mm.enabler.content.ContentPageImpl"]=true;dojo.provide("com.ibm.mm.enabler.content.ContentPageImpl");dojo.declare("com.ibm.mm.enabler.content.ContentPageImpl",[com.ibm.mashups.enabler.content.ContentPage,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.MetaDataImpl2,com.ibm.mm.enabler.TransformableImpl,com.ibm.mm.enabler.DirtyFlagProviderImpl,com.ibm.mm.enabler.ac.EffectiveAccessImpl],{_navigationNode:null,constructor:function(node,_10cd){this.xmlData=node;this._navigationNode=_10cd;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);},setMetaData:function(name,value,_10ce){if(this._navigationNode.shouldSyncMetaData()&&!_10ce){this._navigationNode.setMetaData(name,value,true);}this.inherited(arguments);},removeMetaData:function(name,_10cf){if(this._navigationNode.shouldSyncMetaData()&&!_10cf){this._navigationNode.removeMetaData(name,true);}this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.StaticContentPage_API"]){dojo._hasResource["com.ibm.mashups.enabler.content.StaticContentPage_API"]=true;dojo.provide("com.ibm.mashups.enabler.content.StaticContentPage_API");dojo.provide("com.ibm.mashups.enabler.content.StaticContentPage");dojo.declare("com.ibm.mashups.enabler.content.StaticContentPage",[com.ibm.mashups.enabler.content.ContentPage,com.ibm.mashups.enabler.ModifiableMetaData],{getStaticMarkup:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.getStaticMarkup");},setStaticMarkup:function(_10d0){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.setStaticMarkup");},confirmSetStaticMarkup:function(_10d1){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.confirmSetStaticMarkup");},refreshStaticMarkup:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.refreshStaticMarkup");},confirmRefreshStaticMarkup:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.confirmRefreshStaticMarkup");},getStaticContentURL:function(){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.getStaticContentURL");},setStaticContentURL:function(url){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.setStaticContentURL");},confirmSetStaticContentURL:function(url){throw new Error("Unimplemented API: com.ibm.mashups.enabler.content.StaticContentPage.confirmSetStaticContentURL");}});}if(!dojo._hasResource["com.ibm.mashups.enabler.content.StaticContentPage"]){dojo._hasResource["com.ibm.mashups.enabler.content.StaticContentPage"]=true;dojo.provide("com.ibm.mashups.enabler.content.StaticContentPage");}if(!dojo._hasResource["com.ibm.mm.enabler.content.StaticContentPageImpl"]){dojo._hasResource["com.ibm.mm.enabler.content.StaticContentPageImpl"]=true;dojo.provide("com.ibm.mm.enabler.content.StaticContentPageImpl");dojo.declare("com.ibm.mm.enabler.content.StaticContentPageImpl",[com.ibm.mashups.enabler.content.StaticContentPage,com.ibm.mm.enabler.content.ContentPageImpl,com.ibm.mm.enabler.EditLinkProviderImpl],{constructor:function(node){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_CA]));this._MEDIA_LINK="atom:link[@ext:rel='media']";this._LAYOUT_TEMPLATE_REF_MDNAME="com.ibm.portal.layout.template.ref";this._staticMarkup=null;this._refreshStaticMarkup=true;this._isStaticMarkupDirty=false;},getStaticContentURL:function(){return this.getMetaData(this._LAYOUT_TEMPLATE_REF_MDNAME);},setStaticContentURL:function(url){return this.setMetaData(this._LAYOUT_TEMPLATE_REF_MDNAME,url);},confirmSetStaticContentURL:function(url){return this.confirmSetMetaData(this._LAYOUT_TEMPLATE_REF_MDNAME,url);},getStaticMarkup:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getStaticMarkup);},_getStaticMarkup:function(dfr,sync){var _10d2="_getStaticMarkup";var _10d3=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_10d3){this.LOGGER.entering(_10d2,[dfr,sync]);}if(this._staticMarkup){if(dfr){dfr.finish(this._staticMarkup,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this._staticMarkup;}var _10d4=null;var _10d5=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._MEDIA_LINK,this.xmlData,this.ns);if(_10d5&&_10d5.length>0){_10d4=_10d5[0].getAttribute("href");}else{if(dfr){dfr.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}var _10d6=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_10d4,this);result={};var _10d7=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_10d6,null,null,true,sync);_10d7.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){result.markup=data;}if(dfr){dfr.finish(result.markup||null,xhr.status);}result.status=xhr.status;}));if(_10d3){this.LOGGER.exiting(_10d2,[result]);}return result.markup;},setStaticMarkup:function(_10d8){if(_10d8&&_10d8!=this._staticMarkup){this._isStaticMarkupDirty=true;this._staticMarkup=_10d8;}},confirmSetStaticMarkup:function(_10d9){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER)||this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},refreshStaticMarkup:function(){this._refreshStaticMarkup=true;this._setDirty();},confirmRefreshStaticMarkup:function(){return true;}});}if(!dojo._hasResource["com.ibm.mm.enabler.content.ContentNodeFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.content.ContentNodeFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.content.ContentNodeFactoryImpl");dojo.provide("com.ibm.mm.enabler.content.ContentNodeFactory");dojo.declare("com.ibm.mm.enabler.content.ContentNodeFactoryImpl",null,{constructor:function(){this.serviceJson=null;this._CONTENT_NODE_TYPE_PAGE="content-page";this._CONTENT_NODE_TYPE_STATIC_PAGE="static-content-page";},_lazyInit:function(){if(this.serviceJson){return;}this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM]));},createContentNode:function(_10da,_10db){var _10dc=null;this._lazyInit();var expr="atom:content/*";var _10dd=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,_10da,this.ns);var type=_10dd?com.ibm.mm.enabler.utils.Dom.getLocalName(_10dd):null;switch(type){case this._CONTENT_NODE_TYPE_PAGE:_10dc=new com.ibm.mm.enabler.content.ContentPageImpl(null,_10db);break;case this._CONTENT_NODE_TYPE_STATIC_PAGE:_10dc=new com.ibm.mm.enabler.content.StaticContentPageImpl(null,_10db);break;default:_10dc=new com.ibm.mm.enabler.content.ContentPageImpl(null,_10db);break;}_10dc.setXml(_10da,true);return _10dc;}});com.ibm.mm.enabler.content.ContentNodeFactory=new com.ibm.mm.enabler.content.ContentNodeFactoryImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.GenericWrapper"]){dojo._hasResource["com.ibm.mm.enabler.GenericWrapper"]=true;dojo.provide("com.ibm.mm.enabler.GenericWrapper");dojo.declare("com.ibm.mm.enabler.GenericWrapper",null,{_target:null,_getTarget:function(){return this._target;},_replaceTarget:function(_10de){this._target=_10de;},constructor:function(_10df,_10e0,_10e1){_10e1=_10e1||com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS;this._target=_10df;for(var key in _10e0){if(dojo.indexOf(_10e1,key)==-1&&dojo.isFunction(_10e0[key])){this[key]=dojo.hitch(this,(function(key){return function(){var _10e2=this._getTarget();return _10e2[key].apply(_10e2,arguments);};})(key));}}}});com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS=["constructor","getInherited","inherited","isInstanceOf"];com.ibm.mm.enabler.GenericWrapper.FILTERED_PROPERTIES=["declaredClass"];}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiableEventWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiableEventWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.ModifiableEventWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.ModifiableEventWrapper",[com.ibm.mm.enabler.GenericWrapper,com.ibm.mashups.enabler.widget.ModifiableEvent],{});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.Primed"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.Primed"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.Primed");dojo.declare("com.ibm.mm.enabler.navigation.priming.Primed",null,{_stopPrimingVars:{},setStopPrimingVars:function(vars){this._stopPrimingVars=vars;},stopPriming:function(key,args){if(key){var _10e3=this.getStopPrimingVar("wrapper");return _10e3[key].apply(_10e3,args);}},getStopPrimingVar:function(name){return this._stopPrimingVars[name]||null;},_initStoppers:function(proto){com.ibm.mm.enabler.utils.Misc.forIn(proto,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)&&!Object.prototype.hasOwnProperty.call(dojo.getObject(this.declaredClass).prototype,key)){this[key]=dojo.hitch(this,(function(key){return function(){return this.stopPriming(key,arguments);};})(key));}},this);}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedModifiableEvent"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedModifiableEvent"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedModifiableEvent");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedModifiableEvent",[com.ibm.mashups.enabler.widget.ModifiableEvent,com.ibm.mm.enabler.navigation.priming.Primed],{_primingCentral:null,_eventProvider:null,_eventName:null,constructor:function(_10e4,_10e5,_10e6){this._primingCentral=_10e4;this._eventProvider=_10e5;this._eventName=_10e6;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this._initStoppers(com.ibm.mashups.enabler.widget.ModifiableEvent.prototype);},stopPriming:function(){},_getEventObj:function(){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this._eventProvider);var ret;if(this._primingCentral._widgets&&this._primingCentral._widgets[id]&&this._primingCentral._widgets[id].events&&this._primingCentral._widgets[id].events[this._eventName]){ret=this._primingCentral._widgets[id].events[this._eventName];}else{throw new Error(this.modelMessages.E_OBJECT_DISPOSED_0);}return ret;},getName:function(){return this._getEventObj().name;},isPublished:function(){return this._getEventObj().isPublished;},isHandled:function(){return this._getEventObj().isHandled;},getPayloadType:function(){return this._getEventObj().payloadType;},getLocales:function(){return this._getEventObj().locales;},getTitle:function(_10e7){return this._getEventObj().titles[_10e7]||null;},getDescription:function(_10e8){return this._getEventObj().descriptions[_10e8]||null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedModifiableEventProvider"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedModifiableEventProvider"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedModifiableEventProvider");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedModifiableEventProvider",[com.ibm.mashups.enabler.widget.ModifiableEventProvider,com.ibm.mm.enabler.navigation.priming.Primed],{primingCentral:null,eventProvider:null,_events:null,constructor:function(args){dojo.mixin(this,args);this._events={};this._initStoppers(com.ibm.mashups.enabler.widget.ModifiableEventProvider.prototype);},stopPriming:function(key,args){this._resetPrimedEvents();this.primingCentral.resetPrimedWidget(this.getStopPrimingVar("widgetId"));return this.inherited(arguments);},_noBubble:false,_resetPrimedEvents:function(){if(this._noBubble){return;}this._noBubble=true;var _10e9=this._events;this._events={};this.stopPriming();var _10ea={};dojo.forEach(com.ibm.mashups.enabler.widget.Factory.getWidgetModel().getHierarchicalEventProvider(this.eventProvider).start().getEvents(),function(event){_10ea[event.getName()]=event;});com.ibm.mm.enabler.utils.Misc.forIn(_10e9,function(event,name){if(name in _10ea){event._replaceTarget(_10ea[name]);}},this);this._noBubble=false;},_createEvent:function(_10eb){if(!(_10eb in this._events)){var _10ec=new com.ibm.mm.enabler.navigation.priming.PrimedModifiableEvent(this.primingCentral,this.eventProvider,_10eb);var event=new com.ibm.mm.enabler.navigation.priming.ModifiableEventWrapper(_10ec,com.ibm.mashups.enabler.widget.ModifiableEvent.prototype,null);var _10ed=_10ec.stopPriming;_10ec.stopPriming=dojo.hitch(this,function(key,args){dojo.hitch(_10ec,_10ed)(key,args);this._resetPrimedEvents();if(key){return event[key].apply(event,args);}});this._events[_10eb]=event;}return this._events[_10eb];},_getEvents:function(){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this.eventProvider);return this.primingCentral._widgets[id].events;},getEvents:function(_10ee){var evts=this._getEvents();var ret=[];com.ibm.mm.enabler.utils.Misc.forIn(evts,function(evt,key){if((_10ee[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]&&evt.isHandled)||(_10ee[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS]&&evt.isPublished)||(!_10ee[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]&&!_10ee[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS])){ret.push(this._createEvent(key));}},this);return ret;},getEvent:function(name){if(name in this._getEvents()){return this._createEvent(name);}return null;},getEventByID:function(id){return this.stopPriming("getEventByID",arguments);}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.Disposable"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.Disposable"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.Disposable");dojo.declare("com.ibm.mm.enabler.navigation.priming.Disposable",null,{dispose:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedModifiablePreferences"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedModifiablePreferences"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedModifiablePreferences");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedModifiablePreferences",[com.ibm.mashups.enabler.widget.ModifiablePreferences,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{primingCentral:null,preferenceProvider:null,constructor:function(args){dojo.mixin(this,args);this._initStoppers(com.ibm.mashups.enabler.widget.ModifiablePreferences.prototype);},stopPriming:function(key,args){this.primingCentral.resetPrimedWidget(this.getStopPrimingVar("widgetId"));return this.inherited(arguments);},_getPreferences:function(){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(this.preferenceProvider);return this.primingCentral._widgets[id].preferences;},getValue:function(name){var vals=this.getValues(name);return vals?vals[0]||null:null;},getValues:function(name){var prefs=this._getPreferences();return prefs&&prefs[name]?prefs[name].values||[]:null;},getNames:function(){var ret=[];com.ibm.mm.enabler.utils.Misc.forIn(this._getPreferences(),function(item,idx){ret.push(idx);});return ret;},isReadOnly:function(name){var prefs=this._getPreferences();return prefs&&prefs[name].readOnly;}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedWire"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedWire"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedWire");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedWire",[com.ibm.mashups.enabler.wire.Wire,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{_wireModel:null,_wireObj:null,constructor:function(_10ef,_10f0){this._wireModel=_10ef;this._wireObj=_10f0;this._initStoppers(com.ibm.mashups.enabler.wire.Wire.prototype);},stopPriming:function(){},dispose:function(){com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.wire.Wire.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)){this[key]=function(){throw "Object has been disposed";};}},this);},getSourceWidget:function(){return new com.ibm.mm.enabler.IdentifierImpl(this._wireObj.sourceWidget);},getTargetWidget:function(){return new com.ibm.mm.enabler.IdentifierImpl(this._wireObj.targetWidget);},getSourceEventName:function(){return this._wireObj.sourceEventName;},getTargetEventName:function(){return this._wireObj.targetEventName;}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedWireModel"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedWireModel"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedWireModel");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedWireModel",[com.ibm.mashups.enabler.wire.WireModel,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{primingCentral:null,layoutModel:null,_primedWires:null,constructor:function(args){dojo.mixin(this,args);this._primedWires=[];this._initStoppers(com.ibm.mashups.enabler.wire.WireModel.prototype);},stopPriming:function(key,args){this.primingCentral.resetPrimedWireModel(this.getStopPrimingVar("id"));return this.inherited(arguments);},dispose:function(){com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.wire.WireModel.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)){this[key]=function(){throw "Object has been disposed";};}},this);dojo.forEach(this._primedWires,function(wire){wire.dispose();});},findByTargetWidget:function(id){id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id);return new com.ibm.mm.enabler.DeferredImpl(this,function(_10f1,sync,id){var ret=dojo.map(this.primingCentral._widgets[id].wires,function(item){var wire=new com.ibm.mm.enabler.navigation.priming.PrimedWire(this,item);this._primedWires.push(wire);return wire;},this);_10f1.finish(ret,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return ret;},id);},findBySourceWidget:function(id){id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id);return new com.ibm.mm.enabler.DeferredImpl(this,function(_10f2,sync,id){var ret=[];com.ibm.mm.enabler.utils.Misc.forIn(this.primingCentral._widgets,function(_10f3,wID){dojo.forEach(_10f3.wires,function(_10f4){if(id==_10f4.sourceWidget){var wire=new com.ibm.mm.enabler.navigation.priming.PrimedWire(this,_10f4);ret.push(wire);this._primedWires.push(wire);}},this);},this);_10f2.finish(ret,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return ret;},id);}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationNode"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationNode"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedNavigationNode");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedNavigationNode",[com.ibm.mashups.enabler.navigation.NavigationNode,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{_navigationNodeObj:null,constructor:function(_10f5){this._navigationNodeObj=_10f5;com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.navigation.NavigationNode.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)&&!Object.prototype.hasOwnProperty.call(dojo.getObject(this.declaredClass).prototype,key)){this[key]=dojo.hitch(this,(function(key){return function(){console.debug("stopPriming call to",key);return this.stopPriming(key,arguments);};})(key));}},this);this._initStoppers(com.ibm.mashups.enabler.navigation.NavigationElement.prototype);this._initStoppers(com.ibm.mashups.enabler.navigation.NavigationNode.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ServerRuntimeContentProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ServerRuntimeContent.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ContentProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ContentPage.prototype);this._initStoppers(com.ibm.mashups.enabler.Transformable.prototype);this._initStoppers(com.ibm.mashups.enabler.ThemeProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.ModifiableLocalized.prototype);this._initStoppers(com.ibm.mashups.enabler.ModifiableMetaData.prototype);},stopPriming:function(){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();if(dojo.isFunction(nm._getTarget().stopPriming)){dojo.hitch(nm,nm._getTarget().stopPriming());}this.getStopPrimingVar("wrapper")._reset();return this.inherited(arguments);},dispose:function(){com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.navigation.NavigationNode.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)){this[key]=function(){throw "Object has been disposed";};}},this);},getID:function(){return this._navigationNodeObj.id;},getTitle:function(_10f6){return this._navigationNodeObj.title;},getLocales:function(){return [this._navigationNodeObj.locale];},getNavigationElementType:function(){return this._navigationNodeObj.type;},getMetaDataNames:function(){var _10f7=[];com.ibm.mm.enabler.utils.Misc.forIn(this._navigationNodeObj.metadata,function(value,name){_10f7.push(name);},this);return _10f7;},getMetaData:function(name){var _10f8=null;if(this._navigationNodeObj.metadata){_10f8=this._navigationNodeObj.metadata[name];}return _10f8||null;},hasRole:function(role){var _10f9=false;var roles=this._navigationNodeObj.roles;if(dojo.isArray(roles)){for(var i=roles.length-1;i>=0;i--){if(role==roles[i]){_10f9=true;break;}}}else{this.stopPriming();_10f9=this.getStopPrimingVar("wrapper").hasRole(role);}return _10f9;},isPrivate:function(){return !!this._navigationNodeObj.isPrivate;},getTheme:function(){return this._navigationNodeObj.theme||null;},getThemeIdentifier:function(){var id=null;var th=this.getTheme();if(th){id=new com.ibm.mm.enabler.IdentifierImpl(th);}return id;},isHidden:function(){var ret1=(this.getMetaData("com.ibm.mashups.navigation.hidden")=="true")?true:false;var ret2=(this.getMetaData("com.ibm.portal.Hidden")=="true")?true:false;return (ret1||ret2);},_getRawID:function(){this.stopPriming();return this.getStopPrimingVar("wrapper")._getRawID();},_setRawID:function(id){this.stopPriming();return this.getStopPrimingVar("wrapper")._setRawID(id);},setID:function(id){this.stopPriming();return this.getStopPrimingVar("wrapper").setID(id);},getServerRuntimeContent:function(){return this.getStopPrimingVar("wrapper");},getServerRuntimeMarkup:function(){this.stopPriming();var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();var page=nm.find(this._navigationNodeObj.id).start();if(page){var _10fa=page.getServerRuntimeContent();return _10fa.getServerRuntimeMarkup();}else{return new com.ibm.mm.enabler.DeferredImpl(this,function(_10fb,sync,_10fc){_10fb.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);return null;});}},primeServerRuntimeContent:function(_10fd){com.ibm.mm.enabler.navigation.priming.PrimingCentral.primeServerRuntimeContent(_10fd);},toString:function(){this.stopPriming();return this.getStopPrimingVar("wrapper").toString();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationLabel_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationLabel_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationLabel_API");dojo.provide("com.ibm.mashups.enabler.navigation.NavigationLabel");dojo.declare("com.ibm.mashups.enabler.navigation.NavigationLabel",[com.ibm.mashups.enabler.navigation.NavigationElement],{});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationLabelImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationLabelImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.NavigationLabelImpl");dojo.declare("com.ibm.mm.enabler.navigation.NavigationLabelImpl",[com.ibm.mashups.enabler.navigation.NavigationLabel,com.ibm.mm.enabler.navigation.NavigationElementImpl],{constructor:function(){this._type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationLabel"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationLabel"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationLabel");}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationURL_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationURL_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationURL_API");dojo.provide("com.ibm.mashups.enabler.navigation.NavigationURL");dojo.declare("com.ibm.mashups.enabler.navigation.NavigationURL",[com.ibm.mashups.enabler.navigation.NavigationElement],{getURL:function(){},setURL:function(url){}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationURLImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationURLImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.NavigationURLImpl");dojo.declare("com.ibm.mm.enabler.navigation.NavigationURLImpl",[com.ibm.mashups.enabler.navigation.NavigationURL,com.ibm.mm.enabler.navigation.NavigationElementImpl],{constructor:function(){this._type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_URL;},getURL:function(){var _10fe=null;var expr="atom:link[@ext:rel='content-url-target' and @rel='related']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns_nav);if(nodes&&nodes.length>0){_10fe=nodes[0].getAttribute("href");}return _10fe||null;},setURL:function(url){var link;var expr="atom:link[@ext:rel='content-url-target' and @rel='related']";var res=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns_nav);if(res&&res.length>0){link=res[0];}else{link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns_nav.atom);this.xmlData.appendChild(link);link.setAttribute("rel","related");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData,link,"ext:rel","rel",this.ns_nav.ext,"content-url-target");}link.setAttribute("href",url);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationURL"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationURL"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationURL");}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationModelIterator"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationModelIterator"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedNavigationModelIterator");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedNavigationModelIterator",[com.ibm.mm.enabler.DeferredIteratorImpl,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{constructor:function(_10ff,nodes){this._parentId=_10ff;this._primedNodes=nodes;this._cursor=0;this._isFullyPrimed=this._primedNodes.length===0?false:com.ibm.mm.enabler.utils.Misc.isEmpty(this._primedNodes[this._primedNodes.length-1]);this._initStoppers(com.ibm.mashups.enabler.Deferred.prototype);this._initStoppers(com.ibm.mashups.enabler.Iterator.prototype);this._initStoppers(com.ibm.mashups.enabler.DeferredIterator.prototype);},stopPriming:function(){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();if(dojo.isFunction(nm._getTarget().stopPriming)){dojo.hitch(nm,nm._getTarget().stopPriming());}var _1100=this.getStopPrimingVar("wrapper")._reset();if(this._foreach_fn){_1100.setForEachCallback(this._foreach_fn,this._foreach_p);}if(this._finished_fn){_1100.setFinishedCallback(this._finished_fn,this._finished_p);}return this.inherited(arguments);},start:function(sync){if(this._primedNodes.length>1&&com.ibm.mm.enabler.utils.Misc.isEmpty(this._primedNodes[0])){this._isFullyPrimed=false;}else{while(this._primedNodes[this._cursor]){var node=this._primedNodes[this._cursor++];if(!com.ibm.mm.enabler.utils.Misc.isEmpty(node)){if(this._foreach_fn){this._foreach_fn(node,this._foreach_p);}}else{if(this._finished_fn){this._finished_fn(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,this._finished_p);}}}}if(!this._isFullyPrimed){this.stopPriming();var _1101=this.getStopPrimingVar("wrapper")._getUnprimedIterator(this._parentId);_1101.setCursorPosition(this._cursor+1);_1101.start(sync);}},hasNext:function(){var _1102;if(this._primedNodes[this._cursor]){_1102=!com.ibm.mm.enabler.utils.Misc.isEmpty(this._primedNodes[this._cursor])?true:false;}else{if(this._isFullyPrimed){_1102=false;}else{this.stopPriming();var _1103=this.getStopPrimingVar("wrapper")._getUnprimedIterator(this._parentId);_1103.setCursorPosition(this._cursor+1);_1102=_1103?_1103.hasNext():false;}}return _1102;},next:function(dfr,sync){var _1104;if(this._primedNodes[this._cursor]){var _1105=this._primedNodes[this._cursor++];_1104=com.ibm.mm.enabler.utils.Misc.isEmpty(_1105)?null:_1105;}else{if(this._isFullyPrimed){_1104=null;}else{this.stopPriming();var _1106=this.getStopPrimingVar("wrapper")._getUnprimedIterator(this._parentId);_1106.setCursorPosition(this._cursor+1);_1104=_1106?_1106.next():null;}}return _1104;},setCursorPosition:function(_1107){this._cursor=_1107;},getCursorPosition:function(){return this._cursor;},size:function(){var _1108;if(this._isFullyPrimed){this._numElements=this._primedNodes.length-1;_1108=new com.ibm.mm.enabler.DeferredImpl(this,this._size);}else{this.stopPriming();var _1109=this.getStopPrimingVar("wrapper")._getUnprimedIterator(this._parentId);_1108=_1109?_1109.size():new com.ibm.mm.enabler.DeferredImpl(this,this._size);}return _1108;},_size:function(dfr,sync){dfr.finish(this._numElements,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return this._numElements;},setFinishedCallback:function(fn,p){this._finished_fn=fn;this._finished_p=p;return this;},setForEachCallback:function(fn,p){this._foreach_fn=fn;this._foreach_p=p;return this;}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationModelIteratorWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationModelIteratorWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.NavigationModelIteratorWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.NavigationModelIteratorWrapper",[com.ibm.mm.enabler.GenericWrapper,com.ibm.mashups.enabler.DeferredIterator],{_parentId:null,_originalFn:{},_replaceFn:["start","hasNext","next","getCursorPosition","setCursorPosition","size","setForEachCallback","setFinishedCallback"],_reset:function(){var _110a=this._getUnprimedIterator(this._parentId);this._replaceTarget(_110a);dojo.extend(com.ibm.mm.enabler.DeferredIteratorImpl,this._originalFn);this._originalFn={};return _110a;},_getUnprimedIterator:function(_110b){if(!this._unprimedIterator){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();var _110c=nm.find(_110b).start();if(_110c&&nm.hasChildren(_110c)===true){this._unprimedIterator=nm.getChildren(_110c);}}return this._unprimedIterator;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.SemaphoreHelperImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.SemaphoreHelperImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.SemaphoreHelperImpl");dojo.declare("com.ibm.mm.enabler.model.SemaphoreHelperImpl",null,{_initSemaphore:function(){this.requestCount=0;},_acquire:function(){this.requestCount++;},_release:function(_110d,_110e){this.statusCode=Math.max(parseInt(_110e,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_110d){_110d.finish(null,this.statusCode);}}}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationModelWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationModelWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.NavigationModelWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.NavigationModelWrapper",[com.ibm.mm.enabler.GenericWrapper,com.ibm.mashups.enabler.model.NavigationModel,com.ibm.mm.enabler.model.SemaphoreHelperImpl],{_originalFn:{},_replaceFn:["find","getRoot","getParent","hasChildren","getChildren","addStrategy","setStrategy"],_reset:function(){var _110f=com.ibm.mm.enabler.navigation.priming.Factory.getUnprimedNavigationModel();this._replaceTarget(_110f);dojo.extend(com.ibm.mm.enabler.model.NavigationModelImpl,this._originalFn);this._originalFn={};}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper",[com.ibm.mm.enabler.GenericWrapper],{_id:null,_unprimedNode:null,_originalFn:{},_getUnprimedNode:function(id){if(!this._unprimedNode){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();this._unprimedNode=nm.find(id).start();}return this._unprimedNode;},_getRawID:function(){return this._getTarget()._getRawID();},_setRawID:function(id){return this._getTarget()._setRawID(id);},setID:function(id){return this._getTarget().setID(id);},toString:function(){return this._getTarget().toString();}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationNodeWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationNodeWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.NavigationNodeWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.NavigationNodeWrapper",[com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper,com.ibm.mashups.enabler.navigation.NavigationNode,com.ibm.mashups.enabler.content.ServerRuntimeContent],{_replaceFn:["getID","getTitle","getLocales","getNavigationElementType","getMetaDataNames","getMetaData","hasRole","isPrivate","getServerRuntimeContent","primeServerRuntimeContent","getServerRuntimeMarkup","isHidden"],_reset:function(){var _1110=this._getUnprimedNode(this._id);this._replaceTarget(_1110);dojo.extend(com.ibm.mm.enabler.navigation.NavigationNodeImpl,this._originalFn);this._originalFn={};},getServerRuntimeMarkup:function(){return this._getTarget().getServerRuntimeMarkup();}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationLabelWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationLabelWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.NavigationLabelWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.NavigationLabelWrapper",[com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper,com.ibm.mashups.enabler.navigation.NavigationLabel],{_replaceFn:["getID","getTitle","getLocales","getNavigationElementType","getMetaDataNames","getMetaData","hasRole","isPrivate","isHidden"],_reset:function(){var _1111=this._getUnprimedNode(this._id);this._replaceTarget(_1111);dojo.extend(com.ibm.mm.enabler.navigation.NavigationLabelImpl,this._originalFn);this._originalFn={};}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationURLWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.NavigationURLWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.NavigationURLWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.NavigationURLWrapper",[com.ibm.mm.enabler.navigation.priming.NavigationElementWrapper,com.ibm.mashups.enabler.navigation.NavigationURL],{_replaceFn:["getID","getTitle","getLocales","getNavigationElementType","getMetaDataNames","getMetaData","hasRole","isPrivate","isHidden"],_reset:function(){var _1112=this._getUnprimedNode(this._id);this._replaceTarget(_1112);dojo.extend(com.ibm.mm.enabler.navigation.NavigationURLImpl,this._originalFn);this._originalFn={};}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationLabel"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationLabel"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedNavigationLabel");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedNavigationLabel",[com.ibm.mashups.enabler.navigation.NavigationLabel,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{_navigationNodeObj:null,constructor:function(_1113){this._navigationNodeObj=_1113;com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.navigation.NavigationLabel.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)&&!Object.prototype.hasOwnProperty.call(dojo.getObject(this.declaredClass).prototype,key)){this[key]=dojo.hitch(this,(function(key){return function(){console.debug("stopPriming call to",key);return this.stopPriming(key,arguments);};})(key));}},this);this._initStoppers(com.ibm.mashups.enabler.navigation.NavigationElement.prototype);this._initStoppers(com.ibm.mashups.enabler.navigation.NavigationLabel.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ServerRuntimeContentProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ServerRuntimeContent.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ContentProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ContentPage.prototype);this._initStoppers(com.ibm.mashups.enabler.Transformable.prototype);this._initStoppers(com.ibm.mashups.enabler.ThemeProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.ModifiableLocalized.prototype);this._initStoppers(com.ibm.mashups.enabler.ModifiableMetaData.prototype);},stopPriming:function(){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();if(dojo.isFunction(nm._getTarget().stopPriming)){dojo.hitch(nm,nm._getTarget().stopPriming());}this.getStopPrimingVar("wrapper")._reset();return this.inherited(arguments);},dispose:function(){com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.navigation.NavigationLabel.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)){this[key]=function(){throw "Object has been disposed";};}},this);},getID:function(){return this._navigationNodeObj.id;},getTitle:function(_1114){return this._navigationNodeObj.title;},getLocales:function(){return [this._navigationNodeObj.locale];},getNavigationElementType:function(){return this._navigationNodeObj.type;},getMetaDataNames:function(){var _1115=[];com.ibm.mm.enabler.utils.Misc.forIn(this._navigationNodeObj.metadata,function(value,name){_1115.push(name);},this);return _1115;},getMetaData:function(name){var _1116=null;if(this._navigationNodeObj.metadata){_1116=this._navigationNodeObj.metadata[name];}return _1116||null;},hasRole:function(role){var _1117=false;var roles=this._navigationNodeObj.roles;if(dojo.isArray(roles)){for(var i=roles.length-1;i>=0;i--){if(role==roles[i]){_1117=true;break;}}}else{this.stopPriming();_1117=this.getStopPrimingVar("wrapper").hasRole(role);}return _1117;},isPrivate:function(){return !!this._navigationNodeObj.isPrivate;},getTheme:function(){return this._navigationNodeObj.theme||null;},getThemeIdentifier:function(){var id=null;var th=this.getTheme();if(th){id=new com.ibm.mm.enabler.IdentifierImpl(th);}return id;},isHidden:function(){var ret1=(this.getMetaData("com.ibm.mashups.navigation.hidden")=="true")?true:false;var ret2=(this.getMetaData("com.ibm.portal.Hidden")=="true")?true:false;return (ret1||ret2);},_getRawID:function(){this.stopPriming();return this.getStopPrimingVar("wrapper")._getRawID();},_setRawID:function(id){this.stopPriming();return this.getStopPrimingVar("wrapper")._setRawID(id);},setID:function(id){this.stopPriming();return this.getStopPrimingVar("wrapper").setID(id);},toString:function(){this.stopPriming();return this.getStopPrimingVar("wrapper").toString();}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationURL"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationURL"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedNavigationURL");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedNavigationURL",[com.ibm.mashups.enabler.navigation.NavigationURL,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{_navigationNodeObj:null,constructor:function(_1118){this._navigationNodeObj=_1118;com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.navigation.NavigationURL.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)&&!Object.prototype.hasOwnProperty.call(dojo.getObject(this.declaredClass).prototype,key)){this[key]=dojo.hitch(this,(function(key){return function(){console.debug("stopPriming call to",key);return this.stopPriming(key,arguments);};})(key));}},this);this._initStoppers(com.ibm.mashups.enabler.navigation.NavigationElement.prototype);this._initStoppers(com.ibm.mashups.enabler.navigation.NavigationURL.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ServerRuntimeContentProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ServerRuntimeContent.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ContentProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.content.ContentPage.prototype);this._initStoppers(com.ibm.mashups.enabler.Transformable.prototype);this._initStoppers(com.ibm.mashups.enabler.ThemeProvider.prototype);this._initStoppers(com.ibm.mashups.enabler.ModifiableLocalized.prototype);this._initStoppers(com.ibm.mashups.enabler.ModifiableMetaData.prototype);},stopPriming:function(){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();if(dojo.isFunction(nm._getTarget().stopPriming)){dojo.hitch(nm,nm._getTarget().stopPriming());}this.getStopPrimingVar("wrapper")._reset();return this.inherited(arguments);},dispose:function(){com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.navigation.NavigationURL.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)){this[key]=function(){throw "Object has been disposed";};}},this);},getID:function(){return this._navigationNodeObj.id;},getTitle:function(_1119){return this._navigationNodeObj.title;},getLocales:function(){return [this._navigationNodeObj.locale];},getNavigationElementType:function(){return this._navigationNodeObj.type;},getMetaDataNames:function(){var _111a=[];com.ibm.mm.enabler.utils.Misc.forIn(this._navigationNodeObj.metadata,function(value,name){_111a.push(name);},this);return _111a;},getMetaData:function(name){var _111b=null;if(this._navigationNodeObj.metadata){_111b=this._navigationNodeObj.metadata[name];}return _111b||null;},hasRole:function(role){var _111c=false;var roles=this._navigationNodeObj.roles;if(dojo.isArray(roles)){for(var i=roles.length-1;i>=0;i--){if(role==roles[i]){_111c=true;break;}}}else{this.stopPriming();_111c=this.getStopPrimingVar("wrapper").hasRole(role);}return _111c;},isPrivate:function(){return !!this._navigationNodeObj.isPrivate;},getTheme:function(){return this._navigationNodeObj.theme||null;},getThemeIdentifier:function(){var id=null;var th=this.getTheme();if(th){id=new com.ibm.mm.enabler.IdentifierImpl(th);}return id;},isHidden:function(){var ret1=(this.getMetaData("com.ibm.mashups.navigation.hidden")=="true")?true:false;var ret2=(this.getMetaData("com.ibm.portal.Hidden")=="true")?true:false;return (ret1||ret2);},_getRawID:function(){this.stopPriming();return this.getStopPrimingVar("wrapper")._getRawID();},_setRawID:function(id){this.stopPriming();return this.getStopPrimingVar("wrapper")._setRawID(id);},setID:function(id){this.stopPriming();return this.getStopPrimingVar("wrapper").setID(id);},toString:function(){this.stopPriming();return this.getStopPrimingVar("wrapper").toString();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.Constants"]){dojo._hasResource["com.ibm.mashups.enabler.model.Constants"]=true;dojo.provide("com.ibm.mashups.enabler.model.Constants");dojo.declare("com.ibm.mashups.enabler.model.Constants",null,{constructor:function(){this.SCHEME_SEPARATOR=":";this.CLIENT_ID_SCHEME="cid";this.CLIENT_ID_PREFIX=this.CLIENT_ID_SCHEME+this.SCHEME_SEPARATOR;}});com.ibm.mashups.enabler.model.Constants=new com.ibm.mashups.enabler.model.Constants();}if(!dojo._hasResource["com.ibm.mm.enabler.model.Utils"]){dojo._hasResource["com.ibm.mm.enabler.model.Utils"]=true;dojo.provide("com.ibm.mm.enabler.model.Utils");com.ibm.mm.enabler.model.Utils={LOG_LEVEL:com.ibm.mashups.enabler.logging.LogLevel.TRACE,LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.model.Utils"),isClientNode:function(node){return (node&&node._getRawID().indexOf(com.ibm.mashups.enabler.model.Constants.CLIENT_ID_PREFIX)===0);}};}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationModelIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationModelIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.NavigationModelIteratorImpl");dojo.declare("com.ibm.mm.enabler.navigation.NavigationModelIteratorImpl",[com.ibm.mm.enabler.ModelIteratorImpl],{constructor:function(){this.THR_INREPLYTO="thr:in-reply-to/@ext:uri";},_createNode:function(_111d){var _111e=com.ibm.mashups.enabler.xml.XPath.evaluateString(this.THR_INREPLYTO,_111d,this.model.ns);var node=null;if(_111e&&_111e.indexOf(this.parentId)!=-1){node=com.ibm.mm.enabler.navigation.NavigationNodeFactory.createNavigationNode(_111d);if(node.getID()==this.parentId){return null;}node=this.model._cacheNode(node);}return node||null;},_customizeUrl:function(url){url.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);url.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_COMPOSITE_APPLICATION);url.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this.model._applyHiddenMetaDataLoadingStrategyToModelURL(url);}});}if(!dojo._hasResource["com.ibm.mm.enabler.EmptyModelIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.EmptyModelIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.EmptyModelIteratorImpl");dojo.declare("com.ibm.mm.enabler.EmptyModelIteratorImpl",[com.ibm.mm.enabler.DeferredIteratorImpl],{constructor:function(){},start:function(){this.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);},hasNext:function(dfr){if(dfr){dfr.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return false;},next:function(dfr){if(dfr){dfr.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return null;},setCursorPosition:function(){},getCursorPosition:function(){return 0;},size:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._size);},_size:function(dfr,sync){if(dfr){dfr.finish(0,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return 0;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.theme.Theme"]){dojo._hasResource["com.ibm.mashups.enabler.theme.Theme"]=true;dojo.provide("com.ibm.mashups.enabler.theme.Theme");dojo.declare("com.ibm.mashups.enabler.theme.Theme",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.Localized,com.ibm.mashups.enabler.MetaData],{getBaseUrl:function(){},getDefaultSkin:function(){},getDefaultSkinIdentifier:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.ThemeModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.ThemeModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.ThemeModel_API");dojo.provide("com.ibm.mashups.enabler.model.ThemeModel");dojo.declare("com.ibm.mashups.enabler.model.ThemeModel",[com.ibm.mashups.enabler.ListModel,com.ibm.mashups.enabler.ResourceLocator],{getSkinModel:function(theme){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.EmptySkinModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.EmptySkinModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.EmptySkinModelImpl");dojo.declare("com.ibm.mm.enabler.model.EmptySkinModelImpl",[com.ibm.mashups.enabler.model.SkinModel,com.ibm.mm.enabler.model.ModelImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},iterator:function(){return new com.ibm.mm.enabler.EmptyModelIteratorImpl();},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,uri);},_find:function(dfr,sync,uri){if(dfr){dfr.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}});}if(!dojo._hasResource["com.ibm.mm.enabler.theme.ThemeImpl"]){dojo._hasResource["com.ibm.mm.enabler.theme.ThemeImpl"]=true;dojo.provide("com.ibm.mm.enabler.theme.ThemeImpl");dojo.declare("com.ibm.mm.enabler.theme.ThemeImpl",[com.ibm.mashups.enabler.theme.Theme,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.MetaDataImpl2],{constructor:function(node){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.xmlData=node;var _111f=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_THEME);this.prefix=_111f.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_111f.namespaces,nsf.getNameSpaces([nsf.NS_ATOM]));},getBaseUrl:function(_1120){if(typeof _1120=="undefined"){var _1121="getBaseUrl";this.LOGGER.warning(_1121,"Deprecated. Use com.ibm.mashups.enabler.model.ThemeModel.findResourceURL instead.");}return this._getBaseUrl();},_getBaseUrl:function(){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:content/model:theme/model:link[@ext:rel='baseUrl']",this.xmlData,this.ns);return (nodes&&nodes.length>0)?nodes[0].getAttribute("href"):null;},getDefaultSkin:function(){var id=this.getDefaultSkinIdentifier();return id?id.getID():null;},getDefaultSkinIdentifier:function(){var _1122=null;var expr="atom:link[@rel='related' and @ext:rel='defaultSkin']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(nodes&&nodes.length>0){var id=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,nodes[0]);var href=nodes[0].getAttribute("href");_1122=new com.ibm.mm.enabler.IdentifierImpl(id,{"href":href});}return _1122||null;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mm.enabler.theme.ThemeModelIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.theme.ThemeModelIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.theme.ThemeModelIteratorImpl");dojo.declare("com.ibm.mm.enabler.theme.ThemeModelIteratorImpl",[com.ibm.mashups.enabler.Iterator,com.ibm.mm.enabler.DeferredIteratorImpl,com.ibm.mm.enabler.ModelIteratorImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},_createNode:function(_1123){var node=new com.ibm.mm.enabler.theme.ThemeImpl(_1123);this.model.loadedNodes[node.getID()]=node;return node;},_customizeUrl:function(url){url.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);url.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this.model._applyHiddenMetaDataLoadingStrategyToModelURL(url);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.ThemeModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.ThemeModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.ThemeModelImpl");dojo.declare("com.ibm.mm.enabler.model.ThemeModelImpl",[com.ibm.mashups.enabler.model.ThemeModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.loadedNodes={};this.skinModels={};var _1124=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_THEME);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_1124.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH]));this.collectionUrl=_1124.url;},getInstance:function(){var _1125=com.ibm.mm.enabler.model.ThemeModelImpl._instance;return _1125?_1125:(com.ibm.mm.enabler.model.ThemeModelImpl._instance=new com.ibm.mm.enabler.model.ThemeModelImpl());},iterator:function(){return new com.ibm.mm.enabler.theme.ThemeModelIteratorImpl(this.collectionUrl,this);},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._load,uri);},getSkinModel:function(theme){var _1126=theme.getID();if(!(_1126 in this.skinModels)){var href;var expr="atom:link[@ext:rel='skin']";var skins=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,theme.xmlData,this.ns);if(skins&&skins.length>0){href=skins[0].getAttribute("href");this.skinModels[_1126]=new com.ibm.mm.enabler.model.SkinModelImpl(href,_1126);}if(!href){return new com.ibm.mm.enabler.model.EmptySkinModelImpl();}}return this.skinModels[_1126];},_load:function(_1127,sync,ident){var _1128="_load";var _1129=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1129){this.LOGGER.entering(_1128,arguments);}var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(ident);if(id in this.loadedNodes){if(_1127){_1127.finish(this.loadedNodes[id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}else{var myUrl;var href=com.ibm.mm.enabler.utils.Utils.getHrefFromIdentifiable(ident);if(href){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(href,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_URL,this);myUrl.setNodes([{value:id,isID:true}]);}myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this._applyHiddenMetaDataLoadingStrategyToModelURL(myUrl);var _112a=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_112a.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes&&nodes.length>0){this.loadedNodes[id]=new com.ibm.mm.enabler.theme.ThemeImpl(nodes[0]);}}if(_1127){_1127.finish(this.loadedNodes[id]||null,xhr.status);}}));}if(_1129){this.LOGGER.exiting(_1128);}return this.loadedNodes[id]||null;},findResourceUrl:function(node,name){return this.findResourceURL(node,name);},findResourceURL:function(node,name){var url;var _112b=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ext:rel='media']",node.xmlData,node.ns);if(_112b&&_112b.length>0){var href=_112b[0].getAttribute("href");if(href){if(href.lastIndexOf(name)==(href.length-name.length)){url=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(href,this);}}}if(!url){url=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_MEDIA_URL,this);var _112c=[{value:node.getID(),isID:true},{value:name,isID:false}];url.setNodes(_112c);}return url.getAbsoluteURL();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.ThemeModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.ThemeModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.ThemeModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.theme.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.theme.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.theme.Factory_API");dojo.provide("com.ibm.mashups.enabler.theme.Factory");dojo.declare("com.ibm.mashups.enabler.theme.Factory",null,{getThemeModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.theme.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.theme.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.theme.FactoryImpl");dojo.declare("com.ibm.mm.enabler.theme.FactoryImpl",com.ibm.mashups.enabler.theme.Factory,{getThemeModel:function(){return com.ibm.mm.enabler.model.ThemeModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.theme.Factory=new com.ibm.mm.enabler.theme.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.theme.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.theme.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.theme.Factory");}if(!dojo._hasResource["com.ibm.mm.enabler.strategy.PageLoadAheadStrategyExecutor"]){dojo._hasResource["com.ibm.mm.enabler.strategy.PageLoadAheadStrategyExecutor"]=true;dojo.provide("com.ibm.mm.enabler.strategy.PageLoadAheadStrategyExecutor");dojo.declare("com.ibm.mm.enabler.strategy.PageLoadAheadStrategyExecutor",null,{constructor:function(_112d){this.strategies=_112d;this.loadAheadUser=false;this.loadAheadCatalogCategoryModel=false;this.loadAheadLayoutModel=false;this.userLoadAheadStrategy=null;this.pageLoadAheadStrategy=null;this.catalogCategoryLoadAheadStrategy=null;for(var x in this.strategies){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.strategies[x],com.ibm.mashups.enabler.strategy.UserLoadAheadStrategy)){this.loadAheadUser=this.strategies[x].isLoadAheadUser();this.userLoadAheadStrategy=this.strategies[x];}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.strategies[x],com.ibm.mashups.enabler.strategy.CatalogCategoryLoadAheadStrategy)){}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.strategies[x],com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy)){var _112e=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _112f=_112e.getValue(com.ibm.mashups.enabler.services.ConfigConstants.PAGE_LOAD_OPTIMIZATION);if(_112f===true){this.loadAheadLayoutModel=this.strategies[x].isLoadAheadLayoutModel();}var _1130=_112e.getValue(com.ibm.mashups.enabler.services.ConfigConstants.PAGE_LOAD_OPTIMIZATION_THEME);if(_112f===true){this.loadAheadTheme=this.strategies[x].isLoadAheadTheme();}else{this.loadAheadTheme=false;}this.pageLoadAheadStrategy=_112d[x];}}}}this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.prefix=this.serviceJson.idprefix;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH]));},processLoadAhead:function(_1131,_1132,sync){if(!com.ibm.mashups.enabler.io.XHRMultipartFactory.isMultipartEnabled()){return;}var _1133=com.ibm.mashups.enabler.io.XHRMultipartFactory.create();_1133.startTransaction();if(_1131.length>0){var _1134="atom:link[@rel='edit']";var _1135=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_1134,_1131[0].xmlData,this.ns);if(_1135&&_1135.length>0){var _1136=_1135[0].getAttribute("href");var h_url=new com.ibm.mm.enabler.utils.HttpUrl(_1136);_1133.statics.digest=h_url.getParameter("digest");}}if(this.loadAheadUser){var _1137=this.userLoadAheadStrategy.getUserModel();_1137.findCurrentUser().start();}if(this.loadAheadCatalogCategoryModel){var _1138=this.catalogCategoryLoadAheadStrategy.getCatalogCategoryModel();var _1139=_1138.getRoot().start();var iter=_1138.getChildren(_1139);iter.hasNext();}for(var i=0;i<_1131.length;i++){if(this.loadAheadLayoutModel){_1131[i].getContent().start(false);}if(this.loadAheadTheme){var _113a=_1131[i].getTheme();if(_113a!==null){var _113b=com.ibm.mashups.enabler.theme.Factory.getThemeModel();_113b.find(_113a).start();}com.ibm.mm.builder.utils.skinUtil.getAllSkins();}}if(this.loadAheadLayoutModel){for(var j in _1132){var _113c=_1132[j];_113c.getRoot().start(false);}}_1133.endTransactionDeferred().start();}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.NavigationModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.NavigationModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.NavigationModelImpl");dojo.declare("com.ibm.mm.enabler.model.NavigationModelImpl",[com.ibm.mashups.enabler.model.NavigationModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl,com.ibm.mm.enabler.model.SemaphoreHelperImpl,com.ibm.mm.enabler.ServiceDocConsumer],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.root=null;this.loadedNodes={};this.createdNodes={};this.deletedNodes={};this.initialContents={};this.layoutModels={};this.cid=0;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.urlType=com.ibm.mashups.enabler.model.url.ModelUrlFactory.NAVIGATION_URL;this.enforcementHelper=com.ibm.mm.enabler.utils.APIEnforcementHelper;this.VALID_LAYOUTS={"page":true,"staticpage":true};this._CONTENT_NODE_LINK="atom:link[@rel='related' and @ext:class='content-node']";this._MEDIA_LINK="atom:link[@ext:rel='media']";this._NEXT_LINK="atom:link[@rel='next']";this._LAYOUT_TEMPLATE_REF_MDNAME="com.ibm.portal.layout.template.ref";},_initServiceDoc:function(){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);this.entryUrl=this.serviceJson.url;this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH,nsf.NS_XHTML,nsf.NS_APP]));this.fragmentServiceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);this.fragmentPrefix=this.serviceJson.idprefix;var _113d=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_SPACE_NAVIGATION);this.spaceNavigationEntryUrl=_113d.url;this.inherited("_initServiceDoc",arguments);},_getInstance:function(){var _113e=com.ibm.mm.enabler.model.NavigationModelImpl._instance;return _113e?_113e:(com.ibm.mm.enabler.model.NavigationModelImpl._instance=new com.ibm.mm.enabler.model.NavigationModelImpl());},find:function(uri){this.enforcementHelper.enforceDefinedNotNull(uri,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["id",this.declaredClass,"find(id)"]));return new com.ibm.mm.enabler.DeferredImpl(this,this._find,uri);},findDefaultAcceptParent:function(){return this.getRoot();},getRoot:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getRoot);},_getRoot:function(dfr,sync){if(this.root===null){this.root=this._find(dfr,sync,"collection");}else{if(dfr){dfr.finish(this.root,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}return this.root;},hasChildren:function(node){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"hasChildren(node)"]));return this._getChildrenLink(node)?true:false;},getChildren:function(node){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"getChildren(node)"]));var href=this._getChildrenLink(node);return new com.ibm.mm.enabler.navigation.NavigationModelIteratorImpl(href,this,node.getID());},_getChildrenLink:function(node){node=this._resolve(node);this._initServiceDoc();var expr="atom:link[@rel='replies']/@href";return com.ibm.mashups.enabler.xml.XPath.evaluateString(expr,node.getXml(),this.ns);},_resolve:function(node){if(!node){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var id=(typeof (node)=="string")?node:node.getID();this._find(null,true,id);return this.loadedNodes[id]||null;},getParent:function(uri){this.enforcementHelper.enforceDefinedNotNull(uri,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"getParent(node)"]));return new com.ibm.mm.enabler.DeferredImpl(this,this._getParent,uri);},_getParent:function(dfr,sync,node){this._initServiceDoc();node=this._resolve(node);var _113f;if(node!==null){var refs=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("thr:in-reply-to[@ext:uri]",node.getXml(),this.ns);if(refs&&refs.length>0){var _1140=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,refs[0]);_113f=this._find(dfr,sync,_1140,true);}else{if(dfr){dfr.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}}}return _113f||null;},_setParent:function(node,_1141,_1142){if(node!==null&&_1141!==null){this._initServiceDoc();var _1143=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(_1142,this);_1143.setNodes([{value:_1141.getID(),isID:true}]);var thr=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("thr:in-reply-to",node.getXml(),this.ns);if(!thr||thr.length===0){thr=com.ibm.mm.enabler.utils.Utils.createNode("thr:in-reply-to",this.ns.thr);node.getXml().appendChild(thr);}else{thr=thr[0];}com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.getXml().ownerDocument,thr,"ext:uri","uri",this.ns.ext,_1143.getModelURI());thr.setAttribute("ref",_1143.getModelURI());thr.setAttribute("href",_1143.getAbsoluteURL());}},_setNext:function(node,_1144){if(node){this._initServiceDoc();var next=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._NEXT_LINK,node.getXml(),this.ns);var _1145=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);if(next&&next.length>0){if(_1144){_1145.setNodes([{value:_1144.getID(),isID:true}]);next[0].setAttribute("href","?uri="+_1145.getModelURI());com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.getXml().ownerDocument,next[0],"ext:uri","uri",this.ns.ext,_1145.getModelURI());}else{next[0].parentNode.removeChild(next[0]);}}else{if(_1144){_1145.setNodes([{value:_1144.getID(),isID:true}]);next=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",this.ns.atom);next.setAttribute("href","?uri="+_1145.getModelURI());next.setAttribute("rel","next");next.setAttribute("type","application/atom+xml");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.getXml().ownerDocument,next,"ext:uri","uri",this.ns.ext,_1145.getModelURI());node.getXml().appendChild(next);}}}},insert:function(node,_1146,_1147){this._initServiceDoc();this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"insert(node, parentNode, nextNode)"]));var _1148="insert";var _1149=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1149){this.LOGGER.entering(_1148,[node,_1146,_1147]);}var _114a,prev,_114b,_114c,clean;var _114d=_1146?_1146.getID():null;var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.createdNodes[id]=null;}else{var _114e=this.getParent(node.getID()).start();if(_114e!==null){_114a=this.getChildren(_114e);prev=null;while(_114a.hasNext()){_114b=_114a.next();if(_114b.getID()==id&&prev!==null){this._setNext(prev,_114a.hasNext()?_114a.next():null);this.initialContents[prev.getID()]=prev.toString();break;}if(!prev&&_114b.getID()==id&&!_114a.hasNext()&&_114e.getID()!=_114d){_114c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@rel='replies']",_114e.getXml(),this.ns);if(_114c&&_114c.length>0){clean=this.initialContents[_1146.getID()]==_1146.toString()?true:false;var _114f=_114c[0].parentNode;_114f.removeChild(_114c[0]);if(clean){this.initialContents[_1146.getID()]=_1146.toString();}}}prev=_114b;}}}if(_1146){_114a=this.getChildren(_1146);prev=null;var _1150=_1147?_1147.getID():null;while(_114a.hasNext()){_114b=_114a.next();if(_114b.getID()==_1150){break;}prev=_114b;}if(prev){this._setNext(prev,node);this.initialContents[prev.getID()]=prev.toString();}_114c=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:link[@rel='replies']",_1146.getXml(),this.ns);if(!_114c){clean=this.initialContents[_1146.getID()]==_1146.toString()?true:false;var _1151=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_1151.setNodes([{value:_1146.getID(),isID:true}]);_1151.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_LEVELS,"2");_1151.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);var _1152=_1146.getXml().ownerDocument;_114c=com.ibm.mm.enabler.utils.Dom.createElement(_1152,"atom:link",this.ns.atom);_114c.setAttribute("href",_1151.getAbsoluteURL());_114c.setAttribute("rel","replies");_114c.setAttribute("type","application/atom+xml");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(node.getXml().ownerDocument,_114c,"ext:uri","uri",this.ns.ext,_1151.getModelURI());_1146.getXml().appendChild(_114c);if(clean){this.initialContents[_1146.getID()]=_1146.toString();}}}if(this.createdNodes[id]===null&&this._is25()){var _1153=node.getContent().start();var links=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this._CONTENT_NODE_LINK,_1146.getXml(),this.ns);var _114d;if(links){var uri=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(links,"ext:uri","uri",this.ns.ext);if(uri){_114d=new com.ibm.mm.enabler.IdentifierImpl(uri);}}this._setParent(_1153,_114d||_1146,com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL);}this._setParent(node,_1146,this.urlType);this._setNext(node,_1147);if(_1149){this.LOGGER.exiting(_1148);}},confirmInsert:function(node,_1154,_1155){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"confirmInsert(node, parentNode, nextNode)"]));this.enforcementHelper.enforceDefinedNotNull(_1154,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["parentNode",this.declaredClass,"confirmInsert(node, parentNode, nextNode)"]));if(node===null||typeof node=="undefined"){console.warn("TEMPORARY FIX: Gracefully returning 'true' on NavigationModel.confirmInsert(node) with null or undefined node.");return true;}if(node){var _1156=false;if(com.ibm.mm.enabler.model.Utils.isClientNode(node)){if(_1154){if(_1154.isPrivate()){return node.isPrivate();}else{return _1154.hasRole(node.isPrivate()?com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER:com.ibm.mashups.enabler.ac.RoleType.EDITOR);}}else{return false;}}else{var _1157=this.getParent(node.getID()).start();if(_1157){if(_1157.getID()!=_1154.getID()){_1156=true;}}if(_1156){return this.getConfirmReparent(node,_1157,_1154,_1155);}else{return this.getConfirmReorder(node,_1154,_1155);}}}},confirmExport:function(node){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["page",this.declaredClass,"confirmExport(page)"]));return (com.ibm.mm.enabler.AnonymousHelper.getAnonymousMode()==com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS)?false:true;},remove:function(node){this._initServiceDoc();this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"remove(node)"]));var _1158="remove";var _1159=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1159){this.LOGGER.entering(_1158,[node]);}var page=this._resolve(node);var id=page.getID();var clean=(page.toString()==this.initialContents[id])?true:false;var _115a=this.getParent(id).start();if(_115a){var _115b=this.getChildren(_115a);if(_115b&&_115b.size().start()==1){var _115c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@rel='replies']",_115a.getXml(),this.ns);if(_115c&&_115c.length>0){var _115d=_115c[0].parentNode;_115d.removeChild(_115c[0]);if(clean){this.initialContents[id]=page.toString();}}}}this.deletedNodes[id]=this.loadedNodes[id];this._removeCacheNode(id);if(_1159){this.LOGGER.exiting(_1158);}},confirmRemove:function(node){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["node",this.declaredClass,"confirmRemove(node)"]));if(!com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.Identifiable)){node=this.find(node).start(true);}return this.getConfirmRemove(node);},hasLayoutModel:function(node){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["page",this.declaredClass,"hasLayoutModel(page)"]));return this._is25()?this._25hasLayoutModel(node):this._pre25hasLayoutModel(node);},_25hasLayoutModel:function(node){var page=this._resolve(node);if(page){this._initServiceDoc();var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._getLayoutModelExpr(),page.getXml(),this.ns);if(nodes&&nodes.length>0){return true;}}return false;},_pre25hasLayoutModel:function(node){var page=this._resolve(node);var href=null;if(page){this._initServiceDoc();var expr=this._getLayoutModelExpr();var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,page.getXml(),this.ns);if(nodes&&nodes.length>0){var rel=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(nodes[0],"ext:rel","rel",this.ns.ext);if(rel in this.VALID_LAYOUTS){href=nodes[0].getAttribute("href");}}}return href?true:false;},_getLayoutModelExpr:function(){return this._is25()?"atom:link[@rel='related' and @ext:rel='layout']":"atom:link[@rel='related' and @ext:class='content-node']";},getLayoutModel:function(node){this.enforcementHelper.enforceDefinedNotNull(node,dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["page",this.declaredClass,"hasLayoutModel(page)"]));this._initServiceDoc();if(this._is25()&&!this.hasLayoutModel(node)){return null;}var _115e=(typeof (node)=="string")?node:node.getID();if(!(_115e in this.layoutModels)){var nNode=this._find(null,true,_115e);var href=null;var _115f=_115e;if(this.loadedNodes[_115e]){var expr=this._getLayoutModelExpr();var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.loadedNodes[_115e].getXml(),this.ns);if(nodes&&nodes.length>0){href=nodes[0].getAttribute("href");var _1160=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,nodes[0]);if(_1160){_115f=_1160;}}}this.layoutModels[_115e]=new com.ibm.mm.enabler.model.LayoutModelImpl(href,_115f,this,nNode);if(com.ibm.mashups.enabler.io.XHRMultipartFactory.isMultipartEnabled()&&(this.strategy!==null)&&(this.loadedNodes[_115e])&&(!this.loadedNodes[_115e]._fragmentData)){var _1161=new com.ibm.mm.enabler.strategy.PageLoadAheadStrategyExecutor(this.strategy);_1161.processLoadAhead([this.loadedNodes[_115e]],[this.layoutModels[_115e]],false);}}return this.layoutModels[_115e];},_postContentNode:function(_1162){var _1163="_postContentNode";var sync=true;var _1164=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this._initServiceDoc();var _1165=this.LOGGER.isLoggable(this.LOG_LEVEL);var _1166=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);var _1167=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1166.url,this);if(_1162._refreshStaticMarkup){_1167.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MODE,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MODE_VALUE_REFRESH);}_1167.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);var _1168=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_1167,null,null,false,sync);_1168.create(_1162.toString(),dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){if(data!==null){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(nodes&&nodes.length>0){_1162.xmlData=nodes[0];_1162._setClean();_1162._refreshStaticMarkup=false;}}}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){_1164=xhr.status;if(_1165){this.LOGGER.warning(_1163,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}}}));if(_1164==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){if(_1162._staticMarkup){var _1169=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._MEDIA_LINK,_1162.getXml(),this.ns);if(_1169&&_1169.length>0){var _116a=_1169[0].getAttribute("href");var _116b=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_116a,this);var _116c=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_116b,null,null,true,sync);_116c.create(_1162._staticMarkup,dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){_1162._staticMarkup=data;_1162._isStaticMarkupDirty=false;}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_1165){this.LOGGER.warning(_1163,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}}}));}}}return _1164;},_putContentNode:function(_116d){var _116e="_putContentNode";var sync=true;this._initServiceDoc();var _116f=this.LOGGER.isLoggable(this.LOG_LEVEL);var url=_116d.getEditLink();var _1170=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(url,this);if(_116d._refreshStaticMarkup){_1170.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MODE,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MODE_VALUE_REFRESH);}_1170.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);_1170.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_UPDATE,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_UPDATE_VALUE_REPLACE);_1170.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MDNAME,this._LAYOUT_TEMPLATE_REF_MDNAME);var _1171=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:link[@ext:rel='theme']",_116d.getXml(),_116d.ns);if(_1171){dojo.destroy(_1171);}var _1172=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_1170,null,null,false,sync);_1172.update(_116d.toString(),dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){if(data!==null){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(nodes&&nodes.length>0){_116d.xmlData=nodes[0];_116d._setClean();_116d._refreshStaticMarkup=false;}}}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_116f){this.LOGGER.warning(_116e,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}}}));if(_116d._staticMarkup&&_116d._isStaticMarkupDirty){var _1173=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._MEDIA_LINK,_116d.getXml(),this.ns);if(_1173&&_1173.length>0){var _1174=_1173[0].getAttribute("href");var _1175=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1174,this);var _1176=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_1175,null,null,true,sync);_1176.update(_116d._staticMarkup,dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){_116d._staticMarkup=data;_116d._isStaticMarkupDirty=false;}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_116f){this.LOGGER.warning(_116e,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}}}));}}},create:function(_1177){this._initServiceDoc();var entry=com.ibm.mm.enabler.utils.Atom.createEntry(null,"model:navigation-node",this.ns.model).entryElement;var node;var type=(_1177&&_1177.type)?_1177.type:com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE;switch(type){case com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE:if(_1177&&_1177.template){entry=_1177.template.getXml().cloneNode(true);var _1178=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("thr:in-reply-to",entry,this.ns);if(_1178){_1178.parentNode.removeChild(_1178);}}node=new com.ibm.mm.enabler.navigation.NavigationNodeImpl(entry);break;case com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL:node=new com.ibm.mm.enabler.navigation.NavigationLabelImpl(entry);break;case com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_URL:node=new com.ibm.mm.enabler.navigation.NavigationURLImpl(entry);break;default:throw new Error(this.modelMessages.E_INVALID_CONTEXT_SPECIFIED_0);}if(node){var cid=com.ibm.mashups.enabler.model.Constants.CLIENT_ID_PREFIX+((_1177&&_1177.cid)?_1177.cid:this.cid++);node._setRawID(cid);node._setRole(com.ibm.mashups.enabler.ac.RoleType.USER);node._setRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);node._setRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);node._setRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER);node._setUserOwned(true);node._setDirty();}return node||null;},confirmCreate:function(_1179){return this.getConfirmCreate();},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_117a,sync){this._initServiceDoc();var _117b="_commit";var _117c=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_117c){this.LOGGER.entering(_117b,[_117a,sync]);}sync=true;this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this._initSemaphore();this._acquire();var id,_117d,myUrl,expr,entry,page,_117e,_117f,edit;var _1180=[];var _1181=[];var _1182={};var _1183={};com.ibm.mm.enabler.utils.Misc.forIn(this.loadedNodes,function(node,id){if(id in this.createdNodes){_1180.push(id);var _1184=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(this._NEXT_LINK,node.getXml(),this.ns);if(_1184){var _1185=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,_1184);if(this.createdNodes[_1185]===null){_1183[id]=_1185;_1184.parentNode.removeChild(_1184);}}}else{var _1186=this.loadedNodes[id]._contentNode;var r1=new RegExp(" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"","g");var r2=new RegExp(" xmlns:portal=\"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model\"","g");var _1187=this.initialContents[id].replace(r1,"").replace(r2,"");var _1188=this.loadedNodes[id].toString().replace(r1,"").replace(r2,"");if((_1187!==_1188)||(_1186&&(_1186._isDirty()||_1186._isStaticMarkupDirty))){_1181.push(id);}}},this);var _1189=[];dojo.forEach(_1180,function(id){var _118a=_1183[id];if(_118a){var index=dojo.indexOf(_1189,_118a);_1189.splice(index==-1?0:index,0,id);}else{_1189.push(id);}},this);var _118b={};_118b.code=parseInt(com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK,10);dojo.forEach(_1189,function(id){expr="atom:link[@ext:class='content-node']";var _118c=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,this.loadedNodes[id].getXml(),this.ns);var _118d=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;page=this.loadedNodes[id];var _118e=this.getParent(page).start();if(!_118c){_117e=null;if(this._is25()){_117e=page.getContent().start();_118d=this._postContentNode(_117e);}else{var lm=this.layoutModels[id];if(!lm){lm=new com.ibm.mm.enabler.model.LayoutModelImpl();var root=lm.create();lm.insert(root);root.setFragment(" ");root.setID(this.loadedNodes[id].getID());}lm._commit(_117a,true,this);_117e=lm.getRoot().start(true);}if(_118d==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){var _118f=_117e.getEditLink();var _1190="";expr="atom:id";var ids=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_117e.getXml(),this.ns);if(ids&&ids.length>0){_1190=com.ibm.mm.enabler.utils.Dom.textContent(ids[0]);}var _1191=this.loadedNodes[id].getXml();var link=com.ibm.mm.enabler.utils.Dom.createElement(_1191.ownerDocument,"atom:link",this.ns.atom);link.setAttribute("rel","related");link.setAttribute("href",_118f);link.setAttribute("type","application/atom+xml");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_1191.ownerDocument,link,"ext:rel","rel",this.ns.ext,"page");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_1191.ownerDocument,link,"ext:class","class",this.ns.ext,"content-node");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_1191.ownerDocument,link,"ext:uri","uri",this.ns.ext,_1190);_1191.appendChild(link);}}if(_118d==com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK){_117f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_117f.setNodes([{value:id,isID:true}]);entry=com.ibm.mm.enabler.utils.Utils.createFeed(_117f.getModelURI(),"IBM Lotus Mashups Navigation Feed",this.loadedNodes[id],this.ns);myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_118e._getSpaceIdentifier()?this.spaceNavigationEntryUrl:this.entryUrl,this);myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_COMPOSITE_APPLICATION);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this._acquire();_117d=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_117d.create(entry,dojo.hitch(this,function(type,data,xhr,id){var expr="atom:feed/atom:entry";var _1192=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,data,this.ns);if(_1192){page.setXml(_1192);this.loadedNodes[page.getID()]=page;this.initialContents[page.getID()]=page.toString();delete this.loadedNodes[id];delete this.initialContents[id];delete this.createdNodes[id];if(this.layoutModels[id]&&!this.layoutModels[page.getID()]){this.layoutModels[page.getID()]=this.layoutModels[id];this.layoutModels[page.getID()].switchUri(page.getID());delete this.layoutModels[id];}if(_117a&&_117a.operationCallback){_117a.operationCallback(page,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_117a.operationCallbackParameters);}}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_117c){this.LOGGER.warning(_117b,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}this._release(_117a,xhr.status);}),id);}else{_1182[id]=page;this.invalidate(page);var _1193=parseInt(_118d,10);_118b.code=this._overallStatus(_1193,_118b.code);}},this);dojo.forEach(_1181,function(id){page=this.loadedNodes[id];_117e=page._contentNode;if(_117e&&(_117e._isDirty()||_117e._isStaticMarkupDirty)){this._putContentNode(_117e);}_117f=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);_117f.setNodes([{value:id,isID:true}]);var _1194=this.loadedNodes[id];if(!this.loadedNodes[id].isThemeChanged()){_1194=com.ibm.mm.enabler.navigation.NavigationNodeFactory.createNavigationNode(this.loadedNodes[id].getXml());_1194.setThemeIdentifier(null);}entry=com.ibm.mm.enabler.utils.Utils.createFeed(_117f.getModelURI(),"IBM Lotus Mashups Navigation Feed",_1194,this.ns);edit=page.getEditLink();myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(edit,this);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_UPDATE,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_UPDATE_VALUE_REPLACE);this._acquire();_117d=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_117d.update(entry,dojo.hitch(this,function(type,data,xhr,page){var expr="atom:feed/atom:entry";var _1195=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,data,this.ns);if(_1195){page.setXml(_1195);this.initialContents[page.getID()]=page.toString();}if(_117a&&_117a.operationCallback){_117a.operationCallback(this.loadedNodes[page.getID()],com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_117a.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_117c){this.LOGGER.warning(_117b,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}this._release(_117a,xhr.status);}),page);},this);com.ibm.mm.enabler.utils.Misc.forIn(this.deletedNodes,function(node,id){delete this.layoutModels[id];edit=this.deletedNodes[id].getEditLink();myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(edit,this);this._acquire();_117d=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_117d.remove(dojo.hitch(this,function(type,data,xhr,args){if(_117a&&_117a.operationCallback){_117a.operationCallback(args,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_117a.operationCallbackParameters);}this._release(_117a,xhr.status);}),id);var _1196=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:link[@ext:rel='internalurl']",this.deletedNodes[id].getXml(),this.ns);if(!_1196){expr="atom:link[@rel='related' and @ext:class='content-node']/@href";var _1197=com.ibm.mashups.enabler.xml.XPath.evaluateString(expr,this.deletedNodes[id].getXml(),this.ns);if(_1197){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1197,this);this._acquire();_117d=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_117d.remove(dojo.hitch(this,function(type,data,xhr,args){if(_117a&&_117a.operationCallback){_117a.operationCallback(args,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_117a.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_117c){this.LOGGER.warning(_117b,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}}this._release(_117a,xhr.status);}),id);}}delete this.deletedNodes[id];},this);for(id in this.layoutModels){if(Object.prototype.hasOwnProperty.call(this.layoutModels,id)){if(!(id in _1182)){this.layoutModels[id]._commit(_117a,sync,this);}}}this._release(_117a,_118b.code);if(_117c){this.LOGGER.exiting(_117b);}},_overallStatus:function(_1198,_1199){return Math.max(parseInt(_1198,10),_1199);},_find:function(_119a,sync,uri,_119b){this._initServiceDoc();var _119c="_find";var _119d=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_119d){this.LOGGER.entering(_119c,arguments);}if(!uri){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(uri);if(id in this.deletedNodes){if(_119a){_119a.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}var _119e=null;if(id in this.loadedNodes){if(_119a){_119a.finish(this.loadedNodes[id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}_119e=this.loadedNodes[id];}else{var myUrl;var href=com.ibm.mm.enabler.utils.Utils.getHrefFromIdentifiable(uri);if(href){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(href,this);}else{if(uri=="collection"){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.entryUrl,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);myUrl.setNodes([{value:com.ibm.mm.enabler.utils.Misc.encodeModelID4Uri(uri),isID:true}]);}}var s=this._findStrategyByType("com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy");var _119f="1";if(s){if(_119b){var _11a0=s.getParentLevel();if(_11a0){_119f="-"+(_11a0+1);}}else{var _11a1=s.getChildrenLevel();if(_11a1&&_11a1>0){_119f=_11a1+1;}}}myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_LEVELS,_119f);myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_COMPOSITE_APPLICATION);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this._applyHiddenMetaDataLoadingStrategyToModelURL(myUrl);var _11a2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var _11a3={};_11a3.node=null;_11a2.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes){for(var i=0;i<nodes.length;i++){var node=com.ibm.mm.enabler.navigation.NavigationNodeFactory.createNavigationNode(nodes[i]);node=this._cacheNode(node);if(id==node.getID()||id==node._getUniqueName()){_11a3.node=node;}else{var _11a4=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("thr:in-reply-to[@ext:uri]",node.getXml(),this.ns);if(uri=="collection"&&(!_11a4||_11a4.length===0)){_11a3.node=node;}}}}else{if(sync){_11a3.status=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;}}}if(_119a){_119a.finish(_11a3.node,xhr.status);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){if(_119d){this.LOGGER.warning(_119c,this.modelMessages.E_XHR_REQUEST_FAILED_2,[xhr,data||"n/a"]);}if(sync){_11a3.status=xhr.status;}}}}));if(_11a3.status){throw new Error(dojo.string.substitute(this.modelMessages.E_NAVNODE_NOTFOUND_1,[uri,_11a3.status]));}_119e=_11a3.node;}if(_119d){this.LOGGER.exiting(_119c,_119e);}return _119e;},invalidate:function(node){if(typeof node=="undefined"){var _11a5=[];for(var id in this.loadedNodes){if(Object.prototype.hasOwnProperty.call(this.loadedNodes,id)){_11a5.push(id);}}dojo.forEach(_11a5,this._invalidate,this);}else{this._invalidate(com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node));}},_invalidate:function(id){if(id in this.loadedNodes){delete this.loadedNodes[id];delete this.initialContents[id];if(this.layoutModels[id]&&this.layoutModels[id]._wireModel){this.layoutModels[id]._wireModel=null;}delete this.layoutModels[id];delete this.createdNodes[id];}},_removeCacheNode:function(node){node=this._resolve(node);var id=node.getID();if(id in this.loadedNodes){delete this.loadedNodes[id];delete this.initialContents[id];}},_cacheNode:function(node){var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.initialContents[id]=node.toString();}return this.loadedNodes[id];},discard:function(node){var id;if(node){id=node.getID();}if(id){if(id in this.loadedNodes){var _11a6=com.ibm.mm.enabler.utils.Dom.createDocument(this.initialContents[id]).childNodes[0];this.loadedNodes[id].setXml(_11a6);}}else{for(id in this.createdNodes){if(id in this.loadedNodes){delete this.loadedNodes[id];}}for(id in this.loadedNodes){if(this.loadedNodes.hasOwnProperty(id)){var _11a7=com.ibm.mm.enabler.utils.Dom.createDocument(this.initialContents[id]).childNodes[0];this.loadedNodes[id].setXml(_11a7);}}this.createdNodes={};this.deletedNodes={};}}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.Factory"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.Factory"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.Factory");dojo.declare("com.ibm.mm.enabler.navigation.priming.Factory",null,{_navigationModelWrapper:null,_navigationModelIteratorWrapper:[],_navigationElementWrapper:{},getNavigationModel:function(){if(!this._navigationModelWrapper){var ext={};var _11a8=function(){};var _11a9=com.ibm.mm.enabler.navigation.priming.PrimingCentral;var _11aa=new com.ibm.mm.enabler.navigation.priming.PrimedNavigationModel();var _11ab=new com.ibm.mm.enabler.navigation.priming.NavigationModelWrapper(_11aa,com.ibm.mashups.enabler.model.NavigationModel.prototype,null);_11a9._initResetFuncs(ext,_11ab._replaceFn,_11ab._originalFn,com.ibm.mm.enabler.model.NavigationModelImpl,_11a8);_11aa.setStopPrimingVars({wrapper:_11ab});this._navigationModelWrapper=_11ab;}return this._navigationModelWrapper;},getUnprimedNavigationModel:function(){return com.ibm.mm.enabler.model.NavigationModelImpl.prototype._getInstance();},getNavigationModelIterator:function(_11ac,nodes){var ext={};var _11ad=function(){};var _11ae=com.ibm.mm.enabler.navigation.priming.PrimingCentral;var _11af=new com.ibm.mm.enabler.navigation.priming.PrimedNavigationModelIterator(_11ac,nodes);var _11b0=new com.ibm.mm.enabler.navigation.priming.NavigationModelIteratorWrapper(_11af,com.ibm.mashups.enabler.DeferredIterator.prototype,null);_11b0._parentId=_11ac;_11ae._initResetFuncs(ext,_11b0._replaceFn,_11b0._originalFn,com.ibm.mm.enabler.DeferredIteratorImpl,_11ad);_11af.setStopPrimingVars({wrapper:_11b0});this._navigationModelIteratorWrapper.push(_11b0);return _11b0;},getNavigationNode:function(node){if(!this._navigationElementWrapper[node.id]){var ext={};var _11b1=function(){};var _11b2=com.ibm.mm.enabler.navigation.priming.PrimingCentral;var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();switch(node.type){case com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_URL:var _11b3=new com.ibm.mm.enabler.navigation.priming.PrimedNavigationURL(node);var _11b4=new com.ibm.mm.enabler.navigation.priming.NavigationURLWrapper(_11b3,com.ibm.mashups.enabler.navigation.NavigationURL.prototype,null);_11b2._initResetFuncs(ext,_11b4._replaceFn,_11b4._originalFn,com.ibm.mm.enabler.navigation.NavigationURLImpl,_11b1);break;case com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL:var _11b3=new com.ibm.mm.enabler.navigation.priming.PrimedNavigationLabel(node);var _11b4=new com.ibm.mm.enabler.navigation.priming.NavigationLabelWrapper(_11b3,com.ibm.mashups.enabler.navigation.NavigationLabel.prototype,null);_11b2._initResetFuncs(ext,_11b4._replaceFn,_11b4._originalFn,com.ibm.mm.enabler.navigation.NavigationLabelImpl,_11b1);break;case com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE:var _11b3=new com.ibm.mm.enabler.navigation.priming.PrimedNavigationNode(node);var _11b4=new com.ibm.mm.enabler.navigation.priming.NavigationNodeWrapper(_11b3,com.ibm.mashups.enabler.navigation.NavigationNode.prototype,null);_11b2._initResetFuncs(ext,_11b4._replaceFn,_11b4._originalFn,com.ibm.mm.enabler.navigation.NavigationNodeImpl,_11b1);break;default:var _11b3=new com.ibm.mm.enabler.navigation.priming.PrimedNavigationNode(node);var _11b4=new com.ibm.mm.enabler.navigation.priming.NavigationNodeWrapper(_11b3,com.ibm.mashups.enabler.navigation.NavigationNode.prototype,null);_11b2._initResetFuncs(ext,_11b4._replaceFn,_11b4._originalFn,com.ibm.mm.enabler.navigation.NavigationNodeImpl,_11b1);break;}_11b4._id=node.id;_11b3.setStopPrimingVars({wrapper:_11b4});this._navigationElementWrapper[node.id]=_11b4;}return this._navigationElementWrapper[node.id];}});com.ibm.mm.enabler.navigation.priming.Factory=new com.ibm.mm.enabler.navigation.priming.Factory();}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationModel"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimedNavigationModel"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimedNavigationModel");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimedNavigationModel",[com.ibm.mashups.enabler.model.NavigationModel,com.ibm.mm.enabler.navigation.priming.Disposable,com.ibm.mm.enabler.navigation.priming.Primed],{primingCentral:null,constructor:function(args){this._initStoppers(com.ibm.mashups.enabler.model.NavigationModel.prototype);this.primingCentral=com.ibm.mm.enabler.navigation.priming.PrimingCentral;},stopPriming:function(){var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();this.getStopPrimingVar("wrapper")._reset();var prs=nm.getStrategy("com.ibm.mashups.enabler.strategy.PrimingDataReplacementStrategy");if(prs){var tls=nm.getStrategy("com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy");var _11b5=new com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy(0,prs.getLevel());nm.addStrategy(_11b5);nm.getRoot().start();if(tls){nm.addStrategy(tls);}else{nm.removeStrategy("com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy");}}return this.inherited(arguments);},dispose:function(){com.ibm.mm.enabler.utils.Misc.forIn(com.ibm.mashups.enabler.model.NavigationModel.prototype,function(value,key){if(dojo.indexOf(com.ibm.mm.enabler.GenericWrapper.FILTERED_FUNCTIONS,key)==-1&&dojo.isFunction(value)){this[key]=function(){throw "Object has been disposed";};}},this);},getRoot:function(){for(var id in this.primingCentral._navigationNodes){if(Object.prototype.hasOwnProperty.call(this.primingCentral._navigationNodes,id)){var node=this.primingCentral._navigationNodes[id];if(!node.parentId){var root=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationNode(node);return new com.ibm.mm.enabler.DeferredImpl(this,function(_11b6,sync,_11b7){_11b6.finish(_11b7,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return _11b7;},root);}}}this.stopPriming();return com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel().getRoot();},getParent:function(node){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(node);var _11b8;if(this.primingCentral._navigationNodes[id]){var _11b9=this.primingCentral._navigationNodes[id].parentId;_11b8=_11b9?this.primingCentral._navigationNodes[_11b9]:null;var _11ba=null;if(_11b8!==null){_11ba=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationNode(_11b8);}return new com.ibm.mm.enabler.DeferredImpl(this,function(_11bb,sync,_11bc){_11bb.finish(_11bc,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return _11bc;},_11ba);}else{this.stopPriming();return com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel().getParent(node);}},hasChildren:function(n){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(n);var node=this.primingCentral._navigationNodes[id];if(node&&node.children){if(node.children.length>0){return !com.ibm.mm.enabler.utils.Misc.isEmpty(node.children[0])||node.children.length>1;}else{if(node.children.length===0){return true;}}}this.stopPriming();var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();var _11bd=nm.find(id).start();return _11bd?nm.hasChildren(_11bd):false;},getChildren:function(n){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(n);var node=this.primingCentral._navigationNodes[id];if(node&&node.children){var _11be=com.ibm.mm.enabler.navigation.priming.Factory;var _11bf=dojo.map(node.children,function(id){return com.ibm.mm.enabler.utils.Misc.isEmpty(id)?{}:_11be.getNavigationNode(this.primingCentral._navigationNodes[id]);},this);return com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModelIterator(id,_11bf);}else{this.stopPriming();var nm=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();var _11c0=nm.find(id).start();return nm.getChildren(_11c0);}},find:function(id){id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(id);var _11c1=this.primingCentral._navigationNodes[id];if(_11c1){var node=com.ibm.mm.enabler.navigation.priming.Factory.getNavigationNode(_11c1);return new com.ibm.mm.enabler.DeferredImpl(this,function(_11c2,sync,id){_11c2.finish(node,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return node;},id);}else{this.stopPriming();return com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel().find(id);}},setPrimingData:function(data){return this.primingCentral._setNavigationModelPrimingData(data);},addStrategy:function(s){com.ibm.mm.enabler.navigation.priming.Factory.getUnprimedNavigationModel().addStrategy(s);},setStrategy:function(s){com.ibm.mm.enabler.navigation.priming.Factory.getUnprimedNavigationModel().setStrategy(s);}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiableEventProviderWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiableEventProviderWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.ModifiableEventProviderWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.ModifiableEventProviderWrapper",[com.ibm.mm.enabler.GenericWrapper,com.ibm.mashups.enabler.widget.ModifiableEventProvider],{});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiablePreferencesWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiablePreferencesWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.ModifiablePreferencesWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.ModifiablePreferencesWrapper",[com.ibm.mm.enabler.GenericWrapper,com.ibm.mashups.enabler.widget.ModifiablePreferences],{});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiableWireModelWrapper"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.ModifiableWireModelWrapper"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.ModifiableWireModelWrapper");dojo.declare("com.ibm.mm.enabler.navigation.priming.ModifiableWireModelWrapper",[com.ibm.mm.enabler.GenericWrapper,com.ibm.mashups.enabler.wire.WireModel,com.ibm.mm.enabler.navigation.priming.Disposable],{dispose:function(){if(dojo.isFunction(this._getTarget().dispose)){this._getTarget().dispose();}}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimingCentral"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming.PrimingCentral"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming.PrimingCentral");dojo.declare("com.ibm.mm.enabler.navigation.priming.PrimingCentral",null,{_widgets:null,_wireModels:{},_navigationNodes:{},_widgetModelReplaceFunctions:["find","invalidate","getWidgetDefinitionByWindow","getWidgetDefinitionByInstance","getWidgetWindow","getWidgetInstance","getHierarchicalPreferences","getHierarchicalEventProvider"],_layoutModelReplaceFunctions:["create","getRoot","hasChildren","getChildren","getParent","isModifiable","isDeletable","find","confirmCreate","insert","confirmInsert","remove","confirmRemove","setStrategy","getStrategies","addStrategy","removeStrategy","getWireModel","invalidate"],_originalWidgetModelFunctions:{},_originalLayoutModelFunctions:{},_extractAttributes:function(_11c3){var _11c4={};var css=com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE;dojo.query("."+css.iwItemSet+"[title=\"attributes\"]"+" a."+css.iwItem,_11c3).forEach(function(item){var name=com.ibm.mm.enabler.navigation.priming.PrimingCentral.stripHashPrefix(dojo.attr(item,"href"));_11c4[name]={readOnly:dojo.hasClass(item,com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwReadOnly),values:dojo.query("span."+css.iwValue,item).attr("innerHTML")};},this);return _11c4;},_extractEvents:function(_11c5){var _11c6={};var css=com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE;dojo.query("."+css.iwEvent,_11c5).forEach(function(item){var name=dojo.attr(item,"title");var _11c7=com.ibm.mm.enabler.navigation.priming.PrimingCentral.stripHashPrefix(dojo.attr(dojo.query("."+css.iwDescRef,item)[0],"href"));var _11c8="."+css.iwEventDescription+"[title=\""+_11c7+"\"]";var _11c9=dojo.string.trim(dojo.attr(dojo.query(_11c8+" ."+css.iwPayloadType,_11c5)[0],"innerHTML"));var _11ca={};var _11cb={};var lang,value;dojo.query(_11c8+" ."+css.iwDescription+" ."+css.iwValue,_11c5).forEach(function(item){lang=dojo.attr(item,"lang");value=dojo.attr(item,"innerHTML");_11cb[lang]=null;_11ca[lang]=value;},this);var _11cc={};dojo.query(_11c8+" ."+css.iwTitle+" ."+css.iwValue,_11c5).forEach(function(item){lang=dojo.attr(item,"lang");value=dojo.attr(item,"innerHTML");_11cb[lang]=null;_11cc[lang]=value;},this);var _11cd=[];com.ibm.mm.enabler.utils.Misc.forIn(_11cb,function(value,key){_11cd.push(key);});_11c6[name]={isPublished:dojo.hasClass(item,css.iwPublished),isHandled:dojo.hasClass(item,css.iwHandled),name:name,payloadType:_11c9,locales:_11cd,titles:_11cc,descriptions:_11ca};},this);return _11c6;},_extractWires:function(_11ce,_11cf){var wires=[];var css=com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE;dojo.query("."+css.iwReceivedEvent,_11ce).forEach(function(item){var _11d0=dojo.query("."+css.iwSourceEvent,item)[0];var wire={sourceWidget:com.ibm.mm.enabler.navigation.priming.PrimingCentral.stripHashPrefix(dojo.attr(_11d0,"href")),targetWidget:_11cf,sourceEventName:dojo.string.trim(dojo.attr(_11d0,"innerHTML")),targetEventName:dojo.string.trim(dojo.attr(dojo.query("."+css.iwTargetEvent,item)[0],"innerHTML"))};wires.push(wire);},this);return wires;},_extractNavigationNodes:function(node,_11d1,_11d2){if(!_11d1){_11d1={};}if(!com.ibm.mm.enabler.utils.Misc.isEmpty(node)){var id=node.id;_11d1[id]={};_11d1[id].id=id;switch(node.type){case "page":_11d1[id].type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE;break;case "label":_11d1[id].type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL;break;case "url":_11d1[id].type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_URL;break;default:_11d1[id].type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE;}if(node.metadata){_11d1[id].metadata={};com.ibm.mm.enabler.utils.Misc.forIn(node.metadata,function(v,n){_11d1[id].metadata[n]=v;},this);}if(node.isPrivate){_11d1[id].isPrivate=node.isPrivate;}if(node.roles&&dojo.isArray(node.roles)){_11d1[id].roles=[];var roles=_11d1[id].roles;dojo.forEach(node.roles,function(r){switch(r){case "user":roles.push(com.ibm.mashups.enabler.ac.RoleType.USER);break;case "privilegedUser":roles.push(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER);break;case "editor":roles.push(com.ibm.mashups.enabler.ac.RoleType.EDITOR);break;case "manager":roles.push(com.ibm.mashups.enabler.ac.RoleType.MANAGER);break;case "admin":roles.push(com.ibm.mashups.enabler.ac.RoleType.ADMIN);break;}},this);}_11d1[id].title=node.title;_11d1[id].locale=node.locale;_11d1[id].theme=node.theme;_11d1[id].parentId=_11d2;if(node.children&&dojo.isArray(node.children)){_11d1[id].children=[];if(node.children.length>0){dojo.forEach(node.children,function(child){this._extractNavigationNodes(child,_11d1,id);},this);}}}if(_11d2){_11d1[_11d2].children.push(node.id||{});}return _11d1;},extractInformation:function(node){var ret={};dojo.query("."+com.ibm.mm.iwidget.Constants.CSSCLASS_PREFIXED_INSTANCE.iwWidget,node).forEach(function(_11d3){var _11d4=com.ibm.mm.iwidget.Utils.getModelID(dojo.attr(_11d3,"id"));var id=com.ibm.mm.enabler.IdentifiableHelper.getID(_11d4);var _11d5=this._extractAttributes(_11d3);var _11d6=this._extractEvents(_11d3);var wires=this._extractWires(_11d3,id);ret[id]={widgetId:_11d4,preferences:_11d5,events:_11d6,wires:wires,_primed:[]};},this);return ret;},_resetWidgetModelFunctions:function(){dojo.extend(com.ibm.mm.enabler.widget.WidgetModelImpl,this._originalWidgetModelFunctions);this._originalWidgetModelFunctions={};},_resetLayoutModelFunctions:function(){dojo.extend(com.ibm.mm.enabler.model.LayoutModelImpl,this._originalLayoutModelFunctions);this._originalLayoutModelFunctions={};},reset:function(){this._resetWidgetModelFunctions();this._resetLayoutModelFunctions();this._widgets=null;com.ibm.mm.enabler.utils.Misc.forIn(this._wireModels,function(_11d7,key){_11d7.dispose();});this._wireModels={};},primeServerRuntimeContent:function(node){var _11d8=dojo.isString(node);if(_11d8){node=dojo.create("div",{display:"none",innerHTML:node});}this._widgets=this.extractInformation(node);if(_11d8){dojo.destroy(node);}if(!com.ibm.mm.enabler.utils.Misc.isEmpty(this._widgets)){this._setWidgetModelFunctions();this._setLayoutModelFunctions();}},_setNavigationModelPrimingData:function(data){this._navigationNodes=this._extractNavigationNodes(data);var _11d9=com.ibm.mm.enabler.context.LocalizedContextImpl.prototype.getTitle;var ext={};ext.getTitle=function(_11da){var title;if(dojo.isFunction(_11da._getTarget)){if(_11da._getTarget()._navigationNodeObj){title=_11da._getTarget()._navigationNodeObj.title;}}return title?title:_11d9.apply(this,arguments);};var _11db=com.ibm.mm.enabler.context.LocalizedContextImpl.prototype.getLocale;ext.getLocale=function(_11dc){if(dojo.isFunction(_11dc._getTarget)){var _11dd=_11dc._getTarget()._navigationNodeObj;if(_11dd){if(_11dd.locale){return _11dd.locale;}}}return _11db.apply(this,arguments);};dojo.extend(com.ibm.mm.enabler.context.LocalizedContextImpl,ext);},_replaceWithOriginal:function(item){var _11de=item._getTarget();var _11df;if(item instanceof com.ibm.mm.enabler.navigation.priming.ModifiablePreferencesWrapper){_11df=com.ibm.mashups.enabler.widget.Factory.getWidgetModel().getHierarchicalPreferences(_11de.preferenceProvider).start(true);}else{if(item instanceof com.ibm.mm.enabler.navigation.priming.ModifiableEventProviderWrapper){_11df=com.ibm.mashups.enabler.widget.Factory.getWidgetModel().getHierarchicalEventProvider(_11de.eventProvider).start(true);}else{if(item instanceof com.ibm.mm.enabler.navigation.priming.ModifiableWireModelWrapper){_11df=this._originalLayoutModelFunctions.getWireModel.call(item._getTarget().layoutModel);}}}item._replaceTarget(_11df);},resetPrimedWidget:function(id){if(this._widgets&&id in this._widgets){console.debug("reset!",this._widgets[id]);var _11e0=this._widgets[id]._primed;delete this._widgets[id];if(_11e0){dojo.forEach(_11e0,this._replaceWithOriginal,this);}if(com.ibm.mm.enabler.utils.Misc.isEmpty(this._widgets)){this.reset();}}},resetPrimedWireModel:function(id){this._replaceWithOriginal(this._wireModels[id]);},_saveFunction:function(_11e1,_11e2,func){if(!_11e1[_11e2]){_11e1[_11e2]=func;}return _11e1[_11e2];},_initResetFuncs:function(_11e3,_11e4,_11e5,impl,_11e6){dojo.forEach(_11e4,function(_11e7){var _11e8=this._saveFunction(_11e5,_11e7,impl.prototype[_11e7]);var self=this;if(dojo.isFunction(_11e8)){_11e3[_11e7]=function(){_11e6.apply(self,arguments);return _11e8.apply(this,arguments);};}},this);},_setWidgetModelFunctions:function(){var ext={};var _11e9=function(){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(arguments[0]);this.resetPrimedWidget(id);};this._initResetFuncs(ext,this._widgetModelReplaceFunctions,this._originalWidgetModelFunctions,com.ibm.mm.enabler.widget.WidgetModelImpl,_11e9);var wm=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();ext.getHierarchicalPreferences=dojo.hitch(this,function(_11ea){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_11ea);if(_11ea instanceof com.ibm.mashups.enabler.widget.WidgetWindow&&id in this._widgets){return new com.ibm.mm.enabler.DeferredImpl(this,function(_11eb,sync,_11ec){var _11ed=new com.ibm.mm.enabler.navigation.priming.PrimedModifiablePreferences({primingCentral:this,preferenceProvider:_11ec.preferenceProvider});var prefs=new com.ibm.mm.enabler.navigation.priming.ModifiablePreferencesWrapper(_11ed,com.ibm.mashups.enabler.widget.ModifiablePreferences.prototype,null);_11ed.setStopPrimingVars({widgetId:id,wrapper:prefs});this._widgets[id]._primed.push(prefs);if(_11eb){_11eb.finish(prefs,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return prefs;},{preferenceProvider:_11ea});}else{return this._originalWidgetModelFunctions.getHierarchicalPreferences.apply(wm,arguments);}});ext.getHierarchicalEventProvider=dojo.hitch(this,function(_11ee){var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_11ee);if(_11ee instanceof com.ibm.mashups.enabler.widget.WidgetWindow&&id in this._widgets){return new com.ibm.mm.enabler.DeferredImpl(this,function(_11ef,sync,_11f0){var _11f1=new com.ibm.mm.enabler.navigation.priming.PrimedModifiableEventProvider({primingCentral:this,eventProvider:_11f0.eventProvider});var eP=new com.ibm.mm.enabler.navigation.priming.ModifiableEventProviderWrapper(_11f1,com.ibm.mashups.enabler.widget.ModifiableEventProvider.prototype,null);_11f1.setStopPrimingVars({widgetId:id,wrapper:eP});this._widgets[id]._primed.push(eP);if(_11ef){_11ef.finish(eP,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return eP;},{eventProvider:_11ee});}else{return this._originalWidgetModelFunctions.getHierarchicalEventProvider.apply(wm,arguments);}});ext.invalidate=dojo.hitch(this,function(){this.reset();if(dojo.isFunction(this._originalWidgetModelFunctions.invalidate)){this._originalWidgetModelFunctions.invalidate.apply(wm,arguments);}});dojo.extend(com.ibm.mm.enabler.widget.WidgetModelImpl,ext);},_setLayoutModelFunctions:function(){var ext={};this._initResetFuncs(ext,this._layoutModelReplaceFunctions,this._originalLayoutModelFunctions,com.ibm.mm.enabler.model.LayoutModelImpl,this.reset);var self=this;ext.getWireModel=function(){var _11f2=new com.ibm.mm.enabler.navigation.priming.PrimedWireModel({primingCentral:self,layoutModel:this});var wm=new com.ibm.mm.enabler.navigation.priming.ModifiableWireModelWrapper(_11f2,com.ibm.mashups.enabler.wire.WireModel.prototype,null);var lmID=this._getNavigationNode().getID();_11f2.setStopPrimingVars({wrapper:wm,id:lmID});self._wireModels[lmID]=wm;return wm;};ext.invalidate=dojo.hitch(this,function(){this.reset();if(dojo.isFunction(this._originalLayoutModelFunctions.invalidate)){this._originalLayoutModelFunctions.invalidate.apply(wm,arguments);}});dojo.extend(com.ibm.mm.enabler.model.LayoutModelImpl,ext);}});com.ibm.mm.enabler.navigation.priming.PrimingCentral=new com.ibm.mm.enabler.navigation.priming.PrimingCentral();com.ibm.mm.enabler.navigation.priming.PrimingCentral.stripHashPrefix=com.ibm.mm.iwidget.Utils.stripHashPrefix;}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.priming._primeServerRuntimeContentMixin"]){dojo._hasResource["com.ibm.mm.enabler.navigation.priming._primeServerRuntimeContentMixin"]=true;dojo.provide("com.ibm.mm.enabler.navigation.priming._primeServerRuntimeContentMixin");dojo.declare("com.ibm.mm.enabler.navigation.priming._primeServerRuntimeContentMixin",null,{primeServerRuntimeContent:function(_11f3){com.ibm.mm.enabler.navigation.priming.PrimingCentral.primeServerRuntimeContent(_11f3);}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.NavigationNodeImpl");dojo.declare("com.ibm.mm.enabler.navigation.NavigationNodeImpl",[com.ibm.mashups.enabler.navigation.NavigationNode,com.ibm.mm.enabler.navigation.priming._primeServerRuntimeContentMixin,com.ibm.mm.enabler.navigation.NavigationElementImpl,com.ibm.mashups.enabler.content.ServerRuntimeContent,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.NextLinkProviderImpl,com.ibm.mm.enabler.RepresentationProviderImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this._fragmentData=null;this._fragmentMediaData=null;this._contentNode=null;this._CONTENT_NODE_LINK="atom:link[@rel='related' and @ext:class='content-node']";this._LAYOUT_VIEW_LINK="atom:link[@ext:rel='layout' and @type='text/html']";this._RESOURCE_LINK="atom:link[@ext:rel='resourcefeed']";this._LAYOUT_TEMPLATE_REF_MDNAME="com.ibm.portal.layout.template.ref";this._type=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE;},getTheme:function(){var id=this.getThemeIdentifier();return id?id.getID():null;},setTheme:function(id){this.setThemeIdentifier(new com.ibm.mm.enabler.IdentifierImpl(id));},getExportPageURL:function(){var _11f4=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._RESOURCE_LINK,this.xmlData,this.ns_nav);if(nodes&&nodes.length>0){_11f4=nodes[0].getAttribute("href");}return _11f4||null;},_getFragmentData:function(){return this._fragmentData;},_setFragmentData:function(data){this._fragmentData=data;},_getFragmentMediaData:function(){return this._fragmentMediaData;},_setFragmentMediaData:function(data){this._fragmentMediaData=data;},getServerRuntimeMarkup:function(_11f5){return new com.ibm.mm.enabler.DeferredImpl(this,this._getServerRuntimeMarkup,_11f5);},_getServerRuntimeMarkup:function(dfr,sync,_11f6){var _11f7="_getServerRuntimeMarkup";var _11f8=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_11f8){this.LOGGER.entering(_11f7,arguments);}var _11f9={};var _11fa=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._LAYOUT_VIEW_LINK,this.xmlData,this.ns_nav);if(_11fa&&_11fa.length>0){var _11fb=_11fa[0].getAttribute("href");var _11fc=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_11fb,this);var _11fd=com.ibm.mashups.enabler.model.state.UrlGeneratorFactory.getURLGenerator();if(!_11f6){_11f6=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();}var _11fe=_11fd.getURL(_11f6);_11fc.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_STATE_URL,_11fe);var _11ff=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_11fc,null,null,true,sync);_11ff.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){_11f9.markup=data;}_11f9.status=xhr.status;if(dfr){dfr.finish(_11f9.markup,_11f9.status);}}));}else{_11f9.markup=null;_11f9.status=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;if(dfr){dfr.finish(_11f9.markup,_11f9.status);}}if(_11f8){this.LOGGER.exiting(_11f7,[_11f9]);}return _11f9.markup;},getServerRuntimeContent:function(){return this;},_createContentNode:function(){var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns_nav.atom);entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns_nav.atom));var _1200=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns_nav.atom);_1200.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("model:static-content-page",this.ns_nav.model));entry.appendChild(_1200);var node=com.ibm.mm.enabler.content.ContentNodeFactory.createContentNode(entry,this);node._setClean();return node;},getContent:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getContent);},_getContent:function(dfr,sync){var _1201="_getContent";var _1202=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1202){this.LOGGER.entering(_1201,arguments);}if(this._contentNode){dfr.finish(this._contentNode,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return this._contentNode;}var _1203;var links=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this._CONTENT_NODE_LINK,this.xmlData,this.ns_nav);if(links&&links.length>0){_1203=links[0].getAttribute("href");}else{this._contentNode=this._createContentNode();dfr.finish(this._contentNode,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);return this._contentNode;}var _1204=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1203,this);_1204.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);_1204.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_MDNAME,this._LAYOUT_TEMPLATE_REF_MDNAME);_1204.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);var _1205={};var _1206=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_1204,null,null,false,sync);_1206.read(dojo.hitch(this,function(type,data,xhr,args){_1205.status=xhr.status;if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns_nav);if(nodes){this._contentNode=com.ibm.mm.enabler.content.ContentNodeFactory.createContentNode(nodes[0],this);_1205.node=this._contentNode;}else{_1205.status=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;}}dfr.finish(_1205.node||null,_1205.status);}));if(_1202){this.LOGGER.exiting(_1201,[_1205]);}return _1205.node;},confirmSetDescription:function(_1207,_1208){var _1209=1024;var limit=this.cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.LIMIT_PAGE_DESCRIPTION);if(limit){limit=parseInt(limit,10);if(isNaN(limit)||limit<0){limit=_1209;}}else{limit=_1209;}return (_1207.length<=limit)&&this.inherited(arguments);},shouldSyncMetaData:function(){return com.ibm.mashups.enabler.navigation.Factory.getNavigationModel().getStrategy("com.ibm.mashups.enabler.strategy.SyncMetaDataStrategy")!==null;},setMetaData:function(name,value,_120a){if(this.shouldSyncMetaData()&&!_120a){this.getContent().start(true).setMetaData(name,value,true);}this.inherited(arguments);},removeMetaData:function(name,_120b){if(this.shouldSyncMetaData()&&!_120b){this.getContent().start(true).removeMetaData(name,true);}this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationNode"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.NavigationNode"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.NavigationNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.NavigationModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.NavigationModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.NavigationModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.SharedNavigationNode_API");dojo.provide("com.ibm.mashups.enabler.navigation.SharedNavigationNode");dojo.declare("com.ibm.mashups.enabler.navigation.SharedNavigationNode",com.ibm.mashups.enabler.navigation.NavigationNode,{});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.SharedNavigationNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.SharedNavigationNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.SharedNavigationNodeImpl");dojo.declare("com.ibm.mm.enabler.navigation.SharedNavigationNodeImpl",[com.ibm.mashups.enabler.navigation.SharedNavigationNode,com.ibm.mm.enabler.navigation.NavigationNodeImpl],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationNode"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationNode"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.SharedNavigationNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationRoot_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationRoot_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.SharedNavigationRoot_API");dojo.provide("com.ibm.mashups.enabler.navigation.SharedNavigationRoot");dojo.declare("com.ibm.mashups.enabler.navigation.SharedNavigationRoot",com.ibm.mashups.enabler.navigation.NavigationNode,{});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.SharedNavigationRootImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.SharedNavigationRootImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.SharedNavigationRootImpl");dojo.declare("com.ibm.mm.enabler.navigation.SharedNavigationRootImpl",[com.ibm.mashups.enabler.navigation.SharedNavigationRoot,com.ibm.mm.enabler.navigation.NavigationNodeImpl],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationRoot"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.SharedNavigationRoot"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.SharedNavigationRoot");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SharedNavigationModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.SharedNavigationModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.SharedNavigationModel_API");dojo.provide("com.ibm.mashups.enabler.model.SharedNavigationModel");dojo.declare("com.ibm.mashups.enabler.model.SharedNavigationModel",com.ibm.mashups.enabler.TreeModel,{getLayoutModel:function(node){},isAccepted:function(id){}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationNodeFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.NavigationNodeFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.NavigationNodeFactoryImpl");dojo.provide("com.ibm.mm.enabler.navigation.NavigationNodeFactory");dojo.declare("com.ibm.mm.enabler.navigation.NavigationNodeFactoryImpl",null,{constructor:function(){this.serviceJson=null;this._NAVIGATION_NODE_TYPE_PAGE="page";this._NAVIGATION_NODE_TYPE_LABEL="label";this._NAVIGATION_NODE_TYPE_URL="url";},_lazyInit:function(){if(!this.serviceJson){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM]));}},createNavigationNode:function(_120c){var _120d;this._lazyInit();var expr="atom:link[@ext:class='content-node']";var _120e=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,_120c,this.ns);var type=_120e?com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_120e,"ext:rel","rel",this.ns.ext):null;switch(type){case this._NAVIGATION_NODE_TYPE_PAGE:var _120f=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_120e,"ext:user-own","user-own",this.ns.ext);if(_120f=="false"){_120d=new com.ibm.mm.enabler.navigation.SharedNavigationNodeImpl();}else{_120d=new com.ibm.mm.enabler.navigation.NavigationNodeImpl();}break;case this._NAVIGATION_NODE_TYPE_LABEL:_120d=new com.ibm.mm.enabler.navigation.NavigationLabelImpl();break;case this._NAVIGATION_NODE_TYPE_URL:_120d=new com.ibm.mm.enabler.navigation.NavigationURLImpl();break;default:_120d=new com.ibm.mm.enabler.navigation.NavigationNodeImpl();break;}_120d.setXml(_120c,true);return _120d;}});com.ibm.mm.enabler.navigation.NavigationNodeFactory=new com.ibm.mm.enabler.navigation.NavigationNodeFactoryImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.model.SharedNavigationModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.SharedNavigationModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.SharedNavigationModelImpl");dojo.declare("com.ibm.mm.enabler.model.SharedNavigationModelImpl",[com.ibm.mashups.enabler.model.SharedNavigationModel,com.ibm.mm.enabler.model.NavigationModelImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.urlType=com.ibm.mashups.enabler.model.url.ModelUrlFactory.SHARED_NAVIGATION_URL;var _1210=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_SHARED_NAVIGATION);this.entryUrl=_1210.url;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(_1210.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH]));},_getInstance:function(){var _1211=com.ibm.mm.enabler.model.SharedNavigationModelImpl._instance;return _1211?_1211:(com.ibm.mm.enabler.model.SharedNavigationModelImpl._instance=new com.ibm.mm.enabler.model.SharedNavigationModelImpl());},isAccepted:function(node){if(node===null||typeof node=="undefined"){throw new Error(dojo.string.substitute(this.modelMessages.E_PARAM_ISNULL_OR_UNDEFINED_3,["id",this.declaredClass,"isAccepted(id)"]));}var _1212=(typeof (node)=="string")?node:node.getID();var _1213=this.find(_1212).start();if(!_1213){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}var expr="atom:link[@ext:rel='linked']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_1213.xmlData,this.ns);return (nodes&&nodes.length>0)?true:false;},_cacheNode:function(node){var id=node.getID();this.loadedNodes[id]=node;this.initialContents[id]=node.toString();return this.loadedNodes[id];},_find:function(_1214,sync,uri){var _1215="_find";var _1216=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1216){this.LOGGER.entering(_1215,arguments);}if(!uri){throw new Error(this.modelMessages.E_NODE_ISNULL_0);}uri=(typeof (uri)=="string")?uri:uri.getID();if(uri in this.deletedNodes){if(_1214){_1214.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}if(uri in this.loadedNodes){if(_1214){_1214.finish(this.loadedNodes[uri],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.loadedNodes[uri];}var myUrl;if(uri=="collection"){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.entryUrl,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);myUrl.setNodes([{value:uri,isID:true}]);}myUrl.setParameter("levels","1");var _1217=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._node=null;_1217.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes){var node=com.ibm.mm.enabler.navigation.NavigationNodeFactory.createNavigationNode(nodes[0]);this._node=this._cacheNode(node);}}if(_1214){_1214.finish(this._node,xhr.status);}}));if(_1216){this.LOGGER.exiting(_1215,this._node);}return this._node;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SharedNavigationModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.SharedNavigationModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.SharedNavigationModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.Factory_API");dojo.provide("com.ibm.mashups.enabler.navigation.Factory");dojo.declare("com.ibm.mashups.enabler.navigation.Factory",null,{getNavigationModel:function(){},getSharedNavigationModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.navigation.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.navigation.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.navigation.FactoryImpl");dojo.declare("com.ibm.mm.enabler.navigation.FactoryImpl",com.ibm.mashups.enabler.navigation.Factory,{getNavigationModel:function(){if(com.ibm.mm.enabler.model.ModelImpl.MODEL_RUNTIME_2_5===com.ibm.mm.enabler.model.ModelImpl._getModelRuntime()){return com.ibm.mm.enabler.navigation.priming.Factory.getNavigationModel();}else{return com.ibm.mm.enabler.model.NavigationModelImpl.prototype._getInstance();}},getSharedNavigationModel:function(){return com.ibm.mm.enabler.model.SharedNavigationModelImpl.prototype._getInstance();}});com.ibm.mashups.enabler.navigation.Factory=new com.ibm.mm.enabler.navigation.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.navigation.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.navigation.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.navigation.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.Constants"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.Constants"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.Constants");dojo.declare("com.ibm.mashups.enabler.runtime.skin.Constants",null,{DYNAMIC_CONTENT_TITLE:"lm-dynamic-title",DYNAMIC_CONTENT_ICON:"lm-dynamic-icon",ORDINAL_FIRST:0,ORDINAL_LAST:50000});com.ibm.mashups.enabler.runtime.skin.Constants=new com.ibm.mashups.enabler.runtime.skin.Constants();}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinNode"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinNode"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinNode");dojo.declare("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinNode",com.ibm.mashups.enabler.Identifiable,{constructor:function(){},getStyle:function(){},getDynamicContent:function(name){},getLayoutNode:function(){},getDomElementForDynamicContent:function(name){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode_API");dojo.provide("com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode");dojo.declare("com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode",com.ibm.mashups.enabler.runtime.skin.RuntimeSkinNode,{constructor:function(){},checkStyle:function(style){},setStyle:function(style){},setDynamicContent:function(name,value){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.FilterControl"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.FilterControl"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.FilterControl");dojo.declare("com.ibm.mashups.enabler.runtime.skin.FilterControl",null,{constructor:function(){this.disagree=false;},setDisagree:function(){this.disagree=true;},isDisagree:function(){return this.disagree;}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl");dojo.declare("com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl",[com.ibm.mashups.enabler.runtime.skin.RuntimeSkinNode,com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode],{CHANGE_VIEWPORT:1,CHANGE_DC:2,constructor:function(_1218,model){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.style={size:null,location:null};this.dynamicContent={};this.layoutNode=_1218;this.navStateModel=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();this.model=model;},getStyle:function(){var _1219="getStyle()";var _121a=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_121a){this.LOGGER.entering(_1219);}var value=this._deserializeStyle(this.layoutNode.getMetaData("css-style"));if(_121a){this.LOGGER.exiting(_1219,value);}return value;},_deserializeStyle:function(_121b){var _121c={};if(typeof _121b==="undefined"||null===_121b||_121b.length===0){return _121c;}var attrs=_121b.split(";");for(var i=0;i<attrs.length;i++){var _121d=attrs[i].split(":");if(2==_121d.length){if(_121d[0].charAt(0)=="\""){_121d[0]=_121d[0].substr(1);}_121c[dojo.string.trim(_121d[0])]=dojo.string.trim(_121d[1]);}else{if(1==_121d.length){if(_121d[0].charAt(0)=="\""){_121d[0]=_121d[0].substr(1);}_121c[dojo.string.trim(_121d[0])]="";}}}return _121c;},_serializeStyle:function(_121e){var _121f="";if(typeof _121e==="undefined"||null===_121e){return _121f;}for(var i in _121e){if(Object.prototype.hasOwnProperty.call(_121e,i)){var value=_121e[i];if(typeof value==="undefined"||null===value||""===value){_121f+=i+"; ";}else{_121f+=i+": "+value+"; ";}}}return _121f;},checkStyle:function(_1220){var _1221="check(style)";var _1222=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1222){this.LOGGER.entering(_1221,_1220);}var _1223=this.getStyle();var chain=this.model._buildStyleFilterChain(this.layoutNode,true);var _1224=new com.ibm.mashups.enabler.runtime.skin.FilterControl();chain.doFilter(this.layoutNode,_1223,_1220,_1224);var _1225=!_1224.isDisagree();if(_1222){this.LOGGER.exiting(_1221,_1225);}return _1225;},setStyle:function(_1226){var _1227="setStyle(newStyle)";var _1228=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1228){this.LOGGER.entering(_1227,_1226);}var _1229=this.getStyle();var chain=this.model._buildStyleFilterChain(this.layoutNode,false);chain.doFilter(this.layoutNode,_1229,_1226);if(_1228){this.LOGGER.exiting(_1227);}},getDomElementForDynamicContent:function(name){var _122a;var _122b=dojo.query(".id-"+this.layoutNode.getID()+"");if(_122b.length!==1){return null;}_122a=_122b[0];var elems=dojo.query("."+name,_122a);if(elems.length!==1){return null;}return elems[0];},getDynamicContent:function(name){var _122c="getDynamicContent(name)";var _122d=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_122d){this.LOGGER.entering(_122c,name);}var _122e=this.getDomElementForDynamicContent(name);var value=null;if(_122e&&"IMG"==_122e.nodeName){value=_122e.src;}else{if(_122e){value=_122e.innerHTML;}}if(_122d){this.LOGGER.exiting(_122c,value);}return value;},setDynamicContent:function(name,value){var _122f="setDynamicContent(name, value)";var _1230=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1230){this.LOGGER.entering(_122f,[name,value]);}var _1231=this.getDynamicContent(name);var chain=this.model._buildDCFilterChain(this.layoutNode,false);chain.doFilter(this.layoutNode,name,_1231,value);},getLayoutNode:function(){return this.layoutNode;},_setLayoutNode:function(_1232){this.layoutNode=_1232;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.ModifiableRuntimeSkinNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinLocator"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinLocator"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinLocator");dojo.declare("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinLocator",com.ibm.mashups.enabler.Locator,{findByLayoutNode:function(_1233){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.StyleFilterChain_API"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.StyleFilterChain_API"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.StyleFilterChain_API");dojo.provide("com.ibm.mashups.enabler.runtime.skin.StyleFilterChain");dojo.declare("com.ibm.mashups.enabler.runtime.skin.StyleFilterChain",null,{doFilter:function(_1234,_1235,_1236,_1237){}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.StyleFilterChainImpl"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.StyleFilterChainImpl"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.StyleFilterChainImpl");dojo.declare("com.ibm.mm.enabler.runtime.skin.StyleFilterChainImpl",[com.ibm.mashups.enabler.runtime.skin.StyleFilterChain],{constructor:function(_1238,_1239){this.filters=_1238;this.changing=_1239;this.current=0;},doFilter:function(_123a,_123b,_123c,_123d){if(this.current>=this.filters.length){return;}if(this.changing){this.filters[this.current++].onChangingStyle(_123a,_123b,_123c,_123d,this);}else{this.filters[this.current++].onChangeStyle(_123a,_123b,_123c,this);}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.StyleFilterChain"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.StyleFilterChain"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.StyleFilterChain");}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.StyleFilter"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.StyleFilter"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.StyleFilter");dojo.declare("com.ibm.mashups.enabler.runtime.skin.StyleFilter",null,{consturctor:function(){},onChangingStyle:function(_123e,_123f,_1240,_1241,_1242){},onChangeStyle:function(_1243,_1244,_1245,_1246){},onChangeLayoutControl:function(_1247){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel_API");dojo.provide("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel");dojo.declare("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel",[com.ibm.mashups.enabler.ListModel,com.ibm.mashups.enabler.runtime.skin.RuntimeSkinLocator],{addStyleFilter:function(_1248,_1249,_124a){},removeStyleFilter:function(_124b){},find:function(id){}});}if(!dojo._hasResource["dojox.collections.SortedList"]){dojo._hasResource["dojox.collections.SortedList"]=true;dojo.provide("dojox.collections.SortedList");dojox.collections.SortedList=function(_124c){var _124d=this;var items={};var q=[];var _124e=function(a,b){if(a.key>b.key){return 1;}if(a.key<b.key){return -1;}return 0;};var build=function(){q=[];var e=_124d.getIterator();while(!e.atEnd()){q.push(e.get());}q.sort(_124e);};var _124f={};this.count=q.length;this.add=function(k,v){if(!items[k]){items[k]=new dojox.collections.DictionaryEntry(k,v);this.count=q.push(items[k]);q.sort(_124e);}};this.clear=function(){items={};q=[];this.count=q.length;};this.clone=function(){return new dojox.collections.SortedList(this);};this.contains=this.containsKey=function(k){if(_124f[k]){return false;}return (items[k]!=null);};this.containsValue=function(o){var e=this.getIterator();while(!e.atEnd()){var item=e.get();if(item.value==o){return true;}}return false;};this.copyTo=function(arr,i){var e=this.getIterator();var idx=i;while(!e.atEnd()){arr.splice(idx,0,e.get());idx++;}};this.entry=function(k){return items[k];};this.forEach=function(fn,scope){dojo.forEach(q,fn,scope);};this.getByIndex=function(i){return q[i].valueOf();};this.getIterator=function(){return new dojox.collections.DictionaryIterator(items);};this.getKey=function(i){return q[i].key;};this.getKeyList=function(){var arr=[];var e=this.getIterator();while(!e.atEnd()){arr.push(e.get().key);}return arr;};this.getValueList=function(){var arr=[];var e=this.getIterator();while(!e.atEnd()){arr.push(e.get().value);}return arr;};this.indexOfKey=function(k){for(var i=0;i<q.length;i++){if(q[i].key==k){return i;}}return -1;};this.indexOfValue=function(o){for(var i=0;i<q.length;i++){if(q[i].value==o){return i;}}return -1;};this.item=function(k){if(k in items&&!_124f[k]){return items[k].valueOf();}return undefined;};this.remove=function(k){delete items[k];build();this.count=q.length;};this.removeAt=function(i){delete items[q[i].key];build();this.count=q.length;};this.replace=function(k,v){if(!items[k]){this.add(k,v);return false;}else{items[k]=new dojox.collections.DictionaryEntry(k,v);build();return true;}};this.setByIndex=function(i,o){items[q[i].key].value=o;build();this.count=q.length;};if(_124c){var e=_124c.getIterator();while(!e.atEnd()){var item=e.get();q[q.length]=items[item.key]=new dojox.collections.DictionaryEntry(item.key,item.value);}q.sort(_124e);}};}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain_API"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain_API"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain_API");dojo.provide("com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain");dojo.declare("com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain",null,{doFilter:function(_1250,name,_1251,_1252,_1253){}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.DynamicContentFilterChainImpl"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.DynamicContentFilterChainImpl"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.DynamicContentFilterChainImpl");dojo.declare("com.ibm.mm.enabler.runtime.skin.DynamicContentFilterChainImpl",[com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain],{constructor:function(_1254,_1255){this.filters=_1254;this.changing=_1255;this.current=0;},doFilter:function(_1256,name,_1257,_1258,_1259){if(this.current>=this.filters.length){return;}if(this.changing){this.filters[this.current++].onChangingDynamicContent(_1256,name,_1257,_1258,_1259,this);}else{this.filters[this.current++].onChangeDynamicContent(_1256,name,_1257,_1258,this);}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.DynamicContentFilterChain");}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.DynamicContentFilter"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.DynamicContentFilter"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.DynamicContentFilter");dojo.declare("com.ibm.mashups.enabler.runtime.skin.DynamicContentFilter",null,{consturctor:function(){},onChangingDynamicContent:function(_125a,name,_125b,_125c,_125d,_125e){},onChangeDynamicContent:function(_125f,name,_1260,_1261,_1262){}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.SystemStyleFilter"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.SystemStyleFilter"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.SystemStyleFilter");dojo.declare("com.ibm.mm.enabler.runtime.skin.SystemStyleFilter",[com.ibm.mashups.enabler.runtime.skin.StyleFilter],{constructor:function(_1263,_1264,_1265){this.navModel=_1263;this.layoutModel=_1264;this.rsModel=_1265;},onChangingStyle:function(_1266,_1267,_1268,_1269,_126a){_126a.doFilter(_1266,_1267,_1268,_1269);},onChangeStyle:function(_126b,_126c,_126d,_126e){var _126f=com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl.prototype._serializeStyle(_126d);_126b.setMetaData("css-style",_126f);_126e.doFilter(_126b,_126c,_126d);}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.SystemDynamicContentFilter"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.SystemDynamicContentFilter"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.SystemDynamicContentFilter");dojo.declare("com.ibm.mm.enabler.runtime.skin.SystemDynamicContentFilter",null,{onChangingDynamicContent:function(_1270,name,_1271,_1272,_1273,_1274){_1274.doFilter(_1270,name,_1271,_1272,_1273,_1274);},onChangeDynamicContent:function(_1275,name,_1276,_1277,_1278){_1278.doFilter(_1275,name,_1276,_1277);if(!com.ibm.mm.enabler.utils.Misc.isInstanceOf(_1275,com.ibm.mashups.enabler.layout.LayoutControl)||(typeof _1277==="undefined"||null===_1277)||_1276===_1277){return;}var _1279=com.ibm.mashups.enabler.runtime.skin.Factory.getRuntimeSkinModel();var _127a=_1279.findByLayoutNode(_1275);var node=_127a.getDomElementForDynamicContent(name);if(!node){return;}if(name==com.ibm.mashups.enabler.runtime.skin.Constants.DYNAMIC_CONTENT_TITLE){node.innerHTML=_1277;}else{if(name==com.ibm.mashups.enabler.runtime.skin.Constants.DYNAMIC_CONTENT_ICON){node.src=_1277;}}}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl");dojo.require("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel");dojo.declare("com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl",[com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel,com.ibm.mm.enabler.model.ModelImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.nodes=new dojox.collections.Dictionary();var ids=[];this.cursor=0;this.styleChains=new dojox.collections.Dictionary();this.dcChains=new dojox.collections.Dictionary();this.currentPage=null;this.navStateModel=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();this.navModel=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();dojo.subscribe(com.ibm.mm.enabler.layout.LayoutControlImpl.TOPIC_SKIN_SET,this,"_layoutControlChange");this.styleFilters=new dojox.collections.SortedList();this.styleFilters.add(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_FIRST,new dojox.collections.ArrayList());this.styleFilters.add(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_LAST,new dojox.collections.ArrayList());this.styleFilterIDs=new dojox.collections.SortedList();this.dcFilters=new dojox.collections.SortedList();this.dcFilters.add(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_FIRST,new dojox.collections.ArrayList());this.dcFilters.add(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_LAST,new dojox.collections.ArrayList());this.dcFilterIDs=new dojox.collections.SortedList();},getInstance:function(){var _127b=com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl._instance;return _127b?_127b:(com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl._instance=new com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl());},_buildIteratorNodes:function(node,lm){var _127c="buildIteratorNodes(node, lm)";var _127d=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_127d){this.LOGGER.entering(_127c,[node,lm]);}if(typeof node=="undefined"||null===node){if(_127d){this.LOGGER.exiting(_127c);}return;}if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.layout.LayoutControl)||com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.layout.LayoutContainer)){if(_127d){this.LOGGER.trace(_127c,"Adding runtime skin node with id: "+node.getID());}this.nodes.add(node.getID(),new com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl(node,this));this.ids[this.ids.length]=node.getID();}var _127e=lm.getChildren(node);while(_127e.hasNext()){this._buildIteratorNodes(_127e.next(),lm);}if(_127d){this.LOGGER.exiting(_127c);}},iterator:function(){var _127f="iterator()";var _1280=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1280){this.LOGGER.entering(_127f);}this.nodes.clear();this.ids=[];var page=this._getCurrentPage();this.cursor=0;if(page===null){if(_1280){this.LOGGER.exiting(_127f);}return this;}var _1281=this.navModel.getLayoutModel(page);if(_1281===null){if(_1280){this.LOGGER.exiting(_127f);}return this;}var root=_1281.getRoot().start();this._buildIteratorNodes(root,_1281);if(_1280){this.LOGGER.exiting(_127f);}return this;},start:function(sync){},hasNext:function(){return this.size()>this.cursor;},next:function(){if(!this.hasNext()){return null;}var ret=null;var id=this.ids[this.cursor++];ret=this.nodes.entry(id).valueOf()||null;return ret;},size:function(){return this.nodes.count;},setCursorPosition:function(_1282){this.cursor=_1282;},getCursorPosition:function(){return this.cursor;},_getCurrentPage:function(){var _1283="_getCurrentPage()";var _1284=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1284){this.LOGGER.entering(_1283);}var _1285=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(this.navStateModel,null);var _1286=_1285.getPageID();if(_1284){this.LOGGER.trace(_1283,"page id is "+_1286);}if(typeof _1286=="undefined"||null===_1286){if(_1284){this.LOGGER.exiting(_1283,null);}return null;}var node=this.navModel.find(_1286).start();if(_1284){this.LOGGER.exiting(_1283,node);}return node;},_getLayoutModel:function(){var page=this._getCurrentPage();if(null===page){return null;}return this.navModel.getLayoutModel(page);},_hasPageChanged:function(page){if(this.currentPage===null||page.getID()!==this.currentPage.getID()){this.currentPage=page;this.nodes.clear();this.ids=[];return true;}return false;},_isLayoutNodeOnCurrentPage:function(_1287,page){if(typeof _1287=="undefined"||_1287===null){return false;}if(page===null){return false;}var _1288=this.navModel.getLayoutModel(page);if(_1288===null){return false;}var elem=_1288.find(_1287.getID()).start();if(null===elem){return false;}return true;},find:function(id){var _1289="find(id)";var _128a=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_128a){this.LOGGER.entering(_1289,id);}if(typeof id=="undefined"||id===null){return null;}var _128b=this._getLayoutModel();if(null===_128b){if(_128a){this.LOGGER.exiting(_1289,null);}return null;}var _128c=null;var node=_128b.find(id).start();if(null!==node){_128c=this.findByLayoutNode(node);}if(_128a){this.LOGGER.exiting(_1289,_128c);}return _128c;},findByLayoutNode:function(_128d){var _128e="findByLayoutNode(layoutNode)";var _128f=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_128f){this.LOGGER.entering(_128e,_128d);}if(typeof _128d=="undefined"||null===_128d){if(_128f){this.LOGGER.exiting(_128e,null);}return null;}var id=_128d.getID();var page=this._getCurrentPage();this._hasPageChanged(page);if(!this._isLayoutNodeOnCurrentPage(_128d,page)){if(this.nodes.containsKey(id)){this.nodes.remove(id);}if(_128f){this.LOGGER.trace(_128e,id+" is not on the current page");this.LOGGER.exiting(_128e,null);}return null;}if(this.nodes.containsKey(id)){if(_128f){this.LOGGER.trace(_128e,id+" is cached");this.LOGGER.exiting(_128e,this.nodes.entry(id).valueOf());}return this.nodes.entry(id).valueOf();}var _1290=new com.ibm.mm.enabler.runtime.skin.RuntimeSkinNodeImpl(_128d,this);this.nodes.add(id,_1290);this.ids[this.ids.length]=id;if(_128f){this.LOGGER.exiting(_128e,_1290);}return _1290;},_generateFilterId:function(){if(!this._listenerCounter){this._listenerCounter=1;}else{this._listenerCounter++;}return this._listenerCounter;},addStyleFilter:function(_1291,_1292,_1293){var _1294="ordinal, filter, scopeObject";var _1295=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1295){this.LOGGER.entering(_1294,[_1291,_1292,_1293]);}if(!com.ibm.mm.enabler.utils.Misc.isInstanceOf(_1292,com.ibm.mashups.enabler.runtime.skin.StyleFilter)){if(_1295){this.LOGGER.exiting(_1294,-1);}return -1;}var id=this._addFilter(_1291,_1292,_1293,this.styleFilterIDs,this.styleFilters,this.styleChains);if(_1295){this.LOGGER.exiting(_1294,id);}return id;},_addFilter:function(_1296,_1297,_1298,ids,_1299,_129a){var _129b="_addFilter(ordinal, filter, scopeObject, ids, filters)";var _129c=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_129c){this.LOGGER.entering(_129b,[_1296,_1297,_1298,ids,_1299]);}if(typeof _1296!="number"){this.LOGGER.trace(_129b,"ordinal is not a number");this.LOGGER.exiting(_129b,-1);return -1;}var _129d;var _129e=false;if(typeof _1298=="undefined"||null===_1298||!com.ibm.mm.enabler.utils.Misc.isInstanceOf(_1298,com.ibm.mashups.enabler.layout.LayoutNode)){_129d=null;if(_129c){this.LOGGER.trace(_129b,"no scope object");}}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_1298,com.ibm.mashups.enabler.layout.LayoutControl)){_129d=_1298;if(_129c){this.LOGGER.trace(_129b,"scope object is a LayoutControl");}}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(_1298,com.ibm.mashups.enabler.layout.LayoutContainer)){_129d=_1298;_129e=true;if(_129c){this.LOGGER.trace(_129b,"scope object is a LayoutContainer");}}else{_129d=null;if(_129c){this.LOGGER.trace(_129b,"no scope object");}}}}var id=this._generateFilterId();var _129f={id:id,filter:_1297,scope:_129d,isContainer:_129e,ordinal:_1296};var list;if(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_FIRST>=_1296){list=_1299.item(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_FIRST);list.insert(0,_129f);ids.add(id,com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_FIRST);}else{if(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_LAST<=_1296){list=_1299.item(com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_LAST);list.add(_129f);ids.add(id,com.ibm.mashups.enabler.runtime.skin.Constants.ORDINAL_LAST);}else{list=_1299.item(_1296);if(typeof list==="undefined"||null===list){list=new dojox.collections.ArrayList();this.styleFilters.add(_1296,list);}list.add(_129f);ids.add(id,_1296);}}_129a.clear();if(_129c){this.LOGGER.exiting(_129b,id);}return id;},removeStyleFilter:function(_12a0){this._removeFilter(_12a0,this.styleFilterIDs,this.styleFilters,this.styleChains);},_removeFilter:function(_12a1,ids,_12a2,_12a3){var _12a4=ids.item(_12a1);if(typeof _12a4=="undefined"||null===_12a4){return;}var list=_12a2.item(_12a4);if(typeof list!=="undefined"&&null!==list&&0<list.count){var index=-1;var _12a5=0;var _12a6=list.getIterator();while(!_12a6.atEnd()){var _12a7=_12a6.get();if(_12a7.id===_12a1){index=_12a5;break;}_12a5++;}if(index!==-1){list.removeAt(index);_12a3.clear();}}ids.remove(_12a1);},_getStyleFilters:function(){return this.styleFilters;},_determineFilters:function(_12a8,_12a9,_12aa){var _12ab="_determineFilters(layoutNode, filters, chains)";var _12ac=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_12ac){this.LOGGER.entering(_12ab,[_12a8,_12a9,_12aa]);}var page=this._getCurrentPage();if(this._hasPageChanged(page)){if(_12ac){this.LOGGER.trace(_12ab,"page change, clear chain cache");}_12aa.clear();}else{if(_12aa.containsKey(_12a8.getID())){var id=_12a8.getID();if(_12ac){this.LOGGER.trace(_12ab,id+"  chain is cached");this.LOGGER.exiting(_12ab,_12aa.entry(id).valueOf());}return _12aa.entry(id).valueOf();}}var _12ad=this._getLayoutModel();var _12ae=[];for(var i=0;i<_12a9.count;i++){var _12af=_12a9.getByIndex(i).getIterator();while(!_12af.atEnd()){var _12b0=_12af.get();if(typeof _12b0=="undefined"||null===_12b0){continue;}if(_12b0.scope===null){if(_12ac){this.LOGGER.trace(_12ab,"adding filter "+_12b0.id+", no scope");}_12ae[_12ae.length]=_12b0.filter;}else{if(false===_12b0.isContainer&&_12a8.getID()==_12b0.scope.getID()){if(_12ac){this.LOGGER.trace(_12ab,"adding filter "+_12b0.id+", layoutcontrol matches scope");}_12ae[_12ae.length]=_12b0.filter;}else{if(true===_12b0.isContainer&&null!==_12ad&&_12ad.getParent(_12a8).start().getID()==_12b0.scope.getID()){if(_12ac){this.LOGGER.trace(_12ab,"adding filter "+_12b0.id+", layoutcontainer is the scope");}_12ae[_12ae.length]=_12b0.filter;}}}}}_12aa.add(_12a8.getID(),_12ae);if(_12ac){this.LOGGER.exiting(_12ab,_12ae);}return _12ae;},_determineStyleFilters:function(_12b1){var _12b2=this._determineFilters(_12b1,this.styleFilters,this.styleChains);_12b2[_12b2.length]=new com.ibm.mm.enabler.runtime.skin.SystemStyleFilter(this.navModel,this._getLayoutModel(),this);return _12b2;},_determineDynamicContentFilters:function(_12b3){var _12b4=this._determineFilters(_12b3,this.dcFilters,this.dcChains);_12b4[_12b4.length]=new com.ibm.mm.enabler.runtime.skin.SystemDynamicContentFilter(this);return _12b4;},_buildStyleFilterChain:function(_12b5,_12b6){var _12b7=this._determineStyleFilters(_12b5);return new com.ibm.mm.enabler.runtime.skin.StyleFilterChainImpl(_12b7,_12b6);},_buildDCFilterChain:function(_12b8,_12b9){var _12ba=this._determineDynamicContentFilters(_12b8);return new com.ibm.mm.enabler.runtime.skin.DynamicContentFilterChainImpl(_12ba,_12b9);},_layoutControlChange:function(_12bb,noop,oldID,newID){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.RuntimeSkinModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.Factory_API");dojo.provide("com.ibm.mashups.enabler.runtime.skin.Factory");dojo.declare("com.ibm.mashups.enabler.runtime.skin.Factory",null,{getRuntimeSkinModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.runtime.skin.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.runtime.skin.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.runtime.skin.FactoryImpl");dojo.declare("com.ibm.mm.enabler.runtime.skin.FactoryImpl",com.ibm.mashups.enabler.runtime.skin.Factory,{getRuntimeSkinModel:function(){return com.ibm.mm.enabler.runtime.skin.RuntimeSkinModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.runtime.skin.Factory=new com.ibm.mm.enabler.runtime.skin.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.runtime.skin.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.runtime.skin.Factory");}if(!dojo._hasResource["com.ibm.mm.iwidget.manageditemset.IDescriptorExtendedImpl"]){dojo._hasResource["com.ibm.mm.iwidget.manageditemset.IDescriptorExtendedImpl"]=true;dojo.provide("com.ibm.mm.iwidget.manageditemset.IDescriptorExtendedImpl");dojo.declare("com.ibm.mm.iwidget.manageditemset.IDescriptorExtendedImpl",com.ibm.mm.iwidget.manageditemset.IDescriptorDefaultImpl,{_getWindowState:function(){if(this.widget){var _12bc=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(this.navStateModel,this.widget.id);value=_12bc.getWindowState();}else{value="normal";}return value;},_setDynamicTitleOrIcon:function(name,value){var _12bd=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(this.navStateModel,null);var _12be=_12bd.getPageID();var _12bf=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var page=_12bf.find(_12be).start();var lm=_12bf.getLayoutModel(page);var _12c0=lm.find(this.widget.id).start();var _12c1=com.ibm.mashups.enabler.runtime.skin.Factory.getRuntimeSkinModel();var _12c2=_12c1.findByLayoutNode(_12c0);if(name==iwConstants.iDescriptorItems.title){_12c2.setDynamicContent(com.ibm.mashups.enabler.runtime.skin.Constants.DYNAMIC_CONTENT_TITLE,value);}if(name==iwConstants.iDescriptorItems.icon){_12c2.setDynamicContent(com.ibm.mashups.enabler.runtime.skin.Constants.DYNAMIC_CONTENT_ICON,value);}}});com.ibm.mm.iwidget.manageditemset.IDescriptorImpl=com.ibm.mm.iwidget.manageditemset.IDescriptorExtendedImpl;}if(!dojo._hasResource["com.ibm.mm.iwidget.services.ResourceLoadServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.ResourceLoadServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.ResourceLoadServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.ResourceLoadServiceImpl",null,{constructor:function(){this.modules={};this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this.LOADING_TOKEN=0;this.LOADING_ERROR_TOKEN=1;this.LOADED_TOKEN=2;this.waitingqueue={};this.evalqueue={};this.callbackQueue={};var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);if(cs){var _12c3=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.REGISTER_LOADEDRESOURCES);if(_12c3){if(dojo.isString(_12c3)){try{_12c3=dojo.fromJson(_12c3);}catch(e){}}if(dojo.isArray(_12c3)){this.registeredLoadedResources=_12c3;}}}},executeCallbackQueue:function(_12c4){if(this.callbackQueue[_12c4]){var _12c5=this.callbackQueue[_12c4];var _12c6=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_12c4);if(_12c6){for(var i=0;i<_12c5.length;i++){if(_12c5[i]){var scope=_12c6._getHandlerScope(_12c5[i].cb);if(scope){var cb=dojo.hitch(scope,_12c5[i].cb);cb(_12c5[i].id,_12c5[i].src,_12c5[i].status);_12c5[i]=null;}}}}}},loadResource:function(_12c7,_12c8,cb2){var _12c9="loadResource";var _12ca=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_12ca){this.LOGGER.entering(_12c9,arguments);}var _12cb=_12c7.getGlobalId();var uri=_12c7.getSrc();var path=null;if(_12c7.isJS()){path=this._rewriteUrl(uri,_12c8,true);}else{path=this._rewriteUrl(uri,_12c8,false);}if(!_12cb){_12cb=path;}if(!_12cb){return;}this.evalqueue[_12c8]=this.evalqueue[_12c8]?this.evalqueue[_12c8]:[];this.evalqueue[_12c8].push({_id:_12cb,resourceElem:_12c7,cb2:cb2,widgetId:_12c8,isReady:false});var _12cc=_12c7[iwConstants.RESOURCE.skipLoad];if(_12cc){var rc=false;try{rc=dojo.eval(_12cc);}catch(e){rc=false;}if(rc){this._handleLoadedResource(_12cb,_12c8,null,iwConstants.status.OTHER);return;}}var _12cd=this.registeredLoadedResources;if(dojo.isArray(_12cd)){for(var j=0;j<_12cd.length;j++){if(_12cd[j].globalid&&_12cd[j].globalid==_12cb){if(_12cd[j].version){var _12ce=_12c7[iwConstants.RESOURCE.version];if(!_12ce||(_12ce&&_12ce==_12cd[j].version)){this._handleLoadedResource(_12cb,_12c8,null,iwConstants.status.OTHER);return;}}else{this._handleLoadedResource(_12cb,_12c8,null,iwConstants.status.OTHER);return;}}}}var _12cf=this.modules[_12cb];var me=this;if(_12cf&&_12cf!==null){var type=_12cf.type;switch(type){case 0:this.waitingqueue[_12cf._id]=(this.waitingqueue[_12cf._id])?this.waitingqueue[_12cf._id]:[];this.waitingqueue[_12cf._id].push({resourceElem:_12c7,widgetId:_12c8,cb2:cb2});return;case 1:this._handleLoadedResource(_12cb,_12c8,null,_12cf.status,_12cf.data);return;case 2:this._handleLoadedResource(_12cb,_12c8,null,_12cf.status);return;}}_12cf={};_12cf.type=this.LOADING_TOKEN;_12cf._id=_12cb;_12cf._path=path;this.modules[_12cb]=_12cf;if(_12cb!=path){this.modules[path]=this.modules[_12cb];}var _12d0=null;if(_12c7.isCSS()){_12d0=this._loadCSS(path);this.modules[_12cb].type=this.LOADED_TOKEN;this.modules[_12cb].status=iwConstants.status.OTHER;this._handleLoadedResource(_12cb,_12c8,null,iwConstants.status.OTHER);return;}if(_12c7.isImage()){_12d0=this._loadImage(path);this.modules[_12cb].type=this.LOADED_TOKEN;this.modules[_12cb].status=iwConstants.status.OTHER;this._handleLoadedResource(_12cb,_12c8,null,iwConstants.status.OTHER);return;}var _12d1=path;if(dojo.isIE==6&&path.indexOf("/")===0){var _12d2=window.location.protocol;var host=window.location.hostname;var port=window.location.port;_12d1=_12d2+"//"+host+":"+port+path;}var _12d3=com.ibm.mashups.enabler.io.XHRMultipartFactory.create();var _12d4=!_12d3.isTransaction();if(ibmConfig.dojotest){_12d4=true;}var args={url:_12d1,sync:_12d4,load:function(data,_12d5){var _12d6=null;if(_12d5.xhr.status==200||_12d5.xhr.status===0){var _12d7=_12d5.xhr.responseText;_12d6=_12d7.replace(/_IWID_/g,"_"+_12c8+"_");}me.modules[_12cb].type=me.LOADED_TOKEN;me.modules[_12cb].status=iwConstants.status.SUCCESS;me._handleLoadedResource(_12cb,_12c8,_12d6,iwConstants.status.SUCCESS);var queue=me.waitingqueue[_12cb];if(queue){for(var j=0;j<queue.length;j++){var req=queue[j];me._handleLoadedResource(_12cb,req.widgetId,null,iwConstants.status.SUCCESS);}}me.waitingqueue[_12cb]=null;},error:function(data,_12d8){me.modules[_12cb].type=me.LOADING_ERROR_TOKEN;me.modules[_12cb].data=data;me.modules[_12cb].status=_12d8.xhr.status;me._handleLoadedResource(_12cb,_12c8,null,_12d8.xhr.status,data);var queue=me.waitingqueue[_12cb];if(queue){for(var h=0;h<queue.length;h++){var req=queue[h];me._handleLoadedResource(_12cb,req.widgetId,null,_12d8.xhr.status,data);}}me.waitingqueue[_12cb]=null;}};dojo.xhrGet(args);},_rewriteUrl:function(uri,id,isXhr){var _12d9=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(id);return _12d9._rewriteURI(uri,isXhr);},_getExtension:function(uri){return uri.substring(uri.lastIndexOf(".")+1,uri.length);},_loadCSS:function(path){var link=document.createElement("link");link.setAttribute("rel","stylesheet");link.setAttribute("type","text/css");link.setAttribute("href",path);document.getElementsByTagName("head")[0].appendChild(link);},_loadImage:function(path){com.ibm.mm.enabler.utils.Misc.preloadImage(url);},_evalCallback:function(cb,_12da,_12db,_12dc){if(cb){if(dojo.isString(cb)){var _12dd=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_12da);if(_12dd){var scope=_12dd._getHandlerScope(cb);if(scope){cb=dojo.hitch(scope,cb);}}}var id=_12db.getGlobalId();var src=_12db.getSrc();if(!_12dc){_12dc=iwConstants.status.SUCCESS;}if(dojo.isFunction(cb)){dojo.partial(cb)(id,src,_12dc);}else{this.callbackQueue[_12da]=this.callbackQueue[_12da]?this.callbackQueue[_12da]:[];var _12de={cb:cb,id:id,src:src,status:_12dc};this.callbackQueue[_12da].push(_12de);}}},_evalFn:function(_12df){var rc;if(window.execScript){window.execScript(_12df,"JavaScript");rc="";}else{rc=dojo.eval(_12df);}return rc;},_loadedFC:function(_12e0,_12e1,cb2,data,_12e2){var cb=_12e0[iwConstants.RESOURCE.callback];if(cb){this._evalCallback(cb,_12e1,_12e0,_12e2);}if(cb2){var _12e3=com.ibm.mashups.enabler.io.XHRMultipartFactory.create();_12e3.suspendTransaction();if(data&&_12e2){cb2(data,_12e2);}else{cb2();}_12e3.resumeTransaction();}},_handleLoadedResource:function(_12e4,_12e5,_12e6,_12e7,_12e8){var _12e9;var queue=this.evalqueue[_12e5];if(queue){if(queue[0]&&queue[0]._id&&queue[0]._id==_12e4){if(_12e6){this._evalFn(_12e6);}_12e9=queue.shift();this._loadedFC(_12e9.resourceElem,_12e5,_12e9.cb2,_12e8,_12e7);var arr=queue;var _12ea=true;while(_12ea&&queue.length>0){if(queue[0].isReady){var _12eb=queue[0].contents;if(_12eb){this._evalFn(_12eb);}this._loadedFC(queue[0].resourceElem,_12e5,queue[0].cb2,queue[0].statusData,queue[0].status);queue.shift();}else{_12ea=false;}}}else{if(queue[0]&&queue[0]._id&&queue[0]._id!=_12e4){for(var i=0;i<queue.length;i++){_12e9=queue[i];if(_12e9._id&&_12e9._id==_12e4){queue[i].contents=_12e6;queue[i].isReady=true;queue[i].status=_12e7;queue[i].statusData=_12e8;}}}}}}});com.ibm.mashups.services.ServiceManager.setService("resourceLoadService",new com.ibm.mm.iwidget.services.ResourceLoadServiceImpl());}if(!dojo._hasResource["com.ibm.mm.iwidget.WidgetStub"]){dojo._hasResource["com.ibm.mm.iwidget.WidgetStub"]=true;dojo.provide("com.ibm.mm.iwidget.WidgetStub");dojo.declare("com.ibm.mm.iwidget.WidgetStub",null,{constructor:function(_12ec){this._wrapper=_12ec;this.id=_12ec.id;this.publishedEvents=_12ec._getPublishedEvents();this.handledEvents=_12ec._getHandledEvents();this.payloadDefs=_12ec.widgetDef.getPayloadDefs();this.supportedModes=_12ec.widgetDef.getSupportedModes();},getPublishedEventsNames:function(){if(!this.publishedEvents){return null;}var _12ed=[];var _12ee;for(_12ee in this.publishedEvents){if(Object.prototype.hasOwnProperty.call(this.publishedEvents,_12ee)){_12ed.push(_12ee);}}if(_12ed.length===0){return null;}return _12ed;},getHandledEventsNames:function(){if(!this.handledEvents){return null;}var _12ef=[];var _12f0;for(_12f0 in this.handledEvents){if(Object.prototype.hasOwnProperty.call(this.handledEvents,_12f0)){_12ef.push(_12f0);}}if(_12ef.length===0){return null;}return _12ef;},getPublishedEvent:function(_12f1){if(!this.publishedEvents){return null;}return [this.publishedEvents[_12f1]];},getHandledEvent:function(_12f2){if(!this.handledEvents){return null;}return [this.handledEvents[_12f2]];},getPayloadDefs:function(){return this.payloadDefs;},getPayloadDef:function(name){var _12f3=this.payloadDefs[name];if(typeof _12f3=="undefined"){return null;}return _12f3;},getPayloadDefNames:function(){var arr=[];var a;for(a in this.payloadDefs){if(Object.prototype.hasOwnProperty.call(this.payloadDefs,a)){arr.push(a);}}if(arr.length===0){return null;}return arr;},getWires:function(){return this._wrapper.getWires();},getSupportedModes:function(){return this.supportedModes;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.IWidgetMetadataImpl"]){dojo._hasResource["com.ibm.mm.iwidget.IWidgetMetadataImpl"]=true;dojo.provide("com.ibm.mm.iwidget.IWidgetMetadataImpl");dojo.declare("com.ibm.mm.iwidget.IWidgetMetadataImpl",null,{constructor:function(id){this._id=id;this._items={};},CONSTANTS:{"title":"title","icon":"icon"},getItemValue:function(_12f4,_12f5){if(!_12f5){_12f5="en";}if(typeof _12f4=="undefined"||_12f4===null){return null;}if(!this.CONSTANTS[_12f4]){return null;}var _12f6=this._getInternalIWidgetWrapper();if(_12f6===null){return null;}var data=this._items[_12f4][_12f5];if(typeof data=="undefined"||data===null){if(!this._loadData(_12f4,_12f5)){return null;}data=this._items[_12f4][_12f5];}if(data.detail!="undefined"&&data.detail!==null){return data.detail;}else{return null;}},_setItemValue:function(_12f7,value){if(typeof _12f7=="undefined"||_12f7===null||typeof value=="undefined"||value===null){return null;}if(!this.CONSTANTS[_12f7]){return null;}var _12f8=this._getInternalIWidgetWrapper().getIWidgetInstance().getIDescriptorItems();if(!_12f8){return;}_12f8.setItemValue(_12f7,value);},setItemValue:function(_12f9,value,_12fa){if(typeof _12f9=="undefined"||_12f9===null||typeof value=="undefined"||value===null){return null;}if(!this.CONSTANTS[_12f9]){return null;}var _12fb=this._getInternalIWidgetWrapper().getIWidgetInstance().getIDescriptorItems();if(!_12fb){return;}_12fb.setItemValue(_12f9,value,_12fa);},save:function(){com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().commit().start();},_getInternalIWidgetWrapper:function(){if(typeof (this._internalWidgetWrapper)=="undefined"||this._internalWidgetWrapper===null){var _12fc=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().getWidgetById(this._id);if(typeof _12fc=="undefined"||_12fc===null){return null;}this._internalWidgetWrapper=_12fc;}return this._internalWidgetWrapper;},_loadData:function(_12fd,_12fe){if(!_12fe){_12fe="en";}var rc=false;var _12ff={};var _1300=this._getInternalIWidgetWrapper().getIWidgetInstance().getIDescriptorItems();if(_1300&&_1300.getItemValue(_12fd,_12fe)){var _1301=dojo.toJson(_1300.getItemValue(_12fd,_12fe));_12ff.isDirty=true;_12ff.detail=dojo.fromJson(_1301);rc=true;}else{_12ff.detail={};_12ff.detail.itemName=_12fd;_12ff.isDirty=false;}this._items[_12fd][_12fe]=_12ff;return rc;},_updateMarkup:function(_1302){var _1303=_1302.itemName;var _1304=_1302.defaultValue;var node;var _1305=com.ibm.mashups.services.ServiceManager.getService("iwidgetFragmentService");var _1306=_1305.getItemSet(this._id,iwConstants.IDESCRIPTOR);if(!_1306){node=_1305.createItemSet(iwConstants.IDESCRIPTOR);var _1307=dojo.byId(this._id);_1307.insertBefore(node,_1307.firstChild.nextSibling);_1306=_1305.getItemSet(this._id,iwConstants.IDESCRIPTOR);}var _1308=_1305.getItem(_1306,_1303);if(!_1308){node=_1305.createItem(_1303,_1304);_1306.appendChild(node);}else{_1308.innerHTML=_1304;}this._getInternalIWidgetWrapper().getIWidgetInstance().loadItemSets();}});}if(!dojo._hasResource["com.ibm.mm.iwidget.IWidgetWrapperImpl"]){dojo._hasResource["com.ibm.mm.iwidget.IWidgetWrapperImpl"]=true;dojo.provide("com.ibm.mm.iwidget.IWidgetWrapperImpl");dojo.declare("com.ibm.mm.iwidget.IWidgetWrapperImpl",null,{constructor:function(id){this.id=id;},getiWidgetMetadata:function(){return new com.ibm.mm.iwidget.IWidgetMetadataImpl(this.id);},getInstanceAttributes:function(){var _1309=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().getWidgetById(this.id);if(typeof _1309=="undefined"||_1309===null){return null;}_1309.getIWidgetInstance().loadItemSets();var _130a=_1309.getIWidgetInstance()._getAttributes();var _130b=new com.ibm.mm.iwidget.itemset.DefaultItemSetImpl();for(var _130c in _130a){if(Object.prototype.hasOwnProperty.call(_130a,_130c)){var _130d=_130a[_130c].defaultLocale;var _130e=_130a[_130c].values[_130d];_130b.setItemValue(_130c,_130e,false);}}return _130b;}});}if(!dojo._hasResource["com.ibm.mm.iwidget.services.QueryServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.QueryServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.QueryServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.QueryServiceImpl",null,{getiWidgetWrapperById:function(id){var _130f=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().getWidgetById(id);if(typeof _130f=="undefined"||_130f===null){return null;}return new com.ibm.mm.iwidget.IWidgetWrapperImpl(id);},getWidgetById:function(id,obj,cb){var _1310=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().getWidgetById(id);if(typeof _1310=="undefined"||_1310===null){return null;}if(!obj||!cb){if(_1310.isLoaded()){return new com.ibm.mm.iwidget.WidgetStub(_1310);}else{return null;}}var cbn=function(_1311,obj,cb){obj[cb](new com.ibm.mm.iwidget.WidgetStub(_1311));};if(_1310.isLoaded()){cbn(_1310,obj,cb);}else{com.ibm.mashups.services.ServiceManager.getService("eventService").subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+id,null,function(){var _1312=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(id);cbn(_1312,obj,cb);});}},getWidgetsByDefUrl:function(url){var arr=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().widgetArr;for(var id in arr){if(Object.prototype.hasOwnProperty.call(arr,id)){var _1313=arr[id];if(_1313&&_1313!==null){var _1314=_1313.getIWidgetInstance().widgetXMLUrl;if(typeof _1314!="undefined"&&_1314!==null&&url==_1314){arr.push(id);}}}}return arr;}});com.ibm.mashups.services.ServiceManager.setService("queryService",new com.ibm.mm.iwidget.services.QueryServiceImpl());}if(!dojo._hasResource["com.ibm.mm.enabler.logging.LegacyLoggerStatus"]){dojo._hasResource["com.ibm.mm.enabler.logging.LegacyLoggerStatus"]=true;dojo.provide("com.ibm.mm.enabler.logging.LegacyLoggerStatus");dojo.declare("com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusType",null,{constructor:function(id,_1315,_1316,_1317,_1318){this._id=id;this._styleClass=_1315;this._iconPath=_1316;this._iconAlt=_1317;this._color=_1318;}});dojo.declare("com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusMessage",null,{constructor:function(type,_1319,_131a){this._type=type;this._message=_1319;this._details=_131a;},render:function(_131b){var _131c=com.ibm.mm.enabler.logging.LegacyLoggerStatus.statusTypesMap.getStatusType(this._type);var msg=[];msg[msg.length]="<div class=\"lotusMessage";if(this._type==="warn"){msg[msg.length]=" lotusWarning";}if(this._type==="info"){msg[msg.length]=" lotusInfo";}msg[msg.length]="\" style=\"margin:15px;\">";msg[msg.length]="<div class=\"";if(this._type==="error"){msg[msg.length]="lotusMessageIcon";}if(this._type==="warn"){msg[msg.length]="lotusWarningIcon";}if(this._type==="info"){msg[msg.length]="lotusInfoIcon";}msg[msg.length]="\" title=\""+_131c._iconAlt+"\">";msg[msg.length]="</div>";var _131d=this._message;if(this._type==="error"){var split=_131d.split(":");var _131e=split.shift()+":";_131d=split.join(":");msg[msg.length]="<div class=\"lotusMessageCode\">";msg[msg.length]=_131e;msg[msg.length]="</div>";}msg[msg.length]="<div class=\"lotusMessageText\">";msg[msg.length]=_131d;msg[msg.length]="</div>";if(this._details&&this._details.length>0){msg[msg.length]="<div class=\"lotusMessageSubText\">";msg[msg.length]=this._details;msg[msg.length]="</div>";}msg[msg.length]="</div>";_131b.innerHTML=msg.join("");}});dojo.declare("com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusTypesMap",null,{constructor:function(){this._baseURL=new dojo.moduleUrl("com.ibm.mm.enabler","image/");this.constants={"ERROR":"error","WARN":"warn","INFO":"info"};this.internalStatusTypeMap=null;},getStatusType:function(type){if(this.internalStatusTypeMap===null){var iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");this.internalStatusTypeMap={};this.internalStatusTypeMap.error=new com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusType(0,"error",this._baseURL+"error.gif",iwStr.ERROR,"#FF0000");this.internalStatusTypeMap.warn=new com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusType(1,"warning",this._baseURL+"warning.gif",iwStr.WARNING,"FFFF00");this.internalStatusTypeMap.info=new com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusType(2,"info",this._baseURL+"info.gif",iwStr.INFO,"#0077FF");}return this.internalStatusTypeMap[type];}});com.ibm.mm.enabler.logging.LegacyLoggerStatus.statusTypesMap=new com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusTypesMap();}if(!dojo._hasResource["com.ibm.mm.enabler.logging.LegacyLogger"]){dojo._hasResource["com.ibm.mm.enabler.logging.LegacyLogger"]=true;dojo.provide("com.ibm.mm.enabler.logging.LegacyLogger");com.ibm.mm.enabler.logging.LegacyLogger.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.enabler.logging.LegacyLogger");com.ibm.mm.enabler.logging.LegacyLogger.Constants={MMLogging:"/mm/logging",MMStatusMsg:"/mm/statusMsg",MMTracing:"/mm/tracing",LOG:"log",INFO:"info",WARN:"warn",ERROR:"error"};com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments=function(args){if(args.length==1){return null;}var _131f=[];for(var i=1;i<args.length;i++){_131f[i-1]=args[i];}return _131f;};com.ibm.mm.enabler.logging.LegacyLogger.log=function(_1320){var _1321=com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments(arguments);var msg=com.ibm.mm.enabler.logging.LegacyLogger.LOGGER._getMessageString(_1321);com.ibm.mm.enabler.logging.LegacyLogger.LOGGER.trace(_1320,msg);};com.ibm.mm.enabler.logging.LegacyLogger.entry=function(_1322){var _1323=com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments(arguments);com.ibm.mm.enabler.logging.LegacyLogger.LOGGER.entering(_1322,_1323);};com.ibm.mm.enabler.logging.LegacyLogger.exit=function(_1324){var _1325=com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments(arguments);com.ibm.mm.enabler.logging.LegacyLogger.LOGGER.exiting(_1324,_1325);};com.ibm.mm.enabler.logging.LegacyLogger.escapeXmlForHTMLDisplay=function(_1326){_1326=_1326.replace(/</g,"&lt;");_1326=_1326.replace(/>/g,"&gt;");return _1326;};com.ibm.mm.enabler.logging.LegacyLogger.info=function(_1327){var _1328=com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments(arguments);var msg=com.ibm.mm.enabler.logging.LegacyLogger.LOGGER._getMessageString(_1328);com.ibm.mm.enabler.logging.LegacyLogger.LOGGER.info(_1327,msg);};com.ibm.mm.enabler.logging.LegacyLogger.warn=function(_1329){var _132a=com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments(arguments);var msg=com.ibm.mm.enabler.logging.LegacyLogger.LOGGER._getMessageString(_132a);com.ibm.mm.enabler.logging.LegacyLogger.LOGGER.warning(_1329,msg);};com.ibm.mm.enabler.logging.LegacyLogger.error=function(_132b){var _132c=com.ibm.mm.enabler.logging.LegacyLogger.getObjectArryFromArguments(arguments);var msg=com.ibm.mm.enabler.logging.LegacyLogger.LOGGER._getMessageString(_132c);com.ibm.mm.enabler.logging.LegacyLogger.LOGGER.severe(_132b,msg);};com.ibm.mm.enabler.logging.LegacyLogger._log=function(type,args){if(com.ibm.mm.enabler.logging.LegacyLogger.isLogging){if(args.length>=2&&dojo.isString(args[1])){var arr=[];arr.push(args[0]+args[1]);for(var i=2;i<args.length;i++){arr.push(args[i]);}console[type].apply(window.console,arr);}else{console[type].apply(window.console,args);}}};com.ibm.mm.enabler.logging.LegacyLogger._publishTracing=function(type,args){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.allowPublishTracing===true){var a={};a.type=type;a.args=args;var temp=[];temp[0]=a;dojo.publish(com.ibm.mm.enabler.logging.LegacyLogger.Constants.MMTracing,temp);}};com.ibm.mm.enabler.logging.LegacyLogger._publishLogging=function(type,args){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.allowPublishLogging===true){var a={};a.type=type;a.args=args;var temp=[];temp[0]=a;dojo.publish(com.ibm.mm.enabler.logging.LegacyLogger.Constants.MMLogging,temp);}};if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.isDebug===true){com.ibm.mm.enabler.logging.LegacyLogger.isLogging=true;}else{com.ibm.mm.enabler.logging.LegacyLogger.isLogging=false;}com.ibm.mm.enabler.logging.LegacyLogger.logInlineMessage=function(_132d,type,_132e,_132f,_1330){var _1331=new com.ibm.mm.enabler.logging.LegacyLoggerStatus.StatusMessage(type,_132e,_132f);if(_132d){_1331.render(_132d);}com.ibm.mm.enabler.logging.LegacyLogger._publishStatusMsg(type,_132e,_132f,_1330);};com.ibm.mm.enabler.logging.LegacyLogger._publishStatusMsg=function(type,_1332,_1333,args,_1334){if(typeof ibmConfig!="undefined"&&ibmConfig!==null&&ibmConfig.allowPublishStatusMsg===true){var a={};a.type=type;a.args=args;a.message=_1332;a.details=_1333;a.component=_1334;var temp=[];temp[0]=a;dojo.publish(com.ibm.mm.enabler.logging.LegacyLogger.Constants.MMStatusMsg,temp);}};}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetWrapperStubImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetWrapperStubImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetWrapperStubImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetWrapperStubImpl",null,{PREFIX_STUB:"_stub_",getID:function(){return this.id;},getIWidgetInstance:function(){if(this.widgetInstance){return this.widgetInstance;}this.widgetInstance=new com.ibm.mm.iwidget.widget.IWidgetInstanceImpl(this.rootElement,this.id);return this.widgetInstance;},setIWidgetDefinition:function(_1335){this.widgetDef=_1335;},getIWidgetDefinition:function(){if(this.loaded){return new com.ibm.mm.iwidget.DeferredLoadImpl(this.getIWidgetInstance().widgetXMLUrl,this.id,this.widgetDef);}else{return new com.ibm.mm.iwidget.DeferredLoadImpl(this.getIWidgetInstance().widgetXMLUrl,this.id);}},getMarkup:function(){return new com.ibm.mm.iwidget.DeferredLiveTextUnprocessStubImpl(this);},doRender:function(){try{this.subHandler={};this.eventSvr=com.ibm.mashups.services.ServiceManager.getService("eventService");var _1336=this.eventSvr.subscribeEvent(this.eventSvr.WIDGETEVENT_PREFIX+this.PREFIX_STUB+this.id,this,"handleEvent");this.subHandler[this.PREFIX_STUB+this.id]=[];this.subHandler[this.PREFIX_STUB+this.id].push(_1336);var _1337=this._getInstanceMarkup();var aMode=this._getDefaultMode();if(!aMode){aMode=iwConstants.mode_view;}this.currentMode=aMode;if(this._handleSaveMode){this._handleSaveMode();}var _1338=document.createElement("div");_1338.className=this.ns+"Content";this.rootElement.appendChild(_1338);var _1339=this.rootElement.lastChild;dojo.addClass(_1339,this.currentMode);_1339.visibility="hidden";this.windowManager[this.currentMode]={id:this.id,root:_1339,active:true,main:true};var _133a=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _133b=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_133a,this.id);var _133c=null;if(_133b){_133c=_133b.getWidgetState("cp");}this._createIframe(_1337,_1339,this.id,"false",this,_133c);}catch(e){var _133d=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);_133d.severe("doRender","widget:"+this.id+" Creating iframe Exception:"+e);}},destroy:function(){this.eventSvr._getHubAdapter(this.id).returnSubDomain(this._getSubDomain());var _133e=this.getIWidgetInstance().getWireModel();var _133f=null;if(_133e){_133f=_133e.getTargets();}if(_133f){var _1340=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();for(var i in _133f){if(Object.prototype.hasOwnProperty.call(_133f,i)){var _1341=_1340.find(i);if(_1341){var wires=_1341.getIWidgetInstance().getWireModel();wires.removeWire(this.id);_1341.commit();}}}}for(var i2 in this.subHandler){if(Object.prototype.hasOwnProperty.call(this.subHandler,i2)){for(var j in this.subHandler[i2]){if(Object.prototype.hasOwnProperty.call(this.subHandler[i2],j)){this.eventSvr.unsubscribeEvent(this.subHandler[i2][j]);}}}}this.eventSvr._getHubAdapter(this.id).removeIframeHubContainer(this.id);if(this.windowManager){this.windowManager=null;}},update2:function(span){return;},_getParent:function(){if(!this.parent){this.parent=com.ibm.mm.iwidget.Utils.getWidgetParent(this.rootElement);}this.parent=this.parent||null;return this.parent;},_setParent:function(_1342){this.parent=_1342;},_getPublishedEvents:function(){var _1343=this.getWidgetPublishedEvents();var arr={};if(dojo.isArray(_1343)){for(var i=0,l=_1343.length;i<l;i++){arr[_1343[i].name]=_1343[i];}}return arr;},_getHandledEvents:function(){var _1344=this.getWidgetHandledEvents();var arr={};if(dojo.isArray(_1344)){for(var i=0,l=_1344.length;i<l;i++){arr[_1344[i].name]=_1344[i];}}return arr;},getWidgetPublishedEvents:function(){var _1345=this._getPublicEvents();if(_1345){var _1346={};_1346.isPublished="true";return _1345.getEvents(_1346);}return null;},getWidgetHandledEvents:function(){var _1347=this._getPublicEvents();if(_1347){var _1348={};_1348.isHandled="true";return _1347.getEvents(_1348);}return null;},getWires:function(){return this.getIWidgetInstance().getWires();},_getInstanceMarkup:function(){return this.getIWidgetInstance()._getInstanceMarkup();},handleEvent:function(_1349){var scope=_1349.scope;if(scope){if(scope=="instance"){scope=this.getIWidgetInstance();}else{if(scope=="eventmodel"){scope=this._getPublicEvents();}}}else{scope=this;}var _134a=_1349.methodname;if(_134a&&scope[_134a]&&dojo.isFunction(scope[_134a])){scope[_134a].apply(scope,_1349.params);}},_handleOnModeChange:function(_134b){var _134c=false;var _134d=this.currentMode;if(!_134b){return false;}if(dojo.isString(_134b)){_134b=dojo.fromJson(_134b);}if(!_134b){return false;}var _134e=_134b.newMode||null;var _134f=_134b.rootElementId||null;if(_134e!==null&&_134e==this.currentMode){return false;}if(_134e===null){return false;}var _1350={};var _1351=this.windowManager[this.currentMode];if(_1351&&_1351.main&&_134f===null){_1350.methodname="_handleOnModeChange";_1350.params=[_134e];this.eventSvr._publishEvent("widgetevents."+this.id,_1350);return;}if(_1351&&_1351.main&&_134f!==null){var _1352=this._getInstanceMarkup();_1352=this._getInstanceMarkupForMode(_1352,_134e);this._createIframe(_1352,_134f,this.id+"_"+_134e,"true",this);_134d=this.currentMode;this.currentMode=_134e;if(this._handleSaveMode){this._handleSaveMode();}this.windowManager[this.currentMode]={id:this.id+"_"+_134e,root:_134f,active:true,main:false};_1350.methodname="_handleOnModeUpdated";_1350.params=[_134e];this.eventSvr._publishEvent("widgetevents."+this.id,_1350);dojo.publish(iwConstants.EVENTS.modeChanged,[this.id,_134d,_134e]);_134b={};_134b.id=this.id;_134b.oldMode=_134d;_134b.newMode=_134e;this.eventSvr._publishEvent(com.ibm.mashups.iwidget.Constants.WIDGET_MODECHANGED,_134b,this.hubId);return;}var _1353=this.windowManager[_134e];if(_1353&&_1353.main){_1350={};_1350.methodname="_handleOnModeChange";_1350.params=[_134e];try{this.eventSvr._publishEvent("widgetevents."+this.id,_1350);}catch(e1){console.log("catching exception!!!"+e1);}this.eventSvr._getHubAdapter(this.id).removeIframeHubContainer(this.id+"_"+this.currentMode);try{var x=this.id+"_"+this.currentMode;for(var j in this.subHandler[x]){if(Object.prototype.hasOwnProperty.call(this.subHandler[x],j)){this.eventSvr.unsubscribeEvent(this.subHandler[x][j]);}}}catch(e2){console.log("IWidgetWrapperStub:_handleOnModeChange unsubscribe exception:"+e2);}delete this.windowManager[this.currentMode];_134d=this.currentMode;this.currentMode=_134e;if(this._handleSaveMode){this._handleSaveMode();}dojo.publish(iwConstants.EVENTS.modeChanged,[this.id,_134d,_134e]);_134b={};_134b.id=this.id;_134b.oldMode=_134d;_134b.newMode=_134e;this.eventSvr._publishEvent(com.ibm.mashups.iwidget.Constants.WIDGET_MODECHANGED,_134b,this.hubId);}return;},commit:function(_1354){var _1355=this.getIWidgetInstance();var _1356=_1355.getAttributes();var _1357=_1355.getIDescriptorItems();var _1358=_1355.getWireModel();var _1359={};if(_1356&&_1356._isDirty()){_1359.attributes=_1356;}if(_1357&&_1357._isDirty()){_1359.idescriptors=_1357;}if(_1358&&_1358.isDirty()){_1359.wiremodel=_1358.toJson();}if(!_1354){this.eventSvr._publishEvent(this.eventSvr.WIDGETEVENT_PREFIX+this.id,{"methodname":"_handleDataSync","params":[_1359]},this.id);}if(_1356&&_1356._isDirty()){this._writePropertiesToDOM(this,"attributes",_1356);_1356._setDirty(false);}if(_1357&&_1357._isDirty()){this._writePropertiesToDOM(this,"idescriptor",_1357);_1357._setDirty(false);}if(_1358&&_1358.isDirty()){_1358.commit();}},getPublicEvent:function(name){var _135a=this._getPublicEvents();return _135a.find(name);},_getInstanceMarkupForMode:function(_135b,mode){var _135c=document.createElement("div");_135c.innerHTML=_135b;var root=_135c.firstChild;root.id=this.id;var _135d=dojo.query("span."+this.ns+"ItemSet[title=\""+iwConstants.IDESCRIPTOR+"\"]",root);var _135e=null;if(_135d.length===0){_135e=document.createElement("span");_135e.className=this.ns+"ItemSet";_135e.title=iwConstants.IDESCRIPTOR;_135e.style.display="none";_135e.style.visibility="hidden";root.appendChild(_135e);}else{_135e=_135d[0];}var items=dojo.query("."+this.ns+"Item[href=\"#"+"mode"+"\"]",_135e);for(var i=0,l=items.length;i<l;i++){var item=items[i];if(_135e==item.parentNode){_135e.removeChild(item);}}var _135f=document.createElement("a");_135f.className=this.ns+"Item";_135f.style.visibility="hidden";_135f.style.display="none";_135f.href="#"+"mode";_135f.appendChild(document.createTextNode(mode));_135e.appendChild(_135f);return _135c.innerHTML;},_createIframe:function(_1360,root,id,_1361,_1362,_1363){var that=_1362;var _1364=_1362.getCSSUrl();_1362.subHandler[id]=[];function eventCallback(_1365){if(_1362.isLoaded()&&_1361&&_1361=="false"){_1362.loaded=false;_1360=_1362._getInstanceMarkup();}var obj={"html":_1360,"xml":that.widgetDef.widgetDef,"isModal":_1361,"hubId":id,"cssUrl":_1364};if(_1363){obj.stateData=_1363;}if(!(_1361&&_1361=="false")){var _1366=id.slice(0,id.lastIndexOf("_"));var _1367=that.eventSvr._getHubAdapter().getContainer(_1366,true);_1366=_1367.getIframe().id;obj.mainframeId=_1366;}that.eventSvr._publishEvent(that.eventSvr.WIDGETEVENT_PREFIX+id+"."+"onWidgetLoading",obj);var _1368=that.eventSvr.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+id,null,function(_1369){if(_1361=="false"){that.loaded=true;dojo.query("."+that.ns+"loading",that.rootElement).forEach(function(elem){com.ibm.mm.enabler.utils.Dom.destroyNode(elem);});dojo.query("."+that.currentMode,that.rootElement).style({"visibility":""});}});that.subHandler[id].push(_1368);var _136a=that.eventSvr.subscribeEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+that.id,that,"handleSizeChanged");that.subHandler[id].push(_136a);};var _136b=_1362.eventSvr.subscribeEvent(_1362.eventSvr.WIDGETEVENT_PREFIX+id+"."+"onFrameLoaded",null,eventCallback);_1362.subHandler[id].push(_136b);var _136c=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var url=window.location.protocol;var host=window.location.hostname;var _136d=_136c.getValue(_136c.SERVERDOMAIN);if(_136d&&_136d!="null"){host=_136d;}var port=window.location.port;var path=window.location.pathname;var _136e=_136c.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);var _136f=null;if(path.indexOf(_136e)>0){_136f=path.slice(0,path.indexOf(_136e));}if(_1362._getSubDomain()){var _1370=_1362._getSubDomain()+"."+host;if(port!=""){url+="//"+_1370+":"+port;}else{url+="//"+_1370;}if(_136f){url+=_136f;}url+=_136c.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT_ENABLER);url+="/widgetsandbox";_1362.eventSvr._getHubAdapter().createIframeHubContainer(id,root,url,_1361,null,null,dojo.hitch(this,"_onSecurityAlert"));}else{var _1371=_1362.eventSvr._getHubAdapter().getSubDomainSize();var _1372=unescape(_1362.getIWidgetInstance().getIDescriptorItems().getItemValue("title",dojo.locale));if(!_1372){_1372=_1362.getID();}var _1373=_136c.getValue(com.ibm.mashups.enabler.services.ConfigConstants.SUBDOMAINREUSE);var fmt=_1362.iwMessages.E_SUBDOMAIN_NOTAVAILABLE1_2;if(_1373){fmt=_1362.iwMessages.E_SUBDOMAIN_NOTAVAILABLE_2;}var _1374=dojo.string.substitute(fmt,[_1372,_1371]);var nodes=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",_1362.ns+"loading",_1362.rootElement,nodes,false);if(nodes.length>0){aNode=nodes[0];aNode.innerHTML="";com.ibm.mm.enabler.logging.LegacyLogger.logInlineMessage(aNode,"error",_1374);}}},_onSecurityAlert:function(_1375,_1376){if(_1376&&_1376=="OpenAjax.hub.SecurityAlert.FramePhish"){var me=this;setTimeout(function(){me._handleIframeMove(_1375);},0);}else{this.LOGGER.trace("_onSecurityAlert","securityAlert:"+_1376);}},_handleIframeMove:function(_1377){this.eventSvr._getHubAdapter(this.id).returnSubDomain(this._getSubDomain());var _1378=this.windowManager[this.currentMode];var id=_1378.id;var root=_1378.root;try{for(var j in this.subHandler[id]){if(Object.prototype.hasOwnProperty.call(this.subHandler[id],j)){this.eventSvr.unsubscribeEvent(this.subHandler[id][j]);}}}catch(e){this.LOGGER.trace("_handleIframeMove","FramePHishing"+" error:"+e.message);}this.eventSvr._getHubAdapter(id).removeIframeHubContainer(id);var _1379=this._getInstanceMarkup();this._createIframe(_1379,root,id,"false",this);},_getSubDomain:function(){if(!this.subDomain){this.subDomain=this.eventSvr._getHubAdapter().getSubDomain();}return this.subDomain;},_handleDataSync:function(_137a){if(_137a&&_137a.attributes){var _137b=_137a.attributes;this._syncModifiableProperties(_137b,this.getIWidgetInstance().getAttributes());}if(_137a&&_137a.wiremodel){var _137c=_137a.wiremodel;this._syncWireModel(_137c,this.getIWidgetInstance().getWireModel());}this.commit(true);},_syncWireModel:function(_137d,_137e){var wires=_137d._wires;for(var i in wires){if(Object.prototype.hasOwnProperty.call(wires,i)){var aWire=wires[i];if(aWire._isDirty&&aWire._type&&aWire._type=="NEW"){_137e.addWire(aWire.SourceWidget,aWire.SourceEvent,aWire.TargetEvent);}else{if(aWire._isDirty&&aWire._type&&aWire._type=="DELETE"){_137e.removeWire(aWire.SourceWidget,aWire.SourceEvent,aWire.TargetEvent);}}}}var _137f=_137d._targets;_137e._targets=_137f;},_syncModifiableProperties:function(_1380,_1381){_1381._updateProperties(_1380);},handleSizeChanged:function(_1382){var _1383=this.windowManager[this.currentMode];var id=this.id;if(!_1383.main){id=this.id+"_"+this.currentMode;}var root=_1383.root;var _1384=root.childNodes[0];if(_1382.newWidth){var width=parseInt(_1382.newWidth,10);width=width-5;dojo.style(_1384,"width",width+"px");}if(_1382.newHeight){var _1385=parseInt(_1382.newHeight,10);_1385=_1385-5;dojo.style(_1384,"height",_1385+"px");}this.eventSvr._publishEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+id,_1382);},getCSSUrl:function(){var that=this;if(this.themeCSS){return this.themeCSS;}dojo.forEach(document.getElementsByTagName("link"),function(_1386){if(_1386.href&&_1386.href.indexOf("theme.css")!=-1){var _1387=_1386.href.length-9;if(_1386.href.indexOf("theme.css")==_1387){that.themeCSS=_1386.href;}}else{if(_1386.href&&_1386.href.indexOf("theme_rtl.css")!=-1){var _1388=_1386.href.length-13;if(_1386.href.indexOf("theme_rtl.css")==_1388){that.themeCSS=_1386.href;}}}});return this.themeCSS;},_handleOnNavStateChanged:function(_1389){var state=_1389.payload;if(state){var _138a=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _138b=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_138a,this.id);_138b.setWidgetState("cp",state);var _138c=_138a.commit();_138c.start();}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogNode"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogNode"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.CatalogNode");dojo.declare("com.ibm.mashups.enabler.catalog.CatalogNode",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableLocalized],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogEntryNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogEntryNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.CatalogEntryNode_API");dojo.provide("com.ibm.mashups.enabler.catalog.CatalogEntryNode");dojo.declare("com.ibm.mashups.enabler.catalog.CatalogEntryNode",[com.ibm.mashups.enabler.catalog.CatalogNode,com.ibm.mashups.enabler.ModifiableMetaData],{getDefinitionURL:function(_138d){},getIconURL:function(_138e){},getPreviewThumbnailURL:function(_138f){},getPreviewURL:function(_1390){},getHelpURL:function(_1391){},setDefinitionURL:function(url){},confirmSetDefinitionURL:function(url){},setIconURL:function(url){},confirmSetIconURL:function(url){},setPreviewThumbnailURL:function(url){},confirmSetPreviewThumbnailURL:function(url){},setPreviewURL:function(url){},confirmSetPreviewURL:function(url){},setHelpURL:function(url){},confirmSetHelpURL:function(url){},getShortDescription:function(_1392){},setShortDescription:function(desc,_1393){}});}if(!dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl");dojo.declare("com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl",[com.ibm.mashups.enabler.catalog.CatalogEntryNode,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.MetaDataImpl2,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.ac.EffectiveAccessImpl,com.ibm.mm.enabler.TransformableImpl],{constructor:function(node){this.xmlData=node;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CATALOG);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ceni_ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_XSI,nsf.NS_XML,nsf.NS_OPENSEARCH]));this.NLS_SHORT_DESCRIPTION="atom:content/*/model:shortDescription/base:nls-string";this.NLS_SHORT_DESCRIPTION_TOP="atom:content/*/model:shortDescription";this.BASE_SHORT_DESCRIPTION="base:nls-string";},getDefinitionURL:function(_1394){return this._getURL("definition",_1394);},setDefinitionURL:function(aUrl){this._setURL("definition",aUrl);},confirmSetDefinitionURL:function(aUrl){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},getIconURL:function(_1395){var _1396=this._getURL("icon",_1395);return _1396;},setIconURL:function(aUrl){this._setURL("icon",aUrl);},confirmSetIconURL:function(aUrl){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},getPreviewThumbnailURL:function(_1397){return this._getURL("previewThumbnail",_1397);},setPreviewThumbnailURL:function(aUrl){this._setURL("previewThumbnail",aUrl);},confirmSetPreviewThumbnailURL:function(aUrl){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},getPreviewURL:function(_1398){var pUrl=this._getURL("preview",_1398);return pUrl;},setPreviewURL:function(aUrl){this._setURL("preview",aUrl);},confirmSetPreviewURL:function(aUrl){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},getHelpURL:function(_1399){var hUrl=this._getURL("help",_1399);return hUrl;},setHelpURL:function(aUrl){this._setURL("help",aUrl);},confirmSetHelpURL:function(aUrl){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},getShortDescription:function(_139a){var _139b=null;_139a.replace(/-/g,"_");var _139c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_SHORT_DESCRIPTION,this.xmlData,this.li_ns);if(_139c){for(var i=0;i<_139c.length;i++){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_139c[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_")==_139a){_139b=com.ibm.mm.enabler.utils.Dom.textContent(_139c[i]);break;}}}return _139b;},setShortDescription:function(descr,_139d){_139d.replace(/-/g,"_");var _139e=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_SHORT_DESCRIPTION,this.xmlData,this.li_ns);var _139f=false;var i=_139e.length;while(--i>=0){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_139e[i],"xml:lang","lang",com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaceUri("xml"));if(lang!==null&&lang.replace(/-/g,"_")==_139d){com.ibm.mm.enabler.utils.Dom.textContent(_139e[i],descr);_139f=true;break;}}if(!_139f){var _13a0=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.NLS_SHORT_DESCRIPTION_TOP,this.xmlData,this.li_ns);if(_13a0&&_13a0.length>0){var _13a1=this.xmlData.ownerDocument;var node=com.ibm.mm.enabler.utils.Dom.createElement(_13a1,this.BASE_SHORT_DESCRIPTION,this.BASE_NS);node.setAttribute("xml:lang",_139d);com.ibm.mm.enabler.utils.Dom.textContent(node,descr);_13a0[0].appendChild(node);}else{throw new Error(dojo.string.substitute(this.modelMessages.E_ELEMENT_NOT_FOUND_2,[this.NLS_SHORT_DESCRIPTION_TOP,this.toString()]));}}this._setDirty();},confirmSetShortDescription:function(descr,_13a2){return this.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR);},_getURL:function(rel,_13a3){var _13a4=null;var expr="atom:content/model:catalog-entry/atom:link[@ext:rel='"+rel+"']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ceni_ns);if(nodes&&nodes.length>0){_13a4=nodes[0].getAttribute("href");}var ret=_13a4;if(_13a3!==false){var ret2=com.ibm.mm.enabler.EndpointUtils.checkForEndpoints(_13a4);ret2=ret2||null;if(ret2!==null){ret=ret2;}}return ret;},_setURL:function(rel,href){var expr="atom:content/model:catalog-entry/atom:link[@ext:rel='"+rel+"']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ceni_ns);if(nodes&&nodes.length>0){nodes[0].setAttribute("href",href);this._setDirty();}},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogEntryNode"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogEntryNode"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.CatalogEntryNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.CatalogEntryModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.CatalogEntryModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.CatalogEntryModel_API");dojo.provide("com.ibm.mashups.enabler.model.CatalogEntryModel");dojo.declare("com.ibm.mashups.enabler.model.CatalogEntryModel",com.ibm.mashups.enabler.ListModelController,{create:function(_13a5){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogCategoryNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogCategoryNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.CatalogCategoryNode_API");dojo.provide("com.ibm.mashups.enabler.catalog.CatalogCategoryNode");dojo.declare("com.ibm.mashups.enabler.catalog.CatalogCategoryNode",[com.ibm.mashups.enabler.catalog.CatalogNode],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogCategoryNode"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.CatalogCategoryNode"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.CatalogCategoryNode");}if(!dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl");dojo.declare("com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl",[com.ibm.mashups.enabler.catalog.CatalogCategoryNode,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.EditLinkProviderImpl,com.ibm.mm.enabler.TransformableImpl],{constructor:function(node){this.xmlData=node;this.parentModel=null;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CATALOG);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_XSI,nsf.NS_XML,nsf.NS_OPENSEARCH]);for(var _13a6 in this.serviceJson.namespaces){if(Object.prototype.hasOwnProperty.call(this.serviceJson.namespaces,_13a6)){this.ns[_13a6]=this.serviceJson.namespaces[_13a6];}}},getParentModel:function(){return this.parentModel;},setParentModel:function(_13a7){this.parentModel=_13a7;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogEntryIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogEntryIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.catalog.CatalogEntryIteratorImpl");dojo.declare("com.ibm.mm.enabler.catalog.CatalogEntryIteratorImpl",[com.ibm.mm.enabler.ModelIteratorImpl],{_createNode:function(_13a8){var node=new com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl(_13a8);node=this.model._cacheNode(node);return node;},_customizeUrl:function(url){url.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);url.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this.model._applyHiddenMetaDataLoadingStrategyToModelURL(url);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.CatalogEntryModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.CatalogEntryModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.CatalogEntryModelImpl");dojo.declare("com.ibm.mm.enabler.model.CatalogEntryModelImpl",[com.ibm.mashups.enabler.model.CatalogEntryModel,com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.DeferredIteratorImpl,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl],{constructor:function(_13a9,_13aa){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.category=_13a9;this.parentModel=_13aa;this.strategy=_13aa.strategy;this.loadedNodes={};this.createdNodes={};this.deletedNodes={};this.initialContents={};this.nodeIds=[];this.cid=0;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CATALOG);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH,nsf.NS_XSI]));var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ext:rel='entries']",this.category.xmlData,this.ns);this.collectionUrl=nodes[0].getAttribute("href");},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,uri);},_find:function(_13ab,sync,uri){var _13ac="_find";var _13ad=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13ad){this.LOGGER.entering(_13ac,[_13ab,sync,uri]);}if(this.category.getID()=="CATROOT"){return null;}if(uri in this.deletedNodes){if(_13ab){_13ab.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}if(uri in this.loadedNodes){if(_13ab&&_13ab.getFinishedCallback()){if(_13ab){_13ab.finish(this.loadedNodes[uri],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}else{return this.loadedNodes[uri];}}else{var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.CATALOG_URL,this);myUrl.setNodes([{value:com.ibm.mm.enabler.utils.Misc.encodeModelID4Uri(uri),isID:true},{value:com.ibm.mm.enabler.utils.Misc.encodeModelID4Uri(this.category.getID()),isID:true}]);myUrl.setParameter("rep","full");myUrl.addParameter("aspect","ac");var _13ae=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var entry=null;var _13af={};_13ae.read(dojo.hitch(this,function(type,data,xhr,args){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes&&nodes.length>0){this._cacheNode(new com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl(nodes[0]));}if(_13ab){_13ab.finish(this.loadedNodes[uri]||null,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_13af.status=xhr.status;}}}));if(_13af.status){throw new Error(dojo.string.substitute(this.modelMessages.E_CATNODE_NOTFOUND_1,[uri,_13af.status]));}}if(_13ad){this.LOGGER.exiting(_13ac);}return this.loadedNodes[uri];},_cacheNode:function(node){var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.initialContents[id]=node.toString();}return this.loadedNodes[id];},iterator:function(){if(!this.entries){this.entries=new com.ibm.mm.enabler.catalog.CatalogEntryIteratorImpl(this.collectionUrl,this);}else{this.entries.setCursorPosition(0);}return this.entries;},create:function(_13b0){var _13b1="create";var _13b2=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13b2){this.LOGGER.entering(_13b1,[_13b0]);}var _13b3;if(_13b0&&_13b0.cid){_13b3=_13b0.cid;}else{_13b3=""+this.cid++;}var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);var _13b4=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(_13b4,"cid:"+_13b3+"@"+this.prefix+":"+this.category.getID());entry.appendChild(_13b4);var _13b5=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);entry.appendChild(_13b5);var _13b6=com.ibm.mm.enabler.utils.Utils.createNode("model:catalog-entry",this.ns.model);_13b5.appendChild(_13b6);_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("model:title",this.ns.model));_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("model:description",this.ns.model));_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createExtLinkNode("",null,"definition"));_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createExtLinkNode("",null,"icon"));_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createExtLinkNode("",null,"preview"));_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createExtLinkNode("",null,"previewThumbnail"));_13b6.appendChild(com.ibm.mm.enabler.utils.Utils.createExtLinkNode("",null,"help"));var ret=new com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl(entry);if(_13b2){this.LOGGER.exiting(_13b1,[ret]);}return ret;},confirmCreate:function(_13b7){return this.getConfirmCreate();},insert:function(node,_13b8){var _13b9="insert";var _13ba=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13ba){this.LOGGER.entering(_13b9,[node,_13b8]);}var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.createdNodes[id]=null;}if(_13ba){this.LOGGER.exiting(_13b9);}},confirmInsert:function(node,_13bb){return this.getConfirmInsert();},remove:function(node){var _13bc="remove";var _13bd=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13bd){this.LOGGER.entering(_13bc,[node]);}var id=(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mm.enabler.catalog.CatalogEntryNodeImpl))?node.getID():node;if(!(id in this.deletedNodes)){this.deletedNodes[id]=this.loadedNodes[id];}if(id in this.loadedNodes){delete this.loadedNodes[id];}if(_13bd){this.LOGGER.exiting(_13bc);}},confirmRemove:function(node){return this.getConfirmRemove(node);},_commit:function(_13be,sync,_13bf){var _13c0="_commit";var _13c1=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13c1){this.LOGGER.entering(_13c0,[_13be,sync,_13bf]);}var _13c2;var myUrl,urlId;for(var id in this.loadedNodes){if(Object.prototype.hasOwnProperty.call(this.loadedNodes,id)){var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;var entry=com.ibm.mm.enabler.utils.Utils.createFeed("catalog:"+id,"IBM Lotus Mashups Catalog Feed",this.loadedNodes[id],this.ns);if(id in this.createdNodes){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.collectionUrl,this);this.parentModel._acquire();_13c2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_13c2.create(entry,dojo.hitch(this,function(type,data,xhr,args){if(_13be){if(_13be.operationCallback){_13be.operationCallback(this.loadedNodes[args],com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_13be.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_13be.errorCallback){_13be.errorCallback(xhr.status,_13be.errorCallbackParameters);}}else{this.length++;}}this.parentModel._release(_13be,xhr.status);}),id);}else{if(this.initialContents[id]===this.loadedNodes[id].toString()){continue;}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.loadedNodes[id].getEditLink(),this);myUrl.setParameter("update","replace");this.parentModel._acquire();_13c2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_13c2.update(entry,dojo.hitch(this,function(type,data,xhr,args){if(_13be){if(_13be.operationCallback){_13be.operationCallback(this.loadedNodes[args],com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_13be.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_13be.errorCallback){_13be.errorCallback(xhr.status,_13be.errorCallbackParameters);}}}this.parentModel._release(_13be,xhr.status);}),id);this.initialContents[id]=this.loadedNodes[id].toString();}this.createdNodes={};}}for(var id2 in this.deletedNodes){if(Object.prototype.hasOwnProperty.call(this.deletedNodes,id2)){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.deletedNodes[id2].getEditLink(),this);this.parentModel._acquire();_13c2=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_13c2.remove(dojo.hitch(this,function(type,data,xhr,args){if(_13be){if(_13be.operationCallback){_13be.operationCallback(args,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_13be.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_13be.errorCallback){_13be.errorCallback(xhr.status,_13be.errorCallbackParameters);}}}this.parentModel._release(_13be,xhr.status);}),id2);}}this.deletedNodes={};if(_13c1){this.LOGGER.exiting(_13c0);}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.CatalogEntryModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.CatalogEntryModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.CatalogEntryModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.CatalogCategoryModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.CatalogCategoryModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.CatalogCategoryModel_API");dojo.provide("com.ibm.mashups.enabler.model.CatalogCategoryModel");dojo.declare("com.ibm.mashups.enabler.model.CatalogCategoryModel",com.ibm.mashups.enabler.TreeModelController,{getCatalogEntryModel:function(_13c3){},create:function(_13c4){},commit:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogCategoryIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.catalog.CatalogCategoryIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.catalog.CatalogCategoryIteratorImpl");dojo.declare("com.ibm.mm.enabler.catalog.CatalogCategoryIteratorImpl",[com.ibm.mm.enabler.ModelIteratorImpl],{_createNode:function(_13c5){var node=new com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl(_13c5);node=this.model._cacheNode(node);return node;},_customizeUrl:function(url){url.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);url.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this.model._applyHiddenMetaDataLoadingStrategyToModelURL(url);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.CatalogCategoryModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.CatalogCategoryModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.CatalogCategoryModelImpl");dojo.declare("com.ibm.mm.enabler.model.CatalogCategoryModelImpl",[com.ibm.mashups.enabler.model.CatalogCategoryModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.root=null;this.loadedNodes={};this.createdNodes={};this.deletedNodes={};this.initialContents={};this.entryModels={};this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CATALOG);this.entryUrl=this.serviceJson.url;this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH]));},getInstance:function(){var _13c6=com.ibm.mm.enabler.model.CatalogCategoryModelImpl._instance;return _13c6?_13c6:(com.ibm.mm.enabler.model.CatalogCategoryModelImpl._instance=new com.ibm.mm.enabler.model.CatalogCategoryModelImpl());},getCatalogEntryModel:function(_13c7){if(!(_13c7 in this.entryModels)){this.entryModels[_13c7]=new com.ibm.mm.enabler.model.CatalogEntryModelImpl(_13c7,this);}return this.entryModels[_13c7];},_cacheNode:function(node){var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.initialContents[id]=node.toString();}return this.loadedNodes[id];},find:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,uri);},_find:function(_13c8,sync,uri){var _13c9="_find";var _13ca=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13ca){this.LOGGER.entering(_13c9,[_13c8,sync,uri]);}if(uri in this.deletedNodes){if(_13c8){_13c8.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}if(uri in this.loadedNodes){if(_13c8){_13c8.finish(this.loadedNodes[uri],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}}else{var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.CATALOG_URL,this);myUrl.setNodes([{value:com.ibm.mm.enabler.utils.Misc.encodeModelID4Uri(uri),isID:true}]);myUrl.setParameter("rep","full");myUrl.addParameter("aspect","ac");var _13cb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var entry=null;var _13cc={};_13cb.read(dojo.hitch(this,function(type,data,xhr,args){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes&&nodes.length>0){var entry=new com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl(nodes[0]);if(entry!==null){entry.setParentModel(this);if(!(uri in this.loadedNodes)){this.loadedNodes[uri]=entry;this.initialContents[uri]=entry.toString();}}}if(_13c8){_13c8.finish(this.loadedNodes[uri]||null,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_13cc.status=xhr.status;}}}));if(_13cc.status){throw new Error(dojo.string.substitute(this.modelMessages.E_CCATNODE_NOTFOUND_1,[uri,_13cc.status]));}}if(_13ca){this.LOGGER.exiting(_13c9);}return this.loadedNodes[uri];},create:function(_13cd){var _13ce="create";var _13cf=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13cf){this.LOGGER.entering(_13ce,[_13cd]);}var ret=null;if(_13cd&&_13cd.category){var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);var _13d0=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(_13d0,"catalog:"+this.prefix+":"+_13cd.category);entry.appendChild(_13d0);entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:title",this.ns.atom));entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:summary",this.ns.atom));entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:published",this.ns.atom));entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:updated",this.ns.atom));var _13d1=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);entry.appendChild(_13d1);var _13d2=com.ibm.mm.enabler.utils.Utils.createNode("model:catalog-category",this.ns.model);_13d1.appendChild(_13d2);_13d2.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("model:title",this.ns.model));_13d2.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("model:description",this.ns.model));ret=new com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl(entry);}if(_13cf){this.LOGGER.exiting(_13ce,[ret]);}return ret;},confirmCreate:function(_13d3){return this.getConfirmCreate();},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_13d4,sync){var _13d5="_commit";var _13d6=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13d6){this.LOGGER.entering(_13d5,[_13d4,sync]);}this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this.requestCount=0;this._acquire();var _13d7;for(var id in this.loadedNodes){if(Object.prototype.hasOwnProperty.call(this.loadedNodes,id)){var time=new Date();var entry="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n"+this.loadedNodes[id];var _13d8=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.entryUrl,this);if(id in this.createdNodes){this._acquire();_13d7=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_13d8,null,null,false,sync);_13d7.create(entry,dojo.hitch(this,function(type,data,xhr,args){if(_13d4){if(_13d4.operationCallback){_13d4.operationCallback(this.loadedNodes[args],com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_13d4.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_13d4.errorCallback){_13d4.errorCallback(xhr.status,_13d4.errorCallbackParameters);}}}this._release(_13d4,xhr.status);}),id);}else{if(this.initialContents[id]===this.loadedNodes[id].toString()){continue;}var _13d9=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.loadedNodes[id].getEditLink(),this);_13d9.setParameter("update","replace");this._acquire();_13d7=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_13d9,null,null,false,sync);_13d7.update(entry,dojo.hitch(this,function(type,data,xhr,args){if(_13d4){if(_13d4.operationCallback){_13d4.operationCallback(this.loadedNodes[args],com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_13d4.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_13d4.errorCallback){_13d4.errorCallback(xhr.status,_13d4.errorCallbackParameters);}}}this._release(_13d4,xhr.status);}),id);}}}for(var _13da in this.deletedNodes){if(Object.prototype.hasOwnProperty.call(this.deletedNodes,_13da)){var _13db=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.deletedNodes[_13da].getEditLink(),this);this._acquire();_13d7=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_13db,null,null,false,sync);_13d7.remove(dojo.hitch(this,function(type,data,xhr,args){if(_13d4){if(_13d4.operationCallback){_13d4.operationCallback(args,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_13d4.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_13d4.errorCallback){_13d4.errorCallback(xhr.status,_13d4.errorCallbackParameters);}}}this._release(_13d4,xhr.status);}),_13da);}}for(var _13dc in this.entryModels){if(Object.prototype.hasOwnProperty.call(this.entryModels,_13dc)){this.entryModels[_13dc]._commit(_13d4,sync);}}this._release(_13d4,0);if(_13d6){this.LOGGER.exiting(_13d5);}},_acquire:function(){this.requestCount++;},_release:function(_13dd,_13de){this.statusCode=Math.max(parseInt(_13de,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_13dd){_13dd.finish(null,this.statusCode);}}},getRoot:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._getRoot);},_getRoot:function(_13df,sync){if(this.root===null){var node=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);node.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom));this.root=new com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl(node);this.root.setParentModel(this);this.root.setID("CATROOT");}return this.root;},hasChildren:function(node){return (node.getID()=="CATROOT")?true:false;},getChildren:function(node){if(!this.children){this.children=new com.ibm.mm.enabler.catalog.CatalogCategoryIteratorImpl(this.serviceJson.url,this);}else{this.children.setCursorPosition(0);}return this.children;},getParent:function(uri){return new com.ibm.mm.enabler.DeferredImpl(this,this._getParent,uri);},_getParent:function(_13e0,sync,node){return (node.getID()=="CATROOT")?null:this.getRoot();},insert:function(node){this.loadedNodes[node.getID()]=node;this.createdNodes[node.getID()]=null;},confirmInsert:function(node){return this.getConfirmCreate();},remove:function(node){var _13e1="remove";var _13e2=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13e2){this.LOGGER.entering(_13e1,[node]);}var id=(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mm.enabler.catalog.CatalogCategoryNodeImpl))?node.getID():node;if(!(id in this.deletedNodes)){this.deletedNodes[id]=this.loadedNodes[id];}if(id in this.loadedNodes){delete this.loadedNodes[id];}if(_13e2){this.LOGGER.exiting(_13e1);}},confirmRemove:function(node){return this.getConfirmRemove(node);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.CatalogCategoryModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.CatalogCategoryModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.CatalogCategoryModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.Factory_API");dojo.provide("com.ibm.mashups.enabler.catalog.Factory");dojo.declare("com.ibm.mashups.enabler.catalog.Factory",null,{getCatalogCategoryModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.catalog.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.catalog.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.catalog.FactoryImpl");dojo.declare("com.ibm.mm.enabler.catalog.FactoryImpl",com.ibm.mashups.enabler.catalog.Factory,{getCatalogCategoryModel:function(){return com.ibm.mm.enabler.model.CatalogCategoryModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.catalog.Factory=new com.ibm.mm.enabler.catalog.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.catalog.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.catalog.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.catalog.Factory");}if(!dojo._hasResource["com.ibm.mm.iwidget.RenderController"]){dojo._hasResource["com.ibm.mm.iwidget.RenderController"]=true;dojo.provide("com.ibm.mm.iwidget.RenderController");dojo.declare("com.ibm.mm.iwidget.RenderController",null,{constructor:function(_13e3){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.widgetwrapper=_13e3;this.widgetXMLUrl=this.widgetwrapper.getIWidgetInstance().widgetXMLUrl;this.iwStr=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwStr");this.iwMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwMessages");dojo.subscribe(this.inlineMessageHandler);},render:function(){this._loadWidgetDefinition();},_resourceBaseURL:new dojo.moduleUrl("com.ibm.mm.iwidget","image/"),_setLoading:function(){var _13e4=document.createElement("div");_13e4.className=this.widgetwrapper.ns+"loading";if(ibmConfig&&ibmConfig.loadingHTML){_13e4.innerHTML=ibmConfig.loadingHTML;}else{_13e4.innerHTML="<img alt='"+this.iwStr.LOAD+"' src='"+this._resourceBaseURL+"progress-anim.gif' />&nbsp;"+this.iwStr.LOAD;}this.widgetwrapper.rootElement.appendChild(_13e4);},_loadWidgetDefinition:function(){var _13e5="_loadWidgetDefinition";var _13e6=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13e6){this.LOGGER.entering(_13e5,arguments);}var _13e7=this.widgetwrapper.rootElement;if(this.widgetwrapper.loaded){return false;}this._setLoading();if(this.widgetXMLUrl!==null){var _13e8=com.ibm.mashups.services.ServiceManager.getService("widgetLoadService");_13e8.getWidgetXML(this.widgetXMLUrl,false,dojo.hitch(this,"handleWidgetInfoRetrieved"),this.widgetwrapper.id);}else{return false;}if(_13e6){this.LOGGER.exiting(_13e5,true);}return true;},handleWidgetInfoRetrieved:function(data,_13e9,xhr){var _13ea="handleWidgetInfoRetrieved";var _13eb=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_13eb){this.LOGGER.entering(_13ea,arguments);}var _13ec;if(_13e9=="200"||_13e9=="0"){this.widgetwrapper.setIWidgetDefinition(data);this.widgetDef=data;}else{if(!this._isWidgetInstalled()){this._handleInlineWidgetNotInstalledMessage(this.iwStr.WIDGET_NOT_INSTALLED,this.iwStr.WIDGET_NOT_INSTALLED_SUB,data.message);}else{_13ec=unescape(this.widgetwrapper.getIWidgetInstance().getIDescriptorItems().getItemValue("title",dojo.locale));if(!_13ec){_13ec=this.widgetXMLUrl;}this._handleInlineMessage("error",dojo.string.substitute(this.iwMessages.E_IWIDGETDEF_NOTAVAILABLE_1,[_13ec]),data.message);}return;}var _13ed=this.isSandboxed();if(dojo.isIE<7&&_13ed){_13ec=unescape(this.widgetwrapper.getIWidgetInstance().getIDescriptorItems().getItemValue("title",dojo.locale));if(!_13ec){_13ec=this.widgetXMLUrl;}this._handleInlineMessage("error",dojo.string.substitute(this.iwMessages.E_NODISPLAY_UNSECUREWIDGET_1,[_13ec]));return;}this._doRender(_13ed);if(_13eb){this.LOGGER.exiting(_13ea);}},_isWidgetInstalled:function(){try{var _13ee=com.ibm.mashups.enabler.catalog.Factory.getCatalogCategoryModel();_13ee.setStrategy(new com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy(25));var _13ef=null;var _13f0=null;var _13f1=_13ee.getRoot().start();var _13f2=_13ee.getChildren(_13f1);while(_13f2.hasNext()){var _13f3=_13f2.next();_13ef=_13ee.getCatalogEntryModel(_13f3);var _13f4=_13ef.iterator();_13f4.setCursorPosition(0);while(_13f4.hasNext()){var entry=_13f4.next();var _13f5=decodeURIComponent(this.widgetXMLUrl);if(_13f5.indexOf(entry.getDefinitionURL(false))>=0){return true;}}}}catch(e){return true;}return false;},isSandboxed:function(){var _13f6=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _13f7=_13f6.getValue(com.ibm.mashups.enabler.services.ConfigConstants.SANDBOXENABLED);if(!_13f7){return false;}var _13f8=document.location+"";_13f7=false;var _13f9=this.widgetDef.getAttributes()||null;if(_13f9){var value=_13f9.getItemValue("sandbox");if(typeof value!="undefined"&&value!==null){if(value=="true"){_13f7=true;}}}if(!_13f7){if(this.widgetwrapper.rootElement.getAttribute("sandbox")!==null&&this.widgetwrapper.rootElement.getAttribute("sandbox")=="true"){_13f7=true;}}if(!_13f7){if(this.widgetwrapper.rootElement.className.indexOf(iwConstants.CSSCLASS_INSTANCE.iwSandbox)>0){_13f7=true;}}if(_13f7){if(this._isSandboxDisabledWidget(this.widgetXMLUrl)){_13f7=false;}}return _13f7;},_isSandboxDisabledWidget:function(_13fa){var _13fb=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var temp=_13fb.getValue(com.ibm.mashups.enabler.services.ConfigConstants.WIDGETDEFID_SANDBOX_DISABLED);var _13fc=temp;if(dojo.isString(_13fc)){_13fc=[temp];}if(_13fc.length===0){return false;}for(var i=0;i<_13fc.length;i++){if(dojo.string.trim(_13fa)===dojo.string.trim(_13fc[i])){return true;}else{if(dojo.string.trim(_13fa).indexOf(dojo.string.trim(_13fc[i]))!=-1&&dojo.string.trim(_13fc[i]).indexOf("/")!==0){return true;}else{if(dojo.string.trim(_13fa).indexOf(dojo.string.trim(_13fc[i]))!=-1&&dojo.string.trim(_13fc[i]).indexOf("/")===0&&dojo.string.trim(_13fa).indexOf(":")!=-1){var buf=_13fa.split("//");var _13fd=buf[0];var buf2=buf[1].split("/");var host=buf2[0];if(_13fd==window.location.protocol&&window.location.host==host){return true;}else{if(_13fd==window.location.protocol&&_13fd=="http:"&&host.indexOf(window.location.host)===0){if(host.substr(host.indexOf(":")+1)=="80"){return true;}}else{if(_13fd==window.location.protocol&&_13fd=="https:"&&host.indexOf(window.location.host)===0){if(host.substr(host.indexOf(":")+1)=="443"){return true;}}}}}}}}return false;},_handleInlineMessage:function(type,_13fe,_13ff){var nodes=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",this.widgetwrapper.ns+"loading",this.widgetwrapper.rootElement,nodes,false);var aNode=nodes[0];aNode.innerHTML="";com.ibm.mm.enabler.logging.LegacyLogger.logInlineMessage(aNode,type,_13fe,_13ff);},_handleInlineWidgetNotInstalledMessage:function(_1400,_1401,_1402){var nodes=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",this.widgetwrapper.ns+"loading",this.widgetwrapper.rootElement,nodes,false);var aNode=nodes[0];var msg=[];msg[msg.length]="<div style=\"margin:15px\">";msg[msg.length]="<div class=\"widgetNotInstalledImage\">";msg[msg.length]="</div>";msg[msg.length]="<div class=\"widgetNotInstalledText\">";msg[msg.length]=_1400;msg[msg.length]="</div>";if(_1401&&_1401.length>0){msg[msg.length]="<div class=\"widgetNotInstalledSubText\">";msg[msg.length]=_1401;msg[msg.length]="</div>";}msg[msg.length]="</div>";aNode.innerHTML=msg.join("");com.ibm.mm.enabler.logging.LegacyLogger._publishStatusMsg("info",_1400,_1402);},_doRender:function(_1403){var _1404=com.ibm.mashups.services.ServiceManager.getService("eventService");if(_1403){dojo.mixin(this.widgetwrapper,new com.ibm.mm.iwidget.widget.IWidgetWrapperStubImpl());}else{_1404._getHubAdapter().createInlineHubContainer(this.widgetwrapper.id);_1404._getHubAdapter().createInlineHubClient(this.widgetwrapper.id);}this.widgetwrapper.doRender();}});}if(!dojo._hasResource["com.ibm.mm.iwidget.model.WidgetModelExtended"]){dojo._hasResource["com.ibm.mm.iwidget.model.WidgetModelExtended"]=true;dojo.provide("com.ibm.mm.iwidget.model.WidgetModelExtended");dojo.declare("com.ibm.mm.iwidget.model.WidgetModelExtendedImpl",com.ibm.mm.iwidget.model.WidgetModelDefaultImpl,{_onWindowUnload:function(){var _1405=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();if(_1405){var _1406=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageModeAccessor(_1405);_1406.setPageMode("unload");}try{var arr=[];for(var i in this.widgetArr){if(Object.prototype.hasOwnProperty.call(this.widgetArr,i)){this._unloadWidget(i);}}}catch(e){console.log("_onWindowUnload "+e.message);}},renderWidget:function(_1407){if(typeof _1407=="undefined"){return;}if(_1407.loaded||_1407.loading){return;}_1407.loading=true;var _1408=new com.ibm.mm.iwidget.RenderController(_1407);_1408.render();},getWidgetById:function(id){return this.find(id);}});com.ibm.mm.iwidget.model.WidgetModelImpl=com.ibm.mm.iwidget.model.WidgetModelExtendedImpl;}if(!dojo._hasResource["com.ibm.mm.iwidget.services.EventServiceExtended"]){dojo._hasResource["com.ibm.mm.iwidget.services.EventServiceExtended"]=true;dojo.provide("com.ibm.mm.iwidget.services.EventServiceExtended");dojo.declare("com.ibm.mm.iwidget.services.EventServiceExtendedImpl",com.ibm.mm.iwidget.services.EventServiceDefaultImpl,{registerExtServices:function(){var event=com.ibm.mashups.iwidget.Constants.WIDGET_WINDOWSTATECHANGED;var me=this;var _1409=function(_140a){var _140b=_140a.id;var _140c=_140a.newWindowState;var _140d=_140a.oldWindowState;me.fireEvent(_140b,"onWindowStateChanged",{newWindowState:_140c,oldWindowState:_140d});};this.subscribeEvent(event,null,_1409,null,null);},subscribeWire:function(_140e,_140f,_1410,_1411){if(this.bIsLoggable){this.LOGGER.entering("eventService.subscribeWire",[_140e,_140f,_1410,_1411]);}if(typeof _140e=="undefined"||_140e===null){return false;}if(typeof _140f=="undefined"||_140f===null){return false;}if(typeof _1410=="undefined"||_1410===null){return false;}if(typeof _1411=="undefined"||_1411===null){return false;}var rc=true;var that=this;function eventCallback(topic,_1412,_1413){that.fireEvent(_1410,_1411,_1412.payload,_1412.payloadType,_140e);};function callback(item,_1414,error){if(!_1414){console.log("eventService.subscribeWire subscribe failed "+"source:"+_140e+" sourceEvent:"+_140f+" targetWidget:"+_1410+" targetEvent:"+_1411);}};var _1415=this.hubAdapter._getInlineHubClient(_1410);if(_1415){var _1416=_1415.subscribe(this.WIDGETEVENT_PREFIX+_140e+"."+_140f,eventCallback,null,callback);var _1417=this._generateWireId(_140e,_140f,_1410,_1411);this.subMgr[_1417]=_1416;var _1418={};_1418.targetWidget=_1410;_1418.sourceEvent=_140f;_1418.sourceWidget=_140e;_1418.targetEvent=_1411;this.fireEvent(_140e,"onNewWire",_1418);}return rc;},publishWire:function(_1419,_141a,_141b,_141c){_141b=this._serializePayload(_141b);if(this.bIsLoggable){this.LOGGER.entering("eventService.publishWire",[_1419,_141a,_141b,_141c]);}if(typeof _1419=="undefined"||_1419===null){return false;}if(typeof _141a=="undefined"||_141a===null){return false;}var _141d=this.hubAdapter._getInlineHubClient(_1419);if(_141d){_141d.publish(this.WIDGETEVENT_PREFIX+_1419+"."+_141a,{"payload":_141b,"payloadType":_141c});}return true;},_serializePayload:function(_141e){if(typeof _141e=="object"&&_141e.toJson){_141e=_141e.toJson();}return _141e;},unSubscribeWire:function(_141f,_1420,_1421,_1422){if(typeof _141f=="undefined"||_141f===null){return false;}if(typeof _1420=="undefined"||_1420===null){return false;}if(typeof _1421=="undefined"||_1421===null){return false;}if(typeof _1422=="undefined"||_1422===null){return false;}var _1423=this.hubAdapter._getInlineHubClient(_1421);if(_1423){var _1424=this._generateWireId(_141f,_1420,_1421,_1422);var _1425=this.subMgr[_1424];if(_1425){this.unsubscribeEvent(_1425,_1421);delete this.subMgr[_1424];}var _1426={};_1426.targetWidget=_1421;_1426.targetEvent=_1422;_1426.sourceWidget=_141f;_1426.sourceEvent=_1420;this.fireEvent(_1421,"onRemoveWire",_1426);this.fireEvent(_141f,"onRemoveWire",_1426);this.publishEvent(iwConstants.EVENTS.unSubscribeWire,{wires:[_1426]});}return true;},addWire:function(_1427,_1428,_1429,_142a){if(this.bIsLoggable){this.LOGGER.entering("eventService.addWire",[_1427,_1428,_1429,_142a]);}if(typeof _1427=="undefined"||_1427===null){return false;}if(typeof _1428=="undefined"||_1428===null){return false;}if(typeof _1429=="undefined"||_1429===null){return false;}if(typeof _142a=="undefined"||_142a===null){return false;}var rc=false;var _142b=this.hubAdapter.isInlineClient(_1429);if(!_142b){var _142c="eventservice."+_1429;var _142d={};_142d.methodname="addWire";_142d.params=arguments;_142d.hubclient="main";this._publishEvent(event,_142d);rc=true;}else{rc=this.subscribeWire(_1427,_1428,_1429,_142a);if(rc){var _142e=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().getWidgetById(_1429);if(typeof _142e!="undefined"&&_142e!==null){var aWire={};aWire.SourceWidget=_1427;aWire.SourceEvent=_1428;aWire.TargetEvent=_142a;var _142f=_142e.getIWidgetInstance();var _1430=new com.ibm.mm.iwidget.widget.WireImpl(_1429,aWire);_142f._addWire(_1430);}}}return rc;},removeWire:function(_1431,_1432,_1433,_1434){if(this.bIsLoggable){this.LOGGER.entering("eventService.removeWire",[_1431,_1432,_1433,_1434]);}if(typeof _1431=="undefined"||_1431===null){return false;}if(typeof _1432=="undefined"||_1432===null){return false;}if(typeof _1433=="undefined"||_1433===null){return false;}if(typeof _1434=="undefined"||_1434===null){return false;}var rc=false;var _1435=this.hubAdapter.isInlineClient(_1433);if(!_1435){var _1436="eventservice."+_1433;var _1437={};_1437.methodname="removeWire";_1437.params=arguments;_1437.hubclient="main";this._publishEvent(event,_1437);rc=true;}else{rc=this.unSubscribeWire(_1431,_1432,_1433,_1434);if(rc){var _1438=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().getWidgetById(_1433);if(typeof _1438!="undefined"&&_1438!==null){var aWire={};aWire.SourceWidget=_1431;aWire.SourceEvent=_1432;aWire.TargetEvent=_1434;var _1439=_1438.getIWidgetInstance();var _143a=new com.ibm.mm.iwidget.widget.WireImpl(_1433,aWire);_1439._removeWire(_143a.getID());}}}return rc;}});if(!ibmConfig.insideSandbox){com.ibm.mashups.services.ServiceManager.setService("eventService","com.ibm.mm.iwidget.services.EventServiceExtendedImpl");}}if(!dojo._hasResource["com.ibm.mm.iwidget.services.IFrameEventServiceImpl"]){dojo._hasResource["com.ibm.mm.iwidget.services.IFrameEventServiceImpl"]=true;dojo.provide("com.ibm.mm.iwidget.services.IFrameEventServiceImpl");dojo.declare("com.ibm.mm.iwidget.services.IFrameEventServiceImpl",com.ibm.mashups.iwidget.services.EventService,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.subMgr={};this.eventQueue=[];this.getHubClient();this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},getType:function(){return com.ibm.mm.iwidget.Constants.eventservice.type.IFRAME;},PREFIX_IFRAME:"_iframe_",getHubClient:function(){if(this._hubClient){return this._hubClient;}var that=this;function onHubClientSecurityAlert(_143b,_143c){if(that.bIsLoggable){that.LOGGER.trace("onHubClientSecurityAlert","security alert from "+_143b.getClientID());}};var _143d=new OpenAjax.hub.IframeHubClient({HubClient:{onSecurityAlert:onHubClientSecurityAlert}});function onHubClientConnect2(_143e,_143f,error){if(!_143f){if(that.bIsLoggable){that.LOGGER.trace("onHubClientConnect2","!! client connection error = id: '"+_143e.getClientID()+"' msg: '"+error);}}var id=_143e.getClientID();id=id.slice(8);that.setId(id);that._hubClient=_143e;that._subscribeEventService();for(var i in that.eventQueue){if(Object.prototype.hasOwnProperty.call(that.eventQueue,i)){var args=that.eventQueue[i];args[0]="widgetevents."+id+args[0];that._subscribeEvent.apply(that,args);}}};function onHubClientDisconnect(_1440,_1441,error){if(!_1441){if(that.bIsLoggable){that.LOGGER.trace("onHubClientDisconnect2","!! client disconnection error = id: '"+_1440.getClientID()+"' msg: '"+error);}}_1440.connect(onHubClientConnect2);};_143d.connect(onHubClientConnect2);return null;},disconnectHubClient:function(){if(!this._hubClient){return;}this._hubClient.disconnect();this._hubClient=null;},setId:function(id){this.id=id;},getId:function(){return this.id;},_subscribeEventService:function(){var that=this;function eventCallback(topic,_1442,_1443){var _1444=_1442.methodname;if(_1444){var fn=that[_1442.methodname];if(fn){that[_1444].apply(that,_1442.params);}}};this._hubClient.subscribe("eventservice."+this.getId(),eventCallback,this,this._subscribeCallback);},_subscribeCallback:function(_1445,_1446,error){if(!_1446){}},WIDGETEVENT_PREFIX:iwConstants.WIDGETEVENT_PREFIX,WILDCARD_PREFIX:iwConstants.WILDCARD_PREFIX,subscribeWire:function(_1447,_1448,_1449,_144a){var _144b="subscribeWire";var _144c=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_144c){this.LOGGER.entering(_144b,arguments);}if(typeof _1447=="undefined"||_1447===null){return false;}if(typeof _1448=="undefined"||_1448===null){return false;}if(typeof _1449=="undefined"||_1449===null){return false;}if(typeof _144a=="undefined"||_144a===null){return false;}var rc=true;var that=this;function eventCallback(topic,_144d,_144e){that.fireEvent(_1449,_144a,_144d.payload,_144d.payloadType,_1447);};function callback(item,_144f,error){if(!_144f){if(that.bIsLoggable){that.LOGGER.trace("subscribeWire","eventService.subscribeWire subscribe failed "+"source:"+_1447+" sourceEvent:"+_1448+" targetWidget:"+_1449+" targetEvent:"+_144a);}}};var _1450=this._hubClient.subscribe(this.WIDGETEVENT_PREFIX+_1447+"."+_1448,eventCallback,null,callback);var _1451=this._generateWireId(_1447,_1448,_1449,_144a);this.subMgr[_1451]=_1450;var _1452={};_1452.targetWidget=_1449;_1452.sourceEvent=_1448;_1452.sourceWidget=_1447;_1452.targetEvent=_144a;this.fireEvent(_1447,"onNewWire",_1452);return rc;},publishWire:function(_1453,_1454,_1455,_1456){_1455=this._serializePayload(_1455);if(typeof _1453=="undefined"||_1453===null){return false;}if(typeof _1454=="undefined"||_1454===null){return false;}this._hubClient.publish(this.WIDGETEVENT_PREFIX+_1453+"."+_1454,{"payload":_1455,"payloadType":_1456});return true;},_serializePayload:function(_1457){if(typeof _1457=="object"&&_1457.toJson){_1457=_1457.toJson();}return _1457;},unSubscribeWire:function(_1458,_1459,_145a,_145b){if(typeof _1458=="undefined"||_1458===null){return false;}if(typeof _1459=="undefined"||_1459===null){return false;}if(typeof _145a=="undefined"||_145a===null){return false;}if(typeof _145b=="undefined"||_145b===null){return false;}var _145c=this._generateWireId(_1458,_1459,_145a,_145b);var _145d=this.subMgr[_145c];if(_145d){this._unsubscribeEvent(_145d,_145b);delete this.subMgr[_145c];}var _145e={};_145e.targetWidget=_145a;_145e.targetEvent=_145b;_145e.sourceWidget=_1458;_145e.sourceEvent=_1459;this.fireEvent(_145a,"onRemoveWire",_145e);this.fireEvent(_1458,"onRemoveWire",_145e);this._publishEvent(iwConstants.EVENTS.unSubscribeWire,{wires:[_145e]});},fireEvent:function(_145f,_1460,_1461,_1462,_1463){var _1464=new com.ibm.mm.iwidget.IEventImpl(_1460,_1462,_1461,_1463);var _1465=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();var _1466=_1465.find(_145f);if(typeof _1466!="undefined"&&_1466!==null){if(_1466.isLoaded()){_1466.handleEvent(_1464);}else{var subID=dojox.uuid.generateRandomUuid();var cb=function(_1467,_1468,_1469){_1468.handleEvent(_1469);var _146a=_1467.subMgr[subID];if(_146a){_1467._unsubscribeEvent(_146a);}};var _146b=this._subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_1466.id,null,dojo.partial(cb,this,_1466,_1464));this.subMgr[subID]=_146b;}}else{var _146c={};_146c.methodname="fireEvent";_146c.hubclient=this.getId();_146c.params=[_145f,_1460,_1461,_1462];this._publishEvent("eventservice.main",_146c);}},publishEvent:function(_146d,_146e,_146f,_1470){return;},_publishEvent:function(event,_1471,_1472){if(typeof _1471=="undefined"||_1471===null){this._hubClient.publish(event,"");}else{this._hubClient.publish(event,_1471);}},broadcastEvent:function(_1473,_1474,_1475,_1476,_1477,_1478){return;},broadcastEvents:function(_1479,_147a,_147b,_147c){return;},_handleBroadcastEventsCache:function(){var _147d={};_147d.methodname="_handleBroadcastEventsCache";_147d.hubclient=this.getId();_147d.params=[];this._publishEvent("eventservice.main",_147d);},subscribeEvent:function(event,_147e,_147f,_1480,_1481){return;},_subscribeEvent:function(event,_1482,_1483,_1484,_1485){if(!this._hubClient){this.eventQueue.push(arguments);return;}var _1486=this._hubClient.subscribe(event,function(topic,data,_1487){if(_1482&&_1483){_1483=dojo.hitch(_1482,_1483);}if(_1483){_1483.apply(this,[data]);}},null,function(subID,_1488,error){if(_1482&&_1484){_1484=dojo.hitch(_1482,_1484);}if(_1484){_1484.apply(this,[subID,_1488,error]);}if(!_1488){return;}});return _1486;},_unsubscribeEvent:function(_1489,_148a){if(!_1489){return;}this._hubClient.unsubscribe(_1489);},unsubscribeEvent:function(_148b,_148c){return;},_generateWireId:function(_148d,_148e,_148f,_1490){return _148d+"_"+_148e+"_"+_148f+"_"+_1490;}});if(ibmConfig.insideSandbox){com.ibm.mashups.services.ServiceManager.setService("eventService","com.ibm.mm.iwidget.services.IFrameEventServiceImpl");}}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetDefinitionExtendedImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetDefinitionExtendedImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetDefinitionExtendedImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetDefinitionExtendedImpl",com.ibm.mm.iwidget.widget.IWidgetDefinitionDefaultImpl,{getResources:function(){if(!this.resources){this.resources=[];for(var i=0;i<this.widgetDef.resources.length;i++){this.resources.push(new com.ibm.mm.iwidget.widget.ResourceImpl(this.widgetDef.resources[i]));}}return this.resources;},getPublishedEventsNames:function(){if(!this.widgetDef.publicEvents){return [];}var _1491=[];var _1492;for(_1492 in this.widgetDef.publicEvents){if(Object.prototype.hasOwnProperty.call(this.widgetDef.publicEvents,_1492)){var temp=this.widgetDef.publicEvents[_1492];if(!temp.isPublished||(temp.isPublished&&temp.isPublished=="true")){_1491.push(_1492);}}}return _1491;},getHandledEventsNames:function(){if(!this.widgetDef.publicEvents){return [];}var _1493=[];var _1494;for(_1494 in this.widgetDef.publicEvents){if(Object.prototype.hasOwnProperty.call(this.widgetDef.publicEvents,_1494)){var temp=this.widgetDef.publicEvents[_1494];if(temp.onEvent){_1493.push(_1494);}}}return _1493;},getPublishedEvent:function(_1495){if(!this.widgetDef.publicEvents){return null;}var event=this.getPublicEvent(_1495)||null;if(event){if(!event.isPublished||(event.isPublished&&event.isPublished=="false")){event=null;}}return event;},getHandledEvent:function(_1496){if(!this.widgetDef.publicEvents){return null;}var event=this.getPublicEvent(_1496)||null;if(event){if(!event.onEvent){event=null;}}return event;},getPublicEvent:function(_1497){if(!this.widgetDef.publicEvents){return null;}if(this.eventsCache&&this.eventsCache[_1497]){return new com.ibm.mm.iwidget.IEventDescriptionImpl(this.eventsCache[_1497]);}var data=this.widgetDef.publicEvents[_1497];var event=null;var obj={};if(data){obj.name=data.id;if(data.onEvent){obj.handlingFn=data.onEvent;obj.isHandled=true;}else{obj.isHandled=false;}obj.isPublished=!!data.isPublished;obj.attributes={};obj.localizedAttributes={};var _1498=null;for(var i in data){if(Object.prototype.hasOwnProperty.call(data,i)){if(i!="id"&&i!="onEvent"&&i!="description"){obj.attributes[i]=data[i];}if(i=="description"){_1498=data[i];}}}var _1499=null;if(_1498){_1499=this._getEventDescription(_1498)||null;if(_1499){var _149a=_1499.lang;if(!_149a){_149a=this.getDefaultLanguage();if(!_149a){_149a="en";}}obj.lang=_149a;if(_1499.payloadType){obj.type=_1499.payloadType;}if(_1499.aliases){obj.attributes.aliases=_1499.aliases;}var _149b=_1499.descriptions;if(_149b){obj.localizedAttributes=_1499.descriptions;}if(typeof (obj.localizedAttributes[_149a])=="undefined"){obj.localizedAttributes[_149a]={};}if(_1499.title){obj.localizedAttributes[_149a].title=_1499.title;}if(_1499.description){obj.localizedAttributes[_149a].description=_1499.description;}if(_1499.descriptionURI){obj.localizedAttributes[_149a].descriptionURI=_1499.descriptionURI;}}}if(!this.eventsCache){this.eventsCache={};}this.eventsCache[_1497]=obj;event=new com.ibm.mm.iwidget.IEventDescriptionImpl(obj);}return event;},_getEventDescription:function(id){var _149c=null;if(this.widgetDef.eventDescriptions){_149c=this.widgetDef.eventDescriptions[id];}return _149c;},_getPublicEvents:function(){var _149d={};for(var _149e in this.widgetDef.publicEvents){if(Object.prototype.hasOwnProperty.call(this.widgetDef.publicEvents,_149e)){var _149f=this.getPublicEvent(_149e)||null;if(_149f){_149d[_149e]=_149f;}}}return _149d;},getWidgetPublishedEvents:function(){return this.getPublishedEvents();},getWidgetHandledEvents:function(){return this.getHandledEvents();},getPublishedEvents:function(){var _14a0=[];var _14a1=this.getPublishedEventsNames();for(var i=0;i<_14a1.length;i++){var _14a2=_14a1[i];var _14a3=this.getPublicEvent(_14a2)||null;if(_14a3){_14a0[i]=_14a3;}}return _14a0;},getHandledEvents:function(){var _14a4=[];var _14a5=this.getHandledEventsNames();for(var i=0;i<_14a5.length;i++){var _14a6=_14a5[i];var _14a7=this.getPublicEvent(_14a6)||null;if(_14a7){_14a4[i]=_14a7;}}return _14a4;},getPayloadDefs:function(){return this.widgetDef.payloadDefs;},getPayloadDef:function(name){var _14a8=this.widgetDef.payloadDefs[name];if(typeof _14a8=="undefined"){return null;}return _14a8;},getPayloadDefNames:function(){var arr=[];var a;for(a in this.widgetDef.payloadDefs){if(Object.prototype.hasOwnProperty.call(this.widgetDef.payloadDefs,a)){arr.push(a);}}return arr;},_getShareableItemSets:function(){var _14a9=this.widgetDef.shareableItemSetsArr;if(_14a9){for(var i in _14a9){if(Object.prototype.hasOwnProperty.call(_14a9,i)){return _14a9;}}}return null;},toSpecObject:function(){if(this.specObject){return this.specObject;}var _14aa={};if(!this.xmlStr){return {};}var _14ab=com.ibm.mm.enabler.xslt.loadXmlString(this.xmlStr);var expr="/iw:iwidget";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_14ab,this.namespaces);if(nodes&&nodes.length>0){var _14ac=nodes[0];this._addAttributesToJson(_14ac,_14aa);var _14ad=[];_14ad.push({elementName:"eventDescription",keyNames:["id"]});_14ad.push({elementName:"alt",keyNames:["lang","xml:lang"]});this._addElements(_14ac,_14ad,_14aa);_14ad=[];_14ad.push({elementName:"event",keyNames:["id"]});this._addElements(_14ac,_14ad,_14aa);_14ad=[];_14ad.push({elementName:"itemSet",keyNames:["id"]});_14ad.push({elementName:"item",keyNames:["id"]});_14ad.push({elementName:"alt",keyNames:["lang","xml:lang"]});this._addElements(_14ac,_14ad,_14aa);_14ad=[];_14ad.push({elementName:"resource",keyNames:["uri","src"],elemsAsAtt:["skipLoad"]});this._addElements(_14ac,_14ad,_14aa);_14ad=[];_14ad.push({elementName:"content",keyNames:["mode"]});this._addElements(_14ac,_14ad,_14aa,true);}this.specObject=_14aa;return _14aa;},_addAttributesToJson:function(node,_14ae){var atts=node.attributes;var _14af;for(var i=0;i<atts.length;i++){if(atts[i].nodeName.indexOf(":")==-1){_14ae["_"+atts[i].nodeName]=atts[i].nodeValue;}else{if(atts[i].nodeName.indexOf(":")!=-1){_14af=atts[i].nodeName.replace(":","_");_14ae["_"+_14af]=atts[i].nodeValue;}}}},_addElements:function(node,_14b0,_14b1,_14b2){if(!_14b0){return;}if(!(dojo.isArray(_14b0)===true&&_14b0.length>0)){return;}var _14b3=_14b0[0].elementName;var _14b4=_14b0[0].keyNames;var _14b5=_14b0[0].elemsAsAtt;var _14b6=null;var _14b7=null;if(_14b0.length>1){_14b6=_14b0[1].elementName;_14b7=_14b0[1].keyNames;}var _14b8=_14b1[_14b3+"s"]={};var expr="iw:"+_14b3;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,node,this.namespaces);if(nodes){for(var i=0;i<nodes.length;i++){var _14b9;for(var j=0;j<_14b4.length;j++){_14b9=nodes[i].getAttribute(_14b4[j]);if(_14b9){break;}}if(_14b9){var _14ba=_14b8[_14b9]={};this._addAttributesToJson(nodes[i],_14ba);if(_14b5){for(var k=0;k<_14b5.length;k++){if(!_14ba["_"+_14b5[k]]){var expr1="iw:"+_14b5[k];var _14bb=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr1,nodes[i],this.namespaces);if(_14bb&&_14bb.length>0){var node2=_14bb[0];var _14bc=node2.childNodes;var _14bd=null;for(var h=0;h<_14bc.length;h++){if(_14bc[h].nodeType==4){_14bd=_14bc[h].nodeValue;}}if(_14bd){_14ba["_"+_14b5[k]]=_14bd;}}}}}if(_14b6){var _14be=_14b0.slice(1);this._addElements(nodes[i],_14be,_14ba);}if(_14b2){if(nodes[i].childNodes&&nodes[i].childNodes.length>0){var _14bf=nodes[i].childNodes;var temp="";for(var l=0;l<_14bf.length;l++){if(_14bf[l].nodeType==4){temp=temp+_14bf[l].nodeValue;}else{if(_14bf[l].nodeType==3){temp=temp+_14bf[l].nodeValue;}}}_14ba.value=temp;}else{_14ba.value="";}}}}}}});com.ibm.mm.iwidget.widget.IWidgetDefinitionImpl=com.ibm.mm.iwidget.widget.IWidgetDefinitionExtendedImpl;}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetInstanceExtendedImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetInstanceExtendedImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetInstanceExtendedImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetInstanceExtendedImpl",com.ibm.mm.iwidget.widget.IWidgetInstanceDefaultImpl,{constructor:function(_14c0,id){},_addWire:function(wire){return this.getWireModel()._addWire(wire);},_removeWire:function(id){return this.getWireModel()._removeWire(id);},addWire:function(_14c1,_14c2,_14c3){return this.getWireModel().addWire(_14c1,_14c2,_14c3);},removeWire:function(_14c4,_14c5,_14c6){return this.getWireModel().removeWire(_14c4,_14c5,_14c6);},getWires:function(){return this.getWireModel().getWires();},getWireModel:function(){if(!this.wiremodel){this.wiremodel=com.ibm.mashups.services.ServiceManager.getService("WireProviderFactoryService").createWireProvider(this);}return this.wiremodel;},_getPublicEvents:function(){if(!this.events){this.events={};var _14c7=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwEvent,this.rootElement,_14c7,true);var _14c8=[];com.ibm.mm.iwidget.Utils.findElementByAttribute("class",this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwEventDescription,this.rootElement,_14c8,true);if(_14c7.length>0){for(var i=0;i<_14c7.length;i++){var elem=_14c7[i];var _14c9=this._getEventDescription(elem,_14c8);var id=elem.getAttribute("title");this.events[id]=_14c9;}}}return this.events;},_getEventDescription:function(elem,_14ca){var id=elem.getAttribute("title");var _14cb=dojo.query("."+this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwDescRef,elem);var _14cc=null;if(_14cb){_14cc=_14cb[0];}var _14cd=null;if(_14cc){_14cd=_14cc.getAttribute("href");if(_14cd.indexOf("#")==0){_14cd=_14cd.slice(1);}}var _14ce=null;for(var j=0;j<_14ca.length;j++){var temp=_14ca[j];if(temp.getAttribute("title")==_14cd){_14ce=temp;break;}}var obj={};obj.name=id;var alias=_14cc.innerHTML;alias=alias.replace(/^\s*/,"").replace(/\s*$/,"");if(alias){obj.alias=alias;}var _14cf=elem.className;if(_14cf.indexOf(this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwPublished)>0){obj.isPublished=true;}if(_14cf.indexOf(this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwHandled)>0){obj.isHandled=true;}var list=[];list.push(this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwHandler);list.push(this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwNewWire);list.push(this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwRemoveWire);for(var s=0;s<list.length;s++){var _14d0=dojo.query("."+list[s],elem);if(_14d0){var aNode=_14d0[0];if(aNode){switch(s){case 0:obj.handlingFn=aNode.innerHTML;break;case 1:obj.attributes=obj.attributes?obj.attributes:{};obj.attributes.onNewWire=aNode.innerHTML;break;case 2:obj.attributes=obj.attributes?obj.attributes:{};obj.attributes.onRemoveWire=aNode.innerHTML;break;default:break;}}}}if(_14ce){var _14d1=this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwPayloadType;var list=dojo.query("."+_14d1,_14ce);if(list&&list[0]){obj.type=list[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"");}obj.localizedAttributes={};var _14d2=this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwTitle;var _14d3=this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwValue;var _14d4=dojo.query("."+_14d2,_14ce);if(_14d4&&_14d4[0]){dojo.query("."+_14d3,_14d4[0]).forEach(function(elem){var lang=elem.getAttribute("lang");var value=elem.innerHTML.replace(/^\s*/,"").replace(/\s*$/,"");if(!obj.localizedAttributes[lang]){obj.localizedAttributes[lang]={};}obj.localizedAttributes[lang].title=value;});}var _14d5=this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwDescription;var _14d3=this.ns+com.ibm.mm.iwidget.Constants.CSSCLASS_INSTANCE.iwValue;var _14d6=dojo.query("."+_14d5,_14ce);if(_14d6&&_14d6[0]){dojo.query("."+_14d3,_14d6[0]).forEach(function(elem){var lang=elem.getAttribute("lang");var value=elem.innerHTML.replace(/^\s*/,"").replace(/\s*$/,"");if(!obj.localizedAttributes[lang]){obj.localizedAttributes[lang]={};}obj.localizedAttributes[lang].description=value;});}}return new com.ibm.mm.iwidget.IEventDescriptionImpl(obj);}});com.ibm.mm.iwidget.widget.IWidgetInstanceImpl=com.ibm.mm.iwidget.widget.IWidgetInstanceExtendedImpl;}if(!dojo._hasResource["com.ibm.mm.iwidget.itemset.ShareableItemSetImpl"]){dojo._hasResource["com.ibm.mm.iwidget.itemset.ShareableItemSetImpl"]=true;dojo.provide("com.ibm.mm.iwidget.itemset.ShareableItemSetImpl");dojo.declare("com.ibm.mm.iwidget.itemset.ShareableItemSetImpl",com.ibm.mashups.iwidget.itemset.ShareableItemSet,{constructor:function(_14d7,_14d8,name){this.DELETE_TOKEN="DELETE_TOKEN";this.parent=_14d7;if(name){this.id=name;}if(_14d8){this.id=_14d8.id;this.alias=_14d8.alias?_14d8.alias:null;this.defData=_14d8;}this.mapping={};this.items={};if(_14d8){var _14d9=_14d8.items;for(var i in _14d9){if(Object.prototype.hasOwnProperty.call(_14d9,i)){var id=i;var alias=_14d9[i].alias?_14d9[i].alias:null;this.items[i]={id:id};if(alias){this.mapping[alias]=id;this.items[i].alias=alias;}}}}this.navigationStateModel=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var psid=this.alias;if(!psid){psid=this.id;}this.shareableAccessor=com.ibm.mashups.enabler.model.state.AccessorFactory.getShareableParameterSetAccessor(this.navigationStateModel,psid,"global");this._isDirty=false;this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);},addListener:function(fn){var id=this.alias;if(!id){id=this.id;}var me=this;var _14da=function(_14db){if(me._isSender){return;}var _14dc=_14db.changes?_14db.changes:null;if(_14dc){for(var i=0;i<_14dc.length;i++){var alias=_14dc[i].alias;if(me.mapping){if(me.mapping[alias]){var _14dd=me.mapping[alias];_14dc[i].id=_14dd;}}}}if(_14dc.length>0){var _14de=new com.ibm.mm.iwidget.IEventImpl("onItemSetChanged",null,_14db);if(dojo.isString(fn)){var scope=me.parent._getHandlerScope(fn);if(scope){fn=dojo.hitch(scope,fn);}}fn(_14de);}};var _14df=this.shareableAccessor.registerListener(_14da);return _14df;},removeListener:function(_14e0){return this.shareableAccessor.removeListener(_14e0);},setItemValue:function(_14e1,value){if(!_14e1){return null;}if(!value){return null;}if(typeof (this._isDirty)!="undefined"&&!this._isDirty){this._isDirty=true;this._changedItems={};}var alias=this._resolveMapping(_14e1);if(!alias){alias=_14e1;}this._changedItems=this._changedItems?this._changedItems:{};this._changedItems[alias]=value;return this;},getItemValue:function(_14e2){var id=this._resolveMapping(_14e2);if(!id){id=_14e2;}if(this._isDirty&&this._changedItems){if(this._changedItems[id]&&this._changedItems[id]!=this.DELETE_TOKEN){return this._changedItems[id];}else{if(this._changedItems[id]&&this._changedItems[id]==this.DELETE_TOKEN){return null;}}}var _14e3=this.alias;if(!_14e3){_14e3=this.id;}var value=this.shareableAccessor.getItemValue(id);if(!value){value=null;}return value;},getAllNames:function(){var _14e4=this.alias;if(!_14e4){_14e4=this.id;}var names=this.shareableAccessor.getAllNames();if(this._isDirty){var obj={};for(var i=0;i<names.length;i++){var aName=names[i];obj[aName]=aName;}if(this._changedItems){for(var j in this._changedItems){if(this._changedItems[j]&&this._changedItems[j]==this.DELETE_TOKEN&&obj[j]){obj[j]=null;}else{if(this._changedItems[j]&&!obj[j]){obj[j]=j;}}}}var arr=[];for(var k in obj){if(Object.prototype.hasOwnProperty.call(obj,k)){arr.push(k);}}names=arr;}for(var s=0;s<names.length;s++){var id=names[s];if(this.mapping[id]){names[s]=this.mapping[id];}}if(names.length===0){return null;}return names;},removeItem:function(_14e5){if(typeof (this._isDirty)!="undefined"&&!this._isDirty){this._isDirty=true;this._changedItems={};}var names=this.getAllNames();if(names===null){return null;}var _14e6=false;for(var i=0;i<names.length;i++){if(names[i]==_14e5){_14e6=true;}}if(!_14e6){return null;}var id=this._resolveMapping(_14e5);if(!id){id=_14e5;}this._changedItems=this._changedItems?this._changedItems:{};this._changedItems[id]=this.DELETE_TOKEN;return this;},getItemSetDescription:function(){return null;},commit:function(){if(this._isDirty){this._isSender=true;var _14e7=this.alias;if(!_14e7){_14e7=this.id;}this.shareableAccessor._setItems(this._changedItems);var _14e8=this.navigationStateModel.commit();_14e8.start();this._isSender=false;}this._changedItems=null;this._isDirty=false;},_resolveMapping:function(name){if(!name){return null;}if(!this.items){return null;}if(this.items[name]&&this.items[name].alias){return this.items[name].alias;}return null;}});com.ibm.mm.iwidget.itemset.ShareableItemSetFactory=com.ibm.mm.iwidget.itemset.ShareableItemSetImpl;if((ibmConfig.enablerLayerModules)&&(dojo.indexOf(ibmConfig.enablerLayerModules,"CoreModel")>=0)){dojo["require"]("com.ibm.mm.iwidget.itemset.ShareableItemSetExtendedModelImpl");}}if(!dojo._hasResource["com.ibm.mm.iwidget.DeferredLiveTextUnprocessImpl"]){dojo._hasResource["com.ibm.mm.iwidget.DeferredLiveTextUnprocessImpl"]=true;dojo.provide("com.ibm.mm.iwidget.DeferredLiveTextUnprocessImpl");dojo.declare("com.ibm.mm.iwidget.DeferredLiveTextUnprocessImpl",com.ibm.mm.enabler.DeferredImpl,{constructor:function(_14e9){this.wrapper=_14e9;},start:function(sync){if(sync){return;}var _14ea=this.wrapper.getIWidgetInstance();if(dojo.isFunction(this.wrapper.iScope._onGetMarkup)){this.wrapper.iScope._onGetMarkup();}var _14eb=dojo.clone(this.wrapper.rootElement);dojo.publish("/com/ibm/mashups/livetext/livetextunchange",[_14eb,true,null,null,dojo.hitch(this,this._unchangeCompleteCallback),this.includeParent]);},setIncludeParent:function(value){this.includeParent=value;},getIncludeParent:function(){return this.includeParent;},_unchangeCompleteCallback:function(node){if(dojo.isFunction(this.getFinishedCallback())){this.finish(node,200);}}});}if(!dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetWrapperExtendedImpl"]){dojo._hasResource["com.ibm.mm.iwidget.widget.IWidgetWrapperExtendedImpl"]=true;dojo.provide("com.ibm.mm.iwidget.widget.IWidgetWrapperExtendedImpl");dojo.declare("com.ibm.mm.iwidget.widget.IWidgetWrapperExtendedImpl",com.ibm.mm.iwidget.widget.IWidgetWrapperDefaultImpl,{getMarkup:function(){return new com.ibm.mm.iwidget.DeferredLiveTextUnprocessImpl(this);},destroy:function(){if(this.widgetDef){var _14ec=this.widgetDef._getShareableItemSets();if(_14ec){var _14ed=null;for(var i in _14ec){if(Object.prototype.hasOwnProperty.call(_14ec,i)){if(this.shareableItemSets.listeners[i]){for(var j=0,l=this.shareableItemSets.listeners[i].length;j<l;++j){var _14ee=this.shareableItemSets.listeners[i][j];_14ed=this.shareableItemSets.itemsets[i];_14ed.removeListener(_14ee);}}}}}}this.inherited(arguments);},_getResourceBundle:function(){if(!this.iwMessages){this.iwMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","iwMessages");}return this.iwMessages;},_logInlineMessage:function(_14ef,e){_14ef._getResourceBundle();dojo.query("."+_14ef.ns+"loading",_14ef.rootElement).forEach(function(elem){elem.innerHTML="";var _14f0=_14ef.id;if(_14ef.getIWidgetInstance().getIDescriptorItems().getItemValue("title",dojo.locale)){_14f0=unescape(_14ef.getIWidgetInstance().getIDescriptorItems().getItemValue("title",dojo.locale));com.ibm.mm.enabler.logging.LegacyLogger.logInlineMessage(elem,"error",dojo.string.substitute(_14ef.iwMessages.E_WIDGET_DISPLAY_FAIL_2,[_14f0,e.message]));}else{if(typeof (e)!=="undefined"&&null!==e){com.ibm.mm.enabler.logging.LegacyLogger.logInlineMessage(elem,"error",dojo.string.substitute(_14ef.iwMessages.E_WIDGET_DISPLAY_FAIL_2,[_14f0,e.message]));}else{elem.innerHTML=dojo.string.substitute(_14ef.iwMessages.E_WIDGET_INCORRECTCONFIG_1,[_14f0]);}}});},_logUpdateMarkupError:function(mode){this._getResourceBundle();var error=dojo.string.substitute(this.iwMessages.E_IWIDGETDEF_CONTENTNOTAVAILABLE_1,[mode]);},_loadWidgetSharedResource:function(cb2){var _14f1=this.widgetDef.getResources();this._getResourceBundle();if(typeof _14f1!="undefined"&&_14f1!==null){var size=_14f1.length-1;if(size==-1){cb2();}var _14f2=[];var temp=[];for(var x in _14f1){if(Object.prototype.hasOwnProperty.call(_14f1,x)){var _14f3=_14f1[x];if(_14f3.isImage()||_14f3.isCSS()){temp.push(_14f3);}else{_14f2.push(_14f3);}}}for(var y=0;y<temp.length;y++){_14f2.push(temp[y]);}var me=this;var mycb=function(i,_14f4,data,_14f5){if(data&&_14f5&&_14f4.isJS()){me.error="true";if(!me.data){me.data=[];}var msg=dojo.string.substitute(me.iwMessages.E_RESOURCE_LOAD_FAIL_2,[_14f4.src,data.message]);me.data.push({data:msg,status:_14f5});}if(size==i){if(me.error&&me.error=="true"){dojo.query("."+me.ns+"loading",me.rootElement).forEach(function(elem){elem.innerHTML="";var _14f6=unescape(me.getIWidgetInstance().getIDescriptorItems().getItemValue("title",dojo.locale));if(!_14f6){_14f6=me.widgetXMLUrl;}var _14f7="";for(var j in me.data){if(Object.prototype.hasOwnProperty.call(data,j)){_14f7=_14f7.concat(me.data[j].data).concat("\n");}}com.ibm.mm.enabler.logging.LegacyLogger.logInlineMessage(elem,"error",dojo.string.substitute(me.iwMessages.E_WIDGET_DISPLAY_FAIL_2,[_14f6,_14f7]));});me.error=null;me.data=null;}else{if(cb2){cb2();}}}};for(var i=0;i<_14f2.length;i++){var _14f8=_14f2[i];if(typeof _14f8!="undefined"&&_14f8!==null){com.ibm.mashups.services.ServiceManager.getService("resourceLoadService").loadResource(_14f8,this.id,dojo.partial(mycb,i,_14f8));}}}},handleEvent:function(_14f9){var _14fa=_14f9.declaredClass;if(typeof _14fa!="undefined"&&_14fa!==null&&_14fa=="com.ibm.mm.iwidget.IEventImpl"){var _14fb=_14f9.name;return this._handleEvent(_14fb,_14f9);}var scope=_14f9.scope;if(typeof scope!="undefined"&&scope!==null){if(scope=="instance"){scope=this.getIWidgetInstance();}else{if(scope=="eventmodel"){scope=this._getPublicEvents();}}}else{scope=this;}var _14fc=_14f9.methodname;if(typeof _14fc!="undefined"&&_14fc!==null){if(scope[_14fc]&&dojo.isFunction(scope[_14fc])){scope[_14fc].apply(scope,_14f9.params);}}},_handleEvent:function(_14fd,_14fe){_14fe=this._deserializePayload(_14fe);if(typeof _14fd=="undefined"||_14fd===null){return false;}if(!this.loaded){if(!this._eventqueue){this._eventqueue={};}this._eventqueue[_14fd]=_14fe;return;}try{if(_14fd==iwConstants.EVENTS.onNavStateChanged){return this._handleOnNavStateChanged(_14fe);}if(_14fd==iwConstants.EVENTS.onWindowStateChanged){var _14ff=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _1500=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_14ff,this.id);var value=_14fe.payload.newWindowState;_1500.setWindowState(value);return this._handleEventInternal(_14fd,_14fe);}if(_14fd==iwConstants.EVENTS.onModeChanged){if(this._inIframe()){var _1501={};_1501.methodname="_handleOnModeChange";_1501.hubclient=this.hubId;_1501.params=[_14fe.payload];var id="_stub_"+this.id;this.eventSvr._publishEvent(iwConstants.WIDGETEVENT_PREFIX+id,_1501,this.hubId);return;}return this._handleModeChange(_14fe);}if(_14fd=="onNewWire"){return this._handleNewWire(_14fe);}if(_14fd=="onRemoveWire"){return this._handleRemoveWire(_14fe);}return this._handleEventInternal(_14fd,_14fe);}catch(e){var _1502=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);_1502.severe("_handleEvent","widget:"+this.hubId+"eventName:"+_14fd+" HandleEventException:"+e);}},getPublicEventHandler:function(_1503){var _1504=this._getPublicEvents()||null;if(!_1504){return null;}var _1505=_1504.find(_1503)||null;if(!_1505){return null;}var _1506=_1505.handlingFn||null;if(!_1506){var _1507=_1505.getAttribute("isComplete");if(typeof _1507!=="undefined"&&_1507===false){var _1508=iwConstants.EVENTS.onIncompleteEventDescription;var _1509={eventDescription:_1505};var _150a=new com.ibm.mm.iwidget.IEventImpl(_1508,null,_1509);this._handleEventInternal(_1508,_150a);_1505=_1504.find(_1503);_1506=_1505.handlingFn;}}var _150b=null;if(_1506){if(dojo.isFunction(_1506)){_150b=_1506;}else{var scope=this._getHandlerScope(_1506)||null;if(scope){_150b=dojo.hitch(scope,_1506);}}}return _150b;},getPublishedEvents:function(){if(!this.publishedEvents){this.publishedEvents={};}return this.publishedEvents;},getHandledEvents:function(){if(!this.handledEvents){this.handledEvents={};}return this.handledEvents;},_inIframe:function(){if(this._isInIframe){return this._isInIframe;}var _150c=false;var type=this.eventSvr.getType();if(typeof type!="undefined"&&type==com.ibm.mm.iwidget.Constants.eventservice.type.IFRAME){_150c=true;}this._isInIframe=_150c;return this._isInIframe;},setMainframeId:function(_150d){this._mainframeId=_150d;},setModal:function(_150e){this._isModal=_150e;},isModal:function(){return this._isModal?this._isModal:false;},_handleDataSync:function(_150f){if(typeof _150f.attributes!="undefined"&&_150f.attributes!==null){var _1510=_150f.attributes;this._syncModifiableProperties(_1510,this.getIWidgetInstance().getAttributes());}if(typeof _150f.idescriptors!="undefined"&&_150f.idescriptors!==null){var _1511=_150f.idescriptors;this._syncModifiableProperties(_1511,this.getIWidgetInstance().getIDescriptorItems());}if(typeof _150f.wiremodel!="undefined"&&_150f.wiremodel!==null){var _1512=_150f.wiremodel;this._syncWireModel(_1512,this.getIWidgetInstance().getWireModel());}this.commit(true);},_syncModifiableProperties:function(_1513,_1514){var items=_1513._items;if(_1513._dirty){for(var i in items){if(Object.prototype.hasOwnProperty.call(items,i)){var name=i;var temp=items[i];if(dojo.isString(temp)){if(temp&&temp==_1514.DELETE_TOKEN){_1514.removeItem(name);}}else{var _1515=(items[i].readOnly)?items[i].readOnly:false;var _1516=items[i].values;if(typeof _1516!="undefined"&&_1516!==null){for(var j in _1516){if(Object.prototype.hasOwnProperty.call(_1516,j)){var value=_1516[j];if(value&&value==_1514.DELETE_TOKEN){_1514.removeItemValue(name,j);}else{if(value){_1514.setItemValue(name,value,_1515,j);}}}}}}}}}},_syncWireModel:function(_1517,_1518){var wires=_1517._wires;for(var i in wires){if(Object.prototype.hasOwnProperty.call(wires,i)){var aWire=wires[i];if(aWire._isDirty&&aWire._type&&aWire._type=="NEW"){_1518.addWire(aWire.SourceWidget,aWire.SourceEvent,aWire.TargetEvent);}else{if(aWire._isDirty&&aWire._type&&aWire._type=="DELETE"){_1518.removeWire(aWire.SourceWidget,aWire.SourceEvent,aWire.TargetEvent);}}}}var _1519=_1517._targets;_1518._targets=_1519;},setStateData:function(_151a){this.stateData=_151a;},updateState:function(){var _151b;if(!this._inIframe()){var _151c=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _151d=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_151c,this.id)||null;if(_151d){var _151e=_151d.getWidgetState("cp");if(_151e){_151b=new com.ibm.mm.iwidget.IEventImpl(iwConstants.EVENTS.onNavStateChanged,"json",_151e);this._handleEventInternal(iwConstants.EVENTS.onNavStateChanged,_151b);}}}else{if(this.stateData){_151b=new com.ibm.mm.iwidget.IEventImpl(iwConstants.EVENTS.onNavStateChanged,null,this.stateData);this._handleEventInternal(iwConstants.EVENTS.onNavStateChanged,_151b);}}},_handleOnNavStateChanged:function(_151f){if(!this._inIframe()){var state=_151f.payload;if(state){var _1520=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _1521=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_1520,this.id);_1521.setWidgetState("cp",state);var _1522=_1520.commit();_1522.start();}}else{var _1523={};_1523.methodname="_handleOnNavStateChanged";_1523.params=[_151f];this.eventSvr._publishEvent(this.eventSvr.WIDGETEVENT_PREFIX+"_stub_"+this.id,_1523);}},_initialize:function(){var lang=this.widgetDef.getDefaultLanguage()||null;if(lang){this.defaultLanguage=lang;}else{this.defaultLanguage="en";}var aMode=this._getInitDefaultMode()||null;if(!aMode){aMode=iwConstants.mode_view;}this.currentMode=aMode;this._handleSaveMode();this._initManagedItemSet();this._getShareableItemSets();this._getPublicEvents();this.getWires();},getPublicEvent:function(name){var _1524=this._getPublicEvents();return _1524.find(name);},_getPublicEvents:function(){if(!this.publicEvents){var _1525=com.ibm.mashups.services.ServiceManager.getService("WidgetEventModelFactoryService").createEventModel(this)||null;this.publicEvents=_1525;}return this.publicEvents;},_getPublishedEvents:function(){var _1526=this.getWidgetPublishedEvents()||null;var arr={};if(_1526){var i=0;for(i;i<_1526.length;i++){arr[_1526[i].name]=_1526[i];}}return arr;},_getHandledEvents:function(){var _1527=this.getWidgetHandledEvents()||null;var arr={};if(_1527){var i=0;for(i;i<_1527.length;i++){arr[_1527[i].name]=_1527[i];}}return arr;},getWidgetPublishedEvents:function(){var _1528=this._getPublicEvents();if(_1528){var _1529={};_1529.isPublished="true";return _1528.getEvents(_1529);}return null;},getWidgetHandledEvents:function(){var _152a=this._getPublicEvents();if(_152a){var _152b={};_152b.isHandled="true";return _152a.getEvents(_152b);}return null;},getWires:function(){return this.getIWidgetInstance().getWires();},_handleNewWire:function(_152c){var _152d=_152c.payload;var _152e=this.getIWidgetInstance().getWireModel();_152e.registerTargets(_152d.targetWidget,_152d.targetEvent,_152d.sourceEvent);this.commit();var _152f=_152d.sourceEvent;var _1530=this._getPublicEvents();if(!_1530){return false;}var _1531=_1530.find(_152f);if(_1531){var _1532=_1531.getOnNewWire();if(_1532){var scope=this._getHandlerScope(_1532);if(scope&&dojo.isFunction(scope)){scope(_152c);}else{if(scope&&dojo.isObject(scope)){scope[_1532](_152c);}}return true;}}return false;},_handleRemoveWire:function(_1533){var _1534=_1533.payload;var _1535=_1534.targetEvent;if(this.id==_1534.sourceWidget){_1535=_1534.sourceEvent;}var _1536=this._getPublicEvents()||null;if(!_1536){return false;}var _1537=_1536.find(_1535)||null;if(_1537){var _1538=_1537.getOnRemoveWire();if(_1538){var scope=this._getHandlerScope(_1538);if(scope&&dojo.isFunction(scope)){scope(_1533);}else{if(scope&&dojo.isObject(scope)){scope[_1538](_1533);}}return true;}}return false;},_getShareableItemSets:function(){if(this.shareableItemSets){return this.shareableItemSets;}this.shareableItemSets={};this.shareableItemSets.mapping={};this.shareableItemSets.itemsets={};this.shareableItemSets.listeners={};var _1539=this.widgetDef._getShareableItemSets();if(_1539){var _153a=null;for(var i in _1539){if(Object.prototype.hasOwnProperty.call(_1539,i)){_153a=new com.ibm.mm.iwidget.itemset.ShareableItemSetFactory(this,_1539[i]);var _153b=_1539[i].onItemSetChanged||null;if(_153b){if(!this.shareableItemSets.listeners[i]){this.shareableItemSets.listeners[i]=[];}this.shareableItemSets.listeners[i].push(_153a.addListener(_153b));}this.shareableItemSets.itemsets[i]=_153a;var alias=_1539[i].alias||null;if(alias){this.shareableItemSets.mapping[alias]=alias;}}}}return this.shareableItemSets;},_getShareableItemSet:function(id){var _153c=this._getShareableItemSets();if(_153c&&_153c.mapping[id]){var _153d=_153c.mapping[id];return _153c.itemsets[_153d];}else{if(_153c&&_153c.itemsets[id]){return _153c.itemsets[id];}}var _153e=new com.ibm.mm.iwidget.itemset.ShareableItemSetFactory(this.widgetwrapper,null,name);_153c.itemsets[id]=_153e;return _153c.itemsets[id];},_executeCallbackQueue:function(){com.ibm.mashups.services.ServiceManager.getService("resourceLoadService").executeCallbackQueue(this.id);},_handleSaveMode:function(){var _153f=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _1540=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_153f,this.id);_1540.setWidgetMode(this.currentMode);var _1541=_153f.commit();_1541.start();},_transform:function(_1542,_1543){var event=this.getPublicEvent(_1542);if(!(!event||!event.type||!_1543.type)){var _1544=new com.ibm.mm.iwidget.IEventImpl(event.name,event.type,_1543.payload,null);var _1545=new com.ibm.mm.enabler.utils.EventTransformerImpl();var _1546=_1545._transform(_1543,_1544)||null;if(_1546){_1543=_1546;}}return _1543;},_getModeFromNavStateModel:function(){var _1547=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _1548=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(_1547,this.id);return _1548.getWidgetMode();}});com.ibm.mm.iwidget.widget.IWidgetWrapperImpl=com.ibm.mm.iwidget.widget.IWidgetWrapperExtendedImpl;}if(!dojo._hasResource["com.ibm.mashups.livetext.CallbackModel"]){dojo._hasResource["com.ibm.mashups.livetext.CallbackModel"]=true;dojo.provide("com.ibm.mashups.livetext.CallbackModel");dojo.declare("com.ibm.mashups.livetext.CallbackModel",null,{preProcessCallbackFunc:function(_1549,_154a,_154b){},postProcessCallbackFunc:function(_154c,_154d,_154e,_154f){}});}if(!dojo._hasResource["com.ibm.mashups.livetext.ConfigEntry_API"]){dojo._hasResource["com.ibm.mashups.livetext.ConfigEntry_API"]=true;dojo.provide("com.ibm.mashups.livetext.ConfigEntry_API");dojo.provide("com.ibm.mashups.livetext.ConfigEntry");dojo.declare("com.ibm.mashups.livetext.ConfigEntry",null,{constructor:function(match,_1550,_1551,path,_1552,_1553,id){},isEqual:function(entry){}});}if(!dojo._hasResource["com.ibm.mm.livetext.ConfigEntryImpl"]){dojo._hasResource["com.ibm.mm.livetext.ConfigEntryImpl"]=true;dojo.provide("com.ibm.mm.livetext.ConfigEntryImpl");dojo.declare("com.ibm.mm.livetext.ConfigEntryImpl",com.ibm.mashups.livetext.ConfigEntry,{constructor:function(match,_1554,_1555,path,_1556,_1557,id){this.match=match;this.wait=_1557;this.procEnc=_1554;this.mod=_1555;this.path=path;this.baseCls=_1556;this.id=id;},isEqual:function(entry){return entry&&entry.match==this.match&&entry.wait==this.wait&&entry.procEnc==this.procEnc&&entry.mod==this.mod&&entry.path==this.path&&entry.baseCls==this.baseCls&&entry.id==this.id;}});com.ibm.mashups.livetext.ConfigEntry=com.ibm.mm.livetext.ConfigEntryImpl;}if(!dojo._hasResource["com.ibm.mashups.livetext.ConfigEntry"]){dojo._hasResource["com.ibm.mashups.livetext.ConfigEntry"]=true;dojo.provide("com.ibm.mashups.livetext.ConfigEntry");}if(!dojo._hasResource["com.ibm.mashups.livetext.Exception"]){dojo._hasResource["com.ibm.mashups.livetext.Exception"]=true;dojo.provide("com.ibm.mashups.livetext.Exception");dojo.declare("com.ibm.mashups.livetext.Exception",null,{constructor:function(_1558,_1559){},getMessage:function(_155a){}});}if(!dojo._hasResource["com.ibm.mashups.livetext.LivetextBatchModel"]){dojo._hasResource["com.ibm.mashups.livetext.LivetextBatchModel"]=true;dojo.provide("com.ibm.mashups.livetext.LivetextBatchModel");dojo.declare("com.ibm.mashups.livetext.LivetextBatchModel",null,{processTag:function(nodes,_155b){},unprocessTag:function(nodes){}});}if(!dojo._hasResource["com.ibm.mashups.livetext.LivetextModel"]){dojo._hasResource["com.ibm.mashups.livetext.LivetextModel"]=true;dojo.provide("com.ibm.mashups.livetext.LivetextModel");dojo.declare("com.ibm.mashups.livetext.LivetextModel",null,{processTag:function(node){},unprocessTag:function(node){}});}if(!dojo._hasResource["com.ibm.mashups.livetext.ServiceModel_API"]){dojo._hasResource["com.ibm.mashups.livetext.ServiceModel_API"]=true;dojo.provide("com.ibm.mashups.livetext.ServiceModel_API");dojo.provide("com.ibm.mashups.livetext.ServiceModel");dojo.declare("com.ibm.mashups.livetext.ServiceModel",null,{SERVICE_NAME:"livetextService",init:function(_155c){},onTagChanged:function(_155d,_155e,_155f,_1560){},onUnchangeTag:function(node,_1561,_1562,_1563,_1564){},onTagContentChanged:function(_1565,_1566,_1567,_1568){},onAddConfigEntry:function(entry){},onRemoveConfigEntry:function(entry){}});com.ibm.mashups.livetext.ServiceModel.SERVICE_NAME=com.ibm.mashups.livetext.ServiceModel.prototype.SERVICE_NAME;}if(!dojo._hasResource["com.ibm.mm.livetext.ServiceModelImpl"]){dojo._hasResource["com.ibm.mm.livetext.ServiceModelImpl"]=true;dojo.provide("com.ibm.mm.livetext.ServiceModelImpl");dojo.declare("com.ibm.mm.livetext.ServiceModelImpl",com.ibm.mashups.livetext.ServiceModel,{_tagTypes:null,tagChanged:"/com/ibm/mashups/livetext/livetextchanged",unchangeTag:"/com/ibm/mashups/livetext/livetextunchange",tagStatusChange:"/com/ibm/mashups/livetext/livetextchanged",tagContentChanged:"/com/ibm/mashups/livetext/livetextcontentchanged",entryAdded:"/com/ibm/mashups/livetext/configentryadded",entryRemoved:"/com/ibm/mashups/livetext/configentryremoved",constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this.LogLevel=com.ibm.mashups.enabler.logging.LogLevel.TRACE;dojo.subscribe(this.entryAdded,this,"onAddConfigEntry");dojo.subscribe(this.entryRemoved,this,"onRemoveConfigEntry");},init:function(_1569){if(!_1569){_1569={};}this._loadTags(_1569);dojo.subscribe(this.tagChanged,this,"onTagChanged");dojo.subscribe(this.unchangeTag,this,"onUnchangeTag");dojo.subscribe(this.tagContentChanged,this,"onTagContentChanged");dojo.publish(this.tagContentChanged,[_1569.node||document,("continueAfterException" in _1569)?_1569.continueAfterException:true,_1569.preProcessCallbackFunc,_1569.postProcessCallbackFunc]);},_getNodes:function(node,_156a){var k=[];if(_156a=="undfined"||!_156a){console.error("Why are we having tagType undefined ::::");return k;}var _156b=_156a.match.split(",");var _156c;var a;var _156d=0;if(_156a.processEnclosedTags!="undefined"&&_156a.processEnclosedTags){a=[];for(_156d=0;_156d<_156b.length;_156d++){_156c=dojo.query(_156b[_156d],node);_156c.forEach(function(node,index,_156e){a.push(node);});}return a;}else{a=[];var b=[];for(_156d=0;_156d<_156b.length;_156d++){_156c=dojo.query(_156b[_156d]+" "+_156b[_156d],node);_156c.forEach(function(node,index,_156f){a.push(node);});var _1570=dojo.query(_156b[_156d],node);_1570.forEach(function(node,index,_1571){b.push(node);});}var _1572,_1573;while(a.length>0){_1572=a[0];_1573=0;while(_1573<b.length){if(_1572==b[_1573]){a.splice(0,1);b.splice(_1573,1);break;}else{_1573++;}}}return b;}},onTagChanged:function(node,_1574,_1575,_1576){var _1577="onTagChanged";if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_1577,"inside onTagChanged:"+node+":"+_1574+":"+_1575+":"+_1576);}var tag=null;for(var index=0;index<this._tagTypes.length;index++){tag=this._tagTypes[index];if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_1577,"Calling _processTypeTag for tag"+tag.baseClass);}this._processTypeTag(node,tag,_1574,_1575,_1576,true);}},onUnchangeTag:function(node,_1578,_1579,_157a,_157b){var tag=null;for(var index=0;index<this._tagTypes.length;index++){tag=this._tagTypes[index];this._unprocessTypeTag(node,tag,_1578,_1579,_157a,false);}if(dojo.isFunction(_157b)){_157b(node);}},onTagContentChanged:function(node,_157c,_157d,_157e){var _157f="onTagContentChanged";if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_157f,"inside onTagContentChanged"+node+":"+_157c+":"+_157d+":"+_157e);}var tag=null;for(var index=0;index<this._tagTypes.length;index++){tag=this._tagTypes[index];this._processTypeTag(node,tag,_157c,_157d,_157e,false);}},_processTypeTag:function(node,tag,_1580,_1581,_1582,_1583){tag=tag||null;if(tag===null){return;}var _1584="_processTypeTag";var nodes=[];if(_1583&&this._checkRoot(node,tag)){nodes[0]=node;}nodes=nodes.concat(this._getNodes(node,tag));var id=tag.id||null;if(id===null){id="";}if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_1584,"inside _processTypeTag length of nodes is :${0}: and base class is :${1}: and id of tag is :${2}:",[nodes.length,tag.baseClass,id]);}var _1585=[];_1585=_1585.concat(nodes);if(_1585.length>0){tag.loaded=tag.loaded||null;if(tag.loaded===null){this._loadTagHandler(tag);}var _1586=[];if(dojo.isFunction(_1581)){try{_1581(node,_1585,tag);}catch(error1){console.debug(error1);}}if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){if(tag.tagHandler instanceof com.ibm.mashups.livetext.LivetextBatchModel){this.LOGGER.trace(_1584,"calling processTag with tagHanlder ${0}",[tag.tagHandler.processTag]);}}if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_1584,"tagHanlder is Instanceof of LivetextBatchModel ${0}:",[(tag.tagHandler instanceof com.ibm.mashups.livetext.LivetextBatchModel)]);}if(tag.tagHandler instanceof com.ibm.mashups.livetext.LivetextBatchModel){try{tag.tagHandler.processTag(nodes,tag);}catch(error){this.LOGGER.trace("_processTypeTag","processTag tag:"+tag.baseClass+" error:"+error.message);_1586[_1586.length]=error;}}else{for(var _1587=0;_1587<nodes.length;_1587++){try{tag.tagHandler.processTag(nodes[_1587]);}catch(error2){this.LOGGER.trace("_processTypeTag","processTag tag:"+tag.baseClass+" error:"+error2.message);_1586[_1586.length]=error2;if(_1580){break;}}}}if(dojo.isFunction(_1582)){try{_1582(node,_1585,_1586,tag);}catch(error3){console.debug(error3);}}}},_unprocessTypeTag:function(node,tag,_1588,_1589,_158a,_158b){var tags=[];if(_158b&&this._checkRoot(node,tag)){tags[0]=node;}tags=tags.concat(this._getNodes(node,tag));var _158c=[];_158c=_158c.concat(tags);var _158d=[];if(dojo.isFunction(_1589)){try{_1589(node,_158c,tag);}catch(error1){console.debug(error1);}}if(_158c.length>0){tag.loaded=tag.loaded||null;if(tag.loaded===null){this._loadTagHandler(tag);}if(tag.tagHandler instanceof com.ibm.mashups.livetext.LivetextBatchModel){try{tag.tagHandler.unprocessTag(nodes,tag);}catch(error2){_158d[_158d.length]=error2;}}else{for(var _158e=0;_158e<tags.length;_158e++){try{tag.tagHandler.unprocessTag(tags[_158e]);}catch(error3){_158d[_158d.length]=error3;if(_1588){break;}}}}}if(dojo.isFunction(_158a)){try{_158a(node,_158c,_158d,tag);}catch(error4){console.debug(error4);}}},_checkRoot:function(node,tag){var _158f=false;node=node||null;if(node!==null&&node.nodeType){var copy={};copy.copyOfNode=node.cloneNode(false);copy.copyNodeParent=document.createElement("div");copy.copyNodeParent.appendChild(copy.copyOfNode);copy.result=this._getNodes(copy.copyNodeParent,tag);copy.result=copy.result||null;if(copy.result!==null&&copy.result.length>0){_158f=true;}delete copy.copyOfNode;delete copy.copyNodeParent;delete copy.result;}return _158f;},_loadTags:function(){var _1590="_loadTags";this._tagTypes=this._tagTypes||null;if(this._tagTypes===null){var _1591=this;if(ibmConfig.livetextService){this._tagTypes=ibmConfig.livetextService;}else{dojo.xhrGet({url:dojo.moduleUrl("com.ibm.mm.livetext","tagservice.entries.cfg"),handleAs:"text",sync:true,load:function(_1592){_1591._tagTypes=dojo.fromJson(_1592);if(_1591.LOGGER.isLoggable(_1591.LogLevel.TRACE)){_1591.LOGGER.trace(_1590,"got Inside _loadTags of ServiceModelImpl"+_1591._tagTypes);}},error:function(data){console.dir(data);}});}}},onAddConfigEntry:function(_1593){this._loadTags();if(!dojo.some(this._tagTypes,function(entry){return _1593.isEqual(entry);})){this._tagTypes.push({"match":_1593.match,"processEnclosedTags":_1593.procEnc,"waitOnPreTag":_1593.wait,"module":_1593.mod,"path":_1593.path,"baseClass":_1593.baseCls,"id":_1593.id});}},onRemoveConfigEntry:function(entry){this._loadTags();for(var i=0;;i<this._tagTypes.length){if(entry.isEqual(this._tagTypes[i])){this._tagTypes[i].splice(i,1);}else{i++;}}},parseDom:function(_1594,node){dojo.publish(this.tagChanged,[node]);},_loadTagHandler:function(tag){var _1595="_loadTagHandler";if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_1595,"inside _loadTagHandler:${0}:${1}:${2}:${3}",[tag.match,tag.baseClass,tag.module,tag.path]);}try{dojo.registerModulePath(tag.module,tag.path);dojo["require"](tag.baseClass);var _1596="{create:function(){return new "+tag.baseClass+"()}}";var _1597=dojo.fromJson(_1596);tag.tagHandler=_1597.create();if(this.LOGGER.isLoggable(this.LogLevel.TRACE)){this.LOGGER.trace(_1595,"loaded tagHandler:${0}:",[tag.tagHandler]);}tag.loaded=true;}catch(e){if(this.LOGGER.isLoggable(this.LogLevel.SEVERE)){this.LOGGER.severe(_1595,"Loading failed for path :${0}: and module :${1}:",[tag.path,tag.module]);}}}});com.ibm.mashups.services.ServiceManager.setService(com.ibm.mashups.livetext.ServiceModel.SERVICE_NAME,"com.ibm.mm.livetext.ServiceModelImpl");}if(!dojo._hasResource["com.ibm.mashups.livetext.ServiceModel"]){dojo._hasResource["com.ibm.mashups.livetext.ServiceModel"]=true;dojo.provide("com.ibm.mashups.livetext.ServiceModel");}if(!dojo._hasResource["tagservices.osgadgets"]){dojo._hasResource["tagservices.osgadgets"]=true;dojo.provide("tagservices.osgadgets");dojo.provide("com.ibm.mm.livetext.osgadgets");dojo.declare("tagservices.osgadgets",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},processTag:function(tag){var _1598="processTag";var _1599=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1599){this.LOGGER.entering(_1598,arguments);}var _159a=tag.getAttribute("id");gadgets.container.layoutManager=new gadgets.FloatLeftLayoutManager(_159a);var temp=dojo.query(".iw-Definition",tag)[0];if(!temp){temp=dojo.query(".mm_Definition",tag)[0];}var _159b=gadgets.container.createGadget({specUrl:temp.getAttribute("href")});gadgets.container.addGadget(_159b);gadgets.container.renderGadget(_159b);var _159c=function(_159d){var _159e=dojo.query(".gadgets-gadget",dojo.byId(_159a));if(_159e.length>0){if(_159e[0].tagName=="IFRAME"){_159e[0].style.height=(_159d.newHeight-40)+"px";_159e[0].style.width=(_159d.newWidth-30)+"px";}}};var _159f=dojo.byId("mm_ibm_skin_"+_159a);if(_159f.style.height){var _15a0=dojo.marginBox(_159f);_159c({"newHeight":_15a0.h-40,"newWidth":_15a0.w-20});}var _15a1=com.ibm.mashups.services.ServiceManager.getService("eventService");_15a1.subscribeEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+_159a,null,_159c);},unprocessTag:function(tag){var ns=["iw-","mm_"];for(var n=0;n<ns.length;n++){var _15a2=dojo.query("."+ns[n]+iwConstants.CSSCLASS_INSTANCE.iwContent,tag);for(var i=0;i<_15a2.length;i++){com.ibm.mm.enabler.utils.Dom.destroyNode(_15a2[i]);}}}});}if(!dojo._hasResource["tagservices.skins"]){dojo._hasResource["tagservices.skins"]=true;dojo.provide("tagservices.skins");dojo.provide("com.ibm.mm.livetext.skins");dojo.declare("tagservices.skins",null,{skinIdPrefix:"mm_ibm_skin_",allSkins:[],allVars:[],tempSkinHtmlObj:null,tempSkinJsObj:null,isProcessing:0,waitingList:[],subscribeHandler:null,skinAttachEvent:"/skinservice/attachEnd",LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger("tagservices.skins"),processTag:function(tag){this.tempSkinHtmlObj={};this.tempSkinJsObj={};if(!tag){return;}var _15a3=tag.getAttribute("skin");this._getSkinTemplate(_15a3,tag);},unprocessTag:function(tag){var _15a4=this._findSkinNode(tag);var _15a5=_15a4.parentNode;_15a5.insertBefore(tag,_15a4);com.ibm.mm.enabler.utils.Dom.destroyNode(_15a4);},_findSkinNode:function(node){var _15a6=node;while(_15a6&&_15a6.id!=this.skinIdPrefix+node.id){_15a6=_15a6.parentNode;}return _15a6;},_getSkinTemplate:function(_15a7,tag){var aSkin=this.allSkins[_15a7];if(!aSkin){var _15a8=this;var _15a9=this._getSkinResourceUrl(_15a7,"skin.html");var _15aa=this._getSkinResourceUrl(_15a7,"skin.js");dojo.xhrGet({url:_15a9,handleAs:"text",sync:true,load:function(_15ab){dojo.xhrGet({url:_15aa,handleAs:"json",sync:true,load:function(_15ac){_15ab=_15ab.replace(/<!--.*-->\s*/,"");_15a8.allSkins[_15a7]=_15ab;_15a8.allVars[_15a7]=_15ac;_15a8.startAttatchSkin(_15a7,tag);},error:function(data){_15a8.allSkins[_15a7]=_15ab;_15a8.startAttatchSkin(_15a7,tag);}});},error:function(data){this.LOGGER.severe("_getSkinTemplate",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_LOAD_TEMPLATE_FAIL_1,[data]));}});}else{this.startAttatchSkin(_15a7,tag);}},startAttatchSkin:function(_15ad,tag){if(this.isProcessing===0){this.executeReplaceSkin(_15ad,tag);}else{this.addToWaitingList(_15ad,tag);}},chooseNext:function(){if(this.waitingList.length!==0){var _15ae=this.waitingList.pop();this.executeReplaceSkin(_15ae.skin,_15ae.tag);}},addToWaitingList:function(_15af,tag){if(!this.subscribeHandler){this.subscribeHandler=dojo.subscribe(this.skinAttachEvent,this,"chooseNext");}var _15b0={};_15b0.skin=_15af;_15b0.tag=tag;this.waitingList.push(_15b0);},executeReplaceSkin:function(_15b1,tag){this.isProcessing=1;var temp=this.allSkins[_15b1];if(temp){var _15b2=this._getNodeToReplace(tag);var _15b3=_15b2.parentNode;var anId=dojox.uuid.generateRandomUuid().replace(/\-/g,"");var args=this._getArgs(_15b1,tag,anId);if(!args){this.LOGGER.severe("executeReplaceSkin",com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_NOT_EXIST_0);return;}var _15b4=this._getSkinResourceUrl(_15b1,"skin.css");com.ibm.mm.builder.utils.htmlUtil.loadCss(_15b4);if(builderConfig.isBidi){var _15b5=this._getSkinResourceUrl(_15b1,"skin_rtl.css");com.ibm.mm.builder.utils.htmlUtil.loadCss(_15b5);}var _15b6=dojo.string.substitute(temp,args);_15b6=_15b6.replace(/\/>/g,"></div>");var _15b7=this._getNodeFromMarkup(_15b6);dojo.addClass(_15b7,"mumWidgetTitleBar");_15b3.replaceChild(_15b7,_15b2);var tNode=dojo.byId(anId);tNode.parentNode.replaceChild(tag,tNode);if(!(dojo.hasClass(_15b2,"iw-iWidget")||dojo.hasClass(_15b2,"mm_iWidget"))){}var para={};para.widgetId=tag.id;para.skinNodeId=_15b7.id;para.skinParam=args;com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.skinLoaded",para);}this.isProcessing=0;dojo.publish(this.skinAttachEvent,[null]);},_getSkinResourceUrl:function(_15b8,_15b9){try{var _15ba=com.ibm.mm.builder.utils.skinUtil._getSkinModel();var skin=com.ibm.mm.builder.utils.skinUtil.getSkinNode(_15b8)||com.ibm.mm.builder.utils.skinUtil.getDefaultSkin();var url=_15ba.findResourceURL(skin,_15b9);return url;}catch(ex){this.LOGGER.severe("_getSkinResourceUrl",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_LOAD_ROOT_FAIL_1,[ex.message]));}return null;},_getArgs:function(_15bb,tag,anId){var args={};var _15bc=this.allVars[_15bb];if(_15bc){dojo.mixin(args,_15bc);}args.widgetBody="<div id='"+anId+"'/>";args.skinId=this.skinIdPrefix+tag.id;if(!args.process){args.process=function(_15bd,tagId){};}args.process(_15bb,tag.id);return args;},_getNodeMarkup:function(tag){var _15be=document.createElement("div");_15be.appendChild(tag.cloneNode(true));var _15bf=_15be.innerHTML;_15be.removeChild(_15be.firstChild);return _15bf;},_getNodeFromMarkup:function(_15c0){var _15c1=document.createElement("div");_15c1.innerHTML=_15c0;return _15c1.removeChild(_15c1.firstChild);},_getNodeToReplace:function(tag){var node=dojo.byId(this.skinIdPrefix+tag.id);if(!node){node=tag;}return node;},_showParent:function(node){var _15c2=node.parentNode;while(_15c2){_15c2=_15c2.parentNode;}}});}if(!dojo._hasResource["tagservices.widgets"]){dojo._hasResource["tagservices.widgets"]=true;dojo.provide("tagservices.widgets");dojo.provide("com.ibm.mm.livetext.widgets");dojo.declare("tagservices.widgets",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;},processTag:function(tag){var _15c3="processTag";var _15c4=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_15c4){this.LOGGER.entering(_15c3,arguments);}var id=tag.getAttribute("id");var _15c5=tag.getAttribute("lazyLoad");if(typeof (id)!="undefined"){var _15c6=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().createWidget(tag);if(_15c6){if(!_15c5||(_15c5&&_15c5!="true")){com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().renderWidget(_15c6);}else{_15c6.lazyLoad=true;}}}},unprocessTag:function(tag){var ns=["iw-","mm_"];for(var n=0;n<ns.length;n++){var _15c7=dojo.query("."+ns[n]+iwConstants.CSSCLASS_INSTANCE.iwContent,tag);for(var i=0;i<_15c7.length;i++){com.ibm.mm.enabler.utils.Dom.destroyNode(_15c7[i]);}}}});}if(!dojo._hasResource["com.ibm.mm.iwidget.itemset.ShareableItemSetExtendedModelImpl"]){dojo._hasResource["com.ibm.mm.iwidget.itemset.ShareableItemSetExtendedModelImpl"]=true;dojo.provide("com.ibm.mm.iwidget.itemset.ShareableItemSetExtendedModelImpl");dojo.declare("com.ibm.mm.iwidget.itemset.ShareableItemSetExtendedModelImpl",com.ibm.mm.iwidget.itemset.ShareableItemSetImpl,{constructor:function(_15c8,_15c9,name){var _15ca=com.ibm.mm.enabler.utils.Model.getCurrentPageDeferred().start();var scope=_15ca.getMetaData("param.sharing.scope");if(!scope){scope="global";}var psid=this.alias;if(!psid){psid=this.id;}this.shareableAccessor=com.ibm.mashups.enabler.model.state.AccessorFactory.getShareableParameterSetAccessor(this.navigationStateModel,psid,scope);}});com.ibm.mm.iwidget.itemset.ShareableItemSetFactory=com.ibm.mm.iwidget.itemset.ShareableItemSetExtendedModelImpl;}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.RoleNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.RoleNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.RoleNode_API");dojo.provide("com.ibm.mashups.enabler.ac.RoleNode");dojo.declare("com.ibm.mashups.enabler.ac.RoleNode",[com.ibm.mashups.enabler.Identifiable],{getRoleName:function(){},getRoleType:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.RoleNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.RoleNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.RoleNodeImpl");dojo.declare("com.ibm.mm.enabler.ac.RoleNodeImpl",[com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.TransformableImpl,com.ibm.mm.enabler.EditLinkProviderImpl],{constructor:function(data,_15cb,_15cc){this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_AC,this.nsf.NS_AI]);this.modified=false;this.xmlData=data;this.um=_15cb;if(_15cc){this.roleType=_15cc;}else{this.roleType=com.ibm.mashups.enabler.ac.RoleType.UNKNOWN;var expr="atom:content/ac:role";var roles=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(roles&&roles.length>0){var rt=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(roles[0],"ac:type","type",this.ns.ac);if(rt){if(rt.toUpperCase().indexOf(com.ibm.mashups.enabler.ac.RoleType.USER)===0){this.roleType=com.ibm.mashups.enabler.ac.RoleType.USER;}else{if(rt.toUpperCase().indexOf(com.ibm.mashups.enabler.ac.RoleType.EDITOR)===0){this.roleType=com.ibm.mashups.enabler.ac.RoleType.EDITOR;}else{if(rt.toUpperCase().indexOf(com.ibm.mashups.enabler.ac.RoleType.MANAGER)===0){this.roleType=com.ibm.mashups.enabler.ac.RoleType.MANAGER;}else{if("EDIT"==rt.toUpperCase()){this.roleType=com.ibm.mashups.enabler.ac.RoleType.EDITOR;}else{if("MANAGE"==rt.toUpperCase()){this.roleType=com.ibm.mashups.enabler.ac.RoleType.MANAGER;}}}}}}}}},getRoleName:function(){var expr="atom:content/ac:role";var roles=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(roles&&roles.length>0){var rt=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(roles[0],"ac:type","type",this.ns.ac);return rt;}return this.getRoleType();},getRoleType:function(){return this.roleType;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.RoleNode"]){dojo._hasResource["com.ibm.mashups.enabler.ac.RoleNode"]=true;dojo.provide("com.ibm.mashups.enabler.ac.RoleNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.MemberNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.MemberNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.MemberNode_API");dojo.provide("com.ibm.mashups.enabler.ac.MemberNode");dojo.declare("com.ibm.mashups.enabler.ac.MemberNode",null,{getEntity:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.MemberNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.MemberNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.MemberNodeImpl");dojo.declare("com.ibm.mm.enabler.ac.MemberNodeImpl",[com.ibm.mm.enabler.EditLinkProviderImpl],{constructor:function(_15cd,data,_15ce){this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_AC,this.nsf.NS_AI]);this.prefix="role";this.modified=false;this.xmlData=data;this.um=_15ce;this.roleID=_15cd;if(this.xmlData){var expr="atom:content/ac:member";var _15cf=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_15cf&&_15cf.length>0){this.memberID=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_15cf[0],"ac:id","id",this.ns.ac);this.memberType=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_15cf[0],"ac:type","type",this.ns.ac);if(this.memberID){var e=null;if(this.memberType=="user"){e=this.um.find(this.memberID).start();}else{e=this.um.findGroupByID(this.memberID).start();if((typeof e=="undefined")||(e===null)){e=this.um.find(this.memberID).start();}}this.entity=e;}}}},getEntity:function(){return this.entity;},getID:function(){if(this.entity){return this.entity.getID();}return this.memberID;},_toEntry:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.MemberNode"]){dojo._hasResource["com.ibm.mashups.enabler.ac.MemberNode"]=true;dojo.provide("com.ibm.mashups.enabler.ac.MemberNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.MemberModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.MemberModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.MemberModel_API");dojo.provide("com.ibm.mashups.enabler.ac.MemberModel");dojo.declare("com.ibm.mashups.enabler.ac.MemberModel",[com.ibm.mashups.enabler.ListModelController],{create:function(_15d0){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.MemberModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.MemberModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.MemberModelImpl");dojo.declare("com.ibm.mm.enabler.ac.MemberModelImpl",[com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.DeferredIteratorImpl,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl],{constructor:function(_15d1,_15d2,_15d3,_15d4){this.roleID=_15d1;this.accessControlModel=_15d2;this.um=_15d3;this.cid=0;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_AC,this.nsf.NS_AI,this.NS_CREATION_CONTEXT]);this.prefix="role";this.xmlDom=com.ibm.mm.enabler.utils.Dom.createDocument();this.accessControlModel.membersCursor[this.roleID]=0;if(_15d4){this.xmlData=undefined;this.accessControlModel.membersEntries[this.roleID]=[];this.accessControlModel.membersEntries[this.roleID][0]=null;return;}else{this.xmlData=this.accessControlModel.xmlDataMember[this.roleID];var expr="//atom:entry";var _15d5=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_15d5&&_15d5.length>0){for(var i=0;i<_15d5.length;i++){var node=new com.ibm.mm.enabler.ac.MemberNodeImpl(this.roleID,_15d5[i],this.um);this.accessControlModel.membersEntries[this.roleID][this.accessControlModel.membersCursor[this.roleID]+i]=node.getID();this.accessControlModel._cacheNodeMembers(this.roleID,node);}var len=this.accessControlModel.membersEntries[this.roleID].length;this.accessControlModel.membersEntries[this.roleID][len]=null;}else{this.accessControlModel.membersEntries[this.roleID]=[];this.accessControlModel.membersEntries[this.roleID][0]=null;}}},create:function(_15d6){if(!_15d6){throw new Error("MemberModelImpl.create: no context");}if(!_15d6.type){throw new Error("MemberModelImpl.create: no type context");}if(!_15d6.id){throw new Error("MemberModelImpl.create: no type context");}var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom));var title=com.ibm.mm.enabler.utils.Utils.createNode("atom:title",this.ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(title,"Member");entry.appendChild(title);var _15d7=com.ibm.mm.enabler.utils.Utils.createNode("atom:updated",this.ns.atom);var time=new Date();com.ibm.mm.enabler.utils.Dom.textContent(_15d7,time.toGMTString());entry.appendChild(_15d7);var _15d8=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);_15d8.setAttribute("type","application/xml");var _15d9=com.ibm.mm.enabler.utils.Utils.createNode("ac:member",this.ns.ac);com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_15d9,"ac:id",this.nsf.getNameSpaceUri(this.nsf.NS_AC),_15d6.id);com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_15d9,"ac:type",this.nsf.getNameSpaceUri(this.nsf.NS_AC),_15d6.type);_15d8.appendChild(_15d9);entry.appendChild(_15d8);var _15da=new com.ibm.mm.enabler.ac.MemberNodeImpl(this.roleID,entry,this.um);return _15da;},iterator:function(){return this;},start:function(sync){while(this._hasNext(this,sync)){if(this._next(this,sync)){continue;}else{break;}}},hasNext:function(){return this._hasNext(null,true);},_hasNext:function(_15db,sync){var _15dc=false;var next=this.accessControlModel.membersEntries[this.roleID][this.accessControlModel.membersCursor[this.roleID]];if(next!==null&&next!==undefined){_15dc=true;}return _15dc;},next:function(){return this._next(null,true);},_next:function(_15dd,sync){var _15de=this._hasNext(_15dd,sync);var _15df=this.accessControlModel.membersEntries[this.roleID];var _15e0=this.accessControlModel.membersLoadedNodes[this.roleID];var ret=_15de?_15e0[_15df[this.accessControlModel.membersCursor[this.roleID]]]:null;this.accessControlModel.membersCursor[this.roleID]++;return ret;},size:function(){return this.accessControlModel.membersSizeValue[this.roleID];},setCursorPosition:function(_15e1){this.accessControlModel.membersCursor[this.roleID]=_15e1;},getCursorPosition:function(){return this.accessControlModel.membersCursor[this.roleID];},insert:function(node,_15e2){if(!this.accessControlModel.changedProperties.role){this.accessControlModel.changedProperties.role=this.accessControlModel.getRoleModel()._getRoles();}this.accessControlModel.membersCreatedNodes[this.roleID][node.getID()]=node;var _15e3=this.accessControlModel.membersEntries[this.roleID].length;if((!_15e3)||(_15e3===0)){this.accessControlModel.membersEntries[this.roleID][0]=node.getID();this.accessControlModel.membersEntries[this.roleID][1]=null;}else{this.accessControlModel.membersEntries[this.roleID][_15e3-1]=node.getID();this.accessControlModel.membersEntries[this.roleID][_15e3]=null;}this.accessControlModel._cacheNodeMembers(this.roleID,node);},find:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,id);},_find:function(_15e4,sync,id){if(id in this.accessControlModel.membersDeletedNodes[this.roleID]){if(_15e4){_15e4.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}if(id in this.accessControlModel.membersLoadedNodes[this.roleID]){if(_15e4){_15e4.finish(this.accessControlModel.membersLoadedNodes[this.roleID][id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.accessControlModel.membersLoadedNodes[this.roleID][id];}var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelUrl(com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL,this);myUrl.setNodes([{value:id,isID:true}]);var _15e5=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var entry=null;var _15e6={};_15e6.node=null;_15e5.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _15e7=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_15e7,this.ns);if(nodes){var _15e8=new com.ibm.mm.enabler.ac.MemberNodeImpl(nodes[0],this);this.accessControlModel.membersNewid[this.roleID]=_15e8.getID();this.membersLoadedNodes[this.roleID][this.membersNewid[this.roleID]]=_15e8;_15e6.node=this.accessControlModel.membersLoadedNodes[this.roleID][this.membersNewid[this.roleID]];}else{if(sync){_15e6.status=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;}}}if(_15e4){_15e4.finish(_15e6.node||null,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_15e6.status=xhr.status;}}}));if(_15e6.status){throw new Error(dojo.string.substitute(this.modelMessages.E_COMNODE_NOTFOUND_1,[id,_15e6.status]));}retVal=_15e6.node;return retVal;},remove:function(node){if(!this.accessControlModel.changedProperties.role){this.accessControlModel.changedProperties.role=this.accessControlModel.getRoleModel()._getRoles();}var id=node.getID();if(!(id in this.accessControlModel.membersDeletedNodes[this.roleID])){this.accessControlModel.membersDeletedNodesMemberIDs[this.roleID][id]=node.getEntity().getID();this.accessControlModel.membersDeletedNodes[this.roleID][id]=node;}if(id in this.accessControlModel.membersLoadedNodes[this.roleID]){delete this.accessControlModel.membersLoadedNodes[this.roleID][id];}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.MemberModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.MemberModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.MemberModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.RoleModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.RoleModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.RoleModel_API");dojo.provide("com.ibm.mashups.enabler.ac.RoleModel");dojo.declare("com.ibm.mashups.enabler.ac.RoleModel",[com.ibm.mashups.enabler.ListModelController],{create:function(_15e9){},getMemberModel:function(_15ea){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.RoleModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.RoleModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.RoleModelImpl");dojo.declare("com.ibm.mm.enabler.ac.RoleModelImpl",[com.ibm.mashups.enabler.ac.RoleModel,com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.DeferredIteratorImpl,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl],{constructor:function(_15eb,_15ec){this.accessControlModel=_15eb;this.um=_15ec;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_AC,this.nsf.NS_AI,this.NS_CREATION_CONTEXT]));this.prefix="role";this.xmlDom=com.ibm.mm.enabler.utils.Dom.createDocument();this.cid=0;},create:function(_15ed){if(!_15ed){throw new Error("RoleModelImpl.create: no context");}if(!_15ed.roletype){throw new Error("RoleModelImpl.create: no roletype context");}var _15ee=this.getCursorPosition();this.setCursorPosition(0);var _15ef=this.iterator();while(_15ef.hasNext()){var role=_15ef.next();if(role.getRoleType()==_15ed.roletype){if(_15ee){this.setCursorPosition(_15ee);}else{this.setCursorPosition(0);}return null;}}var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom));var title=com.ibm.mm.enabler.utils.Utils.createNode("atom:title",this.ns.atom);com.ibm.mm.enabler.utils.Dom.textContent(title,"Role");entry.appendChild(title);var _15f0=com.ibm.mm.enabler.utils.Utils.createNode("atom:updated",this.ns.atom);var time=new Date();com.ibm.mm.enabler.utils.Dom.textContent(_15f0,time.toGMTString());entry.appendChild(_15f0);var _15f1=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);_15f1.setAttribute("type","application/xml");var _15f2=com.ibm.mm.enabler.utils.Utils.createNode("ac:role",this.ns.ac);var _15f3=this.accessControlModel._getCreationRoleName(_15ed.roletype);if(!_15f3){_15f3=_15ed.roletype;}com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_15f2,"ac:type",this.nsf.getNameSpaceUri(this.nsf.NS_AC),_15f3);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlDom,_15f2,"creation-context:role-types","role-types",this.ns[this.nsf.NS_CREATION_CONTEXT],_15ed.roletype);var _15f4=this.accessControlModel._getCreationResourceID();com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlDom,_15f2,"creation-context:resource-id","resource-id",this.ns[this.nsf.NS_CREATION_CONTEXT],_15f4);_15f1.appendChild(_15f2);entry.appendChild(_15f1);var _15f5=new com.ibm.mm.enabler.ac.RoleNodeImpl(entry,this.um,_15ed.roletype);_15f5.setID(""+(this.cid++));return _15f5;},remove:function(role){if(!this.accessControlModel.changedProperties.role){this.accessControlModel.changedProperties.role=this._getRoles();}var _15f6=role.getID();for(var i=this.accessControlModel.rolesEntries.length;i>0;i--){if(this.accessControlModel.rolesEntries[i]==_15f6){this.accessControlModel.rolesEntries.splice(i,1);break;}}this.accessControlModel._removeNodeRoles(role);},iterator:function(){return this;},start:function(sync){while(this._hasNext(this,sync)){if(this._next(this,sync)){continue;}else{break;}}},hasNext:function(){return this._hasNext(null,true);},_hasNext:function(_15f7,sync){var _15f8=false;var next=this.accessControlModel.rolesEntries[this.accessControlModel.rolesCursor];if(next!==null&&next!==undefined){_15f8=true;}return _15f8;},next:function(){return this._next(null,true);},_next:function(_15f9,sync){var _15fa=this._hasNext(_15f9,sync);var _15fb=this.accessControlModel.rolesEntries;var _15fc=this.accessControlModel.rolesLoadedNodes;var ret=_15fa?_15fc[_15fb[this.accessControlModel.rolesCursor]]:null;this.accessControlModel.rolesCursor++;return ret;},size:function(){return this.accessControlModel.rolesSizeValue;},setCursorPosition:function(_15fd){this.accessControlModel.rolesCursor=_15fd;},getCursorPosition:function(){return this.accessControlModel.rolesCursor;},insert:function(node,_15fe){if(!this.accessControlModel.changedProperties.role){this.accessControlModel.changedProperties.role=this._getRoles();}this.accessControlModel.rolesCreatedNodes[node.getID()]=node;var _15ff=this.accessControlModel.rolesEntries.length;if((!_15ff)||(_15ff===0)){this.accessControlModel.rolesEntries[0]=node.getID();this.accessControlModel.rolesEntries[1]=null;}else{this.accessControlModel.rolesEntries[_15ff-1]=node.getID();this.accessControlModel.rolesEntries[_15ff]=null;}this.accessControlModel._cacheNodeRoles(node);},_getRoles:function(){var roles={};this.setCursorPosition(0);var _1600=this.iterator();while(_1600.hasNext()){var role=_1600.next();var _1601=role.getID();roles[_1601]=_1601;}return roles;},find:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,id);},_find:function(_1602,sync,id){if(id in this.accessControlModel.rolesLoadedNodes){if(_1602){_1602.finish(this.accessControlModel.rolesLoadedNodes[id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.accessControlModel.rolesLoadedNodes[id];}if(id in this.accessControlModel.rolesDeletedNodes){if(_1602){_1602.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}return null;}var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL,this);myUrl.setNodes([{value:id,isID:true}]);var _1603=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var entry=null;var _1604={};_1604.node=null;_1603.read(dojo.hitch(this,function(type,data,xhr,args){if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _1605=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_1605,this.ns);if(nodes){var _1606=new com.ibm.mm.enabler.ac.RoleNodeImpl(nodes[0],this);this.accessControlModel.rolesNewid=_1606.getID();this.rolesLoadedNodes[this.rolesNewid]=_1606;_1604.node=this.accessControlModel.rolesLoadedNodes[this.rolesNewid];}else{if(sync){_1604.status=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND;}}}if(_1602){_1602.finish(_1604.node,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_1604.status=xhr.status;}}}));if(_1604.status){throw new Error(dojo.string.substitute(this.modelMessages.E_COMNODE_NOTFOUND_1,[id,_1604.status]));}retVal=_1604.node;return retVal;},getMemberModel:function(_1607){if(!_1607){return null;}var id=_1607.getID();if(!id){return null;}if(this.accessControlModel.memberModel){if(this.accessControlModel.memberModel[id]){return this.accessControlModel.memberModel[id];}}this.accessControlModel._loadAheadMember(_1607,null,true);if(this.accessControlModel.memberModel[id]){return this.accessControlModel.memberModel[id];}return null;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.RoleModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.RoleModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.RoleModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.AccessControlModel_API");dojo.provide("com.ibm.mashups.enabler.ac.AccessControlModel");dojo.declare("com.ibm.mashups.enabler.ac.AccessControlModel",[com.ibm.mashups.enabler.model.Model],{isInitialized:function(){},getOwner:function(){},setOwner:function(user){},confirmSetOwner:function(user){},getRoleModel:function(){},getRoleModel:function(_1608){},confirmGetRoleModel:function(){},commit:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.space.SpaceNode_API"]){dojo._hasResource["com.ibm.mashups.enabler.space.SpaceNode_API"]=true;dojo.provide("com.ibm.mashups.enabler.space.SpaceNode_API");dojo.provide("com.ibm.mashups.enabler.space.SpaceNode");dojo.declare("com.ibm.mashups.enabler.space.SpaceNode",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.ThemeProvider],{getRootNavigation:function(){},getExportSpaceURL:function(){},getExportTemplateURL:function(){},saveAsTemplate:function(){},isHidden:function(){},setHidden:function(hide){},confirmSetHidden:function(hide){},isFavorite:function(){},setFavorite:function(_1609){}});}if(!dojo._hasResource["com.ibm.mm.enabler.space.SpaceNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.space.SpaceNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.space.SpaceNodeImpl");dojo.declare("com.ibm.mm.enabler.space.SpaceNodeImpl",[com.ibm.mashups.enabler.space.SpaceNode,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.MetaDataImpl,com.ibm.mm.enabler.EditLinkProviderImpl],{constructor:function(node,_160a,_160b){this.xmlData=node;this.um=_160a;this.spaceModel=_160b;this.cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.owner=null;this.isFavoriteTracker=null;this.isSpaceFavorite=false;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_SPACE);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_CA,nsf.NS_CREATION_CONTEXT]));this.li_ns=dojo.mixin(nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_CA]),this.serviceJson.namespaces);this.NLS_TITLE="atom:content/ca:application/ca:title";this.NLS_TITLE_TOP="atom:content/ca:application";this.NLS_DESCRIPTION="atom:content/ca:application/ca:description";this.NLS_DESCRIPTION_TOP="atom:content/ca:application";this.BASE_TITLE="ca:title";this.BASE_DESCRIPTION="ca:description";this.BASE_NS=this.li_ns.ca;this.changedProperties={};this.sourceSpaceID=null;this.latestLocale="en";},_getOwner:function(){if(!this.owner){var expr="atom:content/ca:application/ca:owner";var owner=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(owner&&owner.length>0){var _160c=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(owner[0],"ca:id","id",this.ns.ca);this.owner=this.um.find(_160c).start();}}return this.owner;},_setOwner:function(user){if(!this.changedProperties.owner){this.changedProperties.owner=this._getOwner();}this.owner=user;var expr="atom:content/ca:application/ca:owner";var owner=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(owner&&owner.length>0){com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(owner[0],"ca:id",this.ns.ca,user.getID());}else{expr="atom:content/ca:application";var _160d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_160d&&_160d.length>0){var tn=com.ibm.mm.enabler.utils.Dom.createElement(this.xmlData.ownerDocument,"ca:owner",this.ns.ca);com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(tn,"ca:id",this.ns.ca,user.getID());_160d[0].appendChild(tn);}}},_getSpaceModel:function(){return this.spaceModel;},getExportSpaceURL:function(){var expr="atom:link[@ca:rel='application-export']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _160e=nodes[0].getAttribute("href");return _160e;},getExportTemplateURL:function(){var expr="atom:link[@ca:rel='template-export']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _160f=nodes[0].getAttribute("href");return _160f;},isHidden:function(){var ret1=(this.getMetaData(this._getHiddenMetaNameFixed())=="true")?true:false;var ret2=(this.getMetaData(this._getHiddenMetaNameDynamic())=="true")?true:false;return (ret1||ret2);},setHidden:function(hide){var name=this._getHiddenMetaNameDynamic();this.setMetaData(name,(hide)?"true":"false");},confirmSetHidden:function(hide){var ret1=this.confirmSetMetaData(this._getHiddenMetaNameFixed(),(hide)?"true":"false");var ret2=this.confirmSetMetaData(this._getHiddenMetaNameDynamic(),(hide)?"true":"false");return (ret1&&ret2);},_getHiddenMetaNameFixed:function(){return "{http://www.ibm.com/xmlns/prod/lotus/mashups/v1.0/extensions}com.ibm.mashups.space.hidden";},_getHiddenMetaNameDynamic:function(){var name=this.cs.getValue("com.ibm.mashups.space.hidden");if(name.search("^\\{http://.*\\}.+")==-1){name="{http://www.ibm.com/xmlns/prod/lotus/mashups/v1.0/extensions}"+name;}return name;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);},getRootNavigation:function(){var _1610;var expr="atom:link[@ca:rel='navigation']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(nodes&&nodes.length>0){var id=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,nodes[0]);var href=nodes[0].getAttribute("href");_1610=new com.ibm.mm.enabler.IdentifierImpl(id,{"href":href});}return _1610||null;},saveAsTemplate:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._saveAsTemplate);},_saveAsTemplate:function(_1611,sync){var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.ns.atom);entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.ns.atom));entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:title",this.ns.atom));var _1612=com.ibm.mm.enabler.utils.Utils.createNode("atom:updated",this.ns.atom);var time=new Date();com.ibm.mm.enabler.utils.Dom.textContent(_1612,time.toGMTString());entry.appendChild(_1612);var _1613=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.ns.atom);_1613.setAttribute("type","application/xml");var _1614=com.ibm.mm.enabler.utils.Utils.createNode("ca:template",this.ns.ca);com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_1614,"creation-context:app-id",this.ns["creation-context"],this.getID());var _1615=this.getLocales();for(var i=0;i<_1615.length;i++){var title=com.ibm.mm.enabler.utils.Utils.createNode("ca:title",this.ns.ca);title.setAttribute("xml:lang",_1615[i]);com.ibm.mm.enabler.utils.Dom.textContent(title,this.getTitle(_1615[i]));_1614.appendChild(title);var _1616=com.ibm.mm.enabler.utils.Utils.createNode("ca:description",this.ns.ca);_1616.setAttribute("xml:lang",_1615[i]);com.ibm.mm.enabler.utils.Dom.textContent(_1616,this.getDescription(_1615[i]));_1614.appendChild(_1616);}_1613.appendChild(_1614);entry.appendChild(_1613);var _1617=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_TEMPLATE);var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_1617.url,this.spaceModel);var _1618=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1618.create(com.ibm.mm.enabler.utils.Dom.innerXML(entry),dojo.hitch(this,function(type,data,xhr,args){if(_1611&&_1611.operationCallback){_1611.operationCallback(entry,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_1611.operationCallbackParameters);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_1611.errorCallback){_1611.errorCallback(xhr.status,_1611.errorCallbackParameters);}}}));},setTitle:function(title,_1619){this.latestLocale=_1619;if(!this.changedProperties.title){this.changedProperties.title={};}if(!this.changedProperties.title[_1619]){this.changedProperties.title[_1619]=this.getTitle(_1619);}this.inherited(arguments);},removeTitle:function(_161a){if(!this.changedProperties.title){this.changedProperties.title={};}if(!this.changedProperties.title[_161a]){this.changedProperties.title[_161a]=this.getTitle(_161a);}this.inherited(arguments);},removeTitles:function(){if(!this.changedProperties.title){this.changedProperties.title={};}var _161b=this.getLocales();for(var _161c in _161b){if(!this.changedProperties.title[_161c]){this.changedProperties.title[_161c]=this.getTitle(_161c);}}this.inherited(arguments);},setDescription:function(desc,_161d){if(!this.changedProperties.description){this.changedProperties.description={};}if(!this.changedProperties.description[_161d]){this.changedProperties.description[_161d]=this.getDescription(_161d);}this.inherited(arguments);},removeDescription:function(_161e){if(!this.changedProperties.description){this.changedProperties.description={};}if(!this.changedProperties.description[_161e]){this.changedProperties.description[_161e]=this.getDescription(_161e);}this.inherited(arguments);},removeDescriptions:function(){if(!this.changedProperties.description){this.changedProperties.description={};}var _161f=this.getLocales();for(var _1620 in _161f){if(!this.changedProperties.description[_1620]){this.changedProperties.description[_1620]=this.getDescription(_1620);}}this.inherited(arguments);},setMetaData:function(name,value){if(!this.changedProperties.metadata){this.changedProperties.metadata={};}if(!this.changedProperties.metadata[name]){this.changedProperties.metadata[name]=this.getMetaData(name);}this.inherited(arguments);},removeMetaData:function(name){if(!this.changedProperties.metadata){this.changedProperties.metadata={};}if(!this.changedProperties.metadata[name]){this.changedProperties.metadata[name]=this.getMetaData(name);}this.inherited(arguments);},_getSpaceExtensionURL:function(){return this.getMetaData("{http://www.ibm.com/xmlns/prod/lotus/mashups/v1.0/extensions}com.ibm.space.extension_url");},_setCopiedFrom:function(_1621){this.sourceSpaceID=_1621;},_getCopiedFrom:function(){return this.sourceSpaceID;},_diffSpaceChanges:function(){var delta={};var _1622;if("owner" in this.changedProperties){var oldID=(!this.changedProperties.owner)?"":this.changedProperties.owner.getID();var _1623=this._getOwner();var newID=(!_1623)?"":_1623.getID();if(newID!=oldID){delta.owner=newID;}}if("title" in this.changedProperties){for(_1622 in this.changedProperties.title){if(Object.prototype.hasOwnProperty.call(this.changedProperties.title,_1622)){var _1624=this.getTitle(_1622);if(_1624!=this.changedProperties.title[_1622]){if(!delta.title){delta.title={};}delta.title[_1622]=_1624;}}}}if("description" in this.changedProperties){for(_1622 in this.changedProperties.description){if(Object.prototype.hasOwnProperty.call(this.changedProperties.description,_1622)){var _1625=this.getDescription(_1622);if(_1625!=this.changedProperties.description[_1622]){if(!delta.description){delta.description={};}delta.description[_1622]=_1625;}}}}if("metadata" in this.changedProperties){for(var name in this.changedProperties.metadata){if(Object.prototype.hasOwnProperty.call(this.changedProperties.metadata,name)){var value=this.getMetaData(name);if(value!=this.changedProperties.metadata[name]){if(!delta.metadata){delta.metadata={};}delta.metadata[name]=value;}}}}this.changedProperties={};return delta;},_getFavoriteURL:function(){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ca:rel='favorite']",this.xmlData,this.ns);if(nodes&&nodes.length>0){return nodes[0].getAttribute("href");}return null;},isFavorite:function(){if(this.isFavoriteTracker==this){return this.isSpaceFavorite;}var ret=false;if(this.spaceModel.deletedFavorites&&this.spaceModel.deletedFavorites[this.getID()]&&(this.spaceModel.deletedFavorites[this.getID()]==this)){ret=false;}else{if(this.spaceModel.createdFavorites&&this.spaceModel.createdFavorites[this.getID()]&&(this.spaceModel.createdFavorites[this.getID()]==this)){ret=true;}else{var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:link[@ca:rel='favorite']",this.xmlData,this.ns);if(nodes&&nodes.length>0){ret=true;}}}this.isFavoriteTracker=this;this.isSpaceFavorite=ret;return ret;},setFavorite:function(_1626){this.isFavoriteTracker=this;if(this.spaceModel.favoritesModel){this.spaceModel.favoritesModel._setOld();}if(_1626){this.spaceModel.createdFavorites[this.getID()]=this;if(this.spaceModel.deletedFavorites&&this.spaceModel.deletedFavorites[this.getID()]){this.spaceModel.deletedFavorites[this.getID()]=null;}this.isSpaceFavorite=true;return true;}else{this.spaceModel.deletedFavorites[this.getID()]=this;if(this.spaceModel.createdFavorites&&this.spaceModel.createdFavorites[this.getID()]){this.spaceModel.createdFavorites[this.getID()]=null;}this.isSpaceFavorite=false;return false;}this._setDirty();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.space.SpaceNode"]){dojo._hasResource["com.ibm.mashups.enabler.space.SpaceNode"]=true;dojo.provide("com.ibm.mashups.enabler.space.SpaceNode");}if(!dojo._hasResource["com.ibm.mashups.enabler.space.SpaceLocator"]){dojo._hasResource["com.ibm.mashups.enabler.space.SpaceLocator"]=true;dojo.provide("com.ibm.mashups.enabler.space.SpaceLocator");dojo.declare("com.ibm.mashups.enabler.space.SpaceLocator",[com.ibm.mashups.enabler.Locator],{findSpaceByNavigation:function(_1627){},findFavorites:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SpaceModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.SpaceModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.SpaceModel_API");dojo.provide("com.ibm.mashups.enabler.model.SpaceModel");dojo.declare("com.ibm.mashups.enabler.model.SpaceModel",[com.ibm.mashups.enabler.ListModelController,com.ibm.mashups.enabler.SubmittableFormProvider,com.ibm.mashups.enabler.space.SpaceLocator],{create:function(_1628){},commit:function(){},confirmExport:function(space){},confirmCopy:function(space){},getSubmittableImportForm:function(id){}});}if(!dojo._hasResource["com.ibm.mm.enabler.space.FavoritesIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.space.FavoritesIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.space.FavoritesIteratorImpl");dojo.declare("com.ibm.mm.enabler.model.FavoritesIteratorImpl",com.ibm.mm.enabler.DeferredIteratorImpl,{constructor:function(_1629,model,um){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.model=model;this.entries=[];this.cursor=0;this.sizeValue=null;this.um=um;this.loadedNodes={};this._old=false;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_SPACE);this.prefix=this.serviceJson.idprefix;this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_XHTML,this.nsf.NS_OPENSEARCH,this.nsf.NS_CA,this.nsf.NS_APP]));},_reset:function(){this.cursor=0;},start:function(){this._start(true);},_start:function(sync){while(this.hasNext(this,sync)){this.next(this,sync);}},hasNext:function(dfr,sync){if(typeof this.entries[this.cursor]=="undefined"){this._loadAhead(dfr||null,typeof sync=="undefined"?true:sync);}return this.entries[this.cursor]?true:false;},next:function(dfr,sync){return this._next(null,true);},_next:function(dfr,sync){return this.hasNext(dfr||null,typeof sync=="undefined"?true:sync)?this.loadedNodes[this.entries[this.cursor++]]:null;},setCursorPosition:function(_162a){this.cursor=_162a;},getCursorPosition:function(){return this.cursor;},size:function(){return new com.ibm.mm.enabler.DeferredImpl(this,this._size);},_size:function(dfr,sync){if(!this.sizeValue){this.hasNext(null,true);}if(dfr){dfr.finish(this.sizeValue,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.sizeValue;},_loadAhead:function(_162b,sync){var _162c="_loadAhead";var _162d=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_162d){this.LOGGER.entering(_162c,arguments);}this._old=false;var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.serviceJson.url,this.model);myUrl.setParameter("filter","is-favorite=true");myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);myUrl.setParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_REPRESENTATION_VALUE_FULL);this.sizeValue=0;var id;var _162e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_162e.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed/atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var ii=0;if(nodes){for(var i=0;i<nodes.length;i++){var node=new com.ibm.mm.enabler.space.SpaceNodeImpl(nodes[i],this.um,this.model);id=node.getID();if(this.model.deletedFavorites&&this.model.deletedFavorites[id]){}else{this._cacheNode(node);this.entries[this.cursor+i]=id;ii++;this.sizeValue++;}if(_162b&&_162b.foreachCallback){_162b.foreachCallback(this.loadedNodes[id],_162b.foreachCallbackParameters);}}}var iii=0;for(var id2 in this.model.createdFavorites){if(this.model.createdFavorites&&this.model.createdFavorites[id2]){this._cacheNode(this.model.createdFavorites[id2]);this.entries[this.cursor+ii+iii]=id2;iii++;this.sizeValue++;}}this.entries[this.cursor+nodes.length]=null;if(_162b){_162b.finish(null,xhr.status);}}else{if(_162b){_162b.finish(null,xhr.status);}}}));if(_162d){this.LOGGER.exiting(_162c);}},_cacheNode:function(node){var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;}return this.loadedNodes[id];},_setOld:function(){this._old=true;this.entries=[];this.cursor=0;this.sizeValue=null;this.loadedNodes={};},_isOld:function(){return this._old;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.space.SpaceExtensionResult"]){dojo._hasResource["com.ibm.mashups.enabler.model.space.SpaceExtensionResult"]=true;dojo.provide("com.ibm.mashups.enabler.model.space.SpaceExtensionResult");dojo.declare("com.ibm.mashups.enabler.model.space.SpaceExtensionResult",null,{STATE_OK:"OK",STATE_WARNING:"WARNING",STATE_ERROR:"ERROR",constructor:function(_162f){this.result=_162f;},getState:function(){return this.result;},getLocaleMessage:function(){return this.message||"";},getLocaleSolution:function(){return this.solution||"";},getOptionalInfo:function(){return this.optionalInfo||"";},setLocaleMessage:function(_1630){this.message=_1630;},setLocaleSolution:function(_1631){this.solution=_1631;},setOptionalInfo:function(info){if(optionalInfo){this.optionalInfo=info;}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.space.SpaceExtension"]){dojo._hasResource["com.ibm.mashups.enabler.model.space.SpaceExtension"]=true;dojo.provide("com.ibm.mashups.enabler.model.space.SpaceExtension");dojo.declare("com.ibm.mashups.enabler.model.space.SpaceExtension",null,{onSpaceCreate:function(_1632,_1633,_1634,_1635){},onSpaceCopy:function(_1636,_1637,_1638,_1639,_163a){},onSpaceUpdate:function(_163b,_163c,_163d){},onSpaceDelete:function(_163e,_163f){},canExportSpace:function(_1640,_1641){},canCopySpace:function(_1642,_1643){},canDeleteSpace:function(_1644,_1645){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.space.SpaceExtensionLocator"]){dojo._hasResource["com.ibm.mashups.enabler.space.SpaceExtensionLocator"]=true;dojo.provide("com.ibm.mashups.enabler.space.SpaceExtensionLocator");dojo.declare("com.ibm.mashups.enabler.space.SpaceExtensionLocator",[com.ibm.mashups.enabler.Locator],{findExtensionBySpace:function(_1646){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SpaceExtensionModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.SpaceExtensionModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.SpaceExtensionModel_API");dojo.provide("com.ibm.mashups.enabler.model.SpaceExtensionModel");dojo.declare("com.ibm.mashups.enabler.model.SpaceExtensionModel",[com.ibm.mashups.enabler.ListModelController,com.ibm.mashups.enabler.space.SpaceExtensionLocator],{create:function(_1647){return new SpaceExtension();}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.SpaceExtensionModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.SpaceExtensionModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.SpaceExtensionModelImpl");dojo.declare("com.ibm.mm.enabler.model.SpaceExtensionModelImpl",[com.ibm.mashups.enabler.model.SpaceExtensionModel],{constructor:function(){this.loadedNodes={};},confirmCreate:function(_1648){if(_1648){if(_1648.space){var _1649=_1648.space._getSpaceExtensionURL();if(_1649){return true;}else{return false;}}else{if(_1648.extensionURL){return true;}}}return false;},create:function(_164a){var _164b=_164a.space?_164a.space._getSpaceExtensionURL():_164a.extensionURL;var _164c=this._getEndpointAndURL(_164b);var url=this._getFullURL(_164c);this._loadJavaScript(url);var _164d=this._getSpaceExtensionClassName(_164c.url);var _164e=this._createSpaceExtensionImpl(_164d);_164e.id=_164b;return _164e;},_getEndpointAndURL:function(_164f){var _1650="endpoint://";var index=_164f.indexOf(_1650);if(index==-1){return {"endpoint":null,"url":_164f};}var start=index+_1650.length;var _1651=_164f.indexOf("/",start);var _1652=_1651==-1?_164f.substring(start):_164f.substring(start,_1651);var url=_1651==-1?null:_164f.substring(_1651);return {"endpoint":_1652,"url":url};},_getEndpointURL:function(_1653){var _1654=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _1655=_1654.getConfigObject(com.ibm.mashups.enabler.services.ConfigConstants.ENDPOINT_CONFIG_PROVIDER);var _1656=_1655.getValue(com.ibm.mashups.enabler.services.ConfigConstants.ENDPOINTS);if(_1656){var _1657=_1656.split(";");for(var i=0;i<_1657.length;i++){if(_1657[i]==_1653){return _1655.getValue(_1653+".url");}}}return null;},_getLocalServer:function(url){if(url.indexOf("http://")==-1&&url.indexOf("https://")==-1){var _1658=new com.ibm.mm.enabler.utils.HttpUrl("/");var _1659=_1658.toString();while(_1659.charAt(_1659.length-1)=="/"){_1659=_1659.substr(0,_1659.length-1);}return _1659;}return null;},_getFullURL:function(_165a){var _165b=_165a.endpoint?this._getEndpointURL(_165a.endpoint):null;var _165c=_165a.url;var _165d=_165c;if(_165b&&_165b.length>0){if(_165b.charAt(_165b.length-1)=="/"){if(_165c.length>0&&_165c.charAt(0)=="/"){_165c=_165c.substring(1);}_165d=_165b+_165c;}else{if(_165c){if(_165c.length>0&&_165c.charAt(0)=="/"){_165d=_165b+_165c;}else{_165d=_165b+"/"+_165c;}}else{_165d=_165b;}}}var _165e=this._getLocalServer(_165d);if(_165e){_165d=(_165d.charAt(0)=="/")?_165e+_165d:_165e+"/"+_165d;}var _165f=_165d.lastIndexOf("#");if(_165f!=-1){_165d=_165d.substring(0,_165f);}return _165d;},_loadJavaScript:function(url){var _1660=new com.ibm.mm.enabler.aggregation.javascript.ExternalScriptFilter();_1660.loadExternalScript(url);},_getSpaceExtensionClassName:function(_1661){var urls=_1661.split("#");if(urls.length===0){return null;}else{if(urls.length>1){var _1662=urls[1].replace(/^\s+|\s+$/g,"");if(_1662!=""){return _1662;}}}var _1663=urls[0];var _1664=_1663.lastIndexOf("/");if(_1664==-1){_1664=0;}else{if(_1664==_1663.length-1){return null;}else{_1664=_1664+1;}}var _1665=_1663.lastIndexOf(".js");if(_1665==-1){return _1663.substring(_1664);}else{return _1663.substring(_1664,_1665);}},_createSpaceExtensionImpl:function(_1666){if(_1666.indexOf("()")!==-1){_1666=_1666.substring(0,_1666.length-2);}var _1667=new (dojo.getObject(_1666))();return _1667;},insert:function(node,_1668){},confirmInsert:function(node,_1669){return "false";},find:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,id);},_find:function(_166a,sync,id){if(id in this.loadedNodes){if(_166a){_166a.finish(this.loadedNodes[id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}return this.loadedNodes[id];}var _166b=this.create({"extensionURL":id});this.loadedNodes[id]=_166b;return _166b;},findExtensionBySpace:function(_166c){return new com.ibm.mm.enabler.DeferredImpl(this,this._findExtensionBySpace,_166c);},_findExtensionBySpace:function(_166d,sync,_166e){var space;if(typeof (_166e)=="string"){var _166f=com.ibm.mashups.enabler.space.Factory.getSpaceModel();space=_166f.find(_166e).start();}else{space=_166e;}var _1670=this.confirmCreate({"space":space});if(!_1670){return null;}return this._find(_166d,sync,space._getSpaceExtensionURL());}});dojo.declare("SpaceExtension",[com.ibm.mashups.enabler.model.space.SpaceExtension],{});dojo.declare("SpaceExtensionResult",[com.ibm.mashups.enabler.model.space.SpaceExtensionResult],{});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SpaceExtensionModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.SpaceExtensionModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.SpaceExtensionModel");}if(!dojo._hasResource["com.ibm.mm.enabler.model.SpaceModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.SpaceModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.SpaceModelImpl");dojo.declare("com.ibm.mm.enabler.model.SpaceModelImpl",[com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl,com.ibm.mm.enabler.SubmittableFormProviderImpl,com.ibm.mm.enabler.strategy.HiddenMetaDataLoadingStrategyHelperImpl,com.ibm.mm.enabler.ServiceDocConsumer],{constructor:function(){this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);var _1671="constructor()";var _1672=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1672){this.LOGGER.entering(_1671);}this.root=null;this.loadedNodes={};this.createdNodes={};this.deletedNodes={};this.failedNodes={};this.initialContents={};this.createdFavorites={};this.deletedFavorites={};this.cid=0;this.start=null;this.num=null;this.sizeValue=9999;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.um=com.ibm.mashups.enabler.user.Factory.getUserModel();this.entries=[];this.cursor=0;this.size=null;this.nextLink=null;this.xmlDom=com.ibm.mm.enabler.utils.Dom.createDocument();this.spaceExtensionModel=com.ibm.mashups.enabler.space.Factory.getSpaceExtensionModel();this.favoritesModel=null;this.urlType=com.ibm.mashups.enabler.model.url.ModelUrlFactory.SPACE_URL;if(_1672){this.LOGGER.exiting(_1671);}},_initServiceDoc:function(){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_SPACE);this.prefix=this.serviceJson.idprefix;this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_XHTML,this.nsf.NS_OPENSEARCH,this.nsf.NS_CA,this.nsf.NS_APP]));this.inherited("_initServiceDoc",arguments);},getInstance:function(){var _1673=com.ibm.mm.enabler.model.SpaceModelImpl._instance;return _1673?_1673:(com.ibm.mm.enabler.model.SpaceModelImpl._instance=new com.ibm.mm.enabler.model.SpaceModelImpl());},find:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,{"id":id,"ignoreDeletedNodes":false});},_find:function(_1674,sync,_1675){var _1676="_find(params, deferred, sync)";var _1677=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1677){this.LOGGER.entering(_1676,[_1675,_1674,sync]);}var id=com.ibm.mm.enabler.utils.Utils.getIdFromIdentifiable(_1675.id);var _1678=_1675.ignoreDeletedNodes;if(!_1678){if(id in this.deletedNodes){if(_1674){_1674.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}if(_1677){this.LOGGER.exiting(_1676);}return null;}}if(id in this.loadedNodes){if(_1674){_1674.finish(this.loadedNodes[id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}if(_1677){this.LOGGER.exiting(_1676,this.loadedNodes[id]);}return this.loadedNodes[id];}if(this.favoritesModel){if(id in this.favoritesModel.loadedNodes){var node=this.favoritesModel.loadedNodes[id];if(_1674){_1674.finish(node,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}if(_1677){this.LOGGER.exiting(_1676,node);}return node;}}var myUrl=null;var href=com.ibm.mm.enabler.utils.Utils.getHrefFromIdentifiable(_1675.id);if(href){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(href,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);myUrl.setNodes([{value:id,isID:true}]);}myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);this._applyHiddenMetaDataLoadingStrategyToModelURL(myUrl);var _1679=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var entry=null;var _167a={};_1679.read(dojo.hitch(this,function(type,data,xhr,args){var _167b="_find_callback(type, data, xhr, args)";if(_1677){this.LOGGER.entering(_167b,[type,data,xhr,args]);}this._initServiceDoc();var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _167c=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_167c,this.ns);var _167d=new com.ibm.mm.enabler.space.SpaceNodeImpl(nodes[0],this.um,this);this.newid=_167d.getID();this.loadedNodes[this.newid]=_167d;this.initialContents[this.newid]=_167d.toString();if(this.createdFavorites&&this.createdFavorites[id]){this.createdFavorites[this.newid]=_167d;this.createdFavorites[id]=null;}if(this.deletedFavorites&&this.deletedFavorites[id]){this.deletedFavorites[this.newid]=_167d;this.deletedFavorites[id]=null;}if(_1674){_1674.finish(this.loadedNodes[this.newid]||null,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_167a.status=xhr.status;}}if(_1677){this.LOGGER.exiting(_167b);}}));if(_167a.status){throw new Error(dojo.string.substitute(this.modelMessages.E_COMNODE_NOTFOUND_1,[id,_167a.status]));}if(_1677){this.LOGGER.exiting(_1676,this.loadedNodes[this.newid]);}return this.loadedNodes[this.newid];},findSpaceByNavigation:function(_167e){return new com.ibm.mm.enabler.DeferredImpl(this,this._findSpaceByNavigation,_167e);},_findSpaceByNavigation:function(_167f,sync,_1680){var _1681="_findSpaceByNavigation(deferred, sync, navNode)";var _1682=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1682){this.LOGGER.entering(_1681,[_167f,sync,_1680]);}if(typeof (_1680)=="string"){if(_167f){_167f.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}if(_1682){this.LOGGER.exiting(_1681);}return null;}var _1683=_1680._getSpaceIdentifier();if(!_1683){if(_167f){_167f.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}if(_1682){this.LOGGER.exiting(_1681);}return null;}return this._find(_167f,sync,{"id":_1683,"ignoreDeletedNodes":false});},findFavorites:function(){if(!this.favoritesModel||this.favoritesModel._isOld()){this.favoritesModel=new com.ibm.mm.enabler.model.FavoritesIteratorImpl(null,this,this.um);}else{this.favoritesModel._reset();}return this.favoritesModel;},create:function(_1684){this._initServiceDoc();var _1685=com.ibm.mm.enabler.utils.Atom.createEntry("New Space","ca:application",this.ns.ca);if(_1684){if(_1684.clonedSpace){com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlDom,_1685.modelElement,"creation-context:app-id","app-id",this.ns["creation-context"],_1684.clonedSpace);}else{if(_1684.templateID){_1685.modelElement.setAttribute("ca:template-id",_1684.templateID);}}}var space=new com.ibm.mm.enabler.space.SpaceNodeImpl(_1685.entryElement,this.um,this);space.setID((_1684&&_1684.cid)?_1684.cid:""+this.cid++);if(_1684&&_1684.clonedSpace){space._setCopiedFrom(_1684.clonedSpace);}space._setDirty();return space;},confirmCreate:function(_1686){return this.getConfirmCreate();},insert:function(node,_1687){var id=node.getID();this.createdNodes[id]=node;},confirmInsert:function(node,_1688){return this.getConfirmInsert();},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_1689,sync){var _168a="_commit(deferred, sync)";var _168b=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_168b){this.LOGGER.entering(_168a,[_1689,sync]);}this._initServiceDoc();this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this.requestCount=0;this._acquire();if(this.favoritesModel){this.favoritesModel._setOld();this.favoritesModel=null;}var space;var _168c;var _168d;var myUrl;var _168e;var _168f;var entry;var link;var id;for(id in this.loadedNodes){if(Object.prototype.hasOwnProperty.call(this.loadedNodes,id)){if(_168b){this.LOGGER.trace(_168a,"Checking if loaded space ${0} is modified",id);}space=this.loadedNodes[id];if(this.initialContents[id]!==this.loadedNodes[id].toString()){if(_168b){this.LOGGER.trace(_168a,"Space is modified, updating");}_168c=this.spaceExtensionModel.findExtensionBySpace(space).start();if(_168c){_168d=_168c.onSpaceUpdate(space.getID(),dojo.toJson(space._diffSpaceChanges(),true),null);if(_168d&&_168d.getState()!="OK"){if(_168b){this.LOGGER.trace(_168a,"Space update aborted: "+space.getID());this.LOGGER.trace(_168a,"Space extension update problem: "+_168d.getLocaleMessage());this.LOGGER.trace(_168a,"Solution: "+_168d.getLocaleSolution());}continue;}}entry=com.ibm.mm.enabler.utils.Utils.createFeed("space:"+space.getID(),"IBM Lotus Mashups Space Feed",this.loadedNodes[id],this.ns);myUrl=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(space.getEditLink(),this);_168e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,true);_168f=null;this._acquire();_168e.update(entry,dojo.hitch(this,function(type,data,xhr,args){if(_1689&&_1689.operationCallback){_1689.operationCallback(this.loadedNodes[args],com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_1689.operationCallbackParameters);}this._release(_1689,xhr.status);}));this.initialContents[id]=this.loadedNodes[id].toString();}}}for(var count in this.createdNodes){if(Object.prototype.hasOwnProperty.call(this.createdNodes,count)){if(_168b){this.LOGGER.trace(_168a,"Processing new space");}space=this.createdNodes[count];var oldid=space.getID();var _1690=space._getCopiedFrom();var _1691=space.latestLocale;if(_1690){_168c=this.spaceExtensionModel.findExtensionBySpace(_1690).start();if(_168c){_168d=_168c.canCopySpace(space.getID(),null);if(_168d&&_168d.getState()!="OK"){if(_168b){this.LOGGER.trace(_168a,"Space copy aborted: "+_1690);this.LOGGER.trace(_168a,"Space extension does not allow to copy this space.");}continue;}}}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.serviceJson.url,this);_168e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,true);_168f=null;this._acquire();_168e.create(space.toString(),dojo.hitch(this,function(type,data,xhr,args){var _1692="_commit_create_callback(type, data, xhr, args)";if(_168b){this.LOGGER.entering(_1692,[type,data,xhr,args]);}var _1693=null;if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _1694=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var _1695=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_1694,this.ns);if(_1695&&_1695.length>0){_1693=new com.ibm.mm.enabler.space.SpaceNodeImpl(_1695[0],this.um,this);this.newid=_1693.getID();this.loadedNodes[this.newid]=_1693;this.initialContents[this.newid]=_1693.toString();this._cacheNode(_1693);var len=this.entries.length;if(len===0){this.entries[0]=this.newid;this.entries[1]=null;}else{if(len==1){this.entries[1]=this.newid;this.entries[2]=null;}else{if(!this.entries[len-1]){this.entries[len-1]=this.newid;this.entries[len]=null;}else{this.entries[len]=this.newid;this.entries[len+1]=null;}}}if(this.createdFavorites&&this.createdFavorites[oldid]){this.createdFavorites[this.newid]=_1693;this.createdFavorites[oldid]=null;}if(this.deletedFavorites&&this.deletedFavorites[oldid]){this.deletedFavorites[this.newid]=_1693;this.deletedFavorites[oldid]=null;}_168c=this.spaceExtensionModel.findExtensionBySpace(_1693).start();if(_168c){var _1696=(!_1691)?"en":_1691;var id=_1693.getID();var title=_1693.getTitle(_1696);var _1697=_1693.getDescription(_1696);var _1698=args;_168d=_1698?_168c.onSpaceCopy(_1698,id,title,_1697,null):_168c.onSpaceCreate(id,title,_1697,null);if(_168d&&_168d.getState()!="OK"){if(_168b){this.LOGGER.trace(_1692,"Space create/copy aborted: "+id);this.LOGGER.trace(_1692,"Space extension update problem: "+_168d.getLocaleMessage());this.LOGGER.trace(_1692,"Solution: "+_168d.getLocaleSolution());}this.failedNodes[id]=_1693;}}}}if(_1689&&_1689.operationCallback){_1689.operationCallback(_1693,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_1689.operationCallbackParameters);}this._release(_1689,xhr.status);if(_168b){this.LOGGER.exiting(_1692);}}),_1690);}}this.createdNodes={};for(var _1699 in this.failedNodes){if(Object.prototype.hasOwnProperty.call(this.failedNodes,_1699)){if(_168b){this.LOGGER.trace(_168a,"Processing delete of space ${0}",id);}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.failedNodes[_1699].getEditLink(),this);_168e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_168e.remove(dojo.hitch(this,function(type,data,xhr,args){var _169a="_commit_remove_callback(type, data, xhr, args)";if(_168b){this.LOGGER.entering(_169a,[type,data,xhr,args]);}if(_1689&&_1689.operationCallback){_1689.operationCallback(null,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_1689.operationCallbackParameters);}this._release(_1689,xhr.status);if(_168b){this.LOGGER.exiting(_169a,[type,data,xhr,args]);}}));}}this.failedNodes={};for(id in this.deletedNodes){if(Object.prototype.hasOwnProperty.call(this.deletedNodes,id)){if(_168b){this.LOGGER.trace(_168a,"Processing delete of space ${0}",id);}var _169b=new com.ibm.mm.enabler.DeferredImpl(this,this._find,{"id":id,"ignoreDeletedNodes":true});var _169c=_169b.start();_168c=this.spaceExtensionModel.findExtensionBySpace(_169c).start();if(_168c){var _169d=_169c.getID();_168d=_168c.canDeleteSpace(_169d,null);if(_168d&&_168d.getState()!="OK"){if(_168b){this.LOGGER.trace(_168a,"Space delete aborted: "+_169c.getID());this.LOGGER.trace(_168a,"Space extension update problem: "+_168d.getLocaleMessage());this.LOGGER.trace(_168a,"Solution: "+_168d.getLocaleSolution());}continue;}_168d=_168c.onSpaceDelete(_169d,null);if(_168d&&_168d.getState()!="OK"){if(_168b){this.LOGGER.trace(_168a,"Space delete aborted: "+_169c.getID());this.LOGGER.trace(_168a,"Space extension update problem: "+_168d.getLocaleMessage());this.LOGGER.trace(_168a,"Solution: "+_168d.getLocaleSolution());}continue;}}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.deletedNodes[id].getEditLink(),this);_168e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_168e.remove(dojo.hitch(this,function(type,data,xhr,args){var _169e="_commit_remove_callback(type, data, xhr, args)";if(_168b){this.LOGGER.entering(_169e,[type,data,xhr,args]);}if(_1689&&_1689.operationCallback){_1689.operationCallback(null,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_1689.operationCallbackParameters);}this._release(_1689,xhr.status);if(_168b){this.LOGGER.exiting(_169e,[type,data,xhr,args]);}}));}}this.deletedNodes={};for(id in this.deletedFavorites){if(this.deletedFavorites[id]){if(_168b){this.LOGGER.trace(_168a,"Processing delete of space-favorite ${0}",id);}myUrl=null;link=this.deletedFavorites[id]._getFavoriteURL();if(typeof (link)=="string"){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{if(!link){myUrl=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.SPACE_FAVORITE_URL,this);myUrl.setNodes([{value:id,isID:true}]);}else{myUrl=link;}}_168e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_168e.remove(dojo.hitch(this,function(type,data,xhr,args){var _169f="_commit_remove_callback(type, data, xhr, args)";if(_168b){this.LOGGER.entering(_169f,[type,data,xhr,args]);}if(_1689&&_1689.operationCallback){_1689.operationCallback(null,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_1689.operationCallbackParameters);}this._release(_1689,xhr.status);if(_168b){this.LOGGER.exiting(_169f,[type,data,xhr,args]);}}));}}this.deletedFavorites={};for(id in this.createdFavorites){if(this.createdFavorites[id]){if(_168b){this.LOGGER.trace(_168a,"Processing create of space-favorite ${0}",id);}entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",this.nsf.getNameSpaceUri(this.nsf.NS_ATOM));entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",this.nsf.getNameSpaceUri(this.nsf.NS_ATOM)));var title=com.ibm.mm.enabler.utils.Utils.createNode("atom:title",this.nsf.getNameSpaceUri(this.nsf.NS_ATOM));com.ibm.mm.enabler.utils.Dom.textContent(title,"Adding a favorite space "+id);entry.appendChild(title);var _16a0=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",this.nsf.getNameSpaceUri(this.nsf.NS_ATOM));_16a0.setAttribute("type","application/xml");var _16a1=com.ibm.mm.enabler.utils.Utils.createNode("ca:application-favorite",this.nsf.getNameSpaceUri(this.nsf.NS_CA));com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_16a1,"ca:app-id",this.nsf.getNameSpaceUri(this.nsf.NS_CA),id);_16a0.appendChild(_16a1);entry.appendChild(_16a0);myUrl=null;link=this.createdFavorites[id]._getFavoriteURL();if(typeof (link)=="string"){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{if(!link){myUrl=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.SPACE_FAVORITE_URL,this);myUrl.setNodes([{value:id,isID:true}]);}else{myUrl=link;}}_168e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_168e.create(com.ibm.mm.enabler.utils.Dom.innerXML(entry),dojo.hitch(this,function(type,data,xhr,args){this._release(_1689,xhr.status);}));}}this.createdFavorites={};this._release(_1689,0);if(_168b){this.LOGGER.exiting(_168a);}},getSubmittableImportForm:function(id){this._initServiceDoc();var model=null;var url;if(id=="spaceForm"){url=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.SPACE_URL,null);url.setNodes([{value:"collection",isID:false}]);url.setParameter("mode","import");url.setParameter("mime-type","text/html");url=url.toProxifiedString();model=new com.ibm.mm.enabler.SubmittableFormImpl(url,"post",id);}else{if(id=="pageForm"){var _16a2=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_RESOURCE);url=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(_16a2.url,this);url.setParameter("mode","import");url.setParameter("mime-type","text/html");if(arguments[1]){url.setParameter("spaceId",arguments[1]);}url=url.toProxifiedString();model=new com.ibm.mm.enabler.SubmittableFormImpl(url,"post",id);}}return model;},_acquire:function(){this.requestCount++;},_release:function(_16a3,_16a4){this.statusCode=Math.max(parseInt(_16a4,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_16a3){_16a3.finish(null,this.statusCode);}}},remove:function(node){var _16a5="remove(node)";var _16a6=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_16a6){this.LOGGER.entering(_16a5,node);}var id=node.getID();var _16a7=null;if(id in this.loadedNodes){_16a7=this.loadedNodes[id];delete this.loadedNodes[id];}else{if(this.favoritesModel&&id in this.favoritesModel.loadedNodes){_16a7=this.favoritesModel.loadedNodes[id];delete this.favoritesModel.loadedNodes[id];}else{_16a7=node;}}if(!(id in this.deletedNodes)){this.deletedNodes[id]=_16a7;}var found=null;for(var i=0;i<this.entries.length;i++){if(this.entries[i]==id){found=i;}}if(found){this.entries.splice(found,1);if(this.cursor>found){this.cursor--;}}if(_16a6){this.LOGGER.exiting(_16a5,node);}},confirmRemove:function(node){var _16a8=true;var _16a9=this.spaceExtensionModel.findExtensionBySpace(node).start();if(_16a9){var _16aa=typeof (node)=="string"?node:node.getID();var _16ab=_16a9.canDeleteSpace(_16aa,null);_16a8=(!_16ab||_16ab.getState()=="OK");}return this.getConfirmRemove(node)&&_16a8;},confirmExport:function(node){if(com.ibm.mm.enabler.AnonymousHelper.getAnonymousMode()==com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS){return false;}var _16ac=true;var _16ad=this.spaceExtensionModel.findExtensionBySpace(node).start();if(_16ad){var _16ae=typeof (node)=="string"?node:node.getID();var _16af=_16ad.canExportSpace(_16ae,null);_16ac=(!_16af||_16af.getState()=="OK");}return _16ac;},confirmCopy:function(node){if(com.ibm.mm.enabler.AnonymousHelper.getAnonymousMode()==com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS){return false;}var _16b0=true;var _16b1=this.spaceExtensionModel.findExtensionBySpace(node).start();if(_16b1){var _16b2=typeof (node)=="string"?node:node.getID();var _16b3=_16b1.canCopySpace(_16b2,null);_16b0=(!_16b3||_16b3.getState()=="OK");}return _16b0;},iterator:function(){return this;},start:function(sync){while(this._hasNext(this,sync)){if(this._next(this,sync)){continue;}else{break;}}},hasNext:function(){return this._hasNext(null,true);},_hasNext:function(_16b4,sync){var _16b5=false;if(this.entries[this.cursor]===undefined){this._loadAhead(_16b4,sync);}var next=this.entries[this.cursor];if(next!==null&&next!==undefined){_16b5=true;}return _16b5;},next:function(){return this._next(null,true);},_next:function(_16b6,sync){return this._hasNext(_16b6,sync)?this.loadedNodes[this.entries[this.cursor++]]:null;},size:function(){return this.sizeValue;},setCursorPosition:function(_16b7){this.cursor=_16b7;},getCursorPosition:function(){return this.cursor;},_loadAhead:function(_16b8,sync){var _16b9="_loadAhead(deferred, sync)";var _16ba=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_16ba){this.LOGGER.entering(_16b9,[_16b8,sync]);}var myUrl;this._initServiceDoc();if(!this.nextLink){if(_16ba){this.LOGGER.trace(_16b9,"Creating new model URL link");}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.serviceJson.url,this);}else{if(_16ba){this.LOGGER.trace(_16b9,"Reusing 'next' link");}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.nextLink,this);}myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);myUrl.setParameter("start",this.getCursorPosition());if(this.strategy){for(var x in this.strategy){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.strategy[x],com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy)){myUrl.setParameter("num",this.strategy[x].getInterval());break;}}}this._applyHiddenMetaDataLoadingStrategyToModelURL(myUrl);var _16bb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var _16bc=this.entries;var _16bd=0;var model=this.model;_16bb.read(dojo.hitch(this,function(type,data,xhr,args){var _16be="_loadAhead_callback(type, data, xhr, args)";if(_16ba){this.LOGGER.entering(_16be,[type,data,xhr,args]);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr;if(!this.sizeValue){expr="atom:feed/openSearch:totalResults";var _16bf=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(_16bf&&_16bf.length>0){this.sizeValue=com.ibm.mm.enabler.utils.Dom.textContent(_16bf[0]);if(_16ba){this.LOGGER.trace(_16be,"Total reported entry count: ${0}",this.sizeValue);}}}this.nextLink=null;expr="atom:feed/atom:link[@rel='next']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes&&nodes.length>0){this.nextLink=nodes[0].getAttribute("href");}if(_16ba){this.LOGGER.trace(_16be,"New nextLink = ${0}",this.nextLink);}expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _16c0=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_16c0,this.ns);_16bd=nodes.length;this.start=this.getCursorPosition();for(var i=0;i<nodes.length;++i){var node=new com.ibm.mm.enabler.space.SpaceNodeImpl(nodes[i],this.um,this);this.entries[this.cursor+i]=node.getID();this._cacheNode(node);if(_16b8&&_16b8.foreachCallback){_16b8.foreachCallback(this.loadedNodes[id],_16b8.foreachCallbackParameters);}}this.entries[this.cursor+nodes.length]=this.nextLink?undefined:null;if(_16b8){_16b8.finish(null,xhr.status);}}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_16b8){_16b8.finish(null,xhr.status);}}}if(_16ba){this.LOGGER.exiting(_16be,[type,data,xhr,args]);}}));if(_16ba){this.LOGGER.exiting(_16b9);}},_cacheNode:function(node){var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.initialContents[id]=node.toString();}return this.loadedNodes[id];}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.SpaceModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.SpaceModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.SpaceModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.space.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.space.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.space.Factory_API");dojo.provide("com.ibm.mashups.enabler.space.Factory");dojo.declare("com.ibm.mashups.enabler.space.Factory",null,{getSpaceModel:function(){},getSpaceExtensionModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.space.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.space.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.space.FactoryImpl");dojo.declare("com.ibm.mm.enabler.space.FactoryImpl",com.ibm.mashups.enabler.space.Factory,{getSpaceModel:function(){return com.ibm.mm.enabler.model.SpaceModelImpl.prototype.getInstance();},getSpaceExtensionModel:function(){return new com.ibm.mm.enabler.model.SpaceExtensionModelImpl();}});com.ibm.mashups.enabler.space.Factory=new com.ibm.mm.enabler.space.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.space.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.space.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.space.Factory");}if(!dojo._hasResource["com.ibm.mm.enabler.ACLinkProviderImpl"]){dojo._hasResource["com.ibm.mm.enabler.ACLinkProviderImpl"]=true;dojo.provide("com.ibm.mm.enabler.ACLinkProviderImpl");dojo.declare("com.ibm.mm.enabler.ACLinkProviderImpl",null,{constructor:function(){var _16c1=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns_acrlp=dojo.delegate(_16c1.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_EXT,nsf.NS_AC,nsf.NS_CA]));this.AC_RESOURCE_ATOM_LINK="atom:link[@ext:rel='ac-resource-config']";this.AC_ROLES_ATOM_LINK="atom:link[@ext:rel='roles']";this.CA_ROLES_ATOM_LINK="atom:link[@ca:rel='roles']";this.AC_MEMBERS_ATOM_LINK="atom:link[@ac:rel='members']";},getACResourceLink:function(_16c2){var _16c3=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.AC_RESOURCE_ATOM_LINK,_16c2,this.ns_acrlp);if(nodes&&nodes.length>0){_16c3=nodes[0].getAttribute("href");}return _16c3;},getACRolesLink:function(_16c4){var _16c5=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.AC_ROLES_ATOM_LINK,_16c4,this.ns_acrlp);if(nodes&&nodes.length>0){_16c5=nodes[0].getAttribute("href");}return _16c5;},getCARolesLink:function(_16c6){var _16c7=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.CA_ROLES_ATOM_LINK,_16c6,this.ns_acrlp);if(nodes&&nodes.length>0){_16c7=nodes[0].getAttribute("href");}return _16c7;},getACMembersLink:function(_16c8){var _16c9=null;var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.AC_MEMBERS_ATOM_LINK,_16c8,this.ns_acrlp);if(nodes&&nodes.length>0){_16c9=nodes[0].getAttribute("href");}return _16c9;}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.AccessControlModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.AccessControlModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.AccessControlModelImpl");dojo.declare("com.ibm.mm.enabler.ac.AccessControlModelImpl",[com.ibm.mashups.enabler.ac.AccessControlModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.ACLinkProviderImpl,com.ibm.mm.enabler.ConfirmableModelImpl],{constructor:function(_16ca){this.mainResource=_16ca;this.url=com.ibm.mashups.enabler.model.url.ModelUrlFactory.AI_URL;},_init:function(){this.initialContentsMembers=null;this.rolesLoadedNodes={};this.rolesCreatedNodes={};this.rolesDeletedNodes={};var _16cb;this.roleModel=_16cb;this.rolesStart=null;this.rolesNum=null;this.rolesSizeValue=9999;this.rolesEntries=[];this.rolesCursor=0;this.rolesSize=null;this.membersLoadedNodes={};this.membersCreatedNodes={};this.membersDeletedNodes={};this.membersDeletedNodesMemberIDs={};this.memberModel={};this.membersEntries={};this.membersCursor={};this.membersSize={};this.xmlDataMember={};this.initialContentsMember={};this.owner=null;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.um=com.ibm.mashups.enabler.user.Factory.getUserModel();this.prefix="resource";this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_XML,this.nsf.NS_OPENSEARCH,this.nsf.NS_AC,this.nsf.NS_AI,this.nsf.NS_APP,this.nsf.NS_CA]);this.changedProperties={};},getResource:function(){return this.mainResource;},_isPageInSpace:function(){return false;},_getPossibleRoles:function(){return null;},_getRolesLink:function(){return null;},_getMembersLink:function(_16cc){return null;},_getCreationRoleName:function(_16cd){return null;},_getCreationResourceID:function(){return this.mainResource.getID();},_filterRole:function(node){return false;},setID:function(id){throw new Error(this.modelMessages.E_UNSUPPORTED_OP_0);},isInitialized:function(){return true;},getRoleModel:function(){if(this.roleModel===undefined){this._loadAheadRole(null,true);}return this.roleModel;},getRoleModel:function(_16ce){if(this.roleModel===undefined){this._loadAheadRole(null,true);}return this.roleModel;},confirmGetRoleModel:function(){if(com.ibm.mm.enabler.AnonymousHelper.getAnonymousMode()==com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS){return false;}return this.mainResource.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);},_loadAheadRole:function(_16cf,sync){var myUrl;var _16d0;this.rolesEntries=[];this.rolesStart=0;this.rolesCursor=0;var _16d1=this._getPossibleRoles();if((this._isPageInSpace())&&(_16d1)){var i=0;for(var _16d2 in _16d1){if(Object.prototype.hasOwnProperty.call(_16d1,_16d2)){var _16d3=_16d1[_16d2];myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url,this);_16d0=[{value:"collection",isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE},{value:this.mainResource.getID(),isID:true}];myUrl.setNodes(_16d0);myUrl.setParameter("filter","type="+_16d3);this.__loadAheadRole(myUrl,_16cf,sync,i,_16d2);i++;}}this.roleModel=new com.ibm.mm.enabler.ac.RoleModelImpl(this,this.um);}else{if(!this.rolesNextLink){var link=this._getRolesLink();if(link){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url,this);_16d0=[{value:"collection",isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE},{value:this.mainResource.getID(),isID:true}];myUrl.setNodes(_16d0);}}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.rolesNextLink,this);}myUrl.setParameter("start",this.rolesPosition);if(this.url===com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL){myUrl.setParameter("filter","all");}if(this.strategy){for(var x in this.strategy){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.strategy[x],com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl)){myUrl.setParameter("num",this.strategy[x].getInterval());break;}}}this.__loadAheadRole(myUrl,_16cf,sync,null);}},__loadAheadRole:function(myUrl,_16d4,sync,_16d5,_16d6){var _16d7=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_16d5=_16d5||null;_16d7.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr,nodes;if(_16d5===null){if(!this.rolesSizeValue){expr="atom:feed/openSearch:totalResults";var _16d8=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(_16d8&&_16d8.length>0){this.rolesSizeValue=com.ibm.mm.enabler.utils.Dom.textContent(_16d8[0]);}}this.rolesNextLink=null;expr="atom:feed/atom:link[@rel='next']";nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes&&nodes.length>0){this.rolesNextLink=nodes[0].getAttribute("href");}}expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _16d9=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_16d9,this.ns);if(nodes.length>0){var i,c,l,node;if(_16d5===null){for(i=0,c=0,l=nodes.length;i<l;i++){node=new com.ibm.mm.enabler.ac.RoleNodeImpl(nodes[i],this.um);if(this._filterRole(node)){continue;}this.rolesEntries[this.rolesCursor+c]=node.getID();this._cacheNodeRoles(node);c++;if(_16d4&&_16d4.foreachCallback){_16d4.foreachCallback(this.rolesLoadedNodes[id],_16d4.foreachCallbackParameters);}}}else{for(i=0,c=0,l=nodes.length;i<l;i++){node=new com.ibm.mm.enabler.ac.RoleNodeImpl(nodes[i],this.um,_16d6);if(this._filterRole(node)){continue;}this.rolesEntries[this.rolesCursor+_16d5+c]=node.getID();this._cacheNodeRoles(node);c++;}}}if(_16d5===null){this.rolesEntries[this.rolesEntries.length]=this.rolesNextLink?undefined:null;this.roleModel=new com.ibm.mm.enabler.ac.RoleModelImpl(this,this.um);}else{this.rolesEntries[this.rolesEntries.length]=null;}if(_16d4){_16d4.finish(null,xhr.status);}}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_16d4){_16d4.finish(null,xhr.status);}}}}));},_cacheNodeRoles:function(node){var id=node.getID();if(!(id in this.rolesLoadedNodes)){this.rolesLoadedNodes[id]=node;}return this.rolesLoadedNodes[id];},_replaceNodeRoles:function(_16da,_16db){if(_16da){var oldID=_16da.getID();var newID=_16db.getID();var len=this.rolesEntries.length;if(len<=1){this.rolesEntries=[];this.rolesEntries[0]=_16db.getID();}else{for(var i=0;i<len;i++){var id=this.rolesEntries[i];if(id==oldID){this.rolesEntries[i]=newID;if(this.membersCreatedNodes[oldID]){this.membersCreatedNodes[newID]=this.membersCreatedNodes[oldID];delete this.membersCreatedNodes[oldID];}break;}}}delete this.rolesCreatedNodes[oldID];delete this.rolesLoadedNodes[oldID];}this._cacheNodeRoles(_16db);},_loadAheadMember:function(role,_16dc,sync){this._loadMemberModel(role.getID(),role.getRoleType(),this._getMembersLink(role.xmlData),null,true);},_loadMemberModel:function(id,_16dd,link,_16de,sync){this.memberModel[id]=null;this.membersLoadedNodes[id]={};this.membersCreatedNodes[id]={};this.membersDeletedNodes[id]={};this.membersDeletedNodesMemberIDs[id]={};this.membersEntries[id]=[];this.membersCursor[id]=0;this.xmlDataMember[id]={};this.initialContentsMember[id]={};if(this.rolesCreatedNodes[id]){var node=new com.ibm.mm.enabler.ac.MemberModelImpl(id,this,this.um,true);this.memberModel[id]=node;return;}var myUrl=null;if(!link){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url,this);var _16df=[{value:"collection",isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_MEMBER},{value:_16dd,isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE},{value:this.mainResource.getID(),isID:true}];myUrl.setNodes(_16df);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}var _16e0=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var _16e1=this.membersEntries[id];var model=this.model;_16e0.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _16e2=(feed&&feed.length>0)?feed[0]:data;this.xmlDataMember[id]=_16e2;this.initialContentsMember[id]=com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlDataMember[id]);var node=new com.ibm.mm.enabler.ac.MemberModelImpl(id,this,this.um,false);this.memberModel[id]=node;if(_16de){_16de.finish(null,xhr.status);}}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_16de){_16de.finish(null,xhr.status);}}}}));},_cacheNodeMembers:function(_16e3,_16e4){var id=_16e4.getID();if(!(id in this.membersLoadedNodes[_16e3])){this.membersLoadedNodes[_16e3][id]=_16e4;}return this.membersLoadedNodes[_16e3][id];},__commit:function(_16e5,sync){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.mainResource,com.ibm.mashups.enabler.space.SpaceNode)){var _16e6=this.mainResource;var _16e7=com.ibm.mashups.enabler.space.Factory.getSpaceExtensionModel();var _16e8=_16e7.findExtensionBySpace(_16e6).start();if(_16e8){var _16e9=this._diffAccessControlChanges();if(_16e9!==null){var _16ea=_16e8.onSpaceUpdate(_16e6.getID(),dojo.toJson(_16e9,true),null);if(_16ea&&_16ea.getState()!="OK"){return;}}}}this._acquire();var id;var link;var myUrl;var _16eb;var _16ec;for(id in this.rolesCreatedNodes){if(Object.prototype.hasOwnProperty.call(this.rolesCreatedNodes,id)){var role=this.rolesCreatedNodes[id];var _16ed=role.getRoleName();link=this._getRolesLink();if(link){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url,this);_16ec=[{value:"collection",isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE},{value:this.mainResource.getID(),isID:true}];myUrl.setNodes(_16ec);}_16eb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_16eb.create(role.toString(),dojo.hitch(this,function(type,data,xhr,args){var _16ee=null;if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _16ef=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_16ef,this.ns);if(nodes.length>0){for(var i=0,l=nodes.length;i<l;i++){_16ee=new com.ibm.mm.enabler.ac.RoleNodeImpl(nodes[i],this.um);if(_16ee.getRoleName()==_16ed){var len=this.rolesEntries.length;var _16f0=null;for(var id in this.rolesCreatedNodes){if(Object.prototype.hasOwnProperty.call(this.rolesCreatedNodes,id)){var node=this.rolesCreatedNodes[id];if(node.getRoleName()==_16ee.getRoleName()){_16f0=node;break;}}}this._replaceNodeRoles(_16f0,_16ee);break;}}}}if(_16e5&&_16e5.operationCallback){_16e5.operationCallback(_16ee,com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_16e5.operationCallbackParameters);}this._release(_16e5,xhr.status);}));}}this.rolesCreatedNodes={};for(var id3 in this.rolesDeletedNodes){if(this.rolesDeletedNodes.hasOwnProperty(id3)){var _16f1=this.rolesDeletedNodes[id3];var _16f2=_16f1.getEditLink();myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelUrl(_16f2,this);_16eb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_16eb.remove(dojo.hitch(this,function(type,data,xhr,args){if(_16e5&&_16e5.operationCallback){_16e5.operationCallback(id3,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_16e5.operationCallbackParameters);}this._release(_16e5,xhr.status);}));}}this.rolesDeletedNodes={};for(var id1 in this.rolesLoadedNodes){if(Object.prototype.hasOwnProperty.call(this.rolesLoadedNodes,id1)){var role1=this.rolesLoadedNodes[id1];var _16f3=role1.getID();var _16f4=role1.getRoleType();for(id in this.membersCreatedNodes[_16f3]){if(Object.prototype.hasOwnProperty.call(this.membersCreatedNodes[_16f3],id)){var _16f5=this.membersCreatedNodes[_16f3][id];link=this._getMembersLink(role1.xmlData);if(link){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url,this);_16ec=[{value:"collection",isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_MEMBER},{value:_16f4,isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE},{value:this.mainResource.getID(),isID:true}];myUrl.setNodes(_16ec);}_16eb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_16eb.create(_16f5._toEntry(),dojo.hitch(this,function(type,data,xhr,args){var _16f6=null;if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr="//atom:entry";var _16f7=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(_16f7&&_16f7.length>0){for(var i=0,l=_16f7.length;i<l;i++){_16f6=new com.ibm.mm.enabler.ac.MemberNodeImpl(id,_16f7[i],this.um);}}}if(_16e5&&_16e5.operationCallback){_16e5.operationCallback(_16f6,com.ibm.mashups.enabler.DeferredOperation.OPERATION_MODIFY,xhr.status,_16e5.operationCallbackParameters);}this._release(_16e5,xhr.status);}));}}this.membersCreatedNodes[_16f3]={};for(var id2 in this.membersDeletedNodes[_16f3]){if(Object.prototype.hasOwnProperty.call(this.membersDeletedNodes[_16f3],id2)){var _16f8=this.membersDeletedNodes[_16f3][id2];var _16f9=this.membersDeletedNodesMemberIDs[_16f3][id2];var _16fa=null;link=_16f8.getEditLink();if(link){_16fa=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{_16fa=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url,this);_16ec=[{value:_16f9,isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_MEMBER},{value:_16f4,isID:false,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ROLE},{value:this.mainResource.getID(),isID:true}];_16fa.setNodes(_16ec);}_16eb=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_16fa,null,null,false,sync);this._acquire();_16eb.remove(dojo.hitch(this,function(type,data,xhr,args){var _16fb=null;if(type!=com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){_16fb=id2;}if(_16e5&&_16e5.operationCallback){_16e5.operationCallback(_16fb,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_16e5.operationCallbackParameters);}this._release(_16e5,xhr.status);}));}}this.membersDeletedNodes[_16f3]={};this.membersDeletedNodesMemberIDs[_16f3]={};}}},_initDelta:function(){var delta={accesscontrol:{}};var _16fc,type;if(this.subResource){_16fc=this.subResource.getID();type=(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.subResource,com.ibm.mashups.enabler.space.SpaceNode))?"space":"page";}else{_16fc=this.mainResource.getID();type="space";}delta.accesscontrol.resourceid=_16fc;delta.accesscontrol.type=type;return delta;},_diffAccessControlChanges:function(){var delta=null;var i,l;if("owner" in this.changedProperties){if(!delta){delta=this._initDelta();}var _16fd=this.getOwner();if(_16fd!=this.changedProperties.owner){delta.accesscontrol.owner=(typeof (_16fd)=="string")?_16fd:_16fd.getID();}}if("roleblock" in this.changedProperties){if(!delta){delta=this._initDelta();}for(var _16fe in this.changedProperties.roleblock){if(Object.prototype.hasOwnProperty.call(this.changedProperties.roleblock,_16fe)){var _16ff=this.changedProperties.roleblock[_16fe];var _1700=this._getRoleTypes(_16fe);var _1701=(_1700.length!=_16ff.length);if(!_1701){for(var i2=0,l2=_1700.length;i2<l2;i2++){if(typeof _16ff[_1700[i2]]!="undefined"){_1701=true;break;}}}if(_1701){if(!delta.accesscontrol.roleblock){delta.accesscontrol.roleblock={};}delta.accesscontrol.roleblock[_16fe]=_1700;}}}}if("role" in this.changedProperties){if(!delta){delta=this._initDelta();}var _1702=function(_1703,_1704,_1705){var id;var _1706=[];var index=0;if(_1703){for(id in _1703){if(Object.prototype.hasOwnProperty.call(_1703,id)){if(_1703[id]){_1706[index++]=_1703[id];}}}}if(_1704){for(id in _1704){if(Object.prototype.hasOwnProperty.call(_1704,id)){if(typeof _1703[id]=="undefined"&&_1704[id]){_1706[index++]=_1704[id];}}}}if(_1705){for(id in _1705){if(_1705[id]){var _1707=_1705[id].getID();for(var j=0;j<_1706.length;j++){if(_1706[j].getID()==_1707){_1706.splice(j,1);break;}}}}}return _1706;};var _1708=function(delta,_1709,role,_170a,_170b,_170c,_170d){var id;var _170e=false;for(id in _170b){if(Object.prototype.hasOwnProperty.call(_170b,id)){_170e=true;}}var _170f=false;for(id in _170d){if(Object.prototype.hasOwnProperty.call(_170d,id)){_170f=true;}}if(_170a&&(_170e||_170f)||!_170a){if(!delta.accesscontrol.role){delta.accesscontrol.role=[];}delta.accesscontrol.role[_1709]={};delta.accesscontrol.role[_1709].name=role.getRoleType();var _1710=_1702(_170b,_170c,_170d);for(var i=0,l=_1710.length;i<l;i++){var _1711=_1710[i];var _1712=_1711.getEntity();if(_1712){if(!delta.accesscontrol.role[_1709].member){delta.accesscontrol.role[_1709].member=[];}delta.accesscontrol.role[_1709].member[i]={id:_1711.getID(),type:_1712.getEntityType()};}}}};var _1713=0;var _1714=_1702(this.rolesCreatedNodes,this.rolesLoadedNodes,this.rolesDeletedNodes);for(i=0,l=_1714.length;i<l;i++){var role=_1714[i];var _1715=role.getID();var _1716=false;for(var id in this.changedProperties.role){if(Object.prototype.hasOwnProperty.call(this.changedProperties.role,id)){var _1717=this.changedProperties.role[id];if(_1717==_1715){_1716=true;break;}}}_1708(delta,_1713,role,_1716,this.membersCreatedNodes[_1715],this.membersLoadedNodes[_1715],this.membersDeletedNodes[_1715]);_1713++;}}this.changedProperties={};return delta;},_removeNodeRoles:function(role){var id=role.getID();if(id in this.rolesLoadedNodes){delete this.rolesLoadedNodes[id];}if(id in this.rolesCreatedNodes){delete this.rolesCreatedNodes[id];}else{this.rolesDeletedNodes[id]=role;}if(this.membersCreatedNodes[id]){delete this.membersCreatedNodes[id];}},_acquire:function(){this.requestCount++;},_release:function(_1718,_1719){this.statusCode=Math.max(parseInt(_1719,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_1718){_1718.finish(null,this.statusCode);}}}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.AccessControlModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.SpaceAccessControlModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.SpaceAccessControlModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.SpaceAccessControlModel_API");dojo.provide("com.ibm.mashups.enabler.ac.SpaceAccessControlModel");dojo.declare("com.ibm.mashups.enabler.ac.SpaceAccessControlModel",com.ibm.mashups.enabler.ac.AccessControlModel,{});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.SpaceAccessControlModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.SpaceAccessControlModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.SpaceAccessControlModelImpl");dojo.declare("com.ibm.mm.enabler.ac.SpaceAccessControlModelImpl",[com.ibm.mashups.enabler.ac.SpaceAccessControlModel,com.ibm.mm.enabler.ac.AccessControlModelImpl],{constructor:function(_171a){this.mainResource=_171a;this.xmlData=this.mainResource.xmlData;this.initialContentsResource=null;this.xmlDataResources=null;this._init();},_filterRole:function(node){return (node.getRoleName().indexOf("@")>0);},_getRolesLink:function(){return this.getCARolesLink(this.mainResource.xmlData);},_getMembersLink:function(_171b){return this.getACMembersLink(_171b);},getOwner:function(){return this.mainResource._getOwner();},setOwner:function(user){this.mainResource._setOwner(user);},confirmSetOwner:function(user){return this.mainResource.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_171c,sync){var _171d=this.mainResource._getSpaceModel();_171d.commit().start();this.__commit(_171c,sync);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.SpaceAccessControlModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.SpaceAccessControlModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.SpaceAccessControlModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel_API");dojo.provide("com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel");dojo.declare("com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel",com.ibm.mashups.enabler.ac.SpaceAccessControlModel,{});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceAccessControlModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceAccessControlModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.ResourceAccessControlModel_API");dojo.provide("com.ibm.mashups.enabler.ac.ResourceAccessControlModel");dojo.declare("com.ibm.mashups.enabler.ac.ResourceAccessControlModel",[com.ibm.mashups.enabler.ac.AccessControlModel],{isInheritanceBlock:function(_171e){},setInheritanceBlock:function(_171f,value){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceAccessControlModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceAccessControlModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.ResourceAccessControlModel");}if(!dojo._hasResource["com.ibm.mm.enabler.ac.ResourceAccessControlModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.ResourceAccessControlModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.ResourceAccessControlModelImpl");dojo.declare("com.ibm.mm.enabler.ac.ResourceAccessControlModelImpl",[com.ibm.mashups.enabler.ac.ResourceAccessControlModel,com.ibm.mm.enabler.ac.AccessControlModelImpl],{constructor:function(_1720){this.mainResource=_1720;this.subResource=this.mainResource;this.url=com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL;this.url2=com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL;},_getRolesLink:function(){return this.getACRolesLink(this.mainResource.xmlData);},_getMembersLink:function(_1721){return this.getACMembersLink(_1721);},_getResourceLink:function(){return this.getACResourceLink(this.mainResource.xmlData);},isInheritanceBlock:function(_1722){return this.isRoleBlock(_1722,"inheritance");},setInheritanceBlock:function(_1723,value){this.setRoleBlock(_1723,value,"inheritance");},getOwner:function(){if(this.owner===null){if(this.xmlData===undefined){this._loadAheadResource(null,true);}var expr="atom:content/ac:resource-config/ac:owner";var owner=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(owner&&owner.length>0){var _1724=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(owner[0],"ac:id","id",this.ns.ac);this.owner=this.um.find(_1724).start();}}return this.owner;},setOwner:function(user){if(this.xmlData===undefined){this._loadAheadResource(null,true);}if(!this.changedProperties.owner){this.changedProperties.owner=this._getOwner();}this.owner=user;var expr="atom:content/ac:resource-config/ac:owner";var owner=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(owner&&owner.length>0){com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(owner[0],"ac:id",this.nsf.getNameSpaceUri(this.nsf.NS_AC),user.getID());}else{expr="atom:content/ac:resource-config";var _1725=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_1725&&_1725.length>0){var tn=com.ibm.mm.enabler.utils.Dom.createElement(this.xmlData.ownerDocument,"ac:owner",this.nsf.getNameSpaceUri(this.nsf.NS_AC));com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(tn,"ac:id",this.nsf.getNameSpaceUri(this.nsf.NS_AC),user.getID());_1725[0].appendChild(tn);}}},confirmSetOwner:function(user){return this.subResource.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);},confirmGetRoleModel:function(){return this.subResource.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER);},_getOwner:function(){if(this.xmlData===undefined){this._loadAheadResource(null,true);}var expr="atom:content/ac:resource-config/ac:owner";var owner=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(owner&&owner.length>0){return com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(owner[0],"ac:id","id",this.nsf.getNameSpaceUri(this.nsf.NS_AC));}return null;},_loadAheadResource:function(_1726,sync){var myUrl=null;var link=this._getResourceLink();if(link){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(link,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url2,this);var _1727=[{value:this.subResource.getID(),isID:true,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_RESOURCE}];myUrl.setNodes(_1727);}var _1728=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1728.read(dojo.hitch(this,function(type,data,xhr,args){var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _1729=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_1729,this.ns);this.xmlData=nodes[0];this.initialContentsResource=com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);if(_1726){_1726.finish(null,xhr.status);}}));},isRoleBlock:function(_172a,_172b){if(this.xmlData===undefined){this._loadAheadResource(null,true);}if(_172a){var expr="atom:content/ac:resource-config/ac:role-block";var _172c=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_172c&&_172c.length>0){for(var i=0;i<_172c.length;i++){var _172d=_172c[i];var block=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_172d,"ac:block-type","block-type",this.ns.ac);var type=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_172d,"ac:type","type",this.ns.ac);if(block&&type){if(_172a.toUpperCase()==type.toUpperCase()){if(_172b.toUpperCase()==block.toUpperCase()){return true;}}}}}}return false;},isPropagationBlock:function(_172e){return this.isRoleBlock(_172e,"propagation");},setRoleBlock:function(_172f,value,_1730){if(this.xmlData===undefined){this._loadAheadResource(null,true);}if(!this.changedProperties.roleblock){this.changedProperties.roleblock={};}if(!this.changedProperties.roleblock[_1730]){this.changedProperties.roleblock[_1730]=this._getRoleTypes(_1730);}var expr,block;if(!value){expr="atom:content/ac:resource-config/ac:role-block";var _1731=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);if(_1731&&_1731.length>0){for(var i=0;i<_1731.length;i++){var _1732=_1731[i];block=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_1732,"ac:block-type","block-type",this.ns.ac);var type=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_1732,"ac:type","type",this.ns.ac);if(block&&type){if(_172f.toUpperCase()==type.toUpperCase()){if(_1730.toUpperCase()==block.toUpperCase()){var _1733=_1732.parentNode;_1733.removeChild(_1732);return;}}}}}}else{expr="atom:content/ac:resource-config";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _1734=nodes[0];block=com.ibm.mm.enabler.utils.Dom.createElement(this.xmlData.ownerDocument,"ac:role-block",this.ns.ac);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,block,"ac:block-type","block-type",this.ns.ac,_1730);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(this.xmlData.ownerDocument,block,"ac:type","type",this.ns.ac,_172f);_1734.appendChild(block);}},_getRoleTypes:function(_1735){if(this.xmlData===undefined){this._loadAheadResource(null,true);}var _1736=[];var expr="atom:content/ac:resource-config/ac:role-block[@ac:block-type='"+_1735+"']";var _1737=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);for(var i=0;i<_1737.length;i++){_1736[i]=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_1737[i],"ac:type","type",this.ns.ac);}return _1736;},setPropagationBlock:function(_1738,value){this.setRoleBlock(_1738,value,"propagation");},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_1739,sync){if(this.initialContentsResource&&this.initialContentsResource!==com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData)){this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this.requestCount=0;this._acquire();var myUrl=new com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.url2,this);var _173a=[{value:this.subResource.getID(),isID:true,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_RESOURCE}];myUrl.setNodes(_173a);var _173b=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,true);this._acquire();_173b.update(com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData),dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){}this.initialContentsResource=com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);if(_1739&&_1739.operationCallback){_1739.operationCallback(this,com.ibm.mashups.enabler.DeferredOperation.OPERATION_CREATE,xhr.status,_1739.operationCallbackParameters);}this._release(_1739,xhr.status);}));}this.__commit(_1739,sync);}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.ResourceSpaceAccessControlModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.ResourceSpaceAccessControlModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.ResourceSpaceAccessControlModelImpl");dojo.declare("com.ibm.mm.enabler.ac.ResourceSpaceAccessControlModelImpl",[com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel,com.ibm.mm.enabler.ac.ResourceAccessControlModelImpl],{constructor:function(_173c,_173d){this.mainResource=_173c;this.subResource=_173d;this.url=com.ibm.mashups.enabler.model.url.ModelUrlFactory.AI_URL;this.url2=com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL;},_getRolesLink:function(){return this.getACRolesLink(this.mainResource.xmlData);},_getResourceLink:function(){return this.getACResourceLink(this.subResource.xmlData);},_getCreationRoleName:function(_173e){return _173e+"@"+this.subResource.getID();},_getCreationResourceID:function(){return this.subResource.getID();},_isPageInSpace:function(){return true;},_getPossibleRoles:function(){var roles={};var names=this.subResource.getMetaDataNames();for(var i=0;i<names.length;i++){if(names[i].indexOf("com.ibm.mashups.acl.role.")===0){var _173f=names[i].substring("com.ibm.mashups.acl.role.".length);var _1740=this.subResource.getMetaData(names[i]);roles[_173f]=_1740;}}return roles;},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_1741,sync){for(var id in this.rolesCreatedNodes){if(Object.prototype.hasOwnProperty.call(this.rolesCreatedNodes,id)){var role=this.rolesCreatedNodes[id];this.subResource.setMetaData("com.ibm.mashups.acl.role."+role.getRoleType(),role.getRoleName());}}var _1742=this.subResource._getLayoutModel();var _1743=_1742._getNavigationModel();_1743.commit().start();this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.ResourceSpaceAccessControlModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModelFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModelFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.AccessControlModelFactory_API");dojo.provide("com.ibm.mashups.enabler.ac.AccessControlModelFactory");dojo.declare("com.ibm.mashups.enabler.ac.AccessControlModelFactory",null,{getAccessControlModel:function(_1744){},getAccessControlModel:function(_1745){},getAccessControlModel:function(_1746){},getAccessControlModel:function(_1747,_1748){},getAccessControlModel:function(_1749,_174a){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.AccessControlModelFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.AccessControlModelFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.AccessControlModelFactoryImpl");dojo.declare("com.ibm.mm.enabler.ac.AccessControlModelFactoryImpl",com.ibm.mashups.enabler.ac.AccessControlModelFactory,{modelMessages:null,_resourceACModels:null,_resourceSpaceACModels:null,constructor:function(){this._resourceACModels={};this._resourceSpaceACModels={};this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");},_transformXNode:function(xNode){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.layout.LayoutContainer)){xNode=xNode._getContent();dojo.deprecated("com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel","The method com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel used in conjunction with com.ibm.mashups.enabler.layout.LayoutNode is deprecated, please use com.ibm.mashups.enabler.content.ContentNode as parameter instead!");}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.layout.LayoutFragment)){dojo.deprecated("com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel","The method com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel used in conjunction with com.ibm.mashups.enabler.layout.LayoutFragment is deprecated, please use com.ibm.mashups.enabler.content.ContentNode as parameter instead!");}}return xNode;},_getResourceSpaceAccessControlModel:function(_174b,xNode){var ret=null;var _174c=_174b.getID();var xID=xNode.getID();if(this._resourceSpaceACModels[_174c]){ret=this._resourceSpaceACModels[_174c][xID];}if(!ret){ret=new com.ibm.mm.enabler.ac.ResourceSpaceAccessControlModelImpl(_174b,xNode);if(!this._resourceSpaceACModels[_174c]){this._resourceSpaceACModels[_174c]={};}this._resourceSpaceACModels[_174c][xID]=ret;}return ret;},_getResourceAccessControlModel:function(xNode){var ret=null;var xID=xNode.getID();ret=this._resourceACModels[xID];if(!ret){ret=new com.ibm.mm.enabler.ac.ResourceAccessControlModelImpl(xNode);this._resourceACModels[xID]=ret;}return ret;},_getSpaceAccessControlModel:function(_174d){return new com.ibm.mm.enabler.ac.SpaceAccessControlModelImpl(_174d);},_getAccessControlModelFromSingleNode:function(xNode){xNode=this._transformXNode(xNode);var ret=null;if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.space.SpaceNode)){ret=this._getSpaceAccessControlModel(xNode);}else{if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.content.ContentNode)||com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.layout.LayoutFragment)){ret=this._getResourceAccessControlModel(xNode);}else{throw new Error(dojo.string.substitute(this.modelMessages.E_INVALID_PARAM_TYPE_0,{num:1,type:"com.ibm.mashups.enabler.space.SpaceNode|com.ibm.mashups.enabler.content.ContentNode"}));}}return ret;},getAccessControlModel:function(){var xNode,ret=null;if(arguments.length===2&&arguments[0]===null){dojo.deprecated("com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel","The method com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel/2 used with null as first parameter is deprecated, please use com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel/1 instead!");ret=this._getAccessControlModelFromSingleNode(arguments[1]);}else{if(arguments.length===2){var _174e=arguments[0];xNode=arguments[1];if(!com.ibm.mm.enabler.utils.Misc.isInstanceOf(_174e,com.ibm.mashups.enabler.space.SpaceNode)){throw new Error(dojo.string.substitute(this.modelMessages.E_INVALID_PARAM_TYPE_0,{num:1,type:"com.ibm.mashups.enabler.space.SpaceNode"}));}xNode=this._transformXNode(xNode);if(!com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.content.ContentNode)&&!com.ibm.mm.enabler.utils.Misc.isInstanceOf(xNode,com.ibm.mashups.enabler.layout.LayoutFragment)){throw new Error(dojo.string.substitute(this.modelMessages.E_INVALID_PARAM_TYPE_0,{num:2,type:"com.ibm.mashups.enabler.content.ContentNode"}));}ret=this._getResourceSpaceAccessControlModel(_174e,xNode);}else{if(arguments.length===1){ret=this._getAccessControlModelFromSingleNode(arguments[0]);}else{throw new Error(this.modelMessages.E_INVALID_PARAM_COUNT_0);}}}if(ret!==null&&dojo.isFunction(ret._init)&&dojo.isFunction(ret._loadAheadResource)){ret._init();ret._loadAheadResource(null,true);}return ret;}});com.ibm.mashups.enabler.ac.AccessControlModelFactory=new com.ibm.mm.enabler.ac.AccessControlModelFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModelFactory"]){dojo._hasResource["com.ibm.mashups.enabler.ac.AccessControlModelFactory"]=true;dojo.provide("com.ibm.mashups.enabler.ac.AccessControlModelFactory");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.VirtualResourceType"]){dojo._hasResource["com.ibm.mashups.enabler.ac.VirtualResourceType"]=true;dojo.provide("com.ibm.mashups.enabler.ac.VirtualResourceType");dojo.declare("com.ibm.mashups.enabler.ac.VirtualResourceType",null,{ROOT:"wps.PORTAL",TEMPLATE:"wps.TEMPLATE_DEPLOYMENT",SPACE:"wps.APPLICATION_ENTITIES"});com.ibm.mashups.enabler.ac.VirtualResourceType=new com.ibm.mashups.enabler.ac.VirtualResourceType();}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.AccessFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.AccessFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.AccessFactory_API");dojo.provide("com.ibm.mashups.enabler.ac.AccessFactory");dojo.declare("com.ibm.mashups.enabler.ac.AccessFactory",null,{getEffectiveAccess:function(node){},getEffectiveAccessVirtualResource:function(_174f){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.AccessFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.AccessFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.AccessFactoryImpl");dojo.declare("com.ibm.mm.enabler.ac.AccessFactoryImpl",[com.ibm.mashups.enabler.ac.AccessFactory],{getEffectiveAccess:function(node){if((node)&&(node.hasRole)){return node;}return null;},getEffectiveAccessVirtualResource:function(_1750){var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.AC_URL,null);myUrl.setNodes([{value:_1750,isID:true,subModel:com.ibm.mashups.enabler.model.url.ModelUrlFactory.SUBMODEL_ACCESS}]);var _1751=null;var _1752=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,true);_1752.read(dojo.hitch(this,function(type,data,xhr,args){if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;var ns=nsf.getNameSpaces([nsf.NS_ATOM]);var expr="//atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,ns);if(nodes){_1751=nodes[0];}}}));if(_1751){var ret=new com.ibm.mm.enabler.ac.EffectiveAccessImpl();ret._init(_1751);return ret;}return null;}});com.ibm.mashups.enabler.ac.AccessFactory=new com.ibm.mm.enabler.ac.AccessFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.AccessFactory"]){dojo._hasResource["com.ibm.mashups.enabler.ac.AccessFactory"]=true;dojo.provide("com.ibm.mashups.enabler.ac.AccessFactory");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.Constants"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.Constants"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.Constants");dojo.declare("com.ibm.mashups.enabler.ac.operation.Constants",null,{EDIT_PAGE_LAYOUT:"com.ibm.mashups.enabler.ac.operation.editpagelayout",EDIT_PAGE_PROPERTIES:"com.ibm.mashups.enabler.ac.operation.editpageproperties",ASSIGN_PAGE_PERMISSIONS:"com.ibm.mashups.enabler.ac.operation.assignpagepermissions"});com.ibm.mashups.enabler.ac.operation.Constants=new com.ibm.mashups.enabler.ac.operation.Constants();}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.Operation_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.Operation_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.Operation_API");dojo.provide("com.ibm.mashups.enabler.ac.operation.Operation");dojo.declare("com.ibm.mashups.enabler.ac.operation.Operation",null,{isAllowed:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.Operation"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.Operation"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.Operation");}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel_API");dojo.provide("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel");dojo.declare("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel",[com.ibm.mashups.enabler.model.Model],{getOperation:function(_1753,_1754){},setOperation:function(_1755,_1756){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory_API"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory_API"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory_API");dojo.provide("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory");dojo.declare("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory",null,{getAllowedOperationsModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.operation.AllowedOperationsModelFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.operation.AllowedOperationsModelFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.operation.AllowedOperationsModelFactoryImpl");dojo.declare("com.ibm.mm.enabler.ac.operation.AllowedOperationsModelFactoryImpl",com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory,{constructor:function(){},getAllowedOperationsModel:function(){return com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory=new com.ibm.mm.enabler.ac.operation.AllowedOperationsModelFactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModelFactory");}if(!dojo._hasResource["com.ibm.mm.enabler.ac.operation.AbstractOperationImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.operation.AbstractOperationImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.operation.AbstractOperationImpl");dojo.declare("com.ibm.mm.enabler.ac.operation.AbstractOperationImpl",[com.ibm.mashups.enabler.ac.operation.Operation],{constructor:function(_1757){this.context=_1757;this.roleCheck=null;},isAllowed:function(){this.context=this.context||null;if(this.context===null){return false;}if(!this.context.contentNode){return false;}var _1758=com.ibm.mashups.enabler.ac.AccessFactory.getEffectiveAccess(this.context.contentNode);_1758=_1758||null;if(_1758!==null&&_1758.hasRole(this.roleCheck)){return true;}return false;}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.operation.EditPageLayoutOperationImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.operation.EditPageLayoutOperationImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.operation.EditPageLayoutOperationImpl");dojo.declare("com.ibm.mm.enabler.ac.operation.EditPageLayoutOperationImpl",[com.ibm.mm.enabler.ac.operation.AbstractOperationImpl],{constructor:function(_1759){this.context=_1759;this.roleCheck=com.ibm.mashups.enabler.ac.RoleType.EDITOR;}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.operation.EditPagePropertiesOperationImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.operation.EditPagePropertiesOperationImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.operation.EditPagePropertiesOperationImpl");dojo.declare("com.ibm.mm.enabler.ac.operation.EditPagePropertiesOperationImpl",[com.ibm.mm.enabler.ac.operation.AbstractOperationImpl],{constructor:function(_175a){this.context=_175a;this.roleCheck=com.ibm.mashups.enabler.ac.RoleType.EDITOR;}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.operation.AssignPagePermissionsOperationImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.operation.AssignPagePermissionsOperationImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.operation.AssignPagePermissionsOperationImpl");dojo.declare("com.ibm.mm.enabler.ac.operation.AssignPagePermissionsOperationImpl",[com.ibm.mm.enabler.ac.operation.AbstractOperationImpl],{constructor:function(_175b){this.context=_175b;this.roleCheck=com.ibm.mashups.enabler.ac.RoleType.MANAGER;}});}if(!dojo._hasResource["com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl");dojo.declare("com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl",com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.additionalOperations=[];},getInstance:function(){var _175c=com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl._instance;return _175c?_175c:(com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl._instance=new com.ibm.mm.enabler.ac.operation.AllowedOperationsModelImpl());},getOperation:function(_175d,_175e){return new com.ibm.mm.enabler.DeferredImpl(this,this._getOperation,{"operationName":_175d,"jsonContext":_175e});},_getOperation:function(dfr,sync,_175f){var _1760="_getOperation";var _1761=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1761){this.LOGGER.entering(_1760,arguments);}var _1762=_175f.operationName;var _1763=_175f.jsonContext;var _1764=null;if(_1762){switch(_1762){case com.ibm.mashups.enabler.ac.operation.Constants.EDIT_PAGE_LAYOUT:_1764=new com.ibm.mm.enabler.ac.operation.EditPageLayoutOperationImpl(_1763);break;case com.ibm.mashups.enabler.ac.operation.Constants.EDIT_PAGE_PROPERTIES:_1764=new com.ibm.mm.enabler.ac.operation.EditPagePropertiesOperationImpl(_1763);break;case com.ibm.mashups.enabler.ac.operation.Constants.ASSIGN_PAGE_PERMISSIONS:_1764=new com.ibm.mm.enabler.ac.operation.AssignPagePermissionsOperationImpl(_1763);break;default:var _1765=this.additionalOperations[_1762]||null;if(dojo.isFunction(_1765)){var _1766=function(_1767){_1764=_1767;dfr.finish(_1764,(_1764!==null)?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);};dojo.partial(_1765)(_1762,_1763,sync,_1766);if(_1761){this.LOGGER.exiting(_1760,[_1764]);}return _1764;}break;}}dfr.finish(_1764,(_1764!==null)?com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK:com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);if(_1761){this.LOGGER.exiting(_1760,[_1764]);}return _1764;},setOperation:function(_1768,_1769){if(!_1768){return false;}if(!_1769){return false;}this.additionalOperations[_1768]=_1769;return true;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel"]){dojo._hasResource["com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel"]=true;dojo.provide("com.ibm.mashups.enabler.ac.operation.AllowedOperationsModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplate_API"]){dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplate_API"]=true;dojo.provide("com.ibm.mashups.enabler.layouttemplate.LayoutTemplate_API");dojo.provide("com.ibm.mashups.enabler.layouttemplate.LayoutTemplate");dojo.declare("com.ibm.mashups.enabler.layouttemplate.LayoutTemplate",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableLocalized,com.ibm.mashups.enabler.ModifiableMetaData,com.ibm.mashups.enabler.TimeStamped],{getURL:function(){},getHeadURL:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.layouttemplate.LayoutTemplate"]){dojo._hasResource["com.ibm.mm.enabler.layouttemplate.LayoutTemplate"]=true;dojo.provide("com.ibm.mm.enabler.layouttemplate.LayoutTemplate");dojo.require("com.ibm.mashups.enabler.layouttemplate.LayoutTemplate");com.ibm.mm.enabler.layouttemplate.PropertiesFileFacade={serialize:function(_176a){var ret=["#\n"];ret.push("# ",(new Date()).toUTCString(),"\n");for(var obj in _176a){if(Object.prototype.hasOwnProperty.call(_176a,obj)){ret.push(obj,"=",_176a[obj],"\n");}}return ret.join("");},deserialize:function(_176b){var dfd=new dojo.Deferred();this._parse(_176b,dfd);return dfd;},_parse:function(_176c,_176d){var lines=_176c.split("\n");var l=lines.length;var _176e={};for(var i=0;i<l;i++){var line=lines[i];if(line.indexOf("#")!==0){var key;var value;var _176f=line.indexOf("=");if(_176f>0){key=line.substring(0,_176f);value=this._filter(line.substring(_176f+1));if(key!==""){_176e[key]=value;}}}}_176d.callback(_176e);},_filter:function(str){return this._processUnicodeCharacters(str);},_processUnicodeCharacters:function(str){var _1770=/\\u[0-9a-fA-F]{4}/g;var _1771=str.match(_1770);if(_1771){for(var i=0,l=_1771.length;i<l;i++){var _1772=_1771[i];var _1773=eval("'"+_1772+"'");str=str.replace(_1772,_1773);}}return str;}};dojo.declare("com.ibm.mm.enabler.layouttemplate.DeferredResolver",null,{setDelegate:function(d){this.deferred=d;},resolve:function(_1774,_1775){if(this.deferred){var cb=this.deferred.getFinishedCallback();var _1776=this.deferred.getFinishedCallbackParameters();if(cb){cb(_1774,_1775,_1776);}}}});com.ibm.mm.enabler.layouttemplate.DeferredManager={counter:0,extractCallbackInfo:function(_1777){var _1778;var _1779;if(_1777.getFinishedCallback){_1778=_1777.getFinishedCallback();}else{if(_1777._callback){_1778=_1777._callback;}}if(_1777.getFinishedCallbackParameters){_1779=_1777.getFinishedCallbackParameters();}else{if(_1777._parameters){_1779=_1777._parameters;}}return {callback:_1778,params:_1779};},combine:function(d1,d2){var cb1=this.extractCallbackInfo(d1);if(ibmConfig.isDebug){if(d1._uid===undefined){d1._uid=this.counter++;}if(d2._uid===undefined){d2._uid=this.counter++;}}var d=new com.ibm.mm.enabler.DeferredImpl(d,function(){d1.start();});var me=this;d1.setFinishedCallback(function(){if(cb1.callback){cb1.callback(arguments[0],arguments[1],cb1.params);}var cb2=me.extractCallbackInfo(d2);d2.setFinishedCallback(function(){if(cb2.callback){cb2.callback(arguments[0],arguments[1],cb2.params);}var cb3=me.extractCallbackInfo(d);if(cb3.callback){cb3.callback(arguments[0],arguments[1],cb3.params);}});d2.start();});if(ibmConfig.isDebug){d._first=d1;d._second=d2;d._uid=this.counter++;}return d;}};com.ibm.mm.enabler.layouttemplate.WebDAVInterface={init:function(_177a){this.remoteModel=_177a;this._commandFactory=com.ibm.mm.enabler.remote.WebDavCommandFactory;},getFileInfo:function(path){return this.remoteModel.find(path);},getFilename:function(file){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){r.resolve(file.getName(),200);});r.setDelegate(d);return d;},isDirectory:function(file){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){r.resolve(file.isDirectory(),200);});r.setDelegate(d);return d;},getDirectoryContentsURLs:function(file){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){r.resolve(file._getChildHrefs(),200);});r.setDelegate(d);return d;},getURL:function(file){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){r.resolve(file.getURL(),200);});r.setDelegate(d);return d;},getFileContents:function(path){var cmd=this._commandFactory.getDownloadCommand(path);var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){var dfd=cmd.execute();dfd.addCallback(function(_177b,_177c){r.resolve(_177b,_177c);});});r.setDelegate(d);return d;},createFile:function(path,_177d){var cmd=this._commandFactory.getCreateCommand(path,null,_177d);var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){var dfd=cmd.execute();dfd.addCallback(function(_177e,_177f){r.resolve(_177e);});});r.setDelegate(d);return d;},updateFile:function(path,_1780){var cmd=this._commandFactory.getUpdateCommand(path,null,_1780);var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){var dfd=cmd.execute();dfd.addCallback(function(_1781,_1782){r.resolve(_1781);});});r.setDelegate(d);return d;},createDirectory:function(path){var cmd=this._commandFactory.getMakeCollectionCommand(path);var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){var dfd=cmd.execute();dfd.addCallback(function(_1783,_1784){r.resolve(_1783);});});r.setDelegate(d);return d;},remove:function(path){var cmd=this._commandFactory.getDeleteCommand(path);var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d=new com.ibm.mm.enabler.DeferredImpl(window,function(){var dfd=cmd.execute();dfd.addCallback(function(_1785,_1786){r.resolve(_1785);});});r.setDelegate(d);return d;}};com.ibm.mm.enabler.layouttemplate.TemplateURLHelper={baseDirectory:ibmConfig&&ibmConfig.baseLayoutTemplatesDirectory?ibmConfig.baseLayoutTemplatesDirectory:"layout-templates/",getLocalizedFileURL:function(_1787,_1788){return this.baseDirectory+_1787+"/metadata/localized_"+_1788+".properties";},getMetaDataFileURL:function(_1789){return this.baseDirectory+_1789+"/metadata.properties";}};dojo.declare("com.ibm.mm.enabler.layouttemplate.WebDAVBackedObject",null,{constructor:function(_178a,rFile,wdInt,_178b,_178c,_178d){this.remoteModel=_178a;this.remoteFile=rFile;this.webDavInterface=wdInt;this.urlHelper=_178b;this.propertiesFileFacade=_178c;this.exists=_178d;this.webDavInterface.init(this.remoteModel);},setRemoteNls:function(_178e){this.remoteNlsFile=_178e;}});dojo.declare("com.ibm.mm.enabler.layouttemplate.WebDAVBackedModifiableLocalized",[com.ibm.mm.enabler.layouttemplate.WebDAVBackedObject,com.ibm.mashups.enabler.ModifiableLocalized],{constructor:function(){this._localBundles={};this._remoteBundles={};this._housekeeper={isClean:true,dirtyLocales:{},makeLocaleDirty:function(_178f){this.dirtyLocales[_178f]=true;this.isClean=false;},reset:function(){this.dirtyLocales={};this.isClean=true;}};},_getBundle:function(_1790){var wdi=this.webDavInterface;var tuh=this.urlHelper;var p=this.propertiesFileFacade;var me=this;var d;if(this.exists){d=wdi.getFileContents(tuh.getLocalizedFileURL(this.remoteFile.getName(),_1790));d.setFinishedCallback(function(_1791){var dfd=p.deserialize(_1791);dfd.addCallback(function(props){me._remoteBundles[_1790]=props;});});}else{var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();d=new com.ibm.mm.enabler.DeferredImpl(window,function(){r.resolve();});r.setDelegate(d);}return d;},_mergeRemoteAndLocalBundle:function(_1792){var _1793=this._remoteBundles[_1792];if(_1793===undefined){_1793={};}var _1794=this._localBundles[_1792];for(var obj in _1794){if(Object.prototype.hasOwnProperty.call(_1794,obj)){_1793[obj]=_1794[obj];}}return _1793;},getTitle:function(_1795){return this._deferredInvocation(_1795,"title");},getDescription:function(_1796){return this._deferredInvocation(_1796,"description");},_deferredInvocation:function(_1797,_1798){var _1799=this._getExistingLocalesAsMap();var _179a=_1799[_1797];var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var newD=new com.ibm.mm.enabler.DeferredImpl(this,function(){if(_179a){r.resolve(this._mergeRemoteAndLocalBundle(_1797)[_1798]);}else{r.resolve(undefined,404);}});if(this._remoteBundles[_1797]===undefined&&this.exists&&_179a){var d=this._getBundle(_1797);var d2=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d,newD);r.setDelegate(d2);return d2;}else{r.setDelegate(newD);return newD;}},getLocales:function(){if(this._locales===undefined){this._locales=[];if(this.exists){this._locales=this._readLocales();}}return this._locales;},_getExistingLocalesAsMap:function(){var obj={};if(this.exists){var ls=this._readLocales();var len=ls.length;for(var i=0;i<len;i++){obj[ls[i]]=true;}}return obj;},_readLocales:function(){if(!this.remoteNlsFile){return ["en"];}var _179b=this.remoteNlsFile._getChildHrefs();var l=_179b.length;var _179c=[];for(var i=1;i<l;i++){var child=_179b[i];var name=child.substring(child.lastIndexOf("/")+1);if(name.indexOf("localized_")===0){name=name.split(".")[0];_179c.push(name.substring(name.length-2));}}return _179c;},setTitle:function(_179d,_179e){var _179f=this._localBundles[_179d];if(_179f===undefined||_179f===null){this._localBundles[_179d]={};this.getLocales().push(_179d);}this._localBundles[_179d].title=_179e;this._housekeeper.makeLocaleDirty(_179d);},confirmSetTitle:function(_17a0,_17a1){return true;},removeTitle:function(_17a2){var _17a3=this._mergeRemoteAndLocalBundle(_17a2);if(!(_17a3===undefined||_17a3===null)){delete _17a3.title;this._housekeeper.makeLocaleDirty(_17a2);}},confirmRemoveTitle:function(_17a4){var _17a5=this._mergeRemoteAndLocalBundle(_17a4);return !(_17a5===undefined||_17a5===null);},removeTitles:function(){for(var _17a6 in this._locales){if(Object.prototype.hasOwnProperty.call(this._locales,_17a6)){delete this._bundles[_17a6].title;this._housekeeper.makeLocaleDirty(_17a6);}}},setDescription:function(_17a7,_17a8){var _17a9=this._mergeRemoteAndLocalBundle(_17a7);if(_17a9===undefined||_17a9===null){_17a9={};this._localBundles[_17a7]=_17a9;this.getLocales().push(_17a7);}_17a9.description=_17a8;this._housekeeper.makeLocaleDirty(_17a7);},confirmSetDescription:function(_17aa,_17ab){return true;},removeDescription:function(_17ac){var _17ad=this._bundles[_17ac];if(!(_17ad===undefined||_17ad===null)){delete _17ad.description;this._housekeeper.makeLocaleDirty(_17ac);}},confirmRemoveDescription:function(_17ae){var _17af=this._remoteBundles[_17ae];return !(_17af===undefined||_17af===null);},removeDescriptions:function(){for(var _17b0 in this._bundles){if(Object.prototype.hasOwnProperty.call(this._bundles,_17b0)){delete this._bundles[_17b0].description;this._housekeeper.makeLocaleDirty(_17b0);}}},_setLocalizedData:function(){var wdi=this.webDavInterface;var tuh=this.urlHelper;var p=this.propertiesFileFacade;var _17b1=this._housekeeper.dirtyLocales;var _17b2;var d;for(var l in _17b1){if(Object.prototype.hasOwnProperty.call(_17b1,l)){var path=tuh.getLocalizedFileURL(this.remoteFile.getName(),l);if(this._getExistingLocalesAsMap()[l]===true){if(this._remoteBundles[l]===undefined){d=this._getBundle(l);}if(d){d=this._newUpdateLocaleFn(d,l,wdi,path,p);}else{d=wdi.updateFile(path,p.serialize(this._mergeRemoteAndLocalBundle(l)));}}else{d=wdi.createFile(path,p.serialize(this._mergeRemoteAndLocalBundle(l)));}if(_17b2===undefined){_17b2=d;}else{_17b2=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(_17b2,d);}}}var _17b3=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var _17b4=new com.ibm.mm.enabler.DeferredImpl(this,function(){this._housekeeper.reset();_17b3.resolve();});_17b3.setDelegate(_17b4);_17b2=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(_17b2,_17b4);return _17b2;},_newUpdateLocaleFn:function(_17b5,_17b6,wdi,path,p){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var newD=new com.ibm.mm.enabler.DeferredImpl(this,function(){var d2=wdi.updateFile(path,p.serialize(this._mergeRemoteAndLocalBundle(_17b6)));var me=this;d2.setFinishedCallback(function(){me._remoteBundles[_17b6]=me._mergeRemoteAndLocalBundle(_17b6);me._localBundles[_17b6]={};r.resolve();});d2.start();});var d3=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(_17b5,newD);r.setDelegate(d3);return d3;},_commitLocalizedChanges:function(){var d;if(this._isLocalizedDataDirty()){d=this._setLocalizedData();}return d;},_isLocalizedDataDirty:function(){return !this._housekeeper.isClean;},_revertLocalizedChanges:function(){this._housekeeper.reset();this._localBundles={};}});dojo.declare("com.ibm.mm.enabler.layouttemplate.WebDAVBackedModifiableMetaData",[com.ibm.mm.enabler.layouttemplate.WebDAVBackedObject,com.ibm.mashups.enabler.ModifiableMetaData],{constructor:function(){this._remoteMd=undefined;this._localMd={};this._mdNames=undefined;this._isMdDirty=false;},getMetaData:function(name){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var newD=new com.ibm.mm.enabler.DeferredImpl(this,function(){var md=this._mergeRWMd();var _17b7=md[name];r.resolve(_17b7);});if(this._remoteMd===undefined&&this.exists){var d=this._loadMetaData();var d2=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d,newD);r.setDelegate(d2);return d2;}else{r.setDelegate(newD);return newD;}},_mergeRWMd:function(){var md=this._remoteMd;if(typeof md=="undefined"){md={};}for(var obj in this._localMd){if(Object.prototype.hasOwnProperty.call(this._localMd,obj)){md[obj]=this._localMd[obj];}}return md;},getMetaDataNames:function(){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var newD=new com.ibm.mm.enabler.DeferredImpl(this,function(){var n=[];var md=this._mergeRWMd();for(var obj in md){if(Object.prototype.hasOwnProperty.call(md,obj)){n.push(obj);}}this._mdNames=n;r.resolve(this._mdNames);});var d2=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(this.getMetaData(),newD);r.setDelegate(d2);return d2;},_loadMetaData:function(){var wdi=this.webDavInterface;var tuh=this.urlHelper;var p=this.propertiesFileFacade;var d=wdi.getFileContents(tuh.getMetaDataFileURL(this.remoteFile.getName()));var me=this;d.setFinishedCallback(function(_17b8){var dfd=p.deserialize(_17b8);dfd.addCallback(function(props){me._remoteMd=props;});});return d;},setMetaData:function(name,value){this._localMd[name]=value;this._mdNames=undefined;this._isMdDirty=true;},confirmSetMetaData:function(name,value){return true;},removeMetaData:function(name){var dirty=false;var _17b9=null;if(this._localMd[name]!==undefined){_17b9=this._localMd[name];delete this._localMd[name];dirty=true;}if(this._remoteMd[name]!==undefined){_17b9=this._remoteMd[name];delete this._remoteMd[name];dirty=true;}if(dirty){this._mdNames=undefined;this._isMdDirty=true;}return _17b9;},confirmRemoveMetaData:function(name){return true;},_updateMetaData:function(){var wdi=this.webDavInterface;var tuh=this.urlHelper;var p=this.propertiesFileFacade;var _17ba;if(this._remoteMd===undefined&&this.exists){_17ba=this._loadMetaData();}var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var newD=new com.ibm.mm.enabler.DeferredImpl(this,function(){var d=wdi.updateFile(tuh.getMetaDataFileURL(this.remoteFile.getName()),p.serialize(this._mergeRWMd()));d.setFinishedCallback(function(){r.resolve();});d.start();});if(_17ba!==undefined){_17ba=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(_17ba,newD);}else{_17ba=newD;}r.setDelegate(_17ba);var _17bb=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var _17bc=new com.ibm.mm.enabler.DeferredImpl(this,function(){this._isMdDirty=false;_17bb.resolve();});_17bb.setDelegate(_17bc);_17ba=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(_17ba,_17bc);return _17ba;},_commitMetaDataChanges:function(){var d;if(this._isMdDirty){d=this._updateMetaData();}return d;},_isMetaDataDirty:function(){return this._isMdDirty;},_revertMetaDataChanges:function(){this._localMd={};this._isMdDirty=false;}});dojo.declare("com.ibm.mm.enabler.layouttemplate.LayoutTemplate",[com.ibm.mm.enabler.layouttemplate.WebDAVBackedModifiableMetaData,com.ibm.mm.enabler.layouttemplate.WebDAVBackedModifiableLocalized,com.ibm.mashups.enabler.layouttemplate.LayoutTemplate],{LAYOUT_HTML:"layout.html",HEAD_HTML:"head.html",getURL:function(){var _17bd=this.remoteFile.getURL();if(_17bd&&_17bd[_17bd.length-1]!=="/"){_17bd+="/";}return _17bd+this.LAYOUT_HTML;},getHeadURL:function(){return this.remoteFile.getURL()+this.HEAD_HTML;},getID:function(){return this.remoteFile.getID();},getCreated:function(){if(this.remoteFile&&!this.createdTime){var resp=new com.ibm.mm.enabler.remote.WebDavResponseImpl();var _17be=resp.getCreationDate(this.remoteFile._properties,this.getURL());if(_17be){var _17bf=/(\d\d\d\d)-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d*)Z/;var match=_17be.match(_17bf);if(match){var year=parseInt(match[1],10);var month=parseInt(match[2],10);var day=parseInt(match[3],10);var hour=parseInt(match[4],10);var _17c0=parseInt(match[5],10);var _17c1=parseInt(match[6],10);var _17c2=0;if(match.length>7){_17c2=parseInt(match[7].substring(1),10);}_17be=Date.UTC(year,month-1,day,hour,_17c0,_17c1,_17c2);}this.createdTime=new Date(_17be);}}return this.createdTime;},getLastModified:function(){if(this.remoteFile&&!this.lastModifiedTime){var resp=new com.ibm.mm.enabler.remote.WebDavResponseImpl();var _17c3=resp.getLastModified(this.remoteFile._properties,this.getURL());this.lastModifiedTime=new Date(_17c3);}return this.lastModifiedTime;},_isDirty:function(){return this._isMetaDataDirty()||this._isLocalizedDataDirty();},_commit:function(){var d1=this._commitLocalizedChanges();var d2=this._commitMetaDataChanges();var _17c4;if(d1&&d2){_17c4=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d1,d2);}else{if(d1||d2){_17c4=d1?d1:d2;}}return _17c4;},_create:function(){var wdi=this.webDavInterface;var urls=this.urlHelper;var d1=wdi.createDirectory(urls.baseDirectory+this.remoteFile.getName());var d2=this._commit();var _17c5=d1;if(d2!==undefined){_17c5=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d1,d2);}return _17c5;},_delete:function(){var wdi=this.webDavInterface;var urls=this.urlHelper;var d1=wdi.remove(urls.baseDirectory+this.remoteFile.getName());return d1;},_revert:function(){this._revertLocalizedChanges();this._revertMetaDataChanges();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplate"]){dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplate"]=true;dojo.provide("com.ibm.mashups.enabler.layouttemplate.LayoutTemplate");}if(!dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel_API");dojo.provide("com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel");dojo.declare("com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel",[com.ibm.mashups.enabler.ListModelController,com.ibm.mashups.enabler.ResourceLocator,com.ibm.mashups.enabler.Commitable],{create:function(_17c6){}});}if(!dojo._hasResource["com.ibm.mm.enabler.layouttemplate.LayoutTemplateModel"]){dojo._hasResource["com.ibm.mm.enabler.layouttemplate.LayoutTemplateModel"]=true;dojo.provide("com.ibm.mm.enabler.layouttemplate.LayoutTemplateModel");dojo.require("com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel");dojo.require("com.ibm.mm.enabler.layouttemplate.LayoutTemplate");dojo.declare("com.ibm.mm.enabler.layouttemplate.DeferredIteratorImpl",com.ibm.mashups.enabler.DeferredIterator,{constructor:function(_17c7,_17c8,_17c9){var me=this;var _17ca=com.ibm.mm.enabler.layouttemplate.TemplateURLHelper.baseDirectory;_17c7.setFinishedCallback(function(_17cb){var hrefs=_17cb._getChildHrefs();var l=hrefs.length;for(var i=1;i<l;i++){var _17cc=hrefs[i].indexOf(_17ca);if(_17cc>=0){hrefs[i]=hrefs[i].substring(_17cc);}}me._hrefs=hrefs;});this._deferred=_17c7;this._ltModel=_17c8;this._remoteModel=_17c9;this._position=1;this._hrefs=undefined;},start:function(sync){if(sync){console.error("Layout template iterator does not support synchronous iteration currently.");}if(this._hrefs===undefined){this._deferred.start();}},setForEachCallback:function(_17cd,_17ce){console.warn("setForEachCallback is not currently enabled in the Remote iterator! This callback will never get called!");},setFinishedCallback:function(_17cf,_17d0){var d=new com.ibm.mm.enabler.DeferredImpl(this,function(){_17cf(_17d0);});this._deferred=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(this._deferred,d);},hasNext:function(){if(this._hrefs===undefined){console.error("Iterator has not been loaded yet. Please call start() and call this method in or after the setFinishedCallback() callback is called.");}else{return this._position<this._hrefs.length;}},next:function(){var rv;var me=this;var hrefs=this._hrefs;var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var next=hrefs===undefined?undefined:this._hrefs[this._position++];var d2=new com.ibm.mm.enabler.DeferredImpl(this,function(){var _17d1=next?next:me._hrefs[me._position++];if(_17d1){var _17d2=me._ltModel.find(_17d1);_17d2.setFinishedCallback(function(_17d3){if(_17d3){r.resolve(_17d3);}else{me.next();}});_17d2.start();}else{r.resolve(undefined);}});r.setDelegate(d2);rv=this._hrefs===undefined?com.ibm.mm.enabler.layouttemplate.DeferredManager(this._deferred,d2):d2;return rv;},size:function(){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var size=this._hrefs.length;var d=new com.ibm.mm.enabler.DeferredImpl(this,function(){r.resolve(size-1);});r.setDelegate(d);return d;},setCursorPosition:function(_17d4){this._position=_17d4;},getCursorPosition:function(){return this._position;}});dojo.declare("com.ibm.mm.enabler.layouttemplate.LayoutTemplateModel",com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel,{constructor:function(){this.remoteModel=com.ibm.mashups.enabler.model.Factory.getRemoteModel();this._localCache={};this._baseLayoutLocation=undefined;},iterator:function(){var d;if(this._baseLayoutLocation===undefined){var _17d5=com.ibm.mm.enabler.layouttemplate.TemplateURLHelper.baseDirectory;d=this.remoteModel.find(_17d5);var me=this;d.setFinishedCallback(function(_17d6){me._baseLayoutLocation=_17d6;});}var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var d2=new com.ibm.mm.enabler.DeferredImpl(this,function(){r.resolve(this._baseLayoutLocation);});r.setDelegate(d2);var _17d7;if(d){_17d7=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d,d2);}else{_17d7=d2;}return new com.ibm.mm.enabler.layouttemplate.DeferredIteratorImpl(_17d7,this,this.remoteModel);},find:function(id){return this._deferredFind(id);},isDirty:function(){var _17d8=false;var c=this._localCache;for(var node in c){if(Object.prototype.hasOwnProperty.call(c,node)&&c[node]._isDirty){_17d8=_17d8||c[node]._isDirty();}}return _17d8;},commit:function(){var c=this._localCache;var _17d9;for(var node in c){if(Object.prototype.hasOwnProperty.call(c,node)&&c[node]._commit&&c[node]._isDirty&&c[node]._isDirty()){var d=c[node]._commit();if(d){if(!_17d9){_17d9=d;}else{_17d9=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(_17d9,d);}}}}return _17d9;},_deferredFind:function(id){var r=new com.ibm.mm.enabler.layouttemplate.DeferredResolver();var newD=new com.ibm.mm.enabler.DeferredImpl(this,function(item){r.resolve(this._localCache[id]);});if(this._localCache[id]===undefined){var me=this;var d=this.remoteModel.find(id);d.setFinishedCallback(function(item){var n=null;if(item.isDirectory()){n=new com.ibm.mm.enabler.layouttemplate.LayoutTemplate(me.remoteModel,item,com.ibm.mm.enabler.layouttemplate.WebDAVInterface,com.ibm.mm.enabler.layouttemplate.TemplateURLHelper,com.ibm.mm.enabler.layouttemplate.PropertiesFileFacade,true);}me._localCache[id]=n;});var dNLS=this.remoteModel.find(id+"metadata/");dNLS.setFinishedCallback(function(_17da){me._localCache[id].setRemoteNls(_17da);});var d2=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d,dNLS);var d3=com.ibm.mm.enabler.layouttemplate.DeferredManager.combine(d2,newD);r.setDelegate(d3);return d3;}else{r.setDelegate(newD);return newD;}},create:function(_17db){var _17dc=new com.ibm.mm.enabler.remote.RemoteFileImpl({name:_17db.name,isDirectory:true});var n=new com.ibm.mm.enabler.layouttemplate.LayoutTemplate(this.remoteModel,_17dc,com.ibm.mm.enabler.layouttemplate.WebDAVInterface,com.ibm.mm.enabler.layouttemplate.TemplateURLHelper,com.ibm.mm.enabler.layouttemplate.PropertiesFileFacade,false);return n;},confirmCreate:function(){return true;},insert:function(_17dd){var d=_17dd._create();d.start();},confirmInsert:function(){return true;},remove:function(_17de){var d=_17de._delete();d.start();},confirmRemove:function(){return true;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel"]){dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel"]=true;dojo.provide("com.ibm.mashups.enabler.layouttemplate.LayoutTemplateModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.remote.RemoteFile_API"]){dojo._hasResource["com.ibm.mashups.enabler.remote.RemoteFile_API"]=true;dojo.provide("com.ibm.mashups.enabler.remote.RemoteFile_API");dojo.provide("com.ibm.mashups.enabler.remote.RemoteFile");dojo.declare("com.ibm.mashups.enabler.remote.RemoteFile",[com.ibm.mashups.enabler.MetaData,com.ibm.mashups.enabler.Identifiable],{getName:function(){},isDirectory:function(){},getUrl:function(){},getURL:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.WebDavUrlFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.WebDavUrlFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.WebDavUrlFactoryImpl");dojo.declare("com.ibm.mm.enabler.remote.WebDavUrlFactoryImpl",com.ibm.mm.enabler.ServiceDocConsumer,{_initServiceDoc:function(){var _17df=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData([com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WEBDAV,com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_FILESTORE]);if(_17df){this._fullUrl=_17df.url;var idx=this._fullUrl.indexOf("//");var _17e0=this._fullUrl.substring(idx+2);var idx2=_17e0.indexOf("/");var _17e1=idx+idx2+2;this._domainUrl=this._fullUrl.substring(0,_17e1);this._context=this._fullUrl.substring(_17e1);}this.inherited("_initServiceDoc",arguments);},createUrl:function(path){this._initServiceDoc();var uri=null;if(!path){uri=this._fullUrl;}else{if(path==this._fullUrl){uri=path+"/";}else{if(path.indexOf(this._fullUrl)===0){uri=path;}else{if(path.indexOf(this._context)===0){uri=this._domainUrl+path;}else{uri=this._fullUrl+path;}}}}return uri;},getUserHome:function(){var _17e2=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData([com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_WEBDAV,com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_USER]);return _17e2.url;}});com.ibm.mm.enabler.remote.WebDavUrlFactory=new com.ibm.mm.enabler.remote.WebDavUrlFactoryImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.remote.WebDavCommandImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.WebDavCommandImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.WebDavCommandImpl");dojo.declare("com.ibm.mm.enabler.remote.WebDavCommandImpl",null,{statics:{timeout:1000*60*3},constructor:function(_17e3,path,form,data,_17e4,_17e5){this._action=_17e3;if(dojo.isIE){this._path=encodeURI(path);}else{this._path=path;}this._handleAs=_17e5;this._form=form;this._data=data;this._headers=_17e4;},getURI:function(){var uri=com.ibm.mm.enabler.remote.WebDavUrlFactory.createUrl(this._path);return uri;},execute:function(sync){var _17e6={url:this.getURI(),sync:sync||false,handleAs:this._handleAs,timeout:this.statics.timeout,preventCache:dojo.isIE<7};var _17e7=false;if(this._data){_17e6.postData=this._data;_17e7=true;}if(this._headers){_17e6.headers=this._headers;}if(this._form){_17e6.form=this._form;_17e6.method="POST";if(_17e6.url.indexOf("?")==-1){_17e6.url=_17e6.url+"?mime-type=text/html";}else{_17e6.url=_17e6.url+"&mime-type=text/html";}return dojo.io.iframe.send(_17e6);}else{return dojo.xhr(this._action,_17e6,_17e7);}}});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.WebDavResponseImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.WebDavResponseImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.WebDavResponseImpl");dojo.declare("com.ibm.mm.enabler.remote.WebDavResponseImpl",null,{namespace:{"D":"DAV:","a":"DAV:","dav":"DAV:"},paths:{collection:"//D:multistatus/D:response/D:propstat/D:prop/D:resourcetype/D:collection",href:"//D:multistatus/D:response/D:href",lastmodified:"//D:multistatus/D:response[D:href='${path}']/D:propstat/D:prop/D:getlastmodified",creationdate:"//D:multistatus/D:response[D:href='${path}']/D:propstat/D:prop/D:creationdate"},constructor:function(){},isCollection:function(data){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.paths.collection,data,this.namespace);var _17e8=(nodes&&nodes.length>0);return _17e8;},getHrefs:function(data){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(this.paths.href,data,this.namespace);return this.convertNodesToStrings(nodes);},getID:function(data,fn){if(!data){return null;}var nodes=this.getHrefs(data);return nodes&&nodes.length>0?nodes[0]:null;},getLastModified:function(data,_17e9){var expr=this.paths.lastmodified.replace(/\$\{path\}/,_17e9);var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.namespace);var arr=this.convertNodesToStrings(nodes);return arr&&arr.length>0?arr[0]:null;},getCreationDate:function(data,_17ea){var expr=this.paths.creationdate.replace(/\$\{path\}/,_17ea);var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.namespace);var arr=this.convertNodesToStrings(nodes);return arr&&arr.length>0?arr[0]:null;},convertNodesToStrings:function(nodes){if(nodes){var _17eb=new Array(nodes.length);for(var i=0;i<nodes.length;i++){var s=dojox.xml.parser.textContent(nodes[i]);_17eb[i]=decodeURI(s);}return _17eb;}else{return null;}}});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.WebDavCommandFactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.WebDavCommandFactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.WebDavCommandFactoryImpl");dojo.declare("com.ibm.mm.enabler.remote.WebDavCommandFactoryImpl",null,{constructor:function(){},defaultProperties:{"resourcetype":true},defaultPropfindDataString:"<?xml version=\"1.0\" encoding=\"utf-8\" ?><D:propfind xmlns:D=\"DAV:\"><D:prop><D:resourcetype/></D:prop></D:propfind>",propfindParameterizedDataString:"<?xml version=\"1.0\" encoding=\"utf-8\" ?><D:propfind xmlns:D=\"DAV:\"><D:prop ${xmlns}>${props}</D:prop></D:propfind>",webDAVNamespaceAlias:"D",requiredWebDAVProperties:{"resourcetype":true},getDownloadCommand:function(path){return new com.ibm.mm.enabler.remote.WebDavCommandImpl("GET",path,null,null,null,"text");},getCreateCommand:function(path,node,_17ec){var _17ed=null;if((!node)&&(_17ec)){_17ed={"content-type":"text/html;charset=utf-8"};}return new com.ibm.mm.enabler.remote.WebDavCommandImpl("POST",path,node,_17ec,_17ed,"text");},getCopyCommand:function(path,dest){var _17ee={"destination":encodeURI(dest)};return new com.ibm.mm.enabler.remote.WebDavCommandImpl("COPY",path,null,null,_17ee,"text");},getMoveCommand:function(path,dest){var _17ef={"destination":encodeURI(dest),"overwrite":false};return new com.ibm.mm.enabler.remote.WebDavCommandImpl("MOVE",path,null,null,_17ef,"text");},getUpdateCommand:function(path,node,_17f0){return new com.ibm.mm.enabler.remote.WebDavCommandImpl("PUT",path,node,_17f0,null,"text");},getDeleteCommand:function(path){return new com.ibm.mm.enabler.remote.WebDavCommandImpl("DELETE",path,null,null,null,"text");},getMakeCollectionCommand:function(path){return new com.ibm.mm.enabler.remote.WebDavCommandImpl("MKCOL",path,null,null,null,"xml");},getFindPropertiesCommand:function(path,props){var data=this.defaultPropfindDataString;if(props){data=this.propfindParameterizedDataString;props=dojo.mixin(props,this.defaultProperties);var _17f1="";var _17f2="";var _17f3=["A","B","C","E","F","G","H","I"];var _17f4=0;for(var prop in props){if(Object.prototype.hasOwnProperty.call(props,prop)){var alias=this.webDAVNamespaceAlias;var _17f5="";var _17f6=prop.indexOf("#");if(_17f6>=0){_17f5=prop.substring(0,_17f6);prop=prop.substring(_17f6+1);alias=_17f3[_17f4++];_17f2+=alias+":"+_17f5+" ";}_17f1+="<"+alias+":"+prop+"/>";}}data=data.replace(/\$\{props\}/,_17f1);data=data.replace(/\$\{xmlns\}/,_17f2);}var _17f7={"depth":"1","content-type":"application/xml;charset=utf-8"};return new com.ibm.mm.enabler.remote.WebDavCommandImpl("PROPFIND",path,null,data,_17f7,"xml");}});com.ibm.mm.enabler.remote.WebDavCommandFactory=new com.ibm.mm.enabler.remote.WebDavCommandFactoryImpl();}if(!dojo._hasResource["com.ibm.mm.enabler.remote.WebDavDeferredImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.WebDavDeferredImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.WebDavDeferredImpl");dojo.declare("com.ibm.mm.enabler.remote.WebDavDeferredImpl",com.ibm.mashups.enabler.Deferred,{constructor:function(_17f8,_17f9){this._context=_17f8;this._startfn=_17f9;},setFinishedCallback:function(_17fa,_17fb){this._callback=_17fa;this._parameters=_17fb;},start:function(sync){if((this._context)&&(this._startfn)){dojo.hitch(this._context,this._startfn)(sync);}return null;},doCallback:function(_17fc,_17fd){if(this._callback){this._callback(_17fc,_17fd,this._parameters);}}});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.RemoteFileImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.RemoteFileImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.RemoteFileImpl");dojo.declare("com.ibm.mm.enabler.remote.RemoteFileImpl",[com.ibm.mashups.enabler.remote.RemoteFile],{constructor:function(_17fe){if(_17fe&&_17fe.name){this._name=_17fe.name;}else{this._name=null;}this._children=null;this._isDirectory=_17fe.isDirectory;this._id=null;this._properties=null;this._context=_17fe;this._deferred=null;},init:function(){this._deferred=new com.ibm.mm.enabler.remote.WebDavDeferredImpl(this,this._init);return this._deferred;},_init:function(sync){if(this._context&&this._context.isCreate){if((this._context.isDirectory)&&(this._context.form)){this._uploadDirectory(this._name,this._context.form);}else{if(this._context.isDirectory){this._createDirectory(this._name,sync);}else{this._createFile(this._name,this._context.form,this._context.content,sync);}}}else{if(this._context&&this._context.isUpdate){this._updateFile(this._name,this._context.form,this._context.content);}else{this._load(this._name);}}},_load:function(name){var _17ff=com.ibm.mm.enabler.remote.WebDavCommandFactory;var _1800=this._context&&this._context.props?this._context.props:null;var _1801=_17ff.getFindPropertiesCommand(name,_1800);var d=_1801.execute();d.addCallback(dojo.hitch(this,this._handleLoad));d.addCallback(dojo.hitch(this,this._handleSuccess));d.addErrback(dojo.hitch(this,this._handleError));},_createFile:function(name,form,_1802,sync){var _1803=com.ibm.mm.enabler.remote.WebDavCommandFactory;var _1804=_1803.getCreateCommand(name,form,_1802);var d=_1804.execute(sync);d.addCallback(dojo.hitch(this,this._handleSuccess));d.addErrback(dojo.hitch(this,this._handleError));},_updateFile:function(name,form,_1805){var _1806=com.ibm.mm.enabler.remote.WebDavCommandFactory;var _1807=_1806.getUpdateCommand(name,form,_1805);var d=_1807.execute();d.addCallback(dojo.hitch(this,this._handleSuccess));d.addErrback(dojo.hitch(this,this._handleError));},_createDirectory:function(name,sync){var _1808=com.ibm.mm.enabler.remote.WebDavCommandFactory;var _1809=_1808.getMakeCollectionCommand(name);var d=_1809.execute(sync);d.addCallback(dojo.hitch(this,this._handleSuccess));d.addErrback(dojo.hitch(this,this._handleError));},_uploadDirectory:function(name,form){var _180a=com.ibm.mm.enabler.remote.WebDavCommandFactory;var _180b=_180a.getUpdateCommand(name,form,null);var d=_180b.execute();d.addCallback(dojo.hitch(this,this._handleSuccess));d.addErrback(dojo.hitch(this,this._handleError));},_handleLoad:function(_180c){this._properties=_180c;},_handleSuccess:function(data){this._deferred.doCallback(this,200);},_handleError:function(error){this._deferred.doCallback(this,500);},_delete:function(){var _180d=com.ibm.mm.enabler.remote.WebDavCommandFactory;var _180e=_180d.getDeleteCommand(this.getID());var d=_180e.execute();d.addCallback(dojo.hitch(this,this._handleSuccess));d.addErrback(dojo.hitch(this,this._handleError));return this._deferred;},getName:function(){var ret=this._name;if("/"==this._name){}else{var parts=this._name.split("/");var c=this._name.charAt(this._name.length-1);if(c=="/"){ret=parts[parts.length-2];}else{ret=parts[parts.length-1];}}return ret;},isDirectory:function(){if(!this._isDirectory){var resp=new com.ibm.mm.enabler.remote.WebDavResponseImpl();this._isDirectory=resp.isCollection(this._properties);}return this._isDirectory;},_getChildHrefs:function(){if(!this._children){this._children=[];if(this.isDirectory()){var resp=new com.ibm.mm.enabler.remote.WebDavResponseImpl();var nodes=resp.getHrefs(this._properties);var i=0;for(var node in nodes){if(Object.prototype.hasOwnProperty.call(nodes,node)){if(i>0){this._children[i]=nodes[node];}i++;}}}}return this._children;},getID:function(){if(!this._id){var resp=new com.ibm.mm.enabler.remote.WebDavResponseImpl();var id=resp.getID(this._properties);if(id){this._id=id;}else{this._id=com.ibm.mm.enabler.remote.WebDavUrlFactory.createUrl(this._name);}}return this._id;},getUrl:function(){return this.getURL();},getURL:function(){return this.getID();}});}if(!dojo._hasResource["com.ibm.mashups.enabler.remote.RemoteFile"]){dojo._hasResource["com.ibm.mashups.enabler.remote.RemoteFile"]=true;dojo.provide("com.ibm.mashups.enabler.remote.RemoteFile");}if(!dojo._hasResource["com.ibm.mashups.enabler.remote.RemoteLocator"]){dojo._hasResource["com.ibm.mashups.enabler.remote.RemoteLocator"]=true;dojo.provide("com.ibm.mashups.enabler.remote.RemoteLocator");dojo.declare("com.ibm.mashups.enabler.remote.RemoteLocator",null,{getUserRoot:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.RemoteModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.RemoteModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.RemoteModel_API");dojo.provide("com.ibm.mashups.enabler.model.RemoteModel");dojo.declare("com.ibm.mashups.enabler.model.RemoteModel",[com.ibm.mashups.enabler.TreeModel,com.ibm.mashups.enabler.remote.RemoteLocator],{});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.WidgetHelper"]){dojo._hasResource["com.ibm.mm.enabler.remote.WidgetHelper"]=true;dojo.provide("com.ibm.mm.enabler.remote.WidgetHelper");dojo.declare("com.ibm.mm.enabler.remote.WidgetHelper",null,{constructor:function(model){this._model=model;},getDirectoryAsZipUrl:function(dir){return dir.getID()+"?mime-type=application/zip";},addNewTemplate:function(name,form){if(name&&name.length>0){var _180f=name.charAt(name.length-1);if(_180f!="/"){name=name+"/";}}var d=new com.ibm.mm.enabler.DeferredImpl(this,this._addNewTemplate,{"name":name,"form":form});return d;},_addNewTemplate:function(_1810,sync,_1811){_1811.deferred=_1810;var d=this.getTemplateDir();d.setFinishedCallback(function(_1812,_1813,_1814){var _1815={};_1815.name=_1812.getUrl()+_1814.name+"?mode=replace";_1815.isDirectory=true;_1815.isCreate=true;_1815.form=_1814.form;var file=new com.ibm.mm.enabler.remote.RemoteFileImpl(_1815);var d2=file.init();d2.setFinishedCallback(function(_1816,_1817,_1818){var _1819=_1818.deferred;if(_1819){_1819.finish(_1816,_1817);}},_1814);d2.start();},_1811);d.start();},uploadZip:function(path,name,form){if(name&&name.length>0){var _181a=name.charAt(name.length-1);if(_181a!="/"){name=name+"/";}}var d=new com.ibm.mm.enabler.DeferredImpl(this,this._uploadZip,{"path":path,"name":name,"form":form});return d;},_uploadZip:function(_181b,sync,_181c){_181c.deferred=_181b;var d=this.getZipDir(_181c.path);d.setFinishedCallback(function(_181d,_181e,_181f){var _1820={};_1820.name=_181d.getUrl()+_181f.name+"?mode=replace";_1820.isDirectory=true;_1820.isCreate=true;_1820.form=_181f.form;var file=new com.ibm.mm.enabler.remote.RemoteFileImpl(_1820);var d2=file.init();d2.setFinishedCallback(function(_1821,_1822,_1823){var _1824=_1823.deferred;if(_1824){_1824.finish(_1821,_1822);}},_181f);d2.start();},_181c);d.start();},getZipDir:function(path){return this._model.find(path);},getTemplateDir:function(){return this._model.find("/public/templates/");},getProjectDir:function(){var _1825=com.ibm.mm.enabler.remote.WebDavUrlFactory.getUserHome();return this._model.find(_1825+"/public/projects/");},createFile:function(_1826){_1826.isDirectory=false;_1826.isCreate=true;var file=new com.ibm.mm.enabler.remote.RemoteFileImpl(_1826);return file.init();},createFolder:function(path){var _1827={};_1827.isDirectory=true;_1827.isCreate=true;_1827.name=path;var file=new com.ibm.mm.enabler.remote.RemoteFileImpl(_1827);return file.init();},updateFile:function(file,_1828){_1828.isDirectory=false;_1828.isUpdate=true;var _1829=new com.ibm.mm.enabler.remote.RemoteFileImpl(_1828);return _1829.init();},copy:function(file,_182a){var _182b=com.ibm.mm.enabler.remote.WebDavCommandFactory.getCopyCommand(file.getUrl(),_182a);var ed=new com.ibm.mm.enabler.remote.WebDavDeferredImpl();var d=_182b.execute();d.addCallback(dojo.partial(this._copy,ed));return ed;},_copy:function(ed,_182c){ed.doCallback(_182c,200);},move:function(file,_182d){var _182e=com.ibm.mm.enabler.remote.WebDavCommandFactory.getMoveCommand(file.getUrl(),_182d);var ed=new com.ibm.mm.enabler.remote.WebDavDeferredImpl();var d=_182e.execute();d.addCallback(dojo.partial(this._move,ed));return ed;},_move:function(ed,_182f){ed.doCallback(_182f,200);},deleteFile:function(file){return file._delete();}});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.RemoteIteratorImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.RemoteIteratorImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.RemoteIteratorImpl");dojo.declare("com.ibm.mm.enabler.remote.RemoteIteratorImpl",com.ibm.mm.enabler.DeferredIteratorImpl,{constructor:function(model,hrefs){this._model=model;this._hrefs=hrefs;this._position=1;},start:function(sync){},hasNext:function(sync){return this._position<this._hrefs.length;},next:function(sync){var href=this._hrefs[this._position];var next=null;if(href){this._position++;next=this._model.find(href);}return next;},setCursorPosition:function(_1830){this._position=_1830;},getCursorPosition:function(){return (this._position-1);},size:function(){return this._hrefs.length;}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.RemoteModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.RemoteModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.RemoteModelImpl");dojo.declare("com.ibm.mm.enabler.model.RemoteModelImpl",[com.ibm.mashups.enabler.model.RemoteModel,com.ibm.mm.enabler.model.ModelImpl],{constructor:function(){this._files={};},getRoot:function(){return this.find("/");},find:function(path){var file=new com.ibm.mm.enabler.remote.RemoteFileImpl({name:path,props:{"getlastmodified":true,"resourcetype":true,"creationdate":true}});var d=file.init();return d;},getUserRoot:function(){var _1831=com.ibm.mm.enabler.remote.WebDavUrlFactory.getUserHome();return this.find(_1831);},hasChildren:function(file){var kids=file._getChildren();if(kids){for(var child in kids){if(Object.prototype.hasOwnProperty.call(kids,child)){return true;}}}return false;},getParent:function(file){var id=file.getID();var index=id.lastIndexOf("/");var _1832=id.substring(0,index);if(file.isDirectory()){_1832=_1832+"/../";}return this.find(_1832);},getChildren:function(file){return new com.ibm.mm.enabler.remote.RemoteIteratorImpl(this,file._getChildHrefs());}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.RemoteModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.RemoteModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.RemoteModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.remote.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.remote.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.remote.Factory_API");dojo.provide("com.ibm.mashups.enabler.remote.Factory");dojo.declare("com.ibm.mashups.enabler.remote.Factory",null,{getRemoteModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.remote.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.remote.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.remote.FactoryImpl");dojo.declare("com.ibm.mm.enabler.remote.FactoryImpl",com.ibm.mashups.enabler.remote.Factory,{getRemoteModel:function(){return new com.ibm.mm.enabler.model.RemoteModelImpl();}});com.ibm.mashups.enabler.remote.Factory=new com.ibm.mm.enabler.remote.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.remote.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.remote.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.remote.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.template.TemplateNode"]){dojo._hasResource["com.ibm.mashups.enabler.template.TemplateNode"]=true;dojo.provide("com.ibm.mashups.enabler.template.TemplateNode");dojo.declare("com.ibm.mashups.enabler.template.TemplateNode",[com.ibm.mashups.enabler.Identifiable,com.ibm.mashups.enabler.ModifiableLocalized],{getExportURL:function(){}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.TemplateModel_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.TemplateModel_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.TemplateModel_API");dojo.provide("com.ibm.mashups.enabler.model.TemplateModel");dojo.declare("com.ibm.mashups.enabler.model.TemplateModel",[com.ibm.mashups.enabler.ListModelController,com.ibm.mashups.enabler.SubmittableFormProvider],{commit:function(){},confirmExport:function(_1833){},getSubmittableImportForm:function(id){}});}if(!dojo._hasResource["com.ibm.mm.enabler.template.TemplateNodeImpl"]){dojo._hasResource["com.ibm.mm.enabler.template.TemplateNodeImpl"]=true;dojo.provide("com.ibm.mm.enabler.template.TemplateNodeImpl");dojo.declare("com.ibm.mm.enabler.template.TemplateNodeImpl",[com.ibm.mashups.enabler.template.TemplateNode,com.ibm.mm.enabler.IdentifiableImpl,com.ibm.mm.enabler.LocalizedImpl,com.ibm.mm.enabler.EditLinkProviderImpl],{constructor:function(node){this.xmlData=node;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_TEMPLATE);this.prefix=this.serviceJson.idprefix;var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_CA,nsf.NS_CREATION_CONTEXT]));this.li_ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_XML,nsf.NS_CA]));this.NLS_TITLE="atom:content/ca:template/ca:title";this.NLS_TITLE_TOP="atom:content/ca:template";this.NLS_DESCRIPTION="atom:content/ca:template/ca:description";this.NLS_DESCRIPTION_TOP="atom:content/ca:template";this.BASE_TITLE="ca:title";this.BASE_DESCRIPTION="ca:description";this.BASE_NS=this.li_ns.ca;},getExportURL:function(){var expr="atom:link[@ca:rel='template-export']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _1834=nodes[0].getAttribute("href");return _1834;},toString:function(){return com.ibm.mm.enabler.utils.Dom.innerXML(this.xmlData);}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.TemplateModelImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.TemplateModelImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.TemplateModelImpl");dojo.declare("com.ibm.mm.enabler.model.TemplateModelImpl",[com.ibm.mashups.enabler.ListModel,com.ibm.mm.enabler.model.ModelImpl,com.ibm.mm.enabler.ConfirmableModelImpl],{constructor:function(){this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);var _1835="constructor()";var _1836=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1836){this.LOGGER.entering(_1835);}this.root=null;this.loadedNodes={};this.createdNodes={};this.deletedNodes={};this.initialContents={};this.start=null;this.num=null;this.sizeValue=9999;this.modelMessages=dojo.i18n.getLocalization("com.ibm.mm.enabler","modelMessages");this.entries=[];this.cursor=0;this.size=null;this.nextLink=null;this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_TEMPLATE);this.prefix=this.serviceJson.idprefix;this.nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,this.nsf.getNameSpaces([this.nsf.NS_ATOM,this.nsf.NS_XHTML,this.nsf.NS_OPENSEARCH,this.nsf.NS_CA,this.nsf.NS_APP]));this.urlType=com.ibm.mashups.enabler.model.url.ModelUrlFactory.TEMPLATE_URL;if(_1836){this.LOGGER.exiting(_1835);}},getInstance:function(){var _1837=com.ibm.mm.enabler.model.TemplateModelImpl._instance;return _1837?_1837:(com.ibm.mm.enabler.model.TemplateModelImpl._instance=new com.ibm.mm.enabler.model.TemplateModelImpl());},find:function(id){return new com.ibm.mm.enabler.DeferredImpl(this,this._find,id);},_find:function(_1838,sync,id){var _1839="_find(id, deferred, sync)";var _183a=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_183a){this.LOGGER.entering(_1839,[id,_1838,sync]);}if(id in this.deletedNodes){if(_1838){_1838.finish(null,com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND);}if(_183a){this.LOGGER.exiting(_1839);}return null;}if(id in this.loadedNodes){if(_1838){_1838.finish(this.loadedNodes[id],com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK);}if(_183a){this.LOGGER.exiting(_1839,this.loadedNodes[id]);}return this.loadedNodes[id];}var myUrl=null;var href=com.ibm.mm.enabler.utils.Utils.getHrefFromIdentifiable(id);if(href){myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(href,this);}else{myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(this.urlType,this);myUrl.setNodes([{value:id,isID:true}]);}myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);var _183b=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var entry=null;var _183c={};_183b.read(dojo.hitch(this,function(type,data,xhr,args){var _183d="_find_callback(type, data, xhr, args)";if(_183a){this.LOGGER.entering(_183d,[type,data,xhr,args]);}var expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _183e=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_183e,this.ns);var _183f=new com.ibm.mm.enabler.template.TemplateNodeImpl(nodes[0]);this.newid=_183f.getID();this.loadedNodes[this.newid]=_183f;this.initialContents[this.newid]=_183f.toString();if(_1838){_1838.finish(this.loadedNodes[this.newid]||null,xhr.status);}if(sync&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(xhr.status!=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_NOT_FOUND){_183c.status=xhr.status;}}if(_183a){this.LOGGER.exiting(_183d);}}));if(_183c.status){throw new Error(dojo.string.substitute(this.modelMessages.E_COMNODE_NOTFOUND_1,[id,_183c.status]));}if(_183a){this.LOGGER.exiting(_1839,this.loadedNodes[this.newid]);}return this.loadedNodes[this.newid];},create:function(_1840){return null;},confirmCreate:function(_1841){return this.getConfirmCreate();},insert:function(node,_1842){var id=node.getID();this.createdNodes[id]=node;},confirmInsert:function(node,_1843){return this.getConfirmInsert(_1843);},confirmExport:function(node){if(com.ibm.mm.enabler.AnonymousHelper.getAnonymousMode()==com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS){return false;}return true;},commit:function(){return new com.ibm.mm.enabler.DeferredOperationImpl(this,this._commit);},_commit:function(_1844,sync){var _1845="_commit(deferred, sync)";var _1846=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1846){this.LOGGER.entering(_1845,[_1844,sync]);}this.statusCode=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;this.requestCount=0;this._acquire();for(var id in this.loadedNodes){if(Object.prototype.hasOwnProperty.call(this.loadedNodes,id)){}}for(var _1847 in this.createdNodes){if(Object.prototype.hasOwnProperty.call(this.createdNodes,_1847)){}}this.createdNodes={};for(var _1848 in this.deletedNodes){if(Object.prototype.hasOwnProperty.call(this.deletedNodes,_1848)){if(_1846){this.LOGGER.trace(_1845,"Processing delete of template ${0}",_1848);}var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.deletedNodes[_1848].getEditLink(),this);var _1849=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);this._acquire();_1849.remove(dojo.hitch(this,function(type,data,xhr,args){var _184a="_commit_remove_callback(type, data, xhr, args)";if(_1846){this.LOGGER.entering(_184a,[type,data,xhr,args]);}if(_1844&&_1844.operationCallback){_1844.operationCallback(newentry,com.ibm.mashups.enabler.DeferredOperation.OPERATION_DELETE,xhr.status,_1844.operationCallbackParameters);}this._release(_1844,xhr.status);if(_1846){this.LOGGER.exiting(_184a,[type,data,xhr,args]);}}));}}this.deletedNodes={};this._release(_1844,0);if(_1846){this.LOGGER.exiting(_1845);}},_acquire:function(){this.requestCount++;},_release:function(_184b,_184c){this.statusCode=Math.max(parseInt(_184c,10),this.statusCode);this.requestCount--;if(this.requestCount<=0){if(_184b){_184b.finish(null,this.statusCode);}}},remove:function(node){var _184d="remove(node)";var _184e=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_184e){this.LOGGER.entering(_184d,node);}var id=node.getID();if(!(id in this.deletedNodes)){this.deletedNodes[id]=this.loadedNodes[id];}if(id in this.loadedNodes){delete this.loadedNodes[id];}if(_184e){this.LOGGER.exiting(_184d,node);}},confirmRemove:function(node){return this.getConfirmRemove(node);},iterator:function(){return this;},start:function(sync){while(this._hasNext(this,sync)){if(this._next(this,sync)){continue;}else{break;}}},hasNext:function(){return this._hasNext(null,true);},_hasNext:function(_184f,sync){var _1850=false;if(this.entries[this.cursor]===undefined){this._loadAhead(_184f,sync);}var next=this.entries[this.cursor];if(next!==null&&next!==undefined){_1850=true;}return _1850;},next:function(){return this._next(null,true);},_next:function(_1851,sync){return this._hasNext(_1851,sync)?this.loadedNodes[this.entries[this.cursor++]]:null;},size:function(){return this.sizeValue;},setCursorPosition:function(_1852){this.cursor=_1852;},getCursorPosition:function(){return this.cursor;},_loadAhead:function(_1853,sync){var _1854="_loadAhead(deferred, sync)";var _1855=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_1855){this.LOGGER.entering(_1854,[_1853,sync]);}var myUrl;if(!this.nextLink){if(_1855){this.LOGGER.trace(_1854,"Creating new model URL link");}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.serviceJson.url,this);myUrl.setParameter("start",this.getCursorPosition());if(this.strategy){for(var x in this.strategy){if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(this.strategy[x],com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl)){myUrl.setParameter("num",this.strategy[x].getInterval());break;}}}}else{if(_1855){this.LOGGER.trace(_1854,"Reusing 'next' link");}myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(this.nextLink,this);}myUrl.addParameter(com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT,com.ibm.mm.enabler.model.url.ModelUrlConstants.PARAMETER_ASPECT_VALUE_ACCESS_CONTROL);var _1856=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);var _1857=this.entries;var _1858=0;var model=this.model;_1856.read(dojo.hitch(this,function(type,data,xhr,args){var _1859="_loadAhead_callback(type, data, xhr, args)";if(_1855){this.LOGGER.entering(_1859,[type,data,xhr,args]);}if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var expr;if(!this.sizeValue){expr="atom:feed/openSearch:totalResults";var _185a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(_185a&&_185a.length>0){this.sizeValue=com.ibm.mm.enabler.utils.Dom.textContent(_185a[0]);if(_1855){this.LOGGER.trace(_1859,"Total reported entry count: ${0}",this.sizeValue);}}}this.nextLink=null;expr="atom:feed/atom:link[@rel='next']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);if(nodes&&nodes.length>0){this.nextLink=nodes[0].getAttribute("href");}if(_1855){this.LOGGER.trace(_1859,"New nextLink = ${0}",this.nextLink);}expr="atom:feed";var feed=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,data,this.ns);var _185b=(feed&&feed.length>0)?feed[0]:data;expr="atom:entry";nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_185b,this.ns);_1858=nodes.length;this.start=this.getCursorPosition();for(var i=0;i<nodes.length;++i){var node=new com.ibm.mm.enabler.template.TemplateNodeImpl(nodes[i]);this.entries[this.cursor+i]=node.getID();this._cacheNode(node);if(_1853&&_1853.foreachCallback){_1853.foreachCallback(this.loadedNodes[id],_1853.foreachCallbackParameters);}}this.entries[this.cursor+nodes.length]=this.nextLink?undefined:null;if(_1853){_1853.finish(null,xhr.status);}}else{if(type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_ERROR){if(_1853){_1853.finish(null,xhr.status);}}}if(_1855){this.LOGGER.exiting(_1859,[type,data,xhr,args]);}}));if(_1855){this.LOGGER.exiting(_1854);}},_cacheNode:function(node){var id=node.getID();if(!(id in this.loadedNodes)){this.loadedNodes[id]=node;this.initialContents[id]=node.toString();}return this.loadedNodes[id];}});}if(!dojo._hasResource["com.ibm.mashups.enabler.model.TemplateModel"]){dojo._hasResource["com.ibm.mashups.enabler.model.TemplateModel"]=true;dojo.provide("com.ibm.mashups.enabler.model.TemplateModel");}if(!dojo._hasResource["com.ibm.mashups.enabler.template.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.template.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.template.Factory_API");dojo.provide("com.ibm.mashups.enabler.template.Factory");dojo.declare("com.ibm.mashups.enabler.template.Factory",null,{getTemplateModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.template.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.template.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.template.FactoryImpl");dojo.declare("com.ibm.mm.enabler.template.FactoryImpl",com.ibm.mashups.enabler.template.Factory,{getTemplateModel:function(){return com.ibm.mm.enabler.model.TemplateModelImpl.prototype.getInstance();}});com.ibm.mashups.enabler.template.Factory=new com.ibm.mm.enabler.template.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.template.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.template.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.template.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.model.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.model.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.model.Factory_API");dojo.provide("com.ibm.mashups.enabler.model.Factory");dojo.declare("com.ibm.mashups.enabler.model.Factory",null,{getCatalogCategoryModel:function(){},getNavigationModel:function(){},getSharedNavigationModel:function(){},getThemeModel:function(){},getUserModel:function(){},getRemoteModel:function(){},getTemplateModel:function(){},getSpaceModel:function(){},getSpaceExtensionModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.model.FactoryImpl"]){dojo._hasResource["com.ibm.mm.enabler.model.FactoryImpl"]=true;dojo.provide("com.ibm.mm.enabler.model.FactoryImpl");dojo.declare("com.ibm.mm.enabler.model.FactoryImpl",null,{getCatalogCategoryModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getCatalogCategoryModel","The method com.ibm.mashups.model.Factory.getCatalogCategoryModel is deprecated, please use com.ibm.mashups.enabler.catalog.Factory.getCatalogCategoryModel instead!");return com.ibm.mashups.enabler.catalog.Factory.getCatalogCategoryModel();},getNavigationModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getNavigationModel","The method com.ibm.mashups.model.Factory.getNavigationModel is deprecated, please use com.ibm.mashups.enabler.navigation.Factory.getNavigationModel instead!");return com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();},getSharedNavigationModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getSharedNavigationModel","The method com.ibm.mashups.model.Factory.getSharedNavigationModel is deprecated, please use com.ibm.mashups.enabler.navigation.Factory.getSharedNavigationModel instead!");return com.ibm.mashups.enabler.navigation.Factory.getSharedNavigationModel();},getThemeModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getThemeModel","The method com.ibm.mashups.model.Factory.getThemeModel is deprecated, please use com.ibm.mashups.enabler.theme.Factory.getThemeModel instead!");return com.ibm.mashups.enabler.theme.Factory.getThemeModel();},getUserModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getUserModel","The method com.ibm.mashups.model.Factory.getUserModel is deprecated, please use com.ibm.mashups.enabler.user.Factory.getUserModel instead!");return com.ibm.mashups.enabler.user.Factory.getUserModel();},getRemoteModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getRemoteModel","The method com.ibm.mashups.model.Factory.getRemoteModel is deprecated, please use com.ibm.mashups.enabler.remote.Factory.getRemoteModel instead!");return com.ibm.mashups.enabler.remote.Factory.getRemoteModel();},getSpaceModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getSpaceModel","The method com.ibm.mashups.model.Factory.getSpaceModel is deprecated, please use com.ibm.mashups.enabler.space.Factory.getSpaceModel instead!");return com.ibm.mashups.enabler.space.Factory.getSpaceModel();},getSpaceExtensionModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getSpaceExtensionModel","The method com.ibm.mashups.model.Factory.getSpaceExtensionModel is deprecated, please use com.ibm.mashups.enabler.space.Factory.getSpaceExtensionModel instead!");return com.ibm.mashups.enabler.space.Factory.getSpaceExtensionModel();},getTemplateModel:function(){dojo.deprecated("com.ibm.mashups.model.Factory.getTemplateModel","The method com.ibm.mashups.model.Factory.getTemplateModel is deprecated, please use com.ibm.mashups.enabler.template.Factory.getTemplateModel instead!");return com.ibm.mashups.enabler.template.Factory.getTemplateModel();}});com.ibm.mashups.enabler.model.Factory=new com.ibm.mm.enabler.model.FactoryImpl();}if(!dojo._hasResource["com.ibm.mashups.enabler.model.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.model.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.model.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy_API"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy_API"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy_API");dojo.provide("com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(_185c,_185d,_185e){},isLoadAheadLayoutModel:function(){return this.loadAheadLayoutModel;},isLoadAheadTheme:function(){return this.loadAheadTheme;}});}if(!dojo._hasResource["com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl"]){dojo._hasResource["com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl"]=true;dojo.provide("com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl");dojo.declare("com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl",[com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy,com.ibm.mm.enabler.ServiceDocConsumer],{constructor:function(_185f,_1860,_1861){this.loadAheadLayoutModel=!!_185f;this.loadAheadUser=!!_1861;this.userModel=null;var _1862=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _1863=_1862.getValue(com.ibm.mashups.enabler.services.ConfigConstants.PAGE_LOAD_OPTIMIZATION_THEME);if(_1863===true){this.loadAheadTheme=!!_1860;}else{this.loadAheadTheme=false;}},_initServiceDoc:function(){this.serviceJson=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_NAVIGATION);var nsf=com.ibm.mm.enabler.model.NameSpaceFactory;this.ns=dojo.delegate(this.serviceJson.namespaces,nsf.getNameSpaces([nsf.NS_ATOM,nsf.NS_THR,nsf.NS_XML,nsf.NS_OPENSEARCH]));this.prefix=this.serviceJson.idprefix;this.inherited("_initServiceDoc",arguments);},isLoadAheadLayoutModel:function(){return this.loadAheadLayoutModel;},isLoadAheadTheme:function(){return this.loadAheadTheme;},isLoadAheadUser:function(){return this.loadAheadUser;},setUserModel:function(_1864){this.userModel=_1864;},getUserModel:function(){if(!this.userModel){this.userModel=com.ibm.mashups.enabler.user.Factory.getUserModel();}return this.userModel;},_processLoadAhead:function(_1865,sync){if(!com.ibm.mashups.enabler.io.XHRMultipartFactory.isMultipartEnabled()){return;}var _1866=com.ibm.mashups.enabler.io.XHRMultipartFactory.create();_1866.startTransaction();if(this.loadAheadUser){var _1867=this.getUserModel();_1867.findCurrentUser().start();}this._initServiceDoc();for(var i=0;i<_1865.length;i++){if(this.loadAheadLayoutModel){var href=null;var id=null;var expr="atom:link[@rel='related' and @ext:class='content-node']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_1865[i].xmlData,this.ns);if(nodes&&nodes.length>0){href=nodes[0].getAttribute("href");id=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,nodes[0]);}var _1868=(id!==null)?id:_1865[i].getID();var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL(href,null);var _1869=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);_1869.read(dojo.hitch(this,function(type,data,xhr,args){if((type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD)&&(args.node)){var _186a=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(_186a&&_186a.length>0){args.node._setFragmentData(_186a[0]);}}}),{"node":_1865[i]});myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_MEDIA_URL,null);myUrl.setNodes([{value:_1868,isID:true},{value:"index.html",isID:false}]);_1869=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,true,sync);_1869.read(dojo.hitch(this,function(type,data,xhr,args){if((type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD)&&(args.node)){args.node._setFragmentMediaData(data);}}),{"node":_1865[i]});}if(this.loadAheadTheme){var _186b=_1865[i].getTheme();if(_186b!==null){var _186c=com.ibm.mashups.enabler.theme.Factory.getThemeModel();_186c.find(_186b).start();}}}_1866.endTransactionDeferred().start();},_processFind:function(node,sync){if(this.loadAheadLayoutModel){this._initServiceDoc();var myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL,null);var uri="0";myUrl.setNodes([{value:uri,isID:true}]);serviceReq=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,sync);serviceReq.read(dojo.hitch(this,function(type,data,xhr,args){if((type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD)&&(node)){var _186d=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,this.ns);if(_186d&&_186d.length>0){node._setFragmentData(_186d[0]);}}}));myUrl=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_MEDIA_URL,null);myUrl.setNodes([{value:uri,isID:true},{value:"index.html",isID:false}]);serviceReq=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,true,sync);serviceReq.read(dojo.hitch(this,function(type,data,xhr,args){if((type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD)&&(node)){node._setFragmentMediaData(data);}}));}if(this.loadAheadTheme){var _186e=com.ibm.mashups.enabler.theme.Factory.getThemeModel();_186e.find("0").start();}}});com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy=com.ibm.mm.enabler.strategy.PageLoadAheadStrategyImpl;}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy");}if(!dojo._hasResource["com.ibm.mashups.enabler.EmbeddingGenerator"]){dojo._hasResource["com.ibm.mashups.enabler.EmbeddingGenerator"]=true;dojo.provide("com.ibm.mashups.enabler.EmbeddingGenerator");dojo.declare("com.ibm.mashups.enabler.EmbeddingGenerator",null,{widgetDefinition:"",pid:"",width:"",height:"",scrollbar:false,sandboxed:false,framework:"light",preferences:null,constructor:function(_186f,pid){this.widgetDefinition=_186f;this.pid=pid;this.hostAlias=null;},_getSecureHostAlias:function(){if(this.hostAlias===null){this.hostAlias=window.location.host;}return this.hostAlias;},toString:function(){var url=window.location.protocol;url+="//"+this._getSecureHostAlias();url+=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);url+=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.EMBEDDING_PUBLIC);url+="?";url+="uri=widget:js";url+="&url="+escape(this.widgetDefinition);if(this.pid){url+="&pid="+escape(this.pid);this.height=this.height?this.height:"850";this.width=this.width?this.width:"750";}else{this.height=this.height?this.height:"500";this.width=this.width?this.width:"400";}url+="&h="+escape(this.height);url+="&w="+escape(this.width);if(this.scrollbar){url+="&sb=yes";}else{url+="&sb=no";}if(this.framework&&this.framework!="light"){url+="&fw="+this.framework;}if(this.sandboxed){url+="&sandbox=yes";}if(this.preferences&&this.preferences.getAllNames()){var names=this.preferences.getAllNames();for(var i=0,l=names.length;i<l;++i){url+="&p_"+encodeURIComponent(names[i])+"="+encodeURIComponent(this.preferences.getItemValue(names[i]));}}return url;},getWidgetDefinition:function(){return this.widgetDefinition;},setWidgetDefinition:function(value){this.widgetDefinition=value;},getPid:function(){return this.pid;},setPid:function(value){this.pid=value;},getWidth:function(){return this.width;},setWidth:function(value){this.width=value;},getHeight:function(){return this.height;},setHeight:function(value){this.height=value;},getScrollbar:function(){return this.scrollbar;},setScrollbar:function(value){this.scrollbar=value;},getSandboxed:function(){return this.sandboxed;},setSandboxed:function(value){this.sandboxed=value;},getFramework:function(){return this.framework;},setFramework:function(value){this.framework=value;},getPreferences:function(){return this.preferences;},setPreferences:function(value){this.preferences=value;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.Factory_API"]){dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.Factory_API"]=true;dojo.provide("com.ibm.mashups.enabler.layouttemplate.Factory_API");dojo.provide("com.ibm.mashups.enabler.layouttemplate.Factory");dojo.declare("com.ibm.mashups.enabler.layouttemplate.Factory",null,{getTemplateModel:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.layouttemplate.Factory"]){dojo._hasResource["com.ibm.mm.enabler.layouttemplate.Factory"]=true;dojo.provide("com.ibm.mm.enabler.layouttemplate.Factory");dojo.require("com.ibm.mm.enabler.layouttemplate.LayoutTemplateModel");dojo.declare("com.ibm.mm.enabler.layouttemplate.Factory",com.ibm.mashups.enabler.layouttemplate.Factory,{getTemplateModel:function(){if(!this._model){this._model=new com.ibm.mm.enabler.layouttemplate.LayoutTemplateModel();}return this._model;}});com.ibm.mashups.enabler.layouttemplate.Factory=new com.ibm.mm.enabler.layouttemplate.Factory();}if(!dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.Factory"]){dojo._hasResource["com.ibm.mashups.enabler.layouttemplate.Factory"]=true;dojo.provide("com.ibm.mashups.enabler.layouttemplate.Factory");}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.CatalogCategoryLoadAheadStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.CatalogCategoryLoadAheadStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.CatalogCategoryLoadAheadStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.CatalogCategoryLoadAheadStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(_1870){this.loadAheadCatalogCategoryModel=_1870;this.catalogCategoryModel=null;},isLoadAheadCatalogCategoryModel:function(){return this.loadAheadCatalogCategoryModel;},setCatalogCategoryModel:function(_1871){this.catalogCategoryModel=_1871||null;},getCatalogCategoryModel:function(){if(null===this.catalogCategoryModel){this.catalogCategoryModel=com.ibm.mashups.enabler.catalog.Factory.getCatalogCategoryModel();}return this.catalogCategoryModel;}});}if(!dojo._hasResource["com.ibm.mashups.enabler.strategy.UserLoadAheadStrategy"]){dojo._hasResource["com.ibm.mashups.enabler.strategy.UserLoadAheadStrategy"]=true;dojo.provide("com.ibm.mashups.enabler.strategy.UserLoadAheadStrategy");dojo.declare("com.ibm.mashups.enabler.strategy.UserLoadAheadStrategy",com.ibm.mashups.enabler.strategy.Strategy,{constructor:function(_1872){this.loadAheadUser=_1872;this.userModel=null;},isLoadAheadUser:function(){return this.loadAheadUser;},setUserModel:function(_1873){this.userModel=_1873;},getUserModel:function(){if(null===this.userModel){this.userModel=com.ibm.mashups.enabler.user.Factory.getUserModel();}return this.userModel;}});}if(!dojo._hasResource["com.ibm.mashups.data.model"]){dojo._hasResource["com.ibm.mashups.data.model"]=true;dojo.provide("com.ibm.mashups.data.model");dojo.declare("com.ibm.mashups.data.model",null,{getValue:function(item,_1874){},getValueType:function(item,_1875){},getValues:function(item,_1876){},getAttributes:function(item){},hasAttribute:function(item,_1877){},isItem:function(_1878){},fetch:function(_1879){},serialize:function(){}});}if(!dojo._hasResource["com.ibm.mm.enabler.LegacySupport"]){dojo._hasResource["com.ibm.mm.enabler.LegacySupport"]=true;dojo.provide("com.ibm.mm.enabler.LegacySupport");dojo.provide("com.ibm.enabler.aggregation.javascript");dojo.provide("com.ibm.enabler.iw");dojo.provide("com.ibm.enabler.xpath");dojo.provide("com.ibm.enabler.xslt");dojo.provide("com.ibm.enabler.services");dojo.provide("com.ibm.enabler.debug");dojo.provide("com.ibm.enabler.iw.eventImpl");dojo.provide("com.ibm.enabler.dom");dojo.provide("com.ibm.mm.enabler.dom");dojo.provide("com.ibm.enabler.utilities");dojo.provide("com.ibm.mm.enabler.utilities");dojo.provide("com.ibm.mm.enabler.iw");dojo.provide("com.ibm.mm.iwidget.iEvents");dojo.provide("com.ibm.mm.enabler.utilities.HttpUrl");dojo.provide("com.ibm.mm.enabler.debug");com.ibm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER=com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER;com.ibm.mm.iwidget.utils=com.ibm.mm.iwidget.Utils;com.ibm.enabler.iw.utils=com.ibm.mm.iwidget.utils;com.ibm.mm.enabler.utilities={};com.ibm.mm.enabler.utilities=dojo.mixin(com.ibm.mm.enabler.utilities,com.ibm.mm.enabler.utils.LocaleHelper,com.ibm.mm.enabler.utils.URLHelper,com.ibm.mm.enabler.utils.Misc,com.ibm.mm.enabler.utils.Dom);com.ibm.enabler.utilities=com.ibm.mm.enabler.utilities;com.ibm.enabler.dom=com.ibm.mm.enabler.dom;dojo.declare("com.ibm.mm.enabler.utilities.HttpUrl",com.ibm.mm.enabler.utils.HttpUrl,{constructor:function(){}});dojo.declare("com.ibm.enabler.utilities.HttpUrl",com.ibm.mm.enabler.utilities.HttpUrl,{constructor:function(){}});com.ibm.mm.enabler.xpath=com.ibm.mm.enabler.xml.xpath;com.ibm.enabler.xpath.evaluateXPath=com.ibm.mashups.enabler.xml.XPath.evaluateXPath;if(com.ibm.mm.enabler.xslt){com.ibm.enabler.xslt.getXmlHttpRequest=com.ibm.mm.enabler.xslt.getXmlHttpRequest;com.ibm.enabler.xslt.loadXml=com.ibm.mm.enabler.xslt.loadXml;com.ibm.enabler.xslt.loadXmlString=com.ibm.mm.enabler.xslt.loadXmlString;com.ibm.enabler.xslt.loadXsl=com.ibm.mm.enabler.xslt.loadXsl;com.ibm.enabler.xslt.transform=com.ibm.mm.enabler.xslt.transform;com.ibm.enabler.xslt.transformAndUpdate=com.ibm.mm.enabler.xslt.transformAndUpdate;}com.ibm.mm.enabler.debug=com.ibm.mm.enabler.logging.LegacyLogger;com.ibm.enabler.debug.Constants=com.ibm.mm.enabler.debug.Constants;com.ibm.enabler.debug.log=com.ibm.mm.enabler.debug.log;com.ibm.enabler.debug.entry=com.ibm.mm.enabler.debug.entry;com.ibm.enabler.debug.exit=com.ibm.mm.enabler.debug.exit;com.ibm.enabler.debug.info=com.ibm.mm.enabler.debug.info;com.ibm.enabler.debug.warn=com.ibm.mm.enabler.debug.warn;com.ibm.enabler.debug.error=com.ibm.mm.enabler.debug.error;dojo.declare("com.ibm.enabler.iw.iEventDescriptionImpl",com.ibm.mm.iwidget.IEventDescriptionImpl,{constructor:function(){}});com.ibm.mm.enabler.iw.utils=com.ibm.mm.iwidget.utils;com.ibm.mm.iwidget.iEvents.Constants=iwConstants.EVENTS;com.ibm.mm.enabler.iw.iEvents=com.ibm.mm.iwidget.iEvents;dojo.declare("com.ibm.mm.enabler.iw.iEventDescriptionImpl",com.ibm.mm.iwidget.IEventDescriptionImpl,{constructor:function(){}});dojo.provide("com.ibm.mashups.iwidget.services");com.ibm.mashups.iwidget.services.ServiceManager=com.ibm.mashups.services.ServiceManager;dojo.provide("com.ibm.mm.enabler.iw.eventImpl");dojo.declare("com.ibm.mm.iwidget.itemset.PersistentAttributes",com.ibm.mm.iwidget.manageditemset.PersistentAttributes,{constructor:function(){}});dojo.provide("com.ibm.mm.livetext.serviceImpl");com.ibm.mm.livetext.serviceImpl=com.ibm.mm.livetext.ServiceModelImpl;iWidgetContainer=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();}if(!dojo._hasResource["dojo.data.util.filter"]){dojo._hasResource["dojo.data.util.filter"]=true;dojo.provide("dojo.data.util.filter");dojo.data.util.filter.patternToRegExp=function(_187a,_187b){var rxp="^";var c=null;for(var i=0;i<_187a.length;i++){c=_187a.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_187a.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_187b){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};}if(!dojo._hasResource["dojo.data.util.sorter"]){dojo._hasResource["dojo.data.util.sorter"]=true;dojo.provide("dojo.data.util.sorter");dojo.data.util.sorter.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};dojo.data.util.sorter.createSortFunction=function(_187c,store){var _187d=[];function createSortFunction(attr,dir,comp,s){return function(itemA,itemB){var a=s.getValue(itemA,attr);var b=s.getValue(itemB,attr);return dir*comp(a,b);};};var _187e;var map=store.comparatorMap;var bc=dojo.data.util.sorter.basicComparator;for(var i=0;i<_187c.length;i++){_187e=_187c[i];var attr=_187e.attribute;if(attr){var dir=(_187e.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_187d.push(createSortFunction(attr,dir,comp,store));}}return function(rowA,rowB){var i=0;while(i<_187d.length){var ret=_187d[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};}if(!dojo._hasResource["dojo.data.util.simpleFetch"]){dojo._hasResource["dojo.data.util.simpleFetch"]=true;dojo.provide("dojo.data.util.simpleFetch");dojo.data.util.simpleFetch.fetch=function(_187f){_187f=_187f||{};if(!_187f.store){_187f.store=this;}var self=this;var _1880=function(_1881,_1882){if(_1882.onError){var scope=_1882.scope||dojo.global;_1882.onError.call(scope,_1881,_1882);}};var _1883=function(items,_1884){var _1885=_1884.abort||null;var _1886=false;var _1887=_1884.start?_1884.start:0;var _1888=(_1884.count&&(_1884.count!==Infinity))?(_1887+_1884.count):items.length;_1884.abort=function(){_1886=true;if(_1885){_1885.call(_1884);}};var scope=_1884.scope||dojo.global;if(!_1884.store){_1884.store=self;}if(_1884.onBegin){_1884.onBegin.call(scope,items.length,_1884);}if(_1884.sort){items.sort(dojo.data.util.sorter.createSortFunction(_1884.sort,self));}if(_1884.onItem){for(var i=_1887;(i<items.length)&&(i<_1888);++i){var item=items[i];if(!_1886){_1884.onItem.call(scope,item,_1884);}}}if(_1884.onComplete&&!_1886){var _1889=null;if(!_1884.onItem){_1889=items.slice(_1887,_1888);}_1884.onComplete.call(scope,_1889,_1884);}};this._fetchItems(_187f,_1883,_1880);return _187f;};}if(!dojo._hasResource["dojox.data.CsvStore"]){dojo._hasResource["dojox.data.CsvStore"]=true;dojo.provide("dojox.data.CsvStore");dojo.declare("dojox.data.CsvStore",null,{constructor:function(_188a){this._attributes=[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=false;if(_188a.url){this.url=_188a.url;}this._csvData=_188a.data;if(_188a.label){this.label=_188a.label;}else{if(this.label===""){this.label=undefined;}}this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._loadInProgress=false;this._queuedFetches=[];this.identifier=_188a.identifier;if(this.identifier===""){delete this.identifier;}else{this._idMap={};}if("separator" in _188a){this.separator=_188a.separator;}if("urlPreventCache" in _188a){this.urlPreventCache=_188a.urlPreventCache?true:false;}},url:"",label:"",identifier:"",separator:",",urlPreventCache:false,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": a function was passed an item argument that was not an item");}},_getIndex:function(item){var idx=this.getIdentity(item);if(this.identifier){idx=this._idMap[idx];}return idx;},getValue:function(item,_188b,_188c){this._assertIsItem(item);var _188d=_188c;if(typeof _188b==="string"){var ai=this._attributeIndexes[_188b];if(ai!=null){var _188e=this._dataArray[this._getIndex(item)];_188d=_188e[ai]||_188c;}}else{throw new Error(this.declaredClass+": a function was passed an attribute argument that was not a string");}return _188d;},getValues:function(item,_188f){var value=this.getValue(item,_188f);return (value?[value]:[]);},getAttributes:function(item){this._assertIsItem(item);var _1890=[];var _1891=this._dataArray[this._getIndex(item)];for(var i=0;i<_1891.length;i++){if(_1891[i]!==""){_1890.push(this._attributes[i]);}}return _1890;},hasAttribute:function(item,_1892){this._assertIsItem(item);if(typeof _1892==="string"){var _1893=this._attributeIndexes[_1892];var _1894=this._dataArray[this._getIndex(item)];return (typeof _1893!=="undefined"&&_1893<_1894.length&&_1894[_1893]!=="");}else{throw new Error(this.declaredClass+": a function was passed an attribute argument that was not a string");}},containsValue:function(item,_1895,value){var _1896=undefined;if(typeof value==="string"){_1896=dojo.data.util.filter.patternToRegExp(value,false);}return this._containsValue(item,_1895,value,_1896);},_containsValue:function(item,_1897,value,_1898){var _1899=this.getValues(item,_1897);for(var i=0;i<_1899.length;++i){var _189a=_1899[i];if(typeof _189a==="string"&&_1898){return (_189a.match(_1898)!==null);}else{if(value===_189a){return true;}}}return false;},isItem:function(_189b){if(_189b&&_189b[this._storeProp]===this){var _189c=_189b[this._idProp];if(this.identifier){var data=this._dataArray[this._idMap[_189c]];if(data){return true;}}else{if(_189c>=0&&_189c<this._dataArray.length){return true;}}}return false;},isItemLoaded:function(_189d){return this.isItem(_189d);},loadItem:function(item){},getFeatures:function(){return this._features;},getLabel:function(item){if(this.label&&this.isItem(item)){return this.getValue(item,this.label);}return undefined;},getLabelAttributes:function(item){if(this.label){return [this.label];}return null;},_fetchItems:function(_189e,_189f,_18a0){var self=this;var _18a1=function(_18a2,_18a3){var items=null;if(_18a2.query){var key,value;items=[];var _18a4=_18a2.queryOptions?_18a2.queryOptions.ignoreCase:false;var _18a5={};for(key in _18a2.query){value=_18a2.query[key];if(typeof value==="string"){_18a5[key]=dojo.data.util.filter.patternToRegExp(value,_18a4);}}for(var i=0;i<_18a3.length;++i){var match=true;var _18a6=_18a3[i];for(key in _18a2.query){value=_18a2.query[key];if(!self._containsValue(_18a6,key,value,_18a5[key])){match=false;}}if(match){items.push(_18a6);}}}else{items=_18a3.slice(0,_18a3.length);}_189f(items,_18a2);};if(this._loadFinished){_18a1(_189e,this._arrayOfAllItems);}else{if(this.url!==""){if(this._loadInProgress){this._queuedFetches.push({args:_189e,filter:_18a1});}else{this._loadInProgress=true;var _18a7={url:self.url,handleAs:"text",preventCache:self.urlPreventCache};var _18a8=dojo.xhrGet(_18a7);_18a8.addCallback(function(data){try{self._processData(data);_18a1(_189e,self._arrayOfAllItems);self._handleQueuedFetches();}catch(e){_18a0(e,_189e);}});_18a8.addErrback(function(error){self._loadInProgress=false;if(_18a0){_18a0(error,_189e);}else{throw error;}});var _18a9=null;if(_189e.abort){_18a9=_189e.abort;}_189e.abort=function(){var df=_18a8;if(df&&df.fired===-1){df.cancel();df=null;}if(_18a9){_18a9.call(_189e);}};}}else{if(this._csvData){try{this._processData(this._csvData);this._csvData=null;_18a1(_189e,this._arrayOfAllItems);}catch(e){_18a0(e,_189e);}}else{var error=new Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(_18a0){_18a0(error,_189e);}else{throw error;}}}}},close:function(_18aa){},_getArrayOfArraysFromCsvFileContents:function(_18ab){if(dojo.isString(_18ab)){var _18ac=new RegExp("^\\s+","g");var _18ad=new RegExp("\\s+$","g");var _18ae=new RegExp("\"\"","g");var _18af=[];var i;var _18b0=this._splitLines(_18ab);for(i=0;i<_18b0.length;++i){var _18b1=_18b0[i];if(_18b1.length>0){var _18b2=_18b1.split(this.separator);var j=0;while(j<_18b2.length){var _18b3=_18b2[j];var _18b4=_18b3.replace(_18ac,"");var field=_18b4.replace(_18ad,"");var _18b5=field.charAt(0);var _18b6=field.charAt(field.length-1);var _18b7=field.charAt(field.length-2);var _18b8=field.charAt(field.length-3);if(field.length===2&&field=="\"\""){_18b2[j]="";}else{if((_18b5=="\"")&&((_18b6!="\"")||((_18b6=="\"")&&(_18b7=="\"")&&(_18b8!="\"")))){if(j+1===_18b2.length){return;}var _18b9=_18b2[j+1];_18b2[j]=_18b4+this.separator+_18b9;_18b2.splice(j+1,1);}else{if((_18b5=="\"")&&(_18b6=="\"")){field=field.slice(1,(field.length-1));field=field.replace(_18ae,"\"");}_18b2[j]=field;j+=1;}}}_18af.push(_18b2);}}this._attributes=_18af.shift();for(i=0;i<this._attributes.length;i++){this._attributeIndexes[this._attributes[i]]=i;}this._dataArray=_18af;}},_splitLines:function(_18ba){var split=[];var i;var line="";var _18bb=false;for(i=0;i<_18ba.length;i++){var c=_18ba.charAt(i);switch(c){case "\"":_18bb=!_18bb;line+=c;break;case "\r":if(_18bb){line+=c;}else{split.push(line);line="";if(i<(_18ba.length-1)&&_18ba.charAt(i+1)=="\n"){i++;}}break;case "\n":if(_18bb){line+=c;}else{split.push(line);line="";}break;default:line+=c;}}if(line!==""){split.push(line);}return split;},_processData:function(data){this._getArrayOfArraysFromCsvFileContents(data);this._arrayOfAllItems=[];if(this.identifier){if(this._attributeIndexes[this.identifier]===undefined){throw new Error(this.declaredClass+": Identity specified is not a column header in the data set.");}}for(var i=0;i<this._dataArray.length;i++){var id=i;if(this.identifier){var iData=this._dataArray[i];id=iData[this._attributeIndexes[this.identifier]];this._idMap[id]=i;}this._arrayOfAllItems.push(this._createItemFromIdentity(id));}this._loadFinished=true;this._loadInProgress=false;},_createItemFromIdentity:function(_18bc){var item={};item[this._storeProp]=this;item[this._idProp]=_18bc;return item;},getIdentity:function(item){if(this.isItem(item)){return item[this._idProp];}return null;},fetchItemByIdentity:function(_18bd){var item;var scope=_18bd.scope?_18bd.scope:dojo.global;if(!this._loadFinished){var self=this;if(this.url!==""){if(this._loadInProgress){this._queuedFetches.push({args:_18bd});}else{this._loadInProgress=true;var _18be={url:self.url,handleAs:"text"};var _18bf=dojo.xhrGet(_18be);_18bf.addCallback(function(data){try{self._processData(data);var item=self._createItemFromIdentity(_18bd.identity);if(!self.isItem(item)){item=null;}if(_18bd.onItem){_18bd.onItem.call(scope,item);}self._handleQueuedFetches();}catch(error){if(_18bd.onError){_18bd.onError.call(scope,error);}}});_18bf.addErrback(function(error){this._loadInProgress=false;if(_18bd.onError){_18bd.onError.call(scope,error);}});}}else{if(this._csvData){try{self._processData(self._csvData);self._csvData=null;item=self._createItemFromIdentity(_18bd.identity);if(!self.isItem(item)){item=null;}if(_18bd.onItem){_18bd.onItem.call(scope,item);}}catch(e){if(_18bd.onError){_18bd.onError.call(scope,e);}}}}}else{item=this._createItemFromIdentity(_18bd.identity);if(!this.isItem(item)){item=null;}if(_18bd.onItem){_18bd.onItem.call(scope,item);}}},getIdentityAttributes:function(item){if(this.identifier){return [this.identifier];}else{return null;}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var fData=this._queuedFetches[i];var _18c0=fData.filter;var _18c1=fData.args;if(_18c0){_18c0(_18c1,this._arrayOfAllItems);}else{this.fetchItemByIdentity(fData.args);}}this._queuedFetches=[];}}});dojo.extend(dojox.data.CsvStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["com.ibm.mm.data.table"]){dojo._hasResource["com.ibm.mm.data.table"]=true;dojo.provide("com.ibm.mm.data.table");dojo.declare("com.ibm.mm.data.table",dojox.data.CsvStore,{constructor:function(_18c2){if(this._isCSVLike(_18c2.data)){_18c2.data=this._CSVLike2CSV(_18c2.data);}this._attributes=[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=false;if(_18c2.url){this.url=_18c2.url;}this._csvData=_18c2.data;if(_18c2.label){this.label=_18c2.label;}else{if(this.label===""){this.label=undefined;}}this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._loadInProgress=false;this._queuedFetches=[];},_isCSVLike:function(_18c3){var data=dojo.clone(_18c3);if(data&&dojo.isString(data)&&data.length>0){data=data.replace(/\n/g,"");var rows=data.split("|");if(!rows||rows.length<2){return false;}var _18c4=this._splitterCSVLikeRow(rows[0]);if(!_18c4||_18c4.length<=0){return false;}var _18c5=_18c4.length;for(var i=1;i<rows.length;i++){if(rows[i]==""){break;}var _18c6=this._splitterCSVLikeRow(rows[i]);if(!_18c6||_18c6.length!=_18c5){return false;}}return true;}return false;},_splitterCSVLikeRow:function(_18c7){var cells=_18c7.split(",");var len=cells.length;var i,j,k;for(var m=0;m<len;m++){i=j=-1;for(k=0;k<cells.length;k++){if(i==-1&&cells[k].charAt(0)=="\""&&cells[k].charAt(cells[k].length-1)!="\""){i=k;continue;}if(i>0&&cells[k].charAt(cells[k].length-1)=="\""&&cells[k].charAt(0)!="\""){j=k;break;}}if(i>0&&j>0){var str=cells[i];for(k=i+1;k<j+1;k++){str=str+","+cells[k];}var temp=[];for(k=0;k<i;k++){temp.push(cells[k]);}temp.push(str);for(k=j+1;k<cells.length;k++){temp.push(cells[k]);}cells=temp;}else{break;}}return cells;},_CSVLike2CSV:function(_18c8){var _18c9=["string"];function _inArray(item,_18ca){for(var i=0;i<_18ca.length;i++){if(item.toUpperCase()==_18ca[i].toUpperCase()){return true;}}return false;};function _addTypeInfo(_18cb,_18cc){var i;if(!_18cc){_18cc=[];for(i=0;i<_18cb.length;i++){_18cc.push("text");}}if(_18cb.length!=_18cc.length){throw ("Illegal CSV like data");}for(i=0;i<_18cb.length;i++){_18cb[i]=_18cb[i]+"<"+_18cc[i]+">";}return _18cb;};var data=dojo.clone(_18c8);if(data&&dojo.isString(data)&&data.length>0){data=data.replace(/\n/g,"");var rows=data.split("|");var csv=[];var _18cd;if(rows.length>=2){_18cd=this._splitterCSVLikeRow(rows[0]);var _18ce=this._splitterCSVLikeRow(rows[1]);var i;var _18cf=true;for(i=0;i<_18ce.length;i++){if(!_inArray(_18ce[i],_18c9)){_18cf=false;break;}}if(_18cf){_18cd=_addTypeInfo(_18cd,_18ce);csv.push(_18cd.join(","));for(i=2;i<rows.length;i++){csv.push(rows[i]);}}else{_18cd=_addTypeInfo(_18cd,null);csv.push(_18cd.join(","));for(i=1;i<rows.length;i++){csv.push(rows[i]);}}}else{_18cd=this._splitterCSVLikeRow(rows[0]);_18cd=_addTypeInfo(_18cd,null);csv.push(_18cd.join(","));}return csv.join("\n");}else{throw ("Illegal CSV like data");}},_processData:function(data){this._getArrayOfArraysFromCsvFileContents(data);this._processAttributeTypes();this._arrayOfAllItems=[];for(var i=0;i<this._dataArray.length;i++){this._arrayOfAllItems.push(this._createItemFromIdentity(i));}this._loadFinished=true;this._loadInProgress=false;},_processAttributeTypes:function(){var _18d0=[];this._attributeTypes={};var _18d1,_18d2,_18d3;var myRE=/^(\w|\s)+<(\w|(.\w)+)+>$/;for(index=0;index<this._attributes.length;index++){_18d1=this._attributes[index];if(_18d1.match(myRE)){_18d2=_18d1.indexOf("<");_18d3=_18d1.substring(0,_18d2);_18d0[_18d0.length]=_18d3;this._attributeTypes[_18d3]=_18d1.substring(_18d2+1,_18d1.length-1);this._attributeIndexes[_18d3]=this._attributeIndexes[_18d1];delete this._attributeIndexes[_18d1];}else{_18d0[_18d0.length]=_18d1;this._attributeTypes[_18d1]="text";}}this._attributes=_18d0;},getValueType:function(item,_18d4){return this._attributeTypes[_18d4];},toJson:function(){var obj={};obj.className=this.declaredClass;var json={};json.data=this._csvData;obj.json=dojo.toJson(json);return dojo.toJson(obj);},serialize:function(){var _18d5="";var _18d6,_18d7,_18d8;for(index=0;index<this._attributes.length;index++){_18d6=this._attributes[index];_18d5+=_18d6+"<"+this._attributeTypes[_18d6]+">,";}_18d5+="\n";if(this._dataArray){for(index=0;index<this._dataArray.length;index++){_18d7=this._dataArray[index];if(_18d7){for(index0=0;index0<_18d7.length;index0++){_18d8=_18d7[index0];if(_18d8.indexOf(",")>=0){_18d5+="\""+_18d8+"\",";}else{_18d5+=_18d8+",";}}_18d5+="\n";}}}return _18d5;}});}if(!dojo._hasResource["com.ibm.mm.builder.builderpre"]){dojo._hasResource["com.ibm.mm.builder.builderpre"]=true;dojo.provide("com.ibm.mm.builder.builderpre");dojo["require"]("com.ibm.mashups.enabler.model.Factory");dojo["require"]("com.ibm.mashups.enabler.context.Factory");dojo["require"]("com.ibm.mashups.services.ServiceManager");dojo["require"]("com.ibm.mashups.enabler.services.ConfigService");dojo["require"]("com.ibm.mm.data.datatypes");dojo["require"]("com.ibm.mm.data.table");dojo["require"]("com.ibm.mashups.enabler.EmbeddingGenerator");builderConfig={};(function(){var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);builderConfig.productName=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.PRODUCT_NAME);builderConfig.enablerPath=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT_ENABLER);builderConfig.builderPath=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT_BUILDER);builderConfig.locale=cs.getValue("locale");builderConfig.isBidi=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CLIENT_IS_BIDI);builderConfig.hasHub=false;var _18d9=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.HUB_URL);if(_18d9&&(dojo.trim(_18d9)!="")){builderConfig.hasHub=true;}builderConfig.pageAutoWiringDefault=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.AUTO_WIRING_DEFAULT_ENABLED);builderConfig.sandboxDisabled=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.WIDGETDEFID_SANDBOX_DISABLED);builderConfig.createSpaceOnTemplateMode=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CREATE_SPACE_TEMPLATE_MODE);builderConfig.favoriteSpacesMaximumNumber=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.FAVORITE_SPACES_MAXIMUM_NUMBER);builderConfig.recentSpacesMaximumNumber=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.RECENT_SPACES_MAXIMUM_NUMBER);})();dojo.declare("com.ibm.mm.builder.builderpre",null,{});try{com.ibm.mm.builder.coreWidgetsMessages=dojo.i18n.getLocalization("com.ibm.mm.builder","coreWidgetsMessages");com.ibm.mm.builder.coreWidgetsStrings=dojo.i18n.getLocalization("com.ibm.mm.builder","coreWidgetsStr");}catch(e){com.ibm.mm.builder.coreWidgetsMessages=dojo.i18n.getLocalization("com.ibm.mm.builder","coreWidgetsMessages",ibmConfig["default.locale"]);com.ibm.mm.builder.coreWidgetsStrings=dojo.i18n.getLocalization("com.ibm.mm.builder","coreWidgetsStr",ibmConfig["default.locale"]);}}if(!dojo._hasResource["com.ibm.mashups.builder.IEvent"]){dojo._hasResource["com.ibm.mashups.builder.IEvent"]=true;dojo.provide("com.ibm.mashups.builder.IEvent");dojo.declare("com.ibm.mashups.builder.IEvent",null,{SWITCH_PAGE:"com.ibm.mashups.builder.switchPage",PAGE_SWITCHED:"com.ibm.mashups.builder.pageSwitched",SWITCH_SPACE:"com.ibm.mashups.builder.switchSpace",REFRESH_SPACE_SELECTOR:"com.ibm.mashups.builder.refreshSpaceSelector",REFRESH_NAVIGATION:"com.ibm.mashups.builder.refreshNavigation",REFRESH_PALETTE:"com.ibm.mashups.builder.refreshPalette",LAYOUT_REFRESH:"com.ibm.mashups.builder.layoutRefresh",LAYOUT_REFRESHED:"com.ibm.mashups.builder.layoutRefreshed",REFRESH_CONTEXT_MENU:"com.ibm.mashups.builder.refreshContextMenu",VIEW_HIDDEN_WIDGETS:"com.ibm.mashups.builder.viewHiddenWidgets",HIDE_HIDDEN_WIDGETS:"com.ibm.mashups.builder.hideHiddenWidgets",CHANGE_PAGE_MODE:"com.ibm.mashups.builder.changePageMode",ADD_WIDGET_FROM_TOOLBOX:"com.ibm.mashups.builder.addWidgetFromToolbox",ADD_WIDGET:"com.ibm.mashups.builder.addWidget",RESET_STYLE:"com.ibm.mashups.builder.resetStyle",DISPLAY_WIDGET:"com.ibm.mashups.builder.displayWidget",HIDE_WIDGET:"com.ibm.mashups.builder.hideWidget",RENAME_WIDGET:"com.ibm.mashups.builder.renameWidget",RENAME_ACTION:"com.ibm.mashups.builder.renameAction",MOVE_ACTION:"com.ibm.mashups.builder.moveAction",RESIZE_ACTION:"com.ibm.mashups.builder.resizeAction",CHANGE_SKIN:"com.ibm.mashups.builder.changeSkin",SKIN_LOADED:"com.ibm.mashups.builder.skinLoaded",RESIZE_WIDGET:"com.ibm.mashups.builder.resizeWidget",WIDGET_RESIZED:"com.ibm.mashups.builder.widgetResized",WIDGET_MOVED:"com.ibm.mashups.builder.widgetMoved",WIDGET_DELETED:"com.ibm.mashups.builder.widgetDeleted",EMBED_PAGE:"com.ibm.mashups.builder.embedPage",EMBED_WIDGET:"com.ibm.mashups.builder.embedWidget",LOAD_PAGESOURCE:"com.ibm.mashups.builder.loadPageSource",SAVE_PAGE:"com.ibm.mashups.builder.savePage",EDIT_PAGE:"com.ibm.mashups.builder.editPage",UPDATE_PAGE_TITLE:"com.ibm.mashups.builder.updatePageTitle",HIGHLIGHT_WIDGET:"com.ibm.mashups.builder.highlightWidget",REMOVE_WIDGET_HIGHTLIGHT:"com.ibm.mashups.builder.removeWidgetHighlight",ADD_NEW_WIRE:"com.ibm.mashups.builder.addNewWire",REMOVE_WIRE:"com.ibm.mashups.builder.removeWire",CREATE_AUTO_WIRE:"com.ibm.mashups.builder.createAutoWire",AUTO_WIRE_CREATED:"com.ibm.mashups.builder.autoWireCreated",CREATE_QUICK_WIRE:"com.ibm.mashups.builder.createquickWire",QUICK_WIRE_CREATED:"com.ibm.mashups.builder.quickWireCreated",EDIT_WIRE:"com.ibm.mashups.builder.editWire",DISPLAY_WIRE_GRAPH:"com.ibm.mashups.builder.displayWireGraph",SHARE_PAGE:"com.ibm.mashups.builder.sharePage",SHARE_SPACE:"com.ibm.mashups.builder.shareSpace",PUBLISH_PAGE:"com.ibm.mashups.builder.publishPage",VIEW_MORE_PAGE:"com.ibm.mashups.builder.viewMorePage",DISPLAY_IN_MASHUP_DIALOG:"com.ibm.mashups.builder.displayInMashupDialog",CLOSE_MASHUP_DIALOG:"com.ibm.mashups.builder.closeMashupDialog",STATE_CHANGED:"com.ibm.mashups.builder.stateChanged",OPEN_PAGE:"com.ibm.mashups.builder.openPage",CLOSE_PAGE:"com.ibm.mashups.builder.closePage",CREATE_PAGE:"com.ibm.mashups.builder.createPage",CREATE_SPACE:"com.ibm.mashups.builder.createSpace",EDIT_SPACE:"com.ibm.mashups.builder.editSpace",COPY_SPACE:"com.ibm.mashups.builder.copySpace",CHANGE_SPACE_OWNER:"com.ibm.mashups.builder.changeSpaceOwner",MANAGE_SPACES:"com.ibm.mashups.builder.manageSpaces"});com.ibm.mashups.builder.iEvents=new com.ibm.mashups.builder.IEvent();}if(!dojo._hasResource["dojox.encoding.base64"]){dojo._hasResource["dojox.encoding.base64"]=true;dojo.provide("dojox.encoding.base64");(function(){var p="=";var tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var dxe=dojox.encoding;dxe.base64.encode=function(ba){var s=[],l=ba.length;var rm=l%3;var x=l-rm;for(var i=0;i<x;){var t=ba[i++]<<16|ba[i++]<<8|ba[i++];s.push(tab.charAt((t>>>18)&63));s.push(tab.charAt((t>>>12)&63));s.push(tab.charAt((t>>>6)&63));s.push(tab.charAt(t&63));}switch(rm){case 2:var t=ba[i++]<<16|ba[i++]<<8;s.push(tab.charAt((t>>>18)&63));s.push(tab.charAt((t>>>12)&63));s.push(tab.charAt((t>>>6)&63));s.push(p);break;case 1:var t=ba[i++]<<16;s.push(tab.charAt((t>>>18)&63));s.push(tab.charAt((t>>>12)&63));s.push(p);s.push(p);break;}return s.join("");};dxe.base64.decode=function(str){var s=str.split(""),out=[];var l=s.length;while(s[--l]==p){}for(var i=0;i<l;){var t=tab.indexOf(s[i++])<<18;if(i<=l){t|=tab.indexOf(s[i++])<<12;}if(i<=l){t|=tab.indexOf(s[i++])<<6;}if(i<=l){t|=tab.indexOf(s[i++]);}out.push((t>>>16)&255);out.push((t>>>8)&255);out.push(t&255);}while(out[out.length-1]==0){out.pop();}return out;};})();}if(!dojo._hasResource["com.ibm.mm.catalog.CatalogPane"]){dojo._hasResource["com.ibm.mm.catalog.CatalogPane"]=true;dojo.provide("com.ibm.mm.catalog.CatalogPane");dojo.declare("com.ibm.mm.catalog.CatalogPane",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.catalog.CatalogPane");this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.dlg={};},show:function(_18da,_18db){var _18dc="",_18dd="";try{_18dc=this.getCatalogURL(_18da)||com.ibm.mm.catalog.hubUtil.getHubSecuredUrl();}catch(error){if(this.LOGGER&&this.LOGGER.isLoggable(this.LOG_LEVEL)){this.LOGGER.severe("show",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_MODE_SELECTOR_GET_CATALOG_1,[error.message]));}return;}if(_18dc){if(!_18db){if(!this.dlg[_18dc]){this.dlg[_18dc]=com.ibm.mashups.builder.displayLMDialog(dojo.create("div"),{title:com.ibm.mm.builder.coreWidgetsStrings.I_CATALOG_PANE_TITLE,containerBackgroundColor:"white",nodeWidth:(0.9*screen.availWidth+"px"),nodeHeight:(0.8*screen.availHeight+"px"),displayCloseButton:true,closeCallback:dojo.hitch(this,function(){var _18de=dojo.query("iframe",this.dlg[_18dc].domNode);if(_18de.length>0){var _18df=_18de[0];_18df.src="";if(_18df.attachEvent){_18df.attachEvent("onload",function(){_18df.outerHTML="";_18df=null;});}}})});}else{this.dlg[_18dc].show();}dojo.query(dojo.create("iframe",{src:_18dc},this.dlg[_18dc].containerNode,"only")).style({width:"99.5%",height:"99%",border:"0 none"});}else{window.open(_18dc);}}},getCatalogURL:function(_18e0){var _18e1=([window.location.protocol,"//",window.location.host,builderConfig.enablerPath].join("")),chars=[];for(var i=0,l=_18e1.length;i<l;i++){chars.push(_18e1.charCodeAt(i));}var _18e2=dojox.encoding.base64.encode(chars);switch(_18e0){case com.ibm.mm.catalog.CATALOGCREATEFEEDUI:return encodeURI([com.ibm.mm.catalog.hubUtil.getHubFeedCreationUrl(),"&serverUrl=",_18e2].join(""));case com.ibm.mm.catalog.CATALOGCREATEFEEDMASHUPUI:return encodeURI([com.ibm.mm.catalog.hubUtil.getHubFeedMashupCreationUrl(),"&serverUrl=",_18e2].join(""));default:var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _18e3=cs.getValue("anonymousUser");var _18e4=cs.getValue("securityOff");if(_18e3||_18e4){return encodeURI([com.ibm.mm.catalog.hubUtil.getHubAnonymousUrl(),"?serverUrl=",_18e2].join(""));}else{return encodeURI([com.ibm.mm.catalog.hubUtil.getHubSecuredUrl(),"?serverUrl=",_18e2].join(""));}}}});com.ibm.mm.catalog.CatalogPane=new com.ibm.mm.catalog.CatalogPane();com.ibm.mm.catalog.CATALOGUI=0;com.ibm.mm.catalog.CATALOGUI_NEW_WINDOW=3;com.ibm.mm.catalog.CATALOGCREATEFEEDUI=1;com.ibm.mm.catalog.CATALOGCREATEFEEDMASHUPUI=2;}if(!dojo._hasResource["com.ibm.mashups.builder.Api"]){dojo._hasResource["com.ibm.mashups.builder.Api"]=true;dojo.provide("com.ibm.mashups.builder.Api");com.ibm.mashups.builder.builderTopicHandlers=null;com.ibm.mashups.builder.createLMDialog=function(_18e5,_18e6){return new com.ibm.mm.builder.widget.CustomDialog(_18e6,_18e5);};com.ibm.mashups.builder.displayLMDialog=function(_18e7,_18e8){var dlg=com.ibm.mashups.builder.createLMDialog(_18e7,_18e8);dlg.show();return dlg;};com.ibm.mashups.builder.showWidgetConfigDialog=function(_18e9){var menu=new com.ibm.mm.builder.widget.WidgetMenu({iwidgetId:_18e9});menu.showEditPane();};com.ibm.mashups.builder.closeWidgetConfigDialog=function(_18ea){dojo.publish(com.ibm.mm.builder.eventTopics.Widget_ConfigurationFinished,[_18ea]);};com.ibm.mashups.builder.subscribeBuilderTopics=function(_18eb,obj,_18ec){var _18ed=dojo.subscribe(_18eb,obj,_18ec);if(!com.ibm.mashups.builder.builderTopicHandlers){com.ibm.mashups.builder.builderTopicHandlers=[];}com.ibm.mashups.builder.builderTopicHandlers.push(_18ed);};com.ibm.mashups.builder.clearBuilderTopicHandlers=function(){dojo.forEach(com.ibm.mashups.builder.builderTopicHandlers,dojo.unsubscribe);com.ibm.mashups.builder.builderTopicHandlers=[];};}if(!dojo._hasResource["com.ibm.mashups.builder.model.Page"]){dojo._hasResource["com.ibm.mashups.builder.model.Page"]=true;dojo.provide("com.ibm.mashups.builder.model.Page");dojo.declare("com.ibm.mashups.builder.model.Page",null,{isDirty:function(){return true;},setDirty:function(_18ee){},getID:function(){return "";},setID:function(_18ef){},getPageMode:function(){return "";},setPageMode:function(_18f0){},setAutoWiringEnablement:function(_18f1){},getAutoWiringEnablement:function(){},isAutoWiringEnabled:function(){}});}if(!dojo._hasResource["com.ibm.mashups.builder.model.Theme"]){dojo._hasResource["com.ibm.mashups.builder.model.Theme"]=true;dojo.provide("com.ibm.mashups.builder.model.Theme");dojo.declare("com.ibm.mashups.builder.model.Theme",null,{getID:function(){return "";},setID:function(_18f2){},registerLayout:function(_18f3){},getLayouts:function(){}});}if(!dojo._hasResource["com.ibm.mashups.builder.model.ContextMenuItem"]){dojo._hasResource["com.ibm.mashups.builder.model.ContextMenuItem"]=true;dojo.provide("com.ibm.mashups.builder.model.ContextMenuItem");dojo.declare("com.ibm.mashups.builder.model.ContextMenuItem",null,{isSeparator:false,iconClass:"",description:"",title:"",localized:null,enabled:true,id:"",ordinal:0,actionCallBackFunction:null});}if(!dojo._hasResource["com.ibm.mashups.builder.model.ContextMenuLoader"]){dojo._hasResource["com.ibm.mashups.builder.model.ContextMenuLoader"]=true;dojo.provide("com.ibm.mashups.builder.model.ContextMenuLoader");dojo.declare("com.ibm.mashups.builder.model.ContextMenuLoader",null,{getItems:function(_18f4,_18f5,_18f6,_18f7){},onChange:function(){}});}if(!dojo._hasResource["com.ibm.mashups.builder.model.ContextMenu"]){dojo._hasResource["com.ibm.mashups.builder.model.ContextMenu"]=true;dojo.provide("com.ibm.mashups.builder.model.ContextMenu");dojo.declare("com.ibm.mashups.builder.model.ContextMenu",null,{getContextMenu:function(_18f8,_18f9,_18fa,_18fb){return null;},getContextMenuDeferred:function(_18fc,_18fd,_18fe,_18ff){return null;},registerContextMenu:function(_1900,_1901){},addContribution:function(_1902,_1903,_1904){},removeContribution:function(_1905,id){},getContributions:function(_1906){},registerListener:function(_1907,scope,func){},registerListener:function(_1908,func){},unregisterListener:function(_1909){}});}if(!dojo._hasResource["com.ibm.mashups.builder.model.Runtimemodel"]){dojo._hasResource["com.ibm.mashups.builder.model.Runtimemodel"]=true;dojo.provide("com.ibm.mashups.builder.model.Runtimemodel");dojo.declare("com.ibm.mashups.builder.model.RuntimeModel",null,{getCurrentContextMenu:function(){return new com.ibm.mashups.builder.model.ContextMenu();},getCurrentPage:function(){return new com.ibm.mashups.builder.model.Page();},getCurrentTheme:function(){return new com.ibm.mashups.builder.model.Theme();}});}if(!dojo._hasResource["com.ibm.mashups.builder.model.Factory"]){dojo._hasResource["com.ibm.mashups.builder.model.Factory"]=true;dojo.provide("com.ibm.mashups.builder.model.Factory");dojo.declare("com.ibm.mashups.builder.model.Factory",null,{getRuntimeModel:function(){return new com.ibm.mashups.builder.model.RuntimeModel();},getContextMenuModel:function(){return new com.ibm.mashups.builder.model.ContextMenu();}});}if(!dojo._hasResource["com.ibm.mashups.builder.Model"]){dojo._hasResource["com.ibm.mashups.builder.Model"]=true;dojo.provide("com.ibm.mashups.builder.Model");}if(!dojo._hasResource["com.ibm.mm.builder.eventTopics"]){dojo._hasResource["com.ibm.mm.builder.eventTopics"]=true;dojo.provide("com.ibm.mm.builder.eventTopics");com.ibm.mm.builder.eventTopics={Hidden_Widgets_Correl_Display:"/builder/hwc/display",Page_ModeChanged:"/builder/changeMode",Page_ContentChanged:"pageChanged",Page_OnChanged:"onChangeMode",Page_Save:"/builder/page/save",Update_Page_With_Default_Content:"/builder/page/update",Page_OnSave:"/builder/pageSaved",Goto_Catalog:"/builder/goto/catalog",Open_Catalog:"/builder/open/catalog",Open_Catalog_New_Window:"/builder/open/catalog_new_window",WirePane_OverWidget:"wirePane/moveOverWidget",WirePane_OutWidget:"wirePane/moveOutWidget",Banner_BackgroundChanged:"/builder/backgroundChanged",Banner_BackgroundChangedBack:"/builder/backgroundChangedBack",Widget_ConfigurationFinished:"/widget/action/finished",Widget_Hide:"/widget/action/hide",Widget_Create:"/widget/action/create",Widget_Column_AddOrDel:"/widget/column/addOrDel",Resize_StartSizing:"/startSizing",Resize_StartHeightSizing:"/startHeightSizing",Resize_ChangeSizing:"/changeSizing",Resize_ChangeHeightSizing:"/changeHeightSizing",Resize_EndSizing:"/endSizing",Resize_EndHeightSizing:"/endHeightSizing",Save_Icon_Change:"/saveIconChange",WidgetMenu_Hide:"/widgetMenu/action/hide",UpdateViewPageControl:"/ACL/pageControl/view",UpdatePersonalizePageControl:"/ACL/pageControl/personalize",UpdateEditPageControl:"/ACL/pageControl/edit",UpdateSearchPageControl:"/ACL/pageControl/search",UpdateAllPageControl:"/ACL/pageControl/all",AclDialogHide:"/ACL/dialogHide",Publish_Page_Show:"/publish/page/show",Publish_Page_Hide:"/publish/page/hide",FreeForm_Layout_Loaded:"/freeformlayout/loaded"};com.ibm.mm.builder.Topics=com.ibm.mm.builder.eventTopics;}if(!dojo._hasResource["com.ibm.mm.builder.model.Page"]){dojo._hasResource["com.ibm.mm.builder.model.Page"]=true;dojo.provide("com.ibm.mm.builder.model.Page");dojo.declare("com.ibm.mm.builder.model.PageImpl",[com.ibm.mashups.builder.model.Page],{dirty:false,currentPageId:null,currentPageMode:null,isAutoWiringEnabled:builderConfig.pageAutoWiringDefault,isDirty:function(){return this.dirty;},setDirty:function(_190a){this.dirty=_190a;dojo.publish(com.ibm.mm.builder.eventTopics.Save_Icon_Change,[_190a]);},getID:function(){return this.currentPageId;},setID:function(_190b){this.currentPageId=_190b;},getPageMode:function(){return this.currentPageMode;},setPageMode:function(_190c){this.currentPageMode=_190c;},setAutoWiringEnablement:function(_190d){if(_190d!==null&&(_190d=="true"||_190d=="false"||_190d===true||_190d===false)){this.isAutoWiringEnabled=eval(_190d);}else{this.isAutoWiringEnabled=builderConfig.pageAutoWiringDefault;}},getAutoWiringEnablement:function(){return this.isAutoWiringEnabled;},isAutoWiringEnabled:function(){return this.isAutoWiringEnabled;}});}if(!dojo._hasResource["com.ibm.mm.builder.model.Theme"]){dojo._hasResource["com.ibm.mm.builder.model.Theme"]=true;dojo.provide("com.ibm.mm.builder.model.Theme");dojo.declare("com.ibm.mm.builder.model.ThemeImpl",[com.ibm.mashups.builder.model.Theme],{currentThemeId:null,layouts:null,constructor:function(){this.layouts=[];},_hasRegister:function(_190e){for(var i=0;i<this.layouts.length;i++){if(_190e==this.layouts[i]){return true;}}return false;},registerLayout:function(_190f){if(!this._hasRegister(_190f)){this.layouts.push(_190f);}},getLayouts:function(){return this.layouts;},getID:function(){return this.currentThemeId;},setID:function(_1910){this.currentThemeId=_1910;}});}if(!dojo._hasResource["com.ibm.mm.builder.DeferredImpl"]){dojo._hasResource["com.ibm.mm.builder.DeferredImpl"]=true;dojo.provide("com.ibm.mm.builder.DeferredImpl");dojo.declare("com.ibm.mm.builder.DeferredImpl",[com.ibm.mashups.enabler.Deferred],{constructor:function(_1911,_1912,_1913){this.context=_1911;this.startfn=_1912;this.params=_1913;},setFinishedCallback:function(_1914,_1915){this.finishedCallback2=_1914;this.finishedCallbackParameters2=_1915;return this;},start:function(sync){var mode=(sync||typeof (sync)=="undefined")?true:false;return dojo.hitch(this.context,this.startfn)(this,mode,this.params);},getFinishedCallback:function(){return this.finishedCallback2;},getFinishedCallbackParameters:function(){return this.finishedCallbackParameters2;}});}if(!dojo._hasResource["com.ibm.mm.builder.DelegatedDeferredImpl"]){dojo._hasResource["com.ibm.mm.builder.DelegatedDeferredImpl"]=true;dojo.provide("com.ibm.mm.builder.DelegatedDeferredImpl");dojo.declare("com.ibm.mm.builder.DelegatorDeferredImpl",com.ibm.mm.builder.DeferredImpl,{constructor:function(){this._delegates=[];this._finishedData=[];var me=this;this.finishedCallback2=function(_1916,_1917,_1918){if(!me._restarted||!me._finished){me._finishedData=[_1916,_1917,_1918];me._finished=true;while(me._delegates.length>0){me._fireDelegate(me._delegates.shift());}return me._finish.apply(me,arguments);}};},_finish:function(_1919,_191a,_191b){if(this._hiddenCallback){return this._hiddenCallback.apply(this,arguments);}},setFinishedCallback:function(_191c,_191d){this._hiddenCallback=_191c;this.finishedCallbackParameters2=_191d;return this;},start:function(sync){if(this._started){return;}this._started=true;return this.inherited(arguments);},_restart:function(sync){if(sync&&this._started&&!this._finished){this._restarted=true;this._started=false;return this.start(true);}},_fireDelegate:function(dfd){var data=this._finishedData,cbk=dfd.getFinishedCallback(),parms=dfd.getFinishedCallbackParameters();if(cbk){return cbk(data[0],data[1],parms);}},addDelegate:function(dfd){this._delegates.push(dfd);dfd.delegator=this;if(this._finished){this._fireDelegate(this._delegates.shift());}return this;}});dojo.declare("com.ibm.mm.builder.DelegatedDeferredImpl",com.ibm.mm.builder.DeferredImpl,{delegator:null,setFinishedCallback:function(_191e,_191f){var me=this;this.finishedCallback2=function(_1920,_1921,_1922){if(me._started){me._result=_1920;return _191e.apply(this,arguments);}};this.finishedCallbackParameters2=_191f;return this;},start:function(sync){if(!this.delegator){return;}this._started=true;var mode=(sync||typeof (sync)==="undefined")?true:false;if(this.delegator._finished&&this.finishedCallback2){this.delegator.addDelegate(this);return this._result;}else{if(mode&&this.delegator._started&&!this.delegator._finished){return this.delegator._restart(mode);}else{if(!this.delegator._started){return this.delegator.start(mode);}}}}});}if(!dojo._hasResource["com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlMenuLoader"]){dojo._hasResource["com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlMenuLoader"]=true;dojo.provide("com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlMenuLoader");dojo.declare("com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlLocalized",com.ibm.mashups.enabler.Localized,{ns:{"cm":"http://www.ibm.com/xmlns/prod/sw/context-menu/1.0"},constructor:function(){this._data=[];},getLocales:function(){var ret=[];for(var i=0;i<this._data.length;++i){ret.push(this._data[i].locale);}return ret;},getTitle:function(_1923){var def=0;for(var i=0;i<this._data.length;++i){if(this._data[i].locale.toLowerCase().replace("_","-")==_1923){return this._data[i].title;}else{if(!def&&this._data[i].locale.toLowerCase().replace("_","-")==ibmConfig["default.locale"]){def=i;}}}return (this._data[def]&&this._data[def].title)?this._data[def].title:null;},getDescription:function(_1924){var def=0;for(var i=0;i<this._data.length;++i){if(this._data[i].locale.toLowerCase().replace("_","-")==_1924){return this._data[i].description;}else{if(!def&&this._data[i].locale.toLowerCase().replace("_","-")==ibmConfig["default.locale"]){def=i;}}}return (this._data[def]&&this._data[def].description)?this._data[def].description:null;},setTitles:function(_1925){var XPath=com.ibm.mashups.enabler.xml.XPath;var _1926=XPath.evaluateXPath("cm:title/cm:nls-string",_1925,this.ns);var i=_1926.length;if(i>0){while(--i>=0){var lang=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_1926[i],"xml:lang","lang","http://www.w3.org/XML/1998/namespace");if(lang!==null){var title=_1926[i].firstChild.nodeValue;this._data.push({"locale":lang,"title":title,"description":null});}}}else{_1926=XPath.evaluateXPath("cm:title",_1925,this.ns);if(_1926.length>0){this._data.push({"locale":"en","title":_1926[0].firstChild.nodeValue,"description":null});}}},setTitle:function(title,_1927){_1927.replace(/-/g,"_");for(var i=0;i<this._data.length;++i){if(this._data[i].locale==_1927){this._data[i].title=title;return null;}}var _1928={"locale":_1927,"title":title,"description":null};this._data.push(_1928);return null;},setDescription:function(desc,_1929){for(var i=0;i<this._data.length;++i){if(this._data[i].locale==_1929){this._data[i].description=desc;return null;}}var _192a={"locale":_1929,"title":null,"description":desc};this._data.push(_192a);return null;}});dojo.declare("com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlMenuLoader",com.ibm.mashups.builder.model.ContextMenuLoader,{CONTEXT_MENU_PROVIDER:ibmConfig["ConfigProvider.ContextMenu_Provider"]?ibmConfig["ConfigProvider.ContextMenu_Provider"]:"ContextMenu_Provider",CONFIG_SERVICE_PROPERTY:"contextmenu.xml",ns:{"cm":"http://www.ibm.com/xmlns/prod/sw/context-menu/1.0"},constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.xmlData=null;},getItems:function(_192b,_192c,_192d,_192e){var mname="getItems",lgr=this.LOGGER;lgr.entering(mname,arguments);dfd=new com.ibm.mm.builder.DeferredImpl(this,function(_192f,sync,_1930){var _1931=_192f.getFinishedCallback(),_1932=_192f.getFinishedCallbackParameters(),res;if(!this.xmlData){var dfd=this.getData().setFinishedCallback(dojo.hitch(this,function(_1933,_1934,_1935){res=_1933;if(_1934==200){this.xmlData=_1933;res=this._initMenuItems(_192b,_192c,_192d,_192e);}if(_1931){_1931(res,_1934,_1932);}}));dfd.start(sync);}else{res=this._initMenuItems(_192b,_192c,_192d,_192e);if(_1931){_1931(res,200,_1932);}}return res;});lgr.exiting(mname,arguments);return dfd;},getData:function(){var mname="getData",lgr=this.LOGGER;if(!this._baseLoader){this._baseLoader=new com.ibm.mm.builder.DelegatorDeferredImpl(this,function(_1936,sync,_1937){var _1938=_1936.getFinishedCallback(),_1939=_1936.getFinishedCallbackParameters();lgr.trace(mname,"Start loading remote data");if(this.xmlData){lgr.trace(mname,"Data already loaded ${0}",[this.xmlData]);if(_1938){_1938(this.xmlData,200,_1939);}}else{this._loadFromService(sync,dojo.hitch(this,function(data,_193a,parms){lgr.trace(mname,"Called back from service loader ${0} ${1} ${2}",[typeof (data),_193a,parms]);var res=data;if(_193a==200){res=this.xmlData=dojox.xml.parser.parse(data);lgr.trace(mname,"Data loaded successfully ${0}",[this.xmlData]);}if(_1938){_1938(res,_193a,_1939);}}));}return this.xmlData;});}var dfd=new com.ibm.mm.builder.DelegatedDeferredImpl();this._baseLoader.addDelegate(dfd);return dfd;},_loadFromService:function(sync,_193b){var mname="_loadFromService",lgr=this.LOGGER;lgr.entering(mname,arguments);var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var co=cs.getConfigObject(this.CONTEXT_MENU_PROVIDER);var _193c=this.CONFIG_SERVICE_PROPERTY;var _193d=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_MENU_NAME);if(_193d&&_193d!==""){_193c=_193d;}var _193e=co.getValueDeferred(_193c);_193e.setFinishedCallback(_193b);var res=_193e.start(sync);lgr.exiting(mname,[res]);return res;},_initMenuItems:function(_193f,_1940,_1941,_1942){var mname="_initMenuItems",lgr=this.LOGGER;lgr.entering(mname,arguments);var ret=[];if(this.xmlData){var expr="cm:contextmenu/cm:menu[@definition=\""+_193f+"\"]";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,this.xmlData,this.ns);var _1943=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();if(nodes&&nodes.length>0){expr="cm:contextMenuItem";var _1944=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,nodes[0],this.ns);if(_1944&&_1944.length>0){for(var i=0;i<_1944.length;++i){var _1945=this._getMetaData("cm:meta-data",_1944[i]);_1945=_1945.length===0?null:_1945;if(this._checkVisibility(_1944[i],_1940,_1941,_1945,_1942)){var _1946=this._checkSeparator(_1944[i]);var _1947=this._getLocalized(_1944[i]);var _1948=_1943.getTitle(_1947);var _1949=_1943.getDescription(_1947);var _194a=this._getIconClass(_1944[i]);var _194b=this._getState(_1944[i],_1940,_1941,_1945,_1942);var _194c=this._getFunction("cm:action-handler",_1944[i]);if(_194c){_194c=this._buildMethod(_194c,_1940,_1941,_1945,_1942);}var _194d={"isSeparator":_1946,"localized":_1947,"title":_1948,"description":_1949,"iconClass":_194a===null?"":_194a,"enabled":_194b,"id":_1944[i].getAttribute("id"),"ordinal":_1944[i].getAttribute("ordinal"),"actionCallBackFunction":_194c};ret.push(_194d);}}}}}lgr.exiting(mname,[ret]);return ret;},_checkVisibility:function(_194e,_194f,_1950,_1951,_1952){var _1953=true;var _1954=this._getFunction("cm:visibility-provider",_194e);if(_1954){try{_1953=this._buildMethod(_1954,_194f,_1950,_1951,_1952)();if(_1953===null||_1953===""){_1953=true;}}catch(e){this.LOGGER.severe("_checkVisibility",e,_194e);}}return !!_1953;},_checkSeparator:function(_1955){var _1956=_1955.getAttribute("separator");if(_1956===true||_1956=="true"){return true;}return false;},_getState:function(_1957,_1958,_1959,_195a,_195b){var state=true;var _195c=this._getFunction("cm:state-provider",_1957);if(_195c){try{state=this._buildMethod(_195c,_1958,_1959,_195a,_195b)();if(state===null||state===""){state=true;}}catch(e){this.LOGGER.severe("_getState",e,_1957);}}return !!state;},_buildMethod:function(_195d,_195e,_195f,_1960,_1961){var _1962=null;try{if(_195d.match("^"+"javascript:")=="javascript:"){if(_1961&&_1961.context){_1962=dojo.hitch(_1961.context,function(){return eval(_195d);});}else{_1962=function(){return eval(_195d);};}}else{if(_1961&&_1961.context){_1962=dojo.hitch(_1961.context,function(){return eval(_195d).call(_1961.context,_195e,_195f,_1960,_1961);});}else{_1962=function(){return eval(_195d).call(this,_195e,_195f,_1960,_1961);};}}}catch(e){this.LOGGER.severe("_buildMethod",e,_195d);_1962=function(){};}return _1962;},_getLocalized:function(_1963){var myloc=new com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlLocalized();myloc.setTitles(_1963);nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("cm:description",_1963,this.ns);if(nodes&&nodes.length>0){myloc.setDescription(nodes[0].firstChild.nodeValue,"en");}return myloc;},_getFunction:function(_1964,_1965){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_1964,_1965,this.ns);if(nodes&&nodes.length>0&&nodes[0].firstChild){return nodes[0].firstChild.nodeValue;}return null;},_getIconClass:function(_1966){return _1966.getAttribute("iconClass");},_getMetaData:function(_1967,_1968){var _1969=[];var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_1967,_1968,this.ns);if(nodes&&nodes.length>0){for(var i=0;i<nodes.length;++i){if(nodes[i].firstChild){var _196a={"key":nodes[i].firstChild.nodeValue,"value":nodes[i].firstChild.nodeValue};_1969.push(_196a);}}}return _1969;}});}if(!dojo._hasResource["com.ibm.mm.builder.DeferredListImpl"]){dojo._hasResource["com.ibm.mm.builder.DeferredListImpl"]=true;dojo.provide("com.ibm.mm.builder.DeferredListImpl");dojo.declare("com.ibm.mm.builder.DeferredListImpl",com.ibm.mm.builder.DeferredImpl,{constructor:function(){this._list=[];this._resultList=[];this._status=200;this._numFinished=0;},add:function(){for(var i=0;i<arguments.length;i++){var dfd=arguments[i],cbk=dfd.getFinishedCallback(),_196b=dfd.getFinishedCallbackParameters(),obj={cbk:cbk,params:_196b,dfd:dfd,result:null};dfd.setFinishedCallback(dojo.hitch(this,"_eachBack"),obj);dfd.setFinishedCallback=dojo.hitch(this,"_setOverride",obj);this._list.push(obj);}return this;},_setOverride:function(obj,_196c,_196d){obj.cbk=_196c;obj.params=_196d;return obj.dfd;},_eachBack:function(res,_196e,parms){this._numFinished++;parms.result=[res,_196e,parms.params];if(parms.cbk){parms.cbk(res,_196e,parms.params);}if(this._numFinished===this._list.length){this._done();}},_done:function(){var cbk=this.getFinishedCallback(),_196f=this.getFinishedCallbackParameters();this._resultList=dojo.map(this._list,function(obj){return obj.result;},this);if(cbk){cbk(this._resultList,this._status,_196f);}},start:function(sync){if(!this._started){this._started=true;sync=(sync||typeof (sync)=="undefined")?true:false;dojo.hitch(this.context,this.startfn||function(){})(this,sync,this.params);if(this._list.length>0){dojo.forEach(this._list,function(obj){obj.dfd.start(sync);});}else{this._done();}}return this._resultList;}});}if(!dojo._hasResource["com.ibm.mm.builder.model.ContextMenu"]){dojo._hasResource["com.ibm.mm.builder.model.ContextMenu"]=true;dojo.provide("com.ibm.mm.builder.model.ContextMenu");dojo.declare("com.ibm.mm.builder.model.ContextMenuImpl",[com.ibm.mashups.builder.model.ContextMenu],{_baseTopic:"Builder/ContextMenuImpl",configServiceLoader:new com.ibm.mm.builder.model.contextMenu.ConfigServiceXmlMenuLoader(),constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this._menus={};this._contrIdCounter=0;this.evtSvc=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");this.evtSvc.subscribeEvent("com.ibm.mashups.builder.refreshContextMenu",this,"_fireChange");},getContextMenu:function(_1970,_1971,_1972,_1973){var mname="getContextMenu",lgr=this.LOGGER;lgr.entering(mname,arguments);dojo.deprecated("com.ibm.mashups.builder.model.ContextMenu.getContextMenu","The method com.ibm.mashups.builder.model.ContextMenu.getContextMenu is deprecated, please use com.ibm.mashups.builder.model.ContextMenu.getContextMenuDeferred instead!");var _1974=this.getContextMenuDeferred.apply(this,arguments).start();lgr.exiting(mname,[_1974]);return _1974;},getContextMenuDeferred:function(_1975,_1976,_1977,_1978){var mname="getContextMenuDeferred",lgr=this.LOGGER;lgr.entering(mname,arguments);var _1979=this._getMenuDef(_1975),cnbt=_1979.contributions.slice(),_197a=_1979.base||this.configServiceLoader,_197b=[_1975,_1976,_1977,_1978];var _197c=_197a.getItems.apply(_197a,_197b);var _197d=dojo.map(cnbt,function(_197e){return _197e.loader.getItems.apply(_197e.loader,_197b);},this);var _197f=new com.ibm.mm.builder.DeferredListImpl(this);_197f.add(_197c).add.apply(_197f,_197d);var _1980=new com.ibm.mm.builder.DeferredImpl(this,function(_1981,sync,_1982){var _1983=_1981.getFinishedCallback(),_1984=_1981.getFinishedCallbackParameters(),res,me=this;_197f.setFinishedCallback(function(_1985,_1986,_1987){res=me._mergingCallback.apply(me,arguments);if(_1983){_1983(res,_1986,_1984);}},{contextMenuId:_1975,contributions:cnbt}).start(sync);return res;});lgr.exiting(mname,[_1980]);return _1980;},_mergingCallback:function(_1988,_1989,_198a){var mname="_mergingCallback",lgr=this.LOGGER;lgr.entering(mname,arguments);var _198b=[],len=_1988.length,ret;if(len>0){var _198c=_1988.shift();len--;if(_198c[1]==200){_198b.push(_198c[0]);}else{lgr.severe(mname,com.ibm.mm.builder.coreWidgetsMessages.E_CONTEXT_MENU_FAIL_1,[[_198a.contextMenuId,_198c[0],_198c[1]]]);}}for(var i=0;i<len;i++){if(_1988[i][1]==200){_198b.push(_1988[i][0]);}else{_198a.contributions.splice(i,1);lgr.severe(mname,com.ibm.mm.builder.coreWidgetsMessages.E_CONTEXT_MENU_FAIL_2,[[_198a.contextMenuId,_1988[i][0],_1988[i][1]]]);}}ret=this._mergeItems(_198b,_198a);lgr.exiting(mname,[ret]);return ret;},_mergeItems:function(_198d,_198e){var items=[],i,j,k,len,item,_198f,_1990=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();if(_198d.length>0){items.push.apply(items,_198d[0]);len=_198d.length;for(i=1;i<len;i++){items.push({__isContribution__:true,contribution:_198e.contributions[i-1],ordinal:_198e.contributions[i-1].ordinal,items:_198d[i]});}items.sort(this._sortByOrdinal);for(j=0;j<items.length;j++){item=items[j];if(item.__isContribution__===true){_198f=item.items.sort(this._sortByOrdinal);for(k=0;k<_198f.length;k++){if(_198f[k].localized){if(_198f[k].title==null){_198f[k].title=_1990.getTitle(_198f[k].localized);}if(_198f[k].description==null){_198f[k].description=_1990.getDescription(_198f[k].localized);}}_198f[k].contributionId=item.contribution.id;_198f[k].ordinal=j+k;}items.splice.apply(items,[j,1].concat(_198f));j+=_198f.length-1;}else{item.ordinal=j;}}}return items;},_getMenuDef:function(_1991){if(!this._menus[_1991]){this._menus[_1991]={base:null,changeTimer:null,contributions:[]};}return this._menus[_1991];},_genContrId:function(_1992){return _1992+"_Contribution"+this._contrIdCounter++;},_connectListener:function(_1993,_1994,_1995){_1995.connection=dojo.connect(_1994,"onChange",this,function(){delete _1995.delegator;this._fireChange(_1993);});return _1995.connection;},registerContextMenu:function(_1996,_1997){var mname="registerContextMenu",lgr=this.LOGGER;lgr.entering(mname,arguments);var def=this._getMenuDef(_1996);def.base=_1997;if(_1997){this._connectListener(_1996,_1997,def);}this._fireChange(_1996);lgr.exiting(mname,[true]);return true;},addContribution:function(_1998,_1999,_199a){var mname="addContribution",lgr=this.LOGGER;lgr.entering(mname,arguments);var cnbt=this._getMenuDef(_1998).contributions;var id=null;if(_1999){id=this._genContrId(_1998);var _199b={loader:_1999,ordinal:_199a,id:id};cnbt.push(_199b);cnbt.sort(this._sortByOrdinal);this._connectListener(_1998,_1999,_199b);this._fireChange(_1998);}lgr.exiting(mname,[id]);return id;},removeContribution:function(_199c,id){var mname="removeContribution",lgr=this.LOGGER;lgr.entering(mname,arguments);var cnbt=this._getMenuDef(_199c).contributions,ret=null;if(id){for(var i=0;i<cnbt.length;i++){if(cnbt[i].id===id){ret=cnbt[i].loader;if(cnbt[i].connection){dojo.disconnect(cnbt[i].connection);}cnbt.splice(i,1);break;}}if(ret){this._fireChange(_199c);}}lgr.exiting(mname,[ret]);return ret;},getContributions:function(_199d){var mname="getContributions",lgr=this.LOGGER;lgr.entering(mname,arguments);var cnbt=this._getMenuDef(_199d).contributions,ret=dojo.map(cnbt,function(_199e){return _199e.loader;},this);lgr.exiting(mname,[ret]);return ret;},_sortByOrdinal:function(a,b){return (a.ordinal!=null?a.ordinal:Number.MAX_VALUE)-(b.ordinal!=null?b.ordinal:Number.MAX_VALUE);},registerListener:function(_199f,scope,func){var mname="registerListener",lgr=this.LOGGER;lgr.entering(mname,arguments);if(arguments.length<3){func=scope;scope=dojo.global;}var ret=dojo.subscribe(this._baseTopic+"/"+_199f,scope,func);lgr.exiting(mname,[ret]);return ret;},unregisterListener:function(_19a0){var mname="unregisterListener",lgr=this.LOGGER;lgr.entering(mname,arguments);var ret=dojo.unsubscribe(_19a0);lgr.exiting(mname,[ret]);},_fireChange:function(_19a1){var mname="_fireChange",lgr=this.LOGGER,me=this;lgr.trace(mname,"Queuing event to indicate context menu ${0} has been updated",[_19a1]);var _19a2=this._getMenuDef(_19a1);if(!_19a2.changeTimer){_19a2.changeTimer=setTimeout(function(){lgr.trace(mname,"Firing event to indicate context menu ${0} has been updated",[_19a1]);clearTimeout(_19a2.changeTimer);delete _19a2.changeTimer;dojo.publish(me._baseTopic+"/"+_19a1,[_19a1]);},1);}}});}if(!dojo._hasResource["com.ibm.mm.builder.model.Runtimemodel"]){dojo._hasResource["com.ibm.mm.builder.model.Runtimemodel"]=true;dojo.provide("com.ibm.mm.builder.model.Runtimemodel");dojo.declare("com.ibm.mm.builder.model.RuntimeModelImpl",[com.ibm.mashups.builder.model.RuntimeModel],{page:null,theme:null,contextMenu:null,getCurrentContextMenu:function(){if(!this.contextMenu){this.contextMenu=new com.ibm.mm.builder.model.ContextMenuImpl();}return this.contextMenu;},getCurrentPage:function(){if(!this.page){this.page=new com.ibm.mm.builder.model.PageImpl();}return this.page;},getCurrentTheme:function(){if(!this.theme){this.theme=new com.ibm.mm.builder.model.ThemeImpl();}return this.theme;}});}if(!dojo._hasResource["com.ibm.mm.builder.model.Factory"]){dojo._hasResource["com.ibm.mm.builder.model.Factory"]=true;dojo.provide("com.ibm.mm.builder.model.Factory");dojo.declare("com.ibm.mm.builder.model.FactoryImpl",[com.ibm.mashups.builder.model.Factory],{builderRuntimeModel:null,contextMenuModel:null,getRuntimeModel:function(){if(!this.builderRuntimeModel){this.builderRuntimeModel=new com.ibm.mm.builder.model.RuntimeModelImpl();}return this.builderRuntimeModel;},getContextMenuModel:function(){if(!this.contextMenuModel){this.contextMenuModel=new com.ibm.mm.builder.model.ContextMenuImpl();}return this.contextMenuModel;}});com.ibm.mashups.builder.model.Factory=new com.ibm.mm.builder.model.FactoryImpl();}if(!dojo._hasResource["com.ibm.mm.builder.Model"]){dojo._hasResource["com.ibm.mm.builder.Model"]=true;dojo.provide("com.ibm.mm.builder.Model");}if(!dojo._hasResource["dojo.data.ItemFileReadStore"]){dojo._hasResource["dojo.data.ItemFileReadStore"]=true;dojo.provide("dojo.data.ItemFileReadStore");dojo.declare("dojo.data.ItemFileReadStore",null,{constructor:function(_19a3){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_19a3.url;this._ccUrl=_19a3.url;this.url=_19a3.url;this._jsonData=_19a3.data;this.data=null;this._datatypeMap=_19a3.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(value){return dojo.date.stamp.fromISOString(value);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_19a3.urlPreventCache!==undefined){this.urlPreventCache=_19a3.urlPreventCache?true:false;}if(_19a3.hierarchical!==undefined){this.hierarchical=_19a3.hierarchical?true:false;}if(_19a3.clearOnClose){this.clearOnClose=true;}if("failOk" in _19a3){this.failOk=_19a3.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.");}},_assertIsAttribute:function(_19a4){if(typeof _19a4!=="string"){throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.");}},getValue:function(item,_19a5,_19a6){var _19a7=this.getValues(item,_19a5);return (_19a7.length>0)?_19a7[0]:_19a6;},getValues:function(item,_19a8){this._assertIsItem(item);this._assertIsAttribute(_19a8);return item[_19a8]||[];},getAttributes:function(item){this._assertIsItem(item);var _19a9=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_19a9.push(key);}}return _19a9;},hasAttribute:function(item,_19aa){this._assertIsItem(item);this._assertIsAttribute(_19aa);return (_19aa in item);},containsValue:function(item,_19ab,value){var _19ac=undefined;if(typeof value==="string"){_19ac=dojo.data.util.filter.patternToRegExp(value,false);}return this._containsValue(item,_19ab,value,_19ac);},_containsValue:function(item,_19ad,value,_19ae){return dojo.some(this.getValues(item,_19ad),function(_19af){if(_19af!==null&&!dojo.isObject(_19af)&&_19ae){if(_19af.toString().match(_19ae)){return true;}}else{if(value===_19af){return true;}}});},isItem:function(_19b0){if(_19b0&&_19b0[this._storeRefPropName]===this){if(this._arrayOfAllItems[_19b0[this._itemNumPropName]]===_19b0){return true;}}return false;},isItemLoaded:function(_19b1){return this.isItem(_19b1);},loadItem:function(_19b2){this._assertIsItem(_19b2.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},_fetchItems:function(_19b3,_19b4,_19b5){var self=this;var _19b6=function(_19b7,_19b8){var items=[];var i,key;if(_19b7.query){var value;var _19b9=_19b7.queryOptions?_19b7.queryOptions.ignoreCase:false;var _19ba={};for(key in _19b7.query){value=_19b7.query[key];if(typeof value==="string"){_19ba[key]=dojo.data.util.filter.patternToRegExp(value,_19b9);}else{if(value instanceof RegExp){_19ba[key]=value;}}}for(i=0;i<_19b8.length;++i){var match=true;var _19bb=_19b8[i];if(_19bb===null){match=false;}else{for(key in _19b7.query){value=_19b7.query[key];if(!self._containsValue(_19bb,key,value,_19ba[key])){match=false;}}}if(match){items.push(_19bb);}}_19b4(items,_19b7);}else{for(i=0;i<_19b8.length;++i){var item=_19b8[i];if(item!==null){items.push(item);}}_19b4(items,_19b7);}};if(this._loadFinished){_19b6(_19b3,this._getItemsArray(_19b3.queryOptions));}else{if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_19b3,filter:_19b6});}else{this._loadInProgress=true;var _19bc={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _19bd=dojo.xhrGet(_19bc);_19bd.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;_19b6(_19b3,self._getItemsArray(_19b3.queryOptions));self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_19b5(e,_19b3);}});_19bd.addErrback(function(error){self._loadInProgress=false;_19b5(error,_19b3);});var _19be=null;if(_19b3.abort){_19be=_19b3.abort;}_19b3.abort=function(){var df=_19bd;if(df&&df.fired===-1){df.cancel();df=null;}if(_19be){_19be.call(_19b3);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;_19b6(_19b3,this._getItemsArray(_19b3.queryOptions));}catch(e){_19b5(e,_19b3);}}else{_19b5(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),_19b3);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var fData=this._queuedFetches[i];var _19bf=fData.args;var _19c0=fData.filter;if(_19c0){_19c0(_19bf,this._getItemsArray(_19bf.queryOptions));}else{this.fetchItemByIdentity(_19bf);}}this._queuedFetches=[];}},_getItemsArray:function(_19c1){if(_19c1&&_19c1.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_19c2){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug("dojo.data.ItemFileReadStore: WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_19c3){var _19c4=false;var self=this;function valueIsAnItem(_19c5){var _19c6=((_19c5!==null)&&(typeof _19c5==="object")&&(!dojo.isArray(_19c5)||_19c4)&&(!dojo.isFunction(_19c5))&&(_19c5.constructor==Object||dojo.isArray(_19c5))&&(typeof _19c5._reference==="undefined")&&(typeof _19c5._type==="undefined")&&(typeof _19c5._value==="undefined")&&self.hierarchical);return _19c6;};function addItemAndSubItemsToArrayOfAllItems(_19c7){self._arrayOfAllItems.push(_19c7);for(var _19c8 in _19c7){var _19c9=_19c7[_19c8];if(_19c9){if(dojo.isArray(_19c9)){var _19ca=_19c9;for(var k=0;k<_19ca.length;++k){var _19cb=_19ca[k];if(valueIsAnItem(_19cb)){addItemAndSubItemsToArrayOfAllItems(_19cb);}}}else{if(valueIsAnItem(_19c9)){addItemAndSubItemsToArrayOfAllItems(_19c9);}}}}};this._labelAttr=_19c3.label;var i;var item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_19c3.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(dojo.isArray(item)){_19c4=true;}addItemAndSubItemsToArrayOfAllItems(item);item[this._rootItemPropName]=true;}var _19cc={};var key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var value=item[key];if(value!==null){if(!dojo.isArray(value)){item[key]=[value];}}else{item[key]=[null];}}_19cc[key]=key;}}while(_19cc[this._storeRefPropName]){this._storeRefPropName+="_";}while(_19cc[this._itemNumPropName]){this._itemNumPropName+="_";}while(_19cc[this._reverseRefMap]){this._reverseRefMap+="_";}var _19cd;var _19ce=_19c3.identifier;if(_19ce){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_19ce;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_19cd=item[_19ce];var _19cf=_19cd[0];if(!this._itemsByIdentity[_19cf]){this._itemsByIdentity[_19cf]=item;}else{if(this._jsonFileUrl){throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_19ce+"].  Value collided: ["+_19cf+"]");}else{if(this._jsonData){throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_19ce+"].  Value collided: ["+_19cf+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_19cd=item[key];for(var j=0;j<_19cd.length;++j){value=_19cd[j];if(value!==null&&typeof value=="object"){if(("_type" in value)&&("_value" in value)){var type=value._type;var _19d0=this._datatypeMap[type];if(!_19d0){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(dojo.isFunction(_19d0)){_19cd[j]=new _19d0(value._value);}else{if(dojo.isFunction(_19d0.deserialize)){_19cd[j]=_19d0.deserialize(value._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(value._reference){var _19d1=value._reference;if(!dojo.isObject(_19d1)){_19cd[j]=this._itemsByIdentity[_19d1];}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _19d2=this._arrayOfAllItems[k];var found=true;for(var _19d3 in _19d1){if(_19d2[_19d3]!=_19d1[_19d3]){found=false;}}if(found){_19cd[j]=_19d2;}}}if(this.referenceIntegrity){var _19d4=_19cd[j];if(this.isItem(_19d4)){this._addReferenceToMap(_19d4,item,key);}}}else{if(this.isItem(value)){if(this.referenceIntegrity){this._addReferenceToMap(value,item,key);}}}}}}}},_addReferenceToMap:function(_19d5,_19d6,_19d7){},getIdentity:function(item){var _19d8=this._features["dojo.data.api.Identity"];if(_19d8===Number){return item[this._itemNumPropName];}else{var _19d9=item[_19d8];if(_19d9){return _19d9[0];}}return null;},fetchItemByIdentity:function(_19da){var item;var scope;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_19da});}else{this._loadInProgress=true;var _19db={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _19dc=dojo.xhrGet(_19db);_19dc.addCallback(function(data){var scope=_19da.scope?_19da.scope:dojo.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_19da.identity);if(_19da.onItem){_19da.onItem.call(scope,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_19da.onError){_19da.onError.call(scope,error);}}});_19dc.addErrback(function(error){self._loadInProgress=false;if(_19da.onError){var scope=_19da.scope?_19da.scope:dojo.global;_19da.onError.call(scope,error);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_19da.identity);if(_19da.onItem){scope=_19da.scope?_19da.scope:dojo.global;_19da.onItem.call(scope,item);}}}}else{item=this._getItemByIdentity(_19da.identity);if(_19da.onItem){scope=_19da.scope?_19da.scope:dojo.global;_19da.onItem.call(scope,item);}}},_getItemByIdentity:function(_19dd){var item=null;if(this._itemsByIdentity){item=this._itemsByIdentity[_19dd];}else{item=this._arrayOfAllItems[_19dd];}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _19de=this._features["dojo.data.api.Identity"];if(_19de===Number){return null;}else{return [_19de];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){dojo.deprecated("dojo.data.ItemFileReadStore: ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _19df={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _19e0=dojo.xhrGet(_19df);_19e0.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error("dojo.data.ItemFileReadStore:  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_19e0.addErrback(function(error){throw error;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});dojo.extend(dojo.data.ItemFileReadStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["dojo.data.ItemFileWriteStore"]){dojo._hasResource["dojo.data.ItemFileWriteStore"]=true;dojo.provide("dojo.data.ItemFileWriteStore");dojo.declare("dojo.data.ItemFileWriteStore",dojo.data.ItemFileReadStore,{constructor:function(_19e1){this._features["dojo.data.api.Write"]=true;this._features["dojo.data.api.Notification"]=true;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};if(!this._datatypeMap["Date"].serialize){this._datatypeMap["Date"].serialize=function(obj){return dojo.date.stamp.toISOString(obj,{zulu:true});};}if(_19e1&&(_19e1.referenceIntegrity===false)){this.referenceIntegrity=false;}this._saveInProgress=false;},referenceIntegrity:true,_assert:function(_19e2){if(!_19e2){throw new Error("assertion failed in ItemFileWriteStore");}},_getIdentifierAttribute:function(){var _19e3=this.getFeatures()["dojo.data.api.Identity"];return _19e3;},newItem:function(_19e4,_19e5){this._assert(!this._saveInProgress);if(!this._loadFinished){this._forceLoad();}if(typeof _19e4!="object"&&typeof _19e4!="undefined"){throw new Error("newItem() was passed something other than an object");}var _19e6=null;var _19e7=this._getIdentifierAttribute();if(_19e7===Number){_19e6=this._arrayOfAllItems.length;}else{_19e6=_19e4[_19e7];if(typeof _19e6==="undefined"){throw new Error("newItem() was not passed an identity for the new item");}if(dojo.isArray(_19e6)){throw new Error("newItem() was not passed an single-valued identity");}}if(this._itemsByIdentity){this._assert(typeof this._itemsByIdentity[_19e6]==="undefined");}this._assert(typeof this._pending._newItems[_19e6]==="undefined");this._assert(typeof this._pending._deletedItems[_19e6]==="undefined");var _19e8={};_19e8[this._storeRefPropName]=this;_19e8[this._itemNumPropName]=this._arrayOfAllItems.length;if(this._itemsByIdentity){this._itemsByIdentity[_19e6]=_19e8;_19e8[_19e7]=[_19e6];}this._arrayOfAllItems.push(_19e8);var pInfo=null;if(_19e5&&_19e5.parent&&_19e5.attribute){pInfo={item:_19e5.parent,attribute:_19e5.attribute,oldValue:undefined};var _19e9=this.getValues(_19e5.parent,_19e5.attribute);if(_19e9&&_19e9.length>0){var _19ea=_19e9.slice(0,_19e9.length);if(_19e9.length===1){pInfo.oldValue=_19e9[0];}else{pInfo.oldValue=_19e9.slice(0,_19e9.length);}_19ea.push(_19e8);this._setValueOrValues(_19e5.parent,_19e5.attribute,_19ea,false);pInfo.newValue=this.getValues(_19e5.parent,_19e5.attribute);}else{this._setValueOrValues(_19e5.parent,_19e5.attribute,_19e8,false);pInfo.newValue=_19e8;}}else{_19e8[this._rootItemPropName]=true;this._arrayOfTopLevelItems.push(_19e8);}this._pending._newItems[_19e6]=_19e8;for(var key in _19e4){if(key===this._storeRefPropName||key===this._itemNumPropName){throw new Error("encountered bug in ItemFileWriteStore.newItem");}var value=_19e4[key];if(!dojo.isArray(value)){value=[value];}_19e8[key]=value;if(this.referenceIntegrity){for(var i=0;i<value.length;i++){var val=value[i];if(this.isItem(val)){this._addReferenceToMap(val,_19e8,key);}}}}this.onNew(_19e8,pInfo);return _19e8;},_removeArrayElement:function(array,_19eb){var index=dojo.indexOf(array,_19eb);if(index!=-1){array.splice(index,1);return true;}return false;},deleteItem:function(item){this._assert(!this._saveInProgress);this._assertIsItem(item);var _19ec=item[this._itemNumPropName];var _19ed=this.getIdentity(item);if(this.referenceIntegrity){var _19ee=this.getAttributes(item);if(item[this._reverseRefMap]){item["backup_"+this._reverseRefMap]=dojo.clone(item[this._reverseRefMap]);}dojo.forEach(_19ee,function(_19ef){dojo.forEach(this.getValues(item,_19ef),function(value){if(this.isItem(value)){if(!item["backupRefs_"+this._reverseRefMap]){item["backupRefs_"+this._reverseRefMap]=[];}item["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(value),attr:_19ef});this._removeReferenceFromMap(value,item,_19ef);}},this);},this);var _19f0=item[this._reverseRefMap];if(_19f0){for(var _19f1 in _19f0){var _19f2=null;if(this._itemsByIdentity){_19f2=this._itemsByIdentity[_19f1];}else{_19f2=this._arrayOfAllItems[_19f1];}if(_19f2){for(var _19f3 in _19f0[_19f1]){var _19f4=this.getValues(_19f2,_19f3)||[];var _19f5=dojo.filter(_19f4,function(_19f6){return !(this.isItem(_19f6)&&this.getIdentity(_19f6)==_19ed);},this);this._removeReferenceFromMap(item,_19f2,_19f3);if(_19f5.length<_19f4.length){this._setValueOrValues(_19f2,_19f3,_19f5,true);}}}}}}this._arrayOfAllItems[_19ec]=null;item[this._storeRefPropName]=null;if(this._itemsByIdentity){delete this._itemsByIdentity[_19ed];}this._pending._deletedItems[_19ed]=item;if(item[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,item);}this.onDelete(item);return true;},setValue:function(item,_19f7,value){return this._setValueOrValues(item,_19f7,value,true);},setValues:function(item,_19f8,_19f9){return this._setValueOrValues(item,_19f8,_19f9,true);},unsetAttribute:function(item,_19fa){return this._setValueOrValues(item,_19fa,[],true);},_setValueOrValues:function(item,_19fb,_19fc,_19fd){this._assert(!this._saveInProgress);this._assertIsItem(item);this._assert(dojo.isString(_19fb));this._assert(typeof _19fc!=="undefined");var _19fe=this._getIdentifierAttribute();if(_19fb==_19fe){throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");}var _19ff=this._getValueOrValues(item,_19fb);var _1a00=this.getIdentity(item);if(!this._pending._modifiedItems[_1a00]){var _1a01={};for(var key in item){if((key===this._storeRefPropName)||(key===this._itemNumPropName)||(key===this._rootItemPropName)){_1a01[key]=item[key];}else{if(key===this._reverseRefMap){_1a01[key]=dojo.clone(item[key]);}else{_1a01[key]=item[key].slice(0,item[key].length);}}}this._pending._modifiedItems[_1a00]=_1a01;}var _1a02=false;if(dojo.isArray(_19fc)&&_19fc.length===0){_1a02=delete item[_19fb];_19fc=undefined;if(this.referenceIntegrity&&_19ff){var _1a03=_19ff;if(!dojo.isArray(_1a03)){_1a03=[_1a03];}for(var i=0;i<_1a03.length;i++){var value=_1a03[i];if(this.isItem(value)){this._removeReferenceFromMap(value,item,_19fb);}}}}else{var _1a04;if(dojo.isArray(_19fc)){var _1a05=_19fc;_1a04=_19fc.slice(0,_19fc.length);}else{_1a04=[_19fc];}if(this.referenceIntegrity){if(_19ff){var _1a03=_19ff;if(!dojo.isArray(_1a03)){_1a03=[_1a03];}var map={};dojo.forEach(_1a03,function(_1a06){if(this.isItem(_1a06)){var id=this.getIdentity(_1a06);map[id.toString()]=true;}},this);dojo.forEach(_1a04,function(_1a07){if(this.isItem(_1a07)){var id=this.getIdentity(_1a07);if(map[id.toString()]){delete map[id.toString()];}else{this._addReferenceToMap(_1a07,item,_19fb);}}},this);for(var rId in map){var _1a08;if(this._itemsByIdentity){_1a08=this._itemsByIdentity[rId];}else{_1a08=this._arrayOfAllItems[rId];}this._removeReferenceFromMap(_1a08,item,_19fb);}}else{for(var i=0;i<_1a04.length;i++){var value=_1a04[i];if(this.isItem(value)){this._addReferenceToMap(value,item,_19fb);}}}}item[_19fb]=_1a04;_1a02=true;}if(_19fd){this.onSet(item,_19fb,_19ff,_19fc);}return _1a02;},_addReferenceToMap:function(_1a09,_1a0a,_1a0b){var _1a0c=this.getIdentity(_1a0a);var _1a0d=_1a09[this._reverseRefMap];if(!_1a0d){_1a0d=_1a09[this._reverseRefMap]={};}var _1a0e=_1a0d[_1a0c];if(!_1a0e){_1a0e=_1a0d[_1a0c]={};}_1a0e[_1a0b]=true;},_removeReferenceFromMap:function(_1a0f,_1a10,_1a11){var _1a12=this.getIdentity(_1a10);var _1a13=_1a0f[this._reverseRefMap];var _1a14;if(_1a13){for(_1a14 in _1a13){if(_1a14==_1a12){delete _1a13[_1a14][_1a11];if(this._isEmpty(_1a13[_1a14])){delete _1a13[_1a14];}}}if(this._isEmpty(_1a13)){delete _1a0f[this._reverseRefMap];}}},_dumpReferenceMap:function(){var i;for(i=0;i<this._arrayOfAllItems.length;i++){var item=this._arrayOfAllItems[i];if(item&&item[this._reverseRefMap]){console.log("Item: ["+this.getIdentity(item)+"] is referenced by: "+dojo.toJson(item[this._reverseRefMap]));}}},_getValueOrValues:function(item,_1a15){var _1a16=undefined;if(this.hasAttribute(item,_1a15)){var _1a17=this.getValues(item,_1a15);if(_1a17.length==1){_1a16=_1a17[0];}else{_1a16=_1a17;}}return _1a16;},_flatten:function(value){if(this.isItem(value)){var item=value;var _1a18=this.getIdentity(item);var _1a19={_reference:_1a18};return _1a19;}else{if(typeof value==="object"){for(var type in this._datatypeMap){var _1a1a=this._datatypeMap[type];if(dojo.isObject(_1a1a)&&!dojo.isFunction(_1a1a)){if(value instanceof _1a1a.type){if(!_1a1a.serialize){throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");}return {_type:type,_value:_1a1a.serialize(value)};}}else{if(value instanceof _1a1a){return {_type:type,_value:value.toString()};}}}}return value;}},_getNewFileContentString:function(){var _1a1b={};var _1a1c=this._getIdentifierAttribute();if(_1a1c!==Number){_1a1b.identifier=_1a1c;}if(this._labelAttr){_1a1b.label=this._labelAttr;}_1a1b.items=[];for(var i=0;i<this._arrayOfAllItems.length;++i){var item=this._arrayOfAllItems[i];if(item!==null){var _1a1d={};for(var key in item){if(key!==this._storeRefPropName&&key!==this._itemNumPropName&&key!==this._reverseRefMap&&key!==this._rootItemPropName){var _1a1e=key;var _1a1f=this.getValues(item,_1a1e);if(_1a1f.length==1){_1a1d[_1a1e]=this._flatten(_1a1f[0]);}else{var _1a20=[];for(var j=0;j<_1a1f.length;++j){_1a20.push(this._flatten(_1a1f[j]));_1a1d[_1a1e]=_1a20;}}}}_1a1b.items.push(_1a1d);}}var _1a21=true;return dojo.toJson(_1a1b,_1a21);},_isEmpty:function(_1a22){var empty=true;if(dojo.isObject(_1a22)){var i;for(i in _1a22){empty=false;break;}}else{if(dojo.isArray(_1a22)){if(_1a22.length>0){empty=false;}}}return empty;},save:function(_1a23){this._assert(!this._saveInProgress);this._saveInProgress=true;var self=this;var _1a24=function(){self._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};self._saveInProgress=false;if(_1a23&&_1a23.onComplete){var scope=_1a23.scope||dojo.global;_1a23.onComplete.call(scope);}};var _1a25=function(err){self._saveInProgress=false;if(_1a23&&_1a23.onError){var scope=_1a23.scope||dojo.global;_1a23.onError.call(scope,err);}};if(this._saveEverything){var _1a26=this._getNewFileContentString();this._saveEverything(_1a24,_1a25,_1a26);}if(this._saveCustom){this._saveCustom(_1a24,_1a25);}if(!this._saveEverything&&!this._saveCustom){_1a24();}},revert:function(){this._assert(!this._saveInProgress);var _1a27;for(_1a27 in this._pending._modifiedItems){var _1a28=this._pending._modifiedItems[_1a27];var _1a29=null;if(this._itemsByIdentity){_1a29=this._itemsByIdentity[_1a27];}else{_1a29=this._arrayOfAllItems[_1a27];}_1a28[this._storeRefPropName]=this;for(key in _1a29){delete _1a29[key];}dojo.mixin(_1a29,_1a28);}var _1a2a;for(_1a27 in this._pending._deletedItems){_1a2a=this._pending._deletedItems[_1a27];_1a2a[this._storeRefPropName]=this;var index=_1a2a[this._itemNumPropName];if(_1a2a["backup_"+this._reverseRefMap]){_1a2a[this._reverseRefMap]=_1a2a["backup_"+this._reverseRefMap];delete _1a2a["backup_"+this._reverseRefMap];}this._arrayOfAllItems[index]=_1a2a;if(this._itemsByIdentity){this._itemsByIdentity[_1a27]=_1a2a;}if(_1a2a[this._rootItemPropName]){this._arrayOfTopLevelItems.push(_1a2a);}}for(_1a27 in this._pending._deletedItems){_1a2a=this._pending._deletedItems[_1a27];if(_1a2a["backupRefs_"+this._reverseRefMap]){dojo.forEach(_1a2a["backupRefs_"+this._reverseRefMap],function(_1a2b){var _1a2c;if(this._itemsByIdentity){_1a2c=this._itemsByIdentity[_1a2b.id];}else{_1a2c=this._arrayOfAllItems[_1a2b.id];}this._addReferenceToMap(_1a2c,_1a2a,_1a2b.attr);},this);delete _1a2a["backupRefs_"+this._reverseRefMap];}}for(_1a27 in this._pending._newItems){var _1a2d=this._pending._newItems[_1a27];_1a2d[this._storeRefPropName]=null;this._arrayOfAllItems[_1a2d[this._itemNumPropName]]=null;if(_1a2d[this._rootItemPropName]){this._removeArrayElement(this._arrayOfTopLevelItems,_1a2d);}if(this._itemsByIdentity){delete this._itemsByIdentity[_1a27];}}this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return true;},isDirty:function(item){if(item){var _1a2e=this.getIdentity(item);return new Boolean(this._pending._newItems[_1a2e]||this._pending._modifiedItems[_1a2e]||this._pending._deletedItems[_1a2e]).valueOf();}else{if(!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)){return true;}return false;}},onSet:function(item,_1a2f,_1a30,_1a31){},onNew:function(_1a32,_1a33){},onDelete:function(_1a34){},close:function(_1a35){if(this.clearOnClose){if(!this.isDirty()){this.inherited(arguments);}else{throw new Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");}}}});}if(!dojo._hasResource["com.ibm.mm.builder.utils.userUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.userUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.userUtil");com.ibm.mm.builder.utils.userUtil.isLookasideEnabled=function(_1a36){var _1a37=this.getUserModel().getLookasideAttributeNames().start();if((typeof _1a37=="undefined")||(_1a37===null)||(_1a37.length===0)){return false;}if((typeof _1a36=="undefined")||(_1a36===null)){return true;}for(var i=0;i<_1a37.length;i++){if(_1a36==_1a37[i]){return true;}}return false;};com.ibm.mm.builder.utils.userUtil.getCurrentUser=function(){return this.getUserModel().findCurrentUser().start();};com.ibm.mm.builder.utils.userUtil.getCurrentUserID=function(){return this.getUserModel().findCurrentUser().start().getID();};com.ibm.mm.builder.utils.userUtil.getUserModel=function(){if(com.ibm.mm.builder.userModel===null){com.ibm.mm.builder.userModel=com.ibm.mashups.enabler.model.Factory.getUserModel();}return com.ibm.mm.builder.userModel;};com.ibm.mm.builder.utils.userUtil.getAnonymousMode=function(){return this.getUserModel().getAnonymousMode();};com.ibm.mm.builder.utils.userUtil.isLockedDownAnonymousMode=function(){return this.getAnonymousMode()===com.ibm.mashups.enabler.user.AnonymousMode.ANONYMOUS;};com.ibm.mm.builder.userModel=null;}if(!dojo._hasResource["com.ibm.mm.builder.utils.enablerUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.enablerUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.enablerUtil");com.ibm.mm.builder.utils.enablerUtil.getPageMetaData=function(key,_1a38){var _1a39=null;if(typeof _1a38!="undefined"){_1a39=com.ibm.mm.builder.utils.pageUtil.getPageNode(_1a38);}else{_1a39=com.ibm.mm.builder.utils.pageUtil.getCurrentPageNode();}if(_1a39){var _1a3a=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel().getLayoutModel(_1a39.getID());if(_1a3a){var _1a3b=_1a3a.getRoot().start();if(_1a3b){return _1a3b.getMetaData(key);}}}return null;};com.ibm.mm.builder.utils.enablerUtil.setPageMetaData=function(key,value,_1a3c){var _1a3d=_1a3c?com.ibm.mm.builder.utils.pageUtil.getPageNode(_1a3c):com.ibm.mm.builder.utils.pageUtil.getCurrentPageNode();if(_1a3d){var _1a3e=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1a3f=_1a3e.getLayoutModel(_1a3d.getID());if(_1a3f){var _1a40=_1a3f.getRoot().start();if(_1a40){_1a40.setMetaData(key,value);_1a3e.commit().start();}}}};com.ibm.mm.builder.utils.enablerUtil.setPageJSONMetaData=function(_1a41,_1a42){var _1a43=_1a42?com.ibm.mm.builder.utils.pageUtil.getPageNode(_1a42):com.ibm.mm.builder.utils.pageUtil.getCurrentPageNode();if(_1a43){var _1a44=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1a45=_1a44.getLayoutModel(_1a43.getID());if(_1a45){var _1a46=_1a45.getRoot().start();if(_1a46){for(var key in _1a41){if(Object.prototype.hasOwnProperty.call(_1a41,key)){_1a46.setMetaData(key,_1a41[key]);}}_1a44.commit().start();}}}};com.ibm.mm.builder.utils.enablerUtil.removePageMetaData=function(keys,_1a47){var _1a48=_1a47?com.ibm.mm.builder.utils.pageUtil.getPageNode(_1a47):com.ibm.mm.builder.utils.pageUtil.getCurrentPageNode();if(_1a48){var _1a49=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1a4a=_1a49.getLayoutModel(_1a48.getID());if(_1a4a){var _1a4b=_1a4a.getRoot().start();if(_1a4b){dojo.forEach(keys,function(key){if(key!="com.ibm.mashups.acl.role.USER"&&key!="com.ibm.mashups.acl.role.EDITOR"){_1a4b.removeMetaData(key);}});_1a49.commit().start();}}}};com.ibm.mm.builder.utils.enablerUtil.getUnescapedNodeTitle=function(node,_1a4c){if(!node){return null;}var _1a4d=null;try{var lc=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();_1a4d=lc.getLocale(node);}catch(e){}return node.getTitle(_1a4c||_1a4d||dojo.locale)||node.getTitle(ibmConfig["default.locale"])||"";};com.ibm.mm.builder.utils.enablerUtil.getNodeTitle=function(node,_1a4e){return com.ibm.mm.builder.utils.htmlUtil.escapeString(this.getUnescapedNodeTitle(node,_1a4e));};com.ibm.mm.builder.utils.enablerUtil.getNodeDescription=function(node,_1a4f){if(!node){return null;}var lc=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();return node.getDescription(_1a4f||lc.getLocale(node)||dojo.locale)||"";};}if(!dojo._hasResource["com.ibm.mm.builder.utils.spaceUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.spaceUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.spaceUtil");(function(){var _1a50=com.ibm.mashups.enabler;var _1a51=com.ibm.mm.builder;var _1a52=_1a51.constant;var _1a53=_1a50.strategy;var ef=_1a50.model.Factory;var af=_1a50.model.state.AccessorFactory;var _1a54=_1a51.utils.userUtil;var _1a55=com.ibm.mm.builder.utils.enablerUtil;var cs=com.ibm.mashups.services.ServiceManager.getService(_1a50.services.ConfigService.SERVICE_NAME);var _1a56=com.ibm.mashups.enabler.services.ConfigConstants;var es=com.ibm.mashups.services.ServiceManager.getService("eventService");var cws=com.ibm.mm.builder.coreWidgetsStrings;var _1a57={getSpaceModel:function(_1a58){if(_1a58||!this.spaceModel){var _1a59=ef.getSpaceModel();_1a59.setStrategy(new com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy(5));this.spaceModel=_1a59;}this.currentSpaceNode=null;return this.spaceModel;},getSpaceByNavigation:function(_1a5a){if(_1a5a){return this.getSpaceModel().findSpaceByNavigation(_1a5a).start();}return null;},getSpaceIdByPageId:function(_1a5b){var s=this.getSpaceByNavigation(com.ibm.mm.builder.utils.pageUtil.getPageNode(_1a5b));if(s){return s.getID();}return null;},getCurrentSpaceId:function(){return this.getSpaceAccessor().getSpaceID();},getCurrentSpaceNode:function(){if(!this.currentSpaceNode||this.currentSpaceNode.getID()!==this.getCurrentSpaceId()){this.currentSpaceNode=this.getSpaceNode(this.getCurrentSpaceId());}return this.currentSpaceNode;},setSpaceId:function(sid){this.getSpaceAccessor().setSpaceID(sid);com.ibm.mm.builder.utils.navigationUtil.getNavigationModel().commit().start();if(!sid){dojo.cookie("inPersonalSpace","true");}else{dojo.cookie("inPersonalSpace",null);}},getSpaceAccessor:function(){this.spaceAccessor=this.spaceAccessor||af.getSpaceAccessor(com.ibm.mm.builder.utils.navigationUtil.getNavigationStateModel());return this.spaceAccessor;},getWelcomeSpaceId:function(){return cs.getValue(_1a56.WELCOME_SPACE_ID);},getHomeSpaceId:function(){if(_1a54.isLookasideEnabled("com.ibm.mashups.user.DEFAULT_SPACE")){try{this._homeSpaceId=this._homeSpaceId||_1a54.getCurrentUser().getAttribute("com.ibm.mashups.user.DEFAULT_SPACE");if(this._homeSpaceId==="null"){return null;}if(this._homeSpaceId==="-1"){return null;}return this._homeSpaceId;}catch(e){return null;}}return null;},setHomeSpaceId:function(sid){sid=sid||"-1";this._homeSpaceId=sid;var _1a5c=_1a54.getUserModel();var user=_1a54.getCurrentUser();if(user){user.setAttribute("com.ibm.mashups.user.DEFAULT_SPACE",sid);_1a5c.commit().start();es.broadcastEvent("com.ibm.mashups.builder.refreshSpaceSelector");}},isHomeSpace:function(_1a5d){return this.getHomeSpaceId()===_1a5d;},isWelcomeSpace:function(_1a5e){return this.getWelcomeSpaceId()===_1a5e;},isPersonalSpace:function(_1a5f){return !this.getCurrentSpaceId();},getSpaceTitle:function(_1a60,_1a61){return _1a55.getNodeTitle(this.getSpaceNode(_1a60),_1a61)||this.getPersonalSpaceTitle();},getPersonalSpaceTitle:function(){if(ibmConfig.PERSONAL_SPACE_KEY&&cws[ibmConfig.PERSONAL_SPACE_KEY]){return cws[ibmConfig.PERSONAL_SPACE_KEY];}return cws.I_SPACE_PERSONAL_SPACE;},getSpaceIconURL:function(space){var names=space.getMetaDataNames();for(var i=0;i<names.length;i++){if(names[i]&&(names[i]=="iconUrl"||names[i].search("^{.*}iconUrl$")!==-1)){return space.getMetaData(names[i]);}}return null;},setSpaceIconURL:function(space,_1a62){var names=space.getMetaDataNames();var found=false;for(var i=0;i<names.length;i++){if(names[i]&&(names[i]=="iconUrl"||names[i].search("^{.*}iconUrl$")!==-1)){space.setMetaData(names[i],_1a62);found=true;}}if(!found){space.setMetaData("{http://www.ibm.com/xmlns/prod/lotus/mashups/v1.0/extensions}iconUrl",_1a62);}return;},getSpaceNode:function(_1a63){if(_1a63===this.getCurrentSpaceId()&&this.currentSpaceNode){return this.currentSpaceNode;}_1a63=_1a63||this.getCurrentSpaceId();if(_1a63){return this.getSpaceModel().find(_1a63).start();}},validateSpaceName:function(title){var cwm=com.ibm.mm.builder.coreWidgetsMessages;if(!title){return false;}if(title.length===0){alert(cwm.E_SPACE_UTIL_INVALID_NAME_EMPTY_0);return false;}title=dojo.trim(title);if(title.length===0){alert(cwm.E_SPACE_UTIL_INVALID_NAME_BLANK_0);return false;}if(title.length>=256){alert(cwm.E_SPACE_UTIL_INVALID_NAME_LENGTH_0);return false;}var match=ibmConfig[_1a56.BUILDER_TITLE_FILTER_REGEXP];if(match){if(title.match(match)){alert(cwm.E_SPACE_UTIL_INVALID_NAME_CHAR_0);return false;}}return true;},isVisiable:function(node){if(!node){return false;}if(dojo.isString(node)){node=this.getSpaceNode(node);}if(!node.isHidden()){return true;}return this.isBusinessSpaceServer()?this.canEdit(node):false;},canEdit:function(node){if(!node){return false;}var ac=com.ibm.mm.builder.utils.acModelUtil;return ac.isSpaceOwner(node)||ac.canEditSpace(node);},isBusinessSpaceServer:function(){return cs.getValue(_1a56.SERVER_TYPE)==_1a56.SERVER_TYPE_BSPACE;}};com.ibm.mm.builder.utils.spaceUtil=_1a57;})();}if(!dojo._hasResource["com.ibm.mm.builder.utils.pageUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.pageUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.pageUtil");com.ibm.mm.builder.utils.pageUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.pageUtil");com.ibm.mm.builder.utils.pageUtil.getPageIdFromSpace=function(_1a64){return this.getPageAccessor(_1a64).getPageID();};com.ibm.mm.builder.utils.pageUtil.getFirstPageInSpace=function(_1a65){return this.getFirstChildPageId(com.ibm.mm.builder.utils.navigationUtil.getNavigationRootNodeId(_1a65));};com.ibm.mm.builder.utils.pageUtil.getFirstPageInHomeSpace=function(){var _1a66=com.ibm.mm.builder.utils.spaceUtil.getHomeSpaceId();return this.getFirstChildPageId(com.ibm.mm.builder.utils.navigationUtil.getNavigationRootNodeId(_1a66));};com.ibm.mm.builder.utils.pageUtil.setPageId=function(pid,_1a67){this.getPageAccessor(_1a67||com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId()).setPageID(pid);this.changePageMode("view");};com.ibm.mm.builder.utils.pageUtil.getPageAccessor=function(_1a68){return com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(com.ibm.mm.builder.utils.navigationUtil.getNavigationStateModel(),_1a68);};com.ibm.mm.builder.utils.pageUtil.getPageModeAccessor=function(_1a69){return com.ibm.mashups.enabler.model.state.AccessorFactory.getPageModeAccessor(com.ibm.mm.builder.utils.navigationUtil.getNavigationStateModel());};com.ibm.mm.builder.utils.pageUtil.getCurrentPageMode=function(){return this.getPageModeAccessor(com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId()).getPageMode();};com.ibm.mm.builder.utils.pageUtil.getCurrentPageId=function(){return com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().getID();};com.ibm.mm.builder.utils.pageUtil.getCurrentPageNode=function(){if(!this.currentPageNode||this.currentPageNode.getID()!==this.getCurrentPageId()){this.currentPageNode=this.getPageNode(this.getCurrentPageId());}return this.currentPageNode;};com.ibm.mm.builder.utils.pageUtil.getParentPageId=function(_1a6a){var p=this.getParentPageNode(_1a6a);return (p)?p.getID():null;};com.ibm.mm.builder.utils.pageUtil.getFirstChildPageId=function(_1a6b){var p=this.getFirstChildPage(_1a6b);return (p)?p.getID():null;};com.ibm.mm.builder.utils.pageUtil.getFirstChildPage=function(_1a6c){var page=this.getPageNode(_1a6c);if(page){var _1a6d=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();if(_1a6d.hasChildren(page)){var iter=_1a6d.getChildren(page);while(iter.hasNext()){var node=iter.next();if(this.isVisiable(node)){return node;}}}}return null;};com.ibm.mm.builder.utils.pageUtil.getParentPageNode=function(_1a6e){var _1a6f=null;var _1a70=com.ibm.mm.builder.utils.navigationUtil;var _1a71=com.ibm.mm.builder.utils.spaceUtil;var _1a72=_1a70.getNavigationModel();var pid=this._getPageId(_1a6e);if(pid){_1a6f=_1a72.getParent(pid).start();}return _1a6f||_1a70.getNavigationRootNode(_1a71.getCurrentSpaceId());};com.ibm.mm.builder.utils.pageUtil.getSiblingPages=function(_1a73){return this.getChildPages(this.getParentPageNode(_1a73));};com.ibm.mm.builder.utils.pageUtil.getChildPages=function(page){if(typeof page==="string"){page=this.getPageNode(page);if(!page){return null;}}var _1a74=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();return _1a74.hasChildren(page)?_1a74.getChildren(page):null;};com.ibm.mm.builder.utils.pageUtil.getDefaultPage=function(_1a75){return this.getPageNode(_1a75)||this.getFirstRootPageId();};com.ibm.mm.builder.utils.pageUtil.getDefaultPageId=function(_1a76){var p=this.getDefaultPage(_1a76);if(!p.getID){return p;}return (p)?p.getID():null;};com.ibm.mm.builder.utils.pageUtil.getFirstRootPageId=function(){var utils=com.ibm.mm.builder.utils;var _1a77=utils.navigationUtil.getNavigationRootNodeId(utils.spaceUtil.getCurrentSpaceId());return this.getFirstChildPageId(_1a77);};com.ibm.mm.builder.utils.pageUtil.getCurrentSpacePageIdByPageTitle=function(title,_1a78){var iter=this.getSiblingPages(this.getFirstRootPageId());while(iter.hasNext()){var page=iter.next();if(this.getPageTitle(page.getID(),_1a78)==title){return page.getID();}}return null;};com.ibm.mm.builder.utils.pageUtil.getPageContent=function(_1a79){var _1a7a=this.getPageLayoutModel(_1a79);if(!_1a7a){return null;}var _1a7b=_1a7a.getRoot().start();if(_1a7b){return _1a7b.getFragment();}alert(com.ibm.mm.builder.coreWidgetsMessages.E_NAV_NO_PAGE_OR_NET_DISCONNECT_0);return null;};com.ibm.mm.builder.utils.pageUtil.getPageTitle=function(page,_1a7c){if(!page){return null;}if(dojo.isString(page)){page=this.getPageNode(page);}return com.ibm.mm.builder.utils.enablerUtil.getNodeTitle(page,_1a7c);};com.ibm.mm.builder.utils.pageUtil.getUnescapedPageTitle=function(page,_1a7d){if(!page){return null;}if(dojo.isString(page)){page=this.getPageNode(page);}return com.ibm.mm.builder.utils.enablerUtil.getUnescapedNodeTitle(page,_1a7d);};com.ibm.mm.builder.utils.pageUtil.getCurrentPageTitle=function(_1a7e){return this.getPageTitle(this.getDefaultPageId(),_1a7e);};com.ibm.mm.builder.utils.pageUtil.getPageDescription=function(_1a7f,_1a80){var node=this.getPageNode(_1a7f);return com.ibm.mm.builder.utils.enablerUtil.getNodeDescription(node,_1a80);};com.ibm.mm.builder.utils.pageUtil.getPageLayoutItemSet=function(_1a81){var _1a82=this.getPageLayoutModel(this._getPageId(_1a81));if(!_1a82){return null;}var _1a83=_1a82.getRoot().start();if(_1a83){return _1a83.getMetaData(com.ibm.mm.builder.constant.layoutWidgetItemSet);}return null;};com.ibm.mm.builder.utils.pageUtil.createPage=function(title,_1a84,_1a85){var utils=com.ibm.mm.builder.utils;var _1a86=this.getPageNode(_1a84||this.getParentPageId()||utils.navigationUtil.getNavigationRootNodeId(utils.spaceUtil.getCurrentSpaceId()));var _1a87=utils.navigationUtil.getNavigationModel();var _1a88=_1a87.create(null);_1a88.setTitle(title,dojo.locale);_1a88.setTitle(title,ibmConfig["default.locale"]);var _1a89=utils.themeUtil.getThemeId(_1a86.getID());if(!utils.themeUtil.getThemeModel().find(_1a89).start()){_1a89=utils.themeUtil.getDefaultThemeId();}_1a88.setTheme(_1a89);_1a87.insert(_1a88,_1a86,null);var _1a8a=_1a87.getLayoutModel(_1a88.getID());if(_1a8a){var _1a8b=_1a8a.create();_1a8a.insert(_1a8b);_1a8b.setFragment(" ");var _1a8c=_1a87.commit();var _1a8d=null;_1a8c.setOperationCallback(function(node,_1a8e,_1a8f,_1a90){if(!node&&_1a8f>=400){com.ibm.mm.builder.utils.pageUtil.LOGGER.severe("createPage",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_PUB_API_CREATE_PAGE_1,[_1a8f]));}else{_1a8d=node.getID();}});_1a8c.setFinishedCallback(function(ret,_1a91){if(!_1a8d||_1a91>=400){if(_1a85){_1a85();}com.ibm.mm.builder.utils.pageUtil.LOGGER.severe("createPage",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_PUB_API_CREATE_PAGE_1,[_1a91]));}else{dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid,null,{expires:-1});var es=com.ibm.mashups.services.ServiceManager.getService("eventService");es.broadcastEvent("com.ibm.mashups.builder.pageCreated",_1a8d);es.broadcastEvent("com.ibm.mashups.builder.switchPage",_1a8d);es.broadcastEvent("com.ibm.mashups.builder.spacemanager.pageCreated",_1a8d);}});_1a8c.start(false);}else{this.LOGGER.trace("cannot get layoutmodel");}};com.ibm.mm.builder.utils.pageUtil.updatePage=function(_1a92,_1a93){var _1a94=_1a92?this.getPageNode(_1a92):this.getCurrentPageNode();if(!_1a94){return;}var _1a95=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1a96=false;var _1a97=null;if(_1a93.content){if(_1a95.hasLayoutModel(_1a94)){var _1a98=_1a95.getLayoutModel(_1a94);if(_1a98){var _1a99=_1a98.getRoot().start()||_1a98.create();_1a99.setFragment(_1a93.content);_1a98.insert(_1a99);_1a96=true;}}}if(_1a93.title&&_1a93.title!=this.getPageTitle(_1a94)){if(this.validatePageName(_1a93.title)){_1a94.setTitle(_1a93.title,dojo.locale);_1a96=true;}else{return;}}if(_1a93.description&&_1a93.description!=com.ibm.mm.builder.utils.enablerUtil.getNodeDescription(_1a94)){_1a94.setDescriptione(_1a93.description,dojo.locale);_1a96=true;}var _1a9a=com.ibm.mm.builder.utils.themeUtil.getThemeId(_1a94);if(_1a93.theme&&_1a93.theme!=_1a9a){_1a94.setTheme(_1a93.theme);_1a96=true;}if(_1a9a==="null"){_1a94.setTheme(com.ibm.mm.builder.utils.themeUtil.getDefaultThemeId());_1a96=true;}if(_1a96){_1a95.commit().start();com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setDirty(false);}};com.ibm.mm.builder.utils.pageUtil.saveCurrentPage=function(_1a9b){var _1a9c={};_1a9c.content=_1a9b||this.getPageContent();this.updatePage(null,_1a9c);};com.ibm.mm.builder.utils.pageUtil.deletePage=function(_1a9d){com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setDirty(false);var _1a9e=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();_1a9e.remove(this._getPageId(_1a9d));_1a9e.commit().start();com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setID(null);};com.ibm.mm.builder.utils.pageUtil.isRoot=function(_1a9f){var node=this.getPageNode(_1a9f);var _1aa0=com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId();return !node||node.getID()==com.ibm.mm.builder.utils.navigationUtil.getNavigationRootNodeId(_1aa0);};com.ibm.mm.builder.utils.pageUtil.getPageLayoutModel=function(_1aa1){var _1aa2=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();return _1aa2.getLayoutModel(this._getPageId(_1aa1));};com.ibm.mm.builder.utils.pageUtil.getPageLayoutNode=function(_1aa3){var _1aa4=this.getPageLayoutModel(_1aa3);if(_1aa4){return _1aa4.getRoot().start();}};com.ibm.mm.builder.utils.pageUtil.getPageNode=function(_1aa5){var pid=this._getPageId(_1aa5);if(pid){var _1aa6=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();try{return _1aa6.find(pid).start();}catch(e){return null;}}};com.ibm.mm.builder.utils.pageUtil._getPageId=function(_1aa7){return _1aa7||this.getCurrentPageId();};com.ibm.mm.builder.utils.pageUtil.validatePageName=function(title){var cwm=com.ibm.mm.builder.coreWidgetsMessages;if(!title){return false;}if(title.length===0){alert(cwm.E_PAGE_UTIL_INVALID_NAME_EMPTY_0);return false;}title=dojo.trim(title);if(title.length===0){alert(cwm.E_PAGE_UTIL_INVALID_NAME_BLANK_0);return false;}if(title.length>=256){alert(cwm.E_PAGE_UTIL_INVALID_NAME_LENGTH_0);return false;}var match=ibmConfig[com.ibm.mashups.enabler.services.ConfigConstants.BUILDER_TITLE_FILTER_REGEXP];if(match){if(title.match(match)){alert(cwm.E_PAGE_UTIL_INVALID_NAME_CHAR_0);return false;}}return true;};com.ibm.mm.builder.utils.pageUtil.getEmptyPageMessage=function(msg){var _1aa8="<div class='empty_div'>"+"<div class='empty_outer_div'>"+"<div class='empty_inner_div'>"+com.ibm.mm.builder.utils.htmlUtil.formatMessage(msg)+"</div>"+"</div>"+"</div>";return _1aa8;};com.ibm.mm.builder.utils.pageUtil.encodeBase64=function(str){function unicode2utf8(str){var _1aa9=[];for(var i=0,len=str.length;i<len;i++){var ch=str.charCodeAt(i);if((ch>=1)&&(ch<=127)){_1aa9.push(str.charAt(i));}else{if(ch>2047){_1aa9.push(String.fromCharCode(224|((ch>>12)&15)));_1aa9.push(String.fromCharCode(128|((ch>>6)&63)));_1aa9.push(String.fromCharCode(128|((ch>>0)&63)));}else{_1aa9.push(String.fromCharCode(192|((ch>>6)&31)));_1aa9.push(String.fromCharCode(128|((ch>>0)&63)));}}}return _1aa9.join("");};str=unicode2utf8(str);var _1aaa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var out,i,len;var c1,c2,c3;len=str.length;var i=0;out=[];while(i<len){c1=str.charCodeAt(i++)&255;if(i===len){out.push(_1aaa.charAt(c1>>2));out.push(_1aaa.charAt((c1&3)<<4));out.push("==");break;}c2=str.charCodeAt(i++);if(i===len){out.push(_1aaa.charAt(c1>>2));out.push(_1aaa.charAt(((c1&3)<<4)|((c2&240)>>4)));out.push(_1aaa.charAt((c2&15)<<2));out.push("=");break;}c3=str.charCodeAt(i++);out.push(_1aaa.charAt(c1>>2));out.push(_1aaa.charAt(((c1&3)<<4)|((c2&240)>>4)));out.push(_1aaa.charAt(((c2&15)<<2)|((c3&192)>>6)));out.push(_1aaa.charAt(c3&63));}return out.join("");};com.ibm.mm.builder.utils.pageUtil.isEmptyPage=function(_1aab){if(!_1aab){return true;}return !com.ibm.mm.builder.utils.navigationUtil.getNavigationModel().hasLayoutModel(_1aab);};com.ibm.mm.builder.utils.pageUtil.isVisiable=function(node){if(!node){return false;}if(dojo.isString(node)){node=this.getPageNode(node);}if(!node.isHidden()){return true;}return com.ibm.mm.builder.utils.spaceUtil.isBusinessSpaceServer()?this.canEdit(node):false;};com.ibm.mm.builder.utils.pageUtil.canEdit=function(node){if(!node){return false;}var ac=com.ibm.mm.builder.utils.acModelUtil;if(ac.isPageOwner(node.getID())){return true;}if(ac.getUserPermission(node.getID())===ac.EDIT){return true;}return false;};com.ibm.mm.builder.utils.pageUtil.updatePageTitle=function(){var _1aac=this.getUnescapedPageTitle(this.getCurrentPageId());var _1aad=com.ibm.mashups.enabler.context.Factory.getPageContext();if(_1aad){if(!_1aac||dojo.trim(_1aac)==""){_1aad.setBrowserTitle(builderConfig.productName);}else{_1aad.setBrowserTitle(builderConfig.productName+" - "+_1aac);}}};com.ibm.mm.builder.utils.pageUtil.isGlobalPage=function(){return dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid)&&dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid)!=="null";};com.ibm.mm.builder.utils.pageUtil.savePageWithConfirm=function(_1aae,_1aaf){if(com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().isDirty()){var cws=com.ibm.mm.builder.coreWidgetsStrings;var _1ab0=new com.ibm.mm.builder.dialog.PageSaveConfirmDialog({contentWarning:cws.I_PAGE_SAVE_WARNING,contentQuestion:cws.I_PAGE_SAVE_SUGGEST,btnSaveText:cws.I_COMMON_SAVE,btnNotSaveText:cws.I_PAGE_SAVE_NO_SAVE,btnCancelText:cws.I_PAGE_SAVE_KEEP_EDIT,callbackSave:_1aae,callbackNotSave:_1aae,callbackCancel:_1aaf});_1ab0.show();}else{if(_1aae){_1aae();}}};com.ibm.mm.builder.utils.pageUtil.changePageMode=function(mode){if(mode=="view"||mode=="edit"){com.ibm.mm.builder.utils.pageUtil.getPageModeAccessor().setPageMode(mode);com.ibm.mm.builder.utils.navigationUtil.getNavigationStateModel().commit().start();}};com.ibm.mm.builder.utils.pageUtil.isPageDescriptionLengthExceed=function(_1ab1){var _1ab2=_1ab1.replace(/[^\x00-\xff]/gi,"--").length;var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var _1ab3=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.LIMIT_PAGE_DESCRIPTION);if(_1ab2>_1ab3){return _1ab3;}else{return 0;}};}if(!dojo._hasResource["com.ibm.mm.builder.constant"]){dojo._hasResource["com.ibm.mm.builder.constant"]=true;dojo.provide("com.ibm.mm.builder.constant");com.ibm.mm.builder.constant={appURL:"http://localhost:8080",enablerModelIdPrefix:"id:",iwIWidget:"iw-iWidget",mmIWidget:"mm_iWidget",iwOAGadget:"iw-OAGadget",mmOAGadget:"mm_OAGadget",iwGGadget:"iw-OSGadget",mmGGadget:"mm_OSGadget",osGadgetChrome:"gadgets-gadget-chrome",osGadgetUserPrefs:"gadgets-gadget-user-prefs-dialog",osGadgetContent:"gadgets-gadget-content",iwDefinition:"iw-Definition",mmDefinition:"mm_Definition",iwItemSet:"iw-ItemSet",mmItemSet:"mm_ItemSet",iwItem:"iw-Item",mmItem:"mm_Item",generic_widget_icon:"/mum/images/generic_widget_icon.gif",skinIdPrefix:"mm_ibm_skin_",skinClass:"iWidgetSkin",dragHandler:"_dragHandler",resizeHandler:"_resizer",resizeHandlerExt:"_res",resizeHeightExt:"_heightRes",widgetBody:"_widgetBody",widgetContent:"_content",menuHandler:"_menu",iWidgetContent:"mm_Content",iwWidgetContent:"iw-Content",iWidgetLoading:"mm_loading",iwWidgetLoading:"iw-loading",handledEvents:"mm_handledEvents",event:"mm_event",publishedEvents:"mm_publishedEvents",iwReceivedEvent:"iw-ReceivedEvent",receivedEvent:"mm_ReceivedEvent",iwEvent:"iw-Event",mmEvent:"mm_Event",sourceWidget:"mm_SourceWidget",mmSourceEventName:"mm_SourceEventName",mmTargetEventName:"mm_TargetEventName",iwSourceEvent:"mm_SourceEvent",iwTargetEvent:"mm_TargetEvent",sourceEvent:"mm_SourceEvent",targetEvent:"mm_TargetEvent",itemSet:"mm_itemSet",item:"mm_item",itemName:"mm_itemName",itemValue:"mm_itemValue",configPannelNode:"configPannelNode",widget_span_attr_class:"class",widget_span_attr_widget:"widget",widget_span_attr_style:"style",widget_span_attr_onNewWire:"onnewwire",widget_span_attr_id:"id",widget_span_attr_visible:"visible",widget_span_attr_skin:"skin",nva_skin_upper:"_upper",no_page_message:"No page to show. Please use navigation widget to create a new page.",aclIdPrefix:"_acl",editbarDragHandler:"_dragHandler_editbar",freeformLayoutClass:"freednd",columnLayoutClass:"fixeddnd",HWCClass:"nva",toolboxClass:"toolbox",nvaSkinName:"nva",layoutWidgetItemSet:"LayoutWidgetAttributes",autoWiringEnabled:"com.ibm.mashups.builder.autoWiringEnabled",dbcsEnlarged:"dbcsEnlarged",NavigationPageSize:20,ToolboxPageSize:20,editBarHeight:35,intervalToKeepSessionAlive:5*60*1000,defaultWidgetWidth:400,cookieKey_previous_pid:"digest.ignore.previous_pid",cookieKey_globalPageId:"digest.ignore.global_page_id",cookieKey_globalPageOpenedSpaceId:"digest.ignore.global_page_id_openedSpace"};}if(!dojo._hasResource["com.ibm.mm.builder.utils.navigationUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.navigationUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.navigationUtil");(function(){var _1ab4=com.ibm.mashups.enabler;var _1ab5=com.ibm.mm.builder;var _1ab6=_1ab4.strategy;var ef=_1ab4.model.Factory;var ems=_1ab4.model.state;var af=ems.AccessorFactory;var _1ab7=_1ab5.utils.pageUtil;var _1ab8=_1ab5.utils.userUtil;var _1ab9=_1ab5.utils.spaceUtil;var cs=com.ibm.mashups.services.ServiceManager.getService(_1ab4.services.ConfigService.SERVICE_NAME);var es=com.ibm.mashups.services.ServiceManager.getService("eventService");var _1aba=_1ab4.logging.Logger.getLogger("com.ibm.mm.builder.utils.navigationUtil");var _1abb={getNavigationModel:function(){if(!this._navModel){var _1abc=ef.getNavigationModel();var _1abd=new _1ab6.PageLoadAheadStrategy(true,true,true);var _1abe=new _1ab6.UserLoadAheadStrategy(true);var _1abf=new _1ab6.CatalogCategoryLoadAheadStrategy(true);var _1ac0=new _1ab6.ListLoadAheadStrategy(com.ibm.mm.builder.constant.NavigationPageSize);_1abe.setUserModel(_1ab5.utils.userUtil.getUserModel());_1abf.setCatalogCategoryModel(_1ab5.utils.toolboxUtil.getCatalogModel());var _1ac1=[_1abd,_1ac0,_1abe,_1abf];for(var i=0;i<_1ac1.length;i++){_1abc.addStrategy(_1ac1[i]);}this._navModel=_1abc;com.ibm.mm.builder.utils.pageUtil.currentPageNode=null;this.personalSpaceNavigationRootNode=null;}return this._navModel;},getSharedNavigationModel:function(){if(!this._sharedNavModel){var _1ac2=ef.getSharedNavigationModel();_1ac2.setStrategy(new _1ab4.strategy.ListLoadAheadStrategy(com.ibm.mm.builder.constant.NavigationPageSize));this._sharedNavModel=_1ac2;}return this._sharedNavModel;},getNavigationStateModel:function(){if(!this.navigationStateModel){this.navigationStateModel=ems.NavigationStateModelFactory.getNavigationStateModel();}return this.navigationStateModel;},getNavigationRootNode:function(_1ac3){if(_1ac3){var space=_1ab9.getSpaceModel().find(_1ac3).start();if(space){return _1ab7.getPageNode(space.getRootNavigation().getID());}}return this.getPersonalSpaceNavigationRootNode();},getPersonalSpaceNavigationRootNode:function(){if(!this.personalSpaceNavigationRootNode){this.personalSpaceNavigationRootNode=this.getNavigationModel().getRoot().start();}return this.personalSpaceNavigationRootNode;},getPersonalSpaceNavigationRootId:function(){return this.getPersonalSpaceNavigationRootNode().getID();},getNavigationRootNodeId:function(_1ac4){return this.getNavigationRootNode(_1ac4).getID();},getSharedNavigationRootNode:function(){return this.getSharedNavigationModel().getRoot().start();},getFirstPageNode:function(){if(_1ab8.isLockedDownAnonymousMode()){this.autoAcceptAllPages();}var pid=_1ab7.getPageIdFromSpace();if(dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid)){pid=dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid);dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid,null,{expires:-1});}if(pid){var page=_1ab7.getPageNode(pid);if(page){return page;}else{try{page=this.getSharedNavigationModel().find(pid).start();var _1ac5=this.getNavigationModel();var root=this.getPersonalSpaceNavigationRootNode();_1ac5.insert(page,root,null);_1ac5.commit().start();return _1ac5.find(pid).start();}catch(e){}}}if(this.isLastPageWhenLogin()){if(!pid&&_1ab9.getCurrentSpaceId()){if(_1ab9.getSpaceNode(_1ab9.getCurrentSpaceId())){pid=_1ab7.getFirstPageInSpace(_1ab9.getCurrentSpaceId());return _1ab7.getPageNode(pid);}else{return this.gotoHomeSpace();}}}var sid=_1ab9.getCurrentSpaceId();if(sid){pid=_1ab7.getFirstPageInSpace(sid);if(pid){var apage=_1ab7.getPageNode(pid);if(apage){return apage;}}_1ab9.setSpaceId(sid);return null;}if(dojo.cookie("inPersonalSpace")&&dojo.cookie("inPersonalSpace")!=="null"){return this.gotoPersonalSpace();}return this.gotoHomeSpace();},gotoHomeSpace:function(){var _1ac6=_1ab9.getHomeSpaceId();if(_1ac6&&_1ab9.getSpaceNode(_1ac6)){_1ab9.setSpaceId(_1ac6);var pid=_1ab7.getFirstPageInHomeSpace();if(pid){var page=_1ab7.getPageNode(pid);if(page){return page;}}return null;}var _1ac7=_1ab9.getWelcomeSpaceId();if(_1ac7&&_1ab9.getSpaceNode(_1ac7)){_1ab9.setSpaceId(_1ac7);var wpid=_1ab7.getFirstPageInSpace(_1ac7);if(wpid){var wpage=_1ab7.getPageNode(wpid);if(wpage){return wpage;}}return null;}return this.gotoPersonalSpace();},gotoPersonalSpace:function(){_1ab9.setSpaceId(null);var _1ac8=this.getNavigationModel();var root=this.getPersonalSpaceNavigationRootNode();var pid=_1ab7.getPageIdFromSpace();if(pid){try{var page=this.getSharedNavigationModel().find(pid).start();_1ac8.insert(page,root,null);_1ac8.commit().start();return this.getNavigationModel().find(pid).start();}catch(e){}}if(!_1ac8.hasChildren(root)){this.autoAcceptPagesFromDefaultGroup();}return _1ab7.getFirstChildPage(root.getID());},autoAcceptPagesFromDefaultGroup:function(){var _1ac9=this.getNavigationModel();var _1aca=this.getNavigationRootNode();var _1acb=this.getSharedNavigationModel();var _1acc=this.getSharedNavigationRootNode();var iter=_1acb.getChildren(_1acc);while(iter.hasNext()){var _1acd=iter.next();var _1ace=false;var _1acf=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CLIENT_AUTO_ACCEPT_SHARED_GROUPNAME);if(_1acf=="*"){_1ace=true;}else{_1acb.find(_1acd.getID()).start();var _1ad0=_1acb.getLayoutModel(_1acd.getID());if(_1ad0){var _1ad1=_1ad0.getRoot().start();var _1ad2=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(_1ad1);var _1ad3=com.ibm.mm.builder.utils.acModelUtil.getAllMembersInModel(_1ad2);var _1ad4=_1acf.split(";");for(var i=0,n=_1ad3.length;i<n;i++){var _1ad5=_1ad3[i].getDisplayName();for(var x=0,y=_1ad4.length;x<y;x++){if(_1ad4[x]==_1ad5){_1ace=true;break;}}}}}if(_1ace){var page=_1acb.find(_1acd.getID()).start();_1ac9.insert(page,_1aca);}}_1ac9.commit().start();},autoAcceptAllPages:function(){try{var _1ad6=this.getNavigationModel();var _1ad7=this.getNavigationRootNode();var _1ad8=this.getSharedNavigationModel();var _1ad9=this.getSharedNavigationRootNode();var iter=_1ad8.getChildren(_1ad9);while(iter.hasNext()){_1ad6.insert(iter.next(),_1ad7);}_1ad6.commit().start();}catch(e){console.log(e);}},getRedirectAddress:function(){return _1ab4.model.state.UrlGeneratorFactory.getUrlGenerator().getUrl(this.getNavigationStateModel());},reorderPageNode:function(_1ada,_1adb,_1adc){try{var _1add=this.getNavigationModel();var _1ade=this.getReorderPageContext(_1adb,_1adc),page=_1ab7.getPageNode(_1ada),_1adf=_1ade.parent,next=_1ade.next;if(_1add.confirmInsert(page,_1adf,next)){_1add.insert(page,_1adf,next);_1add.commit().start();es.broadcastEvent("com.ibm.mashups.builder.refreshNavigation");}}catch(e){_1aba.severe("reorderPageNode",e.message);}},getReorderPageContext:function(_1ae0,_1ae1){var _1ae2=this.getNavigationModel(),page=_1ab7.getPageNode(_1ae0),_1ae3=null,next=null;switch(_1ae1){case "previous":_1ae3=_1ae2.getParent(_1ae0).start();next=page;break;case "next":_1ae3=_1ae2.getParent(_1ae0).start();var _1ae4=_1ae2.getChildren(_1ae3);while(_1ae4.hasNext()){var child=_1ae4.next();if(child.getID()===_1ae0){next=_1ae4.next();break;}}break;default:_1ae3=page;}return {parent:_1ae3,next:next};},getPageContext:function(_1ae5){var _1ae6=this.getNavigationModel(),page=_1ab7.getPageNode(_1ae5),_1ae7=null,next=null,_1ae8=null;_1ae7=_1ae6.getParent(_1ae5).start();var _1ae9=_1ae6.getChildren(_1ae7);while(_1ae9.hasNext()){var child=_1ae9.next();if(child.getID()===_1ae5){if(_1ae9.hasNext()){next=_1ae9.next();}break;}_1ae8=child;}return {parent:_1ae7,previous:_1ae8,next:next};},isDescendant:function(_1aea,_1aeb,_1aec){var _1aed=this.getNavigationModel();var _1aee=this.getNavigationRootNodeId();var _1aef=_1aeb;if(!_1aec||_1aec<=0){_1aec=0;}var _1af0=0;while(_1aea!==_1aef){var _1af1=_1aed.getParent(_1aef).start();if(!_1af1){return false;}_1aef=_1af1.getID();_1af0++;if(_1aec>0&&_1af0>=_1aec){break;}if(_1aee===_1aef){break;}}if(_1aec<=0||_1af0==_1aec){return _1aea===_1aef;}else{return false;}},isLastPageWhenLogin:function(){try{var u=com.ibm.mm.builder.utils.userUtil.getCurrentUser();return u.getAttribute("com.ibm.mashups.user.WHERE_TO_GO_WHEN_LOGIN")==="lastpage";}catch(e){return true;}}};com.ibm.mm.builder.utils.navigationUtil=_1abb;})();}if(!dojo._hasResource["com.ibm.mm.builder.utils.acModelUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.acModelUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.acModelUtil");com.ibm.mm.builder.utils.acModelUtil.VIEW=0;com.ibm.mm.builder.utils.acModelUtil.PERSONALIZE=1;com.ibm.mm.builder.utils.acModelUtil.EDIT=2;com.ibm.mm.builder.utils.acModelUtil.OWNER=3;com.ibm.mm.builder.utils.acModelUtil.getUserPermission=function(_1af2){var _1af3=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1af4=_1af3.find(_1af2).start(true);var _1af5=_1af4.getContent().start(true);if(_1af5.confirmSetStaticMarkup("")){return com.ibm.mm.builder.utils.acModelUtil.EDIT;}return com.ibm.mm.builder.utils.acModelUtil.VIEW;};com.ibm.mm.builder.utils.acModelUtil.getPageOwner=function(_1af6){if(!_1af6){return null;}var _1af7=com.ibm.mm.builder.utils.spaceUtil.getSpaceIdByPageId(_1af6);var _1af8=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1af9=_1af8.getLayoutModel(_1af6);var _1afa=_1af9.getRoot().start();var _1afb=null;if(!_1af7){_1afb=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(_1afa);}else{var _1afc=com.ibm.mm.builder.utils.spaceUtil.getSpaceModel();var space=_1afc.find(_1af7).start();_1afb=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(space,_1afa);}var _1afd=_1afb.getOwner();if(_1afd){return _1afd;}return null;};com.ibm.mm.builder.utils.acModelUtil.getSpaceOwner=function(_1afe){var space=com.ibm.mm.builder.utils.spaceUtil.getSpaceNode(_1afe);var _1aff=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(space);return _1aff.getOwner();};com.ibm.mm.builder.utils.acModelUtil.isOwner=function(_1b00){var _1b01=com.ibm.mm.builder.utils.acModelUtil.getPageOwner(_1b00);if(_1b01){var _1b02=com.ibm.mm.builder.utils.userUtil.getCurrentUserID();if(_1b01.getID()==_1b02){return true;}}return false;};com.ibm.mm.builder.utils.acModelUtil.getViewers=function(_1b03){return com.ibm.mm.builder.utils.acModelUtil.getMemberListFromRoleModel(com.ibm.mashups.enabler.ac.RoleType.USER,_1b03);};com.ibm.mm.builder.utils.acModelUtil.getEditors=function(_1b04){return com.ibm.mm.builder.utils.acModelUtil.getMemberListFromRoleModel(com.ibm.mashups.enabler.ac.RoleType.EDITOR,_1b04);};com.ibm.mm.builder.utils.acModelUtil.addViewers=function(_1b05,_1b06){com.ibm.mm.builder.utils.acModelUtil.insertMemberWithRoleType(_1b05,_1b06,com.ibm.mashups.enabler.ac.RoleType.USER);};com.ibm.mm.builder.utils.acModelUtil.addEditors=function(_1b07,_1b08){com.ibm.mm.builder.utils.acModelUtil.insertMemberWithRoleType(_1b07,_1b08,com.ibm.mashups.enabler.ac.RoleType.EDITOR);};com.ibm.mm.builder.utils.acModelUtil.insertMemberWithRoleType=function(_1b09,_1b0a,_1b0b){if(!_1b0a){return;}var _1b0c=_1b09.getRoleModel();var role=com.ibm.mm.builder.utils.acModelUtil.createRole(_1b09,_1b0c,_1b0b);if(role){var _1b0d=_1b0c.getMemberModel(role);if(_1b0d){for(var _1b0e in _1b0a){if(Object.prototype.hasOwnProperty.call(_1b0a,_1b0e)){var _1b0f=_1b0d.create({type:_1b0a[_1b0e],id:_1b0e});_1b0d.insert(_1b0f,null);}}}}};com.ibm.mm.builder.utils.acModelUtil.createRole=function(_1b10,_1b11,_1b12){_1b11.setCursorPosition(0);var _1b13=_1b11.iterator();if(!_1b13){return;}var role=null;while(_1b13.hasNext()){role=_1b13.next();if(!role){continue;}if(role.getRoleType()==_1b12){return role;}}role=_1b11.create({roletype:_1b12});_1b11.insert(role,null);return role;};com.ibm.mm.builder.utils.acModelUtil.getPageAC=function(_1b14){if(!_1b14){return null;}var _1b15=null;var _1b16=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();_1b16.find(_1b14).start();var _1b17=_1b16.getLayoutModel(_1b14);var _1b18=_1b17.getRoot().start();var _1b19=com.ibm.mm.builder.utils.spaceUtil.getSpaceIdByPageId(_1b14);if(_1b19){var _1b1a=com.ibm.mm.builder.utils.spaceUtil.getSpaceModel();var space=_1b1a.find(_1b19).start();_1b15=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(space,_1b18);}else{_1b15=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(_1b18);}return _1b15;};com.ibm.mm.builder.utils.acModelUtil.getPersonalPageAC=function(_1b1b){var _1b1c=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();_1b1c.find(_1b1b).start();var _1b1d=_1b1c.getLayoutModel(_1b1b);var _1b1e=_1b1d.getRoot().start();var _1b1f=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(_1b1e);return _1b1f;};com.ibm.mm.builder.utils.acModelUtil.getSpacePageAC=function(_1b20,_1b21){var _1b22=com.ibm.mm.builder.utils.spaceUtil.getSpaceModel();var space=_1b22.find(_1b20).start();var _1b23=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();_1b23.find(_1b21).start();var _1b24=_1b23.getLayoutModel(_1b21);var _1b25=_1b24.getRoot().start();return com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(space,_1b25);};com.ibm.mm.builder.utils.acModelUtil.canEditSpace=function(_1b26){var space=com.ibm.mm.builder.utils.spaceUtil.getSpaceNode(_1b26);var ea=com.ibm.mashups.enabler.ac.AccessFactory.getEffectiveAccess(space);if(ea.hasRole("editor")||ea.hasRole("manager")){return true;}return false;};com.ibm.mm.builder.utils.acModelUtil.getSpaceAC=function(_1b27){if(!_1b27){return null;}var _1b28=com.ibm.mm.builder.utils.spaceUtil.getSpaceModel();var space=_1b28.find(_1b27).start();return com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(space);};com.ibm.mm.builder.utils.acModelUtil.getAllMembersInModel=function(_1b29){var _1b2a=[];if(_1b29.isInitialized()){var _1b2b=_1b29.getRoleModel();_1b2b.setCursorPosition(0);var _1b2c=_1b2b.iterator();if(_1b2c){while(_1b2c.hasNext()){var role=_1b2c.next();if(!role){continue;}var _1b2d=_1b2b.getMemberModel(role);if(!_1b2d){continue;}_1b2d.setCursorPosition(0);var _1b2e=_1b2d.iterator();if(!_1b2e){continue;}while(_1b2e.hasNext()){var _1b2f=_1b2e.next();if(!_1b2f){continue;}_1b2a.push(_1b2f.getEntity());}}}}return _1b2a;};com.ibm.mm.builder.utils.acModelUtil.getMemberListFromRoleModel=function(_1b30,_1b31){var _1b32=[];if(_1b31.isInitialized()){var _1b33=_1b31.getRoleModel();_1b33.setCursorPosition(0);var _1b34=_1b33.iterator();if(!_1b34){return _1b32;}while(_1b34.hasNext()){var role=_1b34.next();if(!role||(role.getRoleType()!=_1b30)){continue;}var _1b35=_1b33.getMemberModel(role);if(!_1b35){continue;}_1b35.setCursorPosition(0);var _1b36=_1b35.iterator();if(!_1b36){continue;}while(_1b36.hasNext()){var _1b37=_1b36.next();if(!_1b37){continue;}_1b32.push(_1b37.getEntity());}}}return _1b32;};com.ibm.mm.builder.utils.acModelUtil.removeAllMembers=function(_1b38){com.ibm.mm.builder.utils.acModelUtil.removeViewers(_1b38);com.ibm.mm.builder.utils.acModelUtil.removeEditors(_1b38);};com.ibm.mm.builder.utils.acModelUtil.removeViewers=function(_1b39,_1b3a){com.ibm.mm.builder.utils.acModelUtil.removeMembersWithRoleType(_1b39,com.ibm.mashups.enabler.ac.RoleType.USER,_1b3a);};com.ibm.mm.builder.utils.acModelUtil.removeEditors=function(_1b3b,_1b3c){com.ibm.mm.builder.utils.acModelUtil.removeMembersWithRoleType(_1b3b,com.ibm.mashups.enabler.ac.RoleType.EDITOR,_1b3c);};com.ibm.mm.builder.utils.acModelUtil.removeMembersWithRoleType=function(_1b3d,_1b3e,_1b3f){var _1b40=com.ibm.mm.builder.utils.userUtil.getCurrentUserID();var _1b41=(arguments.length==2);if(!_1b41&&!_1b3f){return;}var _1b42=_1b3d.getRoleModel();_1b42.setCursorPosition(0);var _1b43=_1b42.iterator();if(!_1b43){return;}while(_1b43.hasNext()){var role=_1b43.next();if(!role||(role.getRoleType()!=_1b3e)){continue;}var _1b44=_1b42.getMemberModel(role);if(!_1b44){continue;}_1b44.setCursorPosition(0);var _1b45=_1b44.iterator();if(!_1b45){continue;}while(_1b45.hasNext()){var _1b46=_1b45.next();if(!_1b46){continue;}var _1b47=_1b46.getEntity();if(_1b47.getID()!=_1b40){if(!_1b41){for(var id in _1b3f){if((_1b47.getID()==id)&&(_1b47.getEntityType()==_1b3f[id])){_1b44.remove(_1b46);break;}}}else{_1b44.remove(_1b46);}}}}};com.ibm.mm.builder.utils.acModelUtil.isPageOwner=function(_1b48){return this.isOwner(_1b48);};com.ibm.mm.builder.utils.acModelUtil.isSpaceOwner=function(space){if(!space){return false;}if(!space.declaredClass){space=com.ibm.mm.builder.utils.spaceUtil.getSpaceNode(space);}if(space){var owner=this.getSpaceOwner(space.getID());if(owner){return owner.getID()===com.ibm.mm.builder.utils.userUtil.getCurrentUserID();}}return false;};}if(!dojo._hasResource["dojox.uuid._base"]){dojo._hasResource["dojox.uuid._base"]=true;dojo.provide("dojox.uuid._base");dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(_1b49,_1b4a){if(!_1b49){if(!_1b4a){_1b4a="An assert statement failed.\n"+"The method dojox.uuid.assert() was called with a 'false' value.\n";}throw new Error(_1b4a);}};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID;};dojox.uuid.isValid=function(_1b4b){_1b4b=_1b4b.toString();var valid=(dojo.isString(_1b4b)&&(_1b4b.length==36)&&(_1b4b==_1b4b.toLowerCase()));if(valid){var _1b4c=_1b4b.split("-");valid=((_1b4c.length==5)&&(_1b4c[0].length==8)&&(_1b4c[1].length==4)&&(_1b4c[2].length==4)&&(_1b4c[3].length==4)&&(_1b4c[4].length==12));var _1b4d=16;for(var i in _1b4c){var part=_1b4c[i];var _1b4e=parseInt(part,_1b4d);valid=valid&&isFinite(_1b4e);}}return valid;};dojox.uuid.getVariant=function(_1b4f){if(!dojox.uuid._ourVariantLookupTable){var _1b50=dojox.uuid.variant;var _1b51=[];_1b51[0]=_1b50.NCS;_1b51[1]=_1b50.NCS;_1b51[2]=_1b50.NCS;_1b51[3]=_1b50.NCS;_1b51[4]=_1b50.NCS;_1b51[5]=_1b50.NCS;_1b51[6]=_1b50.NCS;_1b51[7]=_1b50.NCS;_1b51[8]=_1b50.DCE;_1b51[9]=_1b50.DCE;_1b51[10]=_1b50.DCE;_1b51[11]=_1b50.DCE;_1b51[12]=_1b50.MICROSOFT;_1b51[13]=_1b50.MICROSOFT;_1b51[14]=_1b50.UNKNOWN;_1b51[15]=_1b50.UNKNOWN;dojox.uuid._ourVariantLookupTable=_1b51;}_1b4f=_1b4f.toString();var _1b52=_1b4f.charAt(19);var _1b53=16;var _1b54=parseInt(_1b52,_1b53);dojox.uuid.assert((_1b54>=0)&&(_1b54<=16));return dojox.uuid._ourVariantLookupTable[_1b54];};dojox.uuid.getVersion=function(_1b55){var _1b56="dojox.uuid.getVersion() was not passed a DCE Variant UUID.";dojox.uuid.assert(dojox.uuid.getVariant(_1b55)==dojox.uuid.variant.DCE,_1b56);_1b55=_1b55.toString();var _1b57=_1b55.charAt(14);var _1b58=16;var _1b59=parseInt(_1b57,_1b58);return _1b59;};dojox.uuid.getNode=function(_1b5a){var _1b5b="dojox.uuid.getNode() was not passed a TIME_BASED UUID.";dojox.uuid.assert(dojox.uuid.getVersion(_1b5a)==dojox.uuid.version.TIME_BASED,_1b5b);_1b5a=_1b5a.toString();var _1b5c=_1b5a.split("-");var _1b5d=_1b5c[4];return _1b5d;};dojox.uuid.getTimestamp=function(_1b5e,_1b5f){var _1b60="dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.";dojox.uuid.assert(dojox.uuid.getVersion(_1b5e)==dojox.uuid.version.TIME_BASED,_1b60);_1b5e=_1b5e.toString();if(!_1b5f){_1b5f=null;}switch(_1b5f){case "string":case String:return dojox.uuid.getTimestamp(_1b5e,Date).toUTCString();break;case "hex":var _1b61=_1b5e.split("-");var _1b62=_1b61[0];var _1b63=_1b61[1];var _1b64=_1b61[2];_1b64=_1b64.slice(1);var _1b65=_1b64+_1b63+_1b62;dojox.uuid.assert(_1b65.length==15);return _1b65;break;case null:case "date":case Date:var _1b66=3394248;var _1b67=16;var _1b68=_1b5e.split("-");var _1b69=parseInt(_1b68[0],_1b67);var _1b6a=parseInt(_1b68[1],_1b67);var _1b6b=parseInt(_1b68[2],_1b67);var _1b6c=_1b6b&4095;_1b6c<<=16;_1b6c+=_1b6a;_1b6c*=4294967296;_1b6c+=_1b69;var _1b6d=_1b6c/10000;var _1b6e=60*60;var _1b6f=_1b66;var _1b70=_1b6f*_1b6e;var _1b71=_1b70*1000;var _1b72=_1b6d-_1b71;var _1b73=new Date(_1b72);return _1b73;break;default:dojox.uuid.assert(false,"dojox.uuid.getTimestamp was not passed a valid returnType: "+_1b5f);break;}};}if(!dojo._hasResource["dojox.uuid"]){dojo._hasResource["dojox.uuid"]=true;dojo.provide("dojox.uuid");}if(!dojo._hasResource["dojox.uuid.Uuid"]){dojo._hasResource["dojox.uuid.Uuid"]=true;dojo.provide("dojox.uuid.Uuid");dojox.uuid.Uuid=function(input){this._uuidString=dojox.uuid.NIL_UUID;if(input){dojox.uuid.assert(dojo.isString(input));this._uuidString=input.toLowerCase();dojox.uuid.assert(this.isValid());}else{var _1b74=dojox.uuid.Uuid.getGenerator();if(_1b74){this._uuidString=_1b74();dojox.uuid.assert(this.isValid());}}};dojox.uuid.Uuid.compare=function(_1b75,_1b76){var _1b77=_1b75.toString();var _1b78=_1b76.toString();if(_1b77>_1b78){return 1;}if(_1b77<_1b78){return -1;}return 0;};dojox.uuid.Uuid.setGenerator=function(_1b79){dojox.uuid.assert(!_1b79||dojo.isFunction(_1b79));dojox.uuid.Uuid._ourGenerator=_1b79;};dojox.uuid.Uuid.getGenerator=function(){return dojox.uuid.Uuid._ourGenerator;};dojox.uuid.Uuid.prototype.toString=function(){return this._uuidString;};dojox.uuid.Uuid.prototype.compare=function(_1b7a){return dojox.uuid.Uuid.compare(this,_1b7a);};dojox.uuid.Uuid.prototype.isEqual=function(_1b7b){return (this.compare(_1b7b)==0);};dojox.uuid.Uuid.prototype.isValid=function(){return dojox.uuid.isValid(this);};dojox.uuid.Uuid.prototype.getVariant=function(){return dojox.uuid.getVariant(this);};dojox.uuid.Uuid.prototype.getVersion=function(){if(!this._versionNumber){this._versionNumber=dojox.uuid.getVersion(this);}return this._versionNumber;};dojox.uuid.Uuid.prototype.getNode=function(){if(!this._nodeString){this._nodeString=dojox.uuid.getNode(this);}return this._nodeString;};dojox.uuid.Uuid.prototype.getTimestamp=function(_1b7c){if(!_1b7c){_1b7c=null;}switch(_1b7c){case "string":case String:return this.getTimestamp(Date).toUTCString();break;case "hex":if(!this._timestampAsHexString){this._timestampAsHexString=dojox.uuid.getTimestamp(this,"hex");}return this._timestampAsHexString;break;case null:case "date":case Date:if(!this._timestampAsDate){this._timestampAsDate=dojox.uuid.getTimestamp(this,Date);}return this._timestampAsDate;break;default:dojox.uuid.assert(false,"The getTimestamp() method dojox.uuid.Uuid was passed a bogus returnType: "+_1b7c);break;}};}if(!dojo._hasResource["dojox.uuid.generateTimeBasedUuid"]){dojo._hasResource["dojox.uuid.generateTimeBasedUuid"]=true;dojo.provide("dojox.uuid.generateTimeBasedUuid");dojox.uuid.generateTimeBasedUuid=function(node){var _1b7d=dojox.uuid.generateTimeBasedUuid._generator.generateUuidString(node);return _1b7d;};dojox.uuid.generateTimeBasedUuid.isValidNode=function(node){var _1b7e=16;var _1b7f=parseInt(node,_1b7e);var valid=dojo.isString(node)&&node.length==12&&isFinite(_1b7f);return valid;};dojox.uuid.generateTimeBasedUuid.setNode=function(node){dojox.uuid.assert((node===null)||this.isValidNode(node));this._uniformNode=node;};dojox.uuid.generateTimeBasedUuid.getNode=function(){return this._uniformNode;};dojox.uuid.generateTimeBasedUuid._generator=new function(){this.GREGORIAN_CHANGE_OFFSET_IN_HOURS=3394248;var _1b80=null;var _1b81=null;var _1b82=null;var _1b83=0;var _1b84=null;var _1b85=null;var _1b86=16;function _carry(_1b87){_1b87[2]+=_1b87[3]>>>16;_1b87[3]&=65535;_1b87[1]+=_1b87[2]>>>16;_1b87[2]&=65535;_1b87[0]+=_1b87[1]>>>16;_1b87[1]&=65535;dojox.uuid.assert((_1b87[0]>>>16)===0);};function _get64bitArrayFromFloat(x){var _1b88=new Array(0,0,0,0);_1b88[3]=x%65536;x-=_1b88[3];x/=65536;_1b88[2]=x%65536;x-=_1b88[2];x/=65536;_1b88[1]=x%65536;x-=_1b88[1];x/=65536;_1b88[0]=x;return _1b88;};function _addTwo64bitArrays(_1b89,_1b8a){dojox.uuid.assert(dojo.isArray(_1b89));dojox.uuid.assert(dojo.isArray(_1b8a));dojox.uuid.assert(_1b89.length==4);dojox.uuid.assert(_1b8a.length==4);var _1b8b=new Array(0,0,0,0);_1b8b[3]=_1b89[3]+_1b8a[3];_1b8b[2]=_1b89[2]+_1b8a[2];_1b8b[1]=_1b89[1]+_1b8a[1];_1b8b[0]=_1b89[0]+_1b8a[0];_carry(_1b8b);return _1b8b;};function _multiplyTwo64bitArrays(_1b8c,_1b8d){dojox.uuid.assert(dojo.isArray(_1b8c));dojox.uuid.assert(dojo.isArray(_1b8d));dojox.uuid.assert(_1b8c.length==4);dojox.uuid.assert(_1b8d.length==4);var _1b8e=false;if(_1b8c[0]*_1b8d[0]!==0){_1b8e=true;}if(_1b8c[0]*_1b8d[1]!==0){_1b8e=true;}if(_1b8c[0]*_1b8d[2]!==0){_1b8e=true;}if(_1b8c[1]*_1b8d[0]!==0){_1b8e=true;}if(_1b8c[1]*_1b8d[1]!==0){_1b8e=true;}if(_1b8c[2]*_1b8d[0]!==0){_1b8e=true;}dojox.uuid.assert(!_1b8e);var _1b8f=new Array(0,0,0,0);_1b8f[0]+=_1b8c[0]*_1b8d[3];_carry(_1b8f);_1b8f[0]+=_1b8c[1]*_1b8d[2];_carry(_1b8f);_1b8f[0]+=_1b8c[2]*_1b8d[1];_carry(_1b8f);_1b8f[0]+=_1b8c[3]*_1b8d[0];_carry(_1b8f);_1b8f[1]+=_1b8c[1]*_1b8d[3];_carry(_1b8f);_1b8f[1]+=_1b8c[2]*_1b8d[2];_carry(_1b8f);_1b8f[1]+=_1b8c[3]*_1b8d[1];_carry(_1b8f);_1b8f[2]+=_1b8c[2]*_1b8d[3];_carry(_1b8f);_1b8f[2]+=_1b8c[3]*_1b8d[2];_carry(_1b8f);_1b8f[3]+=_1b8c[3]*_1b8d[3];_carry(_1b8f);return _1b8f;};function _padWithLeadingZeros(_1b90,_1b91){while(_1b90.length<_1b91){_1b90="0"+_1b90;}return _1b90;};function _generateRandomEightCharacterHexString(){var _1b92=Math.floor((Math.random()%1)*Math.pow(2,32));var _1b93=_1b92.toString(_1b86);while(_1b93.length<8){_1b93="0"+_1b93;}return _1b93;};this.generateUuidString=function(node){if(node){dojox.uuid.assert(dojox.uuid.generateTimeBasedUuid.isValidNode(node));}else{if(dojox.uuid.generateTimeBasedUuid._uniformNode){node=dojox.uuid.generateTimeBasedUuid._uniformNode;}else{if(!_1b80){var _1b94=32768;var _1b95=Math.floor((Math.random()%1)*Math.pow(2,15));var _1b96=(_1b94|_1b95).toString(_1b86);_1b80=_1b96+_generateRandomEightCharacterHexString();}node=_1b80;}}if(!_1b81){var _1b97=32768;var _1b98=Math.floor((Math.random()%1)*Math.pow(2,14));_1b81=(_1b97|_1b98).toString(_1b86);}var now=new Date();var _1b99=now.valueOf();var _1b9a=_get64bitArrayFromFloat(_1b99);if(!_1b84){var _1b9b=_get64bitArrayFromFloat(60*60);var _1b9c=_get64bitArrayFromFloat(dojox.uuid.generateTimeBasedUuid._generator.GREGORIAN_CHANGE_OFFSET_IN_HOURS);var _1b9d=_multiplyTwo64bitArrays(_1b9c,_1b9b);var _1b9e=_get64bitArrayFromFloat(1000);_1b84=_multiplyTwo64bitArrays(_1b9d,_1b9e);_1b85=_get64bitArrayFromFloat(10000);}var _1b9f=_1b9a;var _1ba0=_addTwo64bitArrays(_1b84,_1b9f);var _1ba1=_multiplyTwo64bitArrays(_1ba0,_1b85);if(now.valueOf()==_1b82){_1ba1[3]+=_1b83;_carry(_1ba1);_1b83+=1;if(_1b83==10000){while(now.valueOf()==_1b82){now=new Date();}}}else{_1b82=now.valueOf();_1b83=1;}var _1ba2=_1ba1[2].toString(_1b86);var _1ba3=_1ba1[3].toString(_1b86);var _1ba4=_padWithLeadingZeros(_1ba2,4)+_padWithLeadingZeros(_1ba3,4);var _1ba5=_1ba1[1].toString(_1b86);_1ba5=_padWithLeadingZeros(_1ba5,4);var _1ba6=_1ba1[0].toString(_1b86);_1ba6=_padWithLeadingZeros(_1ba6,3);var _1ba7="-";var _1ba8="1";var _1ba9=_1ba4+_1ba7+_1ba5+_1ba7+_1ba8+_1ba6+_1ba7+_1b81+_1ba7+node;_1ba9=_1ba9.toLowerCase();return _1ba9;};}();}if(!dojo._hasResource["com.ibm.mm.builder.WidgetCreator"]){dojo._hasResource["com.ibm.mm.builder.WidgetCreator"]=true;dojo.provide("com.ibm.mm.builder.WidgetCreator");dojo.declare("com.ibm.mm.builder.WidgetCreator",null,{widgetSkin:null,widgetDefXML:null,onNewWire:null,widgetType:null,uid:null,widgetTitle:null,systemWidget:null,widgetParam:null,configPanelNodeName:null,constructor:function(_1baa,_1bab,_1bac){this.uid=_1baa;this.itemSet=_1bac;if(typeof _1bab!="undefined"){this.widgetDefXML=_1bab.getDefinitionURL(false);var _1bad=_1bab.getMetadata("onNewWire");if(_1bad==""){this.onNewWire="null";}else{this.onNewWire=_1bad;}var _1bae=_1bab.getMetadata("widgetType");if(_1bae==""){this.widgetType=null;}else{this.widgetType=_1bae;}this.widgetTitle=com.ibm.mm.builder.utils.enablerUtil.getNodeTitle(_1bab);this.systemWidget=false;this.widgetParam=this._jsonObj(_1bab.getMetadata("widgetParam"));this.istrusted=com.ibm.mm.builder.utils.iwidgetUtil.isTrustedWidget(_1bab.getID());this.autowire=_1bab.getMetadata("com.ibm.mashups.builder.autoWiringEnabled");}},_jsonObj:function(_1baf){return (_1baf)?dojo.fromJson(_1baf):{};},setWidgetSkin:function(_1bb0){this.widgetSkin=_1bb0;},getConfigPanelNodeName:function(){return this.configPanelNodeName;},createRootSpan:function(){var _1bb1=document.createElement("span");if(this.widgetType){dojo.addClass(_1bb1,this.widgetType);}else{dojo.addClass(_1bb1,com.ibm.mm.builder.constant.mmIWidget);}_1bb1.setAttribute(com.ibm.mm.builder.constant.widget_span_attr_id,""+this.uid);_1bb1.setAttribute(com.ibm.mm.builder.constant.widget_span_attr_skin,this.widgetSkin);com.ibm.mm.builder.utils.iWidgetSpecUtil.setWidgetDefXML(_1bb1,this.widgetDefXML);if(!this.istrusted){_1bb1.setAttribute("sandbox","true");}if(this.autowire=="true"){_1bb1.setAttribute("autowiringenabled","true");}return _1bb1;},createParamsElement:function(){var param=null;if(this.widgetParam&&this.widgetParam.length){param=com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetSpan();dojo.forEach(this.widgetParam,function(item){com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetKeyValue(param,item.itemName,item.itemValue);});}if(this.itemSet){param=param||com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetSpan();for(var key in this.itemSet){if(Object.prototype.hasOwnProperty.call(this.itemSet,key)){var ii=dojo.query("[href='#"+key+"']",param);if(ii&&ii[0]){ii[0].innerHTML=this.itemSet[key];}else{com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetKeyValue(param,key,this.itemSet[key]);}}}}return param;},getWidget:function(){var param=this.createParamsElement();var root=this.createRootSpan();if(param!==null){root.appendChild(param);}return root;}});}if(!dojo._hasResource["com.ibm.mm.builder.utils.iwidgetUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.iwidgetUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.iwidgetUtil");com.ibm.mm.builder.utils.iwidgetUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.iwidgetUtil");com.ibm.mm.builder.utils.iwidgetUtil.getWidgetFragment=function(_1bb2){var _1bb3=this._getUid();var _1bb4=com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(_1bb2);var _1bb5=new com.ibm.mm.builder.WidgetCreator(_1bb3,_1bb4);var _1bb6=_1bb5.getWidget();var _1bb7=com.ibm.mm.builder.utils.htmlUtil.getElementString(_1bb6);return _1bb7;};com.ibm.mm.builder.utils.iwidgetUtil.dumpItemSetsToJSON=function(att){var obj={};dojo.forEach(att.getAllNames(),function(name){obj[name]=att.getItemValue(name);});return dojo.toJson(obj);};com.ibm.mm.builder.utils.iwidgetUtil.loadItemSetsFromJSON=function(att,_1bb8){if(_1bb8){var obj=dojo.fromJson(_1bb8);for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){att.setItemValue(key,obj[key],false);}}}};com.ibm.mm.builder.utils.iwidgetUtil.loadItemSetsFromJSONObject=function(att,_1bb9){if(_1bb9){for(var key in _1bb9){if(Object.prototype.hasOwnProperty.call(_1bb9,key)){att.setItemValue(key,_1bb9[key],false);}}}};com.ibm.mm.builder.utils.iwidgetUtil.getWidgetInstanceIcon=function(_1bba){var _1bbb=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bba);if(!_1bbb){return com.ibm.mm.builder.constant.generic_widget_icon;}else{var _1bbc=_1bbb.getIWidgetInstance().getIDescriptorItems().getItemValue("icon");var _1bbd=com.ibm.mashups.enabler.utils.EndpointHelper.resolve(_1bbc);var _1bbe=_1bbd||com.ibm.mm.builder.constant.generic_widget_icon;if(builderConfig.isBidi){return this.getRtlIconUrl(_1bbe);}return _1bbe;}};com.ibm.mm.builder.utils.iwidgetUtil.getOriginalWidgetInstanceTitle=function(_1bbf){var _1bc0=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bbf);if(!_1bc0){return null;}var idi=_1bc0.getIWidgetInstance().getIDescriptorItems();return unescape(idi.getItemValue("title",dojo.locale)||idi.getItemValue("title",ibmConfig["default.locale"]));};com.ibm.mm.builder.utils.iwidgetUtil.getWidgetInstanceTitle=function(_1bc1){return com.ibm.mm.builder.utils.htmlUtil.escapeString(this.getOriginalWidgetInstanceTitle(_1bc1));};com.ibm.mm.builder.utils.iwidgetUtil.saveWidgetInstanceTitleAndIcon=function(_1bc2,title,_1bc3){this.saveWidgetInstanceTitle(_1bc2,title,dojo.locale);this.saveWidgetInstanceIcon(_1bc2,_1bc3);};com.ibm.mm.builder.utils.iwidgetUtil.saveWidgetInstanceTitle=function(_1bc4,title,_1bc5){var _1bc6=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bc4);if(_1bc6){var _1bc7="-";var _1bc8=_1bc5.split("-");if(_1bc8.length==1){_1bc8=_1bc5.split("_");_1bc7="_";}if(_1bc8.length>=2){_1bc8[1]=_1bc8[1].toUpperCase();}var _1bc9="";for(var i=0;i<_1bc8.length;i++){_1bc9=_1bc9+_1bc8[i];if(i<_1bc8.length-1){_1bc9=_1bc9+_1bc7;}}var _1bca=_1bc6.getIWidgetInstance();var md=_1bca.getIDescriptorItems();md.setItemValue("title",escape(title),false,_1bc9);com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().commit().start();}};com.ibm.mm.builder.utils.iwidgetUtil.formatWidgetTitle=function(title){if(!title){return "";}return title.replace(/^(&nbsp;)*/,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");};com.ibm.mm.builder.utils.iwidgetUtil.saveWidgetInstanceIcon=function(_1bcb,_1bcc){var _1bcd=this.getiWidgetWrapper(_1bcb);var md=_1bcd.getIDescriptorItems();if(!_1bcc){_1bcc="/mum/images/generic_widget_icon.gif";}md.setItemValue("icon",_1bcc);com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().commit().start();};com.ibm.mm.builder.utils.iwidgetUtil.getRtlIconUrl=function(_1bce){if(!_1bce||_1bce.match("_rtl")){return _1bce;}var _1bcf=_1bce;var _1bd0=this.getRtlIconToTest(_1bce);try{var xhr=this.getXhr();if(xhr&&_1bd0){xhr.onreadystatechange=function(){};xhr.open("HEAD",_1bd0,false);xhr.send(null);if(xhr.readyState==4&&xhr.status==200){_1bcf=_1bd0;}}}catch(err){}return _1bcf;};com.ibm.mm.builder.utils.iwidgetUtil.getRtlIconToTest=function(_1bd1){if(!_1bd1){return _1bd1;}var index=_1bd1.lastIndexOf(".");var _1bd2=_1bd1.substr(0,index);var _1bd3=_1bd1.substr(index+1);return _1bd2.concat("_rtl.",_1bd3);};com.ibm.mm.builder.utils.iwidgetUtil.getXhr=function(){if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(err){return;}}}else{if(window.XMLHttpRequest){return new XMLHttpRequest();}}};com.ibm.mm.builder.utils.iwidgetUtil.getiWidgetWrapper=function(_1bd4){return com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bd4).getIWidgetInstance();};com.ibm.mm.builder.utils.iwidgetUtil.updateWidgetIDescriptor=function(_1bd5,_1bd6){var _1bd7=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bd5);if(_1bd7){var _1bd8=_1bd7.getIWidgetInstance();var md=_1bd8.getIDescriptorItems();var _1bd9=_1bd6.getIconURL(false);if(!_1bd9){_1bd9="/mum/images/generic_widget_icon.gif";}md.setItemValue("icon",_1bd9);dojo.forEach(_1bd6.getLocales(),function(l){md.setItemValue("title",escape(_1bd6.getTitle(l)),false,l);});com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().commit().start();}};com.ibm.mm.builder.utils.iwidgetUtil.definitionMap={};com.ibm.mm.builder.utils.iwidgetUtil.updateWidgetInstance=function(_1bda,_1bdb){var self=com.ibm.mm.builder.utils.iwidgetUtil;if(_1bdb){self.definitionMap[_1bda.id]=_1bdb;}dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[_1bda,false,function(_1bdc,_1bdd){},function(_1bde,_1bdf,_1be0){var _1be1=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bda.id);if(_1be1){var wdid=self.definitionMap[_1bda.id];if(wdid){var _1be2=com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(wdid);self.updateWidgetIDescriptor(_1bda.id,_1be2);self.definitionMap[_1bda.id]=null;}com.ibm.mm.builder.utils.skinUtil.updateTitleAndIcon(_1bda.id);}}]);};com.ibm.mm.builder.utils.iwidgetUtil.getWidgetXMLURL=function(_1be3){var def=dojo.query(".mm_Definition",dojo.byId(_1be3))[0];if(!def){def=dojo.query(".iw-Definition",dojo.byId(_1be3))[0];}if(def){return def.getAttribute("href");}else{return "";}};com.ibm.mm.builder.utils.iwidgetUtil._getUid=function(){return "ns_"+dojox.uuid.generateTimeBasedUuid().replace(/\-/g,"");};com.ibm.mm.builder.utils.iwidgetUtil.loadWidgets=function(div,_1be4){dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[div,false,function(_1be5,_1be6){var _1be7=_1be6.length;var _1be8=0;var cb=function(){_1be8++;if(_1be8==_1be7){if(_1be4){_1be4();}}};dojo.forEach(_1be6,function(tag){var _1be9=tag.getAttribute("lazyLoad");if(!_1be9||(_1be9&&_1be9!="true")){dojo.subscribe(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+tag.id,this,cb);}else{cb();}});},function(_1bea,_1beb,_1bec){}]);};com.ibm.mm.builder.utils.iwidgetUtil.createWidgetSpan=function(_1bed,_1bee){var _1bef=com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(_1bed);if(!_1bef){com.ibm.mm.builder.utils.iwidgetUtil.LOGGER.severe("createWidgetSpan",com.ibm.mm.builder.coreWidgetsMessages.E_DND_CREATEWIDGET_0);return;}var uid=this._getUid();var _1bf0=new com.ibm.mm.builder.WidgetCreator(uid,_1bef,_1bee);var _1bf1=com.ibm.mm.builder.freeLayOutBean||com.ibm.mm.builder.columnLayoutBean;if(_1bf1){_1bf0.setWidgetSkin(_1bf1.getSelectedSkin());}else{_1bf0.setWidgetSkin(com.ibm.mm.builder.utils.skinUtil.getDefaultSkinId());}return _1bf0.getWidget();};com.ibm.mm.builder.utils.iwidgetUtil.toggleMarkedSandboxWidget=function(_1bf2){var tu=com.ibm.mm.builder.utils.toolboxUtil;tu.getWidgetDefinition(_1bf2).setMetadata("sandbox_user",this.isMarkedSandboxWidget(_1bf2)?"false":"true");tu.getCatalogModel().commit().start();};com.ibm.mm.builder.utils.iwidgetUtil.isMarkedSandboxWidget=function(_1bf3){return "true"==com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(_1bf3).getMetadata("sandbox_user");};com.ibm.mm.builder.utils.iwidgetUtil.isSandboxWidget=function(_1bf4){return "true"==com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(_1bf4).getMetadata("sandbox_definition");};com.ibm.mm.builder.utils.iwidgetUtil.isDisabledSandboxWidget=function(_1bf5){if(!this.diabledSandboxList){if(dojo.isString(builderConfig.sandboxDisabled)){this.diabledSandboxList=[builderConfig.sandboxDisabled];}else{this.diabledSandboxList=builderConfig.sandboxDisabled;}}if(this.diabledSandboxList.length===0){return false;}var _1bf6=com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(_1bf5).getDefinitionURL(false);for(var i=0;i<this.diabledSandboxList.length;i++){if(dojo.trim(_1bf6)===dojo.trim(this.diabledSandboxList[i])){return true;}else{if(dojo.trim(_1bf6).indexOf(dojo.trim(this.diabledSandboxList[i]))!==-1&&dojo.trim(this.diabledSandboxList[i]).indexOf("/")!==0){return true;}else{if(dojo.trim(_1bf6).indexOf(dojo.trim(this.diabledSandboxList[i]))!==-1&&dojo.trim(this.diabledSandboxList[i]).indexOf("/")===0&&dojo.trim(_1bf6).indexOf(":")!==-1){var buf=_1bf6.split("//");var _1bf7=buf[0];var buf2=buf[1].split("/");var host=buf2[0];if(_1bf7==window.location.protocol&&window.location.host==host){return true;}else{if(_1bf7==window.location.protocol&&_1bf7=="http:"&&host.indexOf(window.location.host)===0){if(host.substr(host.indexOf(":")+1)=="80"){return true;}}else{if(_1bf7==window.location.protocol&&_1bf7=="https:"&&host.indexOf(window.location.host)===0){if(host.substr(host.indexOf(":")+1)=="443"){return true;}}}}}}}}return false;};com.ibm.mm.builder.utils.iwidgetUtil.isTrustedWidget=function(_1bf8){return this.isDisabledSandboxWidget(_1bf8)||!(this.isSandboxWidget(_1bf8)||this.isMarkedSandboxWidget(_1bf8));};com.ibm.mm.builder.utils.iwidgetUtil.invokeCallbackByWidgetInstanceId=function(_1bf9,_1bfa){var _1bfb=null;if(!_1bf9||!_1bfa){return _1bfb;}var wm=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1bf9);if(wm&&wm.loaded){_1bfa();}else{var _1bfc=com.ibm.mashups.services.ServiceManager.getService("eventService");_1bfb=_1bfc.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_1bf9,null,_1bfa);}return _1bfb;};com.ibm.mm.builder.utils.iwidgetUtil.hideWidget=function(_1bfd){var _1bfe=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1bfd);if(_1bfe){_1bfe.style.display="none";}};com.ibm.mm.builder.utils.iwidgetUtil.showWidget=function(_1bff){var _1c00=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1bff);if(_1c00){_1c00.style.display="";}};com.ibm.mm.builder.utils.iwidgetUtil.getWidgetSpanByMetadata=function(_1c01,_1c02){var param=null;var _1c03=dojo.fromJson(_1c01.widgetParam);var _1c04={id:_1c01.id,_md:_1c01};_1c04.getID=function(){return this._md.id;};_1c04.getTitle=function(_1c05){if(!this._md.title){return null;}return this._md.title[_1c05];};_1c04.getLocales=function(){if(!this._md.title){return [];}if(!this.locales){this.locales=[];for(var l in this._md.title){if(Object.prototype.hasOwnProperty.call(this._md.title,l)){this.locales.push(l);}}}return this.locales;};_1c04.getIconURL=function(){return this._md.icon;};com.ibm.mm.builder.utils.toolboxUtil.setWidgetDefinition(_1c04);if(_1c03&&_1c03.length){param=com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetSpan();dojo.forEach(_1c03,function(item){com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetKeyValue(param,item.itemName,item.itemValue);});}if(_1c02){param=param||com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetSpan();for(var key in _1c02){if(Object.prototype.hasOwnProperty.call(_1c02,key)){var ii=dojo.query("[href='#"+key+"']",param);if(ii&&ii[0]){ii[0].innerHTML=_1c02[key];}else{com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetKeyValue(param,key,_1c02[key]);}}}}var _1c06=document.createElement("span");if(this.widgetType!==null&&this.widgetType=="mm_OAGadget"){dojo.addClass(_1c06,com.ibm.mm.builder.constant.mmOAGadget);}else{if(this.widgetType!==null&&this.widgetType=="mm_OSGadget"){dojo.addClass(_1c06,com.ibm.mm.builder.constant.mmGGadget);}else{dojo.addClass(_1c06,com.ibm.mm.builder.constant.mmIWidget);}}_1c06.setAttribute(com.ibm.mm.builder.constant.widget_span_attr_id,""+this._getUid());var _1c07=com.ibm.mm.builder.freeLayOutBean||com.ibm.mm.builder.columnLayoutBean;if(_1c07){_1c06.setAttribute(com.ibm.mm.builder.constant.widget_span_attr_skin,_1c07.getSelectedSkin());}com.ibm.mm.builder.utils.iWidgetSpecUtil.setWidgetDefXML(_1c06,_1c01.definition);if(com.ibm.mm.builder.widget.sandboxEnabled){if(_1c01.sandbox_definition==="true"||_1c01.sandbox_user==="true"){_1c06.setAttribute("sandbox","true");}}if(_1c01["com.ibm.mashups.builder.autoWiringEnabled"]==="true"){_1c06.setAttribute("autowiringenabled","true");}if(param){_1c06.appendChild(param);}return _1c06;};com.ibm.mm.builder.utils.iwidgetUtil.getWidgetSupportedModes=function(_1c08){var modes=null;var _1c09=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1c08);if(_1c09){var _1c0a=_1c09.getIWidgetDefinition();_1c0a.setFinishedCallback(function(_1c0b,_1c0c){if(_1c0b){modes=_1c0b.getSupportedModes();}});_1c0a.start(false);}return modes;};com.ibm.mm.builder.utils.iwidgetUtil.isWidgetVisible=function(_1c0d){var _1c0e=dojo.byId(_1c0d);if(_1c0e){return _1c0e.getAttribute("visible")?eval(_1c0e.getAttribute("visible")):false;}return false;};}if(!dojo._hasResource["com.ibm.mm.builder.utils.iWidgetSpecUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.iWidgetSpecUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.iWidgetSpecUtil");com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetKeyValue=function(_1c0f,_1c10,_1c11){var item=document.createElement("a");dojo.addClass(item,com.ibm.mm.builder.constant.mmItem);item.setAttribute("href","#"+_1c10);item.innerHTML=com.ibm.mm.builder.utils.htmlUtil.escapeString(_1c11);_1c0f.appendChild(item);};com.ibm.mm.builder.utils.iWidgetSpecUtil.newItemSetSpan=function(){var param=document.createElement("span");dojo.addClass(param,com.ibm.mm.builder.constant.mmItemSet);param.setAttribute("title","attributes");return param;};com.ibm.mm.builder.utils.iWidgetSpecUtil.setWidgetDefXML=function(_1c12,_1c13){var aTag=document.createElement("a");dojo.addClass(aTag,com.ibm.mm.builder.constant.mmDefinition);aTag.setAttribute("href",_1c13);_1c12.appendChild(aTag);};com.ibm.mm.builder.utils.iWidgetSpecUtil.getWidgetDefXML=function(_1c14){var _1c15=dojo.byId(_1c14);var def=dojo.query(com.ibm.mm.builder.constant.mmDefinition,_1c15)[0];return def.getAttribute("href");};com.ibm.mm.builder.utils.iWidgetSpecUtil.getKeyFromHref=function(node){var _1c16=node.getAttribute("href");if(_1c16===null){return "";}var pos=_1c16.indexOf("#");if(pos<0){return "";}return _1c16.substring(pos+1);};}if(!dojo._hasResource["dojo.number"]){dojo._hasResource["dojo.number"]=true;dojo.provide("dojo.number");dojo.number.format=function(value,_1c17){_1c17=dojo.mixin({},_1c17||{});var _1c18=dojo.i18n.normalizeLocale(_1c17.locale);var _1c19=dojo.i18n.getLocalization("dojo.cldr","number",_1c18);_1c17.customs=_1c19;var _1c1a=_1c17.pattern||_1c19[(_1c17.type||"decimal")+"Format"];if(isNaN(value)||Math.abs(value)==Infinity){return null;}return dojo.number._applyPattern(value,_1c1a,_1c17);};dojo.number._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;dojo.number._applyPattern=function(value,_1c1b,_1c1c){_1c1c=_1c1c||{};var group=_1c1c.customs.group;var _1c1d=_1c1c.customs.decimal;var _1c1e=_1c1b.split(";");var _1c1f=_1c1e[0];_1c1b=_1c1e[(value<0)?1:0]||("-"+_1c1f);if(_1c1b.indexOf("%")!=-1){value*=100;}else{if(_1c1b.indexOf("â°")!=-1){value*=1000;}else{if(_1c1b.indexOf("Â¤")!=-1){group=_1c1c.customs.currencyGroup||group;_1c1d=_1c1c.customs.currencyDecimal||_1c1d;_1c1b=_1c1b.replace(/\u00a4{1,3}/,function(match){var prop=["symbol","currency","displayName"][match.length-1];return _1c1c[prop]||_1c1c.currency||"";});}else{if(_1c1b.indexOf("E")!=-1){throw new Error("exponential notation not supported");}}}}var _1c20=dojo.number._numberPatternRE;var _1c21=_1c1f.match(_1c20);if(!_1c21){throw new Error("unable to find a number expression in pattern: "+_1c1b);}if(_1c1c.fractional===false){_1c1c.places=0;}return _1c1b.replace(_1c20,dojo.number._formatAbsolute(value,_1c21[0],{decimal:_1c1d,group:group,places:_1c1c.places,round:_1c1c.round}));};dojo.number.round=function(value,_1c22,_1c23){var _1c24=10/(_1c23||10);return (_1c24*+value).toFixed(_1c22)/_1c24;};if((0.9).toFixed()==0){(function(){var round=dojo.number.round;dojo.number.round=function(v,p,m){var d=Math.pow(10,-p||0),a=Math.abs(v);if(!v||a>=d||a*Math.pow(10,p+1)<5){d=0;}return round(v,p,m)+(v>0?d:-d);};})();}dojo.number._formatAbsolute=function(value,_1c25,_1c26){_1c26=_1c26||{};if(_1c26.places===true){_1c26.places=0;}if(_1c26.places===Infinity){_1c26.places=6;}var _1c27=_1c25.split(".");var _1c28=(_1c26.places>=0)?_1c26.places:(_1c27[1]&&_1c27[1].length)||0;if(!(_1c26.round<0)){value=dojo.number.round(value,_1c28,_1c26.round);}var _1c29=String(Math.abs(value)).split(".");var _1c2a=_1c29[1]||"";if(_1c26.places){var comma=dojo.isString(_1c26.places)&&_1c26.places.indexOf(",");if(comma){_1c26.places=_1c26.places.substring(comma+1);}_1c29[1]=dojo.string.pad(_1c2a.substr(0,_1c26.places),_1c26.places,"0",true);}else{if(_1c27[1]&&_1c26.places!==0){var pad=_1c27[1].lastIndexOf("0")+1;if(pad>_1c2a.length){_1c29[1]=dojo.string.pad(_1c2a,pad,"0",true);}var _1c2b=_1c27[1].length;if(_1c2b<_1c2a.length){_1c29[1]=_1c2a.substr(0,_1c2b);}}else{if(_1c29[1]){_1c29.pop();}}}var _1c2c=_1c27[0].replace(",","");pad=_1c2c.indexOf("0");if(pad!=-1){pad=_1c2c.length-pad;if(pad>_1c29[0].length){_1c29[0]=dojo.string.pad(_1c29[0],pad);}if(_1c2c.indexOf("#")==-1){_1c29[0]=_1c29[0].substr(_1c29[0].length-pad);}}var index=_1c27[0].lastIndexOf(",");var _1c2d,_1c2e;if(index!=-1){_1c2d=_1c27[0].length-index-1;var _1c2f=_1c27[0].substr(0,index);index=_1c2f.lastIndexOf(",");if(index!=-1){_1c2e=_1c2f.length-index-1;}}var _1c30=[];for(var whole=_1c29[0];whole;){var off=whole.length-_1c2d;_1c30.push((off>0)?whole.substr(off):whole);whole=(off>0)?whole.slice(0,off):"";if(_1c2e){_1c2d=_1c2e;delete _1c2e;}}_1c29[0]=_1c30.reverse().join(_1c26.group||",");return _1c29.join(_1c26.decimal||".");};dojo.number.regexp=function(_1c31){return dojo.number._parseInfo(_1c31).regexp;};dojo.number._parseInfo=function(_1c32){_1c32=_1c32||{};var _1c33=dojo.i18n.normalizeLocale(_1c32.locale);var _1c34=dojo.i18n.getLocalization("dojo.cldr","number",_1c33);var _1c35=_1c32.pattern||_1c34[(_1c32.type||"decimal")+"Format"];var group=_1c34.group;var _1c36=_1c34.decimal;var _1c37=1;if(_1c35.indexOf("%")!=-1){_1c37/=100;}else{if(_1c35.indexOf("â°")!=-1){_1c37/=1000;}else{var _1c38=_1c35.indexOf("Â¤")!=-1;if(_1c38){group=_1c34.currencyGroup||group;_1c36=_1c34.currencyDecimal||_1c36;}}}var _1c39=_1c35.split(";");if(_1c39.length==1){_1c39.push("-"+_1c39[0]);}var re=dojo.regexp.buildGroupRE(_1c39,function(_1c3a){_1c3a="(?:"+dojo.regexp.escapeString(_1c3a,".")+")";return _1c3a.replace(dojo.number._numberPatternRE,function(_1c3b){var flags={signed:false,separator:_1c32.strict?group:[group,""],fractional:_1c32.fractional,decimal:_1c36,exponent:false};var parts=_1c3b.split(".");var _1c3c=_1c32.places;if(parts.length==1||_1c3c===0){flags.fractional=false;}else{if(_1c3c===undefined){_1c3c=_1c32.pattern?parts[1].lastIndexOf("0")+1:Infinity;}if(_1c3c&&_1c32.fractional==undefined){flags.fractional=true;}if(!_1c32.places&&(_1c3c<parts[1].length)){_1c3c+=","+parts[1].length;}flags.places=_1c3c;}var _1c3d=parts[0].split(",");if(_1c3d.length>1){flags.groupSize=_1c3d.pop().length;if(_1c3d.length>1){flags.groupSize2=_1c3d.pop().length;}}return "("+dojo.number._realNumberRegexp(flags)+")";});},true);if(_1c38){re=re.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(match,_1c3e,_1c3f,after){var prop=["symbol","currency","displayName"][_1c3f.length-1];var _1c40=dojo.regexp.escapeString(_1c32[prop]||_1c32.currency||"");_1c3e=_1c3e?"[\\s\\xa0]":"";after=after?"[\\s\\xa0]":"";if(!_1c32.strict){if(_1c3e){_1c3e+="*";}if(after){after+="*";}return "(?:"+_1c3e+_1c40+after+")?";}return _1c3e+_1c40+after;});}return {regexp:re.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:group,decimal:_1c36,factor:_1c37};};dojo.number.parse=function(_1c41,_1c42){var info=dojo.number._parseInfo(_1c42);var _1c43=(new RegExp("^"+info.regexp+"$")).exec(_1c41);if(!_1c43){return NaN;}var _1c44=_1c43[1];if(!_1c43[1]){if(!_1c43[2]){return NaN;}_1c44=_1c43[2];info.factor*=-1;}_1c44=_1c44.replace(new RegExp("["+info.group+"\\s\\xa0"+"]","g"),"").replace(info.decimal,".");return _1c44*info.factor;};dojo.number._realNumberRegexp=function(flags){flags=flags||{};if(!("places" in flags)){flags.places=Infinity;}if(typeof flags.decimal!="string"){flags.decimal=".";}if(!("fractional" in flags)||/^0/.test(flags.places)){flags.fractional=[true,false];}if(!("exponent" in flags)){flags.exponent=[true,false];}if(!("eSigned" in flags)){flags.eSigned=[true,false];}var _1c45=dojo.number._integerRegexp(flags);var _1c46=dojo.regexp.buildGroupRE(flags.fractional,function(q){var re="";if(q&&(flags.places!==0)){re="\\"+flags.decimal;if(flags.places==Infinity){re="(?:"+re+"\\d+)?";}else{re+="\\d{"+flags.places+"}";}}return re;},true);var _1c47=dojo.regexp.buildGroupRE(flags.exponent,function(q){if(q){return "([eE]"+dojo.number._integerRegexp({signed:flags.eSigned})+")";}return "";});var _1c48=_1c45+_1c46;if(_1c46){_1c48="(?:(?:"+_1c48+")|(?:"+_1c46+"))";}return _1c48+_1c47;};dojo.number._integerRegexp=function(flags){flags=flags||{};if(!("signed" in flags)){flags.signed=[true,false];}if(!("separator" in flags)){flags.separator="";}else{if(!("groupSize" in flags)){flags.groupSize=3;}}var _1c49=dojo.regexp.buildGroupRE(flags.signed,function(q){return q?"[-+]":"";},true);var _1c4a=dojo.regexp.buildGroupRE(flags.separator,function(sep){if(!sep){return "(?:\\d+)";}sep=dojo.regexp.escapeString(sep);if(sep==" "){sep="\\s";}else{if(sep=="Â "){sep="\\s\\xa0";}}var grp=flags.groupSize,grp2=flags.groupSize2;if(grp2){var _1c4b="(?:0|[1-9]\\d{0,"+(grp2-1)+"}(?:["+sep+"]\\d{"+grp2+"})*["+sep+"]\\d{"+grp+"})";return ((grp-grp2)>0)?"(?:"+_1c4b+"|(?:0|[1-9]\\d{0,"+(grp-1)+"}))":_1c4b;}return "(?:0|[1-9]\\d{0,"+(grp-1)+"}(?:["+sep+"]\\d{"+grp+"})*)";},true);return _1c49+_1c4a;};}if(!dojo._hasResource["dijit.form._FormWidget"]){dojo._hasResource["dijit.form._FormWidget"]=true;dojo.provide("dijit.form._FormWidget");dojo.declare("dijit.form._FormWidget",[dijit._Widget,dijit._Templated],{baseClass:"",name:"",alt:"",value:"",type:"text",tabIndex:"0",disabled:false,intermediateChanges:false,scrollOnFocus:true,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{value:"focusNode",id:"focusNode",tabIndex:"focusNode",alt:"focusNode",title:"focusNode"}),postMixInProperties:function(){this.nameAttrSetting=this.name?("name='"+this.name+"'"):"";this.inherited(arguments);},_setDisabledAttr:function(value){this.disabled=value;dojo.attr(this.focusNode,"disabled",value);if(this.valueNode){dojo.attr(this.valueNode,"disabled",value);}dijit.setWaiState(this.focusNode,"disabled",value);if(value){this._hovering=false;this._active=false;this.focusNode.setAttribute("tabIndex","-1");}else{this.focusNode.setAttribute("tabIndex",this.tabIndex);}this._setStateClass();},setDisabled:function(_1c4c){dojo.deprecated("setDisabled("+_1c4c+") is deprecated. Use attr('disabled',"+_1c4c+") instead.","","2.0");this.attr("disabled",_1c4c);},_onFocus:function(e){if(this.scrollOnFocus){dijit.scrollIntoView(this.domNode);}this.inherited(arguments);},_onMouse:function(event){var _1c4d=event.currentTarget;if(_1c4d&&_1c4d.getAttribute){this.stateModifier=_1c4d.getAttribute("stateModifier")||"";}if(!this.disabled){switch(event.type){case "mouseenter":case "mouseover":this._hovering=true;this._active=this._mouseDown;break;case "mouseout":case "mouseleave":this._hovering=false;this._active=false;break;case "mousedown":this._active=true;this._mouseDown=true;var _1c4e=this.connect(dojo.body(),"onmouseup",function(){if(this._mouseDown&&this.isFocusable()){this.focus();}this._active=false;this._mouseDown=false;this._setStateClass();this.disconnect(_1c4e);});break;}this._setStateClass();}},isFocusable:function(){return !this.disabled&&!this.readOnly&&this.focusNode&&(dojo.style(this.domNode,"display")!="none");},focus:function(){dijit.focus(this.focusNode);},_setStateClass:function(){var _1c4f=this.baseClass.split(" ");function multiply(_1c50){_1c4f=_1c4f.concat(dojo.map(_1c4f,function(c){return c+_1c50;}),"dijit"+_1c50);};if(this.checked){multiply("Checked");}if(this.state){multiply(this.state);}if(this.selected){multiply("Selected");}if(this.disabled){multiply("Disabled");}else{if(this.readOnly){multiply("ReadOnly");}else{if(this._active){multiply(this.stateModifier+"Active");}else{if(this._focused){multiply("Focused");}if(this._hovering){multiply(this.stateModifier+"Hover");}}}}var tn=this.stateNode||this.domNode,_1c51={};dojo.forEach(tn.className.split(" "),function(c){_1c51[c]=true;});if("_stateClasses" in this){dojo.forEach(this._stateClasses,function(c){delete _1c51[c];});}dojo.forEach(_1c4f,function(c){_1c51[c]=true;});var _1c52=[];for(var c in _1c51){_1c52.push(c);}tn.className=_1c52.join(" ");this._stateClasses=_1c4f;},compare:function(val1,val2){if(typeof val1=="number"&&typeof val2=="number"){return (isNaN(val1)&&isNaN(val2))?0:val1-val2;}else{if(val1>val2){return 1;}else{if(val1<val2){return -1;}else{return 0;}}}},onChange:function(_1c53){},_onChangeActive:false,_handleOnChange:function(_1c54,_1c55){this._lastValue=_1c54;if(this._lastValueReported==undefined&&(_1c55===null||!this._onChangeActive)){this._resetValue=this._lastValueReported=_1c54;}if((this.intermediateChanges||_1c55||_1c55===undefined)&&((typeof _1c54!=typeof this._lastValueReported)||this.compare(_1c54,this._lastValueReported)!=0)){this._lastValueReported=_1c54;if(this._onChangeActive){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);}this._onChangeHandle=setTimeout(dojo.hitch(this,function(){this._onChangeHandle=null;this.onChange(_1c54);}),0);}}},create:function(){this.inherited(arguments);this._onChangeActive=true;this._setStateClass();},destroy:function(){if(this._onChangeHandle){clearTimeout(this._onChangeHandle);this.onChange(this._lastValueReported);}this.inherited(arguments);},setValue:function(value){dojo.deprecated("dijit.form._FormWidget:setValue("+value+") is deprecated.  Use attr('value',"+value+") instead.","","2.0");this.attr("value",value);},getValue:function(){dojo.deprecated(this.declaredClass+"::getValue() is deprecated. Use attr('value') instead.","","2.0");return this.attr("value");}});dojo.declare("dijit.form._FormValueWidget",dijit.form._FormWidget,{readOnly:false,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{value:"",readOnly:"focusNode"}),_setReadOnlyAttr:function(value){this.readOnly=value;dojo.attr(this.focusNode,"readOnly",value);dijit.setWaiState(this.focusNode,"readonly",value);this._setStateClass();},postCreate:function(){if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){this.connect(this.focusNode||this.domNode,"onkeydown",this._onKeyDown);}if(this._resetValue===undefined){this._resetValue=this.value;}},_setValueAttr:function(_1c56,_1c57){this.value=_1c56;this._handleOnChange(_1c56,_1c57);},_getValueAttr:function(){return this._lastValue;},undo:function(){this._setValueAttr(this._lastValueReported,false);},reset:function(){this._hasBeenBlurred=false;this._setValueAttr(this._resetValue,true);},_onKeyDown:function(e){if(e.keyCode==dojo.keys.ESCAPE&&!(e.ctrlKey||e.altKey||e.metaKey)){var te;if(dojo.isIE){e.preventDefault();te=document.createEventObject();te.keyCode=dojo.keys.ESCAPE;te.shiftKey=e.shiftKey;e.srcElement.fireEvent("onkeypress",te);}}},_layoutHackIE7:function(){if(dojo.isIE==7){var _1c58=this.domNode;var _1c59=_1c58.parentNode;var _1c5a=_1c58.firstChild||_1c58;var _1c5b=_1c5a.style.filter;var _1c5c=this;while(_1c59&&_1c59.clientHeight==0){(function ping(){var _1c5d=_1c5c.connect(_1c59,"onscroll",function(e){_1c5c.disconnect(_1c5d);_1c5a.style.filter=(new Date()).getMilliseconds();setTimeout(function(){_1c5a.style.filter=_1c5b;},0);});})();_1c59=_1c59.parentNode;}}}});}if(!dojo._hasResource["dijit._Container"]){dojo._hasResource["dijit._Container"]=true;dojo.provide("dijit._Container");dojo.declare("dijit._Container",null,{isContainer:true,buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},addChild:function(_1c5e,_1c5f){var _1c60=this.containerNode;if(_1c5f&&typeof _1c5f=="number"){var _1c61=this.getChildren();if(_1c61&&_1c61.length>=_1c5f){_1c60=_1c61[_1c5f-1].domNode;_1c5f="after";}}dojo.place(_1c5e.domNode,_1c60,_1c5f);if(this._started&&!_1c5e._started){_1c5e.startup();}},removeChild:function(_1c62){if(typeof _1c62=="number"&&_1c62>0){_1c62=this.getChildren()[_1c62];}if(_1c62&&_1c62.domNode){var node=_1c62.domNode;node.parentNode.removeChild(node);}},getChildren:function(){return dojo.query("> [widgetId]",this.containerNode).map(dijit.byNode);},hasChildren:function(){return dojo.query("> [widgetId]",this.containerNode).length>0;},destroyDescendants:function(_1c63){dojo.forEach(this.getChildren(),function(child){child.destroyRecursive(_1c63);});},_getSiblingOfChild:function(child,dir){var node=child.domNode,which=(dir>0?"nextSibling":"previousSibling");do{node=node[which];}while(node&&(node.nodeType!=1||!dijit.byNode(node)));return node&&dijit.byNode(node);},getIndexOfChild:function(child){return dojo.indexOf(this.getChildren(),child);},startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(child){child.startup();});this.inherited(arguments);}});}if(!dojo._hasResource["dojo.dnd.autoscroll"]){dojo._hasResource["dojo.dnd.autoscroll"]=true;dojo.provide("dojo.dnd.autoscroll");dojo.dnd.getViewport=function(){var d=dojo.doc,dd=d.documentElement,w=window,b=dojo.body();if(dojo.isMozilla){return {w:dd.clientWidth,h:w.innerHeight};}else{if(!dojo.isOpera&&w.innerWidth){return {w:w.innerWidth,h:w.innerHeight};}else{if(!dojo.isOpera&&dd&&dd.clientWidth){return {w:dd.clientWidth,h:dd.clientHeight};}else{if(b.clientWidth){return {w:b.clientWidth,h:b.clientHeight};}}}}return null;};dojo.dnd.V_TRIGGER_AUTOSCROLL=32;dojo.dnd.H_TRIGGER_AUTOSCROLL=32;dojo.dnd.V_AUTOSCROLL_VALUE=16;dojo.dnd.H_AUTOSCROLL_VALUE=16;dojo.dnd.autoScroll=function(e){var v=dojo.dnd.getViewport(),dx=0,dy=0;if(e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=-dojo.dnd.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-dojo.dnd.H_TRIGGER_AUTOSCROLL){dx=dojo.dnd.H_AUTOSCROLL_VALUE;}}if(e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=-dojo.dnd.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-dojo.dnd.V_TRIGGER_AUTOSCROLL){dy=dojo.dnd.V_AUTOSCROLL_VALUE;}}window.scrollBy(dx,dy);};dojo.dnd._validNodes={"div":1,"p":1,"td":1};dojo.dnd._validOverflow={"auto":1,"scroll":1};dojo.dnd.autoScrollNodes=function(e){for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in dojo.dnd._validNodes)){var s=dojo.getComputedStyle(n);if(s.overflow.toLowerCase() in dojo.dnd._validOverflow){var b=dojo._getContentBox(n,s),t=dojo.position(n,true);var w=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,b.w/2),h=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,b.h/2),rx=e.pageX-t.x,ry=e.pageY-t.y,dx=0,dy=0;if(dojo.isWebKit||dojo.isOpera){rx+=dojo.body().scrollLeft,ry+=dojo.body().scrollTop;}if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}}if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}}var _1c64=n.scrollLeft,_1c65=n.scrollTop;n.scrollLeft=n.scrollLeft+dx;n.scrollTop=n.scrollTop+dy;if(_1c64!=n.scrollLeft||_1c65!=n.scrollTop){return;}}}try{n=n.parentNode;}catch(x){n=null;}}dojo.dnd.autoScroll(e);};}if(!dojo._hasResource["dojo.dnd.Mover"]){dojo._hasResource["dojo.dnd.Mover"]=true;dojo.provide("dojo.dnd.Mover");dojo.declare("dojo.dnd.Mover",null,{constructor:function(node,e,host){this.node=dojo.byId(node);this.marginBox={l:e.pageX,t:e.pageY};this.mouseButton=e.button;var h=this.host=host,d=node.ownerDocument,_1c66=dojo.connect(d,"onmousemove",this,"onFirstMove");this.events=[dojo.connect(d,"onmousemove",this,"onMouseMove"),dojo.connect(d,"onmouseup",this,"onMouseUp"),dojo.connect(d,"ondragstart",dojo.stopEvent),dojo.connect(d.body,"onselectstart",dojo.stopEvent),_1c66];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox;this.host.onMove(this,{l:m.l+e.pageX,t:m.t+e.pageY});dojo.stopEvent(e);},onMouseUp:function(e){if(dojo.isWebKit&&dojo.isMac&&this.mouseButton==2?e.button==0:this.mouseButton==e.button){this.destroy();}dojo.stopEvent(e);},onFirstMove:function(){var s=this.node.style,l,t,h=this.host;switch(s.position){case "relative":case "absolute":l=Math.round(parseFloat(s.left));t=Math.round(parseFloat(s.top));break;default:s.position="absolute";var m=dojo.marginBox(this.node);var b=dojo.doc.body;var bs=dojo.getComputedStyle(b);var bm=dojo._getMarginBox(b,bs);var bc=dojo._getContentBox(b,bs);l=m.l-(bc.l-bm.l);t=m.t-(bc.t-bm.t);break;}this.marginBox.l=l-this.marginBox.l;this.marginBox.t=t-this.marginBox.t;if(h&&h.onFirstMove){h.onFirstMove(this);}dojo.disconnect(this.events.pop());},destroy:function(){dojo.forEach(this.events,dojo.disconnect);var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.node=this.host=null;}});}if(!dojo._hasResource["dojo.dnd.Moveable"]){dojo._hasResource["dojo.dnd.Moveable"]=true;dojo.provide("dojo.dnd.Moveable");dojo.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:false,constructor:function(node,_1c67){this.node=dojo.byId(node);if(!_1c67){_1c67={};}this.handle=_1c67.handle?dojo.byId(_1c67.handle):null;if(!this.handle){this.handle=this.node;}this.delay=_1c67.delay>0?_1c67.delay:0;this.skip=_1c67.skip;this.mover=_1c67.mover?_1c67.mover:dojo.dnd.Mover;this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")];},markupFactory:function(_1c68,node){return new dojo.dnd.Moveable(node,_1c68);},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.events=this.node=this.handle=null;},onMouseDown:function(e){if(this.skip&&dojo.dnd.isFormElement(e)){return;}if(this.delay){this.events.push(dojo.connect(this.handle,"onmousemove",this,"onMouseMove"),dojo.connect(this.handle,"onmouseup",this,"onMouseUp"));this._lastX=e.pageX;this._lastY=e.pageY;}else{this.onDragDetected(e);}dojo.stopEvent(e);},onMouseMove:function(e){if(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay){this.onMouseUp(e);this.onDragDetected(e);}dojo.stopEvent(e);},onMouseUp:function(e){for(var i=0;i<2;++i){dojo.disconnect(this.events.pop());}dojo.stopEvent(e);},onSelectStart:function(e){if(!this.skip||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onDragDetected:function(e){new this.mover(this.node,e,this);},onMoveStart:function(mover){dojo.publish("/dnd/move/start",[mover]);dojo.addClass(dojo.body(),"dojoMove");dojo.addClass(this.node,"dojoMoveItem");},onMoveStop:function(mover){dojo.publish("/dnd/move/stop",[mover]);dojo.removeClass(dojo.body(),"dojoMove");dojo.removeClass(this.node,"dojoMoveItem");},onFirstMove:function(mover){},onMove:function(mover,_1c69){this.onMoving(mover,_1c69);var s=mover.node.style;s.left=_1c69.l+"px";s.top=_1c69.t+"px";this.onMoved(mover,_1c69);},onMoving:function(mover,_1c6a){},onMoved:function(mover,_1c6b){}});}if(!dojo._hasResource["dojo.dnd.move"]){dojo._hasResource["dojo.dnd.move"]=true;dojo.provide("dojo.dnd.move");dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){},within:false,markupFactory:function(_1c6c,node){return new dojo.dnd.move.constrainedMoveable(node,_1c6c);},constructor:function(node,_1c6d){if(!_1c6d){_1c6d={};}this.constraints=_1c6d.constraints;this.within=_1c6d.within;},onFirstMove:function(mover){var c=this.constraintBox=this.constraints.call(this,mover);c.r=c.l+c.w;c.b=c.t+c.h;if(this.within){var mb=dojo.marginBox(mover.node);c.r-=mb.w;c.b-=mb.h;}},onMove:function(mover,_1c6e){var c=this.constraintBox,s=mover.node.style;s.left=(_1c6e.l<c.l?c.l:c.r<_1c6e.l?c.r:_1c6e.l)+"px";s.top=(_1c6e.t<c.t?c.t:c.b<_1c6e.t?c.b:_1c6e.t)+"px";}});dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(_1c6f,node){return new dojo.dnd.move.boxConstrainedMoveable(node,_1c6f);},constructor:function(node,_1c70){var box=_1c70&&_1c70.box;this.constraints=function(){return box;};}});dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(_1c71,node){return new dojo.dnd.move.parentConstrainedMoveable(node,_1c71);},constructor:function(node,_1c72){var area=_1c72&&_1c72.area;this.constraints=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(area=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});dojo.dnd.move.constrainedMover=function(fun,_1c73){dojo.deprecated("dojo.dnd.move.constrainedMover, use dojo.dnd.move.constrainedMoveable instead");var mover=function(node,e,_1c74){dojo.dnd.Mover.call(this,node,e,_1c74);};dojo.extend(mover,dojo.dnd.Mover.prototype);dojo.extend(mover,{onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox,c=this.constraintBox,l=m.l+e.pageX,t=m.t+e.pageY;l=l<c.l?c.l:c.r<l?c.r:l;t=t<c.t?c.t:c.b<t?c.b:t;this.host.onMove(this,{l:l,t:t});},onFirstMove:function(){dojo.dnd.Mover.prototype.onFirstMove.call(this);var c=this.constraintBox=fun.call(this);c.r=c.l+c.w;c.b=c.t+c.h;if(_1c73){var mb=dojo.marginBox(this.node);c.r-=mb.w;c.b-=mb.h;}}});return mover;};dojo.dnd.move.boxConstrainedMover=function(box,_1c75){dojo.deprecated("dojo.dnd.move.boxConstrainedMover, use dojo.dnd.move.boxConstrainedMoveable instead");return dojo.dnd.move.constrainedMover(function(){return box;},_1c75);};dojo.dnd.move.parentConstrainedMover=function(area,_1c76){dojo.deprecated("dojo.dnd.move.parentConstrainedMover, use dojo.dnd.move.parentConstrainedMoveable instead");var fun=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(area=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(area=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};return dojo.dnd.move.constrainedMover(fun,_1c76);};dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover;dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover;dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover;}if(!dojo._hasResource["dijit._HasDropDown"]){dojo._hasResource["dijit._HasDropDown"]=true;dojo.provide("dijit._HasDropDown");dojo.declare("dijit._HasDropDown",null,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:0,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouse:function(e){if(e.type=="click"&&!this._seenKeydown){return;}this._seenKeydown=false;if(e.type=="mousedown"){this._docHandler=this.connect(dojo.doc,"onmouseup","_onDropDownMouseup");}if(this.disabled||this.readOnly){return;}if(this._stopClickEvents){dojo.stopEvent(e);}this.toggleDropDown();if(e.type=="click"||e.type=="keypress"){this._onDropDownMouseup();}},_onDropDownMouseup:function(e){if(e&&this._docHandler){this.disconnect(this._docHandler);}var _1c77=this.dropDown,_1c78=false;if(e&&this._opened){var c=dojo.position(this._buttonNode,true);if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){var t=e.target;while(t&&!_1c78){if(dojo.hasClass(t,"dijitPopup")){_1c78=true;}else{t=t.parentNode;}}if(_1c78){t=e.target;if(_1c77.onItemClick){var _1c79;while(t&&!(_1c79=dijit.byNode(t))){t=t.parentNode;}if(_1c79&&_1c79.onClick&&_1c79.getParent){_1c79.getParent().onItemClick(_1c79,e);}}return;}}}if(this._opened&&_1c77.focus){window.setTimeout(dojo.hitch(_1c77,"focus"),1);}},_setupDropdown:function(){this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;this._aroundNode=this._aroundNode||this.domNode;this.connect(this._buttonNode,"onmousedown","_onDropDownMouse");this.connect(this._buttonNode,"onclick","_onDropDownMouse");this.connect(this._buttonNode,"onkeydown","_onDropDownKeydown");this.connect(this._buttonNode,"onblur","_onDropDownBlur");this.connect(this._buttonNode,"onkeypress","_onKey");if(this._setStateClass){this.connect(this,"openDropDown","_setStateClass");this.connect(this,"closeDropDown","_setStateClass");}var _1c7a={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";dojo.addClass(this._arrowWrapperNode||this._buttonNode,"dijit"+_1c7a+"ArrowButton");},postCreate:function(){this._setupDropdown();this.inherited(arguments);},destroyDescendants:function(){if(this.dropDown){if(!this.dropDown._destroyed){this.dropDown.destroyRecursive();}delete this.dropDown;}this.inherited(arguments);},_onDropDownKeydown:function(e){this._seenKeydown=true;},_onKeyPress:function(e){if(this._opened&&e.charOrCode==dojo.keys.ESCAPE&&!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.toggleDropDown();dojo.stopEvent(e);return;}this.inherited(arguments);},_onDropDownBlur:function(e){this._seenKeydown=false;},_onKey:function(e){if(this.disabled||this.readOnly){return;}var d=this.dropDown;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){return;}}if(d&&this._opened&&e.keyCode==dojo.keys.ESCAPE){this.toggleDropDown();return;}if(e.keyCode==dojo.keys.DOWN_ARROW||e.keyCode==dojo.keys.ENTER||e.charOrCode==" "){this._onDropDownMouse(e);}},_onBlur:function(){this.closeDropDown();this.inherited(arguments);},isLoaded:function(){return true;},loadDropDown:function(_1c7b){_1c7b();},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}this.focus();var _1c7c=this.dropDown;if(!_1c7c){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(dojo.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},openDropDown:function(){var _1c7d=this.dropDown;var _1c7e=_1c7d.domNode;var self=this;if(!this._preparedNode){dijit.popup.moveOffScreen(_1c7e);this._preparedNode=true;if(_1c7e.style.width){this._explicitDDWidth=true;}if(_1c7e.style.height){this._explicitDDHeight=true;}}if(this.maxHeight||this.forceWidth||this.autoWidth){var _1c7f={display:"",visibility:"hidden"};if(!this._explicitDDWidth){_1c7f.width="";}if(!this._explicitDDHeight){_1c7f.height="";}dojo.style(_1c7e,_1c7f);var mb=dojo.marginBox(_1c7e);var _1c80=(this.maxHeight&&mb.h>this.maxHeight);dojo.style(_1c7e,{overflow:_1c80?"auto":"hidden"});if(this.forceWidth){mb.w=this.domNode.offsetWidth;}else{if(this.autoWidth){mb.w=Math.max(mb.w,this.domNode.offsetWidth);}else{delete mb.w;}}if(_1c80){mb.h=this.maxHeight;if("w" in mb){mb.w+=16;}}else{delete mb.h;}delete mb.t;delete mb.l;if(dojo.isFunction(_1c7d.resize)){_1c7d.resize(mb);}else{dojo.marginBox(_1c7e,mb);}}var _1c81=dijit.popup.open({parent:this,popup:_1c7d,around:this._aroundNode,orient:dijit.getPopupAroundAlignment((this.dropDownPosition&&this.dropDownPosition.length)?this.dropDownPosition:["below"],this.isLeftToRight()),onExecute:function(){self.closeDropDown(true);},onCancel:function(){self.closeDropDown(true);},onClose:function(){dojo.attr(self._popupStateNode,"popupActive",false);dojo.removeClass(self._popupStateNode,"dijitHasDropDownOpen");self._opened=false;self.state="";}});dojo.attr(this._popupStateNode,"popupActive","true");dojo.addClass(self._popupStateNode,"dijitHasDropDownOpen");this._opened=true;this.state="Opened";return _1c81;},closeDropDown:function(focus){if(this._opened){if(focus){this.focus();}dijit.popup.close(this.dropDown);this._opened=false;this.state="";}}});}if(!dojo._hasResource["dijit.form.Button"]){dojo._hasResource["dijit.form.Button"]=true;dojo.provide("dijit.form.Button");dojo.declare("dijit.form.Button",dijit.form._FormWidget,{label:"",showLabel:true,iconClass:"",type:"button",baseClass:"dijitButton",templateString:dojo.cache("dijit.form","templates/Button.html","<span class=\"dijit dijitReset dijitLeft dijitInline\"\n\tdojoAttachEvent=\"onclick:_onButtonClick,onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\"\n\t><span class=\"dijitReset dijitRight dijitInline\"\n\t\t><span class=\"dijitReset dijitInline dijitButtonNode\"\n\t\t\t><button class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\t\tdojoAttachPoint=\"titleNode,focusNode\"\n\t\t\t\t${nameAttrSetting} type=\"${type}\" value=\"${value}\" waiRole=\"button\" waiState=\"labelledby-${id}_label\"\n\t\t\t\t><span class=\"dijitReset dijitInline\" dojoAttachPoint=\"iconNode\"\n\t\t\t\t\t><span class=\"dijitReset dijitToggleButtonIconChar\">&#10003;</span\n\t\t\t\t></span\n\t\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\t\tid=\"${id}_label\"\n\t\t\t\t\tdojoAttachPoint=\"containerNode\"\n\t\t\t\t></span\n\t\t\t></button\n\t\t></span\n\t></span\n></span>\n"),attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{label:{node:"containerNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),_onClick:function(e){if(this.disabled){return false;}this._clicked();return this.onClick(e);},_onButtonClick:function(e){if(this._onClick(e)===false){e.preventDefault();}else{if(this.type=="submit"&&!this.focusNode.form){for(var node=this.domNode;node.parentNode;node=node.parentNode){var _1c82=dijit.byNode(node);if(_1c82&&typeof _1c82._onSubmit=="function"){_1c82._onSubmit(e);break;}}}}},_setValueAttr:function(value){var attr=this.attributeMap.value||"";if(this[attr.node||attr||"domNode"].tagName=="BUTTON"){if(value!=this.value){console.debug("Cannot change the value attribute on a Button widget.");}}},_fillContent:function(_1c83){if(_1c83&&(!this.params||!("label" in this.params))){this.attr("label",_1c83.innerHTML);}},postCreate:function(){dojo.setSelectable(this.focusNode,false);this.inherited(arguments);},_setShowLabelAttr:function(val){if(this.containerNode){dojo.toggleClass(this.containerNode,"dijitDisplayNone",!val);}this.showLabel=val;},onClick:function(e){return true;},_clicked:function(e){},setLabel:function(_1c84){dojo.deprecated("dijit.form.Button.setLabel() is deprecated.  Use attr('label', ...) instead.","","2.0");this.attr("label",_1c84);},_setLabelAttr:function(_1c85){this.containerNode.innerHTML=this.label=_1c85;if(this.showLabel==false&&!this.params.title){this.titleNode.title=dojo.trim(this.containerNode.innerText||this.containerNode.textContent||"");}}});dojo.declare("dijit.form.DropDownButton",[dijit.form.Button,dijit._Container,dijit._HasDropDown],{baseClass:"dijitDropDownButton",templateString:dojo.cache("dijit.form","templates/DropDownButton.html","<span class=\"dijit dijitReset dijitLeft dijitInline\"\n\tdojoAttachPoint=\"_buttonNode\"\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\"\n\t><span class='dijitReset dijitRight dijitInline'\n\t\t><span class='dijitReset dijitInline dijitButtonNode'\n\t\t\t><button class=\"dijitReset dijitStretch dijitButtonContents\"\n\t\t\t\t${nameAttrSetting} type=\"${type}\" value=\"${value}\"\n\t\t\t\tdojoAttachPoint=\"focusNode,titleNode,_arrowWrapperNode\"\n\t\t\t\twaiRole=\"button\" waiState=\"haspopup-true,labelledby-${id}_label\"\n\t\t\t\t><span class=\"dijitReset dijitInline\"\n\t\t\t\t\tdojoAttachPoint=\"iconNode\"\n\t\t\t\t></span\n\t\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"\n\t\t\t\t\tdojoAttachPoint=\"containerNode,_popupStateNode\"\n\t\t\t\t\tid=\"${id}_label\"\n\t\t\t\t></span\n\t\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonInner\">&thinsp;</span\n\t\t\t\t><span class=\"dijitReset dijitInline dijitArrowButtonChar\">&#9660;</span\n\t\t\t></button\n\t\t></span\n\t></span\n></span>\n"),_fillContent:function(){if(this.srcNodeRef){var nodes=dojo.query("*",this.srcNodeRef);dijit.form.DropDownButton.superclass._fillContent.call(this,nodes[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}if(!this.dropDown){var _1c86=dojo.query("[widgetId]",this.dropDownContainer)[0];this.dropDown=dijit.byNode(_1c86);delete this.dropDownContainer;}dijit.popup.moveOffScreen(this.dropDown.domNode);this.inherited(arguments);},isLoaded:function(){var _1c87=this.dropDown;return (!_1c87.href||_1c87.isLoaded);},loadDropDown:function(){var _1c88=this.dropDown;if(!_1c88){return;}if(!this.isLoaded()){var _1c89=dojo.connect(_1c88,"onLoad",this,function(){dojo.disconnect(_1c89);this.openDropDown();});_1c88.refresh();}else{this.openDropDown();}},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown;}});dojo.declare("dijit.form.ComboButton",dijit.form.DropDownButton,{templateString:dojo.cache("dijit.form","templates/ComboButton.html","<table class='dijit dijitReset dijitInline dijitLeft'\n\tcellspacing='0' cellpadding='0' waiRole=\"presentation\"\n\t><tbody waiRole=\"presentation\"><tr waiRole=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonNode\"><button id=\"${id}_button\" class=\"dijitReset dijitButtonContents\"\n\t\t\tdojoAttachEvent=\"onclick:_onButtonClick,onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse,onkeypress:_onButtonKeyPress\"  dojoAttachPoint=\"titleNode\"\n\t\t\twaiRole=\"button\" waiState=\"labelledby-${id}_label\"\n\t\t\t><div class=\"dijitReset dijitInline\" dojoAttachPoint=\"iconNode\" waiRole=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitInline dijitButtonText\" id=\"${id}_label\" dojoAttachPoint=\"containerNode\" waiRole=\"presentation\"></div\n\t\t></button></td\n\t\t><td id=\"${id}_arrow\" class='dijitReset dijitRight dijitButtonNode dijitArrowButton'\n\t\t\tdojoAttachPoint=\"_popupStateNode,focusNode,_buttonNode\"\n\t\t\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onkeypress:_onArrowKeyPress\"\n\t\t\tstateModifier=\"DownArrow\"\n\t\t\ttitle=\"${optionsTitle}\" ${nameAttrSetting}\n\t\t\twaiRole=\"button\" waiState=\"haspopup-true\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" waiRole=\"presentation\">&thinsp;</div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" waiRole=\"presentation\">&#9660;</div\n\t\t></td\n\t></tr></tbody\n></table>\n"),attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{id:"",tabIndex:["focusNode","titleNode"],title:"titleNode"}),optionsTitle:"",baseClass:"dijitComboButton",_focusedNode:null,postCreate:function(){this.inherited(arguments);this._focalNodes=[this.titleNode,this._popupStateNode];var isIE=dojo.isIE;dojo.forEach(this._focalNodes,dojo.hitch(this,function(node){this.connect(node,isIE?"onactivate":"onfocus",this._onNodeFocus);this.connect(node,isIE?"ondeactivate":"onblur",this._onNodeBlur);}));if(isIE&&(isIE<8||dojo.isQuirks)){with(this.titleNode){style.width=scrollWidth+"px";this.connect(this.titleNode,"onresize",function(){setTimeout(function(){style.width=scrollWidth+"px";},0);});}}},_onNodeFocus:function(evt){this._focusedNode=evt.currentTarget;var fnc=this._focusedNode==this.focusNode?"dijitDownArrowButtonFocused":"dijitButtonContentsFocused";dojo.addClass(this._focusedNode,fnc);},_onNodeBlur:function(evt){var fnc=evt.currentTarget==this.focusNode?"dijitDownArrowButtonFocused":"dijitButtonContentsFocused";dojo.removeClass(evt.currentTarget,fnc);},_onBlur:function(){this.inherited(arguments);this._focusedNode=null;},_onButtonKeyPress:function(evt){if(evt.charOrCode==dojo.keys[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]){dijit.focus(this._popupStateNode);dojo.stopEvent(evt);}},_onArrowKeyPress:function(evt){if(evt.charOrCode==dojo.keys[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]){dijit.focus(this.titleNode);dojo.stopEvent(evt);}},focus:function(_1c8a){dijit.focus(_1c8a=="start"?this.titleNode:this._popupStateNode);}});dojo.declare("dijit.form.ToggleButton",dijit.form.Button,{baseClass:"dijitToggleButton",checked:false,attributeMap:dojo.mixin(dojo.clone(dijit.form.Button.prototype.attributeMap),{checked:"focusNode"}),_clicked:function(evt){this.attr("checked",!this.checked);},_setCheckedAttr:function(value){this.checked=value;dojo.attr(this.focusNode||this.domNode,"checked",value);dijit.setWaiState(this.focusNode||this.domNode,"pressed",value);this._setStateClass();this._handleOnChange(value,true);},setChecked:function(_1c8b){dojo.deprecated("setChecked("+_1c8b+") is deprecated. Use attr('checked',"+_1c8b+") instead.","","2.0");this.attr("checked",_1c8b);},reset:function(){this._hasBeenBlurred=false;this.attr("checked",this.params.checked||false);}});}if(!dojo._hasResource["dijit.form.HorizontalSlider"]){dojo._hasResource["dijit.form.HorizontalSlider"]=true;dojo.provide("dijit.form.HorizontalSlider");dojo.declare("dijit.form.HorizontalSlider",[dijit.form._FormValueWidget,dijit._Container],{templateString:dojo.cache("dijit.form","templates/HorizontalSlider.html","<table class=\"dijit dijitReset dijitSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"topDecoration\" class=\"dijitReset\" style=\"text-align:center;width:100%;\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\"\n\t\t\t><div class=\"dijitSliderDecrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${nameAttrSetting}\n\t\t\t/><div class=\"dijitReset dijitSliderBarContainerH\" waiRole=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable dijitSliderMoveableH\"\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleH\" dojoAttachEvent=\"onmousedown:_onHandleClick\" waiRole=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH\" dojoAttachEvent=\"onmousedown:_onBarClick\"></div\n\t\t\t></div\n\t\t></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div\n\t\t></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH\" style=\"right:0px;\"\n\t\t\t><div class=\"dijitSliderIncrementIconH\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t\t><td dojoAttachPoint=\"containerNode,bottomDecoration\" class=\"dijitReset\" style=\"text-align:center;\"></td\n\t\t><td class=\"dijitReset\" colspan=\"2\"></td\n\t></tr\n></table>\n"),value:0,showButtons:true,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:true,slideDuration:dijit.defaultDuration,widgetsInTemplate:true,attributeMap:dojo.delegate(dijit.form._FormWidget.prototype.attributeMap,{id:""}),baseClass:"dijitSlider",_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_startingPixelCount:"l",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}this._setValueAttr(this.value,true);},_onKeyPress:function(e){if(this.disabled||this.readOnly||e.altKey||e.ctrlKey||e.metaKey){return;}switch(e.charOrCode){case dojo.keys.HOME:this._setValueAttr(this.minimum,false);break;case dojo.keys.END:this._setValueAttr(this.maximum,false);break;case ((this._descending||this.isLeftToRight())?dojo.keys.RIGHT_ARROW:dojo.keys.LEFT_ARROW):case (this._descending===false?dojo.keys.DOWN_ARROW:dojo.keys.UP_ARROW):case (this._descending===false?dojo.keys.PAGE_DOWN:dojo.keys.PAGE_UP):this.increment(e);break;case ((this._descending||this.isLeftToRight())?dojo.keys.LEFT_ARROW:dojo.keys.RIGHT_ARROW):case (this._descending===false?dojo.keys.UP_ARROW:dojo.keys.DOWN_ARROW):case (this._descending===false?dojo.keys.PAGE_UP:dojo.keys.PAGE_DOWN):this.decrement(e);break;default:return;}dojo.stopEvent(e);},_onHandleClick:function(e){if(this.disabled||this.readOnly){return;}if(!dojo.isIE){dijit.focus(this.sliderHandle);}dojo.stopEvent(e);},_isReversed:function(){return !this.isLeftToRight();},_onBarClick:function(e){if(this.disabled||this.readOnly||!this.clickSelect){return;}dijit.focus(this.sliderHandle);dojo.stopEvent(e);var _1c8c=dojo.position(this.sliderBarContainer,true);var _1c8d=e[this._mousePixelCoord]-_1c8c[this._startingPixelCoord];this._setPixelValue(this._isReversed()?(_1c8c[this._pixelCount]-_1c8d):_1c8d,_1c8c[this._pixelCount],true);this._movable.onMouseDown(e);},_setPixelValue:function(_1c8e,_1c8f,_1c90){if(this.disabled||this.readOnly){return;}_1c8e=_1c8e<0?0:_1c8f<_1c8e?_1c8f:_1c8e;var count=this.discreteValues;if(count<=1||count==Infinity){count=_1c8f;}count--;var _1c91=_1c8f/count;var _1c92=Math.round(_1c8e/_1c91);this._setValueAttr((this.maximum-this.minimum)*_1c92/count+this.minimum,_1c90);},_setValueAttr:function(value,_1c93){this.valueNode.value=this.value=value;dijit.setWaiState(this.focusNode,"valuenow",value);this.inherited(arguments);var _1c94=(value-this.minimum)/(this.maximum-this.minimum);var _1c95=(this._descending===false)?this.remainingBar:this.progressBar;var _1c96=(this._descending===false)?this.progressBar:this.remainingBar;if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}if(_1c93&&this.slideDuration>0&&_1c95.style[this._progressPixelSize]){var _1c97=this;var props={};var start=parseFloat(_1c95.style[this._progressPixelSize]);var _1c98=this.slideDuration*(_1c94-start/100);if(_1c98==0){return;}if(_1c98<0){_1c98=0-_1c98;}props[this._progressPixelSize]={start:start,end:_1c94*100,units:"%"};this._inProgressAnim=dojo.animateProperty({node:_1c95,duration:_1c98,onAnimate:function(v){_1c96.style[_1c97._progressPixelSize]=(100-parseFloat(v[_1c97._progressPixelSize]))+"%";},onEnd:function(){delete _1c97._inProgressAnim;},properties:props});this._inProgressAnim.play();}else{_1c95.style[this._progressPixelSize]=(_1c94*100)+"%";_1c96.style[this._progressPixelSize]=((1-_1c94)*100)+"%";}},_bumpValue:function(_1c99,_1c9a){if(this.disabled||this.readOnly){return;}var s=dojo.getComputedStyle(this.sliderBarContainer);var c=dojo._getContentBox(this.sliderBarContainer,s);var count=this.discreteValues;if(count<=1||count==Infinity){count=c[this._pixelCount];}count--;var value=(this.value-this.minimum)*count/(this.maximum-this.minimum)+_1c99;if(value<0){value=0;}if(value>count){value=count;}value=value*(this.maximum-this.minimum)/count+this.minimum;this._setValueAttr(value,_1c9a);},_onClkBumper:function(val){if(this.disabled||this.readOnly||!this.clickSelect){return;}this._setValueAttr(val,true);},_onClkIncBumper:function(){this._onClkBumper(this._descending===false?this.minimum:this.maximum);},_onClkDecBumper:function(){this._onClkBumper(this._descending===false?this.maximum:this.minimum);},decrement:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_DOWN?-this.pageIncrement:-1);},increment:function(e){this._bumpValue(e.charOrCode==dojo.keys.PAGE_UP?this.pageIncrement:1);},_mouseWheeled:function(evt){dojo.stopEvent(evt);var janky=!dojo.isMozilla;var _1c9b=evt[(janky?"wheelDelta":"detail")]*(janky?1:-1);this._bumpValue(_1c9b<0?-1:1,true);},startup:function(){dojo.forEach(this.getChildren(),function(child){if(this[child.container]!=this.containerNode){this[child.container].appendChild(child.domNode);}},this);},_typematicCallback:function(count,_1c9c,e){if(count==-1){this._setValueAttr(this.value,true);}else{this[(_1c9c==(this._descending?this.incrementButton:this.decrementButton))?"decrement":"increment"](e);}},postCreate:function(){if(this.showButtons){this.incrementButton.style.display="";this.decrementButton.style.display="";this._connects.push(dijit.typematic.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500));this._connects.push(dijit.typematic.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));}this.connect(this.domNode,!dojo.isMozilla?"onmousewheel":"DOMMouseScroll","_mouseWheeled");var mover=dojo.declare(dijit.form._SliderMover,{widget:this});this._movable=new dojo.dnd.Moveable(this.sliderHandle,{mover:mover});var label=dojo.query("label[for=\""+this.id+"\"]");if(label.length){label[0].id=(this.id+"_label");dijit.setWaiState(this.focusNode,"labelledby",label[0].id);}dijit.setWaiState(this.focusNode,"valuemin",this.minimum);dijit.setWaiState(this.focusNode,"valuemax",this.maximum);this.inherited(arguments);this._layoutHackIE7();},destroy:function(){this._movable.destroy();if(this._inProgressAnim&&this._inProgressAnim.status!="stopped"){this._inProgressAnim.stop(true);}this._supportingWidgets=dijit.findWidgets(this.domNode);this.inherited(arguments);}});dojo.declare("dijit.form._SliderMover",dojo.dnd.Mover,{onMouseMove:function(e){var _1c9d=this.widget;var _1c9e=_1c9d._abspos;if(!_1c9e){_1c9e=_1c9d._abspos=dojo.position(_1c9d.sliderBarContainer,true);_1c9d._setPixelValue_=dojo.hitch(_1c9d,"_setPixelValue");_1c9d._isReversed_=_1c9d._isReversed();}var _1c9f=e[_1c9d._mousePixelCoord]-_1c9e[_1c9d._startingPixelCoord];_1c9d._setPixelValue_(_1c9d._isReversed_?(_1c9e[_1c9d._pixelCount]-_1c9f):_1c9f,_1c9e[_1c9d._pixelCount],false);},destroy:function(e){dojo.dnd.Mover.prototype.destroy.apply(this,arguments);var _1ca0=this.widget;_1ca0._abspos=null;_1ca0._setValueAttr(_1ca0.value,true);}});}if(!dojo._hasResource["dijit.form.VerticalSlider"]){dojo._hasResource["dijit.form.VerticalSlider"]=true;dojo.provide("dijit.form.VerticalSlider");dojo.declare("dijit.form.VerticalSlider",dijit.form.HorizontalSlider,{templateString:dojo.cache("dijit.form","templates/VerticalSlider.html","<table class=\"dijitReset dijitSlider\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" rules=\"none\" dojoAttachEvent=\"onkeypress:_onKeyPress,onkeyup:_onKeyUp\"\n><tbody class=\"dijitReset\"\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\n\t\t\t><div class=\"dijitSliderIncrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"decrementButton\"><span class=\"dijitSliderButtonInner\">+</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderTopBumper dijitSliderTopBumper\" dojoAttachEvent=\"onmousedown:_onClkIncBumper\"></div></center\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td dojoAttachPoint=\"leftDecoration\" class=\"dijitReset\" style=\"text-align:center;height:100%;\"></td\n\t\t><td class=\"dijitReset\" style=\"height:100%;\"\n\t\t\t><input dojoAttachPoint=\"valueNode\" type=\"hidden\" ${nameAttrSetting}\n\t\t\t/><center class=\"dijitReset dijitSliderBarContainerV\" waiRole=\"presentation\" dojoAttachPoint=\"sliderBarContainer\"\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"remainingBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderRemainingBar dijitSliderRemainingBarV\" dojoAttachEvent=\"onmousedown:_onBarClick\"><!--#5629--></div\n\t\t\t\t><div waiRole=\"presentation\" dojoAttachPoint=\"progressBar\" class=\"dijitSliderBar dijitSliderBarV dijitSliderProgressBar dijitSliderProgressBarV\" dojoAttachEvent=\"onmousedown:_onBarClick\"\n\t\t\t\t\t><div class=\"dijitSliderMoveable\" style=\"vertical-align:top;\"\n\t\t\t\t\t\t><div dojoAttachPoint=\"sliderHandle,focusNode\" class=\"dijitSliderImageHandle dijitSliderImageHandleV\" dojoAttachEvent=\"onmousedown:_onHandleClick\" waiRole=\"slider\" valuemin=\"${minimum}\" valuemax=\"${maximum}\"></div\n\t\t\t\t\t></div\n\t\t\t\t></div\n\t\t\t></center\n\t\t></td\n\t\t><td dojoAttachPoint=\"containerNode,rightDecoration\" class=\"dijitReset\" style=\"text-align:center;height:100%;\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset\"\n\t\t\t><center><div class=\"dijitSliderBar dijitSliderBumper dijitSliderBumperV dijitSliderBottomBumper dijitSliderBottomBumper\" dojoAttachEvent=\"onmousedown:_onClkDecBumper\"></div></center\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n\t><tr class=\"dijitReset\"\n\t\t><td class=\"dijitReset\"></td\n\t\t><td class=\"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerV\"\n\t\t\t><div class=\"dijitSliderDecrementIconV\" tabIndex=\"-1\" style=\"display:none\" dojoAttachPoint=\"incrementButton\"><span class=\"dijitSliderButtonInner\">-</span></div\n\t\t></td\n\t\t><td class=\"dijitReset\"></td\n\t></tr\n></tbody></table>\n"),_mousePixelCoord:"pageY",_pixelCount:"h",_startingPixelCoord:"y",_startingPixelCount:"t",_handleOffsetCoord:"top",_progressPixelSize:"height",_descending:true,startup:function(){if(this._started){return;}if(!this.isLeftToRight()&&dojo.isMoz){if(this.leftDecoration){this._rtlRectify(this.leftDecoration);}if(this.rightDecoration){this._rtlRectify(this.rightDecoration);}}this.inherited(arguments);},_isReversed:function(){return this._descending;},_rtlRectify:function(_1ca1){var _1ca2=[];while(_1ca1.firstChild){_1ca2.push(_1ca1.firstChild);_1ca1.removeChild(_1ca1.firstChild);}for(var i=_1ca2.length-1;i>=0;i--){if(_1ca2[i]){_1ca1.appendChild(_1ca2[i]);}}}});}if(!dojo._hasResource["dijit.form.HorizontalRule"]){dojo._hasResource["dijit.form.HorizontalRule"]=true;dojo.provide("dijit.form.HorizontalRule");dojo.declare("dijit.form.HorizontalRule",[dijit._Widget,dijit._Templated],{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH\"></div>",count:3,container:"containerNode",ruleStyle:"",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkH\" style=\"left:",_positionSuffix:"%;",_suffix:"\"></div>",_genHTML:function(pos,ndx){return this._positionPrefix+pos+this._positionSuffix+this.ruleStyle+this._suffix;},_isHorizontal:true,postCreate:function(){var _1ca3;if(this.count==1){_1ca3=this._genHTML(50,0);}else{var i;var _1ca4=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){_1ca3=this._genHTML(0,0);for(i=1;i<this.count-1;i++){_1ca3+=this._genHTML(_1ca4*i,i);}_1ca3+=this._genHTML(100,this.count-1);}else{_1ca3=this._genHTML(100,0);for(i=1;i<this.count-1;i++){_1ca3+=this._genHTML(100-_1ca4*i,i);}_1ca3+=this._genHTML(0,this.count-1);}}this.domNode.innerHTML=_1ca3;}});}if(!dojo._hasResource["dijit.form.VerticalRule"]){dojo._hasResource["dijit.form.VerticalRule"]=true;dojo.provide("dijit.form.VerticalRule");dojo.declare("dijit.form.VerticalRule",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleMark dijitRuleMarkV\" style=\"top:",_isHorizontal:false});}if(!dojo._hasResource["dijit.form.HorizontalRuleLabels"]){dojo._hasResource["dijit.form.HorizontalRuleLabels"]=true;dojo.provide("dijit.form.HorizontalRuleLabels");dojo.declare("dijit.form.HorizontalRuleLabels",dijit.form.HorizontalRule,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH\"></div>",labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerH\" style=\"left:",_labelPrefix:"\"><span class=\"dijitRuleLabel dijitRuleLabelH\">",_suffix:"</span></div>",_calcPosition:function(pos){return pos;},_genHTML:function(pos,ndx){return this._positionPrefix+this._calcPosition(pos)+this._positionSuffix+this.labelStyle+this._labelPrefix+this.labels[ndx]+this._suffix;},getLabels:function(){var _1ca5=this.labels;if(!_1ca5.length){_1ca5=dojo.query("> li",this.srcNodeRef).map(function(node){return String(node.innerHTML);});}this.srcNodeRef.innerHTML="";if(!_1ca5.length&&this.count>1){var start=this.minimum;var inc=(this.maximum-start)/(this.count-1);for(var i=0;i<this.count;i++){_1ca5.push((i<this.numericMargin||i>=(this.count-this.numericMargin))?"":dojo.number.format(start,this.constraints));start+=inc;}}return _1ca5;},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length;}});}if(!dojo._hasResource["dijit.form.VerticalRuleLabels"]){dojo._hasResource["dijit.form.VerticalRuleLabels"]=true;dojo.provide("dijit.form.VerticalRuleLabels");dojo.declare("dijit.form.VerticalRuleLabels",dijit.form.HorizontalRuleLabels,{templateString:"<div class=\"dijitRuleContainer dijitRuleContainerV dijitRuleLabelsContainer dijitRuleLabelsContainerV\"></div>",_positionPrefix:"<div class=\"dijitRuleLabelContainer dijitRuleLabelContainerV\" style=\"top:",_labelPrefix:"\"><span class=\"dijitRuleLabel dijitRuleLabelV\">",_calcPosition:function(pos){return 100-pos;},_isHorizontal:false});}if(!dojo._hasResource["dijit.form.Slider"]){dojo._hasResource["dijit.form.Slider"]=true;dojo.provide("dijit.form.Slider");dojo.deprecated("Call require() for HorizontalSlider / VerticalRule, explicitly rather than 'dijit.form.Slider' itself","","2.0");}if(!dojo._hasResource["dojo.dnd.TimedMoveable"]){dojo._hasResource["dojo.dnd.TimedMoveable"]=true;dojo.provide("dojo.dnd.TimedMoveable");(function(){var _1ca6=dojo.dnd.Moveable.prototype.onMove;dojo.declare("dojo.dnd.TimedMoveable",dojo.dnd.Moveable,{timeout:40,constructor:function(node,_1ca7){if(!_1ca7){_1ca7={};}if(_1ca7.timeout&&typeof _1ca7.timeout=="number"&&_1ca7.timeout>=0){this.timeout=_1ca7.timeout;}},markupFactory:function(_1ca8,node){return new dojo.dnd.TimedMoveable(node,_1ca8);},onMoveStop:function(mover){if(mover._timer){clearTimeout(mover._timer);_1ca6.call(this,mover,mover._leftTop);}dojo.dnd.Moveable.prototype.onMoveStop.apply(this,arguments);},onMove:function(mover,_1ca9){mover._leftTop=_1ca9;if(!mover._timer){var _1caa=this;mover._timer=setTimeout(function(){mover._timer=null;_1ca6.call(_1caa,mover,mover._leftTop);},this.timeout);}}});})();}if(!dojo._hasResource["dijit.form._FormMixin"]){dojo._hasResource["dijit.form._FormMixin"]=true;dojo.provide("dijit.form._FormMixin");dojo.declare("dijit.form._FormMixin",null,{reset:function(){dojo.forEach(this.getDescendants(),function(_1cab){if(_1cab.reset){_1cab.reset();}});},validate:function(){var _1cac=false;return dojo.every(dojo.map(this.getDescendants(),function(_1cad){_1cad._hasBeenBlurred=true;var valid=_1cad.disabled||!_1cad.validate||_1cad.validate();if(!valid&&!_1cac){dijit.scrollIntoView(_1cad.containerNode||_1cad.domNode);_1cad.focus();_1cac=true;}return valid;}),function(item){return item;});},setValues:function(val){dojo.deprecated(this.declaredClass+"::setValues() is deprecated. Use attr('value', val) instead.","","2.0");return this.attr("value",val);},_setValueAttr:function(obj){var map={};dojo.forEach(this.getDescendants(),function(_1cae){if(!_1cae.name){return;}var entry=map[_1cae.name]||(map[_1cae.name]=[]);entry.push(_1cae);});for(var name in map){if(!map.hasOwnProperty(name)){continue;}var _1caf=map[name],_1cb0=dojo.getObject(name,false,obj);if(_1cb0===undefined){continue;}if(!dojo.isArray(_1cb0)){_1cb0=[_1cb0];}if(typeof _1caf[0].checked=="boolean"){dojo.forEach(_1caf,function(w,i){w.attr("value",dojo.indexOf(_1cb0,w.value)!=-1);});}else{if(_1caf[0].multiple){_1caf[0].attr("value",_1cb0);}else{dojo.forEach(_1caf,function(w,i){w.attr("value",_1cb0[i]);});}}}},getValues:function(){dojo.deprecated(this.declaredClass+"::getValues() is deprecated. Use attr('value') instead.","","2.0");return this.attr("value");},_getValueAttr:function(){var obj={};dojo.forEach(this.getDescendants(),function(_1cb1){var name=_1cb1.name;if(!name||_1cb1.disabled){return;}var value=_1cb1.attr("value");if(typeof _1cb1.checked=="boolean"){if(/Radio/.test(_1cb1.declaredClass)){if(value!==false){dojo.setObject(name,value,obj);}else{value=dojo.getObject(name,false,obj);if(value===undefined){dojo.setObject(name,null,obj);}}}else{var ary=dojo.getObject(name,false,obj);if(!ary){ary=[];dojo.setObject(name,ary,obj);}if(value!==false){ary.push(value);}}}else{var prev=dojo.getObject(name,false,obj);if(typeof prev!="undefined"){if(dojo.isArray(prev)){prev.push(value);}else{dojo.setObject(name,[prev,value],obj);}}else{dojo.setObject(name,value,obj);}}});return obj;},isValid:function(){this._invalidWidgets=dojo.filter(this.getDescendants(),function(_1cb2){return !_1cb2.disabled&&_1cb2.isValid&&!_1cb2.isValid();});return !this._invalidWidgets.length;},onValidStateChange:function(_1cb3){},_widgetChange:function(_1cb4){var _1cb5=this._lastValidState;if(!_1cb4||this._lastValidState===undefined){_1cb5=this.isValid();if(this._lastValidState===undefined){this._lastValidState=_1cb5;}}else{if(_1cb4.isValid){this._invalidWidgets=dojo.filter(this._invalidWidgets||[],function(w){return (w!=_1cb4);},this);if(!_1cb4.isValid()&&!_1cb4.attr("disabled")){this._invalidWidgets.push(_1cb4);}_1cb5=(this._invalidWidgets.length===0);}}if(_1cb5!==this._lastValidState){this._lastValidState=_1cb5;this.onValidStateChange(_1cb5);}},connectChildren:function(){dojo.forEach(this._changeConnections,dojo.hitch(this,"disconnect"));var _1cb6=this;var conns=this._changeConnections=[];dojo.forEach(dojo.filter(this.getDescendants(),function(item){return item.validate;}),function(_1cb7){conns.push(_1cb6.connect(_1cb7,"validate",dojo.hitch(_1cb6,"_widgetChange",_1cb7)));conns.push(_1cb6.connect(_1cb7,"_setDisabledAttr",dojo.hitch(_1cb6,"_widgetChange",_1cb7)));});this._widgetChange(null);},startup:function(){this.inherited(arguments);this._changeConnections=[];this.connectChildren();}});}if(!dojo._hasResource["dijit._DialogMixin"]){dojo._hasResource["dijit._DialogMixin"]=true;dojo.provide("dijit._DialogMixin");dojo.declare("dijit._DialogMixin",null,{attributeMap:dijit._Widget.prototype.attributeMap,execute:function(_1cb8){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.attr("value"));},_getFocusItems:function(_1cb9){var elems=dijit._getTabNavigable(dojo.byId(_1cb9));this._firstFocusItem=elems.lowest||elems.first||_1cb9;this._lastFocusItem=elems.last||elems.highest||this._firstFocusItem;if(dojo.isMoz&&this._firstFocusItem.tagName.toLowerCase()=="input"&&dojo.getNodeProp(this._firstFocusItem,"type").toLowerCase()=="file"){dojo.attr(_1cb9,"tabIndex","0");this._firstFocusItem=_1cb9;}}});}if(!dojo._hasResource["dijit.DialogUnderlay"]){dojo._hasResource["dijit.DialogUnderlay"]=true;dojo.provide("dijit.DialogUnderlay");dojo.declare("dijit.DialogUnderlay",[dijit._Widget,dijit._Templated],{templateString:"<div class='dijitDialogUnderlayWrapper'><div class='dijitDialogUnderlay' dojoAttachPoint='node'></div></div>",dialogId:"","class":"",attributeMap:{id:"domNode"},_setDialogIdAttr:function(id){dojo.attr(this.node,"id",id+"_underlay");},_setClassAttr:function(clazz){this.node.className="dijitDialogUnderlay "+clazz;},postCreate:function(){dojo.body().appendChild(this.domNode);},layout:function(){var is=this.node.style,os=this.domNode.style;os.display="none";var _1cba=dijit.getViewport();os.top=_1cba.t+"px";os.left=_1cba.l+"px";is.width=_1cba.w+"px";is.height=_1cba.h+"px";os.display="block";},show:function(){this.domNode.style.display="block";this.layout();this.bgIframe=new dijit.BackgroundIframe(this.domNode);},hide:function(){this.bgIframe.destroy();this.domNode.style.display="none";},uninitialize:function(){if(this.bgIframe){this.bgIframe.destroy();}this.inherited(arguments);}});}if(!dojo._hasResource["dijit._Contained"]){dojo._hasResource["dijit._Contained"]=true;dojo.provide("dijit._Contained");dojo.declare("dijit._Contained",null,{getParent:function(){var _1cbb=dijit.getEnclosingWidget(this.domNode.parentNode);return _1cbb&&_1cbb.isContainer?_1cbb:null;},_getSibling:function(which){var node=this.domNode;do{node=node[which+"Sibling"];}while(node&&node.nodeType!=1);return node&&dijit.byNode(node);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});}if(!dojo._hasResource["dijit.layout._LayoutWidget"]){dojo._hasResource["dijit.layout._LayoutWidget"]=true;dojo.provide("dijit.layout._LayoutWidget");dojo.declare("dijit.layout._LayoutWidget",[dijit._Widget,dijit._Container,dijit._Contained],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,postCreate:function(){dojo.addClass(this.domNode,"dijitContainer");dojo.addClass(this.domNode,this.baseClass);this.inherited(arguments);},startup:function(){if(this._started){return;}this.inherited(arguments);var _1cbc=this.getParent&&this.getParent();if(!(_1cbc&&_1cbc.isLayoutContainer)){this.resize();this.connect(dojo.isIE?this.domNode:dojo.global,"onresize",function(){this.resize();});}},resize:function(_1cbd,_1cbe){var node=this.domNode;if(_1cbd){dojo.marginBox(node,_1cbd);if(_1cbd.t){node.style.top=_1cbd.t+"px";}if(_1cbd.l){node.style.left=_1cbd.l+"px";}}var mb=_1cbe||{};dojo.mixin(mb,_1cbd||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(node),mb);}var cs=dojo.getComputedStyle(node);var me=dojo._getMarginExtents(node,cs);var be=dojo._getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=dojo._getPadExtents(node,cs);this._contentBox={l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(child){dojo.addClass(child.domNode,this.baseClass+"-child");if(child.baseClass){dojo.addClass(child.domNode,this.baseClass+"-"+child.baseClass);}},addChild:function(child,_1cbf){this.inherited(arguments);if(this._started){this._setupChild(child);}},removeChild:function(child){dojo.removeClass(child.domNode,this.baseClass+"-child");if(child.baseClass){dojo.removeClass(child.domNode,this.baseClass+"-"+child.baseClass);}this.inherited(arguments);}});dijit.layout.marginBox2contentBox=function(node,mb){var cs=dojo.getComputedStyle(node);var me=dojo._getMarginExtents(node,cs);var pb=dojo._getPadBorderExtents(node,cs);return {l:dojo._toPixelValue(node,cs.paddingLeft),t:dojo._toPixelValue(node,cs.paddingTop),w:mb.w-(me.w+pb.w),h:mb.h-(me.h+pb.h)};};(function(){var _1cc0=function(word){return word.substring(0,1).toUpperCase()+word.substring(1);};var size=function(_1cc1,dim){var _1cc2=_1cc1.resize?_1cc1.resize(dim):dojo.marginBox(_1cc1.domNode,dim);if(_1cc2){dojo.mixin(_1cc1,_1cc2);}else{dojo.mixin(_1cc1,dojo.marginBox(_1cc1.domNode));dojo.mixin(_1cc1,dim);}};dijit.layout.layoutChildren=function(_1cc3,dim,_1cc4){dim=dojo.mixin({},dim);dojo.addClass(_1cc3,"dijitLayoutContainer");_1cc4=dojo.filter(_1cc4,function(item){return item.layoutAlign!="client";}).concat(dojo.filter(_1cc4,function(item){return item.layoutAlign=="client";}));dojo.forEach(_1cc4,function(child){var elm=child.domNode,pos=child.layoutAlign;var _1cc5=elm.style;_1cc5.left=dim.l+"px";_1cc5.top=dim.t+"px";_1cc5.position="absolute";dojo.addClass(elm,"dijitAlign"+_1cc0(pos));if(pos=="top"||pos=="bottom"){size(child,{w:dim.w});dim.h-=child.h;if(pos=="top"){dim.t+=child.h;}else{_1cc5.top=dim.t+dim.h+"px";}}else{if(pos=="left"||pos=="right"){size(child,{h:dim.h});dim.w-=child.w;if(pos=="left"){dim.l+=child.w;}else{_1cc5.left=dim.l+dim.w+"px";}}else{if(pos=="client"){size(child,dim);}}}});};})();}if(!dojo._hasResource["dojo.html"]){dojo._hasResource["dojo.html"]=true;dojo.provide("dojo.html");(function(){var _1cc6=0,d=dojo;dojo.html._secureForInnerHtml=function(cont){return cont.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"");};dojo.html._emptyNode=dojo.empty;dojo.html._setNodeContent=function(node,cont){d.empty(node);if(cont){if(typeof cont=="string"){cont=d._toDom(cont,node.ownerDocument);}if(!cont.nodeType&&d.isArrayLike(cont)){for(var _1cc7=cont.length,i=0;i<cont.length;i=_1cc7==cont.length?i+1:0){d.place(cont[i],node,"last");}}else{d.place(cont,node,"last");}}return node;};dojo.declare("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:false,extractContent:false,parseContent:false,constructor:function(_1cc8,node){dojo.mixin(this,_1cc8||{});node=this.node=dojo.byId(this.node||node);if(!this.id){this.id=["Setter",(node)?node.id||node.tagName:"",_1cc6++].join("_");}if(!(this.node||node)){new Error(this.declaredClass+": no node provided to "+this.id);}},set:function(cont,_1cc9){if(undefined!==cont){this.content=cont;}if(_1cc9){this._mixin(_1cc9);}this.onBegin();this.setContent();this.onEnd();return this.node;},setContent:function(){var node=this.node;if(!node){console.error("setContent given no node");}try{node=dojo.html._setNodeContent(node,this.content);}catch(e){var _1cca=this.onContentError(e);try{node.innerHTML=_1cca;}catch(e){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+e.message,e);}}this.node=node;},empty:function(){if(this.parseResults&&this.parseResults.length){dojo.forEach(this.parseResults,function(w){if(w.destroy){w.destroy();}});delete this.parseResults;}dojo.html._emptyNode(this.node);},onBegin:function(){var cont=this.content;if(dojo.isString(cont)){if(this.cleanContent){cont=dojo.html._secureForInnerHtml(cont);}if(this.extractContent){var match=cont.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);if(match){cont=match[1];}}}this.empty();this.content=cont;return this.node;},onEnd:function(){if(this.parseContent){this._parse();}return this.node;},tearDown:function(){delete this.parseResults;delete this.node;delete this.content;},onContentError:function(err){return "Error occured setting content: "+err;},_mixin:function(_1ccb){var empty={},key;for(key in _1ccb){if(key in empty){continue;}this[key]=_1ccb[key];}},_parse:function(){var _1ccc=this.node;try{this.parseResults=dojo.parser.parse(_1ccc,true);}catch(e){this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id);}},_onError:function(type,err,_1ccd){var _1cce=this["on"+type+"Error"].call(this,err);if(_1ccd){console.error(_1ccd,err);}else{if(_1cce){dojo.html._setNodeContent(this.node,_1cce,true);}}}});dojo.html.set=function(node,cont,_1ccf){if(undefined==cont){console.warn("dojo.html.set: no cont argument provided, using empty string");cont="";}if(!_1ccf){return dojo.html._setNodeContent(node,cont,true);}else{var op=new dojo.html._ContentSetter(dojo.mixin(_1ccf,{content:cont,node:node}));return op.set();}};})();}if(!dojo._hasResource["dijit.layout.ContentPane"]){dojo._hasResource["dijit.layout.ContentPane"]=true;dojo.provide("dijit.layout.ContentPane");dojo.declare("dijit.layout.ContentPane",dijit._Widget,{href:"",extractContent:false,parseOnLoad:true,preventCache:false,preload:false,refreshOnShow:false,loadingMessage:"<span class='dijitContentPaneLoading'>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'>${errorState}</span>",isLoaded:false,baseClass:"dijitContentPane",doLayout:true,ioArgs:{},isContainer:true,isLayoutContainer:true,onLoadDeferred:null,attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[]}),postMixInProperties:function(){this.inherited(arguments);var _1cd0=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=dojo.string.substitute(this.loadingMessage,_1cd0);this.errorMessage=dojo.string.substitute(this.errorMessage,_1cd0);if(!this.href&&this.srcNodeRef&&this.srcNodeRef.innerHTML){this.isLoaded=true;}},buildRendering:function(){this.inherited(arguments);if(!this.containerNode){this.containerNode=this.domNode;}},postCreate:function(){this.domNode.title="";if(!dojo.attr(this.domNode,"role")){dijit.setWaiRole(this.domNode,"group");}dojo.addClass(this.domNode,this.baseClass);},startup:function(){if(this._started){return;}var _1cd1=dijit._Contained.prototype.getParent.call(this);this._childOfLayoutWidget=_1cd1&&_1cd1.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;if(this.isLoaded){dojo.forEach(this.getChildren(),function(child){child.startup();});}if(this._isShown()||this.preload){this._onShow();}this.inherited(arguments);},_checkIfSingleChild:function(){var _1cd2=dojo.query("> *",this.containerNode).filter(function(node){return node.tagName!=="SCRIPT";}),_1cd3=_1cd2.filter(function(node){return dojo.hasAttr(node,"dojoType")||dojo.hasAttr(node,"widgetId");}),_1cd4=dojo.filter(_1cd3.map(dijit.byNode),function(_1cd5){return _1cd5&&_1cd5.domNode&&_1cd5.resize;});if(_1cd2.length==_1cd3.length&&_1cd4.length==1){this._singleChild=_1cd4[0];}else{delete this._singleChild;}dojo.toggleClass(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild);},setHref:function(href){dojo.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use attr('href', ...) instead.","","2.0");return this.attr("href",href);},_setHrefAttr:function(href){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this.href=href;if(this._created&&(this.preload||this._isShown())){this._load();}else{this._hrefChanged=true;}return this.onLoadDeferred;},setContent:function(data){dojo.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use attr('content', ...) instead.","","2.0");this.attr("content",data);},_setContentAttr:function(data){this.href="";this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this._setContent(data||"");this._isDownloaded=false;return this.onLoadDeferred;},_getContentAttr:function(){return this.containerNode.innerHTML;},cancel:function(){if(this._xhrDfd&&(this._xhrDfd.fired==-1)){this._xhrDfd.cancel();}delete this._xhrDfd;this.onLoadDeferred=null;},uninitialize:function(){if(this._beingDestroyed){this.cancel();}this.inherited(arguments);},destroyRecursive:function(_1cd6){if(this._beingDestroyed){return;}this.inherited(arguments);},resize:function(_1cd7,_1cd8){if(!this._wasShown){this._onShow();}this._resizeCalled=true;if(_1cd7){dojo.marginBox(this.domNode,_1cd7);}var cn=this.containerNode;if(cn===this.domNode){var mb=_1cd8||{};dojo.mixin(mb,_1cd7||{});if(!("h" in mb)||!("w" in mb)){mb=dojo.mixin(dojo.marginBox(cn),mb);}this._contentBox=dijit.layout.marginBox2contentBox(cn,mb);}else{this._contentBox=dojo.contentBox(cn);}this._layoutChildren();},_isShown:function(){if(this._childOfLayoutWidget){if(this._resizeCalled&&"open" in this){return this.open;}return this._resizeCalled;}else{if("open" in this){return this.open;}else{var node=this.domNode;return (node.style.display!="none")&&(node.style.visibility!="hidden")&&!dojo.hasClass(node,"dijitHidden");}}},_onShow:function(){if(this.href){if(!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow)){this.refresh();}}else{if(!this._childOfLayoutWidget&&this._needLayout){this._layoutChildren();}}this.inherited(arguments);this._wasShown=true;},refresh:function(){this.cancel();this.onLoadDeferred=new dojo.Deferred(dojo.hitch(this,"cancel"));this._load();return this.onLoadDeferred;},_load:function(){this._setContent(this.onDownloadStart(),true);var self=this;var _1cd9={preventCache:(this.preventCache||this.refreshOnShow),url:this.href,handleAs:"text"};if(dojo.isObject(this.ioArgs)){dojo.mixin(_1cd9,this.ioArgs);}var hand=(this._xhrDfd=(this.ioMethod||dojo.xhrGet)(_1cd9));hand.addCallback(function(html){try{self._isDownloaded=true;self._setContent(html,false);self.onDownloadEnd();}catch(err){self._onError("Content",err);}delete self._xhrDfd;return html;});hand.addErrback(function(err){if(!hand.canceled){self._onError("Download",err);}delete self._xhrDfd;return err;});delete this._hrefChanged;},_onLoadHandler:function(data){this.isLoaded=true;try{this.onLoadDeferred.callback(data);this.onLoad(data);}catch(e){console.error("Error "+this.widgetId+" running custom onLoad code: "+e.message);}},_onUnloadHandler:function(){this.isLoaded=false;try{this.onUnload();}catch(e){console.error("Error "+this.widgetId+" running custom onUnload code: "+e.message);}},destroyDescendants:function(){if(this.isLoaded){this._onUnloadHandler();}var _1cda=this._contentSetter;dojo.forEach(this.getChildren(),function(_1cdb){if(_1cdb.destroyRecursive){_1cdb.destroyRecursive();}});if(_1cda){dojo.forEach(_1cda.parseResults,function(_1cdc){if(_1cdc.destroyRecursive&&_1cdc.domNode&&_1cdc.domNode.parentNode==dojo.body()){_1cdc.destroyRecursive();}});delete _1cda.parseResults;}dojo.html._emptyNode(this.containerNode);delete this._singleChild;},_setContent:function(cont,_1cdd){this.destroyDescendants();var _1cde=this._contentSetter;if(!(_1cde&&_1cde instanceof dojo.html._ContentSetter)){_1cde=this._contentSetter=new dojo.html._ContentSetter({node:this.containerNode,_onError:dojo.hitch(this,this._onError),onContentError:dojo.hitch(this,function(e){var _1cdf=this.onContentError(e);try{this.containerNode.innerHTML=_1cdf;}catch(e){console.error("Fatal "+this.id+" could not change content due to "+e.message,e);}})});}var _1ce0=dojo.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:this.parseOnLoad},this._contentSetterParams||{});dojo.mixin(_1cde,_1ce0);_1cde.set((dojo.isObject(cont)&&cont.domNode)?cont.domNode:cont);delete this._contentSetterParams;if(!_1cdd){dojo.forEach(this.getChildren(),function(child){if(!this.parseOnLoad||child.getParent){child.startup();}},this);this._scheduleLayout();this._onLoadHandler(cont);}},_onError:function(type,err,_1ce1){this.onLoadDeferred.errback(err);var _1ce2=this["on"+type+"Error"].call(this,err);if(_1ce1){console.error(_1ce1,err);}else{if(_1ce2){this._setContent(_1ce2,true);}}},_scheduleLayout:function(){if(this._isShown()){this._layoutChildren();}else{this._needLayout=true;}},_layoutChildren:function(){if(this.doLayout){this._checkIfSingleChild();}if(this._singleChild&&this._singleChild.resize){var cb=this._contentBox||dojo.contentBox(this.containerNode);this._singleChild.resize({w:cb.w,h:cb.h});}else{dojo.forEach(this.getChildren(),function(_1ce3){if(_1ce3.resize){_1ce3.resize();}});}delete this._needLayout;},onLoad:function(data){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage;},onContentError:function(error){},onDownloadError:function(error){return this.errorMessage;},onDownloadEnd:function(){}});}if(!dojo._hasResource["dijit.TooltipDialog"]){dojo._hasResource["dijit.TooltipDialog"]=true;dojo.provide("dijit.TooltipDialog");dojo.declare("dijit.TooltipDialog",[dijit.layout.ContentPane,dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{title:"",doLayout:false,autofocus:true,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:dojo.cache("dijit","templates/TooltipDialog.html","<div waiRole=\"presentation\">\n\t<div class=\"dijitTooltipContainer\" waiRole=\"presentation\">\n\t\t<div class =\"dijitTooltipContents dijitTooltipFocusNode\" dojoAttachPoint=\"containerNode\" tabindex=\"-1\" waiRole=\"dialog\"></div>\n\t</div>\n\t<div class=\"dijitTooltipConnector\" waiRole=\"presentation\"></div>\n</div>\n"),postCreate:function(){this.inherited(arguments);this.connect(this.containerNode,"onkeypress","_onKey");this.containerNode.title=this.title;},orient:function(node,_1ce4,_1ce5){var c=this._currentOrientClass;if(c){dojo.removeClass(this.domNode,c);}c="dijitTooltipAB"+(_1ce5.charAt(1)=="L"?"Left":"Right")+" dijitTooltip"+(_1ce5.charAt(0)=="T"?"Below":"Above");dojo.addClass(this.domNode,c);this._currentOrientClass=c;},onOpen:function(pos){this.orient(this.domNode,pos.aroundCorner,pos.corner);this._onShow();if(this.autofocus){this._getFocusItems(this.containerNode);dijit.focus(this._firstFocusItem);}},onClose:function(){this.onHide();},_onKey:function(evt){var node=evt.target;var dk=dojo.keys;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.containerNode);}var _1ce6=(this._firstFocusItem==this._lastFocusItem);if(evt.charOrCode==dk.ESCAPE){setTimeout(dojo.hitch(this,"onCancel"),0);dojo.stopEvent(evt);}else{if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_1ce6){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_1ce6){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{if(evt.charOrCode===dk.TAB){evt.stopPropagation();}}}}}});}if(!dojo._hasResource["dijit.Dialog"]){dojo._hasResource["dijit.Dialog"]=true;dojo.provide("dijit.Dialog");dojo.declare("dijit._DialogBase",[dijit._Templated,dijit.form._FormMixin,dijit._DialogMixin],{templateString:dojo.cache("dijit","templates/Dialog.html","<div class=\"dijitDialog\" tabindex=\"-1\" waiRole=\"dialog\" waiState=\"labelledby-${id}_title\">\n\t<div dojoAttachPoint=\"titleBar\" class=\"dijitDialogTitleBar\">\n\t<span dojoAttachPoint=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\n\t<span dojoAttachPoint=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" dojoAttachEvent=\"onclick: onCancel, onmouseenter: _onCloseEnter, onmouseleave: _onCloseLeave\" title=\"${buttonCancel}\">\n\t\t<span dojoAttachPoint=\"closeText\" class=\"closeText\" title=\"${buttonCancel}\">x</span>\n\t</span>\n\t</div>\n\t\t<div dojoAttachPoint=\"containerNode\" class=\"dijitDialogPaneContent\"></div>\n</div>\n"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{title:[{node:"titleNode",type:"innerHTML"},{node:"titleBar",type:"attribute"}],"aria-describedby":""}),open:false,duration:dijit.defaultDuration,refocus:true,autofocus:true,_firstFocusItem:null,_lastFocusItem:null,doLayout:false,draggable:true,"aria-describedby":"",postMixInProperties:function(){var _1ce7=dojo.i18n.getLocalization("dijit","common");dojo.mixin(this,_1ce7);this.inherited(arguments);},postCreate:function(){dojo.style(this.domNode,{display:"none",position:"absolute"});dojo.body().appendChild(this.domNode);this.inherited(arguments);this.connect(this,"onExecute","hide");this.connect(this,"onCancel","hide");this._modalconnects=[];},onLoad:function(){this._position();this.inherited(arguments);},_endDrag:function(e){if(e&&e.node&&e.node===this.domNode){this._relativePosition=dojo.position(e.node);}},_setup:function(){var node=this.domNode;if(this.titleBar&&this.draggable){this._moveable=(dojo.isIE==6)?new dojo.dnd.TimedMoveable(node,{handle:this.titleBar}):new dojo.dnd.Moveable(node,{handle:this.titleBar,timeout:0});this._dndListener=dojo.subscribe("/dnd/move/stop",this,"_endDrag");}else{dojo.addClass(node,"dijitDialogFixed");}this.underlayAttrs={dialogId:this.id,"class":dojo.map(this["class"].split(/\s/),function(s){return s+"_underlay";}).join(" ")};this._fadeIn=dojo.fadeIn({node:node,duration:this.duration,beforeBegin:dojo.hitch(this,function(){var _1ce8=dijit._underlay;if(!_1ce8){_1ce8=dijit._underlay=new dijit.DialogUnderlay(this.underlayAttrs);}else{_1ce8.attr(this.underlayAttrs);}var _1ce9=948+dijit._dialogStack.length*2;dojo.style(dijit._underlay.domNode,"zIndex",_1ce9);dojo.style(this.domNode,"zIndex",_1ce9+1);_1ce8.show();}),onEnd:dojo.hitch(this,function(){if(this.autofocus){this._getFocusItems(this.domNode);dijit.focus(this._firstFocusItem);}})});this._fadeOut=dojo.fadeOut({node:node,duration:this.duration,onEnd:dojo.hitch(this,function(){node.style.display="none";var ds=dijit._dialogStack;if(ds.length==0){dijit._underlay.hide();}else{dojo.style(dijit._underlay.domNode,"zIndex",948+ds.length*2);dijit._underlay.attr(ds[ds.length-1].underlayAttrs);}if(this.refocus){var focus=this._savedFocus;if(ds.length>0){var pd=ds[ds.length-1];if(!dojo.isDescendant(focus.node,pd.domNode)){pd._getFocusItems(pd.domNode);focus=pd._firstFocusItem;}}dijit.focus(focus);}})});},uninitialize:function(){var _1cea=false;if(this._fadeIn&&this._fadeIn.status()=="playing"){_1cea=true;this._fadeIn.stop();}if(this._fadeOut&&this._fadeOut.status()=="playing"){_1cea=true;this._fadeOut.stop();}if((this.open||_1cea)&&!dijit._underlay._destroyed){dijit._underlay.hide();}if(this._moveable){this._moveable.destroy();}this.inherited(arguments);},_size:function(){this._checkIfSingleChild();if(this._singleChild){if(this._singleChildOriginalStyle){this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle;}delete this._singleChildOriginalStyle;}else{dojo.style(this.containerNode,{width:"auto",height:"auto"});}var mb=dojo.marginBox(this.domNode);var _1ceb=dijit.getViewport();if(mb.w>=_1ceb.w||mb.h>=_1ceb.h){var w=Math.min(mb.w,Math.floor(_1ceb.w*0.75)),h=Math.min(mb.h,Math.floor(_1ceb.h*0.75));if(this._singleChild&&this._singleChild.resize){this._singleChildOriginalStyle=this._singleChild.domNode.style.cssText;this._singleChild.resize({w:w,h:h});}else{dojo.style(this.containerNode,{width:w+"px",height:h+"px",overflow:"auto",position:"relative"});}}else{if(this._singleChild&&this._singleChild.resize){this._singleChild.resize();}}},_position:function(){if(!dojo.hasClass(dojo.body(),"dojoMove")){var node=this.domNode,_1cec=dijit.getViewport(),p=this._relativePosition,bb=p?null:dojo._getBorderBox(node),l=Math.floor(_1cec.l+(p?p.x:(_1cec.w-bb.w)/2)),t=Math.floor(_1cec.t+(p?p.y:(_1cec.h-bb.h)/2));dojo.style(node,{left:l+"px",top:t+"px"});}},_onKey:function(evt){var ds=dijit._dialogStack;if(ds[ds.length-1]!=this){return;}if(evt.charOrCode){var dk=dojo.keys;var node=evt.target;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.domNode);}var _1ced=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_1ced){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_1ced){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{while(node){if(node==this.domNode||dojo.hasClass(node,"dijitPopup")){if(evt.charOrCode==dk.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==dk.TAB){dojo.stopEvent(evt);}else{if(!dojo.isOpera){try{this._firstFocusItem.focus();}catch(e){}}}}}}},show:function(){if(this.open){return;}if(!this._alreadyInitialized){this._setup();this._alreadyInitialized=true;}if(this._fadeOut.status()=="playing"){this._fadeOut.stop();}this._modalconnects.push(dojo.connect(window,"onscroll",this,"layout"));this._modalconnects.push(dojo.connect(window,"onresize",this,function(){var _1cee=dijit.getViewport();if(!this._oldViewport||_1cee.h!=this._oldViewport.h||_1cee.w!=this._oldViewport.w){this.layout();this._oldViewport=_1cee;}}));this._modalconnects.push(dojo.connect(dojo.doc.documentElement,"onkeypress",this,"_onKey"));dojo.style(this.domNode,{opacity:0,display:""});this.open=true;this._onShow();this._size();this._position();dijit._dialogStack.push(this);this._fadeIn.play();this._savedFocus=dijit.getFocus(this);},hide:function(){var ds=dijit._dialogStack;if(!this._alreadyInitialized||this!=ds[ds.length-1]){return;}if(this._fadeIn.status()=="playing"){this._fadeIn.stop();}ds.pop();this._fadeOut.play();if(this._scrollConnected){this._scrollConnected=false;}dojo.forEach(this._modalconnects,dojo.disconnect);this._modalconnects=[];if(this._relativePosition){delete this._relativePosition;}this.open=false;this.onHide();},layout:function(){if(this.domNode.style.display!="none"){if(dijit._underlay){dijit._underlay.layout();}this._position();}},destroy:function(){dojo.forEach(this._modalconnects,dojo.disconnect);if(this.refocus&&this.open){setTimeout(dojo.hitch(dijit,"focus",this._savedFocus),25);}if(this._dndListener){dojo.unsubscribe(this._dndListener);}this.inherited(arguments);},_onCloseEnter:function(){dojo.addClass(this.closeButtonNode,"dijitDialogCloseIcon-hover");},_onCloseLeave:function(){dojo.removeClass(this.closeButtonNode,"dijitDialogCloseIcon-hover");}});dojo.declare("dijit.Dialog",[dijit.layout.ContentPane,dijit._DialogBase],{});dijit._dialogStack=[];}if(!dojo._hasResource["com.ibm.mm.builder.utils.htmlUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.htmlUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.htmlUtil");com.ibm.mm.builder.utils.htmlUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.htmlUtil");if(this.widgetType!==null&&this.widgetType=="mm_OSGadget"){com.ibm.mm.builder.utils.htmlUtil.widgetClass=new RegExp("\\b"+com.ibm.mm.builder.constant.mmGGadget+"\\b");}else{com.ibm.mm.builder.utils.htmlUtil.widgetClass=new RegExp("\\b"+com.ibm.mm.builder.constant.mmIWidget+"\\b");}com.ibm.mm.builder.utils.htmlUtil.classMatchType={ContainsAll:0,ContainsAny:1,IsOnly:2};com.ibm.mm.builder.utils.htmlUtil.endsWith=function(str,end,_1cef){if(_1cef){str=str.toLowerCase();end=end.toLowerCase();}if((str.length-end.length)<0){return false;}return str.lastIndexOf(end)==str.length-end.length;};com.ibm.mm.builder.utils.htmlUtil.startsWith=function(str,start,_1cf0){if(_1cf0){str=str.toLowerCase();start=start.toLowerCase();}return str.indexOf(start)===0;};com.ibm.mm.builder.utils.htmlUtil.getAttribute=function(node,attr){node=dojo.byId(node);if((!node)||(!node.getAttribute)){return null;}var ta=typeof attr=="string"?attr:new String(attr);var v=node.getAttribute(ta.toUpperCase());if((v)&&(typeof v=="string")&&(v!="")){return v;}if(v&&v.value){return v.value;}if((node.getAttributeNode)&&(node.getAttributeNode(ta))){return (node.getAttributeNode(ta)).value;}else{if(node.getAttribute(ta)){return node.getAttribute(ta);}else{if(node.getAttribute(ta.toLowerCase())){return node.getAttribute(ta.toLowerCase());}}}return null;};com.ibm.mm.builder.utils.htmlUtil.getParentByType=function(node,type){var _1cf1=dojo.doc;var _1cf2=dojo.byId(node);type=type.toLowerCase();while((_1cf2)&&(_1cf2.nodeName.toLowerCase()!=type)){if(_1cf2==(_1cf1.body||_1cf1.documentElement)){return null;}_1cf2=_1cf2.parentNode;}return _1cf2;};com.ibm.mm.builder.utils.htmlUtil.hasAttribute=function(node,attr){return com.ibm.mm.builder.utils.htmlUtil.getAttribute(dojo.byId(node),attr)?true:false;};com.ibm.mm.builder.utils.htmlUtil.hasClass=function(node,_1cf3){return (new RegExp("(^|\\s+)"+_1cf3+"(\\s+|$)")).test(com.ibm.mm.builder.utils.htmlUtil.getClass(node));};com.ibm.mm.builder.utils.htmlUtil.addClass=function(node,_1cf4){if(com.ibm.mm.builder.utils.htmlUtil.hasClass(node,_1cf4)){return false;}_1cf4=(com.ibm.mm.builder.utils.htmlUtil.getClass(node)+" "+_1cf4).replace(/^\s+|\s+$/g,"");return com.ibm.mm.builder.utils.htmlUtil.setClass(node,_1cf4);};com.ibm.mm.builder.utils.htmlUtil.setClass=function(node,_1cf5){node=dojo.byId(node);var cs=new String(_1cf5);try{if(typeof node.className=="string"){node.className=cs;}else{if(node.setAttribute){node.setAttribute("class",_1cf5);node.className=cs;}else{return false;}}}catch(e){com.ibm.mm.builder.utils.htmlUtil.LOGGER.severe("setClass",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_HTML_UTIL_SET_CLASS_1,[e.message]));}return true;};com.ibm.mm.builder.utils.htmlUtil.getClass=function(node){node=dojo.byId(node);if(!node){return "";}var cs="";if(node.className){cs=node.className;}else{if(com.ibm.mm.builder.utils.htmlUtil.hasAttribute(node,"class")){cs=com.ibm.mm.builder.utils.htmlUtil.getAttribute(node,"class");}}return cs.replace(/^\s+|\s+$/g,"");};com.ibm.mm.builder.utils.htmlUtil.getClasses=function(node){var c=com.ibm.mm.builder.utils.htmlUtil.getClass(node);return (c=="")?[]:c.split(/\s+/g);};com.ibm.mm.builder.utils.htmlUtil.getChildrenbyClass=function(_1cf6,_1cf7){var _1cf8=dojo.query("."+_1cf6,_1cf7);var len=_1cf8.length;var _1cf9=[];for(var x=0;x<len;x++){if(com.ibm.mm.builder.utils.htmlUtil.isDirectChild(_1cf8[x],_1cf7)){_1cf9.push(_1cf8[x]);}}return _1cf9;};com.ibm.mm.builder.utils.htmlUtil.setUnderlayBgColor=function(){var _1cfa=document.getElementsByTagName("BODY")[0];var tags=dojo.query(".dijitDialogUnderlay",_1cfa);var len=tags.length;for(var k=0;k<len;k++){dojo.style(tags[k],{background:"black",opacity:"0.35",filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0.35"});}};com.ibm.mm.builder.utils.htmlUtil.isDirectChild=function(child,_1cfb){var _1cfc=child.className;var pNode=child.parentNode;while(pNode!=_1cfb){if(pNode.className==_1cfc){return false;}else{pNode=pNode.parentNode;}}return true;};com.ibm.mm.builder.utils.htmlUtil.getDirectChildrenbyClass=function(_1cfd,_1cfe){var _1cff=dojo.query("."+_1cfd,_1cfe);var len=_1cff.length;var _1d00=[];for(var x=0;x<len;x++){if(_1cff[x].parentNode==_1cfe){_1d00.push(_1cff[x]);}}return _1d00;};com.ibm.mm.builder.utils.htmlUtil.combineTwoColumn=function(root,left,right){if(this.endsWith(root,"/>")){root=root.substr(0,root.length-2);root=root+">\n";}else{if(this.endsWith(root,"</div>",true)){root=root.substr(0,root.length-6)+"\n";}else{return "";}}root=root+left;root=root+right;root=root+"</div>";return root;};com.ibm.mm.builder.utils.htmlUtil.getElementById=function(_1d01,tagId){var _1d02=null;var _1d03=_1d01.getElementsByTagName("*");for(var ii=0;ii<_1d03.length;ii++){if(_1d03[ii].id==tagId){_1d02=_1d03[ii];break;}}return (_1d02);};com.ibm.mm.builder.utils.htmlUtil.getElementsByClassName=function(){var _1d04=[];var _1d05=["div","span"];for(index=0;index<_1d05.length;index++){els=document.getElementsByTagName(_1d05[index]);var _1d06=els.length;for(var i=0;i<_1d06;i++){if(this.widgetClass.test(els[i].className)){_1d04[_1d04.length]=els[i];}}}return _1d04;};com.ibm.mm.builder.utils.htmlUtil.getElementString=function(node){var ndiv=document.createElement("div");var _1d07=node.cloneNode(true);ndiv.appendChild(_1d07);return ndiv.innerHTML;};com.ibm.mm.builder.utils.htmlUtil.getInclosedWidgets=function(node){var _1d08=[];if(node!==null){var _1d09=this.getElementsByClassName();if(_1d09&&_1d09.length>0){for(var index=0;index<_1d09.length;index++){var aNode=_1d09[index];if(node==this.getWidgetParent(aNode)){_1d08[_1d08.length]=aNode;}}}}return _1d08;};com.ibm.mm.builder.utils.htmlUtil.getChildWidgets=function(_1d0a){var _1d0b=[];if(_1d0a){var aNode=dojo.byId(_1d0a);var _1d0c=aNode.childNodes;if(_1d0c!==null&&_1d0c.length>0){for(var index=0;index<_1d0c.length;index++){child=_1d0c[index];if(child){if(this.widgetClass.test(child.className)){_1d0b[_1d0b.length]=child;}else{children=checkChildElement(child);if(children!==null){for(ii=0;ii<children.length;ii++){_1d0b[_1d0b.length]=children[ii];}}}}}}}return _1d0b;};com.ibm.mm.builder.utils.htmlUtil.checkParentElement=function(_1d0d){if(_1d0d){var _1d0e=_1d0d.parentNode;if(_1d0e){if(_1d0e.className){if(this.widgetClass.test(_1d0e.className)){return _1d0e.id;}}return this.checkParentElement(_1d0e);}}return null;};com.ibm.mm.builder.utils.htmlUtil.prependChild=function(node,_1d0f){if(_1d0f.firstChild){_1d0f.insertBefore(node,_1d0f.firstChild);}else{_1d0f.appendChild(node);}return true;};com.ibm.mm.builder.utils.htmlUtil.disableSelection=function(_1d10){_1d10=dojo.byId(_1d10)||dojo.body();if(dojo.isMoz){_1d10.style.MozUserSelect="none";}else{if(dojo.isSafari){_1d10.style.KhtmlUserSelect="none";}else{if(dojo.isIE){_1d10.unselectable="on";}else{return false;}}}return true;};com.ibm.mm.builder.utils.htmlUtil.getWidgetParent=function(id){if(id===null){return null;}return this.checkParentElement(dojo.byId(id));};com.ibm.mm.builder.utils.htmlUtil.setStyle=function(){var node=arguments[0];for(var i=1;i<arguments.length;i++){stylePair=arguments[i].split(":");node.style[stylePair[0]]=stylePair[1];}};com.ibm.mm.builder.utils.htmlUtil.createRadioButton=function(_1d11,_1d12,_1d13,_1d14,title){var _1d15="<input type='radio' name='";_1d15=_1d15+_1d11+(title?("' title='"+title):"")+"' value='";_1d15=_1d15+_1d12+"' onclick='";_1d15=_1d15+_1d13+"'";if(_1d14){_1d15=_1d15+" checked>";}else{_1d15=_1d15+">";}return _1d15;};com.ibm.mm.builder.utils.htmlUtil.getLimitedString=function(text,_1d16){if(!text){return "";}if(text.length>_1d16){text=text.substr(0,_1d16)+"...";}return text;};com.ibm.mm.builder.utils.htmlUtil.addShadow=function(_1d17,_1d18){for(var i=0;i<_1d18.length;i++){var div=document.createElement("div");div.className=_1d18[i];_1d17.appendChild(div);}};com.ibm.mm.builder.utils.htmlUtil.getSubstitute=function(_1d19,args){if(_1d19&&args){return dojo.string.substitute(_1d19,args);}return _1d19;};com.ibm.mm.builder.utils.htmlUtil.getCurrentStyle=function(obj,prop){if(obj.currentStyle){var _1d1a=obj.currentStyle[prop];if(ibmConfig.fontSizeEnlarged&&prop==="fontSize"&&_1d1a.match(/em/)){var p=obj.parentNode;var _1d1b=false;while(p&&p.tagName.toLowerCase()!="body"){if(dojo.hasClass(p,"dialog_container")){_1d1b=true;break;}p=p.parentNode;}if(_1d1b){var _1d1c=parseFloat(_1d1a.replace("em",""));var _1d1d=parseFloat((p.currentStyle[prop]).replace("em",""));_1d1a=_1d1c*_1d1d+"em";}}return _1d1a;}else{if(window.getComputedStyle){prop=prop.replace(/([A-Z])/g,"-$1");prop=prop.toLowerCase();return window.getComputedStyle(obj,"").getPropertyValue(prop);}}return null;};com.ibm.mm.builder.utils.htmlUtil.createElementWithClass=function(type,_1d1e,_1d1f){var node=document.createElement(type);dojo.addClass(node,_1d1e);if(_1d1f){node.innerHTML=_1d1f;}return node;};com.ibm.mm.builder.utils.htmlUtil.getStrWidthByFontStyle=function(str,_1d20,_1d21,_1d22){if(!this.stringCheckDiv){this.stringCheckDiv=document.createElement("span");this.stringCheckDiv.style.whiteSpace="nowrap";this.stringCheckDiv.style.position="absolute";document.body.appendChild(this.stringCheckDiv);}_1d20=_1d20||this.getCurrentStyle(document.body,"fontSize")||"";_1d21=_1d21||this.getCurrentStyle(document.body,"fontFamily")||"";_1d22=_1d22||this.getCurrentStyle(document.body,"fontWeight")||"";this.stringCheckDiv.style.fontSize=_1d20;this.stringCheckDiv.style.fontFamily=_1d21;this.stringCheckDiv.style.fontWeight=_1d22;this.stringCheckDiv.innerHTML=this.formatBlankSpace(str);this.stringCheckDiv.style.display="";var w=this.stringCheckDiv.scrollWidth;this.stringCheckDiv.style.display="none";return w;};com.ibm.mm.builder.utils.htmlUtil.getStrWidth=function(str,node,_1d23){if(_1d23&&_1d23.fontSize){this._fontSize=_1d23.fontSize;this._fontFamily=_1d23.fontFamily||"Arial,Helvetica,sans-serif";this._fontWeight=_1d23.fontWeight||"normal";return this.getStrWidthByFontStyle(str,this._fontSize,this._fontFamily,this._fontWeight);}if(node){this._fontSize=this._fontFamily=this._fontWeight=null;while(node&&!(this._fontSize&&this._fontFamily&&this._fontWeight)){if(!this._fontSize){this._fontSize=this.getCurrentStyle(node,"fontSize");}if(!this._fontFamily){this._fontFamily=this.getCurrentStyle(node,"fontFamily");}if(!this._fontWeight){this._fontWeight=this.getCurrentStyle(node,"fontWeight");}node=node.parentNode;}}return this.getStrWidthByFontStyle(str,this._fontSize,this._fontFamily,this._fontWeight);};com.ibm.mm.builder.utils.htmlUtil.getStrWithLimit=function(str,node,_1d24,_1d25){if(!str||str.length<=0||!_1d24||_1d24<=0){return "";}var delta=2;var _1d26=0.618;var _1d27=str.substring(0,1)+"...";var _1d28=this.getStrWidth(_1d27,node,_1d25);if(_1d24<=_1d28){return _1d27;}var width=this.getStrWidth(str,node,_1d25);if(width<_1d24){return str;}else{var begin=0;var end=str.length;while(begin<end){if(end-begin<=delta){while(this.getStrWidth(str.substring(0,begin)+"...")>_1d24){begin-=1;}return (str.substring(0,begin)+"...");}var index=begin+Math.round((end-begin)*_1d26);var _1d29=this.getStrWidth(str.substring(0,index));if(_1d29<_1d24){begin=index;end=end;}else{begin=begin;end=index;}}}};com.ibm.mm.builder.utils.htmlUtil.truncateAllChildNodesText=function(node,_1d2a,_1d2b){dojo.forEach(dojo.query(".truncatedLabel",node),function(item){com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(item,_1d2a,_1d2b);});};com.ibm.mm.builder.utils.htmlUtil.truncateNodeText=function(node,_1d2c,_1d2d){var _1d2e=(node.tagName.toLowerCase()==="input")?"value":"innerHTML";if(!_1d2c){_1d2c="title";}var _1d2f=0;var str=node[_1d2e];if(str.length===0){return;}if(dojo.hasAttr(node,"widthlimit")){_1d2f=parseInt(dojo.attr(node,"widthlimit"),10);}else{_1d2f=dojo.contentBox(node).w;if(_1d2f===0){_1d2f=parseInt(dojo.style(node,"width"),10);}}if(_1d2f>0){var _1d30=com.ibm.mm.builder.utils.htmlUtil.getStrWithLimit(str,node,_1d2f,_1d2d);if(_1d30.length<=str.length+2&&!dojo.hasAttr(node,_1d2c)){dojo.attr(node,_1d2c,this.unEscapeString(str));}node[_1d2e]=(_1d2e==="innerHTML"&&(!dojo.hasAttr(node,"keepBlankSpace")))?this.formatBlankSpace(_1d30):_1d30;}};com.ibm.mm.builder.utils.htmlUtil.truncateAllChildNodesWord=function(node){dojo.forEach(dojo.query(".wordTruncatedLabel",node),function(item){com.ibm.mm.builder.utils.htmlUtil.truncateWord(item);});};com.ibm.mm.builder.utils.htmlUtil.truncateWord=function(node,_1d31,_1d32){if(ibmConfig.fontSizeEnlarged){return _1d31;}if(!node){return _1d31;}var _1d33=(node.tagName.toLowerCase()==="input")?"value":"innerHTML";var str=_1d31||node[_1d33];if(str.length===0){return _1d31;}var _1d34=str.split(" ");if(!_1d32&&dojo.hasAttr(node,"widthlimit")){_1d32=parseInt(dojo.attr(node,"widthlimit"),10);}var width=_1d32?_1d32:dojo.contentBox(node).w;dojo.forEach(_1d34,function(_1d35,index){_1d34[index]=com.ibm.mm.builder.utils.htmlUtil.getStrWithLimit(_1d35,node,width);});var _1d36=_1d34.join(" ");var _1d37=(_1d33==="innerHTML"&&(!dojo.hasAttr(node,"keepBlankSpace")))?this.formatBlankSpace(_1d36):_1d36;if(!str){node[_1d33]=_1d37;}else{return _1d37;}};com.ibm.mm.builder.utils.htmlUtil.markTruncation=function(node,_1d38){dojo.addClass(node,"truncatedLabel");dojo.attr(node,"widthLimit",_1d38);};com.ibm.mm.builder.utils.htmlUtil.formatBlankSpace=function(title){if(!title){return "";}return title.replace(/\s/g,"&nbsp;");};com.ibm.mm.builder.utils.htmlUtil.formatDisplayedContent=function(_1d39,_1d3a,_1d3b){if(!_1d39){return "";}if(!_1d3a){_1d39=_1d39.replace(/&/g,"&amp;");}if(!_1d3b){_1d39=_1d39.replace(/\s/g,"&nbsp;");}return _1d39;};com.ibm.mm.builder.utils.htmlUtil.escapeString=function(_1d3c){if(!_1d3c){return "";}return _1d3c.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;");};com.ibm.mm.builder.utils.htmlUtil.unEscapeString=function(_1d3d){if(!_1d3d){return "";}return _1d3d.replace(/&amp;/g,"&").replace(/&quot;/g,"\"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ");};com.ibm.mm.builder.utils.htmlUtil.formatMessage=function(str){if(!str||str.length<=0){return "";}else{var _1d3e=str.indexOf("\n");if(_1d3e>0){var _1d3f=str.substring(0,_1d3e);var _1d40=str.substring(_1d3e);return "<div class='firstLineFont truncatedLabel' widthLimit='400'>"+_1d3f+"</div><span class='leftLineFont'>"+_1d40.replace(/\n/g,"<br/>")+"</span>";}else{return str.replace(/\n/g,"<br/>");}}};com.ibm.mm.builder.utils.htmlUtil.setNodeTitle=function(_1d41,_1d42,_1d43){if(!_1d42||!_1d41){return;}if(!_1d43||_1d43<=0){try{var _1d44=this.getCurrentStyle(_1d42,"width");_1d43=(_1d44=="auto")?_1d44:parseFloat(_1d44.match(/\d*\.?\d*/));}catch(e){_1d43=null;}}_1d42.title="";if(!_1d43||_1d43=="auto"){_1d42.innerHTML=this.formatBlankSpace(_1d41);return;}var _1d45=this.getStrWithLimit(_1d41,_1d42,_1d43);_1d42.innerHTML=this.formatBlankSpace(_1d45);if(_1d41!=_1d45){_1d42.title=this.unEscapeString(_1d41);}};com.ibm.mm.builder.utils.htmlUtil.setNodeTitleWithStyle=function(_1d46,_1d47,_1d48,_1d49){if(!_1d47||!_1d48||!_1d46||_1d48<=0||!_1d49){return;}_1d47.title="";var _1d4a=this.getStrWithLimit(_1d46,_1d47,_1d48,_1d49);if(_1d47.tagName=="INPUT"){_1d47.value=_1d4a;}else{_1d47.innerHTML=this.formatDisplayedContent(_1d4a);}if(_1d46!=_1d4a){_1d47.title=_1d46;}};com.ibm.mm.builder.utils.htmlUtil.setCombinedStringInNode=function(label,_1d4b,node,_1d4c,_1d4d){var _1d4e=this.getStrWidth(label,node);if(_1d4e>_1d4c){var title=dojo.string.substitute(label,[_1d4b]);this.setNodeTitle(title,node,_1d4c);return;}var _1d4f=document.createElement("span");_1d4f.className=_1d4d;node.appendChild(_1d4f);var _1d50=this.getStrWithLimit(_1d4b,_1d4f,_1d4c-_1d4e);var _1d51=dojo.string.substitute(label,["<span class=\""+_1d4d+"\">"+this.formatDisplayedContent(_1d50)+"</span>"]);node.removeChild(_1d4f);node.innerHTML=_1d51;if(_1d50!=_1d4b){node.title=dojo.string.substitute(label,[_1d4b]);}};com.ibm.mm.builder.utils.htmlUtil.loadCss=function(_1d52){this.loadedCss=this.loadedCss||[];for(var i=0;i<this.loadedCss.length;i++){var css=this.loadedCss[i];if(css==_1d52){return;}}var _1d53=document.getElementsByTagName("head")[0];var _1d54=document.createElement("link");_1d54.type="text/css";_1d54.rel="stylesheet";_1d54.href=_1d52;_1d54.media="screen";_1d53.appendChild(_1d54);this.loadedCss.push(_1d52);};com.ibm.mm.builder.utils.htmlUtil.removeIframe=function(node){if(!node){return;}var _1d55=dojo.query("iframe",node)[0];if(_1d55){_1d55.parentNode.removeChild(_1d55);}};com.ibm.mm.builder.utils.htmlUtil.showNodes=function(nodes){dojo.forEach(nodes,function(node){if(node.style){node.style.display="";}});};com.ibm.mm.builder.utils.htmlUtil.hideNodes=function(nodes){dojo.forEach(nodes,function(node){if(node.style){node.style.display="none";}});};com.ibm.mm.builder.utils.htmlUtil.releaseNode=function(node){if(node){try{node.onmouseout=null;node.onmousemove=null;node.onclick=null;node.onfocus=null;node.onkeypress=null;node.innerHTML="";}catch(e){}}};com.ibm.mm.builder.utils.htmlUtil.uncheckAll=function(_1d56){dojo.forEach(_1d56,function(item){var _1d57=dojo.query("input",item);if(_1d57){var _1d58=dojo.query("input",item)[0];_1d58.checked=false;}});};com.ibm.mm.builder.utils.htmlUtil.getAllCheckedNodes=function(pNode){var _1d59=[];dojo.forEach(pNode.childNodes,function(item){var _1d5a=dojo.query("input",item)[0];if(_1d5a.checked){_1d59.push(item);}});return _1d59;};com.ibm.mm.builder.utils.htmlUtil.showScrollBar=function(_1d5b){if(_1d5b!="layoutwidget"){return;}var _1d5c=dojo.byId(_1d5b);if(!_1d5c){return;}var _1d5d=_1d5c.parentNode;while(_1d5d){if(_1d5d.nodeName.toLowerCase()==="#document"){break;}_1d5d=_1d5d.parentNode;}if(!_1d5d){return;}_1d5d=_1d5c.parentNode.parentNode.parentNode;if(dojo.isIE&&(_1d5d.URL.match(/mycontenthandler/))){var rDiv=dojo.query(".mm_Content > div",_1d5c)[0];if(rDiv){rDiv.style.position="static";}var _1d5e=dojo.query(".wrapper",_1d5c)[0];if(_1d5e){_1d5e.style.position="static";}}};com.ibm.mm.builder.utils.htmlUtil.addMissingQuoteInTitle=function(str){if(!str){return "";}return str.replace(/title\s*=\s*\${([^}]+)}/g,"title=\"${$1}\"");};}if(!dojo._hasResource["dojox.layout.ResizeHandle"]){dojo._hasResource["dojox.layout.ResizeHandle"]=true;dojo.provide("dojox.layout.ResizeHandle");dojo.experimental("dojox.layout.ResizeHandle");dojo.declare("dojox.layout.ResizeHandle",[dijit._Widget,dijit._Templated],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:false,activeResizeClass:"dojoxResizeHandleClone",animateSizing:true,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:false,maxHeight:0,maxWidth:0,fixedAspect:false,intermediateChanges:false,startTopic:"/dojo/resize/start",endTopic:"/dojo/resize/stop",templateString:"<div dojoAttachPoint=\"resizeHandle\" class=\"dojoxResizeHandle\"><div></div></div>",postCreate:function(){this.connect(this.resizeHandle,"onmousedown","_beginSizing");if(!this.activeResize){this._resizeHelper=dijit.byId("dojoxGlobalResizeHelper");if(!this._resizeHelper){this._resizeHelper=new dojox.layout._ResizeHelper({id:"dojoxGlobalResizeHelper"}).placeAt(dojo.body());dojo.addClass(this._resizeHelper.domNode,this.activeResizeClass);}}else{this.animateSizing=false;}if(!this.minSize){this.minSize={w:this.minWidth,h:this.minHeight};}if(this.constrainMax){this.maxSize={w:this.maxWidth,h:this.maxHeight};}this._resizeX=this._resizeY=false;var _1d5f=dojo.partial(dojo.addClass,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=true;_1d5f("dojoxResizeNW");break;case "x":this._resizeX=true;_1d5f("dojoxResizeW");break;case "y":this._resizeY=true;_1d5f("dojoxResizeN");break;}},_beginSizing:function(e){if(this._isSizing){return false;}dojo.publish(this.startTopic,[this]);this.targetWidget=dijit.byId(this.targetId);this.targetDomNode=this.targetWidget?this.targetWidget.domNode:dojo.byId(this.targetId);if(this.targetContainer){this.targetDomNode=this.targetContainer;}if(!this.targetDomNode){return false;}if(!this.activeResize){var c=dojo.coords(this.targetDomNode,true);this._resizeHelper.resize({l:c.x,t:c.y,w:c.w,h:c.h});this._resizeHelper.show();}this._isSizing=true;this.startPoint={x:e.clientX,y:e.clientY};var mb=this.targetWidget?dojo.marginBox(this.targetDomNode):dojo.contentBox(this.targetDomNode);this.startSize={w:mb.w,h:mb.h};if(this.fixedAspect){var max,val;if(mb.w>mb.h){max="w";val=mb.w/mb.h;}else{max="h";val=mb.h/mb.w;}this._aspect={prop:max};this._aspect[max]=val;}this._pconnects=[];this._pconnects.push(dojo.connect(dojo.doc,"onmousemove",this,"_updateSizing"));this._pconnects.push(dojo.connect(dojo.doc,"onmouseup",this,"_endSizing"));dojo.stopEvent(e);},_updateSizing:function(e){if(this.activeResize){this._changeSizing(e);}else{var tmp=this._getNewCoords(e);if(tmp===false){return;}this._resizeHelper.resize(tmp);}e.preventDefault();},_getNewCoords:function(e){try{if(!e.clientX||!e.clientY){return false;}}catch(e){return false;}this._activeResizeLastEvent=e;var dx=this.startPoint.x-e.clientX,dy=this.startPoint.y-e.clientY,newW=this.startSize.w-(this._resizeX?dx:0),newH=this.startSize.h-(this._resizeY?dy:0);return this._checkConstraints(newW,newH);},_checkConstraints:function(newW,newH){if(this.minSize){var tm=this.minSize;if(newW<tm.w){newW=tm.w;}if(newH<tm.h){newH=tm.h;}}if(this.constrainMax&&this.maxSize){var ms=this.maxSize;if(newW>ms.w){newW=ms.w;}if(newH>ms.h){newH=ms.h;}}if(this.fixedAspect){var ta=this._aspect[this._aspect.prop];if(newW<newH){newH=newW*ta;}else{if(newH<newW){newW=newH*ta;}}}return {w:newW,h:newH};},_changeSizing:function(e){var tmp=this._getNewCoords(e);if(tmp===false){return;}if(this.targetWidget&&dojo.isFunction(this.targetWidget.resize)){this.targetWidget.resize(tmp);}else{if(this.animateSizing){var anim=dojo.fx[this.animateMethod]([dojo.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:tmp.w}},duration:this.animateDuration}),dojo.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:tmp.h}},duration:this.animateDuration})]);anim.play();}else{dojo.style(this.targetDomNode,{width:tmp.w+"px",height:tmp.h+"px"});}}if(this.intermediateChanges){this.onResize(e);}},_endSizing:function(e){dojo.forEach(this._pconnects,dojo.disconnect);var pub=dojo.partial(dojo.publish,this.endTopic,[this]);if(!this.activeResize){this._resizeHelper.hide();this._changeSizing(e);setTimeout(pub,this.animateDuration+15);}else{pub();}this._isSizing=false;this.onResize(e);},onResize:function(e){}});dojo.declare("dojox.layout._ResizeHelper",dijit._Widget,{show:function(){dojo.fadeIn({node:this.domNode,duration:120,beforeBegin:function(n){dojo.style(n,"display","");}}).play();},hide:function(){dojo.fadeOut({node:this.domNode,duration:250,onEnd:function(n){dojo.style(n,"display","none");}}).play();},resize:function(dim){dojo.marginBox(this.domNode,dim);}});}if(!dojo._hasResource["com.ibm.mm.builder.widget.CustomDialogResizer"]){dojo._hasResource["com.ibm.mm.builder.widget.CustomDialogResizer"]=true;dojo.provide("com.ibm.mm.builder.widget.CustomDialogResizer");dojo.declare("com.ibm.mm.builder.widget.CustomDialogResizer",[dojox.layout.ResizeHandle],{innerContainer:null,innerMargin:null,oritation:"right",intLeftRTLOrig:0,onResize:null,templateString:"<div dojoAttachPoint=\"resizeHandle\" class=\"customDialogResizeHandle\"><div></div></div>",_beginSizing:function(e){if(this._isSizing){return false;}this.targetWidget=dijit.byId(this.targetId);if(this.targetWidget){this.activeResize=true;}this.targetDomNode=this.targetWidget?this.targetWidget.domNode:dojo.byId(this.targetId);if(this.targetContainer){this.targetDomNode=this.targetContainer;}if(!this.targetDomNode){return;}this.intLeftRTLOrig=parseInt(this.targetDomNode.style.left,10);if(!this.activeResize){this.targetDomNode.appendChild(this._activeResizeNode);dojo.fadeIn({node:this._activeResizeNode,duration:120,beforeBegin:dojo.hitch(this,function(){this._activeResizeNode.style.display="";})}).play();}this._isSizing=true;this.startPoint={"x":e.clientX,"y":e.clientY};var mb=(this.targetWidget)?dojo.marginBox(this.targetDomNode):dojo.contentBox(this.targetDomNode);this.startSize={"w":mb.w,"h":mb.h};this._connects=[];this._connects.push(dojo.connect(document,"onmousemove",this,"_updateSizing"));this._connects.push(dojo.connect(document,"onmouseup",this,"_endSizing"));this._connects.push(dojo.connect(document,"onmouseleave",this,"_endSizing"));e.preventDefault();},_changeSizing:function(e){var tmp=this._getNewCoords(e);if(tmp===false){return;}if(this.targetWidget&&typeof this.targetWidget.resize=="function"){this.targetWidget.resize(tmp);}else{var _1d60=0;if(builderConfig.isBidi){_1d60=this.intLeftRTLOrig-tmp.dx;}dojo.style(this.targetDomNode,"width",tmp.w+"px");dojo.style(this.targetDomNode,"height",tmp.h+"px");if(builderConfig.isBidi){dojo.style(this.targetDomNode,"left",_1d60+"px");}if(this.innerContainer&&this.innerMargin){this.innerContainer.style.height=(tmp.h-this.innerMargin.top-this.innerMargin.bottom)+"px";this.innerContainer.style.width=(tmp.w-this.innerMargin.left-this.innerMargin.right-2)+"px";}}e.preventDefault();if(this.onResize!==null){this.onResize(tmp.w,tmp.h);}},_getNewCoords:function(e){try{if(!e.clientX||!e.clientY){return false;}}catch(exception){return false;}this._activeResizeLastEvent=e;var dx=this.startPoint.x-e.clientX;var dy=this.startPoint.y-e.clientY;var newW=0;var newH=(this._resizeY)?this.startSize.h-dy:this.startSize.h;if(!builderConfig.isBidi){newW=(this._resizeX)?this.startSize.w-dx:this.startSize.w;}else{newW=(this._resizeX)?this.startSize.w+dx:this.startSize.w;}if(this.minSize){if(newW<this.minSize.w){newW=this.minSize.w;}if(newH<this.minSize.h){newH=this.minSize.h;}}return {w:newW,h:newH,dx:dx};},_endSizing:function(e){this.inherited(arguments);dojo.forEach(this._connects,function(c){dojo.disconnect(c);});if(this.targetDomNode){var domId=this.targetDomNode.id;if(domId.indexOf("_edit")!=-1){var _1d61=domId.substr(0,domId.length-5);var _1d62=com.ibm.mashups.services.ServiceManager.getService("eventService");var _1d63=dojo.query(".dialog_container",this.targetDomNode)[0];var _1d64={"newWidth":parseInt(_1d63.style.width,10),"newHeight":parseInt(_1d63.style.height,10)};_1d62.publishEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+_1d61,_1d64);}}}});}if(!dojo._hasResource["com.ibm.mm.builder.widget.CustomDialogMoveable"]){dojo._hasResource["com.ibm.mm.builder.widget.CustomDialogMoveable"]=true;dojo.provide("com.ibm.mm.builder.widget.CustomDialogMoveable");dojo.declare("com.ibm.mm.builder.widget.CustomDialogMoveable",dojo.dnd.Moveable,{adjustPosOnMouseUp:function(){this.node.style.left=this.checkValue(this.node.style.left);this.node.style.top=this.checkValue(this.node.style.top);},checkValue:function(value){try{var _1d65=parseInt(value.substring(0,value.length-2),10);if(_1d65<0){return "0px";}}catch(e){}return value;},onMoveStop:function(mover){com.ibm.mm.builder.widget.CustomDialogMoveable.superclass.onMoveStop.call(this,mover);this.adjustPosOnMouseUp();}});}if(!dojo._hasResource["com.ibm.mm.builder.widget.CustomDialog"]){dojo._hasResource["com.ibm.mm.builder.widget.CustomDialog"]=true;dojo.provide("com.ibm.mm.builder.widget.CustomDialog");dojo.declare("com.ibm.mm.builder.widget.CustomDialog",[dijit.Dialog],{templateString:"<div dojoAttachPoint='dialogNode' class='custom_dialog'>"+"<div dojoAttachPoint='dialogDivsNode' class='customDialogDiv lotusDialog'>"+"<div dojoAttachPoint='titleBar' class='dialog_titlebar' waiRole='dialog'>"+"<a title='${closeIconTitle}' class='dialog_titlebar_close_wrapper lotusBtnImg' dojoAttachPoint='closeButtonNode'"+"href='javascript:;' aria-label='${closeIconTitle}' dojoAttachEvent='onclick:trueHide,onkeypress:hideWithKey'>"+"<img alt='${closeIconTitle}' title='${closeIconTitle}' class='dialog_titlebar_close' src='"+builderConfig.builderPath+"/images/oneui/blank.gif'/>"+"<span class='lotusAltText'>X</span>"+"</a>"+"<div dojoAttachPoint='titleNode' class='dialog_titlebar_title'></div>"+"</div>"+"<div dojoAttachPoint='containerNode' class='dialog_container'></div>"+"<span dojoAttachPoint='tabEnd' ></span>"+"<div dojoAttachPoint='leftBar' class='dialog_leftsidebar'></div>"+"<div dojoAttachPoint='rightBar' class='dialog_rightsidebar'></div>"+"<div dojoAttachPoint='endBar' class='dialog_endbar'></div>"+"<div dojoAttachPoint='leftResizeHandler' class='dialog_leftResize_handler'></div>"+"<div dojoAttachPoint='rightResizeHandler' class='dialog_rightResize_handler'></div>"+"</div>"+"</div>",sharedWidget:false,belongId:null,nodeWidth:null,nodeHeight:null,title:null,titleHeight:28,titleBarHeight:"0px",endBarHeight:"0px",bottomHeight:14,topBarBackground:null,topBarOpacity:null,bottomBarBackground:null,bottomBarOpacity:null,bottomBarTip:null,bottomBarTipColor:"white",leftBarWidth:"0px",rightBarWidth:"0px",displayCloseButton:true,containerNodePadding:null,containerBackgroundColor:null,containerOpacity:null,hasLeftBottomResizer:false,hasRightBottomResizer:true,modelDialog:true,needUnderLay:true,initLeftPosition:null,initTopPosition:null,alwaysCenter:true,subDialogs:null,roundCorner:false,dialogStack:[],innerConnects:[],closeCallback:null,displayCallback:null,dynaInitialized:false,closeIconTitle:com.ibm.mm.builder.coreWidgetsStrings.I_COMMON_CANCEL,scrollEnabled:false,postCreate:function(){this.inherited(arguments);this.domNode.className="custom_dialog";this.subDialogs=[];if(this.scrollEnabled){dojo.style(this.containerNode,"overflow","scroll");}dojo.subscribe("/enabler/pageChanged",this,"destroyOnPageChange");},setTitle:function(title){this.title=title||this.title;if(this.title&&this.titleNode&&this.title!=this.titleNode.title){com.ibm.mm.builder.utils.htmlUtil.setNodeTitle(this.title,this.titleNode);}},containXOjbect:function(){return document.applets.length>0||document.getElementsByTagName("Object").length>0;},oldWidgetSpecHitch:function(){},registerSubDialog:function(_1d66){if(dojo.isString(_1d66)){this.subDialogs.push(_1d66);var _1d67=dijit.byId(_1d66);if(_1d67&&!_1d67.modelDialog){_1d67.domNode.style.zIndex=this.domNode.style.zIndex;}}},hideWithKey:function(event){var _1d68=event.keyCode;if(_1d68!=dojo.keys.ENTER){return true;}this.hide();},hide:function(){if(!this.open){return;}if(!dojo.isIE&&this.closeButtonNode.style.display!="none"){this.closeButtonNode.focus();}this.doHide();},doHide:function(){if(!this.open){return;}if(this.dialogStack.length>1){var _1d69=this.dialogStack.pop();dojo.disconnect(_1d69.onKeyHandler);var _1d6a=this.dialogStack[this.dialogStack.length-1];_1d6a.onKeyHandler=dojo.connect(document.documentElement,"onkeypress",_1d6a,"_onKey");}else{if(this.dialogStack.length===1){var _1d6b=this.dialogStack.pop();dojo.disconnect(_1d6b.onKeyHandler);}}dojo.forEach(this.subDialogs,function(_1d6c){var _1d6d=dijit.byId(_1d6c);if(_1d6d){_1d6d.hide();}});setTimeout(this.oldWidgetSpecHitch,this.duration);var ds=com.ibm.mm.builder.widget.customDialogStack;if(!this._alreadyInitialized||this!=ds[ds.length-1]){return;}if(this.modelDialog){com.ibm.mm.builder.widget.customDlgHighestZIndex-=2;this.domNode.style.zIndex=com.ibm.mm.builder.widget.customDlgZIndexOnPage;}if(this._fadeIn.status()=="playing"){this._fadeIn.stop();}com.ibm.mm.builder.widget.customDialogStack.pop();this._fadeOut.play();if(this._scrollConnected){this._scrollConnected=false;}dojo.forEach(this._modalconnects,dojo.disconnect);this._modalconnects=[];if(this._relativePosition){delete this._relativePosition;}this.open=false;},trueHide:function(){this.doHide();},_onKey:function(evt){if(dijit._dialogStack.length>0){return;}var ds=com.ibm.mm.builder.widget.customDialogStack;if(ds[ds.length-1]!=this){return;}if(evt.charOrCode){var dk=dojo.keys;var node=evt.target;if(evt.charOrCode===dk.TAB){this._getFocusItems(this.domNode);}var _1d6e=(this._firstFocusItem==this._lastFocusItem);if(node==this._firstFocusItem&&evt.shiftKey&&evt.charOrCode===dk.TAB){if(!_1d6e){dijit.focus(this._lastFocusItem);}dojo.stopEvent(evt);}else{if(node==this._lastFocusItem&&evt.charOrCode===dk.TAB&&!evt.shiftKey){if(!_1d6e){dijit.focus(this._firstFocusItem);}dojo.stopEvent(evt);}else{while(node){if(node==this.domNode){if(evt.charOrCode==dk.ESCAPE){this.onCancel();}else{return;}}node=node.parentNode;}if(evt.charOrCode!==dk.TAB){dojo.stopEvent(evt);}else{if(!dojo.isOpera){try{this._firstFocusItem.focus();}catch(e){}}}}}}},_getUnderlay:function(){if(!this._underlay){this._underlay=new com.ibm.mm.builder.widget.CustomDialogUnderlay();}return this._underlay;},_isMac:function(){return navigator.appVersion.indexOf("Macintosh")>=0;},_setup:function(){this.moveableHandles=[];if(!dijit._underlay){dijit._underlay=new dijit.DialogUnderlay();}if(this.titleBar){this.moveableHandles.push(new com.ibm.mm.builder.widget.CustomDialogMoveable(this.domNode,{handle:this.titleBar}));}if(this.leftBar){this.moveableHandles.push(new com.ibm.mm.builder.widget.CustomDialogMoveable(this.domNode,{handle:this.leftBar}));}if(this.rightBar){this.moveableHandles.push(new com.ibm.mm.builder.widget.CustomDialogMoveable(this.domNode,{handle:this.rightBar}));}if(this.endBar){this.moveableHandles.push(new com.ibm.mm.builder.widget.CustomDialogMoveable(this.domNode,{handle:this.endBar}));}if(this.modelDialog){this.domNode.style.zIndex=com.ibm.mm.builder.widget.customDlgZIndexOnPage;}else{com.ibm.mm.builder.utils.htmlUtil.setClass(this.domNode,"custom_dialog_nomodel");}var node=this.domNode;if(this.modelDialog&&this.needUnderLay){var _1d6f=this._getUnderlay();this._fadeIn=dojo.fx.combine([dojo.fadeIn({node:node,duration:this.duration}),dojo.fadeIn({node:_1d6f.domNode,duration:this.duration,onEnd:dojo.hitch(this,function(){_1d6f.show();_1d6f.setZIndex(dojo.style(node,"zIndex")-1);if(!(this._isMac()&&dojo.isSafari==4)){this._addBackIFrame(dojo.style(node,"zIndex")-2);}})})]);this._fadeOut=dojo.fx.combine([dojo.fadeOut({node:node,duration:600}),dojo.fadeOut({node:_1d6f.domNode,duration:700,onEnd:dojo.hitch(this,function(){node.style.display="none";_1d6f.hide();this._removeBackIFrame();if(this.closeCallback){setTimeout(dojo.hitch(this,this.closeCallback),500);}})})]);}else{this._fadeIn=dojo.fadeIn({node:node,duration:this.duration});this._fadeOut=dojo.fadeOut({node:node,duration:600,onEnd:dojo.hitch(this,function(){node.style.display="none";if(this.closeCallback){setTimeout(dojo.hitch(this,this.closeCallback),500);}})});}},InitDialogSkin:function(){if(this.roundCorner){dojo.addClass(this.dialogNode,"mumRoundCorner");}this.closeButtonNode.style.display=this.displayCloseButton?"":"none";if(!this.title){this.titleNode.style.display="none";com.ibm.mm.builder.utils.htmlUtil.setClass(this.titleBar,"dialog_titlebar_notitle");com.ibm.mm.builder.utils.htmlUtil.setClass(this.leftBar,"dialog_leftsidebar_notitle");com.ibm.mm.builder.utils.htmlUtil.setClass(this.rightBar,"dialog_rightsidebar_notitle");this.titleHeight=14;}else{this.titleNode.style.display="";com.ibm.mm.builder.utils.htmlUtil.setClass(this.titleBar,"dialog_titlebar");com.ibm.mm.builder.utils.htmlUtil.setClass(this.leftBar,"dialog_leftsidebar");com.ibm.mm.builder.utils.htmlUtil.setClass(this.rightBar,"dialog_rightsidebar");this.titleHeight=28;}if(this.nodeWidth){(this.containerNode.style.width=this.nodeWidth);}dojo.forEach((this.nodeStyle||"").split(";"),function(_1d70){var kvp=_1d70.split(":");if(kvp.length===2){this.containerNode.style[kvp[0]]=kvp[1];}},this);if(this.nodeHeight){this.containerNode.style.height=this.nodeHeight;}if(this.containerNodePadding){this.containerNode.style.padding=this.containerNodePadding;}if(this.leftBarWidth){this.leftBar.style.width=this.leftBarWidth;}if(this.leftBarWidth){this.containerNode.style.marginLeft=this.leftBarWidth;}if(this.rightBarWidth){this.rightBar.style.width=this.rightBarWidth;}if(this.rightBarWidth){this.containerNode.style.marginRight=this.rightBarWidth;}if(this.containerBackgroundColor){this.containerNode.style.backgroundColor=this.containerBackgroundColor;}if(this.containerOpacity){this.containerNode.style.opacity=this.containerOpacity;}if(this.topBarBackground){this.titleBar.style.backgroundColor=this.topBarBackground;}if(this.topBarOpacity){this.titleBar.style.opacity=this.topBarOpacity;}if(this.topBarOpacity){this.titleBar.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity="+this.topBarOpacity*100;}if(this.titleBarHeight!="0px"){this.titleBar.style.height=this.titleBarHeight;}if(this.bottomBarBackground){this.endBar.style.backgroundColor=this.bottomBarBackground;}if(this.bottomBarOpacity){this.endBar.style.opacity=this.bottomBarOpacity;}if(this.bottomBarOpacity){this.endBar.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity="+this.bottomBarOpacity*100;}if(this.endBarHeight&&this.endBarHeight!="0px"){this.endBar.style.height=this.endBarHeight;var _1d71=parseInt(this.endBarHeight,10)+1+"px";this.leftBar.style.bottom=_1d71;this.rightBar.style.bottom=_1d71;}if(this.bottomBarTip){this.endBar.innerHTML=this.bottomBarTip;this.endBar.style.color=this.bottomBarTipColor;}if(this.hasLeftBottomResizer){this.leftResizeHandler.style.display="";this.leftResizer=new com.ibm.mm.builder.widget.CustomDialogResizer({targetContainer:this.domNode,animateSizing:false,activeResize:true,innerContainer:this.containerNode,innerMargin:{top:this.titleHeight,bottom:this.bottomHeight,left:parseInt(this.leftBarWidth,10),right:parseInt(this.rightBarWidth,10)},onResize:dojo.hitch(this,"onResize")},this.leftResizeHandler);this.leftResizer.startup();}if(this.hasRightBottomResizer){this.rightResizeHandler.style.display="";this.rightResizer=new com.ibm.mm.builder.widget.CustomDialogResizer({targetContainer:this.domNode,animateSizing:false,activeResize:true,innerContainer:this.containerNode,innerMargin:{top:this.titleHeight,bottom:this.bottomHeight,left:parseInt(this.leftBarWidth,10),right:parseInt(this.rightBarWidth,10)},onResize:dojo.hitch(this,"onResize")},this.rightResizeHandler);this.rightResizer.startup();}},show:function(){if(this.open){return;}if(!this._alreadyInitialized){this._setup();this.InitDialogSkin();this._alreadyInitialized=true;}if(this._fadeOut.status()=="playing"){this._fadeOut.stop();}this._modalconnects.push(dojo.connect(window,"onscroll",this,"layout"));this._modalconnects.push(dojo.connect(window,"onresize",this,function(){var _1d72=dijit.getViewport();if(!this._oldViewport||_1d72.h!=this._oldViewport.h||_1d72.w!=this._oldViewport.w){this.layout();this._oldViewport=_1d72;}}));if(this.dialogStack.length>0){var _1d73=this.dialogStack[this.dialogStack.length-1];dojo.disconnect(_1d73.onKeyHandler);}this.dialogStack.push(this);if(this.modelDialog){this._modalconnects.push(this.onKeyHandler=dojo.connect(document.documentElement,"onkeypress",this,"_onKey"));}dojo.style(this.domNode,"opacity",0);var _1d74=[];if(!this.dynaInitialized){if(dojo.isIE==6){dojo.query("div",this.domNode).forEach(function(node,i){var _1d75=[];_1d75.node=node;_1d75.height=node.style.height;node.style.height="auto";_1d74.push(_1d75);});}}this.domNode.style.display="block";this.domNode.style.visibility="";this.open=true;if(!this.dynaInitialized){this.domNode.style.height=null;if(this.nodeHeight!==null){this.containerNode.style.height=this.nodeHeight;}else{this.containerNode.style.height=null;}var _1d76=parseInt(this.leftBarWidth.substring(0,this.leftBarWidth.length-2),10);var _1d77=parseInt(this.rightBarWidth.substring(0,this.rightBarWidth.length-2),10);var _1d78;if(this.nodeWidth!==null){this.containerNode.style.width=this.nodeWidth;_1d78=parseInt(this.nodeWidth.substring(0,this.nodeWidth.length-2),10);this.domNode.style.width=(_1d78+_1d76+_1d77+2)+"px";}else{var node;if(this.containerNode.hasChildNodes()){node=this.containerNode.childNodes[0];}else{node=this.containerNode;}_1d78=dojo.coords(node).w;this.containerNode.style.width=_1d78+"px";this.domNode.style.width=(_1d78+_1d76+_1d77+2)+"px";}if(dojo.isIE==6){for(var i=0;i<_1d74.length;i++){if(_1d74[i].height&&_1d74[i].height!="auto"){_1d74[i].node.style.height=_1d74[i].height;}else{_1d74[i].node.style.height="";}}}this._position();this.positionWithGivenValue();this.dynaInitialized=true;}else{if(this.alwaysCenter&&this.initLeftPosition===null&&this.initTopPosition===null){this._position();}dojo.style(this.containerNode,"width","100%");}if(this.modelDialog){com.ibm.mm.builder.widget.customDlgHighestZIndex+=2;this.domNode.style.zIndex=com.ibm.mm.builder.widget.customDlgHighestZIndex;}this.setTitle();com.ibm.mm.builder.widget.customDialogStack.push(this);this._fadeIn.play();this._savedFocus=dijit.getFocus(this);_1d74=null;this._getFocusItems(this.domNode);setTimeout(dojo.hitch(this,function(){var elems=dijit._getTabNavigable(this.containerNode);var f=elems.lowest||elems.first||this._firstFocusItem;if(f){dijit.focus(f);}if(this.displayCallback){this.displayCallback();}}),this.duration+500);},setNodeWidth:function(_1d79){this.containerNode.style.width=this.nodeWidth=_1d79;if(this.dynaInitialized){var _1d7a=parseInt(this.leftBarWidth,10);var _1d7b=parseInt(this.rightBarWidth,10);var _1d7c=this.nodeWidth?parseInt(this.nodeWidth,10):dojo.coords(this.containerNode).w;this.domNode.style.width=(_1d7c+_1d7a+_1d7b+2)+"px";}},setNodeHeight:function(_1d7d){this.containerNode.style.height=this.nodeHeight=_1d7d;},setBottomTip:function(tip){this.endBar.innerHTML=this.bottomBarTip=tip;},setBottomTipColor:function(color){this.endBar.style.color=this.bottomBarTipColor=color;},autoAdjust:function(){},onCancel:function(){this.trueHide();},destroyOnPageChange:function(){if(!this.sharedWidget){this.destroy();}},destroy:function(){if(this.open){this.hide();}dojo.forEach(this.innerConnects,dojo.disconnect);if(this.moveableHandles){for(var i=0;i<this.moveableHandles.length;i++){this.moveableHandles[i].destroy();}}dojo.destroy(this.leftBar);dojo.destroy(this.rightBar);dojo.destroy(this.endBar);dojo.destroy(this.closeButtonNode);dojo.destroy(this.titleBar);if(this.leftResizer){this.leftResizer.destroy();}if(this.rightResizer){this.rightResizer.destroy();}dojo.destroy(this.leftResizeHandler);dojo.destroy(this.rightResizeHandler);if(this._underlay){this._underlay.destroy();}if(this.shimmer){dojo.destroy(this.shimmer);}this.inherited(arguments);},positionWithGivenValue:function(){if(this.initLeftPosition){this.domNode.style.left=this.initLeftPosition;}if(this.initTopPosition){this.domNode.style.top=this.initTopPosition;}},_position:function(){if(dojo.hasClass(dojo.body(),"dojoMove")){return;}var _1d7e=dijit.getViewport();var mb=dojo.marginBox(this.domNode);var left=Math.floor((_1d7e.l+(_1d7e.w-mb.w)/2));var top=Math.floor((_1d7e.t+(_1d7e.h-mb.h)/2));this.domNode.style.left=left>0?left+"px":"0px";this.domNode.style.top=top>0?top+"px":"0px";},layout:function(){if(this.domNode.style.display!="none"&&this.modelDialog&&this.needUnderLay){this._getUnderlay().layout();}},_addBackIFrame:function(_1d7f){this.shimmer=document.createElement("iframe");this.shimmer.style.position="absolute";this.shimmer.style.zIndex=_1d7f;this.shimmer.setAttribute("frameborder","0");this.shimmer.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";document.body.appendChild(this.shimmer);this._adjustBackIFramePosition();},_adjustBackIFramePosition:function(){var _1d80=dijit.getViewport();this.shimmer.style.top=_1d80.t+"px";this.shimmer.style.left=_1d80.l+"px";this.shimmer.style.width=_1d80.w+"px";this.shimmer.style.height=_1d80.h+"px";var _1d81=dijit.getViewport();if(_1d80.w!=_1d81.w){this.shimmer.style.width=_1d81.w+"px";}if(_1d80.h!=_1d81.h){this.shimmer.style.height=_1d81.h+"px";}},_removeBackIFrame:function(){if(this.shimmer){dojo.destroy(this.shimmer);this.shimmer=null;}},onResize:function(width,_1d82){}});com.ibm.mm.builder.widget.customDialogStack=[];com.ibm.mm.builder.widget.customDlgZIndexOnPage=800;com.ibm.mm.builder.widget.customDlgHighestZIndex=800;com.ibm.mm.builder.widget.editDialogUnderlay=null;dojo.declare("com.ibm.mm.builder.widget.CleanDialog",com.ibm.mm.builder.widget.CustomDialog,{_getUnderlay:function(){if(!com.ibm.mm.builder.widget.editDialogUnderlay){com.ibm.mm.builder.widget.editDialogUnderlay=new com.ibm.mm.builder.widget.CustomDialogUnderlay({id:"cleanDialogUnderlay"});}return com.ibm.mm.builder.widget.editDialogUnderlay;}});dojo.declare("com.ibm.mm.builder.widget.GeneralWidgetModeDialog",com.ibm.mm.builder.widget.CleanDialog,{postCreate:function(){this.inherited(arguments);this.modeChangeHandle=dojo.subscribe(iwConstants.EVENTS.modeChanged,this,this.onModeChanged);},onModeChanged:function(_1d83,mode){this.hide();},hideWithKey:function(event){var _1d84=event.keyCode;if(_1d84!=dojo.keys.ENTER){return true;}this.trueHide();},trueHide:function(){if(this.belongId){com.ibm.mashups.services.ServiceManager.getService("eventService").fireEvent(this.belongId,"onModeChanged",{newMode:"view"});return;}this.doHide();},destroy:function(){dojo.unsubscribe(this.modeChangeHandle);this.inherited(arguments);}});dojo.declare("com.ibm.mm.builder.widget.WidgetEditDialog",com.ibm.mm.builder.widget.GeneralWidgetModeDialog,{onModeChanged:function(_1d85,mode){if(mode==="edit"&&this.belongId===_1d85){this.hide();}}});dojo.declare("com.ibm.mm.builder.widget.CustomDialogUnderlay",dijit.DialogUnderlay,{templateString:"<div class=\"customDialogUnderlayWrapper\" id=\"${id}_underlay\">"+"<div class=\"customDialogUnderlay\" dojoAttachPoint=\"node\"></div>"+"</div>",setZIndex:function(_1d86){dojo.style(this.domNode,"zIndex",_1d86);}});}if(!dojo._hasResource["com.ibm.mm.builder.utils.layoutUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.layoutUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.layoutUtil");com.ibm.mm.builder.utils.layoutUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.layoutUtil");com.ibm.mm.builder.utils.layoutUtil.getPageSize=function(){var _1d87;if(self.innerHeight){_1d87=self.innerHeight;}else{if(document.documentElement&&document.documentElement.clientHeight){_1d87=document.documentElement.clientHeight;}else{if(document.body){_1d87=document.body.clientHeight;}}}return _1d87;};com.ibm.mm.builder.utils.layoutUtil.getPageContent=function(pid){if(!pid){if(!com.ibm.mm.builder.utils.pageUtil.getCurrentPageNode()){var _1d88="<div class='empty_div'>"+"<div class='empty_outer_div'>"+"<div class='empty_inner_div'>"+com.ibm.mm.builder.utils.htmlUtil.formatMessage(com.ibm.mm.builder.coreWidgetsStrings.W_NO_PAGE_TO_SHOW)+"</div>"+"</div>"+"</div>";return {"content":_1d88};}return;}try{if(com.ibm.mm.builder.utils.pageUtil.isEmptyPage(com.ibm.mm.builder.utils.pageUtil.getPageNode(pid))){return null;}var _1d89={};var _1d8a=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel().getLayoutModel(pid);if(!_1d8a){return null;}var _1d8b=_1d8a.getRoot().start();if(_1d8b){_1d89.content=_1d8b.getFragment();var _1d8c={};var _1d8d=_1d8b.getMetaDataNames();dojo.forEach(_1d8d,function(_1d8e){_1d8c[_1d8e]=_1d8b.getMetaData(_1d8e);});_1d89.pageAttributes=_1d8c;return _1d89;}else{return null;}}catch(e){com.ibm.mm.builder.utils.layoutUtil.LOGGER.severe("getPageContent",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_MAIN_INVALID_ID_2,[pid,e.message]));}};com.ibm.mm.builder.utils.layoutUtil.transformBgIamge=function(_1d8f){if(_1d8f.search(/url/i)!==0){_1d8f="url"+_1d8f;}if(_1d8f.indexOf("(")!=3){_1d8f=_1d8f.substring(0,3)+"("+_1d8f.substring(3)+")";}if(_1d8f.search(/http/i)!=4){if(_1d8f.substring(4,5)!="/"){_1d8f=_1d8f.substring(0,4)+"http://"+_1d8f.substring(4)+"";}}return _1d8f;};com.ibm.mm.builder.utils.layoutUtil.setBorderSelect=function(_1d90){var index=0;_1d90.options[index++].innerHTML=com.ibm.mm.builder.coreWidgetsStrings.LAYOUT_BORDER_STYLE_NONE;var _1d91=[1,2,3];var _1d92=[com.ibm.mm.builder.coreWidgetsStrings.LAYOUT_BORDER_STYLE_SOLID,com.ibm.mm.builder.coreWidgetsStrings.LAYOUT_BORDER_STYLE_DOTTED,com.ibm.mm.builder.coreWidgetsStrings.LAYOUT_BORDER_STYLE_DOUBLE];for(var i=0;i<_1d92.length;i++){for(var j=0;j<_1d91.length;j++){_1d90.options[index++].innerHTML=_1d91[j]+com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_PAGE_UNIT+" "+_1d92[i];}}};com.ibm.mm.builder.utils.layoutUtil.createSlider=function(iWID,_1d93,_1d94,_1d95,_1d96,_1d97,_1d98,_1d99){var _1d9a=dojo.byId(iWID+_1d93);dojo.byId(iWID+_1d94).innerHTML=_1d95+_1d96;var _1d9b=dijit.byId(iWID+_1d93);if(_1d9b){_1d9b.destroy();}var _1d9c={};_1d9c.id=iWID+_1d93;_1d9c.value=_1d95;_1d9c.pageIncrement=_1d98;_1d9c.maximum=_1d97;_1d9c.showButtons=false;_1d9c.style="width:120px;height:20px;";_1d9b=new dijit.form.HorizontalSlider(_1d9c,_1d9a);dojo.connect(_1d9b,"onChange",null,function(_1d9d){var _1d9e=dojo.number.format(arguments[0],{places:0,pattern:"##."});dojo.byId(iWID+_1d94).innerHTML=_1d9e+_1d96;if(_1d99){dojo.byId(iWID+_1d99).style.width=_1d9e+"px";}});};com.ibm.mm.builder.utils.layoutUtil.getPageBorderSelectIndex=function(prop){var index=0;switch(prop){case "none":index=0;break;case "1px solid":index=1;break;case "2px solid":index=2;break;case "3px solid":index=3;break;case "1px dotted":index=4;break;case "2px dotted":index=5;break;case "3px dotted":index=6;break;case "3px double":index=7;break;case "6px double":index=8;break;case "9px double":index=9;break;}return index;};com.ibm.mm.builder.utils.layoutUtil.getImagePropSelectIndex=function(prop){var index=0;switch(prop){case "RepeatX":index=0;break;case "RepeatY":index=1;break;case "Repeat":index=2;break;case "Center":index=3;break;}return index;};com.ibm.mm.builder.utils.layoutUtil.stretchHeight=function(_1d9f){var root=dojo.byId(_1d9f);var _1da0=dojo.query("."+com.ibm.mm.builder.constant.iWidgetContent,root);var len=_1da0.length;if(len===0){_1da0=dojo.query("."+com.ibm.mm.builder.constant.iwWidgetContent,root);len=_1da0.length;}for(var i=0;i<len;i++){if(_1da0[i].parentNode==root){_1da0[i].style.height="100%";break;}}};com.ibm.mm.builder.utils.layoutUtil.addTip=function(msg,node,_1da1,field){if(!field){field="innerHTML";}if(msg.length>_1da1){node[field]=msg.substr(0,_1da1)+"...";node.setAttribute("title",msg);}else{node[field]=msg;}};com.ibm.mm.builder.utils.layoutUtil.removeAllChildren=function(fNode){var _1da2=null;if(dojo.isIE){_1da2=fNode.children;}else{_1da2=fNode.childNodes;}var len=_1da2.length;if(len!==0){for(var i=0;i<len;i++){dojo.destroy(_1da2[i]);}}};com.ibm.mm.builder.utils.layoutUtil.widgetInLayout=function(_1da3,_1da4){if(_1da3==_1da4){return false;}var _1da5=dojo.byId(_1da3);if(_1da5){var node=_1da5;while(node.tagName!="BODY"){if(node.id==_1da4){return true;}node=node.parentNode;}}else{return false;}return false;};com.ibm.mm.builder.utils.layoutUtil.publishWidgetSize=function(_1da6){var _1da7=null;var _1da8=function(){var _1da9=dojo.contentBox(_1da6+"_content");var _1daa=com.ibm.mashups.services.ServiceManager.getService("eventService");var _1dab={"newWidth":_1da9.w,"newHeight":_1da9.h};_1daa.publishEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+_1da6,_1dab);if(_1da7){_1daa.unsubscribeEvent(_1da7,null);}};var wm=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1da6);if(wm&&wm.loaded){_1da8();}else{var _1dac=com.ibm.mashups.services.ServiceManager.getService("eventService");_1da7=_1dac.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_1da6,null,_1da8);}};com.ibm.mm.builder.utils.layoutUtil.resizeWidget=function(_1dad,_1dae,width){if(width){com.ibm.mm.builder.utils.pageWidthChanger.widgetToBeResized(_1dad,width);}var _1daf=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1dad);var _1db0=dojo.contentBox(_1daf);if(width&&builderConfig.isBidi){var _1db1=parseInt(_1daf.style.left,10);var dx=_1db0.w-width;var _1db2=_1db1+dx;dojo._setBox(_1daf,_1db2);}if(width){_1db0.w=width;}_1db0.h=_1dae;dojo.contentBox(_1daf,_1db0);var _1db3=dojo.byId(_1dad+com.ibm.mm.builder.constant.widgetContent);var _1db4=com.ibm.mm.builder.utils.htmlUtil.getCurrentStyle(dojo.byId(_1dad+com.ibm.mm.builder.constant.widgetBody),"paddingTop");_1db4=_1db4?parseInt(_1db4,10):0;var _1db5=dojo.contentBox(_1db3);dojo.marginBox(_1db3,{l:0,t:0,w:width?width:-1,h:_1dae-_1db4});var _1db6=dojo.contentBox(_1db3);if(dojo.isSafari&&builderConfig.isBidi){dojo.contentBox(_1db3,{w:(_1db6.w+2*(_1db5.w-_1db6.w))});}var _1db7=width?_1db6.w:-1;if(!width){dojo.style(_1daf,"width","auto");}var _1db8=com.ibm.mashups.services.ServiceManager.getService("eventService");_1db8.broadcastEvent("com.ibm.mashups.builder.widgetResized",{widgetId:_1dad,width:_1db7,height:_1db6.h});var _1db9={"newWidth":_1db7,"newHeight":_1db6.h};_1db8.publishEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+_1dad,_1db9);};com.ibm.mm.builder.utils.layoutUtil.refreshLayoutData=function(_1dba){if(com.ibm.mm.builder.columnLayoutBean){com.ibm.mm.builder.iwidget.columnlayout.columnUtil.refreshLayoutData(_1dba);}};}if(!dojo._hasResource["com.ibm.mm.builder.utils.wireUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.wireUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.wireUtil");com.ibm.mm.builder.utils.wireUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.wireUtil");com.ibm.mm.builder.utils.wireUtil.getAllLayoutControlsInLMCSA2=function(_1dbb){var _1dbc=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _1dbd=_1dbc.find(_1dbb).start();var _1dbe=_1dbc.getLayoutModel(_1dbd);var _1dbf=[];if(_1dbe){var _1dc0=_1dbe.getRoot().start();if(_1dbe.hasChildren(_1dc0)){var _1dc1=_1dbe.getChildren(_1dc0);_1dc1.setCursorPosition(0);while(_1dc1.hasNext()){var node=_1dc1.next();var _1dc2=_1dbe.getChildren(node);_1dc2.setCursorPosition(0);while(_1dc2.hasNext()){var _1dc3=_1dc2.next();if(_1dc3 instanceof (com.ibm.mashups.enabler.layout.LayoutControl)){_1dbf.push(_1dc3);}}}}}return _1dbf;};com.ibm.mm.builder.utils.wireUtil.getAllWidgetsInLayouts=function(_1dc4){var _1dc5=[];if(_1dc4){for(var i=0;i<_1dc4.length;i++){try{var _1dc6=eval("_"+_1dc4[i]+"_iContext.scope.getWidgets()");_1dc5=_1dc5.concat(_1dc6);}catch(e){continue;}}}return _1dc5;};com.ibm.mm.builder.utils.wireUtil.getAllMatchHandleEvents=function(id,_1dc7,_1dc8){com.ibm.mm.builder.utils.wireUtil.LOGGER.entering("wireUtil: getMatchHandleEvents with "+_1dc7);var _1dc9=[];var _1dca=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(id);if(!_1dca){return _1dc9;}var _1dcb=_1dca.getPublicEvent(_1dc7);var _1dcc=com.ibm.mm.builder.utils.wireUtil.getAllWidgetsInLayouts(_1dc8);var len=_1dcc.length;var _1dcd=0;for(var x=0;x<len;x++){var _1dce=_1dcc[x];var _1dcf=dojo.byId(_1dce);if(_1dce!=id&&_1dcf.getAttribute("internalWidget")!="true"){_1dcd=0;var _1dd0=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1dce);if(!_1dd0||_1dd0.isLoaded()===false){continue;}var _1dd1=[];var _1dd2=false;var _1dd3=[];var type=com.ibm.mm.builder.utils.iwidgetUtil.getWidgetInstanceTitle(_1dce);var _1dd4=_1dd0.getWidgetHandledEvents();if(_1dd4!==null){for(var n=0;n<_1dd4.length;n++){var _1dd5=_1dd4[n];if(_1dd5.getAttribute("private")!="true"){var _1dd6=false;var _1dd7=false;var _1dd8=com.ibm.mm.builder.utils.wireUtil.isEventFlexCompatible(_1dcb,_1dd5);if(_1dd8){_1dd2=true;_1dd7=true;var wires=_1dd0.getWires();if(wires===null){wires=[];}for(var i=0;i<wires.length;i++){aWire=wires[i];if(id==aWire.getSourceWidgetID()&&_1dc7==aWire.getSourceEventName()&&_1dd5.name==aWire.getTargetEventName()){_1dd6=true;_1dcd++;_1dd3.push(aWire);}}}var _1dd9=com.ibm.mm.builder.utils.wireUtil.createMatchEvent(_1dce,type,_1dd7,_1dd6,_1dd5.name,_1dd5.type,_1dd5.description);_1dd1.push(_1dd9);}}}_1dc9.push(com.ibm.mm.builder.utils.wireUtil.createMatchWidget(_1dce,type,_1dd2,_1dcd,_1dd1,_1dd3,_1dd0.getWires()));}}com.ibm.mm.builder.utils.wireUtil.LOGGER.exiting("wireUtil: getMatchHandleEvents with "+_1dc7);return _1dc9;};com.ibm.mm.builder.utils.wireUtil.getAllMatchPubEvents=function(id,_1dda,_1ddb){com.ibm.mm.builder.utils.wireUtil.LOGGER.entering("wireUtil: getAllMatchPubEvents");var _1ddc=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(id);var _1ddd=[];if(!_1ddc){return _1ddd;}var _1dde=_1ddc.getPublicEvent(_1dda);var _1ddf=com.ibm.mm.builder.utils.wireUtil.getAllWidgetsInLayouts(_1ddb);var len=_1ddf.length;var wires=_1ddc.getWires();if(wires===null){wires=[];}for(var x=0;x<len;x++){var _1de0=_1ddf[x];var _1de1=dojo.byId(_1de0);if(_1de0!=id&&_1de1.getAttribute("internalWidget")!="true"){var _1de2=0;var _1de3=[];var _1de4=false;var _1de5=[];var _1de6=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1de0);if(!_1de6||_1de6.isLoaded()===false){continue;}var type=com.ibm.mm.builder.utils.iwidgetUtil.getWidgetInstanceTitle(_1de0);var _1de7=_1de6.getWidgetPublishedEvents();if(_1de7!==null){for(var n=0;n<_1de7.length;n++){var _1de8=_1de7[n];if(_1de8.getAttribute("private")!="true"){var _1de9=false;var _1dea=false;var _1deb=com.ibm.mm.builder.utils.wireUtil.isEventFlexCompatible(_1de8,_1dde);if(_1deb){_1de4=true;_1dea=true;for(var i=0;i<wires.length;i++){aWire=wires[i];if(_1de0==aWire.getSourceWidgetID()&&_1de8.name==aWire.getSourceEventName()&&_1dda==aWire.getTargetEventName()){_1de9=true;_1de2++;_1de5.push(aWire);}}}var _1dec=com.ibm.mm.builder.utils.wireUtil.createMatchEvent(_1de0,type,_1dea,_1de9,_1de8.name,_1de8.type,_1de8.description);_1de3.push(_1dec);}}}_1ddd.push(com.ibm.mm.builder.utils.wireUtil.createMatchWidget(_1de0,type,_1de4,_1de2,_1de3,_1de5,_1de6.getWires()));}}com.ibm.mm.builder.utils.wireUtil.LOGGER.exiting("wireUtil: getAllMatchPubEvents");return _1ddd;};com.ibm.mm.builder.utils.wireUtil.createMatchWidget=function(id,type,_1ded,_1dee,_1def,_1df0,wires){var _1df1={};_1df1.id=id;_1df1.type=type;_1df1.hasMatchEvent=_1ded;_1df1.totalWiredEvents=_1dee;_1df1.events=_1def;_1df1.wiredEvents=_1df0;_1df1.receivedWires=wires;return _1df1;};com.ibm.mm.builder.utils.wireUtil.createMatchEvent=function(id,type,_1df2,_1df3,_1df4,_1df5,_1df6){var event={};event.id=id;event.type=type;event.isMatch=_1df2;event.isWired=_1df3;event.name=_1df4;event.payloadType=_1df5;event.description=_1df6;return event;};com.ibm.mm.builder.utils.wireUtil.createWireSpan=function(_1df7,_1df8,_1df9){var _1dfa=document.createElement("span");_1dfa.className=com.ibm.mm.builder.constant.receivedEvent;var _1dfb=document.createElement("a");_1dfb.className=com.ibm.mm.builder.constant.iwSourceEvent;_1dfb.setAttribute("href","#"+_1df7);_1dfb.innerHTML=_1df8;var _1dfc=document.createElement("span");_1dfc.className=com.ibm.mm.builder.constant.iwTargetEvent;_1dfc.innerHTML=_1df9;_1dfa.appendChild(_1dfb);_1dfa.appendChild(_1dfc);return _1dfa;};com.ibm.mm.builder.utils.wireUtil.addWireWhenMatch=function(_1dfd,_1dfe){var _1dff=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1dfd);if(!_1dff){return false;}var _1e00=_1dff.getWidgetPublishedEvents();var _1e01=_1e00[0].name;var _1e02=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1dfe);if(!_1e02){return false;}var _1e03=_1e02.getWidgetHandledEvents();var _1e04=_1e03[0].name;var rc=com.ibm.mm.builder.utils.wireUtil.addWire(_1dfd,_1e01,_1dfe,_1e04);return rc;};com.ibm.mm.builder.utils.wireUtil.addWire=function(_1e05,_1e06,_1e07,_1e08){var rc=false;var _1e09=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();var _1e0a=_1e09.find(_1e07);if(_1e0a!==null){var _1e0b=_1e0a.getIWidgetInstance();_1e0b.addWire(_1e05,_1e06,_1e08);var _1e0c=_1e09.commit();_1e0c.start(false);rc=true;}return rc;};com.ibm.mm.builder.utils.wireUtil.isWireExist=function(_1e0d,_1e0e,_1e0f,_1e10){var _1e11=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1e0f);if(!_1e11){return false;}var _1e12=_1e11.getWires();var _1e13=false;for(var i=0;i<_1e12.length;i++){var wire=_1e12[i];if(_1e0d==wire.getSourceWidgetID()&&_1e0e==getSourceEventName()&&_1e0f==getTargetWidgetID()&&_1e10==getTargetEventName()){_1e13=true;break;}}return _1e13;};com.ibm.mm.builder.utils.wireUtil.removeWire=function(_1e14,_1e15,_1e16,_1e17){var rc=false;var _1e18=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();var _1e19=_1e18.find(_1e16);if(_1e19!==null){var _1e1a=_1e19.getIWidgetInstance();_1e1a.removeWire(_1e14,_1e15,_1e17);var _1e1b=_1e18.commit();_1e1b.start();rc=true;}return rc;};com.ibm.mm.data.dataTypeChecker=null;com.ibm.mm.builder.utils.wireUtil.dataTypeChecker=function(){if(com.ibm.mm.data.dataTypeChecker===null){com.ibm.mm.data.dataTypeChecker=new com.ibm.mm.data.datatypes();}return com.ibm.mm.data.dataTypeChecker;};com.ibm.mm.builder.utils.wireUtil.isEventCompatible=function(_1e1c,_1e1d){if(_1e1c===null||_1e1d===null){return false;}var _1e1e=com.ibm.mm.builder.utils.wireUtil.dataTypeChecker();var _1e1f=_1e1e.doesTypeMatch(_1e1d.type,_1e1c.type);return _1e1f;};com.ibm.mm.builder.utils.wireUtil.isEventFlexCompatible=function(_1e20,_1e21){if(_1e20===null||_1e21===null){return false;}var _1e22=com.ibm.mm.builder.utils.wireUtil.dataTypeChecker();var _1e23=_1e22.doesTypeFlexMatch(_1e21.type,_1e20.type);return _1e23;};com.ibm.mm.builder.utils.wireUtil.isWidgetCompatible=function(_1e24,_1e25){if(_1e24===null||_1e25===null||_1e24==_1e25){return false;}var _1e26=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1e25);if(!_1e26){return false;}var _1e27=_1e26.getWidgetHandledEvents();var _1e28=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1e24);if(!_1e28){return false;}var _1e29=_1e28.getWidgetPublishedEvents();if(_1e29===null||_1e27===null||_1e29.length<1||_1e27.length<1){return false;}var _1e2a=_1e29[0].type;var _1e2b=_1e27[0].type;var _1e2c=com.ibm.mm.builder.utils.wireUtil.dataTypeChecker();var _1e2d=_1e2c.doesTypeMatch(_1e2b,_1e2a);return _1e2d;};com.ibm.mm.builder.utils.wireUtil.isEventCompatibleForAutowire=function(_1e2e,_1e2f){if(_1e2e===null||_1e2f===null){return false;}if(_1e2e.name!=_1e2f.name){return false;}if(_1e2e.type=="any"||_1e2f.type=="any"||_1e2e.type!=_1e2f.type){return false;}return true;};com.ibm.mm.builder.utils.wireUtil.setupAutoWiring=function(id){var _1e30={"widgetId":id,"hasAutoWire":false,"publishTo":[],"receiveFrom":[]};if(dojo.byId(id)===null||dojo.byId(id).getAttribute("autowiringenabled")!="true"){return _1e30;}var _1e31={};var _1e32={};var _1e33=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(id);var _1e34=_1e33.getWidgetPublishedEvents();var _1e35=_1e33.getWidgetHandledEvents();var _1e36=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentTheme();var _1e37=_1e36.getLayouts();var _1e38=com.ibm.mm.builder.utils.wireUtil.getAllWidgetsInLayouts(_1e37);var len=_1e38.length;for(var x=0;x<len;x++){var _1e39=_1e38[x];if(_1e39!=id){var _1e3a=dojo.byId(_1e39);if(_1e3a.getAttribute("autowiringenabled")=="true"&&_1e3a.getAttribute("internalWidget")!="true"){var _1e3b=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1e39);if(_1e34!==null){for(var y=0;y<_1e34.length;y++){var _1e3c=_1e3b.getWidgetHandledEvents();if(_1e3c!==null){for(var n=0;n<_1e3c.length;n++){var _1e3d=_1e3c[n];if(com.ibm.mm.builder.utils.wireUtil.isEventCompatibleForAutowire(_1e34[y],_1e3d)){com.ibm.mm.builder.utils.wireUtil.addWire(id,_1e34[y].name,_1e39,_1e3d.name);_1e30.hasAutoWire=true;if(_1e31[_1e39]===null){_1e30.publishTo.push(_1e39);_1e31[_1e39]=true;}}}}}}if(_1e35!==null){for(var z=0;z<_1e35.length;z++){var _1e3e=_1e3b.getWidgetPublishedEvents();if(_1e3e!==null){for(var m=0;m<_1e3e.length;m++){var _1e3f=_1e3e[m];if(com.ibm.mm.builder.utils.wireUtil.isEventCompatibleForAutowire(_1e3f,_1e35[z])){com.ibm.mm.builder.utils.wireUtil.addWire(_1e39,_1e3f.name,id,_1e35[z].name);_1e30.hasAutoWire=true;if(_1e32[_1e39]===null){_1e30.receiveFrom.push(_1e39);_1e32[_1e39]=true;}}}}}}}}}return _1e30;};com.ibm.mm.builder.utils.wireUtil.checkAutoWiring=function(id){if(dojo.byId(id)===null||dojo.byId(id).getAttribute("autowiringenabled")!="true"){return false;}var _1e40=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(id);var _1e41=_1e40.getWidgetPublishedEvents();var _1e42=_1e40.getWidgetHandledEvents();var _1e43=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentTheme();var _1e44=_1e43.getLayouts();var _1e45=com.ibm.mm.builder.utils.wireUtil.getAllWidgetsInLayouts(_1e44);var len=_1e45.length;for(var x=0;x<len;x++){var _1e46=_1e45[x];if(_1e46!=id){var _1e47=dojo.byId(_1e46);if(_1e47.getAttribute("autowiringenabled")=="true"&&_1e47.getAttribute("internalWidget")!="true"){var _1e48=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1e46);if(_1e41!==null){for(var y=0;y<_1e41.length;y++){var _1e49=_1e48.getWidgetHandledEvents();if(_1e49!==null){for(var n=0;n<_1e49.length;n++){var _1e4a=_1e49[n];if(com.ibm.mm.builder.utils.wireUtil.isEventCompatibleForAutowire(_1e41[y],_1e4a)){return true;}}}}}if(_1e42!==null){for(var z=0;z<_1e42.length;z++){var _1e4b=_1e48.getWidgetPublishedEvents();if(_1e4b!==null){for(var m=0;m<_1e4b.length;m++){var _1e4c=_1e4b[m];if(com.ibm.mm.builder.utils.wireUtil.isEventCompatibleForAutowire(_1e4c,_1e42[z])){return true;}}}}}}}}return false;};com.ibm.mm.builder.utils.wireUtil.getWidgetPublishedEventsCSA2=function(_1e4d){var _1e4e=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1e4f=_1e4e.getWidgetWindow(_1e4d).start();var _1e50=_1e4e.getHierarchicalEventProvider(_1e4f).start();var _1e51=new Object();_1e51[com.ibm.mashups.enabler.widget.Constants.FILTER_PUBLISHED_EVENTS]=true;var _1e52=_1e50.getEvents(_1e51);return _1e52;};com.ibm.mm.builder.utils.wireUtil.getWidgetHandledEventsCSA2=function(_1e53){var _1e54=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1e55=_1e54.getWidgetWindow(_1e53).start();var _1e56=_1e54.getHierarchicalEventProvider(_1e55).start();var _1e57=new Object();_1e57[com.ibm.mashups.enabler.widget.Constants.FILTER_HANDLED_EVENTS]=true;var _1e58=_1e56.getEvents(_1e57);return _1e58;};com.ibm.mm.builder.utils.wireUtil.getAllMatchPubEventsCSA2=function(_1e59,_1e5a,_1e5b,_1e5c){com.ibm.mm.builder.utils.wireUtil.LOGGER.entering("wireUtil: getAllMatchPubEventsCSA2");var _1e5d=[];if(!_1e59){return _1e5d;}var _1e5e=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _1e5f=_1e5e.find(_1e5b).start();var lm=_1e5e.getLayoutModel(_1e5f);var _1e60=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1e61=_1e60.getWidgetWindow(_1e59).start();var _1e62=_1e60.getHierarchicalEventProvider(_1e61).start();var _1e63=_1e62.getEvent(_1e5a);var _1e64=com.ibm.mm.builder.utils.wireUtil.getAllLayoutControlsInLMCSA2(_1e5b);var len=_1e64.length;for(var x=0;x<len;x++){var _1e65=_1e64[x];if(_1e65!=_1e59){var _1e66=0;var _1e67=[];var _1e68=false;var _1e69=[];var _1e6a=_1e60.getWidgetWindow(_1e65).start();var _1e6b=_1e60.getWidgetDefinitionByWindow(_1e6a).start();var type=_1e6b.getTitle(ibmConfig["default.locale"]);var _1e6c=com.ibm.mm.builder.utils.wireUtil.getWidgetPublishedEventsCSA2(_1e65);if(_1e6c!==null){for(var n=0;n<_1e6c.length;n++){var _1e6d=_1e6c[n];var _1e6e=false;var _1e6f=false;var _1e70=com.ibm.mm.builder.utils.wireUtil.isEventCompatibleCSA2(_1e6d,_1e63,_1e5c);if(_1e70){_1e68=true;_1e6f=true;var wires=com.ibm.mm.builder.utils.wireUtil.getWiresSourceCSA2(_1e65,_1e5b);if(wires===null){wires=[];}for(var i=0;i<wires.length;i++){var aWire=wires[i];if(_1e65.getID()==aWire.getSourceWidget().getID()&&_1e59.getID()==aWire.getTargetWidget().getID()&&_1e6d.getID()==aWire.getSourceEvent().getID()&&_1e63.getID()==aWire.getTargetEvent().getID()){_1e6e=true;_1e66++;_1e69.push(aWire);}}}var _1e71=com.ibm.mm.builder.utils.wireUtil.createMatchEvent(_1e65.getID(),type,_1e6f,_1e6e,_1e6d.getName(),_1e6d.getPayloadType(),_1e6d.getDescription(ibmConfig["default.locale"]));_1e67.push(_1e71);}}var _1e72=com.ibm.mm.builder.utils.wireUtil.getWiresSourceCSA2(_1e65,_1e5b);_1e5d.push(com.ibm.mm.builder.utils.wireUtil.createMatchWidget(_1e65.getID(),type,_1e68,_1e66,_1e67,_1e69,_1e72));}}com.ibm.mm.builder.utils.wireUtil.LOGGER.exiting("wireUtil: getAllMatchPubEvents");return _1e5d;};com.ibm.mm.builder.utils.wireUtil.getPublicEventCSA2=function(_1e73,_1e74){var _1e75=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1e76=_1e75.getWidgetWindow(_1e73).start();var _1e77=_1e75.getHierarchicalEventProvider(_1e76).start();var _1e78=null;var _1e79=_1e77.getEvents(_1e78);if(_1e79&&_1e79!==null){var _1e7a=[];for(var i=0;i<_1e79.length;i++){if(_1e79[i].isHandled()){_1e7a.push(_1e79[i]);}}return _1e7a;}return null;};com.ibm.mm.builder.utils.wireUtil.getWiresTargetCSA2=function(_1e7b,_1e7c){var _1e7d=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1e7e=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _1e7f=_1e7e.find(_1e7c).start();var lm=_1e7e.getLayoutModel(_1e7f);var _1e80=lm.getWireModel();var wires=[];var _1e81=_1e80.iterator();if(_1e81!==null){_1e81.setCursorPosition(0);while(_1e81.hasNext()){var _1e82=_1e81.next();if(_1e82.getTargetWidget().getID()==_1e7b.getID()){wires.push(_1e82);}}return wires;}return null;};com.ibm.mm.builder.utils.wireUtil.getWiresSourceCSA2=function(_1e83,_1e84){var _1e85=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1e86=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _1e87=_1e86.find(_1e84).start();var lm=_1e86.getLayoutModel(_1e87);var _1e88=lm.getWireModel();var _1e89=_1e85.getWidgetWindow(_1e83);var wires=[];var _1e8a=_1e88.iterator();if(_1e8a!==null){_1e8a.setCursorPosition(0);while(_1e8a.hasNext()){var _1e8b=_1e8a.next();if(_1e8b.getSourceWidget().getID()==_1e83.getID()){wires.push(_1e8b);}}return wires;}return null;};com.ibm.mm.builder.utils.wireUtil.isEventFlexCompatibleCSA2=function(_1e8c,_1e8d){if(_1e8c===null||_1e8d===null){return false;}var _1e8e=com.ibm.mm.builder.utils.wireUtil.dataTypeChecker();var _1e8f=_1e8e.doesTypeFlexMatch(_1e8d.getPayloadType(),_1e8c.getPayloadType());return _1e8f;};com.ibm.mm.builder.utils.wireUtil.isEventCompatibleByName=function(_1e90,_1e91){if(_1e90===null||_1e91===null){return false;}result=(_1e90.getName()===_1e91.getName());return result;};com.ibm.mm.builder.utils.wireUtil.isEventCompatibleByPayloadType=function(_1e92,_1e93){if(_1e92===null||_1e93===null){return false;}var _1e94=com.ibm.mm.builder.utils.wireUtil.dataTypeChecker();var _1e95=_1e94.doesTypeFlexMatch(_1e93.getPayloadType(),_1e92.getPayloadType());return _1e95;};com.ibm.mm.builder.utils.wireUtil.isEventCompatibleCSA2=function(_1e96,_1e97,_1e98){var _1e99=com.ibm.mm.builder.utils.wireUtil;var _1e9a={SEMANTIC_TYPES_ONLY:0,PAYLOAD_TYPES_ONLY:1,SEMANTIC_OR_PAYLOAD_TYPES:2};var _1e9b=false;if(_1e98===_1e9a.SEMANTIC_TYPES_ONLY){_1e9b=_1e99.isEventCompatibleByName(_1e96,_1e97);}else{if(_1e98===_1e9a.PAYLOAD_TYPES_ONLY){_1e9b=_1e99.isEventCompatibleByPayloadType(_1e96,_1e97);}else{_1e9b=(_1e99.isEventCompatibleByName(_1e96,_1e97)||_1e99.isEventCompatibleByPayloadType(_1e96,_1e97));}}return _1e9b;};com.ibm.mm.builder.utils.wireUtil.getAllMatchHandleEventsCSA2=function(_1e9c,_1e9d,_1e9e,_1e9f){com.ibm.mm.builder.utils.wireUtil.LOGGER.entering("wireUtil: getMatchHandleEvents with "+_1e9d);var _1ea0=[];if(!_1e9c){return _1ea0;}var _1ea1=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _1ea2=_1ea1.find(_1e9e).start();var lm=_1ea1.getLayoutModel(_1ea2);var _1ea3=com.ibm.mashups.enabler.widget.Factory.getWidgetModel();var _1ea4=lm.getWireModel();var _1ea5=_1ea3.getWidgetWindow(_1e9c).start();var _1ea6=_1ea3.getHierarchicalEventProvider(_1ea5).start();var _1ea7=_1ea6.getEvent(_1e9d);var _1ea8=com.ibm.mm.builder.utils.wireUtil.getAllLayoutControlsInLMCSA2(_1e9e);var len=_1ea8.length;var _1ea9=0;var _1eaa=_1ea4.findByTargetWidget(_1e9c.getID()).start(true);if(_1eaa===null){_1eaa=[];}for(var x=0;x<len;x++){var _1eab=_1ea8[x];if(_1eab!=_1e9c){_1ea9=0;var _1eac=[];var _1ead=false;var _1eae=[];var _1eaf=_1ea3.getWidgetWindow(_1eab).start();var _1eb0=_1ea3.getWidgetDefinitionByWindow(_1eaf).start();var type=_1eb0.getTitle(ibmConfig["default.locale"]);var _1eb1=com.ibm.mm.builder.utils.wireUtil.getWidgetHandledEventsCSA2(_1eab);if(_1eb1!==null){for(var n=0;n<_1eb1.length;n++){var _1eb2=_1eb1[n];var _1eb3=false;var _1eb4=false;var _1eb5=com.ibm.mm.builder.utils.wireUtil.isEventCompatibleCSA2(_1ea7,_1eb2,_1e9f);if(_1eb5){_1ead=true;_1eb4=true;var wires=_1ea4.findByTargetWidget(_1eab.getID()).start(true);if(wires===null){wires=[];}for(var i=0;i<wires.length;i++){aWire=wires[i];if(_1eab.getID()==aWire.getTargetWidget().getID()&&_1e9c.getID()==aWire.getSourceWidget().getID()&&_1ea7.getID()==aWire.getSourceEvent().getID()&&_1eb2.getID()==aWire.getTargetEvent().getID()){_1eb3=true;_1ea9++;_1eae.push(aWire);}}}var _1eb6=com.ibm.mm.builder.utils.wireUtil.createMatchEvent(_1eab.getID(),type,_1eb4,_1eb3,_1eb2.getName(),_1eb2.getPayloadType(),_1eb2.getDescription(ibmConfig["default.locale"]));_1eac.push(_1eb6);}}_1ea0.push(com.ibm.mm.builder.utils.wireUtil.createMatchWidget(_1eab.getID(),type,_1ead,_1ea9,_1eac,_1eae,_1eaa));}}com.ibm.mm.builder.utils.wireUtil.LOGGER.exiting("wireUtil: getMatchHandleEvents with "+_1e9d);return _1ea0;};}if(!dojo._hasResource["dijit._KeyNavContainer"]){dojo._hasResource["dijit._KeyNavContainer"]=true;dojo.provide("dijit._KeyNavContainer");dojo.declare("dijit._KeyNavContainer",dijit._Container,{tabIndex:"0",_keyNavCodes:{},connectKeyNavHandlers:function(_1eb7,_1eb8){var _1eb9=(this._keyNavCodes={});var prev=dojo.hitch(this,this.focusPrev);var next=dojo.hitch(this,this.focusNext);dojo.forEach(_1eb7,function(code){_1eb9[code]=prev;});dojo.forEach(_1eb8,function(code){_1eb9[code]=next;});this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){dojo.forEach(this.getChildren(),dojo.hitch(this,"_startupChild"));},addChild:function(_1eba,_1ebb){dijit._KeyNavContainer.superclass.addChild.apply(this,arguments);this._startupChild(_1eba);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){var child=this._getFirstFocusableChild();if(child){this.focusChild(child);}},focusNext:function(){var child=this._getNextFocusableChild(this.focusedChild,1);this.focusChild(child);},focusPrev:function(){var child=this._getNextFocusableChild(this.focusedChild,-1);this.focusChild(child,true);},focusChild:function(_1ebc,last){if(this.focusedChild&&_1ebc!==this.focusedChild){this._onChildBlur(this.focusedChild);}_1ebc.focus(last?"end":"start");this.focusedChild=_1ebc;},_startupChild:function(_1ebd){_1ebd.attr("tabIndex","-1");this.connect(_1ebd,"_onFocus",function(){_1ebd.attr("tabIndex",this.tabIndex);});this.connect(_1ebd,"_onBlur",function(){_1ebd.attr("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode){return;}this.focusFirstChild();dojo.attr(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){dojo.attr(this.domNode,"tabIndex",this.tabIndex);}this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();dojo.stopEvent(evt);}},_onChildBlur:function(_1ebe){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getNextFocusableChild:function(child,dir){if(child){child=this._getSiblingOfChild(child,dir);}var _1ebf=this.getChildren();for(var i=0;i<_1ebf.length;i++){if(!child){child=_1ebf[(dir>0)?0:(_1ebf.length-1)];}if(child.isFocusable()){return child;}child=this._getSiblingOfChild(child,dir);}return null;}});}if(!dojo._hasResource["dijit.MenuItem"]){dojo._hasResource["dijit.MenuItem"]=true;dojo.provide("dijit.MenuItem");dojo.declare("dijit.MenuItem",[dijit._Widget,dijit._Templated,dijit._Contained],{templateString:dojo.cache("dijit","templates/MenuItem.html","<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitem\" tabIndex=\"-1\"\n\t\tdojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset\" waiRole=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon\" dojoAttachPoint=\"iconNode\">\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" dojoAttachPoint=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" dojoAttachPoint=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" waiRole=\"presentation\">\n\t\t<div dojoAttachPoint=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\">\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"),attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{label:{node:"containerNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),label:"",iconClass:"",accelKey:"",disabled:false,_fillContent:function(_1ec0){if(_1ec0&&!("label" in this.params)){this.attr("label",_1ec0.innerHTML);}},postCreate:function(){dojo.setSelectable(this.domNode,false);var label=this.id+"_text";dojo.attr(this.containerNode,"id",label);if(this.accelKeyNode){dojo.attr(this.accelKeyNode,"id",this.id+"_accel");label+=" "+this.id+"_accel";}dijit.setWaiState(this.domNode,"labelledby",label);},_onHover:function(){dojo.addClass(this.domNode,"dijitMenuItemHover");this.getParent().onItemHover(this);},_onUnhover:function(){dojo.removeClass(this.domNode,"dijitMenuItemHover");this.getParent().onItemUnhover(this);},_onClick:function(evt){this.getParent().onItemClick(this,evt);dojo.stopEvent(evt);},onClick:function(evt){},focus:function(){try{if(dojo.isIE==8){this.containerNode.focus();}dijit.focus(this.focusNode);}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_1ec1){dojo.toggleClass(this.domNode,"dijitMenuItemSelected",_1ec1);},setLabel:function(_1ec2){dojo.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use attr('label', ...) instead.","","2.0");this.attr("label",_1ec2);},setDisabled:function(_1ec3){dojo.deprecated("dijit.Menu.setDisabled() is deprecated.  Use attr('disabled', bool) instead.","","2.0");this.attr("disabled",_1ec3);},_setDisabledAttr:function(value){this.disabled=value;dojo[value?"addClass":"removeClass"](this.domNode,"dijitMenuItemDisabled");dijit.setWaiState(this.focusNode,"disabled",value?"true":"false");},_setAccelKeyAttr:function(value){this.accelKey=value;this.accelKeyNode.style.display=value?"":"none";this.accelKeyNode.innerHTML=value;dojo.attr(this.containerNode,"colSpan",value?"1":"2");}});}if(!dojo._hasResource["dijit.PopupMenuItem"]){dojo._hasResource["dijit.PopupMenuItem"]=true;dojo.provide("dijit.PopupMenuItem");dojo.declare("dijit.PopupMenuItem",dijit.MenuItem,{_fillContent:function(){if(this.srcNodeRef){var nodes=dojo.query("*",this.srcNodeRef);dijit.PopupMenuItem.superclass._fillContent.call(this,nodes[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}this.inherited(arguments);if(!this.popup){var node=dojo.query("[widgetId]",this.dropDownContainer)[0];this.popup=dijit.byNode(node);}dojo.body().appendChild(this.popup.domNode);this.popup.domNode.style.display="none";if(this.arrowWrapper){dojo.style(this.arrowWrapper,"visibility","");}dijit.setWaiState(this.focusNode,"haspopup","true");},destroyDescendants:function(){if(this.popup){if(!this.popup._destroyed){this.popup.destroyRecursive();}delete this.popup;}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.CheckedMenuItem"]){dojo._hasResource["dijit.CheckedMenuItem"]=true;dojo.provide("dijit.CheckedMenuItem");dojo.declare("dijit.CheckedMenuItem",dijit.MenuItem,{templateString:dojo.cache("dijit","templates/CheckedMenuItem.html","<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitemcheckbox\" tabIndex=\"-1\"\n\t\tdojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset\" waiRole=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" dojoAttachPoint=\"iconNode\">\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" dojoAttachPoint=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" dojoAttachPoint=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" waiRole=\"presentation\">\n\t</td>\n</tr>\n"),checked:false,_setCheckedAttr:function(_1ec4){dojo.toggleClass(this.domNode,"dijitCheckedMenuItemChecked",_1ec4);dijit.setWaiState(this.domNode,"checked",_1ec4);this.checked=_1ec4;},onChange:function(_1ec5){},_onClick:function(e){if(!this.disabled){this.attr("checked",!this.checked);this.onChange(this.checked);}this.inherited(arguments);}});}if(!dojo._hasResource["dijit.MenuSeparator"]){dojo._hasResource["dijit.MenuSeparator"]=true;dojo.provide("dijit.MenuSeparator");dojo.declare("dijit.MenuSeparator",[dijit._Widget,dijit._Templated,dijit._Contained],{templateString:dojo.cache("dijit","templates/MenuSeparator.html","<tr class=\"dijitMenuSeparator\">\n\t<td colspan=\"4\">\n\t\t<div class=\"dijitMenuSeparatorTop\"></div>\n\t\t<div class=\"dijitMenuSeparatorBottom\"></div>\n\t</td>\n</tr>\n"),postCreate:function(){dojo.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});}if(!dojo._hasResource["dijit.Menu"]){dojo._hasResource["dijit.Menu"]=true;dojo.provide("dijit.Menu");dojo.declare("dijit._MenuBase",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{parentMenu:null,popupDelay:500,startup:function(){if(this._started){return;}dojo.forEach(this.getChildren(),function(child){child.startup();});this.startupKeyNavChildren();this.inherited(arguments);},onExecute:function(){},onCancel:function(_1ec6){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.focusedChild._onClick(evt);}else{var _1ec7=this._getTopMenu();if(_1ec7&&_1ec7._isMenuBar){_1ec7.focusNext();}}},_onPopupHover:function(evt){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _1ec8=this.currentPopup.parentMenu;if(_1ec8.focusedChild){_1ec8.focusedChild._setSelected(false);}_1ec8.focusedChild=this.currentPopup.from_item;_1ec8.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(dojo.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _1ec9=item.popup;if(_1ec9){this._stopPendingCloseTimer(_1ec9);_1ec9._pendingClose_timer=setTimeout(function(){_1ec9._pendingClose_timer=null;if(_1ec9.parentMenu){_1ec9.parentMenu.currentPopup=null;}dijit.popup.close(_1ec9);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(popup){if(popup._pendingClose_timer){clearTimeout(popup._pendingClose_timer);popup._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(item.disabled){return false;}if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.popup){this._openPopup();}else{this.onExecute();item.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _1eca=this.focusedChild;if(!_1eca){return;}var popup=_1eca.popup;if(popup.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);dijit.popup.close(this.currentPopup);}popup.parentMenu=this;popup.from_item=_1eca;var self=this;dijit.popup.open({parent:this,popup:popup,around:_1eca.domNode,orient:this._orient||(this.isLeftToRight()?{"TR":"TL","TL":"TR","BR":"BL","BL":"BR"}:{"TL":"TR","TR":"TL","BL":"BR","BR":"BL"}),onCancel:function(){self.focusChild(_1eca);self._cleanUp();_1eca._setSelected(true);self.focusedChild=_1eca;},onExecute:dojo.hitch(this,"_cleanUp")});this.currentPopup=popup;popup.connect(popup.domNode,"onmouseenter",dojo.hitch(self,"_onPopupHover"));if(popup.focus){popup._focus_timer=setTimeout(dojo.hitch(popup,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;dojo.addClass(this.domNode,"dijitMenuActive");dojo.removeClass(this.domNode,"dijitMenuPassive");},onOpen:function(e){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;dojo.removeClass(this.domNode,"dijitMenuActive");dojo.addClass(this.domNode,"dijitMenuPassive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.focusedChild){this.focusedChild._setSelected(false);this.focusedChild._onUnhover();this.focusedChild=null;}if(this.currentPopup){dijit.popup.close(this.currentPopup);this.currentPopup=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this._hoveredChild._onUnhover();}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});dojo.declare("dijit.Menu",dijit._MenuBase,{constructor:function(){this._bindings=[];},templateString:dojo.cache("dijit","templates/Menu.html","<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" waiRole=\"menu\" tabIndex=\"${tabIndex}\" dojoAttachEvent=\"onkeypress:_onKeyPress\">\n\t<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>\n</table>\n"),targetNodeIds:[],contextMenuForWindow:false,leftClickToOpen:false,refocus:true,_contextMenuWithMouse:false,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(dojo.body());}else{dojo.forEach(this.targetNodeIds,this.bindDomNode,this);}var k=dojo.keys,l=this.isLeftToRight();this._openSubMenuKey=l?k.RIGHT_ARROW:k.LEFT_ARROW;this._closeSubMenuKey=l?k.LEFT_ARROW:k.RIGHT_ARROW;this.connectKeyNavHandlers([k.UP_ARROW],[k.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);dojo.stopEvent(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{dojo.stopEvent(evt);}break;}},_iframeContentWindow:function(_1ecb){var win=dijit.getDocumentWindow(this._iframeContentDocument(_1ecb))||this._iframeContentDocument(_1ecb)["__parent__"]||(_1ecb.name&&dojo.doc.frames[_1ecb.name])||null;return win;},_iframeContentDocument:function(_1ecc){var doc=_1ecc.contentDocument||(_1ecc.contentWindow&&_1ecc.contentWindow.document)||(_1ecc.name&&dojo.doc.frames[_1ecc.name]&&dojo.doc.frames[_1ecc.name].document)||null;return doc;},bindDomNode:function(node){node=dojo.byId(node);var cn;if(node.tagName.toLowerCase()=="iframe"){var _1ecd=node,win=this._iframeContentWindow(_1ecd);cn=dojo.withGlobal(win,dojo.body);}else{cn=(node==dojo.body()?dojo.doc.documentElement:node);}var _1ece={node:node,iframe:_1ecd};dojo.attr(node,"_dijitMenu"+this.id,this._bindings.push(_1ece));var _1ecf=dojo.hitch(this,function(cn){return [dojo.connect(cn,(this.leftClickToOpen)?"onclick":"oncontextmenu",this,function(evt){this._openMyself(evt,cn,_1ecd);}),dojo.connect(cn,"onkeydown",this,"_contextKey"),dojo.connect(cn,"onmousedown",this,"_contextMouse")];});_1ece.connects=cn?_1ecf(cn):[];if(_1ecd){_1ece.onloadHandler=dojo.hitch(this,function(){var win=this._iframeContentWindow(_1ecd);cn=dojo.withGlobal(win,dojo.body);_1ece.connects=_1ecf(cn);});if(_1ecd.addEventListener){_1ecd.addEventListener("load",_1ece.onloadHandler,false);}else{_1ecd.attachEvent("onload",_1ece.onloadHandler);}}},unBindDomNode:function(_1ed0){var node;try{node=dojo.byId(_1ed0);}catch(e){return;}var _1ed1="_dijitMenu"+this.id;if(node&&dojo.hasAttr(node,_1ed1)){var bid=dojo.attr(node,_1ed1)-1,b=this._bindings[bid];dojo.forEach(b.connects,dojo.disconnect);var _1ed2=b.iframe;if(_1ed2){if(_1ed2.removeEventListener){_1ed2.removeEventListener("load",b.onloadHandler,false);}else{_1ed2.detachEvent("onload",b.onloadHandler);}}dojo.removeAttr(node,_1ed1);delete this._bindings[bid];}},_contextKey:function(e){this._contextMenuWithMouse=false;if(e.keyCode==dojo.keys.F10){dojo.stopEvent(e);if(e.shiftKey&&e.type=="keydown"){var _1ed3={target:e.target,pageX:e.pageX,pageY:e.pageY};_1ed3.preventDefault=_1ed3.stopPropagation=function(){};window.setTimeout(dojo.hitch(this,function(){this._openMyself(_1ed3);}),1);}}},_contextMouse:function(e){this._contextMenuWithMouse=true;},_openMyself:function(e,node,_1ed4){if(this.leftClickToOpen&&e.button>0){return;}dojo.stopEvent(e);var x,y;if(dojo.isSafari||this._contextMenuWithMouse){x=e.pageX;y=e.pageY;if(_1ed4){var od=e.target.ownerDocument,ifc=dojo.position(_1ed4,true),win=this._iframeContentWindow(_1ed4),_1ed5=dojo.withGlobal(win,"_docScroll",dojo);var cs=dojo.getComputedStyle(_1ed4),tp=dojo._toPixelValue,left=(dojo.isIE&&dojo.isQuirks?0:tp(_1ed4,cs.paddingLeft))+(dojo.isIE&&dojo.isQuirks?tp(_1ed4,cs.borderLeftWidth):0),top=(dojo.isIE&&dojo.isQuirks?0:tp(_1ed4,cs.paddingTop))+(dojo.isIE&&dojo.isQuirks?tp(_1ed4,cs.borderTopWidth):0);x+=ifc.x+left-_1ed5.x;y+=ifc.y+top-_1ed5.y;}}else{var _1ed6=dojo.position(e.target,true);x=_1ed6.x+10;y=_1ed6.y+10;}var self=this;var _1ed7=dijit.getFocus(this);function closeAndRestoreFocus(){if(self.refocus){dijit.focus(_1ed7);}dijit.popup.close(self);};dijit.popup.open({popup:this,x:x,y:y,onExecute:closeAndRestoreFocus,onCancel:closeAndRestoreFocus,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);dijit.popup.close(this);};},uninitialize:function(){dojo.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});}if(!dojo._hasResource["dojo.NodeList-fx"]){dojo._hasResource["dojo.NodeList-fx"]=true;dojo.provide("dojo.NodeList-fx");dojo.extend(dojo.NodeList,{_anim:function(obj,_1ed8,args){args=args||{};return dojo.fx.combine(this.map(function(item){var _1ed9={node:item};dojo.mixin(_1ed9,args);return obj[_1ed8](_1ed9);}));},wipeIn:function(args){return this._anim(dojo.fx,"wipeIn",args);},wipeOut:function(args){return this._anim(dojo.fx,"wipeOut",args);},slideTo:function(args){return this._anim(dojo.fx,"slideTo",args);},fadeIn:function(args){return this._anim(dojo,"fadeIn",args);},fadeOut:function(args){return this._anim(dojo,"fadeOut",args);},animateProperty:function(args){return this._anim(dojo,"animateProperty",args);},anim:function(_1eda,_1edb,_1edc,onEnd,delay){var canim=dojo.fx.combine(this.map(function(item){return dojo.animateProperty({node:item,properties:_1eda,duration:_1edb||350,easing:_1edc});}));if(onEnd){dojo.connect(canim,"onEnd",onEnd);}return canim.play(delay||0);}});}if(!dojo._hasResource["dojox.fx.Shadow"]){dojo._hasResource["dojox.fx.Shadow"]=true;dojo.provide("dojox.fx.Shadow");dojo.experimental("dojox.fx.Shadow");dojo.declare("dojox.fx.Shadow",dijit._Widget,{shadowPng:dojo.moduleUrl("dojox.fx","resources/shadow"),shadowThickness:7,shadowOffset:3,opacity:0.75,animate:false,node:null,startup:function(){this.inherited(arguments);this.node.style.position="relative";this.pieces={};var x1=-1*this.shadowThickness;var y0=this.shadowOffset;var y1=this.shadowOffset+this.shadowThickness;this._makePiece("tl","top",y0,"left",x1);this._makePiece("l","top",y1,"left",x1,"scale");this._makePiece("tr","top",y0,"left",0);this._makePiece("r","top",y1,"left",0,"scale");this._makePiece("bl","top",0,"left",x1);this._makePiece("b","top",0,"left",0,"crop");this._makePiece("br","top",0,"left",0);this.nodeList=dojo.query(".shadowPiece",this.node);this.setOpacity(this.opacity);this.resize();},_makePiece:function(name,_1edd,_1ede,_1edf,_1ee0,_1ee1){var img;var url=this.shadowPng+name.toUpperCase()+".png";if(dojo.isIE<7){img=dojo.create("div");img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+url+"'"+(_1ee1?", sizingMethod='"+_1ee1+"'":"")+")";}else{img=dojo.create("img",{src:url});}img.style.position="absolute";img.style[_1edd]=_1ede+"px";img.style[_1edf]=_1ee0+"px";img.style.width=this.shadowThickness+"px";img.style.height=this.shadowThickness+"px";dojo.addClass(img,"shadowPiece");this.pieces[name]=img;this.node.appendChild(img);},setOpacity:function(n,_1ee2){if(dojo.isIE){return;}if(!_1ee2){_1ee2={};}if(this.animate){var _1ee3=[];this.nodeList.forEach(function(node){_1ee3.push(dojo._fade(dojo.mixin(_1ee2,{node:node,end:n})));});dojo.fx.combine(_1ee3).play();}else{this.nodeList.style("opacity",n);}},setDisabled:function(_1ee4){if(_1ee4){if(this.disabled){return;}if(this.animate){this.nodeList.fadeOut().play();}else{this.nodeList.style("visibility","hidden");}this.disabled=true;}else{if(!this.disabled){return;}if(this.animate){this.nodeList.fadeIn().play();}else{this.nodeList.style("visibility","visible");}this.disabled=false;}},resize:function(args){var x;var y;if(args){x=args.x;y=args.y;}else{var co=dojo._getBorderBox(this.node);x=co.w;y=co.h;}var _1ee5=y-(this.shadowOffset+this.shadowThickness);if(_1ee5<0){_1ee5=0;}if(y<1){y=1;}if(x<1){x=1;}with(this.pieces){l.style.height=_1ee5+"px";r.style.height=_1ee5+"px";b.style.width=x+"px";bl.style.top=y+"px";b.style.top=y+"px";br.style.top=y+"px";tr.style.left=x+"px";r.style.left=x+"px";br.style.left=x+"px";}}});}if(!dojo._hasResource["com.ibm.mm.builder.widget.ShadowMenu"]){dojo._hasResource["com.ibm.mm.builder.widget.ShadowMenu"]=true;dojo.provide("com.ibm.mm.builder.widget.ShadowMenu");dojo.declare("com.ibm.mm.builder.widget.ShadowMenu",[dijit.Menu],{offset_x:0,offset_y:0,leftClickToOpen:true,openPosition:"BL",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){this.offset_x=-this.offset_x;}if(dojo.isIE===6){return;}this._connects.push([dojo.connect(window,"resize",this,function(){if(this.shadow){this.shadow.setDisabled(true);}dijit.popup.close(this);})]);dojo.addClass(this.domNode,"lotusActionMenu");},onItemHover:function(item){if(this.popupFocusTimer){clearTimeout(this.popupFocusTimer);}this.inherited(arguments);},_openMyself:function(e,node,_1ee6){if(this.leftClickToOpen&&e.button>0){return;}try{dojo.stopEvent(e);}catch(err){}var tnode=e.target;if(this.targetNodeIds&&this.targetNodeIds.length==1){tnode=this.targetNodeIds[0];}var _1ee7=dojo.coords(tnode,true);var cbox=dojo.contentBox(tnode);var xPack=0;if(this.openPosition.charAt(1)=="R"){xPack=this.isLeftToRight()?cbox.w:-cbox.w;}var x=_1ee7.x+xPack+(this.offset_x||0)+(this.isLeftToRight()?0:cbox.w);var y=_1ee7.y+(this.openPosition.charAt(0)=="B"?cbox.h:0)+(this.offset_y||0);var self=this;var _1ee8=null;try{_1ee8=dijit.getFocus(this);}catch(error){}this.closeAndRestoreFocus=function(){if(self.refocus&&_1ee8){dijit.focus(_1ee8);}dijit.popup.close(self);};this._prepareData();dijit.popup.open({popup:this,x:x,y:y,onExecute:this.closeAndRestoreFocus,onCancel:this.closeAndRestoreFocus,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);dijit.popup.close(this);};},_prepareData:function(){if(!this._isMenuCreated&&!this._isMenuCreating){this._isMenuCreating=true;this.prepareData();this._isMenuCreated=true;this._isMenuCreating=false;}},prepareData:function(){},_openPopup:function(){if(this.focusedChild.popup._prepareData){this.focusedChild.popup._prepareData();}this._orient=this.isLeftToRight()?{"TR":"TL","TL":"TR"}:{"TL":"TR","TR":"TL"};this.inherited(arguments);},onOpen:function(){this.inherited(arguments);var p=dojo.marginBox(this.domNode);if(p.w<1&&p.h<1){return;}this.shadow=this.shadow||new com.ibm.mm.builder.widget.Shadow({node:this.domNode});this.resizeShadow();},resizeShadow:function(){var s=this.shadow;setTimeout(function(){if(s){s.resize();s.setDisabled(false);}},50);},onClose:function(){dojo.forEach(this.containerNode.childNodes,function(item){dojo.removeClass(item,"dijitMenuItemHover");dojo.removeClass(item,"dijitMenuItemSelected");});this.inherited(arguments);if(this.shadow){this.shadow.setDisabled(true);}},destroy:function(){if(this.shadow){this.shadow.destroy();this.shadow=null;}this._onBlur=null;this.closeAndRestoreFocus=null;try{dijit.popup.close(this);}catch(e){}this.inherited(arguments);}});dojo.declare("com.ibm.mm.builder.widget.Shadow",dojox.fx.Shadow,{shadowPng:dojo.moduleUrl("com.ibm.mm.builder.widget","resources/shadow"),shadowThickness:5,shadowOffset:0,shadowOffset_x:5,postCreate:function(){this.inherited(arguments);this.node.style.position="relative";this.realNode=this.node;this.node=this._getFakeNode(this.realNode);this.pieces={};var x0=this.shadowOffset_x;var x1=-1*this.shadowThickness+this.shadowOffset_x;var y0=this.shadowOffset;var y1=this.shadowOffset+this.shadowThickness;if(this.isLeftToRight()){this._makePiece("tr","top",y0,"left",0);this._makePiece("r","top",y1,"left",0,"scale");this._makePiece("bl","top",0,"left",x1);this._makePiece("b","top",0,"left",x0,"scale");this._makePiece("br","top",0,"left",0);}else{x1=-1*this.shadowThickness;this._makePiece("tl","top",y0,"left",x1);this._makePiece("l","top",y1,"left",x1,"scale");this._makePiece("bl","top",0,"left",x1);this._makePiece("b","top",0,"left",0,"scale");this._makePiece("br","top",0,"right",0);}this.nodeList=dojo.query(".shadowPiece",this.node);dojo.forEach(this.nodeList,"dojo.attr(item,\"alt\",\"\");item.style.zIndex=1001;");},_getFakeNode:function(node){var _1ee9=dojo.coords(node,true);var _1eea=dojo.query(dojo.create("div",null,dojo.body())).addClass("mashupsShadowNode").style({position:"absolute",left:_1ee9.x+"px",top:_1ee9.y+"px",zIndex:998})[0];dojo.query(dojo.create("iframe",{frameborder:0},_1eea)).addClass("shadowedNodePlaceHolder").addClass("shadowPiece").style({heith:"0px",width:"0px"});this._resizeFakeNode(_1eea);return _1eea;},setDisabled:function(_1eeb){this.inherited(arguments);if(this.node){this.node.style.visibility=_1eeb?"hidden":"visible";}},resize:function(args){this._resizeFakeNode();var x,y;if(args){x=args.x;y=args.y;}else{var co=dojo.marginBox(this.realNode);x=co.w;y=co.h;}var _1eec=Math.max(x-this.shadowOffset_x,0);var _1eed=Math.max(y-(this.shadowOffset+this.shadowThickness),0);y=Math.max(y,1);x=Math.max(x,1);if(this.isLeftToRight()){dojo.marginBox(this.pieces.r,{h:_1eed,l:x});dojo.marginBox(this.pieces.tr,{l:x});dojo.marginBox(this.pieces.br,{l:x});}else{dojo.marginBox(this.pieces.l,{h:_1eed});}dojo.marginBox(this.pieces.b,{w:_1eec,t:y});dojo.marginBox(this.pieces.bl,{t:y});dojo.marginBox(this.pieces.br,{t:y});},_resizeFakeNode:function(node){var _1eee=node||this.node;var _1eef=dojo.coords(this.realNode,true);var pl=dojo.query(".shadowedNodePlaceHolder",_1eee)[0];if(pl){dojo.marginBox(pl,{w:_1eef.w,h:_1eef.h});}if(_1eee){dojo.marginBox(_1eee,{l:_1eef.x,t:_1eef.y});}},uninitialize:function(){if(this.node){dojo.destroy(this.node);this.node=null;}this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.mm.builder.widget.MumMenu"]){dojo._hasResource["com.ibm.mm.builder.widget.MumMenu"]=true;dojo.provide("com.ibm.mm.builder.widget.MumMenu");dojo.declare("com.ibm.mm.builder.widget.MumMenu",com.ibm.mm.builder.widget.ShadowMenu,{counter:0,templateString:"<table class=\"dijit remixMenu\" waiRole=\"menu\" dojoAttachEvent=\"onkeypress:_onKeyPress\">"+"<tbody class=\"dijitReset\" dojoAttachPoint=\"containerNode\"></tbody>"+"</table>",postCreate:function(){this.inherited(arguments);if(this.targetNodeIds&&this.targetNodeIds.length==1){var _1ef0=this.targetNodeIds[0];var _1ef1=_1ef0.id;if(_1ef1){if(_1ef1.indexOf("_menu")!=-1){var _1ef2=_1ef1.substr(0,_1ef1.length-5);var _1ef3=dojo.byId(_1ef2);if(_1ef3){if(_1ef3.getAttribute("visible")==="false"){this.offset_x=41;this.offset_y=dojo.isIE?0:8;}}var _1ef4=dijit.byId(_1ef2+com.ibm.mm.builder.constant.dragHandler+"_editbar");if(_1ef4){dojo.connect(this,"onBlur",_1ef4,"hide");}}}}},_pubMenuEvent:function(){},resizeShadow:function(){var self=this;setTimeout(function(){if(self.shadow){self.shadow.resize();self.shadow.setDisabled(false);}},(dojo.isIE===7?500:0));},onClose:function(){this.counter=this.counter+1;this.inherited(arguments);if(this.counter==2){this.counter=0;var self=this;setTimeout(function(){self._pubMenuEvent();},0);}},onBlur:function(){dijit.popup.close(this);},onOpen:function(){try{this.inherited(arguments);var self=this;if(dojo.isIE!==7){return;}setTimeout(function(){if(self.parentMenu&&self.parentMenu.shadow){self.parentMenu.shadow.resize();}},250);}catch(e){console.log(e);}}});dojo.declare("com.ibm.mm.builder.widget.MumMenuItem",dijit.MenuItem,{templateString:"<tr class=\"dijitReset dijitMenuItem remixMenuItem\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitem\" tabIndex=\"-1\" "+"dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">"+"<td><div dojoAttachPoint=\"iconNode\" class=\"dijitReset lotusDijitMenuItemIcon\"></div></td>"+"<td tabIndex=\"-1\" class=\"dijitReset dijitMenuItemLabel lotusDijitMenuItemLabel truncatedLabel\" widthLimit=\"170\" dojoAttachPoint=\"containerNode\" waiRole=\"menuitem\"></td>"+"<td class=\"dijitReset\" dojoAttachPoint=\"arrowCell\">"+"<div dojoAttachPoint=\"arrowWrapper\" style=\"display: none\">"+"<div class=\"lotusDijitMenuExpandEnabled\"></div>"+"<span class=\"dijitMenuExpandA11y\">+</span>"+"</div>"+"</td>"+"<td><div class=\"dijitReset lotusDijitMenuItemIcon\"></div></td>"+"</tr>",postCreate:function(){if(dojo.isIE===7){com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(this.containerNode,null,{fontSize:"1.3em"});}},focus:function(){dojo.addClass(this.domNode,"dijitMenuItemHover");this.inherited(arguments);},_setSelected:function(_1ef5){this.inherited(arguments);if(_1ef5){return;}dojo.removeClass(this.domNode,"dijitMenuItemHover");},setDisabled:function(value){this.disabled=value;dojo[value?"addClass":"removeClass"](this.domNode,"remixMenuItemDisabled");dijit.setWaiState(this.containerNode,"disabled",value?"true":"false");},startup:function(){if(this.popup){dojo.body().appendChild(this.popup.domNode);this.arrowWrapper.style.display="";this.popup.domNode.style.display="none";dijit.setWaiState(this.containerNode,"haspopup","true");}},destroyDescendants:function(){if(this.popup){this.popup.destroyRecursive();delete this.popup;}this.inherited(arguments);}});dojo.declare("com.ibm.mm.builder.widget.MumPopupMenuItem",com.ibm.mm.builder.widget.MumMenuItem,{_fillContent:function(){if(this.srcNodeRef){var nodes=dojo.query("*",this.srcNodeRef);dijit.PopupMenuItem.superclass._fillContent.call(this,nodes[0]);this.dropDownContainer=this.srcNodeRef;}},startup:function(){if(this._started){return;}this.inherited(arguments);if(!this.popup){var node=dojo.query("[widgetId]",this.dropDownContainer)[0];this.popup=dijit.byNode(node);}dojo.body().appendChild(this.popup.domNode);this.popup.domNode.style.display="none";if(this.arrowWrapper){dojo.style(this.arrowWrapper,"visibility","");}dijit.setWaiState(this.focusNode,"haspopup","true");},destroyDescendants:function(){if(this.popup){this.popup.destroyRecursive();delete this.popup;}this.inherited(arguments);}});dojo.declare("com.ibm.mm.builder.widget.MumMenuSeparator",dijit.MenuSeparator,{templateString:"<tr>"+"<td colspan=4>"+"<div class=\"mumMenuSeparator\"></div>"+"</td>"+"</tr>"});}if(!dojo._hasResource["com.ibm.mm.builder.widget.WidgetMenu"]){dojo._hasResource["com.ibm.mm.builder.widget.WidgetMenu"]=true;dojo.provide("com.ibm.mm.builder.widget.WidgetMenu");dojo.declare("com.ibm.mm.builder.widget.WidgetMenu",null,{iwidgetId:"",targetNode:null,inNva:false,pMenu:null,editPane:null,editorDiv:null,cws:com.ibm.mm.builder.coreWidgetsStrings,supportedModeString:{"print":com.ibm.mm.builder.coreWidgetsStrings.I_CONTEXT_MENU_MODE_PRINT,"help":com.ibm.mm.builder.coreWidgetsStrings.I_CONTEXT_MENU_MODE_HELP},oldWidgetConfigId:"",oldWidgetConfigParentNode:null,constructor:function(_1ef6){this.needResizeMoveMenuItems=true;dojo.mixin(this,_1ef6);this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.widget.WidgetMenu");this.eventService=com.ibm.mashups.services.ServiceManager.getService("eventService");this.widgetModes=com.ibm.mm.builder.utils.iwidgetUtil.getWidgetSupportedModes(this.iwidgetId);this.cleanDomDialogHandle=dojo.subscribe(com.ibm.mm.builder.eventTopics.Page_ContentChanged,this,"cleanDomDialog");dojo.subscribe(com.ibm.mm.builder.Topics.Widget_ConfigurationFinished,this,"closeEditDialog");},hasEditMode:function(){return this.isWidgetLoaded()&&dojo.indexOf(this.widgetModes,"edit")>=0;},isWidgetLoaded:function(){var _1ef7=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(this.iwidgetId);return _1ef7&&_1ef7.loaded;},createOtherModesItem:function(){var _1ef8=null;var _1ef9=this;dojo.forEach(this.widgetModes,function(mode){if(mode!="view"&&mode!="edit"){_1ef8=_1ef8||new com.ibm.mm.builder.widget.MumMenu({id:this.targetNode.id+"_mode",parentMenu:this.pMenu});_1ef8.addChild(new com.ibm.mm.builder.widget.MumMenuItem({label:mode.charAt(0).toUpperCase()+mode.substring(1),userMode:mode,onClick:function(){_1ef9.showModePane(this.userMode);}}));}},this);if(_1ef8){this.pMenu.addChild(new com.ibm.mm.builder.widget.MumPopupMenuItem({label:this.cws.I_CONTEXT_MENU_MODE,popup:_1ef8,disabled:!this.isWidgetLoaded()}));}},createSkinItem:function(){var _1efa=this;var _1efb=new com.ibm.mm.builder.widget.MumMenu({id:this.targetNode.id+"_skin",parentMenu:this.pMenu});var _1efc=this.iwidgetId;var _1efd=dojo.byId(this.iwidgetId).getAttribute("skin");var lc=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();dojo.forEach(com.ibm.mm.builder.utils.skinUtil.getAllSkins(),function(skin){if(!skin.getMetaData("com.ibm.mashups.builder.skin.nva")){var _1efe=skin.getTitle(ibmConfig["default.locale"]!=dojo.locale?lc.getLocale(skin):dojo.locale);var _1eff=new com.ibm.mm.builder.widget.MumMenuItem({label:_1efe,skinID:skin.getID(),iconClass:skin.getID()==_1efd?"menuIconClass":"",onClick:function(){_1efa.eventService.broadcastEvent("com.ibm.mashups.builder.changeSkin",{id:_1efc,skin:this.skinID});}});if(_1efd==skin.getID()&&!(dojo.isIE===8&&builderConfig.isBidi)){var _1f00=dojo.doc.createElement("span");dojo.addClass(_1f00,"access");_1f00.innerHTML="is selected";_1eff.containerNode.appendChild(_1f00);}_1efb.addChild(_1eff);}},this);this.pMenu.addChild(new com.ibm.mm.builder.widget.MumPopupMenuItem({label:this.cws.I_CONTEXT_MENU_SKIN,popup:_1efb,disabled:!this.isWidgetLoaded()}));},createDiaplayItem:function(inNva){return new com.ibm.mm.builder.widget.MumMenuItem({label:inNva?this.cws.I_CONTEXT_MENU_DISPLAY:this.cws.I_CONTEXT_MENU_HIDE,iconClass:inNva?"contextMenuIconDisplay":"contextMenuIconHide",disabled:!this.isWidgetLoaded(),onClick:dojo.hitch(this,function(){this.eventService.broadcastEvent(inNva?"com.ibm.mashups.builder.displayWidget":"com.ibm.mashups.builder.hideWidget",this.iwidgetId);})});},createMenu:function(){this.pMenu=new com.ibm.mm.builder.widget.MumMenu({targetNodeIds:[this.targetNode],id:this.targetNode.id+"_menu"});var _1f01=com.ibm.mashups.builder.model.Factory.getContextMenuModel();var _1f02=_1f01.getContextMenu("ContextMenu.widgetSkin",this.iwidgetId,null,{context:this});for(var i=0;i<_1f02.length;++i){if(_1f02[i].isSeparator){if(this.needResizeMoveMenuItems){this.pMenu.addChild(new com.ibm.mm.builder.widget.MumMenuSeparator());}else{if(_1f02[i].id!="resizeMenuSeparator"){this.pMenu.addChild(new com.ibm.mm.builder.widget.MumMenuSeparator());}}continue;}if(!this.needResizeMoveMenuItems){if((_1f02[i].id==="resize")||(_1f02[i].id==="move")){continue;}}var _1f03=_1f02[i].id?_1f02[i].id:"";switch(_1f03){case "supportModes":this.createOtherModesItem();break;case "skins":if(!this.inNva){this.createSkinItem();}break;case "hideOrShow":this.pMenu.addChild(this.createDiaplayItem(this.inNva));break;default:var mitem=new com.ibm.mm.builder.widget.MumMenuItem({label:_1f02[i].title,iconClass:_1f02[i].iconClass,disabled:!_1f02[i].enabled,onClick:_1f02[i].actionCallBackFunction});this.pMenu.addChild(mitem);break;}}this.pMenu._pubMenuEvent=dojo.hitch(this,this.hideMenu);this.pMenu.startup();},open:function(evt){if(this.pMenu){this.pMenu.destroyRecursive();delete this.pMenu;}if(!this.pMenu){this.createMenu();}this.pMenu._openMyself(evt);},showModePane:function(mode){mode=mode.toLowerCase();var _1f04=com.ibm.mm.builder.utils.iwidgetUtil.getWidgetInstanceTitle(this.iwidgetId);var _1f05=this.supportedModeString[mode.toLowerCase()];var _1f06=_1f05||mode.charAt(0).toUpperCase()+mode.substring(1);widgetMenu=this;this.otherModePane=new com.ibm.mm.builder.widget.GeneralWidgetModeDialog({id:this.iwidgetId+"_"+mode,title:dojo.string.substitute(this.cws.I_SYSTEM_MODE_TITLE,[_1f06,_1f04]),type:mode,nodeWidth:"600px",nodeHeight:"400px",needModeSwitch:true,belongId:this.iwidgetId,containerBackgroundColor:"white",closeCallback:function(){this.destroyRecursive();}});com.ibm.mashups.services.ServiceManager.getService("eventService").fireEvent(this.iwidgetId,"onModeChanged",{newMode:mode,rootElementId:this.otherModePane.containerNode});this.otherModePane.show();},showEditPane:function(){this.oldWidgetConfigId="";this.oldWidgetConfigParentNode=null;var _1f07=dojo.byId(this.iwidgetId);var _1f08="";var items=com.ibm.mm.builder.utils.htmlUtil.getChildrenbyClass(com.ibm.mm.builder.constant.mmItem,_1f07);dojo.forEach(items,function(item){var str=com.ibm.mm.builder.utils.iWidgetSpecUtil.getKeyFromHref(item);if(str==com.ibm.mm.builder.constant.configPannelNode){_1f08="_"+this.iwidgetId+"_"+item.innerHTML.replace(/\n/g,"");}});if(_1f08){this.oldWidgetConfigId=_1f08;this.oldWidgetConfigParentNode=dojo.byId(_1f08).parentNode;var _1f09=dojo.byId(_1f08);_1f09.style.display="";this.editorDiv.appendChild(_1f09);}var _1f0a=com.ibm.mm.builder.utils.iwidgetUtil.getWidgetInstanceTitle(this.iwidgetId);if(!com.ibm.mm.builder.editPane){com.ibm.mm.builder.editPane=new com.ibm.mm.builder.widget.WidgetEditDialog({id:this.iwidgetId+"_edit",title:dojo.string.substitute(this.cws.I_SYSTEM_CONF_TITLE,[_1f0a]),type:"config",nodeWidth:dojo.byId(this.iwidgetId).getAttribute("sandbox")==="true"?"600px":null,nodeHeight:dojo.byId(this.iwidgetId).getAttribute("sandbox")==="true"?"400px":null,needModeSwitch:true,modelDialog:true,belongId:this.iwidgetId,containerBackgroundColor:"white"});}else{com.ibm.mm.builder.editPane.setTitle(dojo.string.substitute(this.cws.I_SYSTEM_CONF_TITLE,[_1f0a]));com.ibm.mm.builder.editPane.id=this.iwidgetId+"_edit";com.ibm.mm.builder.editPane.belongId=this.iwidgetId;com.ibm.mm.builder.editPane.nodeWidth=dojo.byId(this.iwidgetId).getAttribute("sandbox")==="true"?"600px":null;com.ibm.mm.builder.editPane.nodeHeight=dojo.byId(this.iwidgetId).getAttribute("sandbox")==="true"?"400px":null;com.ibm.mm.builder.editPane.containerNode.innerHTML="";com.ibm.mm.builder.editPane.dynaInitialized=false;com.ibm.mm.builder.editPane.containerNode.style.display="";}this._fillInEditModeContent(_1f08);com.ibm.mm.builder.editPane.show();},_fillInEditModeContent:function(_1f0b){if(!_1f0b){com.ibm.mashups.services.ServiceManager.getService("eventService").fireEvent(this.iwidgetId,"onModeChanged",{newMode:"edit",rootElementId:com.ibm.mm.builder.editPane.containerNode});}if(this.oldWidgetConfigId!=""){var _1f0c=this.oldWidgetConfigId;var _1f0d=this.oldWidgetConfigParentNode;com.ibm.mm.builder.editPane.oldWidgetSpecHitch=function(){if((_1f0c!="")&&(_1f0d)){dojo.byId(_1f0c).style.display="none";_1f0d.appendChild(dojo.byId(_1f0c));}};}},hideMenu:function(){dojo.unsubscribe(this.cleanDomDialogHandle);dojo.unsubscribe(this.editActionHandle);if(this.pMenu){this.pMenu.destroyRecursive();}if(this.modePopup){this.modePopup.destroyRecursive();}if(this.skinPopup){this.skinPopup.destroyRecursive();}var _1f0e=dijit.byId(this.iwidgetId+com.ibm.mm.builder.constant.editbarDragHandler);if(_1f0e){_1f0e.hide();}var _1f0f=dojo.byId(this.iwidgetId);if(_1f0f){if(_1f0f.getAttribute("visible")==="false"){com.ibm.mm.builder.skinHelper.hideNVASkinEditMode(this.iwidgetId+"_menu",this.iwidgetId+"_icon",this.iwidgetId+"_name",this.iwidgetId+"_upper");}}this.pMenu=null;this.modePopup=null;this.skinPopup=null;},cleanDomDialog:function(){this.destroyElementsFromBodyByClass("dijitDialog");this.destroyElementsFromBodyByClass("dijitDialogUnderlayWrapper");},closeEditDialog:function(_1f10){this.eventService.fireEvent(_1f10,"onModeChanged",{newMode:"view"});},destroyElementsFromBodyByClass:function(_1f11){var _1f12=com.ibm.mm.builder.utils.htmlUtil.getChildrenbyClass(_1f11,dojo.body());for(var j=0;_1f12&&j<_1f12.length;j++){if(_1f11==="dijitDialog"&&_1f12[j].getAttribute("widgetid")==="pageSourceContainer"){continue;}dojo.destroy(_1f12[j]);}},destroy:function(){if(this.pMenu){this.pMenu.destroyRecursive();}delete this.pMenu;}});com.ibm.mm.builder.editPane=null;}if(!dojo._hasResource["com.ibm.mm.builder.SkinHelper"]){dojo._hasResource["com.ibm.mm.builder.SkinHelper"]=true;dojo.provide("com.ibm.mm.builder.SkinHelper");dojo.declare("com.ibm.mm.builder.SkinHelper",null,{overWidgetHandler:null,outWidgetHandler:null,nva_IconHideTimer:null,nva_IconShowTimer:null,createMenu:function(evt,_1f13,_1f14,inNva){if(com.ibm.mm.builder.widgetMenu&&com.ibm.mm.builder.widgetMenu.pMenu&&com.ibm.mm.builder.widgetMenu.pMenu.isShowingNow){if(_1f14!=com.ibm.mm.builder.widgetMenu.iwidgetId){com.ibm.mm.builder.widgetMenu.hideMenu();}else{return;}}if(com.ibm.mm.builder.widgetMenu){com.ibm.mm.builder.widgetMenu.destroy();}com.ibm.mm.builder.widgetMenu=new com.ibm.mm.builder.widget.WidgetMenu({iwidgetId:_1f14,inNva:inNva,targetNode:dojo.byId(_1f13)});com.ibm.mm.builder.widgetMenu.open(evt);com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setDirty(true);},launchWiring:function(_1f15){var _1f16=com.ibm.mm.builder.utils.iwidgetUtil;var _1f17=_1f16.getWidgetInstanceIcon(_1f15);var _1f18={nodeWidth:"486px",title:com.ibm.mm.builder.coreWidgetsStrings.I_WIRING_NAME,titleIconUrl:_1f17,leftBarWidth:"18px",rightBarWidth:"12px",displayCloseButton:true,hasRightBottomResizer:false};var _1f19={widgetTypeId:"wireInterface",eventName:"com.ibm.mashups.builder.editWire",eventPayload:_1f15,dialogParam:_1f18,hasRightBottomResizer:false,requestRefresh:true};com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_1f19);},launchWireGraph:function(_1f1a){com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.displayWireGraph",_1f1a);},getMaxZOrder:function(_1f1b){var _1f1c=50;if(eval("_"+_1f1b+"_iContext")){var _1f1d=eval("_"+_1f1b+"_iContext.scope.getWidgets()");if(_1f1d&&_1f1d.length>0){for(var i=0;i<_1f1d.length;i++){var _1f1e=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1f1d[i]);if(_1f1e&&_1f1e.style.zIndex){var _1f1f=parseInt(_1f1e.style.zIndex,10);if(_1f1c<_1f1f){_1f1c=_1f1f;}}}_1f1c=_1f1c+1;}}return _1f1c;},displayMenuIcon:function(_1f20,_1f21,_1f22,_1f23){window.clearTimeout(this.nva_IconHideTimer);this.nva_IconShowTimer=window.setTimeout(function(){if(dijit.byId(_1f20+"_menu")){return;}var menu=dojo.byId(_1f20);var icon=dojo.byId(_1f21);menu.style.display="";icon.parentNode.style.display="none";var upper=dojo.byId(_1f23);dojo.addClass(upper,"nvaUpperDivHovered");var _1f24=dojo.query(".nva_widgetInteraction",menu)[0];_1f24.focus();},10);},hideMenuIcon:function(_1f25,_1f26,_1f27,_1f28){window.clearTimeout(this.nva_IconShowTimer);if(dijit.byId(_1f25+"_menu")){return;}this.nva_IconHideTimer=window.setTimeout(function(){if(dijit.byId(_1f25+"_menu")){return;}com.ibm.mm.builder.skinHelper.hideNVASkinEditMode(_1f25,_1f26,_1f27,_1f28);},10);},hideNVASkinEditMode:function(_1f29,_1f2a,_1f2b,_1f2c){var menu=dojo.byId(_1f29);if(menu){menu.style.display="none";}var icon=dojo.byId(_1f2a);if(icon){icon.parentNode.style.display="";}var upper=dojo.byId(_1f2c);if(upper){dojo.removeClass(upper,"nvaUpperDivHovered");}},displayEditBar:function(_1f2d,_1f2e){this.setEditBarOpaque(_1f2d,_1f2e);},hideEditBar:function(_1f2f,_1f30){window.clearTimeout(this["showEditTimer_"+_1f2f]);window.clearTimeout(this["hideEditTimer_"+_1f2f]);var tid="";if(builderConfig.isBidi&&dojo.isIE===6){tid=this.getWidgetIdByEditBarId(_1f2f);}this["hideEditTimer_"+_1f2f]=window.setTimeout(function(){var _1f31=_1f2f.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHandlerExt);var _1f32;if(_1f30){_1f32=dojo.byId(_1f30);}else{_1f32=dojo.byId(_1f2f.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHandlerExt))||dojo.byId(_1f2f.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHeightExt));}var _1f33=dojo.byId(_1f2f);if(_1f33){_1f33.style.display="none";if(builderConfig.isBidi&&dojo.isIE){dojo.removeClass(dojo.byId(tid+com.ibm.mm.builder.constant.widgetBody),"widgetBodyEdit");var _1f34=dojo.byId(tid+"_title");if(_1f34){dojo.removeClass(dojo.byId(tid+"_title"),"widgetTitleEdit");}if(dojo.hasClass(dojo.byId(tid+com.ibm.mm.builder.constant.widgetContent),"rtlOverride_IE_paddingTop_0px")){dojo.byId(tid+com.ibm.mm.builder.constant.widgetContent).style.paddingTop="0px";}}}if(_1f32){_1f32.style.display="none";}},100);},keepEditBar:function(_1f35){window.clearTimeout(this["hideEditTimer_"+_1f35]);},setEditBarOpaque:function(_1f36,_1f37){window.clearTimeout(this["hideEditTimer_"+_1f36]);if(!(builderConfig.isBidi&&dojo.isIE===6)){this.showEditBarTimer=window.setTimeout(function(){var _1f38;if(_1f37){_1f38=dojo.byId(_1f37);}else{_1f38=dojo.byId(_1f36.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHandlerExt))||dojo.byId(_1f36.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHeightExt));}var _1f39=dojo.byId(_1f36);if(_1f39){_1f39.style.display="";}if(_1f38){_1f38.style.display="";}},100);}else{this.bidiSetEditBarOpaque(_1f36,_1f37);}},getEditBarIdBySkinId:function(_1f3a){var _1f3b=_1f3a.substring(com.ibm.mm.builder.constant.skinIdPrefix.length,_1f3a.length);return _1f3b+com.ibm.mm.builder.constant.editbarDragHandler;},getColumnResizeBarIdBySkinId:function(_1f3c){var _1f3d=_1f3c.substring(com.ibm.mm.builder.constant.skinIdPrefix.length,_1f3c.length);return _1f3d+com.ibm.mm.builder.constant.resizeHeightExt;},getFreeFormResizeBarIdBySkinId:function(_1f3e){var _1f3f=_1f3e.substring(com.ibm.mm.builder.constant.skinIdPrefix.length,_1f3e.length);return _1f3f+com.ibm.mm.builder.constant.resizeHandlerExt;},getWidgetIdByEditBarId:function(_1f40){return _1f40.substr(0,_1f40.length-com.ibm.mm.builder.constant.editbarDragHandler.length);},getWidgetIdByNvaSkinId:function(_1f41){_1f41=_1f41.replace(com.ibm.mm.builder.constant.skinIdPrefix,"");return _1f41.replace(com.ibm.mm.builder.constant.nva_skin_upper,"");},bidiSetEditBarOpaque:function(_1f42,_1f43){if(builderConfig.isBidi&&dojo.isIE===6){var _1f44=null;var _1f45=null;var _1f46=null;var tid=this.getWidgetIdByEditBarId(_1f42);if(this.isColumnLayout(tid)){dojo.byId(tid+com.ibm.mm.builder.constant.editbarDragHandler).style.position="static";}var style=this.getStyle(dojo.byId(tid+com.ibm.mm.builder.constant.widgetBody),"top");if(style!==null){_1f44=style;var _1f47=this.getColumnLayoutAdjustment(tid);if(_1f47){_1f44=parseInt(_1f44,10)+_1f47+"px";}}var _1f48=dojo.byId(tid+"_title");if(_1f48){style=this.getStyle(_1f48,"top");if(style!==null){_1f45=style;}}_1f46=this.getStyle(dojo.byId(tid+com.ibm.mm.builder.constant.widgetContent),"paddingTop");this.showEditBarTimer=window.setTimeout(function(){var _1f49;if(_1f43){_1f49=dojo.byId(_1f43);}else{_1f49=dojo.byId(_1f42.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHandlerExt))||dojo.byId(_1f42.replace(com.ibm.mm.builder.constant.dragHandler+"_editbar",com.ibm.mm.builder.constant.resizeHeightExt));}var _1f4a=dojo.byId(_1f42);if(_1f4a){_1f4a.style.display="";dojo.addClass(dojo.byId(tid+com.ibm.mm.builder.constant.widgetBody),"widgetBodyEdit");var _1f4b=dojo.byId(tid+"_title");if(_1f4b){dojo.addClass(dojo.byId(tid+"_title"),"widgetTitleEdit");}if(_1f44!==null){dojo.byId(tid+com.ibm.mm.builder.constant.widgetBody).style.top=_1f44;}if(_1f45!==null){_1f4b.style.top=_1f45;}if(_1f46!==null){dojo.byId(tid+com.ibm.mm.builder.constant.widgetContent).style.paddingTop=_1f46;}}if(_1f49){_1f49.style.display="";}},100);}},getStyle:function(div,_1f4c){var _1f4d=(div.className).split(" ");if(_1f4d){for(var i=0;i<_1f4d.length;i++){var str=_1f4d[i].split("_");if(str.length&&str.length===3){if((str[0]=="rtlEditIE6"&&dojo.isIE===6)||(str[0]=="rtlEditIE7"&&dojo.isIE===7)||(str[0]=="rtlEditIE8"&&dojo.isIE===8)){if(str[1]===_1f4c){return str[2];}}}}}return null;},getColumnLayoutAdjustment:function(tid){var _1f4e=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+tid);var _1f4f=0;var _1f50=null;var _1f51=_1f4e.previousSibling;while(_1f51){if(_1f50===null){_1f50=com.ibm.mm.builder.columnLayoutBean.getPageAttrJSONObject();}_1f4f=_1f4f+parseInt(_1f51.style.height,10)+parseInt(_1f50.widthBetweenWidgets,10);_1f51=_1f51.previousSibling;}return _1f4f;},isColumnLayout:function(tid){var _1f52=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+tid);var _1f53=false;var _1f54=_1f52.parentNode;if(dojo.hasClass(_1f54,com.ibm.mm.builder.constant.columnLayoutClass)){_1f53=true;}return _1f53;}});com.ibm.mm.builder.skinHelper=new com.ibm.mm.builder.SkinHelper();com.ibm.mm.builder.widgetMenu=null;}if(!dojo._hasResource["com.ibm.mm.builder.utils.skinUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.skinUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.skinUtil");com.ibm.mm.builder.utils.skinUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.skinUtil");com.ibm.mm.builder.utils.skinUtil.getSkinNode=function(_1f55){var _1f56=com.ibm.mm.builder.utils.skinUtil._getSkinModel();if(_1f56!==null){return _1f56.find(_1f55).start();}com.ibm.mm.builder.utils.skinUtil.LOGGER.severe("getSkinNode",com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_THEME_NOT_EXIST_0);return null;};com.ibm.mm.builder.utils.skinUtil.getDefaultSkinId=function(){var _1f57=com.ibm.mm.builder.utils.themeUtil.getCurrentThemeId();if(_1f57){var _1f58=com.ibm.mm.builder.utils.themeUtil.getThemeModel(true);var theme=com.ibm.mm.builder.utils.themeUtil.getThemeNode(_1f57);if(theme!==null){return theme.getDefaultSkin();}else{com.ibm.mm.builder.utils.skinUtil.LOGGER.severe("getDefaultSkinId",com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_THEME_NOT_EXIST_0);return null;}}return null;};com.ibm.mm.builder.utils.skinUtil.getDefaultSkin=function(){var _1f59=com.ibm.mm.builder.utils.skinUtil.getDefaultSkinId();if(_1f59){return com.ibm.mm.builder.utils.skinUtil.getSkinNode(_1f59);}else{return com.ibm.mm.builder.utils.skinUtil.getFirstSkinNode();}};com.ibm.mm.builder.utils.skinUtil.getFirstSkinNode=function(){var _1f5a=com.ibm.mm.builder.utils.skinUtil._getSkinModel();if(_1f5a!==null){var _1f5b=_1f5a.iterator();if(_1f5b.hasNext()){var skin=_1f5b.next();var title=skin.getTitle("en");if((title)&&(skin.getMetaData("com.ibm.mashups.builder.skin.nva"))){skin=_1f5b.next();}return skin;}}com.ibm.mm.builder.utils.skinUtil.LOGGER.severe("getFirstSkinNode",com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_THEME_NOT_EXIST_0);return null;};com.ibm.mm.builder.utils.skinUtil.getNVANode=function(){var skins=com.ibm.mm.builder.utils.skinUtil.getAllSkins();var _1f5c=null;dojo.forEach(skins,function(skin){var title=skin.getTitle("en");if((title)&&(skin.getMetaData("com.ibm.mashups.builder.skin.nva"))){_1f5c=skin;}});if(_1f5c){return _1f5c;}else{com.ibm.mm.builder.utils.skinUtil.LOGGER.severe("getNVANode",com.ibm.mm.builder.coreWidgetsMessages.E_SKIN_THEME_NOT_EXIST_0);return null;}};com.ibm.mm.builder.utils.skinUtil._getSkinModel=function(){var _1f5d=com.ibm.mm.builder.utils.themeUtil.getCurrentThemeId();var _1f5e=com.ibm.mm.builder.utils.themeUtil.getThemeModel();var theme=com.ibm.mm.builder.utils.themeUtil.getThemeNode(_1f5d);if(theme!==null){if(!this.skinModel){this.skinModel=_1f5e.getSkinModel(theme);this.skinModel.setStrategy(new com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy(10));}return this.skinModel;}return null;};com.ibm.mm.builder.utils.skinUtil.getEditBarNode=function(args,_1f5f){var _1f60=document.createElement("div");dojo.addClass(_1f60,"editBar");_1f60.id=args.widgetId+com.ibm.mm.builder.constant.editbarDragHandler;_1f60.style.display="none";dojo.connect(_1f60,"onmouseover",null,function(){com.ibm.mm.builder.skinHelper.setEditBarOpaque(args.widgetId+com.ibm.mm.builder.constant.editbarDragHandler);});var _1f61=document.createElement("div");_1f61.id=args.widgetId+"_dragHandler";dojo.addClass(_1f61,"dojoDndHandle");dojo.addClass(_1f61,"borderinHM");var _1f62=document.createElement("div");dojo.addClass(_1f62,"widgetDragHandlerMiddle");var _1f63=document.createElement("img");dojo.addClass(_1f63,"widgetIconStyle");var _1f64=document.createElement("span");_1f64.innerHTML=args.title;dojo.addClass(_1f64,"widgetTitleShadow");var _1f65=document.createElement("span");_1f65.innerHTML=args.title;dojo.addClass(_1f65,"widgetTitle");if(dojo.isSafari||dojo.isIE){_1f64.style.width="75%";_1f65.style.width="75%";}var _1f66=document.createElement("input");_1f66.alt=_1f66.title=com.ibm.mm.builder.coreWidgetsStrings.I_SKIN_WIRE_ICON_TITLE;dojo.addClass(_1f66,"widgetInteraction");dojo.attr(_1f66,"type","image");if(builderConfig.isBidi){dojo.attr(_1f66,"src",builderConfig.builderPath+"/images/d_wiring_icon_rtl.png");}else{dojo.attr(_1f66,"src",builderConfig.builderPath+"/images/d_wiring_icon.png");}dojo.connect(_1f66,"onclick",null,function(){com.ibm.mm.builder.skinHelper.launchWiring(args.widgetId);});dojo.connect(_1f66,"onmousedown",null,function(evt){dojo.stopEvent(evt);});var _1f67=document.createElement("input");_1f67.id=args.widgetId+"_menu";_1f67.alt=_1f67.title=com.ibm.mm.builder.coreWidgetsStrings.I_SKIN_EDIT_ICON_TITLE;dojo.addClass(_1f67,"widgetContext");dojo.attr(_1f67,"type","image");if(builderConfig.isBidi){dojo.attr(_1f67,"src",builderConfig.builderPath+"/images/context_menu_rtl.png");}else{dojo.attr(_1f67,"src",builderConfig.builderPath+"/images/context_menu.png");}dojo.connect(_1f67,"onclick",null,function(event){com.ibm.mm.builder.skinHelper.createMenu(event,args.widgetId+"_menu",args.widgetId,false,_1f5f);});dojo.connect(_1f67,"onmousedown",null,function(evt){dojo.stopEvent(evt);});_1f62.appendChild(_1f63);_1f62.appendChild(_1f64);_1f62.appendChild(_1f65);_1f62.appendChild(_1f66);_1f62.appendChild(_1f67);var _1f68=document.createElement("div");var _1f69=document.createElement("div");if(builderConfig.isBidi){dojo.addClass(_1f68,"widgetDragHandlerLeftRtl");dojo.addClass(_1f69,"widgetDragHandlerRightRtl");}else{dojo.addClass(_1f68,"widgetDragHandlerLeft");dojo.addClass(_1f69,"widgetDragHandlerRight");}_1f61.appendChild(_1f68);_1f61.appendChild(_1f69);_1f61.appendChild(_1f62);var _1f6a=document.createElement("div");dojo.addClass(_1f6a,"widgetDragHandlerBG");var _1f6b=document.createElement("div");dojo.addClass(_1f6b,"widgetDragHandlerCorner");var _1f6c=document.createElement("div");dojo.addClass(_1f6c,"editBarRightTopCornerShadow");var _1f6d=document.createElement("div");dojo.addClass(_1f6d,"editBarCornerShadow");_1f60.appendChild(_1f61);_1f60.appendChild(_1f6a);_1f60.appendChild(_1f6b);_1f60.appendChild(_1f6c);_1f60.appendChild(_1f6d);return _1f60;};com.ibm.mm.builder.utils.skinUtil.getValueFromStyle=function(key,_1f6e){if(_1f6e.indexOf(key)==-1){return null;}var pos=_1f6e.indexOf(key);var _1f6f=_1f6e.substr(pos,_1f6e.length);var _1f70=_1f6f.indexOf(":");var _1f71=_1f6f.indexOf(";");var value=_1f6f.substr(_1f70+1,_1f71-_1f70);return value;};com.ibm.mm.builder.utils.skinUtil.setValueToStyle=function(_1f72,key,value){if(_1f72.indexOf(key)==-1){return null;}var pos=_1f72.indexOf(key);var left=_1f72.substr(0,pos+key.length+1);var _1f73=_1f72.substr(pos+key.length+1,_1f72.length);var right=_1f73.substr(_1f73.indexOf(";"),_1f73.length);var _1f74=left+value+right;return _1f74;};com.ibm.mm.builder.utils.skinUtil.updateDefaultSize=function(_1f75){var _1f76=function(){var _1f77=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1f75);var _1f78=_1f77.getIDescriptorItems().getItemValue("defaultHeight");var _1f79=_1f77.getIDescriptorItems().getItemValue("defaultWidth");var _1f7a=null;if(_1f78||_1f79){_1f7a={};_1f7a.widgetId=_1f75;if(_1f78){_1f7a.height=_1f78;}if(_1f79){_1f7a.width=_1f79;}}if(_1f7a){var _1f7b=com.ibm.mashups.services.ServiceManager.getService("eventService");_1f7b.broadcastEvent("com.ibm.mashups.builder.resizeWidget",_1f7a);}};var wm=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1f75);if(wm&&wm.loaded){_1f76();}else{var _1f7c=com.ibm.mashups.services.ServiceManager.getService("eventService");_1f7c.subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_1f75,null,_1f76);}};com.ibm.mm.builder.utils.skinUtil._widgetOnMouseOut=function(_1f7d){dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1f7d).onmouseout=function(){com.ibm.mm.builder.skinHelper.hideEditBar(_1f7d+com.ibm.mm.builder.constant.editbarDragHandler);};com.ibm.mm.builder.skinHelper.hideEditBar(_1f7d+com.ibm.mm.builder.constant.editbarDragHandler);};com.ibm.mm.builder.utils.skinUtil.updateTitleAndIcon=function(_1f7e){var _1f7f=com.ibm.mm.builder.utils.iwidgetUtil;var _1f80=_1f7f.getWidgetInstanceTitle(_1f7e);var title=com.ibm.mm.builder.utils.htmlUtil.formatBlankSpace(_1f80);var icon=_1f7f.getWidgetInstanceIcon(_1f7e);try{dojo.attr(dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1f7e),"aria-label",_1f80);}catch(error){if(com.ibm.mashups.enabler.io.XHRMultipartFactory.isMultipartEnabled()){return;}throw error;}var _1f81=dojo.byId(_1f7e).getAttribute("visible");if(_1f81=="false"){var _1f82=dojo.byId(_1f7e+"_icon");if(_1f82){_1f82.src=icon;_1f82.alt="";}var _1f83=dojo.byId(_1f7e+"_name_middle");_1f83.innerHTML=_1f80;_1f83.title=_1f80;if(_1f82){_1f82.alt=_1f83.textContent;}dojo.attr(_1f83,"widthLimit","210");com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(_1f83,null,{fontSize:"1.2em",fontWeight:"bold"});}else{var _1f84=document.getElementById(_1f7e+"_title_content");var _1f85=document.getElementById(_1f7e+"_icon");if(_1f84){_1f84.innerHTML=title;}if(_1f85){_1f85.src=icon;_1f85.alt="";}var _1f86=dojo.byId(_1f7e+"_dragHandler");if(_1f86){var _1f87=dojo.query(".widgetTitle",_1f86)[0];var _1f88=com.ibm.mm.builder.utils.htmlUtil.getCurrentStyle(_1f86.parentNode.parentNode,"width");var width=parseInt(parseInt(_1f88.replace(/px/,""),10)*0.55-120,10);if(_1f87){dojo.attr(_1f87,"widthLimit",width);_1f87.innerHTML=_1f80;_1f87.title=_1f80;com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(_1f87);}var _1f89=dojo.query(".widgetTitleShadow",_1f86)[0];if(_1f89){dojo.attr(_1f89,"widthLimit",width);_1f89.innerHTML=_1f80;_1f89.title=_1f80;com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(_1f89);}var _1f8a=dojo.query(".widgetIconStyle",_1f86)[0];if(_1f8a){_1f8a.src=icon;_1f8a.alt="";}}}};com.ibm.mm.builder.utils.skinUtil.skinMinSize={"Default":76};com.ibm.mm.builder.utils.skinUtil.getMinSize=function(skin){if(typeof com.ibm.mm.builder.utils.skinUtil.skinMinSize[skin]!="undefined"){return com.ibm.mm.builder.utils.skinUtil.skinMinSize[skin];}else{return com.ibm.mm.builder.utils.skinUtil.skinMinSize.Default;}};com.ibm.mm.builder.utils.skinUtil.getLocationValue=function(key,_1f8b){var _1f8c=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1f8b);return dojo.style(_1f8c,key);};com.ibm.mm.builder.utils.skinUtil.setLocationValue=function(key,value,_1f8d){var _1f8e=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1f8d);dojo.style(_1f8e,{key:value});};com.ibm.mm.builder.utils.skinUtil.markIWidgetInstanceAsDraggable=function(_1f8f){var _1f90=dojo.byId(com.ibm.mm.builder.constant.skinIdPrefix+_1f8f);_1f90.setAttribute("dndtype","iWidgetInstance");_1f90.setAttribute("dnddata",_1f8f);dojo.addClass(_1f90,"dojoDndItem");};com.ibm.mm.builder.utils.skinUtil.skins=null;com.ibm.mm.builder.utils.skinUtil.getAllSkins=function(){if(com.ibm.mm.builder.utils.skinUtil.skins&&(0<com.ibm.mm.builder.utils.skinUtil.skins.length)){return com.ibm.mm.builder.utils.skinUtil.skins;}com.ibm.mm.builder.utils.skinUtil.skins=[];var _1f91=com.ibm.mm.builder.utils.skinUtil._getSkinModel();if(_1f91!==null){var _1f92=_1f91.iterator();while(_1f92.hasNext()){com.ibm.mm.builder.utils.skinUtil.skins.push(_1f92.next());}}return com.ibm.mm.builder.utils.skinUtil.skins;};}if(!dojo._hasResource["dojox.validate.regexp"]){dojo._hasResource["dojox.validate.regexp"]=true;dojo.provide("dojox.validate.regexp");dojo.mixin(dojox.validate.regexp,{ipAddress:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowDottedDecimal!="boolean"){flags.allowDottedDecimal=true;}if(typeof flags.allowDottedHex!="boolean"){flags.allowDottedHex=true;}if(typeof flags.allowDottedOctal!="boolean"){flags.allowDottedOctal=true;}if(typeof flags.allowDecimal!="boolean"){flags.allowDecimal=true;}if(typeof flags.allowHex!="boolean"){flags.allowHex=true;}if(typeof flags.allowIPv6!="boolean"){flags.allowIPv6=true;}if(typeof flags.allowHybrid!="boolean"){flags.allowHybrid=true;}var _1f93="((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";var _1f94="(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]";var _1f95="(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]";var _1f96="(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|"+"4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])";var hexRE="0[xX]0*[\\da-fA-F]{1,8}";var _1f97="([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}";var _1f98="([\\da-fA-F]{1,4}\\:){6}"+"((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";var a=[];if(flags.allowDottedDecimal){a.push(_1f93);}if(flags.allowDottedHex){a.push(_1f94);}if(flags.allowDottedOctal){a.push(_1f95);}if(flags.allowDecimal){a.push(_1f96);}if(flags.allowHex){a.push(hexRE);}if(flags.allowIPv6){a.push(_1f97);}if(flags.allowHybrid){a.push(_1f98);}var _1f99="";if(a.length>0){_1f99="("+a.join("|")+")";}return _1f99;},host:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowIP!="boolean"){flags.allowIP=true;}if(typeof flags.allowLocal!="boolean"){flags.allowLocal=false;}if(typeof flags.allowPort!="boolean"){flags.allowPort=true;}if(typeof flags.allowNamed!="boolean"){flags.allowNamed=false;}var _1f9a="(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)";var _1f9b="(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)";var _1f9c=flags.allowPort?"(\\:\\d+)?":"";var _1f9d="((?:"+_1f9a+"\\.)+"+_1f9b+"\\.?)";if(flags.allowIP){_1f9d+="|"+dojox.validate.regexp.ipAddress(flags);}if(flags.allowLocal){_1f9d+="|localhost";}if(flags.allowNamed){_1f9d+="|^[^-][a-zA-Z0-9_-]*";}return "("+_1f9d+")"+_1f9c;},url:function(flags){flags=(typeof flags=="object")?flags:{};if(!("scheme" in flags)){flags.scheme=[true,false];}var _1f9e=dojo.regexp.buildGroupRE(flags.scheme,function(q){if(q){return "(https?|ftps?)\\://";}return "";});var _1f9f="(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?";return _1f9e+dojox.validate.regexp.host(flags)+_1f9f;},emailAddress:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowCruft!="boolean"){flags.allowCruft=false;}flags.allowPort=false;var _1fa0="([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+";var _1fa1=_1fa0+"@"+dojox.validate.regexp.host(flags);if(flags.allowCruft){_1fa1="<?(mailto\\:)?"+_1fa1+">?";}return _1fa1;},emailAddressList:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.listSeparator!="string"){flags.listSeparator="\\s;,";}var _1fa2=dojox.validate.regexp.emailAddress(flags);var _1fa3="("+_1fa2+"\\s*["+flags.listSeparator+"]\\s*)*"+_1fa2+"\\s*["+flags.listSeparator+"]?\\s*";return _1fa3;},numberFormat:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.format=="undefined"){flags.format="###-###-####";}var _1fa4=function(_1fa5){return dojo.regexp.escapeString(_1fa5,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d");};return dojo.regexp.buildGroupRE(flags.format,_1fa4);}});dojox.validate.regexp.ca={postalCode:function(){return "([A-Z][0-9][A-Z] [0-9][A-Z][0-9])";},province:function(){return "(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)";}};dojox.validate.regexp.us={state:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowTerritories!="boolean"){flags.allowTerritories=true;}if(typeof flags.allowMilitary!="boolean"){flags.allowMilitary=true;}var _1fa6="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|"+"NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";var _1fa7="AS|FM|GU|MH|MP|PW|PR|VI";var _1fa8="AA|AE|AP";if(flags.allowTerritories){_1fa6+="|"+_1fa7;}if(flags.allowMilitary){_1fa6+="|"+_1fa8;}return "("+_1fa6+")";}};}if(!dojo._hasResource["dojox.validate._base"]){dojo._hasResource["dojox.validate._base"]=true;dojo.provide("dojox.validate._base");dojo.experimental("dojox.validate");dojox.validate.isText=function(value,flags){flags=(typeof flags=="object")?flags:{};if(/^\s*$/.test(value)){return false;}if(typeof flags.length=="number"&&flags.length!=value.length){return false;}if(typeof flags.minlength=="number"&&flags.minlength>value.length){return false;}if(typeof flags.maxlength=="number"&&flags.maxlength<value.length){return false;}return true;};dojox.validate._isInRangeCache={};dojox.validate.isInRange=function(value,flags){value=dojo.number.parse(value,flags);if(isNaN(value)){return false;}flags=(typeof flags=="object")?flags:{};var max=(typeof flags.max=="number")?flags.max:Infinity,min=(typeof flags.min=="number")?flags.min:-Infinity,dec=(typeof flags.decimal=="string")?flags.decimal:".",cache=dojox.validate._isInRangeCache,_1fa9=value+"max"+max+"min"+min+"dec"+dec;if(typeof cache[_1fa9]!="undefined"){return cache[_1fa9];}cache[_1fa9]=!(value<min||value>max);return cache[_1fa9];};dojox.validate.isNumberFormat=function(value,flags){var re=new RegExp("^"+dojox.validate.regexp.numberFormat(flags)+"$","i");return re.test(value);};dojox.validate.isValidLuhn=function(value){var sum=0,_1faa,_1fab;if(!dojo.isString(value)){value=String(value);}value=value.replace(/[- ]/g,"");_1faa=value.length%2;for(var i=0;i<value.length;i++){_1fab=parseInt(value.charAt(i));if(i%2==_1faa){_1fab*=2;}if(_1fab>9){_1fab-=9;}sum+=_1fab;}return !(sum%10);};}if(!dojo._hasResource["com.ibm.mm.builder.utils.embedUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.embedUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.embedUtil");com.ibm.mm.builder.utils.embedUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.embedUtil");com.ibm.mm.builder.utils.embedUtil.launchFeedPreview=function(_1fac,_1fad,_1fae){var _1faf=com.ibm.mm.builder.utils.embedUtil.createDummyWidgetMarkup(_1fac);var _1fb0=dojo.byId("Embedding_Widget_TmpDiv");var _1fb1=com.ibm.mm.builder.utils.embedUtil.createDummyMD(_1fac);com.ibm.mm.builder.utils.iwidgetUtil.loadWidgets(_1fb0,function(){var _1fb2=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_1faf).getIWidgetInstance();if(_1fb2===null){com.ibm.mm.builder.utils.embedUtil.LOGGER.severe("launchFeedPreview",dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_EMBEDDING_NOWIDGET_ERROR_1,[_1faf]));return;}var _1fb3=_1fb2.getAttributes();for(var _1fb4 in _1fad){if(_1fad[_1fb4]){_1fb3.setItemValue(_1fb4,_1fad[_1fb4],false);}}var _1fb5=com.ibm.mm.builder.utils.embedUtil.generateURL(_1fac,null,400,600,true,_1fb3);_1fae(_1fb5);});com.ibm.mm.builder.utils.iwidgetUtil.saveWidgetInstanceTitleAndIcon(_1faf,_1fb1.widgetname,_1fb1.widgetIconSrc);};com.ibm.mm.builder.utils.embedUtil.createDummyWidgetMarkup=function(_1fb6){var _1fb7=com.ibm.mm.builder.utils.iwidgetUtil._getUid();var _1fb8=com.ibm.mm.builder.utils.embedUtil.createDummyMD(_1fb6);var _1fb9=new com.ibm.mm.builder.WidgetCreator(_1fb7,_1fb8);var _1fba=_1fb9.getWidget();_1fba.removeAttribute("skin");var _1fbb=com.ibm.mm.builder.utils.htmlUtil.getElementString(_1fba);var _1fbc=dojo.byId("Embedding_Widget_TmpDiv");if(_1fbc){_1fbc.innerHTML="";}else{_1fbc=document.createElement("div");_1fbc.id="Embedding_Widget_TmpDiv";dojo.body().appendChild(_1fbc);_1fbc.style.display="none";}_1fbc.innerHTML=_1fbb;return _1fb7;};com.ibm.mm.builder.utils.embedUtil.createDummyMD=function(_1fbd){var _1fbe={};_1fbe.id="";_1fbe.widgetname="";_1fbe.widgetDefXML=_1fbd;_1fbe.widgetIconSrc="";_1fbe.widgetParam=null;_1fbe.onNewWire=null;_1fbe.systemWidget=false;return _1fbe;};com.ibm.mm.builder.utils.embedUtil.createEmbeddingWidgetMarkup=function(_1fbf){var _1fc0=com.ibm.mm.builder.utils.iwidgetUtil._getUid();var _1fc1=com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition(_1fbf);var _1fc2=new com.ibm.mm.builder.WidgetCreator(_1fc0,_1fc1);var _1fc3=_1fc2.getWidget();_1fc3.removeAttribute("skin");var _1fc4=dojo.byId("Embedding_Widget_TmpDiv");if(_1fc4){_1fc4.innerHTML="";}else{_1fc4=document.createElement("div");_1fc4.id="Embedding_Widget_TmpDiv";_1fc4.style.display="none";dojo.body().appendChild(_1fc4);}_1fc4.appendChild(_1fc3);return _1fc0;};com.ibm.mm.builder.utils.embedUtil.destroyEmbeddedWidget=function(_1fc5){var _1fc6=dojo.byId("Embedding_Widget_TmpDiv");if(_1fc6){_1fc6.innerHTML="";}var _1fc7=com.ibm.mashups.services.ServiceManager.getService("eventService");_1fc7.publishEvent(com.ibm.mashups.iwidget.Constants.UNLOAD_WIDGETS,_1fc5);};com.ibm.mm.builder.utils.embedUtil.createRadioButton=function(_1fc8,_1fc9,_1fca,_1fcb,title,id){var _1fcc="<input type='radio' name='";_1fcc+=_1fc8+"' value='";_1fcc+=_1fc9+"' title='";_1fcc+=title+"' id='";_1fcc+=id+"' aria-label='";_1fcc+=title+"'";if(_1fca){_1fcc+="onclick='"+_1fca+"' onkeypress='(function(e,self) { if (e.charCode == dojo.keys.SPACE || e.keyCode == dojo.keys.ENTER) {self.onclick(e);} })(event,this);'";}if(_1fcb){_1fcc+=" checked>";}else{_1fcc+=">";}return _1fcc;};com.ibm.mm.builder.utils.embedUtil.getHeight=function(_1fcd){var _1fce=dojo.byId(_1fcd+"_height").value+"px";return _1fce;};com.ibm.mm.builder.utils.embedUtil.getWidth=function(_1fcf){var width="auto";if(dojo.query("[name="+_1fcf+"_emdPgWidth]")[0].checked){width=dojo.byId(_1fcf+"_width").value+"px";}return width;};com.ibm.mm.builder.utils.embedUtil.createClearDiv=function(){var adiv=document.createElement("div");adiv.style.clear="both";return adiv;};com.ibm.mm.builder.utils.embedUtil.createCheckPreview=function(uid,_1fd0){var _1fd1=com.ibm.mm.builder.utils.htmlUtil.createElementWithClass("div","embedPreviewTxt","");_1fd1.id=uid+"_previewDiv";var _1fd2=com.ibm.mm.builder.utils.htmlUtil.createElementWithClass("span","embedPreviewTxtLeft","");var ckBox=com.ibm.mm.builder.utils.htmlUtil.createElementWithClass("input","","");ckBox.id=uid+"_checkBox";ckBox.setAttribute("type","checkbox");ckBox.title=com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_PREVIEW_BYDEFAULT;setTimeout(function(){ckBox.checked=_1fd0;},0);var _1fd3=document.createElement("label");_1fd3.innerHTML=com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_PREVIEW_BYDEFAULT;_1fd3.setAttribute("for",ckBox.id);dojo.attr(_1fd3,"widthLimit","320");com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(_1fd3);_1fd2.appendChild(ckBox);_1fd2.appendChild(_1fd3);var _1fd4=com.ibm.mm.builder.utils.htmlUtil.createElementWithClass("span","embedPreviewTxtRight","");var _1fd5=com.ibm.mm.builder.utils.htmlUtil.createElementWithClass("a","embedPgPreviewLink",com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_PREVIEW_CLOSE);_1fd5.id=uid+"_closeLink";_1fd5.href="javascript:void(0)";_1fd5.title=com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_PREVIEW_CLOSE;dojo.attr(_1fd5,"widthLimit","160");com.ibm.mm.builder.utils.htmlUtil.truncateNodeText(_1fd5);_1fd4.appendChild(_1fd5);_1fd1.appendChild(_1fd2);_1fd1.appendChild(_1fd4);return _1fd1;};com.ibm.mm.builder.utils.embedUtil.validateInput=function(_1fd6,_1fd7){if(dojo.query("[name="+_1fd6+"_emdPgWidth]")[0].checked){var _1fd8=dojo.byId(_1fd6+"_width");if(_1fd8){if(!dojox.validate.isInRange(_1fd8.value,{min:50,max:2000})){alert(com.ibm.mm.builder.coreWidgetsMessages.E_EMBEDDING_WIDTHHEIGHT_INPUTERROR1_0);return false;}if((parseInt(_1fd8.value,10)+"")!=_1fd8.value){alert(com.ibm.mm.builder.coreWidgetsMessages.E_EMBEDDING_WIDTHHEIGHT_INPUTERROR2_0);return false;}}}var _1fd9=dojo.byId(_1fd6+"_height");if(_1fd9){if(!dojox.validate.isInRange(_1fd9.value,{min:50,max:2000})){alert(com.ibm.mm.builder.coreWidgetsMessages.E_EMBEDDING_WIDTHHEIGHT_INPUTERROR1_0);return false;}if((parseInt(_1fd9.value,10)+"")!=_1fd9.value){alert(com.ibm.mm.builder.coreWidgetsMessages.E_EMBEDDING_WIDTHHEIGHT_INPUTERROR2_0);return false;}}return true;};com.ibm.mm.builder.utils.embedUtil.generateURL=function(_1fda,pid,width,_1fdb,_1fdc,_1fdd,_1fde){var _1fdf=new com.ibm.mashups.enabler.EmbeddingGenerator(_1fda,pid);_1fdf.setPreferences(_1fdd);_1fdf.setWidth(width);_1fdf.setHeight(_1fdb);_1fdf.setScrollbar(_1fdc);if(typeof _1fde!="undefined"){if(_1fde){_1fdf.setSandboxed(_1fde);}}if(typeof _1fdd!="undefined"){if(_1fdd){_1fdf.setPreferences(_1fdd);}}return _1fdf;};com.ibm.mm.builder.utils.embedUtil.displayEmbedDialog=function(id,type,_1fe0){var _1fe1;var _1fe2;var _1fe3={containerBackgroundColor:"white",nodeWidth:dojo.isIE?"550px":"545px",initLeftPosition:"100px",initTopPosition:"100px",displayCloseButton:true};if(type=="page"){_1fe1="embedPage";_1fe2="com.ibm.mashups.builder.embedPage";var _1fe4=com.ibm.mm.builder.utils.pageUtil.getPageTitle(id);var title=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_PAGE_TITLE,[_1fe4]);_1fe3.id=id+"_embeddingPage";_1fe3.title=title;}else{_1fe1="embedWidget";_1fe2="com.ibm.mashups.builder.embedWidget";_1fe3.id="mainEmbeddingDialog";_1fe3.title=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsStrings.I_EMBED_WIDGET_HEADERTEXT,[_1fe0]);}var _1fe5={widgetTypeId:_1fe1,eventName:_1fe2,eventPayload:id,requestRefresh:true,dialogParam:_1fe3};com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_1fe5);};}if(!dojo._hasResource["com.ibm.mm.builder.utils.themeUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.themeUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.themeUtil");com.ibm.mm.builder.utils.themeUtil.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.utils.themeUtil");com.ibm.mm.builder.utils.themeUtil.getThemeModel=function(_1fe6){if(_1fe6||!this.themeModel){this.themeModel=com.ibm.mashups.enabler.model.Factory.getThemeModel();this.themeModel.setStrategy(new com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy(25));}return this.themeModel;};com.ibm.mm.builder.utils.themeUtil.getThemeNode=function(_1fe7){var _1fe8=this.getThemeModel().find(_1fe7).start();if(_1fe8){return _1fe8;}try{var _1fe9=this.getDefaultThemeId();var _1fea=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();var _1feb=com.ibm.mm.builder.utils.pageUtil.getCurrentPageId();var page=_1fea.find(_1feb).start();page.setTheme(_1fe9);_1fea.commit().start();}catch(ex){com.ibm.mm.builder.utils.themeUtil.LOGGER.severe("getThemeNode","Fail to set default theme to current page!");}return this.getDefaultThemeNode();};com.ibm.mm.builder.utils.themeUtil.getDefaultThemeNode=function(){var _1fec=this.getThemeModel();return _1fec.find(this.getDefaultThemeId()).start();};com.ibm.mm.builder.utils.themeUtil.getDefaultThemeId=function(_1fed){if(_1fed){var _1fee=com.ibm.mm.builder.utils.navigationUtil.getNavigationRootNode(_1fed).getTheme();if(_1fee&&_1fee!="null"){return _1fee;}}var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);return cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CLIENT_DEFAULT_THEME_ID);};com.ibm.mm.builder.utils.themeUtil.getCurrentSpaceThemeId=function(){var _1fef=com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId();var _1ff0=com.ibm.mm.builder.utils.navigationUtil.getNavigationRootNode(_1fef).getTheme();if(_1ff0&&_1ff0!="null"){return _1ff0;}};com.ibm.mm.builder.utils.themeUtil.getThemeTitle=function(theme,_1ff1){if(!theme){return null;}return com.ibm.mm.builder.utils.enablerUtil.getNodeTitle(theme,_1ff1);};com.ibm.mm.builder.utils.themeUtil.loadTheme=function(_1ff2){var page=com.ibm.mm.builder.utils.pageUtil.getDefaultPage(_1ff2);if(!page){this.loadDefaultTheme();return;}var _1ff3=this.getCurrentThemeId();if(!_1ff3){this._load(this.getThemeId(_1ff2));}};com.ibm.mm.builder.utils.themeUtil.loadDefaultTheme=function(){var dt=this.getCurrentSpaceThemeId();var ct=this.getCurrentThemeId();if(!ct||ct!=dt){this._load(dt);}};com.ibm.mm.builder.utils.themeUtil.getCurrentThemeId=function(){var _1ff4=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentTheme().getID();return _1ff4==="null"?null:_1ff4;};com.ibm.mm.builder.utils.themeUtil.getThemeId=function(page){var pu=com.ibm.mm.builder.utils.pageUtil;var _1ff5=null;if(page){if(dojo.isString(page)){_1ff5=pu.getPageNode(page);}else{_1ff5=page;}}else{_1ff5=pu.getCurrentPageNode();}if(!_1ff5){return null;}var _1ff6=_1ff5.getTheme();if(!_1ff6||_1ff6==="null"){return this.getDefaultThemeId();}return _1ff6;};com.ibm.mm.builder.utils.themeUtil.getCurrentThemeNode=function(){return this.getThemeNode(this.getCurrentThemeId());};com.ibm.mm.builder.utils.themeUtil._load=function(_1ff7){if(!_1ff7||_1ff7==="null"){var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);_1ff7=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.CLIENT_DEFAULT_THEME_ID);}var tm=this.getThemeNode(_1ff7);if(!tm){alert(dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_MAIN_LOAD_THEME_MODEL_FAIL_0,[_1ff7||"null"]));}com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentTheme().setID(_1ff7);document.body.id=_1ff7;var _1ff8=this.getThemeModel().findResourceUrl(tm,"theme.html");var _1ff9=this.getThemeModel().findResourceUrl(tm,"theme.css");com.ibm.mm.builder.utils.htmlUtil.loadCss(_1ff9);if(builderConfig.isBidi){var _1ffa=this.getThemeModel().findResourceUrl(tm,"theme_rtl.css");com.ibm.mm.builder.utils.htmlUtil.loadCss(_1ffa);}var _1ffb={url:_1ff8,handle:function(data,_1ffc){if(data instanceof Error){return;}document.body.innerHTML=data;var i=1;dojo.forEach(document.body.getElementsByTagName("script"),function(_1ffd){try{var id=_1ffd.getAttribute("id");if(id===null||id===""){_1ffd.setAttribute("id","_scr#"+i);i++;}com.ibm.mm.enabler.aggregation.javascript.JAVASCRIPT_HANDLER.handle(_1ffd);}catch(e){console.log("Exception evaluate js:"+e.message);}});var _1ffe=com.ibm.mashups.enabler.io.XHRMultipartFactory.create();_1ffe.startTransaction();com.ibm.mm.builder.utils.iwidgetUtil.loadWidgets(null,function(){com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.switchPage");});_1ffe.endTransactionDeferred(true).start();var _1fff=com.ibm.mm.builder.utils.themeUtil.getCurrentThemeNode().getMetadata("com.ibm.mashups.theme.body.class");dojo.forEach(_1fff.split(" "),function(_2000){dojo.addClass(dojo.body(),_2000);});if(ibmConfig.fontSizeEnlarged){dojo.addClass(dojo.body(),com.ibm.mm.builder.constant.dbcsEnlarged);}},error:function(err,_2001){setTimeout(function(){com.ibm.mm.builder.utils.themeUtil.loadDefaultTheme();},0);}};dojo.xhrGet(_1ffb);};com.ibm.mm.builder.utils.themeUtil.unloadAllWidgets=function(_2002){var _2003=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentTheme();var _2004=_2003.getLayouts();var _2005=com.ibm.mm.builder.utils.wireUtil.getAllWidgetsInLayouts(_2004);dojo.forEach(_2005,function(_2006){com.ibm.mm.builder.commonActions.removeWidget(_2006);});if(_2002){com.ibm.mashups.services.ServiceManager.getService("eventService").publishEvent(com.ibm.mashups.iwidget.Constants.UNLOAD_WIDGETS,_2005);}};mmBuilder_layoutWidgetsPool=[];com.ibm.mm.builder.utils.themeUtil.unloadWidgetsInLayout=function(_2007){mmBuilder_layoutWidgetsPool.push(_2007);var _2008=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentTheme();var _2009=_2008.getLayouts();if(_2009){if(mmBuilder_layoutWidgetsPool.length==_2009.length){for(var i=0;i<_2009.length;i++){mmBuilder_layoutWidgetsPool.pop(_2009[i]);}}if(mmBuilder_layoutWidgetsPool.length===0){mmBuilder_layoutWidgetsPool=[];com.ibm.mm.builder.utils.themeUtil.unloadAllWidgets(true);}}};}if(!dojo._hasResource["com.ibm.mm.builder.utils.toolboxUtil"]){dojo._hasResource["com.ibm.mm.builder.utils.toolboxUtil"]=true;dojo.provide("com.ibm.mm.builder.utils.toolboxUtil");com.ibm.mm.builder.utils.toolboxUtil.getWidgetDefinition=function(_200a){this.entries=this.entries||{};var entry=this.entries[_200a];if(entry){return entry;}var _200b=this.getCatalogModel();var _200c=_200b.getRoot().start();var _200d=_200b.getChildren(_200c);while(_200d.hasNext()){var _200e=_200b.getCatalogEntryModel(_200d.next());var wdmd=_200e.find(_200a).start();if(wdmd){this.setWidgetDefinition(wdmd);return wdmd;}}};com.ibm.mm.builder.utils.toolboxUtil.setWidgetDefinition=function(model){this.entries=this.entries||{};this.entries[model.getID()]=model;};com.ibm.mm.builder.utils.toolboxUtil.getCatalogModel=function(_200f){if(_200f||!this._catModel){var _2010=com.ibm.mashups.enabler;var _2011=_2010.model.Factory.getCatalogCategoryModel();_2011.setStrategy(new _2010.strategy.ListLoadAheadStrategy(30));this._catModel=_2011;this.catalogEntrys=null;this.entries=null;}return this._catModel;};com.ibm.mm.builder.utils.toolboxUtil.getDescription=function(_2012,id){var _2013=this.getCatalogModel();var _2014=_2013.getCatalogEntryModel(_2012);var node=_2014.find(id).start();var desc=com.ibm.mm.builder.utils.enablerUtil.getNodeDescription(node);return com.ibm.mm.builder.utils.htmlUtil.escapeString(desc);};com.ibm.mm.builder.utils.toolboxUtil.getCategories=function(sync){if(this.catalogEntrys){return this.catalogEntrys;}this.catalogEntrys=[];var cm=this.getCatalogModel();var _2015=cm.getRoot().start(sync);var iter=cm.getChildren(_2015);while(iter.hasNext()){this.catalogEntrys.push(iter.next());}return this.catalogEntrys;};com.ibm.mm.builder.utils.toolboxUtil.clearTooltipsTimer=function(tips){for(var i=0,l=tips.length;i<l;i++){clearTimeout(tips.shift());}};com.ibm.mm.builder.utils.toolboxUtil.clearTooltips=function(){dojo.forEach(dojo.query(".dijitTooltip"),function(t){t.style.display="none";});};com.ibm.mm.builder.utils.toolboxUtil.preloadWidgetEntries=function(){var _2016=this.getCatalogModel();var _2017=this.getCategories(true);var _2018=com.ibm.mashups.enabler.io.XHRMultipartFactory.create();_2018.startTransaction();dojo.forEach(_2017,function(_2019){var _201a=_2016.getCatalogEntryModel(_2019);var _201b=_201a.iterator();_201b.start(false);});_2018.endTransactionDeferred().start();};}if(!dojo._hasResource["com.ibm.mm.builder.iwidget.SystemWidget"]){dojo._hasResource["com.ibm.mm.builder.iwidget.SystemWidget"]=true;dojo.provide("com.ibm.mm.builder.iwidget.SystemWidget");dojo.declare("com.ibm.mm.builder.iwidget.SystemWidget",null,{cws:com.ibm.mm.builder.coreWidgetsStrings,cwm:com.ibm.mm.builder.coreWidgetsMessages,eventService:com.ibm.mashups.services.ServiceManager.getService("eventService"),LOGGER:com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass),onPageModeChanged:function(_201c){var pl=_201c.payload;if(!pl||pl.length<2){return;}var _201d="on"+pl.charAt(0).toUpperCase()+pl.substring(1).toLowerCase();if(this[_201d]){this[_201d]();}},getViewRootNode:function(){return this._getModeRootNode("view");},_getModeRootNode:function(mode){var node=dojo.query(".iw-Content."+mode,this.iContext.getRootElement())[0];if(!node){node=dojo.query(".mm_Content."+mode,this.iContext.getRootElement())[0];}return node;}});dojo.declare("com.ibm.mm.builder.iwidget.SystemTemplatedWidget",com.ibm.mm.builder.iwidget.SystemWidget,{onView:function(){this._loadMode("View");},onEdit:function(){this._loadMode("Edit");},_loadMode:function(mode){if(this[mode+"IsLoaded"]){return;}var _201e={};for(var _201f in this){if(typeof this[_201f]=="function"&&!(_201f in this.constructor.superclass)){_201e[_201f]=dojo.hitch(this,this[_201f]);}}var _2020=this["get"+mode+"RootNode"]();var _2021=dojo.isIE?com.ibm.mm.builder.utils.htmlUtil.addMissingQuoteInTitle(_2020.innerHTML):_2020.innerHTML;var _2022=new com.ibm.mm.builder.iwidget.TemplatedWidget(dojo.mixin({templateString:_2021},_201e));var _2023={};for(var nn in _2022){if(Object.prototype.hasOwnProperty.call(_2022,nn)){var rr=_2022[nn];if((rr&&rr.nodeType==1&&nn!=="domNode")||rr instanceof dijit._Widget){_2023[nn]=rr;}}}dojo.mixin(this,_2023);_2020.innerHTML="";_2020.appendChild(_2022.domNode);this[mode+"IsLoaded"]=true;}});dojo.declare("com.ibm.mm.builder.iwidget.TemplatedWidget",[dijit._Widget,dijit._Templated],{widgetsInTemplate:true,postMixInProperties:function(){var t=this.templateString;if(t){this.templateString=dojo.string.substitute(t,com.ibm.mm.builder.coreWidgetsStrings,function(v,k){return v||"$ {"+k+"}";});}}});}if(!dojo._hasResource["com.ibm.mm.builder.widget.ViewMorePage"]){dojo._hasResource["com.ibm.mm.builder.widget.ViewMorePage"]=true;dojo.provide("com.ibm.mm.builder.widget.ViewMorePage");dojo.declare("com.ibm.mm.builder.widget.ViewMorePage",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:"<div><div dojoAttachPoint=\"containerNode\"></div></div>",postCreate:function(){this.pageList=[];dojo.forEach(this.items,function(item){this.addChild(new com.ibm.mm.builder.widget.ViewMorePageItem({title:item.title,pid:item.pid,pre:item.pre,end:item.end}));},this);},reGenerate:function(items){this.pageList=[];this.items=items;this.destroyDescendants();dojo.forEach(this.items,function(item){this.addChild(new com.ibm.mm.builder.widget.ViewMorePageItem({title:item.title,pid:item.pid,pre:item.pre,end:item.end}));},this);}});dojo.declare("com.ibm.mm.builder.widget.ViewMorePageItem",[dijit._Widget,dijit._Templated,dijit._Container,dijit._Contained],{templateString_rtl:"<div style=\"height:25px\" waiRole=\"presentation\">"+"<div dojoAttachPoint=\"treeItemDividerTop\" class=\"treeItemDividerTop\"></div>"+"<div dojoAttachPoint=\"contentNode\" class=\"pageItemContent\" dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover\" waiRole=\"presentation\">"+"<span style=\"float:right\" dojoAttachPoint=\"iconNode\" waiRole=\"presentation\">"+"</span>"+"<span style=\"float:right\" dojoAttachPoint=\"labelDescNodePre\" class=\"treeItemDesc treeItemDescPreLoc\"></span>"+"<span style=\"float:right\" dojoAttachPoint=\"labelNode\" class=\"treeItemText\" role=\"listitem\" tabindex=\"0\"></span>"+"<span style=\"float:right\" dojoAttachPoint=\"labelDescNode\" class=\"treeItemDesc treeItemDescLoc\"></span>"+"<span style=\"padding:0px 20px;float:left\">"+"<input dojoAttachPoint=\"btnAddNode\" class=\"sharingPageTreeButton\" type=\"button\" value=\"\" dojoAttachEvent=\"onclick:_onAddClick\"/>"+"<input style=\"display:none\" class=\"sharingPageTreeButton\" dojoAttachPoint=\"btnRemoveNode\" type=\"button\" value=\"\" dojoAttachEvent=\"onclick:_onRemoveClick\"/>"+"</span>"+"</div>"+"<div dojoAttachPoint=\"treeItemDividerBottom\" class=\"treeItemDividerBottom\"></div>"+"</div>",templateString:"<div style=\"height:25px\" waiRole=\"presentation\">"+"<div dojoAttachPoint=\"treeItemDividerTop\" class=\"treeItemDividerTop\"></div>"+"<div dojoAttachPoint=\"contentNode\" class=\"pageItemContent\" dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover\" waiRole=\"presentation\">"+"<span style=\"float:left\" dojoAttachPoint=\"iconNode\" waiRole=\"presentation\">"+"</span>"+"<span style=\"float:left\" dojoAttachPoint=\"labelDescNodePre\" class=\"treeItemDesc treeItemDescPreLoc\"></span>"+"<span style=\"float:left\" dojoAttachPoint=\"labelNode\" class=\"treeItemText\" role=\"listitem\" tabindex=\"0\"></span>"+"<span style=\"float:left\" dojoAttachPoint=\"labelDescNode\" class=\"treeItemDesc treeItemDescLoc\"></span>"+"<span style=\"padding:0px 20px;float:right\">"+"<input dojoAttachPoint=\"btnAddNode\" class=\"sharingPageTreeButton\" type=\"button\" value=\"\" dojoAttachEvent=\"onclick:_onAddClick\"/>"+"<input style=\"display:none\" class=\"sharingPageTreeButton\" dojoAttachPoint=\"btnRemoveNode\" type=\"button\" value=\"\" dojoAttachEvent=\"onclick:_onRemoveClick\"/>"+"</span>"+"</div>"+"<div dojoAttachPoint=\"treeItemDividerBottom\" class=\"treeItemDividerBottom\"></div>"+"</div>",postMixInProperties:function(){if(builderConfig.isBidi){this.templateString=this.templateString_rtl;}},postCreate:function(){this.labelDescNodePre.innerHTML=this.pre;this.labelDescNode.innerHTML=this.end;this.labelNode.innerHTML=this.title;this.domNode.title=com.ibm.mm.builder.utils.htmlUtil.unEscapeString(this.title);this.btnAddNode.value=com.ibm.mm.builder.coreWidgetsStrings.I_COMMON_ADD;this.btnRemoveNode.value=com.ibm.mm.builder.coreWidgetsStrings.I_COMMON_REMOVE;this._changeToAdd();},_onHover:function(){dojo.addClass(this.domNode,"highLightTreeItem");dojo.addClass(this.labelNode,"highLightTreeText");this.treeItemDividerTop.style.backgroundImage="url('"+builderConfig.builderPath+"/images/divider_morepages_hover_top.png')";},_onUnhover:function(){dojo.removeClass(this.domNode,"highLightTreeItem");dojo.removeClass(this.labelNode,"highLightTreeText");this.treeItemDividerTop.style.backgroundImage="";},_changeToAdd:function(){this.labelNode.style.color="#000000";this.labelNode.style.fontSize="12px";this.labelNode.fontFamily="Arial";this.btnAddNode.style.display="";this.btnRemoveNode.style.display="none";},_changeToRemove:function(){this.labelNode.style.color="#BDBDD3";this.btnAddNode.style.display="none";this.btnRemoveNode.style.display="";},_onRemoveClick:function(){this._changeToAdd();this.removeItem(this.getParent().pageList,this.pid);},removeItem:function(array,value){for(var i=0,n=0;i<array.length;i++){if(array[i]!=value){array[n++]=array[i];}}array.length-=1;},_onAddClick:function(){this._changeToRemove();this.getParent().pageList.push(this.pid);}});}if(!dojo._hasResource["com.ibm.mm.builder.dialog.ACLReassignDialog"]){dojo._hasResource["com.ibm.mm.builder.dialog.ACLReassignDialog"]=true;dojo.provide("com.ibm.mm.builder.dialog.ACLReassignDialog");dojo.declare("com.ibm.mm.builder.dialog.ACLReassignDialog",null,{aclReassignDialog:null,aclReassignRootDiv:null,constructor:function(_2024,_2025,list){this.layout=_2024;this.viewIsSource=false;this.editIsSource=false;this.target=_2025;this.aclReassignList=list;},initACLReassignContent:function(){this.maxLen=dojo.isIE?50:95;if(ibmConfig.fontSizeEnlarged&&dojo.isSafari){this.maxLen=dojo.isSafari<4?65:60;}this.aclReassignRootDiv=document.createElement("div");var _2026=document.createElement("div");dojo.addClass(_2026,"accessControlReassignDiv");var _2027=document.createElement("span");dojo.addClass(_2027,"accessControlReassignTitle");_2027.innerHTML=com.ibm.mm.builder.coreWidgetsStrings.I_ACL_INFORMATION_1+"<br/><br/>";_2026.appendChild(_2027);var _2028=document.createElement("span");dojo.addClass(_2028,"accessControlReassignList");_2028.innerHTML=this._listToHtml(this.aclReassignList);_2026.appendChild(_2028);var _2029=document.createElement("span");dojo.addClass(_2029,"accessControlReassignConfirm");_2029.innerHTML="<br/>"+com.ibm.mm.builder.coreWidgetsStrings.I_ACL_INFORMATION_2+"<br/><br/>";_2026.appendChild(_2029);var _202a=document.createElement("div");dojo.addClass(_202a,"accessControlReassignBottomDiv");var _202b=com.ibm.mm.builder.utils.htmlUtil;var _202c=document.createElement("input");_202c.setAttribute("type","button");_202c.setAttribute("value",_202b.getStrWithLimit(com.ibm.mm.builder.coreWidgetsStrings.I_ACL_REASSIGN_BTN,_202c,this.maxLen));_202c.setAttribute("title",com.ibm.mm.builder.coreWidgetsStrings.I_ACL_REASSIGN_BTN);dojo.attr(_202c,"role","button");dojo.attr(_202c,"wai-role","button");dojo.attr(_202c,"aria-label",com.ibm.mm.builder.coreWidgetsStrings.I_ACL_REASSIGN_BTN);dojo.addClass(_202c,"lotusFormButton");dojo.addClass(_202c,"lotusFormButtonReassign");this._defaultFocus=_202c;var _202d=document.createElement("input");_202d.setAttribute("type","button");_202d.setAttribute("value",_202b.getStrWithLimit(com.ibm.mm.builder.coreWidgetsStrings.I_ACL_REASSIGN_NOT_CHANGE,_202d,this.maxLen));_202d.setAttribute("title",com.ibm.mm.builder.coreWidgetsStrings.I_ACL_REASSIGN_NOT_CHANGE);dojo.attr(_202d,"role","button");dojo.attr(_202d,"wai-role","button");dojo.attr(_202d,"aria-label",com.ibm.mm.builder.coreWidgetsStrings.I_ACL_REASSIGN_NOT_CHANGE);dojo.addClass(_202d,"lotusFormButton");dojo.addClass(_202d,"lotusFormButtonReassignNoChange");_202a.appendChild(_202c);_202a.appendChild(_202d);_2026.appendChild(_202a);this.aclReassignRootDiv.appendChild(_2026);dojo.connect(_202c,"onclick",this,"reassign");dojo.connect(_202d,"onclick",this,"noChange");},_getSource:function(perm){switch(perm){case "aclView":this.viewIsSource=true;return com.ibm.mm.builder.dnd.viewSource;case "aclPersonal":this.personalizeIsSource=true;return com.ibm.mm.builder.dnd.personalizeSource;case "aclEdit":this.editIsSource=true;return com.ibm.mm.builder.dnd.editSource;}},reassign:function(){for(var i=0;i<this.aclReassignList.length;i++){var _202e=this._getSource(this.aclReassignList[i].perm);this.layout.transferNode(_202e,this.target,this.aclReassignList[i].id,null,false);}if(this.viewIsSource){dojo.publish("aclView");this.viewIsSource=false;}if(this.personalizeIsSource){dojo.publish("aclPersonalize");this.personalizeIsSource=false;}if(this.editIsSource){dojo.publish("aclEdit");this.editIsSource=false;}dojo.publish(com.ibm.mm.builder.eventTopics.UpdateAllPageControl);this.hide();},noChange:function(){this.hide();},show:function(){this.initACLReassignContent();var acrId=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().getID()+"_accessControlReassign";var _202f=dijit.byId(acrId);if(_202f){_202f.destroy();}var _2030=(dojo.isIE)?"370px":"350px";this.aclReassignDialog=new com.ibm.mm.builder.widget.CustomDialog({id:acrId,title:com.ibm.mm.builder.coreWidgetsStrings.I_ACL_CONFLICT_TITLE,nodeWidth:_2030,containerBackgroundColor:"white",hasRightBottomResizer:false},this.aclReassignRootDiv);dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[this.aclReassignDialog.domNode]);this.aclReassignDialog.show();this._defaultFocus.focus();},hide:function(){this.aclReassignDialog.hide();},_listToHtml:function(list){var _2031="";for(var i=0;i<list.length;i++){var perm;switch(list[i].perm){case "aclView":perm=com.ibm.mm.builder.coreWidgetsStrings.I_ACL_PERMISSION_VIEW;break;case "aclPersonalize":perm="Personalize";break;case "aclEdit":perm=com.ibm.mm.builder.coreWidgetsStrings.I_ACL_PERMISSION_EDIT;break;default:perm="";}var _2032=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsStrings.I_ACL_INFORMATION_HAS,[list[i].name,"<span class='accessControlReassignLevel'>"+perm+"</span>"," <span class='accessControlReassignHas' > "," </span>"]);_2031=_2031+"<span>"+_2032+"</span><br/>";}return _2031;}});}(function(){var reg=new ExtensionRegistry();reg.disconnect("dojo.declare");})();var Base32={ALPHABET:"0123456789ABCDEFGHIJKLMNOPQRSTUV",ENCODING_BASE:5,DIGIT_MASK:31,encode:function(str){var _2033=(str.length*8+this.ENCODING_BASE-1)/this.ENCODING_BASE;var index=0,digit=0,_2034=0;var _2035="";for(var i=0;i<_2033;i++){if(_2034<this.ENCODING_BASE&&index<str.length){var next=str.charCodeAt(index++);if(next<0){next+=256;}digit=digit|(next<<_2034);_2034+=8;}_2035+=this.ALPHABET.charAt(digit&this.DIGIT_MASK);digit=(digit>>>this.ENCODING_BASE);_2034-=this.ENCODING_BASE;}return _2035;},toByte:function(value){return value&255;},toCharacter:function(value){return String.fromCharCode(this.toByte(value));},decode:function(str){var digit=0,_2036=0,max=str.length;var _2037="";for(var i=0;i<max;i++){var next=this.ALPHABET.indexOf(str.charAt(i));digit=digit|(next<<_2036);_2036+=this.ENCODING_BASE;if(_2036>=8){_2037+=this.toCharacter(digit);digit=digit>>>8;_2036-=8;}}if(digit!=0){_2037+=this.toCharacter(digit);}return _2037;}};dojo.provide("com.ibm.mm.extension.url");dojo.declare("com.ibm.mm.extension.url.ModelUrlFactoryImpl",[com.ibm.mm.enabler.model.url.ModelUrlFactoryImpl],{WEBDAV_URL:"webdav",constructor:function(){var _2038=com.ibm.mashups.enabler.model.url.ModelUrlFactory;this.schemeMap={};this.schemeMap[_2038.NAVIGATION_URL]="nm";this.schemeMap[_2038.SHARED_NAVIGATION_URL]="snm";this.schemeMap[_2038.FRAGMENT_URL]="cm";this.schemeMap[_2038.FRAGMENT_MEDIA_URL]="spa";this.schemeMap[_2038.COMMUNITY_URL]="ai";this.schemeMap[_2038.USER_URL]="um";this.schemeMap[_2038.THEME_URL]="tl";this.schemeMap[_2038.THEME_MEDIA_URL]="theme-media";this.schemeMap[_2038.CATALOG_URL]="catalog";this.schemeMap[_2038.CONFIG_URL]="config";this.schemeMap[_2038.SPACE_URL]="space";this.schemeMap[_2038.SPACE_FAVORITE_URL]="space-favorite";this.schemeMap[_2038.AC_URL]="ac";this.schemeMap[_2038.AI_URL]="ai";this.schemeMap[_2038.TEMPLATE_URL]="template";this.schemeMap[_2038.WEBDAV_URL]="dav:mmdav";this.schemeMap[_2038.WIDGET_URL]="pm";this.schemeMap[_2038.LAYOUT_URL]="lm";this.schemeMap[_2038.EVENT_URL]="ce";this.schemeMap["service"]="service";},createModelURL:function(_2039,_203a){var _203b=_203a[0];var model=_203a[1];var _203c=this.schemeMap[_203b];if(!_203c){return null;}var _203d;if(_203b==com.ibm.mashups.enabler.model.url.ModelUrlFactory.THEME_MEDIA_URL){_203d=new com.ibm.mm.extension.url.ThemeResourceUrlImpl(_203c,model);}else{if(_203b==com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_MEDIA_URL){_203d=new com.ibm.mm.extension.url.SchemeBasedModelMediaUrlImpl(_203c,model);}else{_203d=new com.ibm.mm.extension.url.SchemeBasedModelUrlImpl(_203c,model);}}return _203d;},getModelURL:function(_203e,_203f){var url=_203f[0];var model=_203f[1];return new com.ibm.mm.extension.url.StringBasedModelUrlImpl(url,model);}});dojo.declare("com.ibm.mm.extension.url.BaseModelUrl",[com.ibm.mashups.enabler.model.url.ModelUrl],{modelSchema:null,schemeSpecific:null,isMediaUrl:false,httpUrl:null,VALUE:"value",IS_ID:"isID",SUBMODEL:"submodel",constructor:function(){this.nodes=[];this.prefix=null;var _2040=com.ibm.mashups.enabler.model.url.ModelUrlFactory;this.subModelSchemeMap={};this.subModelSchemeMap[_2040.SUBMODEL_RESOURCE]="resourceconfig";this.subModelSchemeMap[_2040.SUBMODEL_ROLE]="role";this.subModelSchemeMap[_2040.SUBMODEL_MEMBER]="member";this.subModelSchemeMap[_2040.SUBMODEL_ACCESS]="access";this.locale=document.documentElement.lang;},_loadPrefix:function(){if(this.prefix==null){this.prefix="oid";}},setPrimaryNode:function(value,isID,_2041){var _2042={};this.setPrimaryNodePortal(value,isID,_2042);_2042.subModel=_2041;this.nodes[0]=_2042;},setSecondaryNode:function(value,isID,_2043){var _2044={};_2044.value=value;_2044.isID=(isID!=null)?isID:true;if(this.modelSchema=="tl"){this.modelSchema="sl";}else{if((this.modelSchema=="spa")&&(value=="index.html")){_2044.value="html/index.html";}}_2044.subModel=_2043;this.nodes[1]=_2044;},setNodes:function(nodes){for(var i=0;i<nodes.length;i++){nodes[i].isID=(nodes[i].isID!=null)?nodes[i].isID:true;}this.nodes=nodes;var _2045=false;if(this.modelSchema=="ai"&&nodes.length>0){if((nodes.length==2)&&(nodes[0].value=="collection")&&(nodes[0].isID==false)&&(nodes[0].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_ROLE)){this.nodes=[];this.setPrimaryNode("applications/"+nodes[1].value+"/roles",false);_2045=true;}else{if((nodes.length==3)&&(nodes[0].value=="collection")&&(nodes[0].isID==false)&&(nodes[0].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_MEMBER)&&(nodes[1].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_ROLE)){this.nodes=[];this.setPrimaryNode("roles/"+nodes[1].value+"/members",false);_2045=true;}else{if((nodes.length==3)&&(nodes[0].value!="collection")&&(nodes[0].isID==false)&&(nodes[0].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_MEMBER)&&(nodes[1].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_ROLE)){this.nodes=[];this.setPrimaryNode("roles/"+nodes[1].value+"/members/"+nodes[0].value,false);_2045=true;}}}}else{if(this.modelSchema=="ac"&&nodes.length>0){if((nodes.length==2)&&(nodes[0].value=="collection")&&(nodes[0].isID==false)&&(nodes[0].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_ROLE)){this.nodes=[];this.setPrimaryNode("role:oid:"+nodes[1].value,false);_2045=true;}else{if((nodes.length==3)&&(nodes[0].value=="collection")&&(nodes[0].isID==false)&&(nodes[0].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_MEMBER)&&(nodes[1].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_ROLE)){this.nodes=[];this.setPrimaryNode("member:"+nodes[1].value+"@oid:"+nodes[2].value,false);_2045=true;}else{if((nodes.length==3)&&(nodes[0].value!="collection")&&(nodes[0].isID==false)&&(nodes[0].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_MEMBER)&&(nodes[1].subModel==com.ibm.mm.enabler.model.UrlFactory.SUBMODEL_ROLE)){this.nodes=[];this.setPrimaryNode("member:oid:"+nodes[0].value+"@role:"+nodes[1].value+"@oid:"+nodes[2].value,false);_2045=true;}}}}}if(!_2045){if(nodes.length==1){this.setPrimaryNode(nodes[0].value,nodes[0].isID,nodes[0].subModel);}else{if(nodes.length==2){this.setPrimaryNode(nodes[0].value,nodes[0].isID,nodes[0].subModel);this.setSecondaryNode(nodes[1].value,nodes[1].isID,nodes[1].subModel);}}}this._updateURI();},setSchemeSpecificPart:function(value){this.nodes=[];if(this.modelSchema=="um"){value="secure/"+value.replace(":","/");}this.schemeSpecific=value;this._updateURI();},getSchemeSpecificPart:function(){if(this.schemeSpecific!=null){return this.schemeSpecific;}var _2046="";if(this.isMediaUrl){_2046="/";}if(!this.nodes){return _2046;}if(this.isMediaUrl){for(var i=0;i<this.nodes.length;i++){var node=this.nodes[i];if(node.isID&&!this.prefix){this._loadPrefix();}if(i>0){if(i<this.nodes.length-1){_2046+="@";}else{_2046+="/";}}_2046+=node.value;}}else{for(var i=0;i<this.nodes.length;i++){var node=this.nodes[i];if(node.isID&&!this.prefix){this._loadPrefix();}if(_2046!=""){_2046+="@";}if(node.subModel){_2046+=this.subModelSchemeMap[node.subModel]+":";}if(node.isID){_2046+=this.prefix+":";}_2046+=node.value;}}return _2046;},_updateURI:function(){var uri=this.modelSchema+":"+this.getSchemeSpecificPart();this.httpUrl.setParameter("uri",uri);},addParameter:function(name,value){if(name=="start"){this.httpUrl.addParameter("start-index",value);}else{if(name=="num"){this.httpUrl.addParameter("max-results",value);}else{this.httpUrl.addParameter(name,value);}}},setParameter:function(name,value){if(name=="start"){this.httpUrl.setParameter("start-index",value);}else{if(name=="num"){this.httpUrl.setParameter("max-results",value);}else{this.httpUrl.setParameter(name,value);}}},getParameter:function(name){return this.httpUrl.getParameter(name);},getParameters:function(){return this.httpUrl.getParameters();},getAbsoluteURL:function(){if(this.locale&&!this.getParameter("locale")){this.addParameter("locale",this.locale);}return this.httpUrl.toString();},getProxifiedAbsoluteURL:function(){if(this.locale&&!this.getParameter("locale")){this.addParameter("locale",this.locale);}return this.httpUrl.toProxifiedString();},getModelURI:function(){return this.httpUrl.getParameter("uri");},toProxifiedString:function(){if(this.locale&&!this.getParameter("locale")){this.addParameter("locale",this.locale);}return this.httpUrl.toProxifiedString();},setPrimaryNodePortal:function(value,isID,_2047){if(this.modelSchema=="nm"){if(value=="collection"){_2047.value="ibm.portal.Home";_2047.isID=true;}else{_2047.value=value;_2047.isID=true;}}else{if(this.modelSchema=="snm"){if(value=="collection"){_2047.value="ibm.portal.sharedPages";_2047.isID=true;}else{_2047.value=value;_2047.isID=true;}this.modelSchema="nm";}else{if(this.modelSchema=="tl"&&value=="collection"){_2047.value="all:mashup";_2047.isID=false;}else{if(this.modelSchema=="tl"&&isID==true){_2047.value=value;_2047.isID=true;this.setParameter("filter","mashup");}else{if(this.modelSchema=="cm"&&value=="collection"){_2047.value="ibm.portal.MashupContentRoot";_2047.isID=true;}else{if(this.modelSchema=="catalog"&&value=="collection"){_2047.value="all";_2047.isID=false;}else{if(this.modelSchema=="ai"){if(value=="collection"){_2047.value="communities/collection";_2047.isID=false;}else{_2047.value=value;_2047.isID=false;}}else{if(this.modelSchema=="spa"){_2047.value=value;_2047.isID=(isID!=null)?isID:true;}else{if(this.modelSchema=="space"){this.modelSchema="ai";if(value=="collection"){_2047.value="/applications";_2047.isID=false;}else{_2047.value="/applications/"+value;_2047.isID=false;}}else{if(this.modelSchema=="space-favorite"){this.modelSchema="ai";if(value=="collection"){_2047.value="/application-favorites/";_2047.isID=false;}else{_2047.value="/application-favorites/"+value;_2047.isID=false;}}else{if(this.modelSchema=="template"){this.modelSchema="ai";if(value=="collection"){_2047.value="/templates";_2047.isID=false;}else{_2047.value="/templates/"+value;_2047.isID=false;}}else{_2047.value=value;_2047.isID=(isID!=null)?isID:true;}}}}}}}}}}}}});dojo.declare("com.ibm.mm.extension.url.SchemeBasedModelUrlImpl",[com.ibm.mm.extension.url.BaseModelUrl],{constructor:function(_2048,model){this.modelSchema=_2048;this.model=model;var url="";var _2049=portalMashupsConfig.contentHandlerContextPath;if(_2049.indexOf("?")!=-1){_2049=_2049.substring(0,_2049.indexOf("?"));}url+=_2049;this.httpUrl=new com.ibm.mm.enabler.utilities.HttpUrl(url);this.httpUrl.setParameter("uri",this.modelSchema);var _204a="com.ibm.mm.enabler.model.NavigationModelImpl";var _204b="com.ibm.mm.enabler.model.SharedNavigationModelImpl";var _204c="com.ibm.mm.enabler.model.LayoutModelImpl";var _204d="com.ibm.mm.enabler.widget.WidgetModelImpl";if(model&&model.declaredClass==_204a){var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);navHiddenName=cs.getValue(com.ibm.mashups.enabler.services.ConfigConstants.NAVIGATION_HIDDEN);this.httpUrl.addParameter("mdname",navHiddenName);this.httpUrl.addParameter("mdname","com.ibm.portal.rendertype");}else{if(model&&model.declaredClass==_204b){this.httpUrl.setParameter("aspect","backlinks");}else{if(model&&model.declaredClass==_204c){this.httpUrl.addParameter("mdname","com.ibm.portal.layoutnode.localname");}else{if(model&&model.declaredClass==_204d){this.httpUrl.addParameter("filter","application");}}}}}});dojo.declare("com.ibm.mm.extension.url.SchemeBasedModelMediaUrlImpl",[com.ibm.mm.extension.url.SchemeBasedModelUrlImpl],{constructor:function(_204e,model){this.isMediaUrl=true;}});dojo.declare("com.ibm.mm.extension.url.ThemeResourceUrlImpl",[com.ibm.mm.extension.url.BaseModelUrl],{constructor:function(_204f,model){this.modelSchema=_204f;this.model=model;this.httpUrl=new com.ibm.mm.enabler.utilities.HttpUrl("/");this.httpUrl.setParameter("uri",this.modelSchema);},_updateURI:function(){if(this.nodes.length==2){var _2050=this.nodes[0].value;var _2051=this.nodes[1].value;var _2052=this.model.find(_2050).start();var url=_2052._getBaseUrl();this.httpUrl=new com.ibm.mm.enabler.utilities.HttpUrl(url+_2051);}else{if(this.nodes.length==3){var _2053=this.nodes[0].value;var _2050=this.nodes[1].value;var _2051=this.nodes[2].value;var _2054=this.model.find(_2053).start();var url=_2054._getBaseUrl();this.httpUrl=new com.ibm.mm.enabler.utilities.HttpUrl(url+_2051);}else{this.httpUrl=new com.ibm.mm.enabler.utilities.HttpUrl("/");}}}});dojo.declare("com.ibm.mm.extension.url.StringBasedModelUrlImpl",[com.ibm.mm.extension.url.BaseModelUrl],{constructor:function(url,model){if(url.indexOf("?")==0){contenthandlerpath=portalMashupsConfig.contentHandlerContextPath;if(contenthandlerpath.indexOf("?")!=-1){contenthandlerpath=contenthandlerpath.substring(0,contenthandlerpath.indexOf("?"));url=contenthandlerpath+url;}else{url=contenthandlerpath+url;}}if(!com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT){com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTEXT_ROOT);com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.PRIVATE_HANDLER=com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT+com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PRIVATE);com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.PUBLIC_HANDLER=com.ibm.mm.enabler.model.url.StringBasedModelUrlImpl.CONTEXT_ROOT+com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME).getValue(com.ibm.mashups.enabler.services.ConfigConstants.CONTENTHANDLER_PUBLIC);}this.httpUrl=new com.ibm.mm.enabler.utilities.HttpUrl(url);var _2055="com.ibm.mm.enabler.model.NavigationModelImpl";var _2056="com.ibm.mm.enabler.model.SharedNavigationModelImpl";var _2057="com.ibm.mm.enabler.model.LayoutModelImpl";var _2058="com.ibm.mm.enabler.widget.WidgetModelImpl";if(model&&model.declaredClass==_2055){var cs=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);navHiddenName=cs.getValue("com.ibm.mashups.navigation.hidden");this.httpUrl.setParameter("mdname",navHiddenName);}else{if(model&&model.declaredClass==_2056){this.httpUrl.addParameter("aspect","backlinks");}else{if(model&&model.declaredClass==_2057){this.httpUrl.addParameter("mdname","com.ibm.portal.layoutnode.localname");}else{if(model&&model.declaredClass==_2058){this.httpUrl.addParameter("filter","application");}}}}}});com.ibm.mm.extension.url.UrlFactory=new com.ibm.mm.extension.url.ModelUrlFactoryImpl();ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelUrl":{type:"around",handler:function(_2059,_205a){return com.ibm.mm.extension.url.UrlFactory.createModelURL(_2059,_205a);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL":{type:"around",handler:function(_205b,_205c){return com.ibm.mm.extension.url.UrlFactory.createModelURL(_205b,_205c);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelUrl":{type:"around",handler:function(url,url2){return com.ibm.mm.extension.url.UrlFactory.getModelURL(url,url2);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.url.ModelUrlFactory.getModelURL":{type:"around",handler:function(url,url2){return com.ibm.mm.extension.url.UrlFactory.getModelURL(url,url2);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.NavigationModel.findDefaultAcceptParent":{type:"around",handler:function(func,args){var _205d=ibmConfig.sharedPagesParent;if(_205d==null){var state=com.ibm.mashups.enabler.model.state;var _205e=state.NavigationStateModelFactory.getNavigationStateModel();var _205f=state.AccessorFactory.getSpaceAccessor(_205e);var _2060=_205f.getSpaceID();var _2061=state.AccessorFactory.getPageAccessor(_205e,_2060);_205d=_2061.getPageID();}if(_205d==null){_205d="ibm.portal.Home";}var node=this.find(_205d);var root=this.getRoot().start();var _2062=node;var _2063=_2062;while(_2063.start()!=root){_2062=_2063;_2063=this.getParent(_2062.start());}if(this.confirmInsert(null,_2062.start(),null)){return _2062;}else{}}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.NavigationModel.create":{type:"after",handler:function(_2064,args){if(!args[0].pageTemplate){for(var key in ibmConfig.nodeMetaData){var value=ibmConfig.nodeMetaData[key];if(value!=null){_2064.setMetaData(key,value);}}}return _2064;}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel":{type:"after",handler:function(model,args){var _2065=args[0];if(model instanceof com.ibm.mashups.enabler.ac.ResourceAccessControlModel){model._portal_is_resource_ac_model=true;}else{if(model instanceof com.ibm.mashups.enabler.ac.SpaceAccessControlModel){model._portal_is_space_ac_model=true;}}return model;}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.ac.AccessControlModel.setOwner":{type:"around",handler:function(func,args){var _2066=this.getOwner();var _2067=args[0];func(args);if((this._portal_is_space_ac_model)&&(_2066.getID()!=_2067.getID())){var _2068=this.getRoleModel();var it=_2068.iterator();var role;var found=false;while(it.hasNext()){role=it.next();if(role.getRoleType()==com.ibm.mashups.enabler.ac.RoleType.MANAGER){found=true;break;}}if(!found){return;}var _2069=_2068.getMemberModel(role);var _206a=_2069.find(_2066.getID()).start();if(_206a){_2069.remove(_206a);}}}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.ac.ResourceAccessControlModel.isInitialized":{type:"around",handler:function(func,args){var _206b=this.getResource().getXml();var _206c="atom:content/*/ac:allowed-access[@ac:private='true']";var ns={"atom":"http://www.w3.org/2005/Atom","model":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model-elements","ac":"http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0","xhtml":"http://www.w3.org/1999/xhtml","xml":"http://www.w3.org/XML/1998/namespace"};var _206d=com.ibm.mashups.enabler.xml.XPath.evaluateBoolean(_206c,_206b,ns);return _206d?false:func(args);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.ac.ResourceAccessControlModel.getRoleModel":{type:"before",handler:function(args){if(typeof this.roleModel=="undefined"){if(this._portal_is_resource_ac_model){var _206e=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);var _206f=_206e.idprefix;var ns={"ac":"http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0","app":"http://www.w3.org/2007/app","atom":"http://www.w3.org/2005/Atom","base":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0/ibm-portal-composite-base","ca":"http://www.ibm.com/xmlns/prod/composite-applications/v1.0","creation-context":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.1.0/portal-creation-context","ext":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model","model":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model-elements","opensearch":"http://a9.com/-/spec/opensearch/1.1/","thr":"http://purl.org/syndication/thread/1.0","xhtml":"http://www.w3.org/1999/xhtml","xml":"http://www.w3.org/XML/1998/namespace"};var _2070="atom:id";var _2071="atom:content/model:static-content-page";var _2072="atom:content/model:static-content-page/model:content";var _2073="atom:link";var _2074=_2073+"[@ext:rel='linked']";var _2075=_2073+"[@ext:rel='staticpage']";var _2076=_2073+"[@ext:rel='theme']";var _2077="creation-context";var _2078="copy";var _2079=_2077+":"+_2078;var _207a="domainprovider";var _207b=_2077+":"+_207a;var _207c="private";var _207d=_2077+":"+_207c;var _207e=this.mainResource.getXml();if(this.getACRolesLink(_207e)==null){var _207f=this.mainResource.getID();var _2080=this.mainResource.getEditLink();var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_2074,_207e,ns);var _2081;var _2082;if(nodes&&nodes.length>0){_2081=true;_2082=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(_206f,nodes[0]);}else{_2081=false;_2082=_207f;}var nm=com.ibm.mashups.enabler.model.Factory.getNavigationModel();var page=nm.find(_2082).start();var lm=nm.getLayoutModel(page);var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",ns.atom);var id=com.ibm.mm.enabler.utils.Utils.createNode("atom:id",ns.atom);var url=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelUrl(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL,this);url.setNodes([{value:this.uri,isID:true}]);com.ibm.mm.enabler.utils.Dom.textContent(id,url.getModelURI());entry.appendChild(id);var _2083=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",ns.atom);var node=com.ibm.mm.enabler.utils.Utils.createNode("model:static-content-page",ns.model);var _2084=com.ibm.mm.enabler.utils.Utils.createNode("model:title",ns.model);var _2085=com.ibm.mm.enabler.utils.Utils.createNode("model:description",ns.model);node.appendChild(_2084);node.appendChild(_2085);_2083.appendChild(node);entry.appendChild(_2083);var _2086=new com.ibm.mm.enabler.layout.LayoutFragmentImpl(entry,this);var _2087=_2086.getXml();var aid=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_2070,_2087,ns);if(aid&&aid.length>0){com.ibm.mm.enabler.utils.Dom.textContent(aid[0],"cid:0");}var pages=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_2071,_2087,ns);if(pages&&pages.length>0){com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2087.ownerDocument,pages[0],_2079,_2078,ns[_2077],_207f);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2087.ownerDocument,pages[0],_207d,_207c,ns[_2077],"false");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2087.ownerDocument,pages[0],_207b,_207a,ns[_2077],"ibm.portal.sharedPages");}var _2088=page.getLocales();if(_2088!=null){for(var i=0;i<_2088.length;i++){var title=page.getTitle(_2088[i]);if(title){_2086.setTitle(title,_2088[i]);}var _2089=page.getDescription(_2088[i]);if(_2089){_2086.setDescription(_2089,_2088[i]);}}}var theme=page.getTheme();if(theme!=null){var _208a;var _208b=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_2076,_2087,ns);if(_208b&&_208b.length>0){_208a=_208b[0];}else{_208a=com.ibm.mm.enabler.utils.Utils.createNode(_2073,ns.atom);_2087.appendChild(_208a);}var _208c=_2087.ownerDocument;_208a.setAttribute("rel","related");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_208c,_208a,"ext:rel","rel",ns.ext,"theme");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_208c,_208a,"ext:uri","uri",ns.ext,"tl:oid:"+theme);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_208c,_208a,"ext:inherited","inherited",ns.ext,"false");}var feed=com.ibm.mm.enabler.utils.Utils.createFeed("cm:oid:ibm.portal.sharedPages","IBM Lotus Mashups Fragment Feed",_2086.toString(),ns);var _208d=com.ibm.mm.enabler.model.UrlFactory.createModelUrl(com.ibm.mm.enabler.model.UrlFactory.FRAGMENT_URL,this);_208d.setNodes([{value:"ibm.portal.sharedPages",isID:true}]);var _208e=new com.ibm.mm.enabler.services.ModelRestServiceRequest(_208d,null,null,false,true);var _208f=false;_208e.create(feed,dojo.hitch(this,function(type,data,xhr,args){if(data!==null&&type==com.ibm.mm.enabler.services.ModelRestServiceRequest.XHR_STATUS_LOAD){var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:feed/atom:entry",data,ns);if(nodes&&nodes.length>0){_208f=true;var c;while((c=_207e.firstChild)){_207e.removeChild(c);}var _2090=nodes[0].childNodes;for(var i=0,l=_2090.length;i<l;i++){_207e.appendChild(_2090[i].cloneNode(true));}}}}));if(!_208f){return args;}var _2091=page.getContent().start();var _2092=_2091.getXml();var _2083=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(_2072,_2092,ns);_2083.parentNode.removeChild(_2083);page.setMetaData("com.ibm.portal.navigation.follow_internal_urls","true");var _2093=page.getXml();var links=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(_2075,_2093,ns);var _2094;if(links&&links.length>0){_2094=links[0];}else{var link=com.ibm.mm.enabler.utils.Utils.createNode("atom:link",ns.atom);com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2093.ownerDocument,link,"atom:rel","rel",ns.atom,"related");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2093.ownerDocument,link,"ext:rel","rel",ns.ext,"page");com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2093.ownerDocument,link,"ext:class","class",ns.ext,"content-node");_2093.appendChild(link);_2094=link;}var ids=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("atom:id",_207e,ns);if(_2094&&ids&&ids.length>0){com.ibm.mm.enabler.utils.Dom.setAttributeWithNS(_2093.ownerDocument,_2094,"ext:uri","uri",ns.ext,com.ibm.mm.enabler.utils.Dom.textContent(ids[0]));}nm.commit().start(true);if(_2081==true){myUrl=com.ibm.mm.enabler.model.UrlFactory.getModelUrl(_2080,this);serviceReq=new com.ibm.mm.enabler.services.ModelRestServiceRequest(myUrl,null,null,false,true);serviceReq.remove(dojo.hitch(this,function(type,data,xhr,args){}));}nm.invalidate(page);var _2095=com.ibm.mashups.builder.model.Factory.getRuntimeModel(),_2096=com.ibm.mashups.services.ServiceManager.getService("eventService"),_2097=_2095.getCurrentPage().getID();_2096.broadcastEvent("com.ibm.mashups.builder.switchPage",_2097);}}}return args;}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.content.StaticContentPage.setXml":{type:"before",handler:function(args){var _2098=args[0];var ns={"ac":"http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0","app":"http://www.w3.org/2007/app","atom":"http://www.w3.org/2005/Atom","base":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0/ibm-portal-composite-base","creation-context":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.1.0/portal-creation-context","ext":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model","model":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model-elements","opensearch":"http://a9.com/-/spec/opensearch/1.1/","thr":"http://purl.org/syndication/thread/1.0","xhtml":"http://www.w3.org/1999/xhtml","xml":"http://www.w3.org/XML/1998/namespace"};var _2099=false;var _209a=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:content/model:static-content-page/model:content",_2098,ns);var res=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("atom:content/model:static-content-page/model:metadata[@name='com.ibm.portal.layout.template.ref']",_2098,ns);if(res){res=res.getAttribute("value");_2099=true;}if((_209a)&&(_2099)){var _209b=_209a.parentNode;_209b.removeChild(_209a);}return args;}}});if(!dojo._hasResource["com.ibm.portal.extension.state"]){dojo._hasResource["com.ibm.portal.extension.state"]=true;dojo.provide("com.ibm.portal.extension.state");com.ibm.portal.extension.state.ObjectIDUtilities={widgetIDPrefix:"7eAe",portletWindowIDPrefix:"Z7_",encodeWidgetID:function(_209c){var _209d=_209c;if(!this.isObjectID(_209c)){_209d=this.widgetIDPrefix+Base32.encode(_209c);}return _209d;},decodeWidgetID:function(_209e){var _209f=_209e;if(_209e.indexOf(this.widgetIDPrefix)===0){_209f=_209e.substring(this.widgetIDPrefix.length);_209f=Base32.decode(_209f);}return _209f;},isObjectID:function(id){return id.indexOf(this.portletWindowIDPrefix)===0;}};com.ibm.portal.extension.state.PortletModeMapper={PORTLET_MODE_VIEW:"view",PORTLET_MODE_EDIT:"edit",PORTLET_MODE_EDIT_DEFAULTS:"edit_defaults",PORTLET_MODE_CONFIG:"config",PORTLET_MODE_HELP:"help",DEFAULT_PORTLET_MODE:"view",IWIDGET_MODE_VIEW:com.ibm.mm.iwidget.Constants.mode.VIEW,IWIDGET_MODE_EDIT:com.ibm.mm.iwidget.Constants.mode.EDIT,IWIDGET_MODE_PERSONALIZE:com.ibm.mm.iwidget.Constants.mode.PERSONALIZE,IWIDGET_MODE_CONFIG:com.ibm.mm.iwidget.Constants.mode.CONFIG,IWIDGET_MODE_HELP:com.ibm.mm.iwidget.Constants.mode.HELP,DEFAULT_IWIDGET_MODE:com.ibm.mm.iwidget.Constants.mode.VIEW,toPortletMode:function(_20a0){var _20a1=_20a0;if(_20a0){if(_20a0==this.IWIDGET_MODE_VIEW){_20a1=this.PORTLET_MODE_VIEW;}else{if(_20a0==this.IWIDGET_MODE_EDIT){_20a1=this.PORTLET_MODE_EDIT_DEFAULTS;}else{if(_20a0==this.IWIDGET_MODE_PERSONALIZE){_20a1=this.PORTLET_MODE_EDIT;}else{if(_20a0==this.IWIDGET_MODE_CONFIG){_20a1=this.PORTLET_MODE_CONFIG;}else{if(_20a0==this.IWIDGET_MODE_HELP){_20a1=this.PORTLET_MODE_HELP;}}}}}}return _20a1;},toIWidgetMode:function(_20a2){var _20a3=_20a2;if(_20a2){if(_20a2==this.PORTLET_MODE_VIEW){_20a3=this.IWIDGET_MODE_VIEW;}else{if(_20a2==this.PORTLET_MODE_EDIT){_20a3=this.IWIDGET_MODE_PERSONALIZE;}else{if(_20a2==this.PORTLET_MODE_EDIT_DEFAULTS){_20a3=this.IWIDGET_MODE_EDIT;}else{if(_20a2==this.PORTLET_MODE_CONFIG){_20a3=this.IWIDGET_MODE_CONFIG;}else{if(_20a2==this.PORTLET_MODE_HELP){_20a3=this.IWIDGET_MODE_HELP;}}}}}}return _20a3;}};com.ibm.portal.extension.state.WindowStateMapper={WINDOW_STATE_NORMAL:"normal",WINDOW_STATE_MAXIMIZED:"maximized",WINDOW_STATE_MINIMIZED:"minimized",DEFAULT_WINDOW_STATE:"normal",IWIDGET_WINDOW_STATE_NORMAL:com.ibm.mm.iwidget.Constants.windowstate.NORMAL,IWIDGET_WINDOW_STATE_MAXIMIZE:com.ibm.mm.iwidget.Constants.windowstate.MAXIMIZE,IWIDGET_WINDOW_STATE_MINIMIZE:com.ibm.mm.iwidget.Constants.windowstate.MINIMIZE,DEFAULT_IWIDGET_WINDOW_STATE:com.ibm.mm.iwidget.Constants.windowstate.NORMAL,toPortletWindowState:function(_20a4){var _20a5=null;if(_20a4){if(_20a4==this.IWIDGET_WINDOW_STATE_NORMAL){_20a5=this.WINDOW_STATE_NORMAL;}else{if(_20a4==this.IWIDGET_WINDOW_STATE_MAXIMIZE){_20a5=this.WINDOW_STATE_MAXIMIZED;}else{if(_20a4==this.IWIDGET_WINDOW_STATE_MINIMIZE){_20a5=this.WINDOW_STATE_MINIMIZED;}}}}return _20a5;},toIWidgetWindowState:function(_20a6){var _20a7=null;if(_20a6){if(_20a6==this.WINDOW_STATE_NORMAL){_20a7=this.IWIDGET_WINDOW_STATE_NORMAL;}else{if(_20a6==this.WINDOW_STATE_MAXIMIZED){_20a7=this.IWIDGET_WINDOW_STATE_MAXIMIZE;}else{if(_20a6==this.WINDOW_STATE_MINIMIZED){_20a7=this.IWIDGET_WINDOW_STATE_MINIMIZE;}}}}return _20a7;}};dojo.declare("com.ibm.portal.extension.state.CSANavigationStateProcessor",null,{constructor:function(){var _20a8="com.ibm.portal.extension.state.CSANavigationStateProcessor";this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(_20a8);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.modeMapper=com.ibm.portal.extension.state.PortletModeMapper;this.windowStateMapper=com.ibm.portal.extension.state.WindowStateMapper;this.oidUtils=com.ibm.portal.extension.state.ObjectIDUtilities;var _20a9=portalMashupsConfig.contentHandlerContextPath;this.stateManager=new com.ibm.portal.state.StateManager(_20a9);this.stateCache={};if(dojo.isIE){this.threshold=2048;}else{this.threshold=8192;}},decode:function(url,_20aa){var _20ab=this.isLoggable();var _20ac="decode";if(_20ab){this.logEntry(_20ac,url);}var state=null;var hash=this.decodeHash(url);if(hash){if(dojo.trim(hash).indexOf("{")===0||dojo.trim(hash).indexOf("[")===0){try{state=dojo.fromJson(hash);}catch(error){}}if(state===null){if(hash.indexOf("http")===0||hash.indexOf("/")===0){var _20ad=this.decodePortalURL(hash);if(_20ad){state=this.fromPortalState(_20ad);}else{if(_20ab){this.log(_20ac,"Could not decode URL ${0}",[hash]);}}}}}if(state===null){var _20ae=this.getCachedStateXML(url);if(_20ae){state=this.fromPortalState(_20ae);}}if(state===null){var _20ad=this.decodePortalURL(url);if(_20ad){state=this.fromPortalState(_20ad);}else{if(_20ab){this.log(_20ac,"Could not decode URL ${0}",[url]);}}}if(state===null){state={};}if(_20ab){this.logExit(_20ac,dojo.toJson(state));}if(_20aa){_20aa(state);}else{return state;}},encode:function(state,_20af,_20b0,_20b1){var _20b2=this.isLoggable();var _20b3="encode";if(_20b2){}var _20b4=this;if(_20af){_20b4.serializeState(state,function(_20b5){_20af(_20b5,_20b1);});}else{return _20b4.serializeState(state);}},generateURL:function(state,_20b6,_20b7){var _20b8=this.isLoggable();var _20b9="generateURL";if(_20b8){this.logEntry(_20b9,[dojo.toJson(state),dojo.toJson(_20b7)]);}var _20ba=this;var _20bb=_20ba.toPortalState(state);if(_20b7){_20bb=_20ba.processState(_20bb,_20b7);}if(_20b6){_20ba.generatePortalURL(_20bb,_20b7,function(url){if(_20b8){_20ba.logExit(_20b9,url);}_20b6(url);});}else{var url=_20ba.generatePortalURL(_20bb,_20b7);if(_20b8){_20ba.logExit(_20b9,url);}return url;}},processState:function(_20bc,_20bd){var _20be=this.isLoggable();var _20bf="processState";if(_20be){this.logEntry(_20bf,dojo.toJson(_20bd));}var _20c0=_20bd.pocURI;if(_20c0){var _20c1=this.stateManager.newSelectionAccessor(_20bc);_20c1.setURI(_20c0);var _20c2=_20bd.queryParams;if(_20c2){var _20c3=_20c1.getParameters();for(var name in _20c2){if(_20c2.hasOwnProperty(name)){var value=_20c2[name];if(value){if(dojo.isArray(value)){_20c3.setValues(name,value);}else{_20c3.setValue(name,value);}}}}}}var _20c4=_20bd.newWindow;if(_20c4){var _20c5=this.stateManager.newStatePartitionAccessor(_20bc);_20c5.includeStatePartition();}var _20c6=_20bd.themeTemplate;if(_20c6){var _20c7=this.stateManager.newThemeTemplateAccessor(_20bc);_20c7.setThemeTemplate(_20c6);}var _20c8=_20bd.soloState;if(_20c8){var _20c9=_20c8.portletWindowID;if(_20c9){_20c9=this.oidUtils.encodeWidgetID(_20c9);var _20ca=this.stateManager.newSoloStateAccessor(_20bc);_20ca.setSoloPortlet(_20c9);var _20cb=_20c8.returnSelection;if(_20cb){_20ca.setReturnSelection(_20cb);}}}if(_20be){this.logExit(_20bf,dojox.xml.parser.innerXML(_20bc));}return _20bc;},preprocess:function(state,_20cc){var _20cd=this.isLoggable();var _20ce="preprocess";if(_20cd){}if(_20cc){_20cc(state);}else{return state;}},dispose:function(_20cf){var _20d0=this.isLoggable();var _20d1="dispose";if(_20d0){this.logEntry(_20d1);}if(_20cf){_20cf();}},postprocess:function(state,_20d2,_20d3,_20d4){var _20d5=this.isLoggable();var _20d6="postprocess";if(_20d5){}if(_20d2){_20d2(state,_20d4);}else{return state;}},getCachedStateXML:function(url){var _20d7=this.isLoggable();var _20d8="getCachedStateXML";var _20d9=null;if(this.isBaseURL(url)){var _20da=ibmCfg.portalConfig.bootstrapState;if(_20da){if(_20d7){this.log(_20d8,"Using cached bootstrap state...");}_20d9=dojox.xml.parser.parse(_20da);}}return _20d9;},isBaseURL:function(url){var _20db=(url===top.location.href);if(!_20db){_20db=(url===this.getBaseURL());}return _20db;},getBaseURL:function(){var _20dc=this.isLoggable();var _20dd="getBaseURL";if(_20dc){this.logEntry(_20dd);}var _20de=null;var head=dojo.query("head")[0];if(head){var link=dojo.query("link[rel='alternate'][id='com.ibm.lotus.NavStateUrl']",head)[0];if(link){_20de=dojo.attr(link,"href");}}if(_20dc){this.logExit(_20dd,_20de);}return _20de;},serializeState:function(state,_20df){var _20e0=this.isLoggable();var _20e1="serializeState";var _20e2=this;var _20e3=dojo.toJson(state);if(_20e2.isTooLong(_20e3)){if(_20df){_20e2.generateURL(state,function(url){if(_20e2.isTooLong(url)){if(_20e0){_20e2.log(_20e1,"URL is getting too long. Discarding the client-side state...");}_20df("");}else{_20df(url);}});}else{var url=_20e2.generateURL(state);if(_20e2.isTooLong(url)){if(_20e0){_20e2.log(_20e1,"URL is getting too long. Discarding the client-side state...");}return "";}else{return url;}}}else{if(_20df){_20df(_20e3);}else{return _20e3;}}},isTooLong:function(_20e4){var url=top.location.href;var idx=url.lastIndexOf("#");var _20e5=encodeURIComponent(_20e4).length;var _20e6=false;if(idx>0){_20e6=(idx+_20e5>this.threshold);}else{_20e6=(url.length+_20e5>this.threshold);}return _20e6;},decodeHash:function(url){var _20e7=this.isLoggable();var _20e8="decodeHash";var idx=url.lastIndexOf("#");var hash=null;if(idx>0&&url.length-1>idx){hash=decodeURIComponent(url.substring(idx+1));}if(_20e7){this.logExit(_20e8,hash);}return hash;},decodePortalURL:function(url,_20e9){var _20ea=this.isLoggable();var _20eb="decodePortalURL";if(_20ea){this.logEntry(_20eb,url);}var _20ec=this;var _20ed=_20ec.stateManager.getSerializationManager();if(_20e9){_20ed.deserialize(url,function(_20ee,url,_20ef){if(_20ea){if(_20ef){_20ec.logExit(_20eb,dojox.xml.parser.innerXML(_20ef));}else{_20ec.logExit(_20eb,null);}}if(_20ee==_20ed.STATUS_OK){_20e9(_20ef);}else{_20e9(null);}});}else{var _20f0=_20ed.deserialize(url);var _20f1=null;if(_20f0.status==_20ed.STATUS_OK){_20f1=_20f0.state;}if(_20ea){if(_20f1){_20ec.logExit(_20eb,dojox.xml.parser.innerXML(_20f1));}else{_20ec.logExit(_20eb,null);}}return _20f1;}},fromCache:function(_20f2,_20f3){var _20f4=this.isLoggable();var _20f5="fromCache";if(_20f4){this.logEntry(_20f5,[dojox.xml.parser.innerXML(_20f2),dojo.toJson(_20f3)]);}var _20f6;var _20f7=dojox.xml.parser.innerXML(_20f2);var _20f8;if(_20f3){_20f8=dojo.toJson(_20f3);}else{_20f8=null;}if(this.stateCache.state==_20f7&&this.stateCache.params==_20f8){_20f6=this.stateCache.serialized;}else{_20f6=null;}if(_20f4){this.logExit(_20f5,_20f6);}return _20f6;},toCache:function(_20f9,_20fa,_20fb){var _20fc=this.isLoggable();var _20fd="toCache";if(_20fc){this.logEntry(_20fd,[dojox.xml.parser.innerXML(_20f9),dojo.toJson(_20fa),_20fb]);}var _20fe=dojox.xml.parser.innerXML(_20f9);this.stateCache.state=_20fe;var _20ff;if(_20fa){_20ff=dojo.toJson(_20fa);}else{_20ff=null;}this.stateCache.params=_20ff;this.stateCache.serialized=_20fb;if(_20fc){this.logExit(_20fd);}},generatePortalURL:function(_2100,_2101,_2102){var _2103=this.fromCache(_2100,_2101);if(_2103){if(_2102){_2102(_2103);}else{return _2103;}}else{var _2104=this;var _2105=_2104.stateManager.getSerializationManager();if(_2102){_2105.serialize(_2100,true,function(_2106,_2107,url){_2104.toCache(_2100,_2101,url);_2102(url);},false);}else{var _2108=_2105.serialize(_2100,true,null,false);_2104.toCache(_2100,_2101,_2108.url);return _2108.url;}}},fromPortalState:function(_2109){var _210a=this.isLoggable();var _210b="fromPortalState";if(_210a){this.logEntry(_210b);}var _210c=this;var state={};var _210d=_210c.stateManager.newSelectionAccessor(_2109);var _210e=_210d.getPageSelection();if(_210e){state.pid={};state.pid.value=_210e;}var _210f=_210c.stateManager.newLocaleAccessor(_2109);var _2110=_210f.getLocale();if(_2110){state.locale=_2110;}var _2111=_210d.getMappingSources();if(_2111&&_2111.length>0){state.labelmappings={};dojo.forEach(_2111,function(srcId){var _2112=_210d.getMapping(srcId);state.labelmappings[srcId]={value:_2112};});}var _2113=_210c.stateManager.newStatePartitionAccessor(_2109);var _2114=_2113.getStatePartition();if(_2114){state.partitionID=_2114;}var _2115=_210c.stateManager.newPortletListAccessor(_2109).getPortlets();if(_2115&&_2115.length>0){state.wparams={};dojo.forEach(_2115,function(_2116){_210c.decodePortletState(_2116,_2109,state);});}var _2117=_210c.stateManager.newSharedStateListAccessor(_2109).getScopeIDs();if(_2117&&_2117.length>0){state.sparams={};state.sparams["public-render-parameters"]={};var _2118=state.sparams["public-render-parameters"];dojo.forEach(_2117,function(_2119){_210c.decodeSharedParameters(_2119,_2109,_2118);});}if(_210a){this.logExit(_210b,dojo.toJson(state));}return state;},decodePortletState:function(_211a,_211b,state){var _211c=this.isLoggable();var _211d="decodePortletState";if(_211c){this.logEntry(_211d,_211a);}var _211e=this.oidUtils.decodeWidgetID(_211a);var pAcc=this.stateManager.newPortletAccessor(_211a,_211b);var _211f=pAcc.getRenderParameters();var _2120={};var _2121={};if(this.oidUtils.isObjectID(_211e)){var _2122=pAcc.getPortletMode();if(_2122){var _2123=this.modeMapper.toIWidgetMode(_2122);_2120.md=_2123;}var _2124=pAcc.getWindowState();if(_2124){var _2125=this.windowStateMapper.toIWidgetWindowState(_2124);_2120.st=_2125;}if(_211f){var names=_211f.getNames();dojo.forEach(names,function(name){var _2126=_211f.getValues(name);if(_2126){_2121[name]=_2126;}});}}else{if(_211f){var _2127=_211f.getValue("rp");if(_2127){_2120=dojo.fromJson(_2127);}var _2128=_211f.getValue("cp");if(_2128){_2121=dojo.fromJson(_2128);}}}var _2129=state.wparams;if(_2120||_2121){_2129[_211e]={"value":{}};}if(_2120){_2129[_211e]["value"]["rp"]=_2120;}if(_2121){_2129[_211e]["value"]["cp"]=_2121;}if(_211c){this.logExit(_211d,dojo.toJson(state));}},decodeSharedParameters:function(_212a,_212b,_212c){var _212d=this.isLoggable();var _212e="decodeSharedParameters";if(_212d){this.logEntry(_212e,_212a);}var _212f=this.stateManager.newSharedStateAccessor(_212a,_212b);if(_212f){var _2130=_212f.getQNames();if(_2130&&_2130.length>0){_212c[_212a]={};_212c[_212a].value={};var _2131=_212c[_212a].value;var _2132=this;dojo.forEach(_2130,function(qname){var _2133=_212f.getValues(qname);if(dojo.isArray(_2133)){_2132.decodeSharedParameter(qname,_2133,_2131);}});}}if(_212d){this.logExit(_212e,dojo.toJson(_212c));}},decodeSharedParameter:function(qname,_2134,_2135){var _2136=this.isLoggable();var _2137="decodeSharedParameter";if(_2136){this.logEntry(_2137,qname,dojo.toJson(_2134));}var _2138=this.qnameToItemName(qname);var _2139=dojo.toJson(_2134);_2135[_2138]={};_2135[_2138].value=_2139;if(_2136){this.logExit(_2137,dojo.toJson(_2135));}},toPortalState:function(state){var _213a=this.isLoggable();var _213b="toPortalState";if(_213a){this.logEntry(_213b);}var _213c=this.stateManager.newState();var _213d=state.pid.value;var _213e=this.stateManager.newSelectionAccessor(_213c);if(_213d){_213e.setPageSelection(_213d);}var _213f=state.locale;if(_213f){var _2140=this.stateManager.newLocaleAccessor(_213c);_2140.setLocale(_213f);}var _2141=state.labelmappings;if(_2141){for(srcId in _2141){if(_2141.hasOwnProperty(srcId)){var _2142=_2141[srcId].value;if(_2142){_213e.setMapping(srcId,_2142);}}}}var _2143=state.wparams;if(_2143){for(var _2144 in _2143){if(Object.prototype.hasOwnProperty.call(_2143,_2144)){if(_2143[_2144]){var _2145=_2143[_2144].value?_2143[_2144].value:_2143[_2144];if(_2145){this.decodeWidgetState(_2144,_2145,_213c);}}}}}var _2146=state.sparams;if(_2146){for(var _2147 in _2146){if(Object.prototype.hasOwnProperty.call(_2146,_2147)){var _2148=_2146[_2147];if(_2148){this.decodeShareableItemSet(_2147,_2148,_213c);}}}}if(_213a){this.logExit(_213b,dojox.xml.parser.innerXML(_213c));}return _213c;},decodeWidgetState:function(_2149,_214a,_214b){var _214c=this.isLoggable();var _214d="decodeWidgetState";if(_214c){}var _214e=_214a.rp;var _214f=_214a.cp;var _2150=this.oidUtils.encodeWidgetID(_2149);var _2151=null;if(this.oidUtils.isObjectID(_2149)){if(_214e){var _2152=_214e.st;if(_2152&&_2152!=this.windowStateMapper.DEFAULT_IWIDGET_WINDOW_STATE){if(_2151===null){_2151=this.stateManager.newPortletAccessor(_2150,_214b);}var _2153=this.windowStateMapper.toPortletWindowState(_2152);_2151.setWindowState(_2153);}var _2154=_214e.md;if(_2154&&_2154!=this.modeMapper.DEFAULT_IWIDGET_MODE){if(_2151===null){_2151=this.stateManager.newPortletAccessor(_2150,_214b);}var _2155=this.modeMapper.toPortletMode(_2154);_2151.setPortletMode(_2155);}}if(_214f){if(_2151===null){_2151=this.stateManager.newPortletAccessor(_2150,_214b);}var _2156=_2151.getRenderParameters();for(var key in _214f){if(Object.prototype.hasOwnProperty.call(_214f,key)){var _2157=_214f[key];if(_2157){_2156.setValues(key,_2157);}}}}}else{if(!this.isDefaultState(_214e)){if(_2151===null){_2151=this.stateManager.newPortletAccessor(_2150,_214b);}_2151.getRenderParameters().setValue("rp",dojo.toJson(_214e));}if(_214f){if(_2151===null){_2151=this.stateManager.newPortletAccessor(_2150,_214b);}_2151.getRenderParameters().setValue("cp",dojo.toJson(_214f));}}if(_214c){this.logExit(_214d,dojox.xml.parser.innerXML(_214b));}},decodeShareableItemSet:function(_2158,_2159,_215a){var _215b=this.isLoggable();var _215c="decodeShareableItemSet";if(_215b){this.logEntry(_215c,[_2158,dojo.toJson(_2159)]);}if(_2158=="public-render-parameters"){for(var _215d in _2159){if(Object.prototype.hasOwnProperty.call(_2159,_215d)){var items=_2159[_215d];if(items&&items.value){this.decodeShareableItems(_2158,_215d,items.value,_215a);}}}}if(_215b){this.logExit(_215c,dojox.xml.parser.innerXML(_215a));}},decodeShareableItems:function(_215e,_215f,items,_2160){var _2161=this.isLoggable();var _2162="decodeShareableItems";if(_2161){}var _2163=null;for(var name in items){if(Object.prototype.hasOwnProperty.call(items,name)){if(items[name]){var _2164=items[name];if(_2164&&_2164.value){if(_2163===null){_2163=this.stateManager.newSharedStateAccessor(_215f,_2160);}this.decodeShareableItem(_2163,name,_2164.value);}}}}if(_2161){}},decodeShareableItem:function(_2165,_2166,value){var _2167=this.isLoggable();var _2168="decodeShareableItem";if(_2167){}var qname=this.itemNameToQName(_2166);try{var _2169=dojo.fromJson(value);if(dojo.isArray(_2169)){_2165.setValues(qname,_2169);}else{_2165.setValue(qname,value);}}catch(e){_2165.setValue(qname,value);}if(_2167){}},qnameToItemName:function(qname){return qname;},itemNameToQName:function(name){return name;},setThreshold:function(_216a){var _216b=this.isLoggable();var _216c="setThreshold";if(_216b){this.logEntry(_216c,_216a);}this.threshold=_216a;},isDefaultState:function(_216d){var _216e=this.isLoggable();var _216f="isDefaultState";if(!_216d){if(_216e){}return true;}var mode=_216d.md;if(mode&&mode!=this.modeMapper.DEFAULT_IWIDGET_MODE){if(_216e){this.logExit(_216f,false);}return false;}var _2170=_216d.st;if(_2170&&_2170!=this.windowStateMapper.DEFAULT_IWIDGET_WINDOW_STATE){if(_216e){this.logExit(_216f,false);}return false;}for(var key in _216d){if(_216d.hasOwnProperty(key)){if(key!="st"&&key!="md"){if(_216e){this.logExit(_216f,false);}return false;}}}if(_216e){}return true;},isLoggable:function(){return this.LOGGER.isLoggable(this.LOG_LEVEL);},logEntry:function(name,args){this.LOGGER.entering(name,args);},log:function(name,msg,args){this.LOGGER.log(this.LOG_LEVEL,name,msg,args);},logExit:function(name,_2171){this.LOGGER.exiting(name,_2171);}});com.ibm.portal.extension.state.CSANavigationStateProcessor.SINGLETON=new com.ibm.portal.extension.state.CSANavigationStateProcessor();dojo.declare("com.ibm.portal.extension.state.PersistenceManager",null,{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;this.bIsLoggable=this.LOGGER.isLoggable(this.LOG_LEVEL);this._dirty=false;this._cookiePath=ibmPortalConfig["portalContext"];},COOKIE_NAME_PREFIX:"digest.ignore.portal.state.",COOKIE_NAME_ANONYMOUS:"digest.ignore.portal.state.anonymous",COOKIE_THRESHOLD:4096,dispose:function(){var id=this._getCookieID();if(id&&dojo.cookie(id)){dojo.cookie(id,null,{expires:-1});}delete this._state;delete this._cookieID;this._dirty=false;},_getCookieID:function(){if(!this._cookieID){var _2172=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);var uid=_2172.getValue(com.ibm.mashups.enabler.services.ConfigConstants.USER);if(uid&&uid!="null"&&uid.length>0){this._cookieID=this.COOKIE_NAME_PREFIX+uid;}else{this._cookieID=this.COOKIE_NAME_ANONYMOUS;}}return this._cookieID;},_deleteCookie:function(item){if(item&&item.indexOf(this.COOKIE_NAME_PREFIX)==0){item=item.split("=");if(this._getCookieID()!=item[0]+""&&item){dojo.cookie(item[0],null,{path:this._cookiePath,expires:-1});}}},_init:function(_2173){if(!this._state){this._state={};if(dojo.cookie.isSupported()){var _2174=dojo.cookie(this._getCookieID());dojo.forEach(document.cookie.split(/;\s*/),this._deleteCookie,this);if(_2174){this._state=dojo.fromJson(_2174);}}}if(!this._state[_2173]){this._state[_2173]={};}},getThreshold:function(){return this.COOKIE_THRESHOLD;},getState:function(id,_2175){var _2176=this._getStatePartition(_2175);this._init(_2176);if(!id){return this._state[_2176];}else{var state=this._state[_2176][id];if(state){return state;}}return null;},setState:function(id,value,_2177){var _2178=this._getStatePartition(_2177);this._init(_2178);if(value){this._state[_2178][id]=value;}else{this._state[_2178]=id;}this._dirty=true;},remove:function(id,_2179){var _217a=this._getStatePartition(_2179);this._init(_217a);if(this._state[_217a][id]){delete this._state[_217a][id];this._dirty=true;}},clear:function(){this._state={};},commit:function(){if(this._dirty){if(dojo.cookie.isSupported()){dojo.cookie(this._getCookieID(),dojo.toJson(this._state),{path:this._cookiePath});}this._dirty=false;}},_getStatePartition:function(_217b){if(_217b){return _217b;}else{return "def";}}});com.ibm.portal.extension.state.PersistenceManager.SINGLETON=new com.ibm.portal.extension.state.PersistenceManager();dojo.declare("com.ibm.portal.extension.state.SSANavigationStateProcessor",[com.ibm.portal.extension.state.CSANavigationStateProcessor],{constructor:function(){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.persistenceManager=com.ibm.portal.extension.state.PersistenceManager.SINGLETON;this.widgetModel=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel();},_isEmpty:function(_217c){for(var i in _217c){if(Object.prototype.hasOwnProperty.call(_217c,i)&&typeof (_217c)=="object"){return false;}}return true;},generateURL:function(state,_217d,_217e){var url=null;if(_217e&&_217e.skipState&&_217e.pocURI){var links=dojo.query("link[title="+_217e.pocURI+"]");if(links&&links.length>0){var _217f=dojo.attr(links[0],"href");if(_217f){url=_217f;}}else{var base=dojo.query("base[href]")[0];if(base){url=dojo.attr(base,"href")+"?uri="+_217e.pocURI;}}_217e.pocURI=null;_217e.skipState=false;}if(url){if(_217d){_217d(url,_217e);}else{return url;}}else{return this.inherited(arguments,[state,_217d,_217e]);}},_mergeState:function(_2180,_2181){for(var i in _2181){if(Object.prototype.hasOwnProperty.call(_2181,i)){if(Object.prototype.hasOwnProperty.call(_2180,i)&&!this._isEmpty(_2181[i])){this._mergeState(_2180[i],_2181[i]);}else{_2180[i]=_2181[i];}}}},decode:function(url,_2182){var _2183="decode";var _2184=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_2184){this.logEntry(_2183,arguments);}var _2185=this;if(url===top.location.href){var _2186=_2185.getBaseURL();if(_2186){url=_2186;}}if(_2182){_2185.inherited(arguments,[url,function(_2187){var state=_2185.persistenceManager.getState(null,_2187.partitionID);if(dojo.isString(state)){state=_2185.inherited(arguments,[state]);}_2185._mergeState(state,_2187);if(_2184){_2185.logExit(_2183,state);}_2182(state);}]);}else{var _2188=_2185.inherited(arguments,[url]);var state=_2185.persistenceManager.getState(null,_2188.partitionID);if(dojo.isString(state)){state=_2185.inherited(arguments,[state]);}_2185._mergeState(state,_2188);if(_2184){_2185.logExit(_2183,state);}return state;}},encode:function(state,_2189,_218a,_218b){var _218c="encode";var _218d=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_218d){this.logEntry(_218c,[dojo.toJson(state),_2189,dojo.toJson(_218a),dojo.toJson(_218b)]);}this.persistenceManager.clear();var _218e=state.wparams;if(_218e){var _218f=_218a?_218a.wparams:undefined;var _2190=null;for(var _2191 in _218e){if(Object.prototype.hasOwnProperty.call(_218e,_2191)){if(this._isUnmanagedWidget(_2191)){var _2192=_218e[_2191];if(_2192&&_2192.value){_2192=_2192.value;var _2193=null;var _2194=false;if(_218f){var _2195=_218f[_2191];if(_2195&&_2195.value){var _2196=_2195.value.rp;if(_2196){_2194=this.isDefaultState(_2196);}}}var _2197=_2192.rp;if(_2197&&!(this.isDefaultState(_2197)&&_2194)){if(_2193===null){_2193={};}_2193.rp=_2197;}var _2198=_2192.cp;if(_2198){if(_2193===null){_2193={};}_2193.cp=_2198;}if(_2193){if(_2190===null){_2190={};}_2190[_2191]={"value":_2193};}}}}}if(_2190){this.persistenceManager.setState("wparams",_2190,state.partitionID);}}this.persistenceManager.commit();if(_218d){this.logExit(_218c);}if(_2189){if(_218b&&_218b.allowRedirect){_218b.doRedirect=true;}_2189("",_218b,_218b);}else{return "";}},_isUnmanagedWidget:function(_2199){var _219a=false;var _219b=this.widgetModel.find(_2199);var _219c=(_219b&&_219b.isStandalone());if(!_219c&&_219b){_219a=dojo.hasClass(_219b.rootElement,"iw-iWidget");}return _219a;}});com.ibm.portal.extension.state.SSANavigationStateProcessor.SINGLETON=new com.ibm.portal.extension.state.SSANavigationStateProcessor();var com_ibm_portal_extension_state_navStateProcessor=(ibmCfg&&ibmCfg["themeConfig"]&&ibmCfg["themeConfig"]["isPageRenderModeCSA"])?com.ibm.portal.extension.state.CSANavigationStateProcessor.SINGLETON:com.ibm.portal.extension.state.SSANavigationStateProcessor.SINGLETON;ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.encode":{type:"around",handler:function(_219d,_219e){var _219f=com_ibm_portal_extension_state_navStateProcessor;return _219f.encode(_219e[0],_219e[1],_219e[2],_219e[3]);}},"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.postprocess":{type:"around",handler:function(_21a0,_21a1){var _21a2=com_ibm_portal_extension_state_navStateProcessor;return _21a2.postprocess(_21a1[0],_21a1[1],_21a1[2],_21a1[3]);}},"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.decode":{type:"around",handler:function(_21a3,_21a4){var _21a5=com_ibm_portal_extension_state_navStateProcessor;return _21a5.decode(_21a4[0],_21a4[1]);}},"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.preprocess":{type:"around",handler:function(_21a6,_21a7){var _21a8=com_ibm_portal_extension_state_navStateProcessor;return _21a8.preprocess(_21a7[0],_21a7[1]);}},"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.generateURL":{type:"around",handler:function(_21a9,_21aa){var _21ab=com_ibm_portal_extension_state_navStateProcessor;return _21ab.generateURL(_21aa[0],_21aa[1],_21aa[2]);}},"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.dispose":{type:"around",handler:function(_21ac,_21ad){var _21ae=com_ibm_portal_extension_state_navStateProcessor;_21ae.dispose(_21ad[0]);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.state.NavigationStateProcessor.generateUrl":{type:"around",handler:function(_21af,_21b0){return com.ibm.mashups.enabler.model.state.NavigationStateProcessor.generateURL(_21af,_21b0);}}});}dojo.declare("com.ibm.mm.extension.model.NavigationModelImpl",null,{constructor:function(){this.ns={"ac":"http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0","app":"http://www.w3.org/2007/app","atom":"http://www.w3.org/2005/Atom","base":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0/ibm-portal-composite-base","creation-context":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.1.0/portal-creation-context","ext":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model","model":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model-elements","opensearch":"http://a9.com/-/spec/opensearch/1.1/","thr":"http://purl.org/syndication/thread/1.0","xhtml":"http://www.w3.org/1999/xhtml","xml":"http://www.w3.org/XML/1998/namespace"};this._CREATION_CONTEXT="creation-context";this._ACCESS="ac";this._PRIVATE="private";this._CREATION_CONTEXT_PRIVATE=this._CREATION_CONTEXT+":"+this._PRIVATE;this._ACCESS_PRIVATE=this._ACCESS+":"+this._PRIVATE;},create:function(nm,node,_21b1){if(node!=null){if(!_21b1||!_21b1.template){if(nm._portal_createdNodes==null){nm._portal_createdNodes=[];}nm._portal_createdNodes[node.getID()]=node;}if(_21b1){if(_21b1.template){node.setMetaData("com.ibm.portal.navigation.follow_internal_urls","true");}if(_21b1["private"]){var expr="atom:content/*";var _21b2=node.getXml();var nav=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,_21b2,this.ns);if(nav){this._setAttributeWithNS(_21b2.ownerDocument,nav,this._CREATION_CONTEXT_PRIVATE,this._PRIVATE,this.ns[this._CREATION_CONTEXT],""+_21b1["private"]);var _21b3=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("ac:allowed-access",nav,this.ns);if(_21b3){this._setAttributeWithNS(_21b2.ownerDocument,_21b3,this._ACCESS_PRIVATE,this._PRIVATE,this.ns[this._ACCESS],""+_21b1["private"]);}}var _21b4=node.getContent().start();if(_21b4){var _21b5=_21b4.getXml();var res=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,_21b5,this.ns);if(res){this._setAttributeWithNS(_21b5.ownerDocument,res,this._CREATION_CONTEXT_PRIVATE,this._PRIVATE,this.ns[this._CREATION_CONTEXT],""+_21b1["private"]);var _21b3=com.ibm.mashups.enabler.xml.XPath.evaluateEntry("ac:allowed-access",res,this.ns);if(_21b3){this._setAttributeWithNS(_21b2.ownerDocument,_21b3,this._ACCESS_PRIVATE,this._PRIVATE,this.ns[this._ACCESS],""+_21b1["private"]);}}}}}}},remove:function(_21b6,nm,args){var id=args[0];var _21b7=false;var _21b8=null;if(id!=null){_21b8=nm.find(id).start();if(_21b8!=null&&com.ibm.mashups.enabler.model.Factory.getSpaceModel().findSpaceByNavigation(_21b8).start()!=null){_21b7=true;}}var _21b9=_21b6(args);if(id!=null&&nm._portal_createdNodes!=null){delete nm._portal_createdNodes[id];}if(_21b7){var expr="atom:link[@rel='related' and @ext:class='content-node']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_21b8.xmlData,this.ns);if(nodes&&nodes.length>0){dojo.removeAttr(nodes[0],"href");}}return _21b9;},insert:function(nm,node,_21ba){if(nm._portal_createdNodes!=null&&nm._portal_createdNodes[node.getID()]!=null){var _21bb=nm._portal_createdNodes[node.getID()];var _21bc=com.ibm.mashups.enabler.model.Factory.getSpaceModel().findSpaceByNavigation(_21ba).start();_21bb._portal_isPrivate=(_21bc!=null)?"false":"true";}var id=node.getID();if(nm.createdNodes[id]==null){var _21bd=null;var expr="atom:link[@rel='related' and @ext:rel='content-topology']";var _21be=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(expr,_21ba.getXml(),this.ns);if(_21be&&_21be.length>0){_21bd=com.ibm.mm.enabler.utils.Utils.getIdFromExtUri(this.prefix,_21be[0]);}var _21bf=node.getContent().start();if(_21bf&&_21bd){this._setContentParent(_21bf,_21bd,nm);}}},_setContentParent:function(node,_21c0,_21c1){if(node!==null&&_21c0!==null){var _21c2=com.ibm.mashups.enabler.model.url.ModelUrlFactory.createModelURL(com.ibm.mashups.enabler.model.url.ModelUrlFactory.FRAGMENT_URL,_21c1);_21c2.setNodes([{value:_21c0,isID:true}]);var thr=com.ibm.mashups.enabler.xml.XPath.evaluateXPath("thr:in-reply-to",node.getXml(),this.ns);if(!thr||thr.length===0){thr=com.ibm.mm.enabler.utils.Utils.createNode("thr:in-reply-to",this.ns.thr);node.getXml().appendChild(thr);}else{thr=thr[0];}this._setAttributeWithNS(node.xmlData.ownerDocument,thr,"ext:uri","uri",this.ns.ext,_21c2.getModelURI());thr.setAttribute("ref",_21c2.getModelURI());thr.setAttribute("href",_21c2.getAbsoluteURL());}},commit_after:function(nm){if(nm._portal_createdNodes!=null){for(var _21c3 in nm._portal_createdNodes){var node=nm._portal_createdNodes[_21c3];nm.invalidate(node);}nm._portal_createdNodes=[];}},_setAttributeWithNS:function(dom,_21c4,_21c5,_21c6,nsUri,value){if(dojo.isIE){var _21c7=dom.createNode(2,_21c5,nsUri);_21c7.nodeValue=value;_21c4.setAttributeNode(_21c7);}else{_21c4.setAttributeNS(nsUri,_21c5,value);}}});com.ibm.mm.extension.model.NavigationModel=new com.ibm.mm.extension.model.NavigationModelImpl();ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.NavigationModel.create":{type:"after",handler:function(_21c8,args){com.ibm.mm.extension.model.NavigationModel.create(this,_21c8,args[0]);if(args[0].pageTemplate){var cn=_21c8.getContent().start();var node=null;var entry=com.ibm.mm.enabler.utils.Utils.createNode("atom:entry",cn.ns.atom);entry.appendChild(com.ibm.mm.enabler.utils.Utils.createNode("atom:id",cn.ns.atom));var _21c9=com.ibm.mm.enabler.utils.Utils.createNode("atom:content",cn.ns.atom);var _21ca=com.ibm.mm.enabler.utils.Utils.createNode("model:content-page",cn.ns.model);com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_21ca,"creation-context:copy",cn.ns["creation-context"],args[0].pageTemplate);if(args[0]["private"]===true){com.ibm.mm.enabler.utils.Utils.setAttributeWithNS(_21ca,"creation-context:private",cn.ns["creation-context"],"true");}_21c9.appendChild(_21ca);entry.appendChild(_21c9);node=com.ibm.mm.enabler.content.ContentNodeFactory.createContentNode(entry,this);var _21cb=node.getXml();cn.setXml(_21cb,true);}return _21c8;}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.NavigationModel.remove":{type:"around",handler:function(_21cc,args){return com.ibm.mm.extension.model.NavigationModel.remove(_21cc,this,args);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.NavigationModel.insert":{type:"after",handler:function(_21cd,args){com.ibm.mm.extension.model.NavigationModel.insert(this,args[0],args[1]);return _21cd;}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.NavigationModel.commit":{type:"after",handler:function(dfr,args){var _21ce=this;dfr.start=function(sync){var mode=(sync||typeof (sync)=="undefined")?true:false;dojo.hitch(this.context,this.startfn)(this,mode,this.params);com.ibm.mm.extension.model.NavigationModel.commit_after(_21ce);};return dfr;}}});dojo.declare("com.ibm.mm.extension.model.LayoutModelImpl",null,{constructor:function(){this.ns={"app":"http://www.w3.org/2007/app","atom":"http://www.w3.org/2005/Atom","base":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0/ibm-portal-composite-base","creation-context":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.1.0/portal-creation-context","ext":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model","model":"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.1/portal-model-elements","opensearch":"http://a9.com/-/spec/opensearch/1.1/","thr":"http://purl.org/syndication/thread/1.0","xhtml":"http://www.w3.org/1999/xhtml","xml":"http://www.w3.org/XML/1998/namespace"};},create:function(nm,node,_21cf){if(node!=null&&(!_21cf||!_21cf.template)){node.setMetaData("com.ibm.portal.content.mashuppage","true");}},confirmRemove:function(nm,func,node){if(nm.isDeletable(node)){return nm.navigationNode.hasRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER);}return false;},confirmInsert:function(lm,func,args){var node=args[0];var _21d0=args[1];var next=args[2];var _21d1=true;if(com.ibm.mm.enabler.utils.Misc.isInstanceOf(node,com.ibm.mashups.enabler.Transformable)){var _21d2=_21d0.getXml();_21d1=_21d1&&com.ibm.mashups.enabler.xml.XPath.evaluateBoolean("atom:content/model:layout-container",_21d2,this.ns);}if(_21d1){_21d1=_21d1&&(node.getID()!=_21d0.getID());}if(_21d1){_21d1=_21d1&&(lm.navigationNode.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR)||lm.navigationNode.hasRole(com.ibm.mashups.enabler.ac.RoleType.PRIVILEGED_USER));}if(_21d1){_21d1=_21d1&&lm.isModifiable(node)&&lm.isModifiable(_21d0);}return _21d1;}});com.ibm.mm.extension.model.LayoutModel=new com.ibm.mm.extension.model.LayoutModelImpl();ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.LayoutModel.create":{type:"after",handler:function(_21d3,args){com.ibm.mm.extension.model.LayoutModel.create(this,_21d3,args[0]);return _21d3;}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.LayoutModel.confirmRemove":{type:"around",handler:function(func,args){return com.ibm.mm.extension.model.LayoutModel.confirmRemove(this,func,args[0]);}}});ibmConfig.extensions.push({"com.ibm.mashups.enabler.model.LayoutModel.confirmInsert":{type:"around",handler:function(func,args){return com.ibm.mm.extension.model.LayoutModel.confirmInsert(this,func,args);}}});(function(){var ns,_21d4=com.ibm.mm.enabler.layout.LayoutControlImpl.prototype.setXml,getNS=function(){if(!ns){var _21d5=com.ibm.mm.enabler.model.ServiceDocumentModel.getCollectionData(com.ibm.mm.enabler.model.ServiceDocumentModel.SERVICE_CONTENT);ns=dojo.delegate(_21d5.namespaces,com.ibm.mm.enabler.model.NameSpaceFactory.getNameSpaces([com.ibm.mm.enabler.model.NameSpaceFactory.NS_ATOM]));}return ns;};dojo.extend(com.ibm.mm.enabler.layout.LayoutControlImpl,{setXml:function(xml){var xp="atom:content/*/model:*[local-name() = 'templateName' or local-name() = 'containerChild' or local-name() = 'controlChild']";var nodes=com.ibm.mashups.enabler.xml.XPath.evaluateXPath(xp,xml,getNS());if(nodes&&nodes.length>0){dojo.forEach(nodes,dojo.destroy);}_21d4.apply(this,arguments);}});})();(function(){var _21d6=com.ibm.mashups.enabler.ac.operation,_21d7=_21d6.Constants,_21d8=_21d6.AllowedOperationsModelFactory.getAllowedOperationsModel();dojo.mixin(_21d7,{EDIT_LAYOUT:"com.ibm.mashups.enabler.ac.operation.EditLayout",EDIT_PROPERTIES:"com.ibm.mashups.enabler.ac.operation.EditPageProperties",ASSIGN_ROLES:"com.ibm.mashups.enabler.ac.operation.AssignRoles",VIEW:"com.ibm.mashups.enabler.ac.operation.view",EDIT:"com.ibm.mashups.enabler.ac.operation.edit",EDIT_DEFAULTS:"com.ibm.mashups.enabler.ac.operation.edit_defaults",CONFIG:"com.ibm.mashups.enabler.ac.operation.config",HELP:"com.ibm.mashups.enabler.ac.operation.help"});var _21d9=function(_21da,_21db){_21d8.setOperation(_21da,function(_21dc,_21dd,sync,_21de){var _21df=_21dd.contentNode.getID();new com.ibm.pb.extension.contextmenu.ContextMenuAcOperation(_21df,ibmPortalConfig.contentHandlerURI+"wp.operations/page:oid:"+_21df,sync,_21db,_21de);});},_21e0=function(_21e1,_21e2){_21d8.setOperation(_21e1,function(_21e3,_21e4,sync,_21e5){var _21e6=_21e4.contentNode.getID();new com.ibm.pb.extension.contextmenu.ContextMenuAcOperation(_21e4.id,ibmPortalConfig.contentHandlerURI+"wp.operations/portlet:oid:"+_21e4.id+"@oid:"+_21e6,sync,_21e2,_21e5);});},_21e7=[[_21d7.EDIT_LAYOUT,"EditLayout"],[_21d7.EDIT_PROPERTIES,"EditPageProperties"],[_21d7.ASSIGN_ROLES,"AssignRoles"]],_21e8=[[_21d7.VIEW,"view"],[_21d7.EDIT,"edit"],[_21d7.EDIT_DEFAULTS,"edit_defaults"],[_21d7.CONFIG,"config"],[_21d7.HELP,"help"]],i=0;for(i=0;i<_21e7.length;i++){_21d9(_21e7[i][0],_21e7[i][1]);}for(i=0;i<_21e8.length;i++){_21e0(_21e8[i][0],_21e8[i][1]);}})();dojo.declare("com.ibm.mm.extension.navigation.NavigationNodeFactoryImpl",null,{constructor:function(){this._NAVIGATION_NODE_TYPE_STATIC_PAGE="staticpage";this._NAVIGATION_NODE_TYPE_EXTERNAL_URL="externalurl";this._NAVIGATION_NODE_TYPE_INTERNAL_URL="internalurl";},createNavigationNode:function(_21e9,nnFac,args){var _21ea=args[0];var _21eb;nnFac._lazyInit();var expr="atom:link[@ext:class='content-node']";var _21ec=com.ibm.mashups.enabler.xml.XPath.evaluateEntry(expr,_21ea,nnFac.ns);var type=_21ec?com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_21ec,"ext:rel","rel",nnFac.ns.ext):null;switch(type){case nnFac._NAVIGATION_NODE_TYPE_PAGE:var _21ed=com.ibm.mm.enabler.utils.Dom.getAttributeWithNS(_21ec,"ext:user-own","user-own",nnFac.ns.ext);if(_21ed=="false"){_21eb=new com.ibm.mm.enabler.navigation.SharedNavigationNodeImpl();}else{_21eb=new com.ibm.mm.enabler.navigation.NavigationNodeImpl();}break;case nnFac._NAVIGATION_NODE_TYPE_LABEL:_21eb=new com.ibm.mm.enabler.navigation.NavigationLabelImpl();break;case nnFac._NAVIGATION_NODE_TYPE_URL:_21eb=new com.ibm.mm.enabler.navigation.NavigationURLImpl();break;case this._NAVIGATION_NODE_TYPE_EXTERNAL_URL:_21eb=new com.ibm.mm.enabler.navigation.NavigationURLImpl();break;default:_21eb=new com.ibm.mm.enabler.navigation.NavigationNodeImpl();break;}_21eb.setXml(_21ea,true);return _21eb;}});com_ibm_mm_extension_navigation_NavigationNodeFactory=new com.ibm.mm.extension.navigation.NavigationNodeFactoryImpl();ibmConfig.extensions.push({"com.ibm.mm.enabler.navigation.NavigationNodeFactory.createNavigationNode":{type:"around",handler:function(_21ee,args){return com_ibm_mm_extension_navigation_NavigationNodeFactory.createNavigationNode(_21ee,this,args);}}});(function(){var c=ibmConfig;if(c&&c.extensions&&c.extensions.length>0){var _21ef={},e=c.extensions;function forInLoop(obj,work){for(var prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){work(prop,obj[prop]);}}};for(var i=0;i<e.length;i++){forInLoop(e[i],function(name,value){_21ef[name]=value;});}var _21f0=c["mappingFunction"];var _21f1=new ExtensionRegistry(_21f0);_21f1.process(e);}})();if(!dojo._hasResource["com.ibm.pb.logging.FirebugLogger"]){dojo._hasResource["com.ibm.pb.logging.FirebugLogger"]=true;dojo.provide("com.ibm.pb.logging.FirebugLogger");if(window.console&&window.console.firebug&&window.ibmConfig&&ibmConfig.useFirebugLogger){var lvl=com.ibm.mashups.enabler.logging.LogLevel;var fbgLogger=dojo.declare("com.ibm.pb.logging.FirebugLogger",null,{methods:{},constructor:function(name,_21f2){this.name=name;this.parent=_21f2;this._loggers={};this._initConfig(ibmConfig&&ibmConfig.traceConfig);},_initConfig:function(_21f3){if(_21f3&&_21f3.length>0){this._test=new RegExp(dojo.isArray(_21f3)?_21f3.join("|"):_21f3);}else{this._test=null;}},_getTest:function(){if(!this._test&&this.parent){return this.parent._getTest();}return this._test;},getLogger:function(_21f4){if(this.parent){return this.parent.getLogger(_21f4);}if(!this._loggers[_21f4]){this._loggers[_21f4]=new this.constructor(_21f4,this);}return this._loggers[_21f4];},addHandler:function(_21f5){},removeHandler:function(_21f6){},entering:function(_21f7,args){var trc=lvl.TRACE;if(this.isLoggable(trc)){this.log(trc,_21f7,"ENTRY ${0}",[args]);}},exiting:function(_21f8,args){var trc=lvl.TRACE;if(this.isLoggable(trc)){this.log(trc,_21f8,"RETURN ${0}",[args]);}},info:function(_21f9,_21fa,args){this.log(lvl.INFO,_21f9,_21fa,args);},warning:function(_21fb,_21fc,args){this.log(lvl.WARNING,_21fb,_21fc,args);},severe:function(_21fd,_21fe,args){this.log(lvl.SEVERE,_21fd,_21fe,args);},trace:function(_21ff,_2200,args){this.log(lvl.TRACE,_21ff,_2200,args);},log:function(_2201,_2202,_2203,args){if(this.isLoggable(_2201)){var msg=this._firebugStyle(this.name+" "+_2202+" - "+_2203,args);console[this.methods[this._normalizeLevel(_2201)]].apply(window,msg);}},_firebugStyle:function(text,args){var _2204=[],msg=dojo.string.substitute(text,args,function(value,key){_2204.push(value);return dojo.isString(value)?"%s":"%o";});_2204.unshift(msg);return _2204;},_normalizeLevel:function(level){var _2205=lvl.SEVERE;if(level<=lvl.SEVERE){_2205=lvl.SEVERE;}if(level<=lvl.WARNING){_2205=lvl.WARNING;}if(level<=lvl.INFO){_2205=lvl.INFO;}if(level<=lvl.TRACE){_2205=lvl.TRACE;}return _2205;},isLoggable:function(_2206){if(_2206>lvl.TRACE){return true;}if(!(ibmConfig&&ibmConfig.isDebug)){return false;}var test=this._getTest();return test&&test.test(this.name);}});var methods=fbgLogger.prototype.methods;methods[lvl.INFO]="info";methods[lvl.WARNING]="warn";methods[lvl.SEVERE]="error";methods[lvl.TRACE]="debug";var baseFbgLogger=com.ibm.mashups.enabler.logging.Logger=new com.ibm.pb.logging.FirebugLogger();ibmConfig.extensions.push({"com.ibm.mashups.enabler.logging.Logger.getLogger":{type:"around",handler:function(func,args){return baseFbgLogger.getLogger.apply(baseFbgLogger,args);}}});}}if(!dojo._hasResource["com.ibm.pb.debug.liveTracing"]){dojo._hasResource["com.ibm.pb.debug.liveTracing"]=true;dojo.provide("com.ibm.pb.debug.liveTracing");(function(){arrayToString=function(arr){var str="";while(arr.length>0){str+="'"+arr.shift()+"'";if(arr.length>0){str+=",";}}return str;};var _2207=com.ibm.pb.debug.liveTracing={traceConfigCookieName:"digest.ignore.debug.traceString",useFirebugLoggerCookieName:"digest.ignore.debug.useFirebugLogger",setTracing:function(_2208,_2209){if(_2208){if(dojo.isString(_2208)){var parts=_2208.split(",");_2208=arrayToString(parts);}else{if(dojo.isArray(_2208)){_2208=arrayToString(_2208);}}dojo.cookie(_2207.traceConfigCookieName,"["+_2208+"]",{path:"/"});}if(_2209!==undefined){dojo.cookie(_2207.useFirebugLoggerCookieName,_2209==true,{path:"/"});}},clearTracing:function(){dojo.cookie(_2207.traceConfigCookieName,null,{path:"/",expires:-1});},showEffectiveTracing:function(){alert(ibmConfig.traceConfig);},showConfiguredTracing:function(){alert(dojo.cookie(_2207.traceConfigCookieName));}};})();}if(!dojo._hasResource["com.ibm.pb.io.ResourceCache"]){dojo._hasResource["com.ibm.pb.io.ResourceCache"]=true;dojo.provide("com.ibm.pb.io.ResourceCache");dojo.declare("com.ibm.pb.io.ResourceCache",null,{_mpExp:/mashup:huffman/,PLUGIN_ID:"com.ibm.pb.io.ResourceCache",DYNRES:com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.io.DynamicResolver.SERVICE_NAME),constructor:function(){this._cacheKeys=[];this._cache={};},_matcher:function(url){url=url?url.toString():"";var exp=new RegExp(this._cacheKeys.join("|")),m;url=url.replace(/\/(?:\/)+/,"/");if(!url.match(this._mpExp)){return ((m=url.match(exp))?m[0]:false);}return false;},set:function(key,val){if(!key){return;}if(!this._cache[key]){if(this._cacheKeys.length===0){var me=this;this.DYNRES.register(this.PLUGIN_ID,function(url){return me._matcher(url);},function(url,_220a){return me.get(_220a);});}this._cacheKeys.push(key);}if(!val){for(var i=0;i<this._cacheKeys.length;i++){if(this._cacheKeys[i]===key){this._cacheKeys.splice(i,1);break;}}if(this._cacheKeys.length===0){this.DYNRES.unregister(this.PLUGIN_ID);}}this._cache[key]=val;},get:function(key){return this._cache[key];}});com.ibm.pb.io.RESOURCE_CACHE=new com.ibm.pb.io.ResourceCache();}if(!dojo._hasResource["dijit.form.TextBox"]){dojo._hasResource["dijit.form.TextBox"]=true;dojo.provide("dijit.form.TextBox");dojo.declare("dijit.form.TextBox",dijit.form._FormValueWidget,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,templateString:dojo.cache("dijit.form","templates/TextBox.html","<input class=\"dijit dijitReset dijitLeft\" dojoAttachPoint='textbox,focusNode'\n\tdojoAttachEvent='onmouseenter:_onMouse,onmouseleave:_onMouse'\n\tautocomplete=\"off\" type=\"${type}\" ${nameAttrSetting}\n\t/>\n"),baseClass:"dijitTextBox",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{maxLength:"focusNode"}),_getValueAttr:function(){return this.parse(this.attr("displayedValue"),this.constraints);},_setValueAttr:function(value,_220b,_220c){var _220d;if(value!==undefined){_220d=this.filter(value);if(typeof _220c!="string"){if(_220d!==null&&((typeof _220d!="number")||!isNaN(_220d))){_220c=this.filter(this.format(_220d,this.constraints));}else{_220c="";}}}if(_220c!=null&&_220c!=undefined&&((typeof _220c)!="number"||!isNaN(_220c))&&this.textbox.value!=_220c){this.textbox.value=_220c;}this.inherited(arguments,[_220d,_220b]);},displayedValue:"",getDisplayedValue:function(){dojo.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use attr('displayedValue') instead.","","2.0");return this.attr("displayedValue");},_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},setDisplayedValue:function(value){dojo.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use attr('displayedValue', ...) instead.","","2.0");this.attr("displayedValue",value);},_setDisplayedValueAttr:function(value){if(value===null||value===undefined){value="";}else{if(typeof value!="string"){value=String(value);}}this.textbox.value=value;this._setValueAttr(this.attr("value"),undefined,value);},format:function(value,_220e){return ((value==null||value==undefined)?"":(value.toString?value.toString():value));},parse:function(value,_220f){return value;},_refreshState:function(){},_onInput:function(e){if(e&&e.type&&/key/i.test(e.type)&&e.keyCode){switch(e.keyCode){case dojo.keys.SHIFT:case dojo.keys.ALT:case dojo.keys.CTRL:case dojo.keys.TAB:return;}}if(this.intermediateChanges){var _2210=this;setTimeout(function(){_2210._handleOnChange(_2210.attr("value"),false);},0);}this._refreshState();},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);if(dojo.isMoz||dojo.isOpera){this.connect(this.textbox,"oninput",this._onInput);}else{this.connect(this.textbox,"onkeydown",this._onInput);this.connect(this.textbox,"onkeyup",this._onInput);this.connect(this.textbox,"onpaste",this._onInput);this.connect(this.textbox,"oncut",this._onInput);}},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=dojo.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(word){return word.substring(0,1).toUpperCase()+word.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.attr("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);if(this._selectOnClickHandle){this.disconnect(this._selectOnClickHandle);}if(this.selectOnClick&&dojo.isMoz){this.textbox.selectionStart=this.textbox.selectionEnd=undefined;}},_onFocus:function(by){if(this.disabled||this.readOnly){return;}if(this.selectOnClick&&by=="mouse"){this._selectOnClickHandle=this.connect(this.domNode,"onmouseup",function(){this.disconnect(this._selectOnClickHandle);var _2211;if(dojo.isIE){var range=dojo.doc.selection.createRange();var _2212=range.parentElement();_2211=_2212==this.textbox&&range.text.length==0;}else{_2211=this.textbox.selectionStart==this.textbox.selectionEnd;}if(_2211){dijit.selectInputText(this.textbox);}});}this._refreshState();this.inherited(arguments);},reset:function(){this.textbox.value="";this.inherited(arguments);}});dijit.selectInputText=function(_2213,start,stop){var _2214=dojo.global;var _2215=dojo.doc;_2213=dojo.byId(_2213);if(isNaN(start)){start=0;}if(isNaN(stop)){stop=_2213.value?_2213.value.length:0;}dijit.focus(_2213);if(_2215["selection"]&&dojo.body()["createTextRange"]){if(_2213.createTextRange){var range=_2213.createTextRange();with(range){collapse(true);moveStart("character",-99999);moveStart("character",start);moveEnd("character",stop-start);select();}}}else{if(_2214["getSelection"]){if(_2213.setSelectionRange){_2213.setSelectionRange(start,stop);}}}};}if(!dojo._hasResource["dijit.InlineEditBox"]){dojo._hasResource["dijit.InlineEditBox"]=true;dojo.provide("dijit.InlineEditBox");dojo.declare("dijit.InlineEditBox",dijit._Widget,{editing:false,autoSave:true,buttonSave:"",buttonCancel:"",renderAsHtml:false,editor:"dijit.form.TextBox",editorWrapper:"dijit._InlineEditor",editorParams:{},onChange:function(value){},onCancel:function(){},width:"100%",value:"",noValueIndicator:"<span style='font-family: wingdings; text-decoration: underline;'>&nbsp;&nbsp;&nbsp;&nbsp;&#x270d;&nbsp;&nbsp;&nbsp;&nbsp;</span>",constructor:function(){this.editorParams={};},postMixInProperties:function(){this.inherited(arguments);this.displayNode=this.srcNodeRef;var _2216={ondijitclick:"_onClick",onmouseover:"_onMouseOver",onmouseout:"_onMouseOut",onfocus:"_onMouseOver",onblur:"_onMouseOut"};for(var name in _2216){this.connect(this.displayNode,name,_2216[name]);}dijit.setWaiRole(this.displayNode,"button");if(!this.displayNode.getAttribute("tabIndex")){this.displayNode.setAttribute("tabIndex",0);}this.attr("value",this.value||this.displayNode.innerHTML);},setDisabled:function(_2217){dojo.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use attr('disabled', bool) instead.","","2.0");this.attr("disabled",_2217);},_setDisabledAttr:function(_2218){this.disabled=_2218;dijit.setWaiState(this.domNode,"disabled",_2218);if(_2218){this.displayNode.removeAttribute("tabIndex");}else{this.displayNode.setAttribute("tabIndex",0);}},_onMouseOver:function(){dojo.addClass(this.displayNode,this.disabled?"dijitDisabledClickableRegion":"dijitClickableRegion");},_onMouseOut:function(){dojo.removeClass(this.displayNode,this.disabled?"dijitDisabledClickableRegion":"dijitClickableRegion");},_onClick:function(e){if(this.disabled){return;}if(e){dojo.stopEvent(e);}this._onMouseOut();setTimeout(dojo.hitch(this,"edit"),0);},edit:function(){if(this.disabled||this.editing){return;}this.editing=true;this._savedPosition=dojo.style(this.displayNode,"position")||"static";this._savedOpacity=dojo.style(this.displayNode,"opacity")||"1";this._savedTabIndex=dojo.attr(this.displayNode,"tabIndex")||"0";if(this.wrapperWidget){this.wrapperWidget.editWidget.attr("displayedValue" in this.editorParams?"displayedValue":"value",this.value);}else{var _2219=dojo.create("span",null,this.domNode,"before");var ewc=dojo.getObject(this.editorWrapper);this.wrapperWidget=new ewc({value:this.value,buttonSave:this.buttonSave,buttonCancel:this.buttonCancel,tabIndex:this._savedTabIndex,editor:this.editor,inlineEditBox:this,sourceStyle:dojo.getComputedStyle(this.displayNode),save:dojo.hitch(this,"save"),cancel:dojo.hitch(this,"cancel")},_2219);}var ww=this.wrapperWidget;dojo.style(this.displayNode,{position:"absolute",opacity:"0"});dojo.style(ww.domNode,{position:this._savedPosition,visibility:"visible",opacity:"1"});dojo.attr(this.displayNode,"tabIndex","-1");setTimeout(dojo.hitch(ww,function(){this.focus();this._resetValue=this.getValue();}),0);},_onBlur:function(){this.inherited(arguments);if(!this.editing){setTimeout(dojo.hitch(this,function(){if(this.wrapperWidget){this.wrapperWidget.destroy();delete this.wrapperWidget;}}),0);}},_showText:function(focus){var ww=this.wrapperWidget;dojo.style(ww.domNode,{position:"absolute",visibility:"hidden",opacity:"0"});dojo.style(this.displayNode,{position:this._savedPosition,opacity:this._savedOpacity});dojo.attr(this.displayNode,"tabIndex",this._savedTabIndex);if(focus){dijit.focus(this.displayNode);}},save:function(focus){if(this.disabled||!this.editing){return;}this.editing=false;var ww=this.wrapperWidget;var value=ww.getValue();this.attr("value",value);setTimeout(dojo.hitch(this,"onChange",value),0);this._showText(focus);},setValue:function(val){dojo.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use attr('value', ...) instead.","","2.0");return this.attr("value",val);},_setValueAttr:function(val){this.value=val=dojo.trim(val);if(!this.renderAsHtml){val=val.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/\n/g,"<br>");}this.displayNode.innerHTML=val||this.noValueIndicator;},getValue:function(){dojo.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use attr('value') instead.","","2.0");return this.attr("value");},cancel:function(focus){if(this.disabled||!this.editing){return;}this.editing=false;setTimeout(dojo.hitch(this,"onCancel"),0);this._showText(focus);}});dojo.declare("dijit._InlineEditor",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("dijit","templates/InlineEditBox.html","<span dojoAttachPoint=\"editNode\" waiRole=\"presentation\" style=\"position: absolute; visibility:hidden\" class=\"dijitReset dijitInline\"\n\tdojoAttachEvent=\"onkeypress: _onKeyPress\"\n\t><span dojoAttachPoint=\"editorPlaceholder\"></span\n\t><span dojoAttachPoint=\"buttonContainer\"\n\t\t><button class='saveButton' dojoAttachPoint=\"saveButton\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:save\" label=\"${buttonSave}\"></button\n\t\t><button class='cancelButton' dojoAttachPoint=\"cancelButton\" dojoType=\"dijit.form.Button\" dojoAttachEvent=\"onClick:cancel\" label=\"${buttonCancel}\"></button\n\t></span\n></span>\n"),widgetsInTemplate:true,postMixInProperties:function(){this.inherited(arguments);this.messages=dojo.i18n.getLocalization("dijit","common",this.lang);dojo.forEach(["buttonSave","buttonCancel"],function(prop){if(!this[prop]){this[prop]=this.messages[prop];}},this);},postCreate:function(){var cls=dojo.getObject(this.editor);var _221a=this.sourceStyle;var _221b="line-height:"+_221a.lineHeight+";";dojo.forEach(["Weight","Family","Size","Style"],function(prop){_221b+="font-"+prop+":"+_221a["font"+prop]+";";},this);dojo.forEach(["marginTop","marginBottom","marginLeft","marginRight"],function(prop){this.domNode.style[prop]=_221a[prop];},this);var width=this.inlineEditBox.width;if(width=="100%"){_221b+="width:100%;";this.domNode.style.display="block";}else{_221b+="width:"+(width+(Number(width)==width?"px":""))+";";}var _221c=this.inlineEditBox.editorParams;_221c.style=_221b;_221c["displayedValue" in cls.prototype?"displayedValue":"value"]=this.value;var ew=this.editWidget=new cls(_221c,this.editorPlaceholder);if(this.inlineEditBox.autoSave){this.buttonContainer.style.display="none";this.connect(ew,"onChange","_onChange");this.connect(ew,"onKeyPress","_onKeyPress");}else{if("intermediateChanges" in cls.prototype){ew.attr("intermediateChanges",true);this.connect(ew,"onChange","_onIntermediateChange");this.saveButton.attr("disabled",true);}}},_onIntermediateChange:function(val){this.saveButton.attr("disabled",(this.getValue()==this._resetValue)||!this.enableSave());},destroy:function(){this.editWidget.destroy(true);this.inherited(arguments);},getValue:function(){var ew=this.editWidget;return String(ew.attr("displayedValue" in ew?"displayedValue":"value"));},_onKeyPress:function(e){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(e.altKey||e.ctrlKey){return;}if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);this.cancel(true);}else{if(e.charOrCode==dojo.keys.ENTER&&e.target.tagName=="INPUT"){dojo.stopEvent(e);this._onChange();}}}},_onBlur:function(){this.inherited(arguments);if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){if(this.getValue()==this._resetValue){this.cancel(false);}else{if(this.enableSave()){this.save(false);}}}},_onChange:function(){if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&this.enableSave()){dijit.focus(this.inlineEditBox.displayNode);}},enableSave:function(){return (this.editWidget.isValid?this.editWidget.isValid():true);},focus:function(){this.editWidget.focus();setTimeout(dojo.hitch(this,function(){if(this.editWidget.focusNode.tagName=="INPUT"){dijit.selectInputText(this.editWidget.focusNode);}}),0);}});}if(!dojo._hasResource["dijit.form.Form"]){dojo._hasResource["dijit.form.Form"]=true;dojo.provide("dijit.form.Form");dojo.declare("dijit.form.Form",[dijit._Widget,dijit._Templated,dijit.form._FormMixin],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"<form dojoAttachPoint='containerNode' dojoAttachEvent='onreset:_onReset,onsubmit:_onSubmit' ${nameAttrSetting}></form>",attributeMap:dojo.delegate(dijit._Widget.prototype.attributeMap,{action:"",method:"",encType:"","accept-charset":"",accept:"",target:""}),postMixInProperties:function(){this.nameAttrSetting=this.name?("name='"+this.name+"'"):"";this.inherited(arguments);},execute:function(_221d){},onExecute:function(){},_setEncTypeAttr:function(value){this.encType=value;dojo.attr(this.domNode,"encType",value);if(dojo.isIE){this.domNode.encoding=value;}},postCreate:function(){if(dojo.isIE&&this.srcNodeRef&&this.srcNodeRef.attributes){var item=this.srcNodeRef.attributes.getNamedItem("encType");if(item&&!item.specified&&(typeof item.value=="string")){this.attr("encType",item.value);}}this.inherited(arguments);},onReset:function(e){return true;},_onReset:function(e){var faux={returnValue:true,preventDefault:function(){this.returnValue=false;},stopPropagation:function(){},currentTarget:e.currentTarget,target:e.target};if(!(this.onReset(faux)===false)&&faux.returnValue){this.reset();}dojo.stopEvent(e);return false;},_onSubmit:function(e){var fp=dijit.form.Form.prototype;if(this.execute!=fp.execute||this.onExecute!=fp.onExecute){dojo.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0");this.onExecute();this.execute(this.getValues());}if(this.onSubmit(e)===false){dojo.stopEvent(e);}},onSubmit:function(e){return this.isValid();},submit:function(){if(!(this.onSubmit()===false)){this.containerNode.submit();}}});}if(!dojo._hasResource["dijit.form.CheckBox"]){dojo._hasResource["dijit.form.CheckBox"]=true;dojo.provide("dijit.form.CheckBox");dojo.declare("dijit.form.CheckBox",dijit.form.ToggleButton,{templateString:dojo.cache("dijit.form","templates/CheckBox.html","<div class=\"dijitReset dijitInline\" waiRole=\"presentation\"\n\t><input\n\t \t${nameAttrSetting} type=\"${type}\" ${checkedAttrSetting}\n\t\tclass=\"dijitReset dijitCheckBoxInput\"\n\t\tdojoAttachPoint=\"focusNode\"\n\t \tdojoAttachEvent=\"onmouseover:_onMouse,onmouseout:_onMouse,onclick:_onClick\"\n/></div>\n"),baseClass:"dijitCheckBox",type:"checkbox",value:"on",readOnly:false,attributeMap:dojo.delegate(dijit.form.ToggleButton.prototype.attributeMap,{readOnly:"focusNode"}),_setReadOnlyAttr:function(value){this.readOnly=value;dojo.attr(this.focusNode,"readOnly",value);dijit.setWaiState(this.focusNode,"readonly",value);this._setStateClass();},_setValueAttr:function(_221e){if(typeof _221e=="string"){this.value=_221e;dojo.attr(this.focusNode,"value",_221e);_221e=true;}if(this._created){this.attr("checked",_221e);}},_getValueAttr:function(){return (this.checked?this.value:false);},postMixInProperties:function(){if(this.value==""){this.value="on";}this.checkedAttrSetting=this.checked?"checked":"";this.inherited(arguments);},_fillContent:function(_221f){},reset:function(){this._hasBeenBlurred=false;this.attr("checked",this.params.checked||false);this.value=this.params.value||"on";dojo.attr(this.focusNode,"value",this.value);},_onFocus:function(){if(this.id){dojo.query("label[for='"+this.id+"']").addClass("dijitFocusedLabel");}},_onBlur:function(){if(this.id){dojo.query("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");}},_onClick:function(e){if(this.readOnly){dojo.stopEvent(e);return false;}return this.inherited(arguments);}});dojo.declare("dijit.form.RadioButton",dijit.form.CheckBox,{type:"radio",baseClass:"dijitRadio",_setCheckedAttr:function(value){this.inherited(arguments);if(!this._created){return;}if(value){var _2220=this;dojo.query("INPUT[type=radio]",this.focusNode.form||dojo.doc).forEach(function(_2221){if(_2221.name==_2220.name&&_2221!=_2220.focusNode&&_2221.form==_2220.focusNode.form){var _2222=dijit.getEnclosingWidget(_2221);if(_2222&&_2222.checked){_2222.attr("checked",false);}}});}},_clicked:function(e){if(!this.checked){this.attr("checked",true);}}});}if(!dojo._hasResource["com.ibm.widgets.InlineEditorWrapper"]){dojo._hasResource["com.ibm.widgets.InlineEditorWrapper"]=true;dojo.provide("com.ibm.widgets.InlineEditorWrapper");dojo.declare("com.ibm.widgets.InlineEditorWrapper",null,{embeddedEditorWidget:"dijit.form.TextBox",embeddedEditorParams:{},popupWidget:"com.ibm.widgets.InlineEditorPopup",popupParams:{},postMixInProperties:function(){this.inherited(arguments);this.popupParams=dojo.mixin({},this.popupParams);},postCreate:function(){this.inherited(arguments);if(!this._supportingWidgets){this._supportingWidgets=[];}this._supportingWidgets.push(this.editor=new com.ibm.widgets.WrappedInlineEditBox({value:this.label,title:this.title,editor:this.embeddedEditorWidget,editorParams:this.embeddedEditorParams,canExit:dojo.hitch(this,function(){if(this.popupFocused||(this.editorFocused&&!this.editor._wantsFocus)){this.editor.editWidget._exitInProgress=false;return false;}return true;}),saveIsValid:function(){if(this.disabled||!this.editing||me.popupFocused||(this.editWidget.editWidget&&this.editWidget.editWidget.validate&&!this.editWidget.editWidget.validate())){this.editWidget._exitInProgress=false;return false;}return true;}},this.editor));var _2223=this.editor.save;var me=this;var _2224=dojo.hitch(this.editor,this.editor.edit);this.editor.edit=dojo.hitch(this,function(){this.editor.attr("value",this.defaultValue);_2224();if(this.editorPopup){this.editorPopup.attr("value",this.popupDefaultValue);dijit.popup.open({parent:this,popup:this.editorPopup,around:this.domNode,onCancel:dojo.hitch(this,this.editor.cancel),onClose:function(){}});}});this.connect(this.editor,"onChange","_onChange");this.connect(this.editor,"onCancel","_onCancel");this.connect(this.editor,"edit","onEdit");},_getPopup:function(){if(this.editorPopup){return this.editorPopup;}if(!this.popupWidget){return null;}var cls=dojo.getObject(this.popupWidget);if(cls){this.editorPopup=new cls(this.popupParams);dijit.popup.prepare(this.editorPopup.domNode);this.editorPopup.startup();this.popupDefaultValue=this.editorPopup.attr("value");this.connect(this.editorPopup,"onFocus",function(){this.popupFocused=true;this.editorFocused=false;});this.connect(this.editorPopup,"onBlur",function(){this.popupFocused=false;setTimeout(dojo.hitch(this,function(){if(!this.editorFocused&&this.editor.editWidget){this.editor.editWidget._onBlur();}}),50);});this.connect(this.editor,"onFocus",function(){this.editorFocused=true;this.popupFocused=false;});this.connect(this.editor,"onBlur",function(){this.editorFocused=false;});return this.editorPopup;}return null;},startup:function(){this.editor.startup();},isEditing:function(){return this.editor&&this.editor.editing;},_onChange:function(value){this.editor.attr("value",this.label);var _2225={label:value};if(this.editorPopup){_2225=dojo.mixin(this.editorPopup.attr("value"),_2225);dijit.popup.close(this.editorPopup);}this.onChange(_2225,this.editor._wantsFocus);},onChange:function(value,focus){},_onCancel:function(){this.editor.attr("value",this.label);if(this.editorPopup){dijit.popup.close(this.editorPopup);}this.onCancel(this.editor._wantsFocus);},onCancel:function(focus){},onEdit:function(){}});dojo.declare("com.ibm.widgets.WrappedInlineEditBox",dijit.InlineEditBox,{waitTime:50,_wantsFocus:false,constructor:function(){this._connections=[];},canExit:function(){return true;},waitToExit:function(fname,_2226){setTimeout(dojo.hitch(this,function(){if(this.canExit()&&this[fname+"IsValid"]()){dijit.InlineEditBox.prototype[fname].apply(this,_2226);this._wantsFocus=false;}}),this.waitTime);},saveIsValid:function(){return true;},cancelIsValid:function(){return true;},save:function(focus){this._wantsFocus=focus;this.waitToExit("save",arguments);},cancel:function(focus){this._wantsFocus=focus;this.waitToExit("cancel",arguments);},edit:function(){this.inherited(arguments);this._wantsFocus=false;var ew=this.editWidget;this._connections.push(dojo.connect(ew,"focus",this,"onFocus"));this._connections.push(dojo.connect(ew.editWidget,"onFocus",this,"onFocus"));this._connections.push(dojo.connect(ew,"onBlur",this,"onBlur"));var _2227=dojo.connect(ew.editWidget,"destroy",this,function(){dojo.forEach(this._connections,dojo.disconnect);dojo.disconnect(_2227);});}});dojo.declare("com.ibm.widgets.InlineEditorPopup",dijit.layout.ContentPane,{"class":"inlineEditorPopup",content:"<form dojoType=\"dijit.form.Form\" encType=\"multipart/form-data\" action=\"\" method=\"POST\" onSubmit=\"return false;\" onReset=\"return false;\">"+"<input name=\"isPrivate\" checked=\"checked\" dojoType=\"dijit.form.CheckBox\">"+"<label for=\"isPrivate\">Make this my private page</label>"+"</form>",onFocus:function(){},_getValueAttr:function(){var _2228=dojo.query("> [widgetId]",this.containerNode).map(dijit.byNode);if(_2228.length>0){return _2228[0].attr("value");}return null;},_setValueAttr:function(value){var _2229=dojo.query("> [widgetId]",this.containerNode).map(dijit.byNode);if(_2229.length>0){_2229[0].attr("value",value);}}});}if(!dojo._hasResource["com.ibm.widgets.TabBar"]){dojo._hasResource["com.ibm.widgets.TabBar"]=true;dojo.provide("com.ibm.widgets.TabBar");dojo.declare("com.ibm.widgets.TabBar",[dijit._Widget,dijit._Templated,dijit._KeyNavContainer],{"class":"lotusTabContainer",tabListClass:"lotusTabs",tabClass:"lotusTab",tabWidget:"com.ibm.widgets.Tab",tabStrip:false,skipPreload:false,tabIndex:"0",templateString:"<div tabIndex=\"${tabIndex}\" class=\"${class}\" waiRole=\"navigation\" dojoAttachPoint=\"focusNode\">"+"<ul class=\"${tabListClass}\" waiRole=\"tablist\" dojoAttachPoint=\"containerNode,tabList\" dojoAttachEvent=\"onkeypress:_onKeyPress\"></ul>"+"</div>",attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{tabListClass:{node:"containerNode",type:"class"}}),_setClassAttr:function(value){this["class"]=value;this.domNode.className=value;},postCreate:function(){this.inherited(arguments);if(this.tabStrip){dojo.addClass(this.tabList,this["class"]+"Strip");}var ltr=this.isLeftToRight(),k=dojo.keys;this.connectKeyNavHandlers(ltr?[k.LEFT_ARROW]:[k.RIGHT_ARROW],ltr?[k.RIGHT_ARROW]:[k.LEFT_ARROW]);},startup:function(){this.startupKeyNavChildren();this.inherited(arguments);},_fillContent:function(_222a){var dest=this.containerNode;if(_222a&&dest){var nodes=dojo.query("> ul",_222a);if(nodes.length>0){this.preloaded=!this.skipPreload;this.tabListClass=nodes[0].className;this.containerNode.className=this.tabListClass;_222a=nodes[0];}}return this.inherited(arguments);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}if(evt.charOrCode==dojo.keys.DOWN_ARROW){this._moveToPopup(evt);dojo.stopEvent(evt);}},_onNodeBlur:function(evt){this._startCloseTimer();this.inherited(arguments);},_onChildBlur:function(item){if(item.popup){dijit.popup.close(item.popup);}item._blur();},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this._openPopup(this.focusedChild,true);}},_moveToNextPopup:function(){this.focusNext();},_openPopup:function(item,focus){var popup=item.popup;if(!popup){return false;}if(this.currentPopup==popup){if(focus&&popup.focus){popup.focus();}return false;}var me=this;var ori={"BL":"TL","TL":"BL"};if(!this.isLeftToRight()){ori={"BR":"TR","TR":"BR"};}dijit.popup.open({parent:this,popup:popup,orient:ori,around:item.domNode,onCancel:function(){if(popup.close){popup.close();}else{dijit.popup.close(popup);}item.focus();me.currentPopup=null;},onClose:function(){me.currentPopup=null;}});this.currentPopup=popup;if(focus&&popup.focus){popup.focus();}return true;},_closePopup:function(){if(this.currentPopup){if(this.currentPopup.close){this.currentPopup.close();}else{dijit.popup.close(this.currentPopup);}}this.currentPopup=null;},_startCloseTimer:function(){if(this.currentPopup){if(this.currentPopup._startCloseTimer){this.currentPopup._startCloseTimer();}else{this._closePopup();}}},_stopCloseTimer:function(){if(this.currentPopup&&this.currentPopup._stopCloseTimer){this.currentPopup._stopCloseTimer();}},_onItemAccent:function(child,focus){if(child.attr("disabled")){return;}this._stopCloseTimer();if(this.currentPopup){if(this.currentPopup.canClose&&!this.currentPopup.canClose()){return;}if(this.currentPopup!=child.popup){dijit.popup.close(this.currentPopup);}}this._openPopup(child,focus);},onItemFocus:function(child){},onItemClick:function(child,evt){if(child.attr("disabled")){return;}child.onClick(evt);},onItemHover:function(child,evt){this._onItemAccent(child,false);},onItemUnhover:function(item){this._startCloseTimer();},onPopupDestroyed:function(popup){if(popup==this.currentPopup){this.currentPopup=null;}}});dojo.declare("com.ibm.widgets._TabBase",[dijit._Widget,dijit._Templated,dijit._Contained],{"class":"lotusTab",_setDisabledAttr:function(value){this.disabled=value;dojo[value?"addClass":"removeClass"](this.domNode,"disabled");dijit.setWaiState(this.focusNode,"disabled",value?"true":"false");},_setClassAttr:function(value){this["class"]=value;this.domNode.className=value;},focus:function(){dijit.focus(this.focusNode);},onFocus:function(){this.getParent().onItemFocus(this);},_onHover:function(evt){this.getParent().onItemHover(this,evt);},_onUnhover:function(evt){this.getParent().onItemUnhover(this,evt);},_blur:function(){}});dojo.declare("com.ibm.widgets.Tab",com.ibm.widgets._TabBase,{iconClass:"",href:"",label:"",templateString:"<li class=\"${class}\" dojoAttachEvent=\"onclick:_onClick,onmouseenter:_onHover,onmouseleave:_onUnhover\"\n\t><div waiRole=\"presentation\" dojoAttachPoint=\"containerNode\"\n\t\t><span class=\"dragHandle\" waiRole=\"presentation\" dojoAttachPoint=\"dndHandleNode\"\n\t\t\t><span class=\"dragHandleInner\" waiRole=\"presentation\"\n\t\t\t\t><img dojoAttachPoint=\"iconNode\" alt=\"\" src=\"${_blankGif}\" waiRole=\"presentation\" \n\t\t\t\t/><span waiRole=\"presentation\" class=\"dragHandleA11y\">|</span\n\t\t\t></span\n\t\t></span\n\t\t><a dojoAttachPoint=\"focusNode,linkNode,labelNode\" href=\"javascript:;\" onclick=\"javascript:return false;\" waiRole=\"menuitem\"></a\n\t\t><span class=\"modelHasChildrenIcon\" waiRole=\"presentation\" dojoAttachPoint=\"hasChildrenIconNode\"\n\t\t\t><img src=\"${_blankGif}\" alt=\"\" waiRole=\"presentation\" class=\"dijitArrowButtonInner\"\n\t\t\t/><span waiRole=\"presentation\" class=\"dijitArrowButtonChar\">&#9660;</span\n\t\t></span\n\t\t><div class=\"dndMagicZone\" waiRole=\"presentation\"\n\t\t></div\n\t></div\n></li>\n",attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{label:{node:"labelNode",type:"innerHTML"},href:{node:"linkNode",type:"attribute"},iconClass:{node:"iconNode",type:"class"}}),_setDndHandleAttr:function(value){this.dndHandle=value;dojo[value?"addClass":"removeClass"](this.dndHandleNode,"dojoDndHandle");},postCreate:function(){this.inherited(arguments);if(this.popup){this.setPopup(this.popup);}},_fillContent:function(_222b){var dest=this.containerNode;var _222c=false;if(_222b&&dest){var nodes=dojo.query("a",_222b);if(nodes.length>0){_222c=true;this.linkNode.setAttribute("href",nodes[0].getAttribute("href"));while(nodes[0].hasChildNodes()){this.linkNode.appendChild(nodes[0].firstChild);}}}if(!_222c){return this.inherited(arguments);}},setPopup:function(popup){this.popup=popup;this.popup.anchor=this;this.popup.startup();dijit.setWaiState(this.linkNode,"haspopup","true");},destroyPopup:function(){if(this.popup){this.popup.destroyRecursive();var _222d=this.getParent();if(_222d){_222d.onPopupDestroyed(this.popup);}delete this.popup;dijit.setWaiState(this.linkNode,"haspopup","false");}},destroyDescendants:function(){this.destroyPopup();this.inherited(arguments);},startup:function(){this.inherited(arguments);if(this.popup){this.popup.startup();}},_onClick:function(evt){var p=this.getParent();if(p){p.onItemClick(this,evt);dojo.stopEvent(evt);}},onClick:function(evt){}});dojo.declare("com.ibm.widgets.ShowEditorTab",com.ibm.widgets._TabBase,{"class":"showEditorTab",templateString:"<li class=\"${class}\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onclick:onClick\">"+"<a dojoAttachPoint=\"focusNode\" waiRole=\"menuitem\" class=\"tabLabel\" onclick=\"javascript:return false;\" href=\"javascript:void(0);\">${label}</a>"+"</li>",postCreate:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,true);if(this.popupWidget){var cls=dojo.getObject(this.popupWidget);this.popup=new cls(this.popupParams);this.connect(this.popup,"onChange","onChange");this.connect(this.popup,"onCancel","onCancel");this.connect(this.popup,"focus","onEdit");}},onFocus:function(){},onChange:function(value){},onCancel:function(){},onEdit:function(){},onClick:function(evt){if(this.popup){if(typeof ibmPortalConfig!="undefined"&&typeof ibmPortalConfig.savePageManager!="undefined"&&typeof ibmPortalConfig.savePageManager.leavePage!="undefined"){var _222e=this.popup;var _222f=function(){_222e.focus();};ibmPortalConfig.savePageManager.leavePage(_222f);}else{this.popup.focus();}}}});dojo.declare("com.ibm.widgets.EditorTab",[com.ibm.widgets._TabBase,com.ibm.widgets.InlineEditorWrapper],{templateString:"<li class=\"inlineEditor ${class}\" waiRole=\"presentation\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onclick:onClick,onmouseenter:_onHover,onmouseleave:_onUnhover\"\n\t><div\n\t\t><a dojoAttachPoint=\"editor,focusNode\" href=\"javascript:;\" class=\"tabLabel\" waiRole=\"tab\" onclick=\"javascript:return false;\">${label}</a\n\t></div\n></li>\n","class":"lotusTab",postCreate:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,true);}});}if(!dojo._hasResource["com.ibm.widgets.TimedMenu"]){dojo._hasResource["com.ibm.widgets.TimedMenu"]=true;dojo.provide("com.ibm.widgets.TimedMenu");dojo.declare("com.ibm.widgets.TimedMenu",null,{_onHover:function(){this._enter();},_onUnhover:function(){this._exit();},_onNodeFocus:function(evt){this._enter();this.inherited(arguments);},_onNodeBlur:function(evt){this._exit();this.inherited(arguments);},_exit:function(){this._startCloseTimer();if(this.parentMenu&&this.parentMenu._startCloseTimer){this.parentMenu._startCloseTimer();}},_enter:function(){this._stopCloseTimer();},_startCloseTimer:function(){if(!this._closeTimer){this._isClosing=true;if(this.parentMenu){this.parentMenu._isClosing=true;}if(this.closeDelay==0){this.close();}else{this._closeTimer=setTimeout(dojo.hitch(this,function(){this._closeTimer=null;this.close();}),this.closeDelay);}}},_stopCloseTimer:function(){this._isClosing=false;if(this.parentMenu&&this.parentMenu._stopCloseTimer){this.parentMenu._stopCloseTimer();}if(this._closeTimer){clearTimeout(this._closeTimer);this._closeTimer=null;}},canClose:function(){return true;},close:function(){if(this._isClosing&&this.canClose()){var _2230=this.parentMenu;this.closeAction();if(_2230&&_2230.close){_2230.close();}}},closeAction:function(){dijit.popup.close(this);}});}if(!dojo._hasResource["dojo.dnd.Container"]){dojo._hasResource["dojo.dnd.Container"]=true;dojo.provide("dojo.dnd.Container");dojo.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(node,_2231){this.node=dojo.byId(node);if(!_2231){_2231={};}this.creator=_2231.creator||null;this.skipForm=_2231.skipForm;this.parent=_2231.dropParent&&dojo.byId(_2231.dropParent);this.map={};this.current=null;this.containerState="";dojo.addClass(this.node,"dojoDndContainer");if(!(_2231&&_2231._skipStartup)){this.startup();}this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||dojo.global;var m=this.map,e=dojo.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dojo.dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_2232,_2233){if(!this.parent.firstChild){_2233=null;}else{if(_2232){if(!_2233){_2233=this.parent.firstChild;}}else{if(_2233){_2233=_2233.nextSibling;}}}if(_2233){for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_2233);}}else{for(var i=0;i<data.length;++i){var t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){dojo.forEach(this.events,dojo.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_2234,node){_2234._skipStartup=true;return new dojo.dnd.Container(node,_2234);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dojo.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dojo.dnd.isFormElement(e)){dojo.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_2235){var _2236="dojoDnd"+type;var state=type.toLowerCase()+"State";dojo.removeClass(this.node,_2236+this[state]);dojo.addClass(this.node,_2236+_2235);this[state]=_2235;},_addItemClass:function(node,type){dojo.addClass(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){dojo.removeClass(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _2237=node.parentNode;_2237;node=_2237,_2237=node.parentNode){if(_2237==this.parent&&dojo.hasClass(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!dojo.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dojo.dnd.getUniqueId();}dojo.addClass(t.node,"dojoDndItem");return t;}});dojo.dnd._createNode=function(tag){if(!tag){return dojo.dnd._createSpan;}return function(text){return dojo.create(tag,{innerHTML:text});};};dojo.dnd._createTrTd=function(text){var tr=dojo.create("tr");dojo.create("td",{innerHTML:text},tr);return tr;};dojo.dnd._createSpan=function(text){return dojo.create("span",{innerHTML:text});};dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dojo.dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[tag]);return function(item,hint){var isObj=item&&dojo.isObject(item),data,type,n;if(isObj&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(isObj&&item.data)?item.data:item;type=(isObj&&item.type)?item.type:["text"];n=(hint=="avatar"?dojo.dnd._createSpan:c)(String(data));}n.id=dojo.dnd.getUniqueId();return {node:n,data:data,type:type};};};}if(!dojo._hasResource["dojo.dnd.Selector"]){dojo._hasResource["dojo.dnd.Selector"]=true;dojo.provide("dojo.dnd.Selector");dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(node,_2238){if(!_2238){_2238={};}this.singular=_2238.singular;this.autoSync=_2238.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"));},singular:false,getSelectedNodes:function(){var t=new dojo.NodeList();var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dojo.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dojo.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dojo.byId(i);this.delItem(i);dojo.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||dojo.global;var s=this.selection,e=dojo.dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){dojo.dnd.Selector.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}dojo.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_2239,data,_223a,_223b){var _223c=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_223c.call(this,item,hint);if(_2239){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};dojo.dnd.Selector.superclass.insertNodes.call(this,data,_223a,_223b);this._normalizedCreator=_223c;return this;},destroy:function(){dojo.dnd.Selector.superclass.destroy.call(this);this.selection=this.anchor=null;},markupFactory:function(_223d,node){_223d._skipStartup=true;return new dojo.dnd.Selector(node,_223d);},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dojo.isCopyKey(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(e.button===dojo.mouseButtons.LEFT){dojo.stopEvent(e);}return;}if(!this.singular&&e.shiftKey){if(!dojo.isCopyKey(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0;for(;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){var node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dojo.isCopyKey(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dojo.isCopyKey(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}dojo.stopEvent(e);},onMouseUp:function(e){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(e){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove");},onOutEvent:function(){dojo.disconnect(this.onmousemoveEvent);delete this.onmousemoveEvent;},_removeSelection:function(){var e=dojo.dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dojo.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});}if(!dojo._hasResource["dojo.dnd.Avatar"]){dojo._hasResource["dojo.dnd.Avatar"]=true;dojo.provide("dojo.dnd.Avatar");dojo.declare("dojo.dnd.Avatar",null,{constructor:function(_223e){this.manager=_223e;this.construct();},construct:function(){this.isA11y=dojo.hasClass(dojo.body(),"dijit_a11y");var a=dojo.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_223f=this.manager.source,node,b=dojo.create("tbody",null,a),tr=dojo.create("tr",null,b),td=dojo.create("td",null,tr),icon=this.isA11y?dojo.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td):null,span=dojo.create("span",{innerHTML:_223f.generateText?this._generateText():""},td),k=Math.min(5,this.manager.nodes.length),i=0;dojo.attr(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_223f.creator){node=_223f._normalizedCreator(_223f.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var table=dojo.create("table"),tbody=dojo.create("tbody",null,table);tbody.appendChild(node);node=table;}}node.id="";tr=dojo.create("tr",null,b);td=dojo.create("td",null,tr);td.appendChild(node);dojo.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){dojo.destroy(this.node);this.node=false;},update:function(){dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");if(this.isA11y){var icon=dojo.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}dojo.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(node){node.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});}if(!dojo._hasResource["dojo.dnd.Manager"]){dojo._hasResource["dojo.dnd.Manager"]=true;dojo.provide("dojo.dnd.Manager");dojo.declare("dojo.dnd.Manager",null,{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_2240){if(this.avatar){this.target=(_2240&&_2240.targetState!="Disabled")?_2240:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}dojo.publish("/dnd/source/over",[_2240]);},outSource:function(_2241){if(this.avatar){if(this.target==_2241){this.target=null;this.canDropFlag=false;this.avatar.update();dojo.publish("/dnd/source/over",[null]);}}else{dojo.publish("/dnd/source/over",[null]);}},startDrag:function(_2242,nodes,copy){this.source=_2242;this.nodes=nodes;this.copy=Boolean(copy);this.avatar=this.makeAvatar();dojo.body().appendChild(this.avatar.node);dojo.publish("/dnd/start",[_2242,nodes,this.copy]);this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp"),dojo.connect(dojo.doc,"ondragstart",dojo.stopEvent),dojo.connect(dojo.body(),"onselectstart",dojo.stopEvent)];var c="dojoDnd"+(copy?"Copy":"Move");dojo.addClass(dojo.body(),c);},canDrop:function(flag){var _2243=Boolean(this.target&&flag);if(this.canDropFlag!=_2243){this.canDropFlag=_2243;this.avatar.update();}},stopDrag:function(){dojo.removeClass(dojo.body(),"dojoDndCopy");dojo.removeClass(dojo.body(),"dojoDndMove");dojo.forEach(this.events,dojo.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new dojo.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){dojo.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dojo.isCopyKey(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dojo.isCopyKey(e))),_2244=[this.source,this.nodes,copy,this.target];dojo.publish("/dnd/drop/before",_2244);dojo.publish("/dnd/drop",_2244);}else{dojo.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case dojo.keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();dojo.removeClass(dojo.body(),"dojoDnd"+(this.copy?"Move":"Copy"));dojo.addClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"));}});dojo.dnd._manager=null;dojo.dnd.manager=function(){if(!dojo.dnd._manager){dojo.dnd._manager=new dojo.dnd.Manager();}return dojo.dnd._manager;};}if(!dojo._hasResource["dojo.dnd.Source"]){dojo._hasResource["dojo.dnd.Source"]=true;dojo.provide("dojo.dnd.Source");dojo.declare("dojo.dnd.Source",dojo.dnd.Selector,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_2245){dojo.mixin(this,dojo.mixin({},_2245));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){dojo.addClass(this.node,"dojoDndSource");}this.targetState="";if(this.accept){dojo.addClass(this.node,"dojoDndTarget");}if(this.horizontal){dojo.addClass(this.node,"dojoDndHorizontal");}this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")];},checkAcceptance:function(_2246,nodes){if(this==_2246){return !this.copyOnly||this.selfAccept;}for(var i=0;i<nodes.length;++i){var type=_2246.getItem(nodes[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_2247,self){if(_2247){return true;}if(arguments.length<2){self=this==dojo.dnd.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){dojo.dnd.Source.superclass.destroy.call(this);dojo.forEach(this.topics,dojo.unsubscribe);this.targetAnchor=null;},markupFactory:function(_2248,node){_2248._skipStartup=true;return new dojo.dnd.Source(node,_2248);},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=dojo.dnd.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var nodes=this.getSelectedNodes();if(nodes.length){m.startDrag(this,nodes,this.copyState(dojo.isCopyKey(e),true));}}}if(this.isDragging){var _2249=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=dojo.position(this.current,true);}if(this.horizontal){_2249=(e.pageX-this.targetBox.x)<(this.targetBox.w/2);}else{_2249=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_2249!=this.before){this._markTargetAnchor(_2249);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dojo.dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;dojo.dnd.Source.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;dojo.dnd.Source.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_224a){if(this!=_224a){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=dojo.dnd.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_224b,nodes,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_224b?(copy?"Copied":"Moved"):"");}var _224c=this.accept&&this.checkAcceptance(_224b,nodes);this._changeState("Target",_224c?"":"Disabled");if(this==_224b){dojo.dnd.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_224d,nodes,copy,_224e){if(this==_224e){this.onDrop(_224d,nodes,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_224f,nodes,copy){if(this!=_224f){this.onDropExternal(_224f,nodes,copy);}else{this.onDropInternal(nodes,copy);}},onDropExternal:function(_2250,nodes,copy){var _2251=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _2251.call(this,_2250.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node,hint){var t=_2250.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node,hint){var t=_2250.getItem(node.id);_2250.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_2250.selectNone();}this.insertNodes(true,nodes,this.before,this.current);if(!copy&&this.creator){_2250.deleteSelectedNodes();}this._normalizedCreator=_2251;},onDropInternal:function(nodes,copy){var _2252=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _2252.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dojo.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node,hint){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,nodes,this.before,this.current);this._normalizedCreator=_2252;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){dojo.dnd.Source.superclass.onOverEvent.call(this);dojo.dnd.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){dojo.dnd.Source.superclass.onOutEvent.call(this);dojo.dnd.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_2253){if(this.current==this.targetAnchor&&this.before==_2253){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_2253;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(!dojo.mouseButtons.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(dojo.hasClass(node,"dojoDndHandle")){return true;}if(dojo.hasClass(node,"dojoDndItem")||dojo.hasClass(node,"dojoDndIgnore")){break;}}return false;}});dojo.declare("dojo.dnd.Target",dojo.dnd.Source,{constructor:function(node,_2254){this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");},markupFactory:function(_2255,node){_2255._skipStartup=true;return new dojo.dnd.Target(node,_2255);}});dojo.declare("dojo.dnd.AutoSource",dojo.dnd.Source,{constructor:function(node,_2256){this.autoSync=true;},markupFactory:function(_2257,node){_2257._skipStartup=true;return new dojo.dnd.AutoSource(node,_2257);}});}if(!dojo._hasResource["com.ibm.dnd.CustomManagerSource"]){dojo._hasResource["com.ibm.dnd.CustomManagerSource"]=true;dojo.provide("com.ibm.dnd.CustomManagerSource");com.ibm.dnd.CustomManagerMixin={managerOverrides:{},_partialMixin:function(tgt,src,map){for(var p in map){tgt[p]=src[p];}return tgt;},_changeManager:function(){if(!this._mgr){this.mgrProps={};this._mgr=dojo.dnd.manager();this._partialMixin(this.mgrProps,this._mgr,this.managerOverrides);dojo.mixin(this._mgr,this.managerOverrides);this._mgrFixConn=dojo.connect(dojo.doc,"onmouseup",this,"_fixManager");}},_fixManager:function(){if(this._mgrFixConn){dojo.disconnect(this._mgrFixConn);this._mgrFixConn=null;}if(this._mgr){dojo.mixin(this._mgr,this.mgrProps);this.mgrProps={};}this._mgr=null;},onMouseDown:function(e){this._changeManager();this.inherited(arguments);},destroy:function(){if(this._mgrFixConn){dojo.disconnect(this._mgrFixConn);}this._mgrFixConn=null;this.inherited(arguments);}};dojo.declare("com.ibm.dnd.CustomManagerSource",dojo.dnd.Source,com.ibm.dnd.CustomManagerMixin);dojo.declare("com.ibm.dnd.CustomManagerAutoSource",dojo.dnd.AutoSource,com.ibm.dnd.CustomManagerMixin);}if(!dojo._hasResource["com.ibm.dnd.PageAvatar"]){dojo._hasResource["com.ibm.dnd.PageAvatar"]=true;dojo.provide("com.ibm.dnd.PageAvatar");dojo.declare("com.ibm.dnd.PageAvatar",dojo.dnd.Avatar,{construct:function(){var div=dojo.doc.createElement("div");div.style.position="absolute";div.style.zIndex=1999;div.style.margin="0px";var _2258=this.manager.source,node;node=_2258._normalizedCreator(_2258.getItem(this.manager.nodes[0].id).data,"avatar").node;node.id="";div.appendChild(node);this.node=div;}});}if(!dojo._hasResource["com.ibm.dnd.ModeledSource"]){dojo._hasResource["com.ibm.dnd.ModeledSource"]=true;dojo.provide("com.ibm.dnd.ModeledSource");if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}dojo.declare("com.ibm.dnd.ModeledSource",com.ibm.dnd.CustomManagerSource,{managerOverrides:{OFFSET_X:1,OFFSET_Y:1,makeAvatar:function(){return new com.ibm.dnd.PageAvatar(this);}},model:null,item:null,isBidi:false,constructor:function(node,_2259){if(this.withHandles){dojo.addClass(node,"dndHasHandles");}if(typeof (ibmCfg)!="undefined"&&ibmCfg.themeConfig){this.isBidi=ibmCfg.themeConfig.isRTL;}else{if(typeof (ibmConfig)!="undefined"){this.isBidi=ibmConfig.isBidi;}else{if(typeof (ibmPortalConfig)!="undefined"){this.isBidi=ibmPortalConfig.isRTL;}}}},onDrop:function(_225a,nodes,copy){var _225b=dijit.getEnclosingWidget(this.current),_225c=null,_225d=null;if(dojo.hasClass(this.current,"dojoDndItemChild")){_225d=_225b.item;}else{_225d=_225b.getParent().item;if(this.current){var _225e=(this.isBidi&&this.horizontal)?"dojoDndItemBefore":"dojoDndItemAfter";if(dojo.hasClass(this.current,_225e)){_225b=_225b.getNextSibling();while(_225b&&dojo.hasClass(_225b.domNode,"dojoDndItemAnchor")){_225b=_225b.getNextSibling();}}if(_225b){_225c=_225b.item;}}}setTimeout(dojo.hitch(this,function(){dojo.forEach(nodes,function(node){var _225f=dijit.getEnclosingWidget(node),_2260=_225f.item,_2261=_225f.getParent().item;if(this.checkModelAcceptance(_2260,_225d)){this.model.pasteItem(_2260,_2261,_225d,copy,_225c);}},this);}),50);},checkModelAcceptance:function(_2262,_2263){return true;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=dojo.dnd.manager();if(this.isDragging){dojo.forEach(this.draggingItems,function(item){if(item.popup.isShowingNow){dijit.popup.close(item.popup);this._removeItemClass(this.current,"Over");dojo.removeClass(this.current,"dijitMenuItemHover");}},this);var _2264=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox={xy:dojo.coords(this.current,true),w:this.current.offsetWidth,h:this.current.offsetHeight};}if(this.horizontal){if((e.pageX-this.targetBox.xy.x)<(this.targetBox.w*0.25)){_2264="Before";}else{if((e.pageX-this.targetBox.xy.x)>(this.targetBox.w*0.75)){_2264="After";}else{_2264="Child";}}}else{if((e.pageY-this.targetBox.xy.y)<(this.targetBox.h*0.25)){_2264="Before";}else{if((e.pageY-this.targetBox.xy.y)>(this.targetBox.h*0.75)){_2264="After";}else{_2264="Child";}}}}if(this.current!=this.targetAnchor||_2264!=this.before){this._markTargetAnchor(_2264);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}else{if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var nodes=this.getSelectedNodes();if(nodes.length){m.startDrag(this,nodes,this.copyState(dojo.isCopyKey(e),true));}}}},_markTargetAnchor:function(_2265){if(this.current==this.targetAnchor&&this.before==_2265){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before);}this.targetAnchor=this.current;this.targetBox=null;this.before=_2265;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before);}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before);this.targetAnchor=null;this.targetBox=null;this.before=true;},onDndStart:function(_2266,nodes,copy){this.draggingItems=[];dojo.forEach(nodes,function(node){var _2267=dijit.getEnclosingWidget(node);if(_2267&&_2267.popup){this.draggingItems.push(_2267);this._removeItemClass(_2267.popup,"Over");dijit.popup.close(_2267.popup);}},this);this.inherited(arguments);dojo.addClass(this.node,"isDragging");},onDndCancel:function(){this.inherited(arguments);dojo.removeClass(this.node,"isDragging");},destroy:function(){this.inherited(arguments);this.model=this.node=this.current=this.item=null;}});}if(!dojo._hasResource["com.ibm.widgets.TreeModeled"]){dojo._hasResource["com.ibm.widgets.TreeModeled"]=true;dojo.provide("com.ibm.widgets.TreeModeled");dojo.require("com.ibm.dnd.ModeledSource");dojo.declare("com.ibm.widgets._DataBacked",null,{_loaded:false,_loading:false,load:function(){},reload:function(force){},_onLoad:function(){this._loaded=true;this._loading=false;this.onLoad();},_onLoading:function(){this._loading=true;this.onLoading();},onLoad:function(){},onLoading:function(){}});dojo.declare("com.ibm.widgets.TreeModeled",com.ibm.widgets._DataBacked,{model:null,item:null,items:null,levels:Number.MAX_VALUE,level:0,dndEnabled:false,dndClass:"com.ibm.dnd.ModeledSource",dndAccept:null,dndType:null,dndCreator:null,dndSingular:true,dndDelay:0,dndHorizontal:false,loadingIndicatorWidget:"",showLoadingOnBootstrap:true,showInlineEditor:false,inlineEditorWidget:"",inlineEditorWidgetParams:{},inlineEditorTitle:"",inlineEditorLabel:"",inlineEditorDefaultValue:"",embeddedEditorWidget:"dijit.form.TextBox",embeddedEditorParams:{},embeddedEditorPopup:"com.ibm.widgets.InlineEditorPopup",embeddedEditorPopupParams:{},bootstrapped:false,constructor:function(){this.inlineEditorWidgetParams={};this.embeddedEditorParams={};this.embeddedEditorPopupParams={};this.items={};},initializeModelWidget:function(){this.connect(this.model,"onTreeChange","onModelTreeChange");this.connect(this.model,"onChange","onModelChange");this.connect(this.model,"onChildrenChange","onModelChildrenChange");if(!this.preloaded){var _2268=dojo.getObject(this.loadingIndicatorWidget);if(_2268){this.loadingIndicator=new _2268();}}if(this.showInlineEditor){this.connect(this,"onLoad","setupInlineEditor");}if(!dojo.isArray(this.dndAccept)){this.dndAccept=[this.dndAccept];}this._dndParams={model:this.model,item:this.item,skipForm:true,accept:this.dndAccept||[],singular:this.dndSingular,creator:this.dndCreator,delay:this.dndDelay,horizontal:this.dndHorizontal,dropParent:this.containerNode};if(this.dndEnabled&&!this.preloaded){this.setupDnd();}this._draggingNodes=[];},startupModelWidget:function(){if(!this.preloaded&&this.showLoadingOnBootstrap){this.showLoading();}},setupInlineEditor:function(){if(!this.inlineEditor){var _2269=dojo.getObject(this.inlineEditorWidget);if(_2269){this.inlineEditor=new _2269(dojo.delegate({label:this.inlineEditorLabel,title:this.inlineEditorTitle,defaultValue:this.inlineEditorDefaultValue,embeddedEditorWidget:this.embeddedEditorWidget,embeddedEditorParams:this.embeddedEditorParams,popupWidget:this.embeddedEditorPopup,popupParams:this.embeddedEditorPopupParams},this.inlineEditorWidgetParams));this.connect(this.inlineEditor,"onChange","_onInlineEditorChange");this.connect(this.inlineEditor,"onCancel","onInlineEditorCancel");this.connect(this.inlineEditor,"onEdit","onInlineEdit");this.addChild(this.inlineEditor);}}},setupDnd:function(){if(!this.dndSource){this.dndEnabled=true;var cls=dojo.getObject(this.dndClass);this.dndSource=new cls(this.domNode,this._dndParams);this._dndConnects=[];this._dndConnects.push(this.connect(this.dndSource,"onDraggingOver","onDraggingOver"));this._dndConnects.push(this.connect(this.dndSource,"onDraggingOut","onDraggingOut"));this._dndConnects.push(this.connect(this.dndSource,"onDndStart","onDndStart"));this._dndConnects.push(this.connect(this.dndSource,"onDndCancel","onDndCancel"));}dojo.forEach(this.getChildren(),function(child){child.attr("dndStatus",true);},this);},disableDnd:function(){this._disableLocalDnd();dojo.forEach(this.getChildren(),function(child){child.attr("dndStatus",false);},this);},_disableLocalDnd:function(){if(this.dndSource){this.dndEnabled=false;dojo.forEach(this._dndConnects,this.disconnect,this);this._dndConnects=[];this.dndSource.destroy();this.dndSource=null;}},destroy:function(){this._disableLocalDnd();this.inherited(arguments);},getInheritableParameters:function(item){return {item:item,model:this.model,level:this.level+1,levels:this.levels,showInlineEditor:this.showInlineEditor,inlineEditorLabel:this.inlineEditorLabel,inlineEditorTitle:this.inlineEditorTitle,inlineEditorDefaultValue:this.inlineEditorDefaultValue,embeddedEditorWidget:this.embeddedEditorWidget,embeddedEditorParams:dojo.mixin({},this.embeddedEditorParams),embeddedEditorPopup:this.embeddedEditorPopup,embeddedEditorPopupParams:dojo.mixin({},this.embeddedEditorPopupParams),dndCreator:this.dndCreator,dndEnabled:this.dndEnabled,dndAccept:this.dndAccept,dndSingular:this.dndSingular,dndDelay:this.dndDelay,dndType:this.dndType,onModelItemClick:this.onModelItemClick,setupInlineEditor:this.setupInlineEditor,seedPreloadedData:this.seedPreloadedData};},createItemRep:function(item){},handlePreloaded:function(){this.domNode.removeAttribute("item");dojo.forEach(this.getChildren(),function(wij){this.items[this.model.getIdentity(wij.item)]=wij;this._flagChildForDnd(wij);this._flagChildHasChildren(wij);wij.domNode.removeAttribute("item");},this);},seedPreloadedData:function(){},showLoading:function(){if(this.loadingIndicator&&!this._loaderVisible){this.addChild(this.loadingIndicator);this._loaderVisible=true;}},clearLoading:function(){if(this.loadingIndicator&&this._loaderVisible){this.removeChild(this.loadingIndicator);this._loaderVisible=false;}},load:function(_226a){if(this._loaded||this._loading||!this.item){return false;}if(this.preloaded){this.seedPreloadedData();this.handlePreloaded();if(this.showInlineEditor){this.setupInlineEditor();}if(this.dndEnabled){this.setupDnd();}return false;}if(!this.model.mayHaveChildren(this.item)){this.clearLoading();this._onLoading();this._onLoad();return false;}this._onLoading();this.model.getChildren(this.item,dojo.hitch(this,function(items){if(_226a&&_226a<this._reloadTimeStamp){return false;}this.clearLoading();if(this._loaded){return false;}this.loadHandler(items);this._onLoad();}),dojo.hitch(this,function(error){this.clearLoading();this._onLoad();this.onError(error);}));return true;},reload:function(force){if(this._loading&&force!=true){return false;}this._loaded=this._loading=false;var items=this.items;for(var id in items){this.removeChild(items[id]);items[id].destroyRecursive();delete items[id];}if(this.dndSource){this.dndSource.sync();}this.showLoading();this.preloaded=false;if(this.model.resolver){this.model.resolver.getValue(this.item,"children").reload();}this._reloadTimeStamp=new Date().getTime();return this.load(this._reloadTimeStamp);},loadHandler:function(items){if(!this.showInlineEditor&&this.inlineEditor){this.inlineEditor.destroy();this.inlineEditor=null;}else{if(this.showInlineEditor&&!this.inlineEditor){this.setupInlineEditor();}}var _226b=0;if(this.inlineEditor){_226b=this.getIndexOfChild(this.inlineEditor);if(_226b<0){_226b=null;}}dojo.forEach(items,function(item){var _226c=this._setupNewChild(item);this.items[this.model.getIdentity(item)]=_226c;var li=null;if(!this.bootstrapped){li=dojo.query("> #"+this.model.getIdentity(_226c.item),this.containerNode)[0];}if(li){this.containerNode.replaceChild(_226c.domNode,li);if(_226b!==null){this.addChild(_226c,_226b++);}else{this.addChild(_226c);}}else{if(_226b!==null){this.addChild(_226c,_226b++);}else{this.addChild(_226c);}}},this);this.bootstrapped=true;if(this.dndSource){this.dndSource.sync();}},_flagChildForDnd:function(_226d){dojo.addClass(_226d.domNode,"dojoDndItem");_226d.domNode.setAttribute("dndType",this.dndType);_226d.domNode.setAttribute("dndData",this.model.getLabel(_226d.item));_226d.attr("dndHandle",this._dndParams.withHandles);},_flagChildHasChildren:function(_226e){if(!this.model.mayHaveChildren(_226e.item)||this.levels===0||this.level>=this.levels){_226e.attr("hasChildren",false);}else{_226e.attr("hasChildren",true);}},_setupNewChild:function(item){var _226f=this.createItemRep(item);_226f.item=item;this._flagChildForDnd(_226f);this._flagChildHasChildren(_226f);return _226f;},onError:function(error){console.error(error);},onItemCreate:function(_2270,item){},onModelRemoveChild:function(_2271){var _2272=this.getChildren();for(var i=0,wij;wij=_2272[i],i<_2272.length;i++){if(wij.item==_2271){delete this.items[this.model.getIdentity(_2271)];this.removeChild(wij);wij.destroyRecursive();for(var x in wij){try{delete wij[x];}catch(e){wij[x]=null;}}if(this.dndSource){this.dndSource.sync();}return;}}},onModelInsertChild:function(_2273,_2274){var _2275=this._setupNewChild(_2273);var _2276=this.getChildren();var _2277=null;if(_2274){for(var i=0,wij;wij=_2276[i],i<_2276.length;i++){if(wij.item==_2274){_2277=i;break;}}}else{_2277=this.getIndexOfChild(this.inlineEditor);}this.animateInChild(_2275,_2277);if(!this.model.isCreated(_2273)){if(this._editorChangedWithFocus){setTimeout(function(){dijit.focus(_2275.focusNode?_2275.focusNode:_2275.domNode);},0);}this._editorChangedWithFocus=false;_2275.attr("disabled",true);this.model.addOnCreate(_2273,dojo.hitch(this,function(){this.items[this.model.getIdentity(_2273)]=_2275;_2275.attr("disabled",false);this.onItemCreate(_2275,_2273);}));}else{this.items[this.model.getIdentity(_2273)]=_2275;}if(this.dndSource){this.dndSource.sync();}},onModelReorderChild:function(_2278,_2279){var _227a=this.getChildren();var _227b=null;for(var i=0,wij;wij=_227a[i],i<_227a.length;i++){if(wij.item==_2278){_227b=wij;this.removeChild(_227b);_227a.splice(i,1);break;}}var _227c=null;if(_2279){for(var i=0,wij;wij=_227a[i],i<_227a.length;i++){if(wij.item==_2279){_227c=i;break;}}}else{_227c=this.getIndexOfChild(this.inlineEditor);}this.animateInChild(_227b,_227c);if(this.dndSource){this.dndSource.sync();}},onModelTreeChange:function(_227d,_227e,_227f,_2280){var f=null;if(this.item==_227e){f="onModelRemoveChild";}if(this.item==_227f){f=f?"onModelReorderChild":"onModelInsertChild";}if(f){this[f](_227d,_2280);return true;}return false;},onModelChange:function(item){if(this.items[this.model.getIdentity(item)]){}return false;},onModelChildrenChange:function(_2281,_2282){if(this.item!=_2281){var _2283=this.model.getIdentity(_2281),child=this.items[_2283];if(child){this.handleChildChildrenChange(child,_2282||[]);}return false;}if(this.anchor){this.anchor.attr("hasChildren",_2282&&_2282.length>0);}},handleChildChildrenChange:function(child,_2284){},onModelItemClick:function(_2285,item){},onDraggingOver:function(){if(this.inlineEditor&&this.dndSource.getAllNodes().length===0){this.dndSource._addItemClass(this.inlineEditor.domNode,"Before");}},onDraggingOut:function(){if(this.inlineEditor&&this.dndSource.getAllNodes().length===0){this.dndSource._removeItemClass(this.inlineEditor.domNode,"Before");}},onDndStart:function(_2286,nodes,copy){if(this.dndSource==_2286){dojo.forEach(nodes,function(node){this._animateOut(node);},this);this._draggingNodes=nodes;}},onDndCancel:function(){if(this.inlineEditor){this.dndSource._removeItemClass(this.inlineEditor.domNode,"Before");}dojo.forEach(this._draggingNodes,function(node){this._animateIn(node);},this);this._draggingNodes=[];},_animateIn:function(node){if(node._animation){node._animation.stop(true);}dojo.style(node,"display","");var anim=dojo.fadeIn({node:node,duration:500});if(dojo.isIE){var _2287=node.style.filter;anim.onEnd=function(){node._animation=null;node.style.filter=_2287;};}node._animation=anim;anim.play();return anim;},_animateOut:function(node){if(node._animation){node._animation.stop(true);}var anim=dojo.fadeOut({node:node,duration:500,onEnd:function(){node._animation=null;dojo.style(node,"display","none");}});node._animation=anim;anim.play();return anim;},animateInChild:function(_2288,_2289){var _228a=null;if(dojo.isIE){_228a=_2288.domNode.style.filter;}dojo.style(_2288.domNode,"opacity","0");(_2289>=0)?this.addChild(_2288,_2289):this.addChild(_2288);var anim=this._animateIn(_2288.domNode);if(dojo.isIE){var conn=dojo.connect(anim,"onEnd",function(){_2288.domNode.style.filter=_228a;dojo.disconnect(conn);});}return anim;},animateOutChild:function(_228b){var anim=this._animateOut(_228b.domNode);dojo.connect(anim,"onEnd",this,function(){this.removeChild(_228b);});return anim;},moveChild:function(_228c,_228d){this.removeChild(_228c);this.animateInChild(_228c,_228d);},_onInlineEditorChange:function(value,focus){this._editorChangedWithFocus=focus;this.onInlineEditorChange(value,this.item);},onInlineEditorChange:function(value,_228e){this.model.newItem(value,_228e);},onInlineEditorCancel:function(){},onInlineEdit:function(){}});}if(!dojo._hasResource["com.ibm.widgets.SelectionModeled"]){dojo._hasResource["com.ibm.widgets.SelectionModeled"]=true;dojo.provide("com.ibm.widgets.SelectionModeled");dojo.declare("com.ibm.widgets.SelectionModeled",com.ibm.widgets.TreeModeled,{level:0,selectionModel:null,selectedClass:"",selectedChild:null,tiedToSelection:false,constructor:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.bundles","Theme");this.currentlySelected=this.bundle["currently_selected"];},postMixInProperties:function(){this.inherited(arguments);this.attr("level",this.getVariedLevel());},initializeModelWidget:function(){this.inherited(arguments);this.connect(this.selectionModel,"onSelectionPathChange","_updateSelection");},loadHandler:function(items){if(this.selectedChild){delete this.selectedChild;}return this.inherited(arguments);},_itemIsEqual:function(item1,item2){return (item1&&this.model.getIdentity(item1))==(item2&&this.model.getIdentity(item2));},_setLevelAttr:function(value){this.level=value;if(this.tiedToSelection){this.item=this.selectionModel.atLevel(this.level,true);}},_markSel:function(_228f,value){if(value){if(this.selectedChild){this.markSelected(this.selectedChild,false);}this.selectedChild=_228f;}this.markSelected(_228f,value);},markSelected:function(_2290,value){dojo[value?"addClass":"removeClass"](_2290.domNode,this.selectedClass);},getVariedLevel:function(){return this.level;},_updateSelection:function(){var _2291=this.level,_2292=this.getVariedLevel();if(_2291!=_2292){this.attr("level",_2292);this.reload(true);}else{var _2293=this.selectionModel.atLevel(this.level,true),_2294=this.selectionModel.atLevel(this.level+1,true);if(_2293!=null){if(this.tiedToSelection&&!this._itemIsEqual(this.item,_2293)){this.item=_2293;this.reload(true);}else{var _2295=_2293?this.model.getIdentity(_2293):null,_2296=_2294?this.model.getIdentity(_2294):null;if(_2293&&_2295!=_2296&&this.items[_2295]){this._markSel(this.items[_2295],false);}if(_2296&&this.items[_2296]){this._markSel(this.items[_2296],true);}}}}},_setupNewChild:function(item){var _2297=this.inherited(arguments);if(this._itemIsEqual(this.selectionModel.atLevel(this.level+1,true),item)){this._markSel(_2297,true);}return _2297;},getInheritableParameters:function(item){return dojo.mixin(this.inherited(arguments),{selectionModel:this.selectionModel,selectedClass:this.selectedClass});},onModelItemClick:function(_2298,item){if(_2298.disabled){return false;}var id=this.model.getIdentity(item);thisSel=this.selectionModel.atLevel(this.level,true),thisSelId=thisSel?this.model.getIdentity(thisSel):null;if(thisSelId!=id){try{this.selectionModel.changeSelection(item);}catch(e){}return true;}return false;}});}if(!dojo._hasResource["com.ibm.widgets.DataMenu"]){dojo._hasResource["com.ibm.widgets.DataMenu"]=true;dojo.provide("com.ibm.widgets.DataMenu");dojo.require("dijit.Menu");dojo.require("dijit.InlineEditBox");dojo.require("com.ibm.widgets.TimedMenu");dojo.require("com.ibm.widgets.SelectionModeled");dojo.require("com.ibm.widgets.InlineEditorWrapper");dojo.declare("com.ibm.widgets.DataMenu",[dijit.Menu,com.ibm.widgets.TimedMenu,com.ibm.widgets.SelectionModeled],{"class":"lotusActionMenu",loadingIndicatorWidget:"com.ibm.widgets.LoadingMenuItem",inlineEditorWidget:"com.ibm.widgets.EditorMenuItem",closeDelay:500,level:0,postCreate:function(){this.inherited(arguments);var ltr=this.isLeftToRight(),k=dojo.keys;this._exitKey=ltr?k.LEFT_ARROW:k.RIGHT_ARROW;this._openKey=ltr?k.RIGHT_ARROW:k.LEFT_ARROW;if(this.embeddedEditorParams.tooltipPosition){this.embeddedEditorParams.tooltipPosition=["after","before","below"];}this.initializeModelWidget();this._dndParams.withHandles=true;dojo.addClass(this.domNode,this["class"]);dojo.addClass(this.domNode,"modeledDataMenu");this.connect(this,"onMouseEnter","_onHover");this.connect(this,"onMouseLeave","_onUnhover");this.domNode.setAttribute("cellSpacing","0px");dojo.style(this.domNode,{borderCollapse:"separate",borderSpacing:"0px"});},startup:function(){this.inherited(arguments);this.startupModelWidget();},setupInlineEditor:function(){return;},setupDnd:function(){this._dndParams.withHandles=true;this.inherited(arguments);},getInheritableParameters:function(item){return dojo.mixin(this.inherited(arguments),{parentMenu:this,closeDelay:this.closeDelay,popupDelay:this.popupDelay,"class":this["class"]});},_getPopup:function(item){if(this.level<this.levels){return new this.constructor(this.getInheritableParameters(item));}return null;},loadHandler:function(items){this.inherited(arguments);if(items.length==0){var a=this.anchor;if(a){a.attr("hasChildren",false);a.destroyPopup&&a.destroyPopup();}}},createItemRep:function(item){var args={iconClass:"dragHandleIcon",label:com.ibm.domUtilities.encodeXML(this.model.getLabel(item)),item:item};var cls=com.ibm.widgets.DataPopupMenuItem;if(this.model.mayHaveChildren(item)||this.showInlineEditor){var popup=this._getPopup(item);if(popup){args.popup=popup;}}var _2299=new cls(args);return _2299;},handleChildChildrenChange:function(child,_229a){if(_229a.length===0){child.destroyPopup();child.attr("hasChildren",false);}else{if(!child.popup){var popup=this._getPopup(child.item);if(popup){child.setPopup(popup);child.attr("hasChildren",true);popup.load();this.onItemHover(child);}}}},getTopAnchor:function(){if(this.anchor){var _229b=this.anchor.getParent();return _229b&&_229b.getTopAnchor?_229b.getTopAnchor():this.anchor;}else{return null;}},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this._openPopup();}else{var _229c=this.getTopAnchor();if(_229c){_229c.getParent().focusNext();}}},_onChildBlur:function(item){if(!item||!item.domNode){return;}return this.inherited(arguments);},onItemHover:function(item){if(!this.inlineEditor||!this.inlineEditor.isEditing()){this.isActive=true;return this.inherited(arguments);}},onItemClick:function(child,evt){if(child.attr("disabled")){return false;}this.onExecute();child.onClick(evt);if(child.item){this.onModelItemClick(child,child.item);}this._isClosing=true;this.close();},_onKeyPress:function(evt){if(this.inlineEditor&&this.inlineEditor.isEditing()&&dojo.isDescendant(evt.target,this.inlineEditor.domNode)){return;}if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._exitKey:if(this.parentMenu){this.onCancel(false);}else{var _229d=this.getTopAnchor();if(_229d){_229d.getParent().focusPrev();}}dojo.stopEvent(evt);break;case this._openKey:this._moveToPopup(evt);dojo.stopEvent(evt);break;}},canClose:function(){return !this.inlineEditor||(this.inlineEditor&&!this.inlineEditor.isEditing());}});dojo.declare("com.ibm.widgets._DataMenuItem",null,{templateString:"<tr class=\"dijitReset dijitMenuItem\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitem\" tabIndex=\"-1\""+"dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">"+"<td dojoAttachPoint=\"dndHandleNode\" class=\"dijitReset dragHandle\" waiRole=\"presentation\">"+"<img dojoAttachPoint=\"iconNode\" src=\"${_blankGif}\" alt=\"\" />"+"<span class=\"dragHandleA11y\">|</span>"+"</td>"+"<td class=\"dijitReset dijitMenuItemLabel\" dojoAttachPoint=\"containerNode\"></td>"+"<td class=\"dijitReset dijitMenuArrowCell\" waiRole=\"presentation\">"+"<div class=\"modelHasChildrenIcon\" dojoAttachPoint=\"arrowWrapper\">"+"<div class=\"dijitMenuExpand\"></div>"+"<span class=\"dijitMenuExpandA11y\">+</span>"+"</div>"+"</td>"+"</tr>",_setDndHandleAttr:function(value){this.dndHandle=value;dojo[value?"addClass":"removeClass"](this.dndHandleNode,"dojoDndHandle");},_setHasChildrenAttr:function(value){this.hasChildren=value;dojo[value?"addClass":"removeClass"](this.domNode,"modelHasChildren");},_setDndStatusAttr:function(value){this.dndStatus=value;if(this.popup){this.popup[value?"setupDnd":"disableDnd"]();}},focus:function(){var _229e=this.getParent();if(!_229e.dndSource||!_229e.dndSource.isDragging){this.inherited(arguments);}}});dojo.declare("com.ibm.widgets.DataMenuItem",[dijit.MenuItem,com.ibm.widgets._DataMenuItem],{});dojo.declare("com.ibm.widgets.DataPopupMenuItem",[dijit.MenuItem,com.ibm.widgets._DataMenuItem],{constructor:function(){this._popupConnects=null;},startup:function(){this.inherited(arguments);if(this.popup){this.setPopup(this.popup);}},setPopup:function(popup){this.popup=popup;this.popup.anchor=this;this._popupConnects=[this.connect(this.focusNode,"onfocus","loadPopup"),this.connect(this.popup,"onLoading","onLoading"),this.connect(this.popup,"onLoad","onLoad")];this.popup.startup();if(this.arrowWrapper){dojo.style(this.arrowWrapper,"visibility","");}dijit.setWaiState(this.focusNode,"haspopup","true");},destroyPopup:function(){if(this.popup){dojo.forEach(this._popupConnects,this.disconnect,this);this._popupConnects=null;this.popup.destroyRecursive();delete this.popup;dijit.setWaiState(this.focusNode,"haspopup","false");}},loadPopup:function(){if(this.popup){this.popup.load();}},onLoad:function(){},onLoading:function(){},_onHover:function(){this.loadPopup();this.inherited(arguments);},destroyDescendants:function(){this.destroyPopup();this.inherited(arguments);}});dojo.declare("com.ibm.widgets.LoadingMenuItem",dijit.MenuItem,{label:"Loading...",iconClass:"ibmLoading",postMixInProperties:function(){this.shelfBundle=dojo.i18n.getLocalization("com.ibm.bundles","Shelf");this.label=this.shelfBundle.shelf_loading;}});dojo.declare("com.ibm.widgets.EditorMenuItem",[dijit.MenuItem,com.ibm.widgets.InlineEditorWrapper],{templateString:"<tr class=\"dijitReset dijitMenuItem inlineEditor lotusMenuSeparator\" dojoAttachPoint=\"focusNode\" waiRole=\"menuitem\" tabIndex=\"-1\""+"dojoAttachEvent=\"onmouseenter:_onHover,onmouseleave:_onUnhover,onkeypress:_onKeyPress\">"+"<td class=\"dijitReset\" waiRole=\"presentation\"><div class=\"dijitMenuItemIcon\" dojoAttachPoint=\"iconNode\"></div></td>"+"<td class=\"dijitReset dijitMenuItemLabel\" dojoAttachPoint=\"containerNode\"><span dojoAttachPoint=\"editor\">${label}</span></td>"+"<td class=\"dijitReset dijitMenuArrowCell\" waiRole=\"presentation\"></td>"+"</tr>",attributeMap:dojo.mixin(dojo.clone(dijit.MenuItem.prototype.attributeMap),{label:{node:"editor",type:"innerHTML"}}),postCreate:function(){this.inherited(arguments);dojo.setSelectable(this.domNode,true);},focus:function(){var _229f=this.getParent();if(!_229f.dndSource||!_229f.dndSource.isDragging){this.inherited(arguments);}},_onKeyPress:function(evt){if(!evt.ctrlKey&&!evt.altKey&&evt.charOrCode==dojo.keys.ENTER&&!this.isEditing()){this.editor.edit();dojo.stopEvent(evt);return false;}}});}if(!dojo._hasResource["com.ibm.widgets.DataTabBar"]){dojo._hasResource["com.ibm.widgets.DataTabBar"]=true;dojo.provide("com.ibm.widgets.DataTabBar");dojo.require("com.ibm.widgets.TabBar");dojo.require("com.ibm.widgets.DataMenu");dojo.require("com.ibm.widgets.SelectionModeled");dojo.declare("com.ibm.widgets.DataTabBar",[com.ibm.widgets.TabBar,com.ibm.widgets.SelectionModeled],{tabWidget:"com.ibm.widgets.DataTab",menuWidget:"com.ibm.widgets.DataMenu",closeDelay:500,openDelay:0,dndHorizontal:true,loadingIndicatorWidget:"com.ibm.widgets.LoadingTab",inlineEditorWidget:"com.ibm.widgets.ShowEditorTab",showNestedInlineEditor:false,postCreate:function(){this.inherited(arguments);this.initializeModelWidget();this._dndParams.withHandles=true;dojo.addClass(this.domNode,"modeledTabs");if(this.tabStrip){dojo.addClass(this.tabList,this["class"]+"Strip");}},startup:function(){this.inherited(arguments);this.startupModelWidget();this.load();},getInheritableParameters:function(item){return dojo.mixin(this.inherited(arguments),{closeDelay:this.closeDelay,popupDelay:this.popupDelay,showInlineEditor:this.showNestedInlineEditor,dndClass:this.dndClass});},handlePreloaded:function(){dojo.forEach(this.getChildren(),function(wij){if(this.model.mayHaveChildren(wij.item)||this.showNestedInlineEditor){var popup=this._getPopup(wij.item);if(popup){wij.setPopup(popup);popup.startup();}}},this);return this.inherited(arguments);},_getPopup:function(item){if(this.level<this.levels){var _22a0=dojo.getObject(this.menuWidget);return new _22a0(this.getInheritableParameters(item));}return null;},createItemRep:function(item){var _22a1=dojo.getObject(this.tabWidget);var args={label:com.ibm.domUtilities.encodeXML(this.model.getLabel(item)),iconClass:"dragHandleIcon",model:this.model,item:item};if(this.tabClass){args["class"]=this.tabClass;}if(this.model.mayHaveChildren(item)||this.showNestedInlineEditor){var popup=this._getPopup(item);if(popup){args.popup=popup;}}var _22a2=new _22a1(args);_22a2.startup();return _22a2;},handleChildChildrenChange:function(child,_22a3){if(!this.showNestedInlineEditor){if(_22a3.length==0){child.destroyPopup();child.attr("hasChildren",false);}else{if(!child.popup){var popup=this._getPopup(child.item);if(popup){child.setPopup(popup);child.attr("hasChildren",true);popup.load();this.onItemHover(child);}}}}},markSelected:function(_22a4,value){dojo[value?"addClass":"removeClass"](_22a4.domNode,this.selectedClass);if(_22a4.labelNode){if(value){var _22a5=com.ibm.domUtilities.removeChildren(_22a4.labelNode);var _22a6=dojo.create("strong",null,_22a4.labelNode);_22a5.place(_22a6);if(this.selectionModel.atLevel(0)==_22a4.item){var _22a7=dojo.create("span",{innerHTML:this.currentlySelected,className:"ibmPortalHiddenText"});_22a6.appendChild(_22a7);}}else{var label=dojo.query("strong",_22a4.labelNode);if(label[0]){var _22a5=com.ibm.domUtilities.removeChildren(label[0]);_22a5.place(_22a4.labelNode);dojo.destroy(label[0]);}}}},onItemFocus:function(child){if(child.popup){child.popup.load();}this.inherited(arguments);},onItemHover:function(child,evt){if(child.popup){child.popup.load();}this.inherited(arguments);},onItemClick:function(child,evt){if(child.attr("disabled")){return false;}child.onClick(evt);if(child.item){this.onModelItemClick(child,child.item);}}});dojo.declare("com.ibm.widgets.DataTab",com.ibm.widgets.Tab,{_setHasChildrenAttr:function(value){this.hasChildren=value;dojo[value?"addClass":"removeClass"](this.domNode,"modelHasChildren");},_setDndStatusAttr:function(value){this.dndStatus=value;if(this.popup){this.popup[value?"setupDnd":"disableDnd"]();}},item:null});dojo.declare("com.ibm.widgets.LoadingTab",com.ibm.widgets._TabBase,{templateString:"<li class=\"${class}\" waiRole=\"presentation\" dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onclick:onClick,onmouseenter:_onHover,onmouseleave:_onUnhover\"\n\t><div\n\t\t><img alt=\"\" dojoAttachPoint=\"iconNode\" src=\"${_blankGif}\" class=\"${iconClass}\"\n\t\t/><a dojoAttachPoint=\"labelNode,focusNode\" href=\"javascript:;\" class=\"tabLabel\" waiRole=\"tab\" onclick=\"javascript:return false;\">${label}</a\n\t></div\n></li>\n","class":"loadingTab lotusTab",iconClass:"ibmLoading",label:"Loading...",postMixInProperties:function(){this.shelfBundle=dojo.i18n.getLocalization("com.ibm.bundles","Shelf");this.label=this.shelfBundle["shelf_loading"];},attributeMap:dojo.mixin(dojo.clone(dijit._Widget.prototype.attributeMap),{label:{node:"labelNode",type:"innerHTML"},iconClass:{node:"iconNode",type:"class"}}),isFocusable:function(){return false;}});}if(!dojo._hasResource["com.ibm.widgets.NavigationWidget"]){dojo._hasResource["com.ibm.widgets.NavigationWidget"]=true;dojo.provide("com.ibm.widgets.NavigationWidget");dojo.require("com.ibm.widgets.DataTabBar");dojo.require("com.ibm.widgets.DataMenu");dojo.declare("com.ibm.widgets.NavigationWidget",com.ibm.widgets.DataTabBar,{menuWidget:"com.ibm.widgets.NavigationMenu","class":"lotusTabContainer",tabListClass:"lotusTabs",tabClass:"lotusTab",selectedClass:"lotusSelected",menuBaseClass:"lotusActionMenu",nestedInlineEditorLabel:"",emptyContentsInlineEditorLabel:"",constructor:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.bundles","NavWidget");this.inlineEditorLabel=this.bundle.nav_new_page_label;this.inlineEditorDefaultValue=this.bundle.nav_new_page_default_value;this.nestedInlineEditorLabel=this.bundle.nav_new_page_nested_label;this.emptyContentsInlineEditorLabel=this.bundle.nav_new_page_empty_nested_label;this.inlineEditorTitle=this.bundle.nav_new_page_title;},postMixInProperties:function(){this.inherited(arguments);if(!this.embeddedEditorParams.invalidMessage){this.embeddedEditorParams.invalidMessage=this.bundle.nav_new_page_invalid_message;}if(!this.embeddedEditorParams.promptMessage){this.embeddedEditorParams.promptMessage=this.bundle.nav_new_page_prompt_message;}},postCreate:function(){this.inherited(arguments);dijit.setWaiRole(this.containerNode,"menubar");if(dojo.isOpera){this.connect(this,"onLoad",function(){dojo.query(".ibmPortalList").addContent(" ");});}},getInheritableParameters:function(item){return dojo.mixin(this.inherited(arguments),{inlineEditorLabel:this.nestedInlineEditorLabel,emptyContentsInlineEditorLabel:this.emptyContentsInlineEditorLabel,"class":this.menuBaseClass});}});dojo.declare("com.ibm.widgets.NavigationMenu",com.ibm.widgets.DataMenu,{emptyContentsInlineEditorLabel:"","class":"lotusActionMenu",constructor:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.bundles","NavWidget");this.inlineEditorLabel=this.bundle.nav_new_page_label;this.inlineEditorDefaultValue=this.bundle.nav_new_page_default_value;this.nestedInlineEditorLabel=this.bundle.nav_new_page_nested_label;this.emptyContentsInlineEditorLabel=this.bundle.nav_new_page_empty_nested_label;this.inlineEditorTitle=this.bundle.nav_new_page_title;},postMixInProperties:function(){this.inherited(arguments);if(!this.embeddedEditorParams.invalidMessage){this.embeddedEditorParams.invalidMessage=this.bundle.nav_new_page_invalid_message;}if(!this.embeddedEditorParams.promptMessage){this.embeddedEditorParams.promptMessage=this.bundle.nav_new_page_prompt_message;}},postCreate:function(){this.inherited(arguments);dijit.setWaiRole(this.containerNode,"navigation");if(this.showInlineEditor&&this.level==1){this.connect(this,"onLoad",function(){if(this.inlineEditor){if(this.getChildren().length<2){this.inlineEditor.editor.attr("value",this.emptyContentsInlineEditorLabel);}}});this.connect(this,"onModelRemoveChild",function(_22a8,_22a9){if(this.item==_22a8&&this.getChildren().length<2){this.inlineEditor.editor.attr("value",this.emptyContentsInlineEditorLabel);}});this.connect(this,"onModelInsertChild",function(_22aa,_22ab,_22ac){if(this.item==_22aa){this.inlineEditor.editor.attr("value",this.inlineEditorLabel);}});}},getInheritableParameters:function(item){return dojo.mixin(this.inherited(arguments),{emptyContentsInlineEditorLabel:this.emptyContentsInlineEditorLabel});}});}if(!dojo._hasResource["com.ibm.widgets.Breadcrumbs"]){dojo._hasResource["com.ibm.widgets.Breadcrumbs"]=true;dojo.provide("com.ibm.widgets.Breadcrumbs");dojo.declare("com.ibm.widgets.Breadcrumbs",[dijit._Widget,dijit._Templated],{model:null,treeModel:null,item:null,parent:null,siblings:{},startLevel:null,levels:Number.MAX_VALUE,renderSiblings:true,newSiblingText:"",newSiblingDefaultValue:"",embeddedEditorWidget:"dijit.form.TextBox",allowNew:true,newEditor:null,embeddedEditorParams:{},introText:"",listDOM:"ul",itemDOM:"li",containerClass:"",listClass:"",ancestorClass:"",siblingClass:"",newClass:"",ancestorSeparator:" > ",siblingSeparator:" | ",templateString:"<div dojoAttachPoint=\"focusNode\" class=\"${containerClass}\"><span dojoAttachPoint=\"introTextNode\"></span><${listDOM} dojoAttachPoint=\"trail\" class=\"${listClass}\"></${listDOM}></div>",constructor:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.bundles","NavWidget");this.theme=dojo.i18n.getLocalization("com.ibm.bundles","Theme");this.introText=this.bundle["breadcrumb_intro"];this.newSiblingText=this.bundle["breadcrumb_new_page_label"];this.newSiblingDefaultValue=this.bundle["nav_new_page_default_value"];this.currentlySelected=this.theme["currently_selected"];},postMixInProperties:function(){this.inherited(arguments);if(!this.embeddedEditorParams.invalidMessage){this.embeddedEditorParams.invalidMessage=this.bundle["nav_new_page_invalid_message"];}if(!this.embeddedEditorParams.promptMessage){this.embeddedEditorParams.promptMessage=this.bundle["nav_new_page_prompt_message"];}},postCreate:function(){this.treeModel=this.model.treeModel;this.connect(this.model,"onSelectionPathChange","redraw");this.connect(this.treeModel,"onTreeChange","onModelTreeChange");},startup:function(){this.inherited(arguments);this.draw();},draw:function(){var path=this.model.getPath();this.parent=path[1];if(path.length-this.startLevel<=1){this.introTextNode.innerHTML="";return;}this.introTextNode.innerHTML=this.introText;for(var i=1;i<path.length&&i<=this.levels&&i<(path.length-this.startLevel);i++){this.createDomLink(path[i],this.ancestorClass,this.ancestorSeparator,this.trail.firstChild);}if(this.renderSiblings){this.siblings=[];this.shelfBundle=dojo.i18n.getLocalization("com.ibm.bundles","Shelf");var _22ad=document.createTextNode(this.shelfBundle["shelf_loading"]);this.trail.appendChild(_22ad);this.treeModel.getChildren(path[1],dojo.hitch(this,function(_22ae){this.trail.removeChild(_22ad);this.createDomText(path[0],this.siblingClass,this.siblingSeparator,null);var _22af=this.treeModel.getIdentity(path[0]);dojo.forEach(_22ae,function(_22b0){if(_22af!=this.treeModel.getIdentity(_22b0)){this.siblings.push({item:_22b0,node:this.createDomLink(_22b0,this.siblingClass,this.siblingSeparator,null)});}},this);this.createEditBox();}));}else{this.createDomText(path[0],this.siblingClass,this.siblingSeparator,null);this.createEditBox();}},redraw:function(_22b1){this.trail.innerHTML="";this.draw();},onModelTreeChange:function(_22b2,_22b3,_22b4,_22b5){var _22b6=this.model.getPath()[0];if(_22b3!=_22b4&&_22b2!=_22b6){if(this.parent==_22b3){this.onModelRemoveChild(_22b2);}else{if(this.parent==_22b4){var isNew=(!_22b3)?true:false;this.onModelInsertChild(_22b2,isNew);}}}},onModelRemoveChild:function(_22b7){var path=this.model.getPath();if(path.length-this.startLevel<=1){return;}for(var i=0;i<this.siblings.length;i++){if(_22b7==this.siblings[i].item){this.trail.removeChild(this.siblings[i].node);delete this.siblings[i].item;delete this.siblings[i].node;this.siblings.splice(i,1);return;}}},onModelInsertChild:function(_22b8,isNew){var path=this.model.getPath();if(path.length-this.startLevel<=1){return;}if(this.renderSiblings){var _22b9=this.newEditor;var _22ba=(_22b9)?_22b9.domNode:null;var node=this.createDomLink(_22b8,this.siblingClass,this.siblingSeparator,_22ba);if(isNew){dojo.addClass(node,"disabled");}this.siblings.push({item:_22b8,node:node});if(!_22b8.created){setTimeout(function(){dijit.focus(node);},0);var conn=dojo.connect(_22b8,"onCreate",this,function(){node.firstChild.href=top.location.href+"?uri="+this.treeModel.getIdentity(_22b8);dojo.removeClass(node,"disabled");dojo.disconnect(conn);});}}},createDomLink:function(item,_22bb,_22bc,node){var _22bd=document.createElement(this.itemDOM);dojo.addClass(_22bd,_22bb);var link=document.createElement("a");_22bd.appendChild(link);_22bd.appendChild(document.createTextNode(_22bc));link.appendChild(document.createTextNode(this.treeModel.getLabel(item)));var url=top.location.href;if(url.indexOf("#")>-1){url=url.substring(0,url.indexOf("#"));}if(url.indexOf("?")>-1){url=url.substring(0,url.indexOf("?"));}link.href=url+"?uri="+this.treeModel.getIdentity(item);this.trail.insertBefore(_22bd,node);return _22bd;},createDomText:function(item,_22be,_22bf,node){var _22c0=document.createElement(this.itemDOM);dojo.addClass(_22c0,_22be);var _22c1=dojo.create("span",{innerHTML:this.currentlySelected,className:"ibmPortalHiddenText"});var _22c2=dojo.create("span");_22c2.appendChild(_22c1);_22c0.appendChild(document.createTextNode(this.treeModel.getLabel(item)));_22c0.appendChild(_22c1);_22c0.appendChild(document.createTextNode(_22bf));this.trail.insertBefore(_22c0,node);return _22c0;},createEditBox:function(){if(this.allowNew){this.newEditor=new com.ibm.widgets.BreadcrumbsEditor({embeddedEditorWidget:this.embeddedEditorWidget,embeddedEditorParams:this.embeddedEditorParams,"class":this.newClass,label:this.newSiblingText,defaultValue:this.newSiblingDefaultValue});this.newEditor.editor.width="10em";this.newEditor.editor.lineHeight="1.5em";this.connect(this.newEditor,"onChange","createNewSiblingItem");this.trail.appendChild(this.newEditor.domNode);}},onClickItem:function(item){if(!item.created){return false;}top.location.href=top.location.href+"?uri="+this.treeModel.getIdentity(item);},createNewSiblingItem:function(value,focus){var _22c3=null;var _22c4=function(){_22c3.onCreate();};_22c3=this.treeModel.newItem(dojo.mixin(value,{onComplete:_22c4,scope:this}),this.parent);_22c3._onCreate=function(){};}});dojo.declare("com.ibm.widgets.BreadcrumbsEditor",[dijit._Widget,dijit._Templated,com.ibm.widgets.InlineEditorWrapper],{templateString:"<span class=\"inlineEditor ${class}\" waiRole=\"presentation\"><a dojoAttachPoint=\"editor,focusNode\" class=\"newPageLink\" href=\"javascript:;\">${label}</a></span>"});}if(!dojo._hasResource["com.ibm.dnd.PageCreator"]){dojo._hasResource["com.ibm.dnd.PageCreator"]=true;dojo.provide("com.ibm.dnd.PageCreator");dojo.declare("com.ibm.dnd.PageCreator",null,{creator:function(item,hint){var node=document.createElement("div");if(hint=="avatar"){node.className="ibmPortalDndPageAvatar";var title=document.createTextNode(item);node.appendChild(title);}return {node:node,data:item,type:["cmNode"]};}});com.ibm.dnd.PAGE_CREATOR=new com.ibm.dnd.PageCreator();}if(!dojo._hasResource["com.ibm.UnloadGuard"]){dojo._hasResource["com.ibm.UnloadGuard"]=true;dojo.provide("com.ibm.UnloadGuard");(function(){var _22c5={};var _22c6=function(){for(var x in _22c5){if(_22c5[x]&&_22c5[x].length>0){return x;}}return false;};var _22c7=function(_22c8){if(!_22c5[_22c8]){_22c5[_22c8]=[];}_22c5[_22c8].push(true);};var _22c9=function(_22ca){if(_22c5[_22ca]){_22c5[_22ca].pop();}if(!_22c6()){dojo.publish("/window/unload/nonePending");}};dojo.subscribe("/window/unload/addPending",null,_22c7);dojo.subscribe("/window/unload/removePending",null,_22c9);window.onbeforeunload=function(){var msg=_22c6();if(msg!==false){return msg;}};})();}if(!dojo._hasResource["com.ibm.widgets.StatusBar"]){dojo._hasResource["com.ibm.widgets.StatusBar"]=true;dojo.provide("com.ibm.widgets.StatusBar");dojo.require("dojox.data.dom");dojo.declare("com.ibm.widgets.StatusType",null,{constructor:function(id,_22cb,_22cc,_22cd){this._id=id;this._styleClass=_22cb;this._iconPath=_22cc;this._color=_22cd;}});dojo.declare("com.ibm.widgets.StatusMessage",null,{constructor:function(type,_22ce,_22cf){this._type=type;this._message=_22ce;this._details=_22cf;}});dojo.declare("com.ibm.widgets.StatusColorFader",null,{constructor:function(_22d0,_22d1){this._containerId=_22d0;this._beginColorStr="";this._endColorStr="";this._redCtr=0;this._greenCtr=0;this._blueCtr=0;this._endRed=0;this._endGreen=0;this._endBlue=0;this.setEndColor(_22d1);this._fadeCallbackId=null;this._enable=true;},fade:function(){var _22d2=true;for(var ctr=0;ctr<10;ctr++){if(this._redCtr<this._endRed){this._redCtr++;_22d2=false;}else{if(this._redCtr>this._endRed){this._redCtr--;_22d2=false;}}if(this._greenCtr<this._endGreen){this._greenCtr++;_22d2=false;}else{if(this._greenCtr>this._endGreen){this._greenCtr--;_22d2=false;}}if(this._blueCtr<this._endBlue){this._blueCtr++;_22d2=false;}else{if(this._blueCtr>this._endBlue){this._blueCtr--;_22d2=false;}}}if(_22d2){this.stop();}else{var _22d3="#"+this.getHexString(this._redCtr)+this.getHexString(this._greenCtr)+this.getHexString(this._blueCtr);var _22d4=document.getElementById(this._containerId);if(_22d4!=null){_22d4.style.backgroundColor=_22d3;}else{this.stop();}}},start:function(){if(this._enable){var _22d5=document.getElementById(this._containerId);_22d5.style.backgroundColor=this._beginColorStr;var me=this;this._fadeCallbackId=self.setInterval(function(){me.fade();},20);}},stop:function(){if(this._fadeCallbackId!=null){clearInterval(this._fadeCallbackId);}},setBeginColor:function(_22d6){this._beginColorStr=_22d6;this._redCtr=this.getColorValue(_22d6,"r");this._greenCtr=this.getColorValue(_22d6,"g");this._blueCtr=this.getColorValue(_22d6,"b");},setEndColor:function(_22d7){this._endColorStr=_22d7;this._endRed=this.getColorValue(_22d7,"r");this._endGreen=this.getColorValue(_22d7,"g");this._endBlue=this.getColorValue(_22d7,"b");},getColorValue:function(_22d8,rgb){var _22d9="";if(rgb=="r"){_22d9=_22d8.slice(1,3);}else{if(rgb=="g"){_22d9=_22d8.slice(3,5);}else{if(rgb=="b"){_22d9=_22d8.slice(5);}}}var rv=parseInt(_22d9,16);return rv;},getHexString:function(num){var rv=0;if(num>=16){rv=num.toString(16);}else{rv="0"+num.toString(16);}return rv;},setEnable:function(value){this._enable=value;}});dojo.declare("com.ibm.widgets.StatusBar",[dijit._Widget,dijit._Templated],{uid:"statusBar",locale:"en",errorGifPath:"",warningGifPath:"",infoGifPath:"",multipleMessagesGifPath:"",showDetails:false,isBidi:false,templateString:"<div class=\"statusBar\"\r\n\t><div dojoAttachEvent=\"\"\r\n\t\t\twaiRole=\"alert\" \r\n\t\t\tclass=\"ibmPortalStatusBar\" \r\n\t\t\tdojoAttachPoint=\"containerNode,focusNode\"\r\n\t></div\r\n></div>\r\n",postCreate:function(){this._messages=[];this._numMessages=0;this._baseURL=window.location.protocol+"//"+window.location.host;this._statusTypesMap={"error":new com.ibm.widgets.StatusType(0,"ibmPortalError",this._baseURL+this.errorGifPath,"#FF0000"),"warning":new com.ibm.widgets.StatusType(1,"ibmPortalWarning",this._baseURL+this.warningGifPath,"FFFF00"),"info":new com.ibm.widgets.StatusType(2,"ibmPortalInfo",this._baseURL+this.infoGifPath,"#0077FF"),"multiple":new com.ibm.widgets.StatusType(3,"ibmPortalMultiple",this._baseURL+this.multipleMessagesGifPath,"#E9CAF9")};this._statusHandler=dojo.subscribe("/portal/status",this,this.addMessage);this._summaryHeaderId="ibmPortalStatusBarHeader";var _22da=this._statusTypesMap.multiple._color;this.colorFader=new com.ibm.widgets.StatusColorFader(this._summaryHeaderId,_22da);if(typeof (ibmCfg)!="undefined"&&ibmCfg.portalConfig){this.isBidi=ibmCfg.portalConfig.isRTL;}else{if(typeof (ibmPortalConfig)!="undefined"){this.isBidi=ibmPortalConfig.isRTL;}else{if(typeof (ibmConfig)!="undefined"){this.isBidi=ibmConfig.isBidi;}}}},startup:function(){this.inherited(arguments);},_getStatusContainer:function(){return this.containerNode;},setShowDetails:function(_22db){this.showDetails=_22db;},toggleShowDetails:function(){this.setShowDetails(!this.showDetails);this.colorFader.setEnable(false);this.render();this.colorFader.setEnable(true);},clear:function(){var _22dc=this._getStatusContainer();dojox.data.dom.removeChildren(_22dc);this._messages.length=0;},print:function(){var _22dd=window.open("","status","resizable=yes,scrollbars=yes,menubar=no,toolbar=yes,status=no,width=800px,height=600px,screenX=10px,screenY=10px,top=10px,left=10px");var _22de=_22dd.document;_22de.title="Status";var _22df=_22dd.document.createElement("base");_22df.setAttribute("href",window.location.protocol+"//"+window.location.host);_22de.documentElement.childNodes[0].appendChild(_22df);_22de.body.innerHTML="<div id='statusBar' class='statusBar'></div>";for(x in this._messages){var _22e0=this._statusTypesMap[this._messages[x]._type];var entry=_22de.createElement("div");entry.className=_22e0._styleClass;var _22e1=_22de.createElement("h3");var _22e2=_22de.createElement("div");if(this.isBidi){_22e2.className="ibmPortalStatusHeaderRHS";dojo.attr(_22e2,"dir","rtl");}else{_22e2.className="ibmPortalStatusHeaderLHS";}var icon=_22de.createElement("img");icon.src=_22e0._iconPath;_22e2.appendChild(icon);_22e2.appendChild(_22de.createTextNode(this._messages[x]._message));_22e1.appendChild(_22e2);entry.appendChild(_22e1);var _22e3=_22de.createElement("div");if(this.isBidi){dojo.attr(_22e3,"dir","rtl");}_22e3.className="ibmPortalDetails";_22e3.appendChild(_22de.createTextNode(this._messages[x]._details));entry.appendChild(_22e3);_22dd.document.getElementById("statusBar").appendChild(entry);}},addMessage:function(args){if(args.uid&&args.uid!=this.uid){return;}var _22e4=args.message;this._messages.push(_22e4);if(this._messages.length<100){this.render(this._getStatusContainer());}},render:function(_22e5){if(_22e5==null){_22e5=this._getStatusContainer();}dojox.data.dom.removeChildren(_22e5);if(this._messages.length>1){this.renderHeader(_22e5);}else{if(this._messages.length==1){this.renderMessage(_22e5,this._messages[0],this.showDetails,0);}}if(this.showDetails&&this._messages.length>1){for(x in this._messages){this.renderMessage(_22e5,this._messages[x],this.showDetails,x);}}if(!this.showDetails&&this._messages.length>1){this.colorFader.stop();var end=this._messages.length-1;var _22e6=this._statusTypesMap[this._messages[end]._type]._color;this.colorFader.setBeginColor(_22e6);this.colorFader.start();}},renderHeader:function(_22e7){var _22e8=dojo.i18n.getLocalization("com.ibm.portal","v3theme",this.locale);if(this._messages.length>1){var _22e9=new com.ibm.widgets.StatusMessage("multiple",_22e8.itemsAvailable,"");this.renderMessage(_22e7,_22e9,this.showDetails,-1);}else{if(this._messages.length==1){}}},renderMessage:function(_22ea,_22eb,_22ec,index){var _22ed=this._statusTypesMap[_22eb._type];var entry=document.createElement("div");entry.className=_22ed._styleClass;var _22ee=document.createElement("h3");_22ee.id=this._summaryHeaderId;var _22ef=document.createElement("div");if(!this.isBidi){_22ef.className="ibmPortalStatusHeaderLHS";}else{_22ef.className="ibmPortalStatusHeaderRHS";}var icon=document.createElement("img");icon.src=_22ed._iconPath;_22ef.appendChild(icon);var _22f0=null;var _22f1=dojo.i18n.getLocalization("com.ibm.portal","v3theme",this.locale);if(this._messages.length>1&&index<0){if(!this.isBidi){_22f0=document.createTextNode(""+this._messages.length+" "+_22f1.messagesAvailable);}else{_22f0=dojo.create("span");_22f0.appendChild(dojo.create("span",{innerHTML:this._messages.length+" "}));_22f0.appendChild(dojo.create("span",{innerHTML:_22f1.messagesAvailable}));}}else{if(this._messages.length==1){_22f0=document.createTextNode(_22eb._message);entry.style.marginLeft="0px";}else{_22ef.appendChild(document.createTextNode(_22eb._message));}}_22ee.appendChild(_22ef);if((this._messages.length>1&&index<0)||(this._messages.length==1)){var me=this;var _22f2=document.createElement("a");_22f2.href="javascript:void(0)";_22f2.onclick=function(e){me.toggleShowDetails();return false;};var _22f3=document.createElement("div");var _22f4=document.createElement("a");_22f4.href="javascript:void(0);";_22f4.onclick=function(e){me.clear();return false;};_22f4.appendChild(document.createTextNode(_22f1.clear));var _22f5=document.createElement("a");_22f5.href="javascript:void(0);";_22f5.onclick=function(e){me.print();};_22f5.appendChild(document.createTextNode(_22f1.print));var _22f6=_22f1.showDetails;var _22f7=_22f1.hideDetails;if(this.isBidi){_22f3.className="ibmPortalStatusHeaderLHS";}else{_22f3.className="ibmPortalStatusHeaderRHS";}_22ef.appendChild(_22f0);if(_22ec){_22f2.appendChild(document.createTextNode(_22f7));}else{_22f2.appendChild(document.createTextNode(_22f6));}_22ef.appendChild(_22f2);_22f3.appendChild(_22f4);_22f3.appendChild(_22f5);_22ee.appendChild(_22f3);}var _22f8=document.createElement("div");_22f8.className="wptheme-clearing ";_22ee.appendChild(_22f8);entry.appendChild(_22ee);if(_22ec&&index>=0){var _22f9=document.createElement("div");_22f9.className="ibmPortalDetails";_22f9.appendChild(document.createTextNode(_22eb._details));entry.appendChild(_22f9);}_22ea.appendChild(entry);}});}if(!dojo._hasResource["com.ibm.widgets.NewPageDialog"]){dojo._hasResource["com.ibm.widgets.NewPageDialog"]=true;dojo.provide("com.ibm.widgets.NewPageDialog");dojo.declare("com.ibm.widgets.NewPageDialog",[dijit.Dialog],{shelfBundle:null,dialogBundle:null,propsBundle:null,blankImg:"",autofocus:false,showMakePrivate:true,showFriendlyURL:true,showPageTemplate:false,pageTemplateData:null,value:{},templateString:"<div class=\"lotusDialogBorder lotusui\" waistate=\"labelledby-${id}\" wairole=\"dialog\" role=\"dialog\" index=\"-1\" aria-labelledby=\"${id}\" dojoAttachPoint=\"dialogDiv\">"+"<div class=\"lotusDialog\">"+"<h1>"+"<a href=\"javascript:void(0);\" dojoAttachPoint=\"closeButtonNode\" class=\"lotusBtnImg lotusClose\" title=\"${closeText}\">"+"<img src=\"${_blankGif}\" alt=\"\" aria-label=\"${closeText}\" />"+"<span class=\"lotusAltText\">X</span>"+"</a>"+"<span dojoAttachPoint=\"titleNode\">${titleText}</span>"+"</h1>"+"<form dojoAttachPoint=\"newPageForm,containerNode\" action=\"javascript:;\">"+"<div class=\"lotusDialogContent\">"+"<div>"+"<div class=\"lotusMessage\" dojoAttachPoint=\"newPageError\" style=\"display: none\" role=\"alert\">"+"<span>${nlsTitleError}</span>"+"</div>"+"<div><label for=\"${id}_name\">${nlsPageTitle}</label></div>"+"<div><input id=\"${id}_name\" type=\"text\" name=\"title\" dojoAttachPoint=\"typingNode, focusNode\" size=\"24\"/></div><br />"+"<div dojoAttachPoint=\"divFriendlyURL\">"+"<div><label for=\"${id}_friendly\">${nlsFriendlyURL}</label></div>"+"<div><input id=\"${id}_friendly\" type=\"text\" name=\"friendlyURL\" dojoAttachPoint=\"newPageFriendlyURL\" size=\"24\"/></div>"+"</div><br />"+"<div dojoAttachPoint=\"divPrivate\">"+"<input id=\"${id}_private\" type=\"checkbox\" name=\"private\" dojoAttachPoint=\"makePrivate\"/><span> <label for=\"${id}_private\">${nlsMakePrivate}</label></span>"+"</div>"+"<div dojoAttachPoint=\"divPageTemplate\">"+"<br /><a href=\"javascript:void(0);\" class=\"lotusAction\" dojoAttachPoint=\"showHideTemplateNode\">${nlsPageTemplate}</a>"+"<div dojoAttachPoint=\"divTemplate\" style=\"display: none\">"+"<div><label for=\"${id}_template\">${nlsPageTemplateLabel}</label></div>"+"<div><select dojoAttachPoint=\"templateSelect\" id=\"${id}_template\" name=\"template\"><option selected value=\"\">${nlsNoTemplate}</option></select></div>"+"</div>"+"</div>"+"</div>"+"</div>"+"<div class=\"lotusDialogFooter\" dojoAttachPoint=\"dialogFooter\">"+"<input value=\"${okText}\" class=\"lotusFormButton\" dojoAttachPoint=\"submitDialog\" type=\"submit\"/> "+"<a href=\"javascript:void(0);\" class=\"lotusAction\" dojoAttachPoint=\"dialogCancel\">${cancelText}</a>"+"</div>"+"</form>"+"</div>"+"</div>",postMixInProperties:function(){this.shelfBundle=dojo.i18n.getLocalization("com.ibm.bundles","Shelf");this.dialogBundle=dojo.i18n.getLocalization("com.ibm.bundles","PageCreatorDialog");try{this.propsBundle=dojo.i18n.getLocalization("com.ibm.bundles","properties");}catch(err){}this.cancelText=this.shelfBundle["add_content_cancel"];this.closeText=this.shelfBundle["add_content_close"];this.okText=this.dialogBundle["page_dialog_create_page"];this.nlsPageTitle=this.dialogBundle["page_dialog_page_name"];this.nlsTitleError=this.shelfBundle["new_feed_enterTitle"];this.nlsFriendlyURL=this.dialogBundle["page_dialog_friendly_url_name"];this.nlsMakePrivate=this.dialogBundle["page_dialog_make_private"];this.titleText=this.dialogBundle["page_dialog_create_page"];if(this.propsBundle){this.nlsPageTemplate=this.propsBundle["page_dialog_page_template"];this.nlsPageTemplateLabel=this.propsBundle["page_dialog_page_template_label"];this.nlsNoTemplate=this.propsBundle["page_dialog_no_template"];}if(!this.nlsPageTemplate){this.nlsPageTemplate="Page Template";this.nlsPageTemplateLabel="The new page will be based on the following page template:";this.nlsNoTemplate="No template";}this.baseUrl=location.protocol+"//"+location.host+ibmPortalConfig.contentHandlerURI;this.feedQueryUrl="?uri=nm%3Aoid%3Awps.content.template.root&levels=100";},postCreate:function(){this.inherited(arguments);this.submitDialog.onclick=dojo.hitch(this,function(){this.submit();return false;});this.closeButtonNode.onclick=this.dialogCancel.onclick=dojo.hitch(this,function(){this.cancel();return false;});if(!this.showMakePrivate){dojo.destroy(this.divPrivate);delete this.divPrivate;}this.connect(this.typingNode,"onkeyup",function(){if(this.typingNode.value!=""){this.newPageError.style.display="none";}});if(this.showFriendlyURL){this.connect(this.typingNode,"onkeyup",function(){this.filterFriendlyURL(this.typingNode.value);});this.connect(this.newPageFriendlyURL,"onkeyup",function(){this.filterFriendlyURL(this.newPageFriendlyURL.value);});}else{dojo.destroy(this.divFriendlyURL);delete this.divFriendlyURL;}if(this.showPageTemplate){this.connect(this.showHideTemplateNode,"onclick",this.showHideTemplateSection);}else{dojo.destroy(this.divPageTemplate);delete this.divPageTemplate;}},showHideTemplateSection:function(){if(this.divTemplate.style.display==="none"){if(this.pageTemplateData==null){this.pageTemplateData={keys:[],values:[]};this._getEntriesFromAtomFeed(this.baseUrl+this.feedQueryUrl);this._displayTemplateChoices();}else{this.divTemplate.style.display="block";}}else{this.divTemplate.style.display="none";}},_getEntriesFromAtomFeed:function(_22fa){var _22fb={url:_22fa,handleAs:"xml",sync:true,preventCache:true,collection:this.pageTemplateData,getNodename:this._getNodename,load:function(data,args){var node=null;var _22fc=data;var _22fd=true;if(_22fc){node=_22fc.lastChild;var c=node.childNodes;for(i=0;i<c.length;i++){if(c[i].nodeType==1){var name=args.args.getNodename(c[i]);if(!name){continue;}if(name==="entry"){if(_22fd){_22fd=false;continue;}var ec=c[i].childNodes;var _22fe=null;var _22ff=null;for(j=0;j<ec.length;j++){if(ec[j].nodeType==1){var name=args.args.getNodename(ec[j]);if(!name){continue;}if(name==="title"){if(ec[j].innerHTML){_22fe=ec[j].innerHTML;}else{_22fe=dojox.xml.parser.textContent(ec[j]);}}else{if(name==="id"){_22ff=dojox.xml.parser.textContent(ec[j]);var nsSep=_22ff.lastIndexOf(":");if(nsSep!==-1){_22ff=_22ff.substring((nsSep+1),_22ff.length);}}}}}if(_22fe&&_22ff){if(args.args.collection){args.args.collection.keys.push(_22ff);args.args.collection.values.push(_22fe);}}}}}}}};dojo.xhrGet(_22fb);},_getNodename:function(node){var name=null;if(node!==null){name=node.localName?node.localName:node.nodeName;if(name!==null){var nsSep=name.indexOf(":");if(nsSep!==-1){name=name.substring((nsSep+1),name.length);}}}return name;},_displayTemplateChoices:function(){var _2300=this.templateSelect;var _2301=this.pageTemplateData;dojo.forEach(this.pageTemplateData.keys,function(id,i){var _2302=_2301.values[i];var _2303=dojo.create("option",{innerHTML:_2302},_2300);_2303.setAttribute("value",id);});this.divTemplate.style.display="block";},_validatePageName:function(title){dojo["require"]("com.ibm.mm.builder.builderpre");var cwm=com.ibm.mm.builder.coreWidgetsMessages;if(!title){return false;}if(title.length===0){alert(cwm.E_PAGE_UTIL_INVALID_NAME_EMPTY_0);return false;}title=dojo.trim(title);if(title.length===0){alert(cwm.E_PAGE_UTIL_INVALID_NAME_BLANK_0);return false;}if(title.length>=256){alert(cwm.E_PAGE_UTIL_INVALID_NAME_LENGTH_0);return false;}var match=ibmConfig[com.ibm.mashups.enabler.services.ConfigConstants.BUILDER_TITLE_FILTER_REGEXP];if(match){if(title.match(match)){alert(cwm.E_PAGE_UTIL_INVALID_NAME_CHAR_0);return false;}}return true;},submit:function(){var _2304=this.typingNode.value.replace(/<(?:\/?).+?>/g,"");this.typingNode.value=_2304;if(_2304==""){this.newPageError.style.display="block";return;}if(!this._validatePageName(_2304)){return;}dojo.attr(this.submitDialog,"disabled","disabled");this.hide();this.beforeSubmit();var self=this;setTimeout(function(){self.onSubmit();},this.duration*2);},cancel:function(){this.hide();},onChange:function(arg){},onComplete:function(){},beforeSubmit:function(){},onSubmit:function(){this.value=dojo.formToObject(this.newPageForm);if(!this.value["private"]&&!this.showMakePrivate){this.value["private"]="on";}this.value.onComplete=this.onComplete;this.onChange(this.value);},layout:function(){if(this.domNode.style.display!="none"){this._size();}return this.inherited(arguments);},focus:function(){this.newPageError.style.display="none";if(this.showMakePrivate){this.makePrivate.checked=false;}this.typingNode.value="";if(this.showFriendlyURL){this.newPageFriendlyURL.value="";}this.submitDialog.removeAttribute("disabled");this.show();this.focusNode.focus();},filterFriendlyURL:function(_2305){var _2306=_2305.replace(/[!\*\'\(\);:@&=+$,\/?%#\[\]\s]/g,"-");this.newPageFriendlyURL.value=_2306;},destroy:function(){this.submitDialog.onclick=null;this.closeButtonNode.onclick=null;this.pageTemplateData=null;this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.pb.logging.Loggable"]){dojo._hasResource["com.ibm.pb.logging.Loggable"]=true;dojo.provide("com.ibm.pb.logging.Loggable");(function(){var _2307=com.ibm.mashups.enabler.logging.Logger;dojo.declare("com.ibm.pb.logging.Loggable",null,{LOGGER:null,constructor:function(){this.LOGGER=_2307.getLogger(this.declaredClass);}});})();}if(!dojo._hasResource["com.ibm.pb.data.ResourceLoader"]){dojo._hasResource["com.ibm.pb.data.ResourceLoader"]=true;dojo.provide("com.ibm.pb.data.ResourceLoader");dojo.declare("com.ibm.pb.data.ResourceLoader",com.ibm.pb.logging.Loggable,{_cache:{},constructor:function(){this._cache={};},getData:function(url,type){var mname="getData",lgr=this.LOGGER,me=this;if(!this._cache[url]){this._cache[url]=new com.ibm.mm.builder.DelegatorDeferredImpl(this,function(_2308,sync,_2309){var _230a=_2308.getFinishedCallback(),_230b=_2308.getFinishedCallbackParameters();lgr.trace(mname,"Start loading remote data");if(_2308._data){lgr.trace(mname,"Data already loaded ${0}",[_2308._data]);if(_230a){_230a(_2308._data,200,_230b);}}else{dojo.xhrGet({url:url,load:function(data,_230c){lgr.trace(mname,"Received response from url ${0} with data ${1}",[url,data]);_2308._hasFired=true;me._finishDeferred(_2308,data,200);},error:function(err,_230d){lgr.warning(mname,"Error getting data from url ${0}: ${1}",[url,err]);if(!_2308._hasFired){me._finishDeferred(_2308,err,me.statusCodes.HTTP_NOT_FOUND);}},handleAs:type,sync:sync});}return _2308._data;});}var dfd=new com.ibm.mm.builder.DelegatedDeferredImpl();this._cache[url].addDelegate(dfd);return dfd;},_finishDeferred:function(_230e,data,_230f){_230e._data=data;var _2310=_230e.getFinishedCallback(),_2311=_230e.getFinishedCallbackParameters();if(_2310){_2310(data,_230f,_2311);}return data;}});com.ibm.pb.data.RESOURCE_LOADER=new com.ibm.pb.data.ResourceLoader();}if(!dojo._hasResource["com.ibm.pb.localized.DojoLocalized"]){dojo._hasResource["com.ibm.pb.localized.DojoLocalized"]=true;dojo.provide("com.ibm.pb.localized.DojoLocalized");dojo.declare("com.ibm.pb.localized.DojoLocalized",[com.ibm.mashups.enabler.Localized,com.ibm.pb.logging.Loggable],{bundlePackage:"",bundleName:"",bundleKey:"",constructor:function(_2312){this.bundlePackage=_2312.bundlePackage;this.bundleName=_2312.bundleName;this.bundleKey=_2312.bundleKey;this._locales=[dojo.locale];var extra=dojo.config&&dojo.config.extraLocale;if(extra){this._locales.push.apply(this._locales,extra);}dojo["require"+"Localization"](this.bundlePackage,this.bundleName);},_getBundle:function(_2313){var mname="_getBundle",ret={};try{ret=dojo.i18n.getLocalization(this.bundlePackage,this.bundleName,_2313);this.LOGGER.trace(mname,"Found bundle for locale ${0}",[_2313]);}catch(err){this.LOGGER.warning("_getBundle","Bundle not found for locale ${0}",[_2313]);}return ret;},getLocales:function(){var mname="getLocales";this.LOGGER.entering(mname,[]);if(!this._locales.filtered){this.LOGGER.trace(mname,"Filtering locales",[]);this._locales=dojo.filter(this._locales,function(_2314){var _2315=this._getBundle(_2314);var ret=_2315[this.bundleKey]||_2315[this.bundleKey+"_title"]||_2315[this.bundleKey+"_description"];this.LOGGER.trace(mname,"Does title or description exist for locale ${0}? ${1}",[_2314,ret]);return ret;},this);this._locales.filtered=true;}this.LOGGER.exiting(mname,[this._locales]);return this._locales;},getTitle:function(_2316){var mname="getTitle";this.LOGGER.entering(mname,[_2316]);var _2317=this._getBundle(_2316);var ret=_2317[this.bundleKey+"_title"]||_2317[this.bundleKey];this.LOGGER.exiting(mname,[_2316]);return ret;},getDescription:function(_2318){var mname="getDescription";this.LOGGER.entering(mname,[_2318]);var ret=this._getBundle(_2318)[this.bundleKey+"_description"];this.LOGGER.exiting(mname,[_2318]);return ret;}});}if(!dojo._hasResource["com.ibm.pb.contextMenu.JsonContextMenuLoader"]){dojo._hasResource["com.ibm.pb.contextMenu.JsonContextMenuLoader"]=true;dojo.provide("com.ibm.pb.contextMenu.JsonContextMenuLoader");dojo.declare("com.ibm.pb.contextMenu.JsonContextMenuLoader",[com.ibm.mashups.builder.model.ContextMenuLoader,com.ibm.pb.logging.Loggable],{_df:null,statusCodes:com.ibm.mm.enabler.model.HttpStatusCodes,constructor:function(_2319){if(!_2319){throw new Error("definition must not be null");}this._df=_2319;this._data=null;},getItems:function(_231a,_231b,_231c,_231d){var mname="getItems",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);dfd=new com.ibm.mm.builder.DeferredImpl(this,function(_231e,sync,_231f){var _2320=_231e.getFinishedCallback(),_2321=_231e.getFinishedCallbackParameters(),res;if(!this._data){this.getData(function(data,_2322){if(_2322==200){res=me._initMenuItems(_231a,_231b,_231c,_231d);}else{res=data;}if(_2320){_2320(res,_2322,_2321);}},sync);}else{res=this._initMenuItems(_231a,_231b,_231c,_231d);if(_2320){_2320(res,200,_2321);}}return res;});lgr.exiting(mname,arguments);return dfd;},getData:function(_2323,sync){var mname="getData",lgr=this.LOGGER,me=this,_2324=this._df.name,_2325=com.ibm.mm.enabler.model.HttpStatusCodes.HTTP_OK;lgr.entering(mname,arguments);if(!this._data){if(this._df.data){this._data=_2324?dojo.getObject(_2324,false,this._df.data):this._df.data;if(_2323){_2323(this._data,200);}}else{if(this._df.url){lgr.trace(mname,"Requesting context menu by url ${0}",[this._df.url]);com.ibm.pb.data.RESOURCE_LOADER.getData(this._df.url,"json").setFinishedCallback(function(data,_2326,_2327){me._data=data;if(_2326==200&&_2324){me._data=dojo.getObject(_2324,false,data);}if(_2323){_2323(me._data,_2326);}}).start(sync);}else{throw new Error("Configuration error for context menu: Must specify url or data properties");}}}lgr.exiting(mname,[this._data]);return this._data;},_initMenuItems:function(_2328,_2329,_232a,_232b){var mname="_initMenuItems",lgr=this.LOGGER,ret=[],_232c=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();dojo.forEach(this._data,function(item){if(this._isVisible(item,_2329,_232a,_232b)){lgr.trace(mname,"Adding item ${0}",[item.id]);var l7d=this._getLocalized(item);ret.push(dojo.delegate(item,{enabled:this._isEnabled(item,_2329,_232a,_232b),localized:l7d,title:item.title||_232c.getTitle(l7d),description:item.description||_232c.getDescription(l7d),actionCallBackFunction:this._getAction(item,_2329,_232a,_232b)}));lgr.trace(mname,"Added item ${0}",[item.id]);}else{lgr.trace(mname,"Item ${0} is hidden",[item.id]);}},this);return ret;},_getAction:function(item,_232d,_232e,_232f){var mname="_getAction",lgr=this.LOGGER;lgr.entering(mname,[item.id,_232d,_232e,_232f]);var ret=dojo.partial(item.actionFn,_232d,_232e,item.metadata,_232f);lgr.exiting(mname,[item.id,ret]);return ret;},_isVisible:function(item,_2330,_2331,_2332){var mname="_isVisible",lgr=this.LOGGER;lgr.entering(mname,[item.id,_2330,_2331,_2332]);var ret=false;try{ret=dojo.isFunction(item.visibilityFn)?dojo.partial(item.visibilityFn)(_2330,_2331,item.metadata,_2332):true;}catch(err){lgr.severe(mname,"Error executing visibilityFn for item ${0}: ${1}",[item,err]);}lgr.exiting(mname,[item.id,ret]);return ret;},_isEnabled:function(item,_2333,_2334,_2335){var mname="_isEnabled",lgr=this.LOGGER;lgr.entering(mname,[item.id,_2333,_2334,_2335]);var ret=false;try{ret=item.stateFn?item.stateFn(_2333,_2334,item.metadata,_2335):item.enabled;}catch(err){lgr.severe(mname,"Error executing stateFn ${0}",[err]);}lgr.exiting(mname,[item.id,ret]);return ret;},_getLocalized:function(item){return new com.ibm.pb.localized.DojoLocalized(item);}});}if(!dojo._hasResource["com.ibm.lang.DeferredQueue"]){dojo._hasResource["com.ibm.lang.DeferredQueue"]=true;dojo.provide("com.ibm.lang.DeferredQueue");dojo.declare("com.ibm.lang.DeferredQueue",null,{constructor:function(def){this.curDef=def;this.firstDef=def;},_addCallbacks:function(_2336,_2337){_2336.addCallbacks(function(res){_2337.callback(res);return res;},dojo.hitch(this,function(err){try{if(!err._raised){this.raiseError(err);err._raised=true;}}catch(err2){}_2337.callback(err);return err;}));},addBefore:function(def){if(!this.firstDef){this.firstDef=def;}else{var _2338=this.firstDef;this.firstDef=def;this._addCallbacks(def,_2338);}},add:function(def){if(!this.firstDef){this.firstDef=def;}if(this.curDef){var _2339=this.curDef;this.curDef=def;this._addCallbacks(_2339,def);}else{this.curDef=def;}return this;},fire:function(res){if(this.firstDef){this.firstDef.callback(res);}return this;},raiseError:function(err){},destroy:function(){delete this.firstDef;delete this.curDef;delete this.raiseError;}});}if(!dojo._hasResource["com.ibm.data._NotificationHelper"]){dojo._hasResource["com.ibm.data._NotificationHelper"]=true;dojo.provide("com.ibm.data._NotificationHelper");dojo.declare("com.ibm.data._NotificationHelper",null,{onDelete:function(_233a){return _233a;},onNew:function(_233b,_233c){return {newItem:_233b,parentInfo:_233c};},onSet:function(item,_233d,_233e,_233f){return {item:item,attribute:_233d,oldValue:_233e,newValue:_233f};}});}if(!dojo._hasResource["com.ibm.data.EnablerModelStore"]){dojo._hasResource["com.ibm.data.EnablerModelStore"]=true;dojo.provide("com.ibm.data.EnablerModelStore");dojo.declare("com.ibm.data.EnablerModelStore",com.ibm.data._NotificationHelper,{itemClass:"com.ibm.mm.enabler.navigation.NavigationNodeImpl",_isItemCreated:false,_isDirty:false,rootNode:null,globalPage:null,globalPageInSpace:null,constructor:function(){this.navigationUtil=com.ibm.mm.builder.utils.navigationUtil;this.pageUtil=com.ibm.mm.builder.utils.pageUtil;this.spaceUtil=com.ibm.mm.builder.utils.spaceUtil;var root=this.getRootNode();this.rootNode=root;},getRootNode:function(){var pid=null;var _2340=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage();var items=[];if(!_2340){var _2341=this.spaceUtil.getCurrentSpaceId();pid=_2341?this.pageUtil.getFirstPageInSpace(_2341):this.pageUtil.getFirstRootPageId();}else{pid=_2340.getID();}if(!pid){return null;}_2340.setID(pid);var _2341=this.spaceUtil.getSpaceIdByPageId(pid);if(_2341!==this.spaceUtil.getCurrentSpaceId()){this.spaceUtil.setSpaceId(_2341);}var _2342=this.navigationUtil.getNavigationModel();var _2343=_2342.find(pid).start();var _2344=this.navigationUtil.getNavigationRootNodeId();var _2345=this.navigationUtil.getNavigationRootNodeId(this.spaceUtil.getCurrentSpaceId());while(_2343&&_2343.getID()!==_2344&&_2343.getID()!==_2345){items.push(_2343);_2343=_2342.getParent(_2343.getID()).start();}return items[items.length-1];},getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Write":true,"dojo.data.api.Identity":"id","dojo.data.api.Notification":true};},getValue:function(item,_2346,_2347){var _2348=this.getValues(item,_2346);return (_2348.length>0)?_2348[0]:_2347;},getValues:function(item,_2349){var _234a=null;switch(_2349){case "id":_234a=[item.getID()];break;case "title":if(item.title){_234a=[item.title];}else{_234a=[this.pageUtil.getUnescapedPageTitle(item.getID())];}break;case "description":_234a=[this.pageUtil.getPageDescription(item.getID())];break;case "type":_234a=item.type;break;case "parent":if(this.globalPage&&item.openPageId&&item.pageLoadedSpaceId===com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId()){if(dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid)){var _234b=dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid);var _234c=com.ibm.mm.builder.utils.pageUtil.getPageNode(_234b);var _234d=this.navigationUtil.getNavigationModel();var _234e=_234d.getParent(_234c.getID()).start();_234a=[_234e];}else{console.log("Error: previous_pid in cookie is missing!");}}else{var _234d=this.navigationUtil.getNavigationModel();var _234e=_234d.getParent(item.getID()).start();_234a=[_234e];}break;case "parentId":var _234d=this.navigationUtil.getNavigationModel();var _234e=_234d.getParent(item.getID()).start();var _234f=_234e?_234e.getID():null;_234a=[_234f];break;case "children":var _234d=this.navigationUtil.getNavigationModel();var _2350=_234d.getChildren(item);var _2351=[];while(_2350.hasNext()){var child=_2350.next();var _2352=com.ibm.mm.builder.utils.pageUtil.isVisiable(child);if(_2352){_2351.push(child);}}if(this.globalPage&&this.globalPageInSpace===com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId()){_2351.push(this.globalPage);}_234a=_2351;break;case "hasChildren":if(com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceNode()==item){return false;}var _234d=this.navigationUtil.getNavigationModel();_234a=[_234d.hasChildren(item)];break;default:_234a=null;}_234a=(_234a&&dojo.isArray(_234a))?_234a:[_234a];return _234a;},getAttributes:function(item){return ["id","title","description","type","parent","parentId","children","hasChildren"];},hasAttribute:function(item,_2353){return !!(this.getValue(item,_2353));},containsValue:function(item,_2354,value){return this.getValue(item,_2354)==value;},isItem:function(_2355){return _2355.declaredClass=="com.ibm.mm.enabler.navigation.NavigationNodeImpl"&&_2355.getID();},isItemLoaded:function(_2356){return this.isItem(_2356)&&_2356.loaded;},loadItem:function(_2357){},getLabel:function(item){return this.getValue(item,"title");},getLabelAttributes:function(item){return ["title"];},fetch:function(_2358){if(!_2358){_2358={};}var me=this;_2358.aborted=false;if(!_2358.scope){_2358.scope=dojo.global;}var query=_2358.query;var items=[];var _2359=this.navigationUtil.getNavigationModel();if(query===null){items.push(this.rootNode);}else{var _235a=com.ibm.mm.builder.utils.spaceUtil;var pid=query.uri;if(!pid){var _235b=_235a.getCurrentSpaceId();pid=_235b?this.pageUtil.getFirstPageInSpace(_235b):this.pageUtil.getFirstRootPageId();}if(pid){if(com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId()==pid){items.push(com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceNode());items.push(this.navigationUtil.getNavigationRootNode());}else{var _235c=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage();_235c.setID(pid);var _235b=_235a.getSpaceIdByPageId(pid);if(_235b!==_235a.getCurrentSpaceId()){_235a.setSpaceId(_235b);}var _235d=this.navigationUtil.getNavigationModel();var _235e=_235d.find(pid).start();while(_235e){items.push(_235e);_235e=_235d.getParent(_235e.getID()).start();}}}}items=this.processFetchedItems(items,_2358);if(_2358.onBegin){_2358.onBegin.call(_2358.scope,this.getResultSize(items.root,_2358,items),_2358);}if(_2358.onItem){for(var i=0;i<items.length;i++){if(_2358.aborted){return;}_2358.onItem.call(_2358.scope,items[i],_2358);}}if(_2358.onComplete){if(_2358.aborted){return;}if(!_2358.onItem){_2358.onComplete.call(_2358.scope,items,_2358);}else{_2358.onComplete.call(_2358.scope,null,_2358);}}},processFetchedItems:function(items,_235f){return items;},getRootItem:function(){return this.rootNode;},getIdentity:function(item){return this.getValue(item,"id");},getIdentityAttributes:function(item){return ["id"];},fetchItemByIdentity:function(_2360){var node=this.pageUtil.getPageNode(getkeywordArgs.identify);node=node?node:null;if(_2360.onItem){if(!_2360.scope){_2360.scope=dojo.global;}_2360.onItem.call(_2360.scope,node);}},deleteItem:function(item){return false;},setValue:function(item,_2361,value){var lc=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();switch(_2361){case "id":item.setID(value);break;case "title":item.setTitle(value,lc.getLocale(item)||ibmConfig.locale);break;case "description":item.setDescription(item,lc.getLocale(item)||ibmConfig.locale);break;case "type":item.type=value;break;case "parent":break;case "parentId":break;case "children":break;case "hasChildren":break;case "position":var _2362=com.ibm.mm.builder.utils.navigationUtil.getNavigationModel();_2362.insert(item,value.newParent,value.next);item.loaded=false;item.created=true;if(value.oldParent==value.newParent){this.onSet(item,_2361,value.oldParent,value.next);}else{if(value.next){this.onSet(item,"parent_next",value.oldParent,value.next);}else{this.onSet(item,"parent",value.oldParent,value.newParent);}}break;}},newItem:function(_2363,_2364){var title=_2363.label;var utils=com.ibm.mm.builder.utils;var _2365=utils.navigationUtil.getNavigationModel();var _2366;if(_2363.openPageId){_2366=com.ibm.mm.builder.utils.pageUtil.getPageNode(_2363.openPageId);_2366.loaded=false;_2366.created=false;_2366.openPageId=_2363.openPageId;_2366.pageLoadedSpaceId=_2363.pageLoadedSpaceId;_2366.onCreate=function(){};this.globalPageInSpace=_2366.pageLoadedSpaceId;this.globalPage=_2366;}else{_2366=_2365.create(null);_2366.setTitle(title,dojo.locale);_2366.setTitle(title,ibmConfig["default.locale"]);var _2367=utils.themeUtil.getThemeId(_2364.parent.getID());if(!utils.themeUtil.getThemeModel().find(_2367).start()){_2367=utils.themeUtil.getDefaultThemeId();}_2366.setTheme(_2367);_2366.title=title;_2366.loaded=false;_2366.created=false;_2366.onCreate=function(){};_2365.insert(_2366,_2364.parent,null);var lm=_2365.getLayoutModel(_2366.getID());var _2368=lm.create();lm.insert(_2368);_2368.setFragment(" ");}this.onNew(_2366,_2364);this._isItemCreated=true;return _2366;},isCreated:function(item){return !!item.created;},addOnCreate:function(item,_2369){if(this.isCreated(item)){_2369(item);}else{if(!item.onCreateDefQueue){item.onCreateDefQueue=new com.ibm.lang.DeferredQueue(new dojo.Deferred());}item.onCreateDefQueue.add((new dojo.Deferred()).addCallback(_2369));}},_fireCreated:function(item){if(item.onCreateDefQueue){try{item.onCreateDefQueue.fire(item);}catch(ex){console.log(ex);}}},save:function(_236a){var utils=com.ibm.mm.builder.utils;var _236b=utils.navigationUtil.getNavigationModel();this.keywordArgs=_236a;if(this.keywordArgs.openPageId){var _236c=com.ibm.mm.builder.utils.pageUtil.getPageNode(this.keywordArgs.openPageId);if(this._isItemCreated){this.keywordArgs=_236a;this.keywordArgs.item.onCreate();this.keywordArgs.item.created=true;this.keywordArgs.item.setID(_236c.getID());this._fireCreated(this.keywordArgs.item);this.onSaveComplete();this._isItemCreated=false;if(this.keywordArgs.onComplete){this.keywordArgs.onComplete(this.keywordArgs);}}}else{if(this._isItemCreated){this.keywordArgs=_236a;this.keywordArgs.item.onCreate();var _236d=_236b.commit();_236d.addFinishedCallback(dojo.hitch(this,function(node){this.keywordArgs.item.created=true;var es=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");es.broadcastEvent("com.ibm.mashups.builder.pageCreated",node.getID());this.keywordArgs.item.setID(node.getID());this._fireCreated(this.keywordArgs.item);this.onSaveComplete();this._isItemCreated=false;if(this.keywordArgs.onComplete){this.keywordArgs.onComplete(this.keywordArgs);}}));_236d.start(false);}if(this._isDirty){_236b.commit().start(false);this._isDirty=false;if(_236a.onComplete){_236a.onComplete(_236a);}}}},revert:function(){this._isItemCreated=false;this._isDirty=false;return false;},onSaveComplete:function(args){}});}if(!dojo._hasResource["com.ibm.data.DataTreeModel"]){dojo._hasResource["com.ibm.data.DataTreeModel"]=true;dojo.provide("com.ibm.data.DataTreeModel");dojo.declare("com.ibm.data.DataTreeModel",null,{store:null,query:null,root:null,addQueryParams:null,constructor:function(args){dojo.mixin(this,args);if(!this.addQueryParams){this.addQueryParams={};}},destroy:function(){},reset:function(){this.root=null;},getRoot:function(_236e,_236f){},mayHaveChildren:function(item){},getChildren:function(_2370,_2371,_2372){},getIdentity:function(item){return this.store.getIdentity(item);},getLabel:function(item){return this.store.getLabel(item);},getParent:function(item){},newItem:function(args,_2373){},pasteItem:function(_2374,_2375,_2376,_2377,extra){},onChange:function(item){},onChildrenChange:function(_2378,_2379){},onTreeChange:function(_237a,_237b,_237c,_237d){},toString:function(){return "[TreeModel "+this.declaredClass+"]";}});}if(!dojo._hasResource["com.ibm.data.EnablerTreeModel"]){dojo._hasResource["com.ibm.data.EnablerTreeModel"]=true;dojo.provide("com.ibm.data.EnablerTreeModel");dojo.declare("com.ibm.data.EnablerTreeModel",com.ibm.data.DataTreeModel,{eModel:null,store:null,query:null,root:null,addQueryParams:null,constructor:function(args){dojo.mixin(this,args);if(!this.addQueryParams){this.addQueryParams={};}this.connections=[];if(this.store.getFeatures()["dojo.data.api.Notification"]){this.connections.concat([dojo.connect(this.store,"onNew",this,"_onNew"),dojo.connect(this.store,"onSet",this,"_onSet"),dojo.connect(this.store,"onDelete",this,"_onDelete")]);}},destroy:function(){dojo.forEach(this.connections,dojo.disconnect);},reset:function(){this.root=null;},getRoot:function(_237e,_237f){this.root=this.store.rootNode;_237e(this.root);},mayHaveChildren:function(item){return this.store.getValue(item,"hasChildren");},getChildren:function(_2380,_2381,_2382){var store=this.store;if(this.mayHaveChildren(_2380)){_2380._children=this.store.getValues(_2380,"children");if(_2380._children&&_2380._children.length>0){_2381(_2380._children);}else{_2380._children=null;_2381(_2380._children);}}else{_2380._children=null;_2381(_2380._children);}},getIdentity:function(item){return this.store.getIdentity(item);},getLabel:function(item){return this.store.getLabel(item);},getParent:function(item){return this.store.getValue(item,"parent");},newItem:function(args,_2383){if(_2383.getRootNavigation){_2383=com.ibm.mm.builder.utils.navigationUtil.getNavigationRootNode(_2383.getID());}var _2384=this.store.newItem(args,{parent:_2383});var es=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");if(args.openPageId){this.store.save({item:_2384,onComplete:args.onComplete,onError:args.onError,scope:args.scope,openPageId:args.openPageId,pageLoadedSpaceId:args.pageLoadedSpaceId});es.broadcastEvent("com.ibm.mashups.builder.saveCheck",dojo.hitch(this,function(){es.broadcastEvents(args.eventsArray||[],args.lastVisitedPage,args.openPageId);}));}else{this.store.save({item:_2384,onComplete:args.onComplete,onError:args.onError,scope:args.scope});es.broadcastEvent("com.ibm.mashups.builder.saveCheck",dojo.hitch(this,function(){es.broadcastEvent("com.ibm.mashups.builder.switchPage",this.getIdentity(_2384));}));}return _2384;},deleteItem:function(args,item){var _2385=this.getParent(item);this.store.globalPage=null;this._removeChildItem(_2385,item,null,dojo.hitch(this,function(){this.onTreeChange(_2385,null,_2385);}));var es=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");if(args.openPagePayload){}else{es.broadcastEvent("com.ibm.mashups.builder.saveCheck",dojo.hitch(this,function(){es.broadcastEvent("com.ibm.mashups.builder.switchPage",args.lastVisitedPage);}));}},clearGlobalPageItem:function(args,item){var _2386=this.getParent(item);this.store.globalPage=null;this._removeChildItem(_2386,item,null,dojo.hitch(this,function(){this.onTreeChange(_2386,null,_2386);}));},isCreated:function(item){return this.store.isCreated(item);},addOnCreate:function(item,_2387){return this.store.addOnCreate(item,_2387);},pasteItem:function(_2388,_2389,_238a,copy,_238b,extra){this.store.setValue(_2388,"position",{newParent:_238a,oldParent:_2389,next:_238b});this.store._isDirty=true;this.store.save({});this.store.onSaveComplete();},toString:function(){return "[TreeModel "+this.declaredClass+"]";},_onNew:function(item,_238c){this.newPageItem=item;this.newPageParent=_238c.parent;this._insertChildItem(this.newPageParent,this.newPageItem,null,dojo.hitch(this,function(){this.onTreeChange(this.newPageItem,null,this.newPageParent);}));},_onDelete:function(item){},_onSet:function(item,_238d,_238e,_238f){if(_238d.indexOf("parent")>-1){var _2390=null;if(_238d=="parent_next"){_2390=this.store.getValue(item,"parent");}else{_2390=_238f;_238f=null;}this._removeChildItem(_238e,item);this._insertChildItem(_2390,item,_238f,dojo.hitch(this,function(){this.onTreeChange(item,_238e,_2390,_238f);}));}else{if(_238d=="position"){this._moveChildItem(_238e,item,_238f,dojo.hitch(this,function(){this.onTreeChange(item,_238e,_238e,_238f);}));}else{this.onChange(item);}}},refreshItemChildren:function(item,_2391){item._children=null;var func=_2391?_2391:function(items){this.onChildrenChange(item,items);};this.getChildren(item,dojo.hitch(this,func));},_insertChildItem:function(_2392,item,_2393,_2394){this.getChildren(_2392,dojo.hitch(this,function(items){if(!items){items=[];}if(!_2393){items.push(item);}else{var id=this.getIdentity(_2393);for(var i=0;i<items.length;i++){if(this.getIdentity(items[i])==id){items.splice(i,0,item);break;}}}if(_2394){_2394();}this.onChildrenChange(_2392,items);}));},_removeChildItem:function(_2395,item,_2396){this.getChildren(_2395,dojo.hitch(this,function(items){var id=this.store.getIdentity(item);if(items){for(var i=0;i<items.length;i++){if(this.store.getIdentity(items[i])==id){items.splice(i,1);break;}}}if(_2396){_2396();}this.onChildrenChange(_2395,items);}));},_moveChildItem:function(_2397,item,_2398,_2399){this.getChildren(_2397,dojo.hitch(this,function(items){var id=this.store.getIdentity(item);var _239a=items.length-1;for(var i=0;i<items.length;i++){if(this.store.getIdentity(items[i])==id){items.splice(i,1);i--;}else{if(_2398&&this.store.getIdentity(items[i])==_2398){items.splice(i,0,item);i++;}}}if(!_2398){items.push(item);}if(_2399){_2399();}this.onChildrenChange(_2397,items);}));},onTreeChange:function(_239b,_239c,_239d,_239e){},onChange:function(item){},onChildrenChange:function(_239f,items){}});}if(!dojo._hasResource["com.ibm.data.SelectionModel"]){dojo._hasResource["com.ibm.data.SelectionModel"]=true;dojo.provide("com.ibm.data.SelectionModel");dojo.declare("com.ibm.data.SelectionModel",null,{treeModel:null,selectionPath:[],constructor:function(args){dojo.mixin(this,args);this.modelConnection=dojo.connect(this.treeModel,"onTreeChange",this,"onModelTreeChange");},atLevel:function(level,_23a0){return this.selectionPath[_23a0?this.selectionPath.length-1-level:level];},getPath:function(){return this.selectionPath.slice();},onModelTreeChange:function(_23a1,_23a2,_23a3,_23a4){if(_23a2!=_23a3&&dojo.some(this.selectionPath,function(item){return this._itemIsEqual(item,_23a1);},this)){this._calculateNewPath(this.selectionPath[0]);this.onSelectionPathChange(false);}},_itemIsEqual:function(item1,item2){return (item1&&this.treeModel.getIdentity(item1))==(item2&&this.treeModel.getIdentity(item2));},_calculateNewPath:function(_23a5){var cur=_23a5;this.selectionPath.splice(0,this.selectionPath.length);while(cur){this.selectionPath.push(cur);cur=this.treeModel.getParent(cur);}},onSelectionPathChange:function(_23a6){},changeSelection:function(_23a7){this._calculateNewPath(_23a7);this.onSelectionPathChange(true);}});}if(!dojo._hasResource["com.ibm.mm.builder.navigationHelper"]){dojo._hasResource["com.ibm.mm.builder.navigationHelper"]=true;dojo.provide("com.ibm.mm.builder.navigationHelper");dojo.declare("com.ibm.mm.builder.navigationHelper",null,{loaded:false,init:function(){this.store=new com.ibm.data.EnablerModelStore();this.navigationUtil=com.ibm.mm.builder.utils.navigationUtil;this.pageUtil=com.ibm.mm.builder.utils.pageUtil;this.spaceUtil=com.ibm.mm.builder.utils.spaceUtil;var nm=com.ibm.mashups.enabler.model.Factory.getNavigationModel();var _23a8=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage();var _23a9=_23a8.getID();if(!_23a9){var _23aa=this.spaceUtil.getCurrentSpaceId();_23a9=_23aa?this.pageUtil.getFirstPageInSpace(_23aa):this.pageUtil.getFirstRootPageId();if(!_23a9&&_23aa){_23a9=_23aa;}else{currentPageID=this.navigationUtil.getNavigationRootNode().getID();}}var _23ab=dojo.hitch(this,function(items){this.treeModel=new com.ibm.data.EnablerTreeModel({newItem:function(args){args.label=args.title;return this.inherited("newItem",arguments);},root:items[items.length-1],store:this.store});this.selectionModel=new com.ibm.data.SelectionModel({treeModel:this.treeModel,selectionPath:items});this.loaded=true;});var args={onComplete:_23ab,onError:function(err){console.error(err);throw err;},query:{uri:_23a9}};if(!this.treeModel||!this.selectionModel){this.store.fetch(args);}},getStore:function(){return this.store;},getTreeModel:function(){return this.treeModel;},getSelectionModel:function(){return this.selectionModel;}});com.ibm.mm.builder.navigationHelper=new com.ibm.mm.builder.navigationHelper();}if(!dojo._hasResource["com.ibm.pb.iwidget.iWidgetBase"]){dojo._hasResource["com.ibm.pb.iwidget.iWidgetBase"]=true;dojo.provide("com.ibm.pb.iwidget.iWidgetBase");dojo.declare("com.ibm.pb.iwidget.iWidgetBase",com.ibm.pb.logging.Loggable,{builderFactory:com.ibm.mashups.builder.model.Factory,builderEvents:com.ibm.mashups.builder.iEvents,iWidgetConstants:com.ibm.mashups.iwidget.Constants,configConstants:com.ibm.mashups.enabler.services.ConfigConstants,serviceManager:com.ibm.mashups.services.ServiceManager,roleTypes:com.ibm.mashups.enabler.ac.RoleType,constructor:function(){this.runtimeModel=this.builderFactory.getRuntimeModel();this.userModel=com.ibm.mashups.enabler.model.Factory.getUserModel();this.evtSvc=this.serviceManager.getService(com.ibm.mashups.iwidget.services.EventService.SERVICE_NAME);this.configSvc=this.serviceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);},getItemSetValues:function(names){var attrs=this.iContext.getiWidgetAttributes();var map={};for(var i=0;i<names.length;i++){var val=attrs.getItemValue(names[i]);if(val!==null&&val!==undefined){map[names[i]]=val;}}return map;},convertMapTypes:function(map,keys,type){var cnv=null;switch(type){case "Number":cnv=function(key){map[key]=parseInt(map[key],10);};break;case "Boolean":cnv=function(key){map[key]=(map[key]==="true"||map[key]===true)?true:false;};break;case "Object":cnv=function(key){if(dojo.isString(map[key])){map[key]=dojo.eval(map[key]);}};break;default:cnv=function(key){};}dojo.forEach(keys,function(key){if(map[key]!==undefined){cnv(key);}},this);}});}if(!dojo._hasResource["com.ibm.pb.data.EnablerNavigationTreeModel"]){dojo._hasResource["com.ibm.pb.data.EnablerNavigationTreeModel"]=true;dojo.provide("com.ibm.pb.data.EnablerNavigationTreeModel");(function(){var _23ac=com.ibm.mashups.enabler,em=_23ac.model,state=em.state,_23ad=state.AccessorFactory,_23ae=_23ac.space.Factory,_23af=_23ac.navigation.Factory,lCtxt=_23ac.context.Factory.getLocalizedContext(),dfOpP=_23ac.DeferredOperation.prototype,_23b0={};dojo.forEach(["GET","CREATE","MODIFY","DELETE"],function(c){this[c]=dfOpP["OPERATION_"+c];},_23b0);dojo.declare("com.ibm.pb.data.EnablerNavigationTreeModel",com.ibm.pb.logging.Loggable,{SAVE_CHECK:"com.ibm.mashups.builder.saveCheck",SWITCH_PAGE:"com.ibm.mashups.builder.switchPage",root:null,nsm:null,nm:null,spm:null,codes:{HTTP_OK:200},constructor:function(args){dojo.safeMixin(this,args);if(!this.nsm){this.nsm=state.NavigationStateModelFactory.getNavigationStateModel();}if(!this.nm){this.nm=_23af.getNavigationModel();}if(!this.spm){this.spm=_23ae.getSpaceModel();}if(!this.delaySave){this.delaySave=false;}},destroy:function(){},reset:function(root){this.root=root;},_getRootBySpace:function(space,_23b1,_23b2){var mname="_getRootBySpace",lgr=this.LOGGER;lgr.entering(mname,arguments);try{var _23b3;if(space){_23b3=this.nm.find(space.getRootNavigation());}else{_23b3=this.nm.getRoot();}_23b3.setFinishedCallback(dojo.hitch(this,function(_23b4,_23b5){lgr.trace(mname,"Callback: ${0} ${1}",[_23b4,_23b5]);if(_23b4&&!(_23b4 instanceof Error)){this.root=_23b4;if(_23b2.onItem){_23b2.onItem(this.root);}}else{if(_23b2.onError){lgr.error(mname,"Error getting the root nav node in space ${0}: ${1}",[space,err]);_23b2.onError(_23b4);}}}));lgr.trace(mname,"Finding root nav node in space ${0}",[space]);node=_23b3.start(false);}catch(err){lgr.error(mname,"Error starting find operation for the root nav node in space ${0}: ${1}",[space,err]);console.error(err);}lgr.exiting(mname,arguments);},getRoot:function(_23b6,_23b7){var mname="getRoot",lgr=this.LOGGER;lgr.entering(mname,arguments);var id=_23ad.getSpaceAccessor(this.nsm).getSpaceID(),_23b8={onItem:_23b6,onError:_23b7};if(id){var dfd=this.spm.find(id);dfd.setFinishedCallback(dojo.hitch(this,"_getRootBySpace"),_23b8);dfd.start(false);}else{this._getRootBySpace(null,200,_23b8);}lgr.exiting(mname,arguments);},mayHaveChildren:function(item){return this.nm.hasChildren(item);},getChildren:function(_23b9,_23ba,_23bb){var mname="getChildren",lgr=this.LOGGER;lgr.entering(mname,arguments);var dfd=this.nm.getChildren(_23b9);var _23bc=[];dfd.setForEachCallback(function(child){lgr.trace(mname,"Got child ${0}",[child]);if(child&&!child.isHidden()){_23bc.push(child);}});dfd.setFinishedCallback(dojo.hitch(this,function(res,_23bd,_23be){lgr.trace(mname,"Finished getting children with status ${0}",[_23bd]);if(_23bd==this.codes.HTTP_OK){if(_23ba){_23ba(_23bc);}}else{if(_23bb){_23bb(res);}}}));dfd.start(false);lgr.exiting(mname,arguments);},getIdentity:function(item){if(item==null){return null;}return item.getID();},getLabel:function(item){if(item==null){return null;}return lCtxt.getTitle(item);},getParent:function(item){var mname="getParent",lgr=this.LOGGER;lgr.entering(mname,arguments);var _23bf=this.nm.getParent(item).start();lgr.exiting(mname,[_23bf]);return _23bf;},newItem:function(args,_23c0){var mname="newItem",lgr=this.LOGGER;lgr.entering(mname,arguments);if(_23c0.getRootNavigation){lgr.trace(mname,"Parent is space ${0}",[_23c0]);parentNavId=_23c0.getRootNavigation();_23c0=this.nm.find(parentNavId).start();}lgr.trace(mname,"Creating item as child of nav node ${0}",[_23c0]);var _23c1=this._createItem(args,{parent:_23c0});var es=com.ibm.mashups.services.ServiceManager.getService("eventService");var _23c2={item:_23c1,onComplete:args.onComplete,onError:args.onError,scope:args.scope};if(args.openPageId){lgr.trace(mname,"Creating global page ${0}",[rgs.openPageId]);this.save(dojo.delegate(_23c2,{openPageId:args.openPageId,pageLoadedSpaceId:args.pageLoadedSpaceId}));es.broadcastEvent(this.SAVE_CHECK,dojo.hitch(this,function(){es.broadcastEvents(args.eventsArray||[],args.lastVisitedPage,args.openPageId);}));}else{this.save(_23c2);es.broadcastEvent(this.SAVE_CHECK,dojo.hitch(this,function(){es.broadcastEvent(this.SWITCH_PAGE,this.getIdentity(_23c1));}));}this.onTreeChange(_23c1,null,_23c0,args.next);lgr.exiting(mname,[_23c1]);return _23c1;},_createItem:function(args,_23c3){var title=args.label;var _23c4,mix={loaded:false,created:false};if(args.openPageId){_23c4=this.nm.find(args.openPageId).start();mix=dojo.mixin(mix,{openPageId:args.openPageId,pageLoadedSpaceId:args.pageLoadedSpaceId});this.globalPageInSpace=args.pageLoadedSpaceId;this.globalPage=_23c4;}else{if(!this.nm.confirmCreate(args)){return;}_23c4=this.nm.create(args);_23c4.setTitle(title,lCtxt.getPreferredLocale());_23c4.setTitle(title,ibmCfg.enablerConfig["default.locale"]);mix.title=title;this.nm.insert(_23c4,_23c3.parent,args.next);}dojo.mixin(_23c4,mix);return _23c4;},save:function(_23c5){var scope=_23c5.scope||dojo.global;var utils=com.ibm.mm.builder.utils;if(_23c5.openPageId){var _23c6=this.nm.find(_23c5.openPageId).start();_23c6.created=true;_23c6.setID(_23c6.getID());this._fireCreated(_23c6);if(_23c5.onComplete){_23c5.onComplete.call(scope);}}else{var dfdOp=this.nm.commit();dfdOp.setOperationCallback(dojo.hitch(this,function(node){node.created=true;var es=com.ibm.mashups.services.ServiceManager.getService("eventService");es.broadcastEvent("com.ibm.mashups.builder.pageCreated",node.getID());node.setID(node.getID());this._fireCreated(node);}));dfdOp.setFinishedCallback(function(){if(_23c5.onComplete){_23c5.onComplete.call(scope);}});dfdOp.start(false);if(this._isDirty){this.nm.commit().start(false);this._isDirty=false;if(_23c5.onComplete){_23c5.onComplete(_23c5);}}}},_fireCreated:function(item){if(item.onCreateDefQueue&&!item.onCreateDefQueue._fired){try{item.onCreateDefQueue.fire(item);item.onCreateDefQueue._fired=true;}catch(ex){console.log(ex);}}},deleteItem:function(args,item){this.clearGlobalPageItem(args,item);var es=com.ibm.mashups.services.ServiceManager.getService("eventService");if(args.openPagePayload){}else{es.broadcastEvent(this.SAVE_CHECK,dojo.hitch(this,function(){es.broadcastEvent(this.SWITCH_PAGE,args.lastVisitedPage);}));}},clearGlobalPageItem:function(args,item){var _23c7=this.getParent(item);this.globalPage=null;this._removeChildItem(_23c7,item,null,dojo.hitch(this,function(){this.onTreeChange(_23c7,null,_23c7);}));},isCreated:function(item){return true;},addOnCreate:function(item,_23c8){if(this.isCreated(item)){if(_23c8){_23c8(item);}}else{if(!item.onCreateDefQueue){item.onCreateDefQueue=new com.ibm.lang.DeferredQueue(new dojo.Deferred());}item.onCreateDefQueue.add(new dojo.Deferred().addCallback(_23c8));}},_updateChildren:function(_23c9){if(_23c9){this.getChildren(_23c9,dojo.hitch(this,function(_23ca){this.onChildrenChange(_23c9,_23ca);}));}},pasteItem:function(_23cb,_23cc,_23cd,copy,_23ce,extra){var mname="pasteItem",lgr=this.LOGGER;lgr.entering(mname,arguments);if(!this.nm.confirmInsert(_23cb,_23cd,_23ce)){lgr.trace("confirmInsert returns false");}else{lgr.trace("insert into the tree model");this.nm.insert(_23cb,_23cd,_23ce);this.save({});this.onTreeChange(_23cb,_23cc,_23cd,_23ce);this._updateChildren(_23cc);this._updateChildren(_23cd);}lgr.exiting(mname,arguments);},toString:function(){return "[TreeModel "+this.declaredClass+"]";},_onNew:function(item,_23cf){},_onDelete:function(item){},_onSet:function(item,_23d0,_23d1,_23d2){},onTreeChange:function(_23d3,_23d4,_23d5,_23d6){},onChange:function(item){},onChildrenChange:function(_23d7,items){}});})();}if(!dojo._hasResource["com.ibm.pb.tree.Traversal"]){dojo._hasResource["com.ibm.pb.tree.Traversal"]=true;dojo.provide("com.ibm.pb.tree.Traversal");dojo.declare("com.ibm.pb.tree.Traversal",com.ibm.pb.logging.Loggable,{model:null,constructor:function(model){this.model=model;this.stopped=true;},isStopped:function(){return this.stopped;},find:function(node,test,_23d8){var mname="find",lgr=this.LOGGER;lgr.entering(mname,arguments);this.collect(node,test,function(list){_23d8(list[0]);},function(_23d9){return _23d9.list.length>0;});lgr.exiting(mname,arguments);},collect:function(node,test,_23da,stop,_23db){var mname="collect",lgr=this.LOGGER;lgr.entering(mname,arguments);this.stopped=false;if(!_23db){_23db={};}if(!_23db.list){_23db.list=[];}_23db.level=1;this.visit(node,test,_23da,stop||function(){return false;},_23db);lgr.exiting(mname,arguments);},visit:function(node,test,_23dc,stop,_23dd){var mname="visit",lgr=this.LOGGER;lgr.entering(mname,arguments);if(test(this.model,node)){lgr.trace(mname,"Found positive testing node ${0}",[node]);_23dd.list.push(node);}if(stop(_23dd)){this.stopped=true;lgr.trace(mname,"Hard stopping traversal and calling back with results ${0}",[_23dd.list]);_23dc(_23dd.list);}else{this.next(node,test,_23dc,stop,_23dd);}lgr.exiting(mname,arguments);},next:function(node,test,_23de,stop,_23df){}});}if(!dojo._hasResource["com.ibm.pb.tree.DFSTraversal"]){dojo._hasResource["com.ibm.pb.tree.DFSTraversal"]=true;dojo.provide("com.ibm.pb.tree.DFSTraversal");dojo.declare("com.ibm.pb.tree.DFSTraversal",com.ibm.pb.tree.Traversal,{next:function(node,test,_23e0,stop,_23e1){var mname="next",lgr=this.LOGGER;lgr.entering(mname,arguments);var _23e2=null;if(this.model.hasChildren(node)){lgr.trace(mname,"Traversing down children of ${0}",[node]);var _23e3={node:node,test:test,callback:_23e0,stop:stop,params:_23e1,list:[]},me=this;this.model.getChildren(node).setForEachCallback(function(){me._collectChild.apply(me,arguments);},_23e3).setFinishedCallback(function(){me._visitChildren.apply(me,arguments);},_23e3).start(false);}else{lgr.trace(mname,"Reached end of traversal at ${0}",[node]);if(!this.isStopped()){_23e0(_23e1.list);}}lgr.exiting(mname,arguments);},_collectChild:function(_23e4,_23e5){_23e5.list.push(_23e4);},_visitChildren:function(_23e6,_23e7,_23e8){var mname="_visitChildren",lgr=this.LOGGER,me=this;lgr.entering(mname,[_23e6,_23e7,_23e8]);if(_23e7!==200){lgr.severe(mname,"An error occurred ${0} ${1}",[_23e7,_23e6]);lgr.exiting(mname,arguments);return;}var _23e9=function(){if(!me.isStopped()){var _23ea=_23e8.list.shift();if(_23ea){me._visitChild(_23ea,_23e8.test,_23e9,_23e8.stop,dojo.delegate(_23e8.params,{level:_23e8.params.level+1}));}else{lgr.trace(mname,"Reached end of list of children of ${0}",[_23e8.node]);_23e8.callback(_23e8.params.list);}}else{lgr.trace(mname,"Stopped in the middle of the list of children of ${0}",[_23e8.node]);_23e8.callback(_23e8.params.list);}};lgr.exiting(mname,arguments);_23e9();},_visitChild:function(node,test,_23eb,stop,_23ec){var mname="_visitChild",lgr=this.LOGGER,me=this;lgr.trace(mname,"Visiting next node in list of children ${0}",[node]);if(!this.isStopped()){this.visit(node,test,_23eb,stop,_23ec);}else{lgr.trace(mname,"Hard stopped iterating");}}});}if(!dojo._hasResource["com.ibm.pb.control.NavigationController"]){dojo._hasResource["com.ibm.pb.control.NavigationController"]=true;dojo.provide("com.ibm.pb.control.NavigationController");dojo.declare("com.ibm.pb.control.NavigationController",com.ibm.pb.iwidget.iWidgetBase,{navigationConstants:com.ibm.mashups.enabler.navigation.Constants,accFactory:com.ibm.mashups.enabler.model.state.AccessorFactory,treeModel:null,selectionModel:null,globalPageOpened:null,_changingSelection:false,globalPageLoaded:false,openGlobalPageAgain:false,currentThemeTemplate:"",constructor:function(){var lgr=this.LOGGER,mname="constructor";lgr.entering(mname,arguments);this.themeBundle=dojo.i18n.getLocalization("com.ibm.bundles","Theme");this.navWidgetBundle=dojo.i18n.getLocalization("com.ibm.bundles","NavWidget");this.nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();this.nsm=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();this.spm=com.ibm.mashups.enabler.space.Factory.getSpaceModel();this.spaceAcc=this.accFactory.getSpaceAccessor(this.nsm);this.nm.addStrategy(new com.ibm.mashups.enabler.strategy.TreeLoadAheadStrategy(10,1));this.nm.addStrategy(new com.ibm.mashups.enabler.strategy.ListLoadAheadStrategy(50));this.treeModel=new com.ibm.pb.data.EnablerNavigationTreeModel({nm:this.nm,nsm:this.nsm,spm:this.spm});this.treeModel.getRoot=dojo.hitch(this,"getRootNavigation");this.selectionModel=new com.ibm.data.SelectionModel({treeModel:this.treeModel,selectionPath:[]});var _23ed=this.selectionModel.changeSelection;this.selectionModel.changeSelection=dojo.partial(function(node){lgr.trace("changeSelection","Changing the selection model's selection ${0}",[node]);return _23ed.apply(this,arguments);});this._changingSelection=true;this.bootstrapping=true;this._bootstrapState=false;this._calculateCurrentPage();this.evtSvc.subscribeEvent(this.iWidgetConstants.NAVSTATE_UPDATED,this,function(){var _23ee="NavStateUpdatedHandler";lgr.entering(_23ee,arguments);this.nsm=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var cid=this.getCurrentPageId();if(!this._changingSelection&&cid!==this.currentPageId){this.onSwitchPage(cid,{skipStateUpdate:true});}lgr.exiting(_23ee,arguments);});this.evtSvc.subscribeEvent(this.builderEvents.SWITCH_PAGE,this,"onSwitchPage");this.evtSvc.subscribeEvent(this.builderEvents.REFRESH_NAVIGATION,this,"onRefreshNavigation");this.evtSvc.subscribeEvent("com.ibm.mashups.builder.saveCheck",this,"dirtyPageCheck");lgr.exiting(mname,arguments);},getSelectionModel:function(){return this.selectionModel;},getTreeModel:function(){return this.treeModel;},getThemeTemplate:function(node){return node.getMetaData("com.ibm.portal.theme.template.file.name.html")||"";},getThemeId:function(node){var _23ef=node.getThemeIdentifier?node.getThemeIdentifier():null;while(!_23ef&&node){node=this.nm.getParent(node).start();_23ef=(node&&node.getThemeIdentifier)?node.getThemeIdentifier():null;}if(!_23ef){_23ef=this.runtimeModel.getCurrentTheme();}return _23ef.getID();},getRenderMode:function(node){var _23f0=node.getMetaData("com.ibm.portal.rendertype")||null;while(!_23f0&&node){node=this.nm.getParent(node).start();if(node){_23f0=node.getMetaData("com.ibm.portal.rendertype")||null;}}return _23f0||ibmConfig.defaultRenderingMode;},_visibleChildFinder:function(node){var mname="_visibleChildFinder";this._findFirstVisible(node,dojo.hitch(this,function(child){if(child&&!(child instanceof Error)){this._setCurrentNavNode(child);}else{this.LOGGER.severe(mname,"Error finding a visible child of navigation node ${0}: ${1}",[node,child]);}}));},_isNavLabel:function(model,node){return node.getNavigationElementType()===this.navigationConstants.NAVIGATION_LABEL;},_setCurrentNavNode:function(node,_23f1){var mname="_setCurrentNavNode",lgr=this.LOGGER;lgr.entering(mname,arguments);this.currentNavNode=node;this.currentPageId=node.getID();if(this.bootstrapping){this.renderMode=this.getRenderMode(node);this.bootstrapping=false;}this.currentThemeTemplate=this.getThemeTemplate(node);this._walkUpTree(node);this._updateNavigationState(this.currentPageId,_23f1);if(this.renderMode==="iwidget"){this.setBrowserTitle(node);}lgr.exiting(mname,arguments);},_calculateCurrentPage:function(){var mname="_calculateCurrentPage",lgr=this.LOGGER;lgr.entering(mname,arguments);var _23f2=this.getCurrentPageId();if(!_23f2){this._bootstrapState=true;_23f2=this.runtimeModel.getCurrentPage().getID();}else{this._bootstrapState=false;lgr.trace(mname,"Got current page from the navigation state",[]);}if(!_23f2){lgr.trace(mname,"No runtime model of current page, getting root navigation",[]);this.treeModel.getRoot(dojo.hitch(this,"_visibleChildFinder"),dojo.hitch(this,function(err){lgr.severe(mname,"Error getting root navigation node ${0}",[err]);}));}else{lgr.trace(mname,"Found current page id ${0}",[_23f2]);this.nm.find(_23f2).setFinishedCallback(dojo.hitch(this,function(node,_23f3,_23f4){if(_23f3==200){this.refresh(node.getID());}else{lgr.severe(mname,"Error finding the current page with id ${0} ${1}",[_23f2,node]);}})).start(false);}lgr.exiting(mname,arguments);},_walkUpTree:function(_23f5){var mname="_walkUpTree",lgr=this.LOGGER;if(_23f5){var dfd=this.nm.getParent(_23f5).setFinishedCallback(dojo.hitch(this,"_walkUpTree"));dfd.start(false);}else{lgr.trace(mname,"Updating selection to ${0}",[this.currentNavNode.getID()]);this.selectionModel.changeSelection(this.currentNavNode);}},_findFirstVisible:function(_23f6,_23f7){var mname="_findFirstVisible",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);var dft=new com.ibm.pb.tree.DFSTraversal(this.nm);dft.find(_23f6,function(model,_23f8){return !me._isNavLabel(model,_23f8)&&!_23f8.isHidden();},function(_23f9){lgr.trace(mname,"Found visible non-label node ${0}, executing callback",[_23f9]);_23f7(_23f9);});lgr.exiting(mname,arguments);},getCurrentSpaceId:function(){return this.spaceAcc.getSpaceID();},getCurrentPageId:function(){var _23fa=this.accFactory.getPageAccessor(this.nsm,this.getCurrentSpaceId());return _23fa.getPageID();},getRootNavigation:function(_23fb,_23fc){var mname="getRootNavigation",lgr=this.LOGGER;lgr.entering(mname,arguments);var id=this.getCurrentSpaceId(),_23fd={onItem:_23fb,onError:_23fc};if(id){var dfd=this.spm.find(id);dfd.setFinishedCallback(dojo.hitch(this,"_getRootBySpace"),_23fd);dfd.start(false);}else{this._getRootBySpace(null,200,_23fd);}lgr.exiting(mname,arguments);},_getRootBySpace:function(space,_23fe,_23ff){var mname="_getRootBySpace",lgr=this.LOGGER;lgr.entering(mname,arguments);try{var _2400;if(space){_2400=this.nm.find(space.getRootNavigation().getID());}else{_2400=this.nm.getRoot();}_2400.setFinishedCallback(dojo.hitch(this,function(_2401,_2402){var _2403=mname+":callback";lgr.entering(_2403,arguments);if(_2401&&!(_2401 instanceof Error)){this.root=_2401;if(_23ff.onItem){_23ff.onItem(_2401);}}else{if(_23ff.onError){lgr.severe(_2403,"Error getting the root nav node in space ${0}: ${1}",[space,_2401]);_23ff.onError(_2401);}}}));lgr.trace(mname,"Finding root nav node in space ${0}",[space]);_2400.start(false);}catch(err){lgr.severe(mname,"Error starting find operation for the root nav node in space ${0}: ${1}",[space,err]);}lgr.exiting(mname,arguments);},onSwitchPage:function(_2404,_2405){var mname="onSwitchPage",lgr=this.LOGGER;lgr.entering(mname,arguments);if(_2404==this.currentPageId&&!com.ibm.mm.builder.utils.pageUtil.isRoot(_2404)){lgr.trace(mname,"skipping switchPage handling as already the current page");lgr.exiting(mname,arguments);return;}this._changingSelection=true;this.nm.find(_2404).setFinishedCallback(dojo.hitch(this,"switchPageHandler"),_2405).start(false);lgr.exiting(mname,arguments);},switchPageHandler:function(_2406,_2407,_2408){var mname="switchPageHandler",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.renderMode!="iwidget"){lgr.trace(mname,"Current rendertype: ${0} - performing a full page refresh",[this.renderMode]);this._reloadToPageWithConfirm(_2406.getID());}else{var _2409=this._isNavLabel(this.nm,_2406);lgr.trace(mname,"Is ${0} a label? ${1}",[_2406,_2409]);if(_2409){this._findFirstVisible(_2406,dojo.hitch(this,function(node){if(node){this.evtSvc.broadcastEvent(this.builderEvents.SWITCH_PAGE,node.getID());}else{lgr.trace(mname,"Could not find visible non-label descendant of ${0}, loading directly",[_2406]);return this._postLabelCheck(_2406,_2408);}}));}else{this._postLabelCheck(_2406,_2408);}}lgr.exiting(mname,arguments);},_postLabelCheck:function(_240a,_240b){var mname="_postLabelCheck",lgr=this.LOGGER;lgr.entering(mname,arguments);var _240c=this.getRenderMode(_240a);if(_240c.toLowerCase()!="iwidget"){lgr.trace(mname,"Switched page rendertype: ${0}  - performing a full page refresh",[_240c]);this._reloadToPageWithConfirm(_240a.getID());}else{var _240d=this.getThemeTemplate(_240a).toLowerCase();if(_240d!=this.currentThemeTemplate&&!((_240d===""&&this.currentThemeTemplate==="theme.html")||(_240d==="theme.html"&&this.currentThemeTemplate===""))){lgr.trace(mname,"Switched theme template from ${0} to ${1}",[this.currentThemeTemplate,_240d]);return this._reloadToPageWithConfirm(_240a.getID());}else{this.currentThemeTemplate=_240d;if(this.globalPageLoaded&&iEvent.payload){this.spm.findSpaceByNavigation(_240a).setFinishedCallback(dojo.hitch(this,function(space,_240e,_240f){if(!space||space.getID()!=this.globalPageLoadedSpaceId){if(iEvent.payload!=this.globalPageOpened){this.onClearGlobalPage();}else{}}this._postGlobalPageCheck(_240a,_240f);}),_240b).start(false);}else{this._postGlobalPageCheck(_240a,_240b);}}}lgr.exiting(mname,arguments);},_postGlobalPageCheck:function(_2410,_2411){var mname="_postGlobalPageCheck",lgr=this.LOGGER;lgr.entering(mname,arguments);var cb=dojo.hitch(this,function(){try{this.refresh(_2410.getID(),true,_2411);}catch(e){this._changingSelection=false;lgr.severe(mname,"An error occured during page switching ${0}",[e]);}});this.dirtyPageCheck(cb);lgr.exiting(mname,arguments);},setBrowserTitle:function(_2412){var mname="setBrowserTitle",lgr=this.LOGGER;lgr.entering(mname,arguments);var _2413=this.treeModel.getLabel(_2412),_2414=dojo.trim(_2413||""),_2415=com.ibm.mashups.enabler.context.Factory.getPageContext();if(_2415){var _2416=this.configSvc.getValue(this.configConstants.PRODUCT_NAME);if(_2416){if(!_2413||_2414===""){_2415.setBrowserTitle(_2416);}else{_2415.setBrowserTitle(_2413);}}else{if(_2413&&_2414!==""){_2415.setBrowserTitle(_2413);}}}lgr.exiting(mname,arguments);},dirtyPageCheck:function(_2417,_2418,_2419){var mname="dirtyPageCheck",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.runtimeModel.getCurrentPage().isDirty()){lgr.trace(mname,"Page is dirty, display confirmation dialog",[]);var cws=com.ibm.mm.builder.coreWidgetsStrings;dojo["require"]("com.ibm.mm.builder.dialog.PageSaveConfirmDialog");var _241a=new com.ibm.mm.builder.dialog.PageSaveConfirmDialog({contentWarning:cws.I_PAGE_SAVE_WARNING,contentQuestion:cws.I_PAGE_SAVE_SUGGEST,btnSaveText:cws.I_COMMON_SAVE,btnNotSaveText:cws.I_PAGE_SAVE_NO_SAVE,btnCancelText:cws.I_PAGE_SAVE_KEEP_EDIT,hideNotSave:true,callbackSave:_2417,callbackNotSave:_2418,callbackCancel:_2419});_241a.show();}else{lgr.trace(mname,"Page is NOT dirty, callback immediately",[]);if(_2417){_2417();}}lgr.exiting(mname,arguments);},_reloadToPageWithConfirm:function(_241b){var cb=dojo.hitch(this,this.reloadToPage,_241b);this.dirtyPageCheck(cb);},reloadToPage:function(_241c){var mname="reloadToPage",lgr=this.LOGGER;lgr.entering(mname,arguments);this._updateNavigationState(_241c);var _241d=com.ibm.mashups.enabler.model.state.UrlGeneratorFactory.getUrlGenerator().getUrl(this.nsm,null,{skipState:true,pocURI:"nm:oid:"+_241c});lgr.trace(mname,"Navigating to URL immediately ${0}",[_241d]);lgr.exiting(mname,arguments);top.location.href=_241d;},onRefreshNavigation:function(){try{this.refresh();}catch(e){var msg=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_NAV_REFRESH_NAVIGATION_1,[e.message]);this.LOGGER.severe("onRefreshNavigation",msg);setTimeout(function(){throw e;},1);}},refresh:function(pid,_241e,_241f){var mname="refresh",lgr=this.LOGGER,me=this,node,_2420,_2421=this.getCurrentSpaceId();lgr.entering(mname,arguments);if((pid===this.globalPageOpened)&&(this.getCurrentSpaceId()===this.globalPageLoadedSpaceId)){lgr.trace(mname,"Loading global page");node=this.nm.find(pid).start();if(node){this._setCurrentNavNode(node,_241f);}if(_241e){this._changingSelection=false;this.pageUtil.setPageId(pid);this.runtimeModel.getCurrentPage().setID(pid);this.evtSvc.broadcastEvent(this.builderEvents.PAGE_SWITCHED,pid);}this.globalPageLoaded=true;}else{if(pid){if(!this.bootstrapping){lgr.trace(mname,"Checking for theme change");var _2422=this.runtimeModel.getCurrentTheme().getID();var _2423=this.nm.find(pid).start();if(_2423&&this.getThemeId(_2423)!=_2422){lgr.trace(mname,"Theme changed!");var cb=dojo.hitch(this,this.reloadToPage,pid);this.dirtyPageCheck(cb);lgr.exiting(mname,arguments);return;}}else{if(!_241f){_241f={};}_241f.skipStateUpdate=!this._bootstrapState;lgr.trace(mname,"Bootstrapping to current page ${0}",[pid]);}}else{pid=this.getCurrentPageId();if(!pid){lgr.trace(mname,"Find the first visible page from the current root");this.getRootNavigation(function(item){lgr.trace(mname,"Initiate page switch to ${0}",item);me.refresh(me.treeModel.getIdentity(item),true);},function(err){this._changingSelection=false;lgr.severe(mname,"Error getting root navigation ${0}",err.message);setTimeout(function(){throw err;},1);});lgr.exiting(mname,arguments);return;}}if(pid){lgr.trace(mname,"Reloading navigation");node=this.nm.find(pid).start();if(node){this._setCurrentNavNode(node,_241f);}}this._changingSelection=false;if(_241e||pid!==ibmPortalConfig.currentPageOID){setTimeout(dojo.hitch(this,function(){lgr.trace(mname,"Sending page switched event");this.runtimeModel.getCurrentPage().setDirty(false);this.evtSvc.broadcastEvent(this.builderEvents.PAGE_SWITCHED,pid);}),50);}}lgr.exiting(mname,arguments);},_updateNavigationState:function(_2424,_2425){var mname="_updateNavigationState",lgr=this.LOGGER;lgr.entering(mname,arguments);this.runtimeModel.getCurrentPage().setID(_2424);if(!_2425||!_2425.skipStateUpdate){this.accFactory.getPageAccessor(this.nsm,this.getCurrentSpaceId()).setPageID(_2424);this.nsm.commit({addToHistory:true}).start();}lgr.exiting(mname,arguments);},onOpenPage:function(_2426){var mname="onOpenPage",lgr=this.LOGGER;lgr.entering(mname,arguments);var es=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");var cb=dojo.hitch(this,function(){if(this.globalPageOpened){if(this.globalPageOpened==(_2426.payload||_2426.payload.pid)){if(this.globalPageOpened==this.runtimeModel.getCurrentPage().getID()){console.log("Error: you are now already in the global page you want to open");return;}this.openGlobalPageAgain=true;es.broadcastEvent("com.ibm.mashups.builder.saveCheck",dojo.hitch(this,function(){es.broadcastEvents(_2426.payload.eventsArray||[],this.lastVisitedPage,this.globalPageOpened);}));}else{var _2427={closePageId:this.globalPageOpened,openPagePayload:_2426.payload};es.broadcastEvent("com.ibm.mashups.builder.closePage",_2427);}}else{if(dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid)){this.lastVisitedPage=dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid);}else{this.lastVisitedPage=com.ibm.mm.builder.utils.pageUtil.getCurrentPageId();}this.globalPageLoadedSpaceId=com.ibm.mm.builder.utils.spaceUtil.getCurrentSpaceId();if(_2426.payload.pid){this.globalPageOpened=_2426.payload.pid;}else{this.globalPageOpened=_2426.payload;}dojo.cookie(com.ibm.mm.builder.constant.cookieKey_globalPageId,this.globalPageOpened);dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid,this.lastVisitedPage,{expires:3652});dojo.cookie(com.ibm.mm.builder.constant.cookieKey_globalPageOpenedSpaceId,this.globalPageLoadedSpaceId);if(this.lastVisitedPage===this.globalPageOpened){console.log("Error: you already in global page, please close it.");return;}var _2428=com.ibm.mm.builder.utils.pageUtil.getPageNode(this.globalPageOpened);var _2429=this.tabNavigation.model;var _242a;var _242b=function(item){_242a=item;};var _242c=function(){};_2429.getRoot(_242b,_242c);var args={title:_2428.getTitle(dojo.locale),pageLoadedSpaceId:this.globalPageLoadedSpaceId,openPageId:this.globalPageOpened};if(_2426.payload.pid){args.eventsArray=_2426.payload.eventsArray;args.lastVisitedPage=this.lastVisitedPage;}_2429.newItem(args,_2429.getParent(_242a));}});if(com.ibm.mm.builder.pageSaveChecker){com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.saveCheck",cb);}else{cb();}lgr.exiting(mname,arguments);},onClosePage:function(_242d){var mname="onClosePage",lgr=this.LOGGER;lgr.entering(mname,arguments);var _242e=null;if(_242d.payload.closePageId){_242e=_242d.payload.closePageId;}else{_242e=_242d.payload;}if(_242e!=this.globalPageOpened){console.log("Error: you are closing a global page not opened now!");return;}if(this.globalPageOpened){var _242f=com.ibm.mm.builder.utils.pageUtil.getPageNode(this.globalPageOpened);var _2430=this.tabNavigation.model;var args={"lastVisitedPage":this.lastVisitedPage};if(_242d.payload.openPagePayload){args.openPagePayload=_242d.payload.openPagePayload;}this.globalPageOpened=null;this.lastVisitedPage=null;this.globalPageLoadedSpaceId=null;this.globalPageLoaded=false;_2430.deleteItem(args,_242f);dojo.cookie(com.ibm.mm.builder.constant.cookieKey_globalPageId,null,{expires:-1});dojo.cookie(com.ibm.mm.builder.constant.cookieKey_globalPageOpenedSpaceId,null,{expires:-1});if(args.openPagePayload){this.tabNavigation.reload();var es=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");es.broadcastEvent("com.ibm.mashups.builder.openPage",args.openPagePayload);}else{dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid,null,{expires:-1});}}else{lgr.severe(mname,"Error: the global page is not open, can't close it.");}lgr.exiting(mname,arguments);},onClearGlobalPage:function(){var mname="onClearGlobalPage",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.globalPageOpened){var _2431=com.ibm.mm.builder.utils.pageUtil.getPageNode(this.globalPageOpened);this.treeModel=this.tabNavigation.model;this.globalPageOpened=null;this.lastVisitedPage=null;this.globalPageLoadedSpaceId=null;this.globalPageLoaded=false;var args={"lastVisitedPage":this.lastVisitedPage};this.treeModel.clearGlobalPageItem(args,_2431);dojo.cookie(com.ibm.mm.builder.constant.cookieKey_globalPageId,null,{expires:-1});dojo.cookie(com.ibm.mm.builder.constant.cookieKey_globalPageOpenedSpaceId,null,{expires:-1});dojo.cookie(com.ibm.mm.builder.constant.cookieKey_previous_pid,null,{expires:-1});}lgr.exiting(mname,arguments);},onUnLoad:function(){var mname="onUnLoad",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.tabNavigation){this.tabNavigation.destroy();this.tabNavigation=null;}lgr.exiting(mname,arguments);}});(function(){var _2432=null;com.ibm.pb.control.NavigationController.getController=function(){if(!_2432){_2432=new com.ibm.pb.control.NavigationController();}return _2432;};})();}if(!dojo._hasResource["com.ibm.pb.iwidget.control"]){dojo._hasResource["com.ibm.pb.iwidget.control"]=true;dojo.provide("com.ibm.pb.iwidget.control");(function(){var _2433=com.ibm.mashups.iwidget,_2434=_2433.Constants,_2435=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.iwidget.services.EventService.SERVICE_NAME),_2436=_2433.model.Factory.getGlobalWidgetModel();var iCtl=com.ibm.pb.iwidget.control={onLoad:function(id,cb){if(id){var _2437=_2436.find(id);if(_2437){if(_2437.isLoaded()===false){var me=this;_2435.subscribeEvent(_2434.WIDGET_LOADED+"."+id,null,function(){cb(_2437);});return;}else{cb(_2437);}}}cb();}};})();}if(!dojo._hasResource["com.ibm.pb.layout.LayoutParser"]){dojo._hasResource["com.ibm.pb.layout.LayoutParser"]=true;dojo.provide("com.ibm.pb.layout.LayoutParser");(function(){var lp=com.ibm.pb.layout.LayoutParser={CONTAINER_QUERY:".component-container",CONTROL_QUERY:".component-control",ID_MATCHER:/id-([\S]+)/,extractID:function(_2438){var m=(dojo.attr(_2438,"class")||"").match(lp.ID_MATCHER);return m&&m[1];},findById:function(id){return dojo.query(".id-"+id)[0];},findContainers:function(root){return dojo.query(lp.CONTAINER_QUERY,root);},findControls:function(root){return dojo.query(lp.CONTROL_QUERY,root);}};})();}if(!dojo._hasResource["com.ibm.pb.customize.enabler.ChangeStyleController"]){dojo._hasResource["com.ibm.pb.customize.enabler.ChangeStyleController"]=true;dojo.provide("com.ibm.pb.customize.enabler.ChangeStyleController");com.ibm.pb.customize.enabler.ChangeStyleController={current:"",set:"",url:"",navModel:null,parent:null,dirty:false,started:false,refresh:false,styleMetadataKey:"colorPalette",urlPrefix:ibmCfg.themeConfig.themeRootURI+"/",layoutParser:com.ibm.pb.layout.LayoutParser,startup:function(_2439){this.logger.entering("startup");this.parent=_2439;this.current=this.set;this.started=true;if(this.setupUI){this.setupUI();}if(!this.navModel){this.navModel=com.ibm.mashups.enabler.model.Factory.getNavigationModel();}this.logger.exiting("startup");},makeDirty:function(_243a){this.logger.entering("makeDirty",[_243a]);this.dirty=_243a;this.logger.exiting("makeDirty",[_243a]);},processChange:function(args){this.logger.entering("processChange",[args]);this.apply(args);if(!this.parent){this.beforeSubmit().addCallback(dojo.hitch(this,function(){this.submit(args);}));}this.logger.exiting("processChange",[args]);},apply:function(args){this.logger.entering("apply",[args]);if(args.id!=this.current){if(args.id==this.set){this.makeDirty(false);}else{if(this.dirty===false){this.makeDirty(true);}}this.current=args.id;this.url=args.url;this._switchStylesheet(this.current,this.url);}com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setDirty(true);this.logger.exiting("apply",[args]);},undo:function(args){this.logger.entering("undo",[args]);if(this.started){this.apply({id:this.set});}this.logger.exiting("undo",[args]);},beforeSubmit:function(args){this.logger.entering("beforeSubmit",[args]);var dfd=new dojo.Deferred();dfd.callback();this.logger.exiting("beforeSubmit",[args]);return dfd;},submit:function(args){this.logger.entering("submit",[args]);if(!this.dirty){if(args.onComplete){args.onComplete();}this.logger.exiting("submit",[args]);return;}var _243b=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().getID();if(_243b){var _243c=this.navModel.find(_243b);if(_243c){_243c.setFinishedCallback(dojo.hitch(this,"_setMetadata"),args);_243c.start(false);}else{this.logger.severe("submit","Cannot get page node object from Navigation Model",[args]);if(args.onError){args.onError();}}}else{this.logger.severe("submit","Cannot get current page id",[args]);if(args.onError){args.onError();}}this.logger.exiting("submit",[args]);},_setMetadata:function(page,_243d,args){this.logger.entering("_setMetadata",[page,_243d,args]);if(_243d=="200"){var _243e=page.getContent().start();if(this.url&&_243e.confirmSetMetaData(this.styleMetadataKey,this.url)){if(this.url){_243e.setMetaData(this.styleMetadataKey,this.url);}}else{if(!this.url&&_243e.confirmRemoveMetaData(this.styleMetadataKey)){_243e.removeMetaData(this.styleMetadataKey);}else{this.logger.severe("submit","User does not have permission to set or delete page metadata",[args]);if(args.onError){args.onError();}}}this.makeDirty(false);this.set=this.current;if(args.onComplete){args.onComplete();}}else{this.logger.severe("submit","Cannot find the page object for the current node",[args]);if(args.onError){args.onError();}}this.logger.exiting("_setMetadata",[page,_243d,args]);},_switchStylesheet:function(title,url){var i,_243f,found=false;for(i=0;(_243f=document.getElementsByTagName("link")[i]);i++){if(_243f.getAttribute("rel").indexOf("style")>=0&&_243f.getAttribute("title")){if(_243f.getAttribute("title")==title){_243f.disabled=false;found=true;}else{_243f.disabled=true;}}}if(!found&&url){this._loadCss(url,title,true,true);this._switchStylesheet(title);}},_loadCss:function(path,title,_2440,_2441){if(dojo.isIE){var link=document.createElement("link");link.setAttribute("disabled",_2441);if(title){link.title=title;}var head=document.getElementsByTagName("head")[0];head.appendChild(link);link.setAttribute("type","text/css");link.setAttribute("rel",(_2440)?"alternate stylesheet":"stylesheet");link.setAttribute("href",this.urlPrefix+path);link.setAttribute("media","screen");}else{var link=dojo.create("link",{type:"text/css",rel:(_2440)?"alternate stylesheet":"stylesheet",href:this.urlPrefix+path,media:"screen",disabled:_2441});if(title){link.title=title;}var head=document.getElementsByTagName("head")[0];head.appendChild(link);}},setupUICallback:function(_2442){dojo.forEach(_2442,dojo.hitch(this,function(_2443){_2443.hub.fetch({onComplete:dojo.hitch(this,function(items){dojo.forEach(items,dojo.hitch(this,function(item){if(!this.layoutParser.findById(item.id[0])&&item.url){this._loadCss(this.baseCssPath+item.url[0],item.id[0],true,true);}}));})});}));var _2444=new com.ibm.customize.ResultsList({parent:this,size:this.getSize(),draggable:this.draggable});this.center.appendChild(_2444.domNode);var _2445=new com.ibm.customize.SearchBar({searchId:this.id,imagePath:this.imagePath});this.left.appendChild(_2445.domNode);var menu=new com.ibm.customize.Menu({sources:_2442,searchId:this.id,menuTitle:this.label,blankImg:this.imagePath+"/blank.gif"});this.left.appendChild(menu.domNode);}};}if(!dojo._hasResource["com.ibm.pb.control.RenderingController"]){dojo._hasResource["com.ibm.pb.control.RenderingController"]=true;dojo.provide("com.ibm.pb.control.RenderingController");dojo.declare("com.ibm.pb.control.RenderingController",com.ibm.pb.iwidget.iWidgetBase,{MINIMIZE_CLASS:"ibm-minimized",MAXIMIZE_CLASS:"ibm-maximized",HIDDEN_CONTAINER_NAME:"ibmHiddenWidgets",PRERENDER_BUFFER_ID:"ibmPreRenderBuffer",MAXIMIZE_BUFFER_ID:"ibmMaximizeBuffer",MAXIMIZE_PLACEHOLDER_ID:"ibmMaximizePlaceHolder",STYLE_METADATA:"colorPalette",INITIAL_STYLE_ID:"initial",PAGE_STYLE_METADATA:"pageStyle",PAGE_STYLE_ID:"ibmPageStyleLink",widgetAccessor:null,navStateModel:null,maximizeBuffer:null,preRenderBuffer:null,layoutContainers:null,wStylesNodeID:"layout-wstate-styles",wStylesTemplate:[".component-control{","width: 0 !important;","height: 0 !important;","position: absolute;","top: -9999px;","z-index: -1;","}",".id-${id}{","width: 100% !important;","height: 100% !important;","position: static;","top: 0px;","z-index: 0;","}",".component-container{","height: 100% !important;","width: 100% !important;","margin: 0 !important;","padding: 0 !important;","}"].join(""),activeElement:null,layoutParser:com.ibm.pb.layout.LayoutParser,isHandleBrowserResize:false,browserResizeHandler:null,modeWidgets:{},constructor:function(){var lgr=this.LOGGER,mname="constructor";lgr.entering(mname,arguments);this.navStateModel=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();this.navModel=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();this.evtSvc.subscribeEvent(this.iWidgetConstants.CHANGE_WIDGETWINDOWSTATE,this,this.onWidgetWindowStateChange);this.evtSvc.subscribeEvent("com.ibm.mashups.builder.preRenderProcess",this,this.onPreRenderProcess);this.evtSvc.subscribeEvent("com.ibm.mashups.builder.layoutRefresh",this,this.onLayoutRefresh);this.handleBrowserResize(false);this.configService=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);this.preRenderBuffer=dojo.byId(this.PRERENDER_BUFFER_ID);this.layoutContainers=dojo.byId("layoutContainers");this.preRenderBuffer=dojo.create("div",{id:this.PRERENDER_BUFFER_ID,style:{position:"absolute",top:"-9999px"}},dojo.byId("lotusMain"),"last");this.wStylesNode=dojo.byId(this.wStylesNodeID);this.doCheckNewPage();lgr.exiting(mname,arguments);},boostrapPreRenderProcess:function(){var mname="boostrapPreRenderProcess",lgr=this.LOGGER;lgr.entering(mname,arguments);var _2446=com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().getID();var nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var page=nm.find(_2446).start();if(page&&page.getNavigationElementType()==com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL){var _2447=this.configService.getValue("labelDefaultRuntimeContent");if(_2447){if(dojo.isFunction(_2447)){_2447=_2447(_2446);}this.layoutContainers.innerHTML=_2447;this.layoutContainers.className="ibmLayoutContainers";lgr.exiting(mname,arguments);return;}}this._setActiveElement();this.preRenderBuffer.innerHTML="";this.processControls(this.layoutContainers);dojo.removeClass(this.layoutContainers,"ibmLayoutContainersHidden");if(this.activeElement){this._setActiveElementFocus();}lgr.exiting(mname,arguments);},onPreRenderProcess:function(_2448){var mname="onPreRenderProcess",lgr=this.LOGGER;lgr.entering(mname,arguments);this._setActiveElement();this.preRenderBuffer.innerHTML=_2448.markup;this.processControls(this.preRenderBuffer);var _2449=this.preRenderBuffer.innerHTML;this.preRenderBuffer.innerHTML="";if(this.activeElement){this._setActiveElementFocus();}var _244a=(_2448&&_2448._pageId)?_2448._pageId:this.runtimeModel.getCurrentPage().getID();var page=this.navModel.find(_244a).start();var _244b=page.getMetaData("transition");var _244c=null;if(ibmCfg&&ibmCfg.themeConfig&&ibmCfg.themeConfig.transitions){if(_244b){_244c=ibmCfg.themeConfig.transitions[_244b];}else{_244c=ibmCfg.themeConfig.transitions[ibmCfg.themeConfig.transitions.fallback];}}this.evtSvc.broadcastEvent("com.ibm.mashups.builder.preRenderComplete",{"id":_2448.id,"markup":_2449,"fn":_244c,"_pageId":_244a});this.doChangeStyle(_2448.id);this.doCheckNewPage();lgr.exiting(mname,arguments);},processControls:function(node){var mname="processControls",lgr=this.LOGGER;lgr.entering(mname,arguments);this.controls=new Array();var _244d=null;if(this.maximizeBuffer){dojo.destroy(this.maximizeBuffer);}if(this.wStylesNode){previous=this.wStylesNode;dojo.destroy(previous);}this.maximizeBuffer=dojo.create("div",{id:this.MAXIMIZE_BUFFER_ID,style:{display:"none"}},node,"last");dojo.forEach(dojo.query(".component-control",node),function(_244e){var id=this.layoutParser.extractID(_244e);_244d=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(this.navStateModel,id);this.controls.push({node:_244e,id:id,state:_244d.getWindowState()});},this);dojo.forEach(this.controls,function(_244f){if(_244f.state=="minimize"){this._processMinimize(_244f.node);}},this);dojo.forEach(this.controls,function(_2450){if(_2450.state=="maximize"){this._processMaximize(_2450.node,node);}},this);lgr.exiting(mname,arguments);},addModeWidgets:function(mode,_2451){if(!this.modeWidgets[mode]){this.modeWidgets[mode]=[];}this.modeWidgets[mode].push.apply(this.modeWidgets[mode],_2451);},changePageMode:function(mode,cb){var page=this.runtimeModel.getCurrentPage(),_2452=page.getPageMode(),me=this;if(mode&&mode!=_2452){var _2453=(typeof ibmCfg.themeConfig.editModeJSURL!=="undefined");var _2454=function(){var _2455=me.modeWidgets[mode];var cmCbk=function(){me.evtSvc.broadcastEvent("com.ibm.mashups.builder.changePageMode",mode);page.setPageMode(mode);if(cb){cb();}};if(_2453&&!me.editModeInitialized){com.ibm.themes.PageBuilder2.initEditMode();me.editModeInitialized=true;}if(_2455&&!_2455.loaded&&_2455.length>0){var count=_2455.length,_2456=function(){if(--count<=0){_2455.loaded=true;cmCbk();}};dojo.forEach(_2455,function(_2457){this.onLoad(_2457,_2456);},com.ibm.pb.iwidget.control);}else{cmCbk();}};if(_2453&&!this.editModeInitialized){dojo.io.script.get({url:ibmCfg.themeConfig.editModeJSURL,checkString:"com.ibm.pb.PB2EditModeLoadedFlag",load:_2454});}else{_2454();}}},onLayoutRefresh:function(_2458){if(this.widgetAccessor&&this.widgetAccessor.getWindowState()==this.widgetAccessor.MAX){this.evtSvc.publishEvent(this.iWidgetConstants.CHANGE_WIDGETWINDOWSTATE,{id:this.widgetAccessor.wid,newWindowState:this.widgetAccessor.NORMAL,oldWindowState:this.widgetAccessor.MAX});}},onWidgetWindowStateChange:function(_2459){var mname="onWidgetWindowStateChange",lgr=this.LOGGER;lgr.entering(mname,arguments);this.widgetAccessor=com.ibm.mashups.enabler.model.state.AccessorFactory.getWidgetAccessor(this.navStateModel,_2459.id);this.currentWidget=this.layoutParser.findById(_2459.id);switch(_2459.newWindowState){case this.widgetAccessor.MIN:this.doMinimize(_2459);break;case this.widgetAccessor.MAX:this.doMaximize(_2459);break;default:this.doRestore(_2459);}lgr.exiting(mname,arguments);},doMinimize:function(_245a){var mname="doMinimize",lgr=this.LOGGER;lgr.entering(mname,arguments);this.widgetAccessor.setWindowState(this.widgetAccessor.MIN);this._processMinimize(this.currentWidget);if(_245a.oldWindowState==this.widgetAccessor.MAX){this._processMinimize(this.currentWidget);this._removeMaximize(this.currentWidget);}this._updateNavStateModel(_245a);lgr.exiting(mname,arguments);},doMaximize:function(_245b){var mname="doMaximize",lgr=this.LOGGER;lgr.entering(mname,arguments);this.widgetAccessor.setWindowState(this.widgetAccessor.MAX);if(_245b.oldWindowState==this.widgetAccessor.MIN){this._removeMinimize(this.currentWidget);}this._setActiveElement();this._processMaximize(this.currentWidget,this.layoutContainers);if(this.activeElement){this._setActiveElementFocus();}this._updateNavStateModel(_245b);lgr.exiting(mname,arguments);},doRestore:function(_245c){var mname="doRestore",lgr=this.LOGGER;lgr.entering(mname,arguments);this.widgetAccessor.setWindowState(this.widgetAccessor.NORMAL);if(_245c.oldWindowState==this.widgetAccessor.MIN){this._removeMinimize(this.currentWidget);}else{if(_245c.oldWindowState==this.widgetAccessor.MAX){this._removeMaximize(this.currentWidget);}}this._updateNavStateModel(_245c);lgr.exiting(mname,arguments);},doCheckNewPage:function(){var mname="doCheckNewPage",lgr=this.LOGGER;lgr.entering(mname,arguments);if(ibmCfg.themeConfig.autoEditNewPages&&dojo.query(".component-control",this.layoutContainers).length==0){lgr.trace(mname,"Going into edit mode on a blank page");this.changePageMode("edit");}lgr.exiting(mname,arguments);},doChangeStyle:function(id){var mname="doChangeStyle",lgr=this.LOGGER;lgr.entering(mname,arguments);var nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var pid=id||com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().getID();var _245d=nm.find(pid);_245d.setFinishedCallback(dojo.hitch(this,function(page){this._processPageStyle(page.getMetaData(this.PAGE_STYLE_METADATA));var _245e=page.getContent();_245e.setFinishedCallback(dojo.hitch(this,function(_245f){this._findAggregatedColorPalette(nm,_245f,page);}));_245e.start(false);}));_245d.start(false);lgr.exiting(mname,arguments);},_processPageStyle:function(url){var mname="_processPageStyle",lgr=this.LOGGER;lgr.entering(mname,arguments);var link=dojo.byId(this.PAGE_STYLE_ID),head=document.getElementsByTagName("head")[0];if(link){head.removeChild(link);delete link;}if(url){var _2460=dojo.create("link",{type:"text/css",id:this.PAGE_STYLE_ID,rel:"stylesheet",href:url,media:"screen"});head.appendChild(_2460);}lgr.exiting(mname,arguments);},_processColorPalette:function(url){var mname="_processColorPalette",lgr=this.LOGGER;lgr.entering(mname,arguments);var csc=com.ibm.pb.customize.enabler.ChangeStyleController;var title=this.INITIAL_STYLE_ID;if(url){title=url.substring(url.lastIndexOf("/")+1);}dojo.hitch(csc,"_switchStylesheet",title,url)();ibmCfg.portalConfig.aggregatedStyle=url;dojo.publish("com.ibm.pb.customize.pageStyleChanged",[url]);lgr.exiting(mname,arguments);},_findAggregatedColorPalette:function(_2461,_2462,page){var style=_2462.getMetaData(this.STYLE_METADATA);if(style){this._processColorPalette(style);}else{var _2463=_2461.getParent(page);_2463.setFinishedCallback(dojo.hitch(this,function(_2464){if(!_2464){this._processColorPalette(null);}else{if(_2464.getContent){var _2465=_2464.getContent();_2465.setFinishedCallback(dojo.hitch(this,function(_2466){this._findAggregatedColorPalette(_2461,_2466,_2464);}));_2465.start(false);}else{this._findAggregatedColorPalette(_2461,_2464,_2464);}}}));_2463.start(false);}},_processMinimize:function(_2467){var mname="_processMinimize",lgr=this.LOGGER;lgr.entering(mname,arguments);dojo.addClass(_2467,this.MINIMIZE_CLASS);lgr.exiting(mname,arguments);},_processMaximize:function(_2468,_2469){var mname="_processMaximize",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.wStylesNode){var _246a=dojo.string.substitute(this.wStylesTemplate,{id:this.layoutParser.extractID(_2468)||""}),_246b=this.wStylesNode;this.wStylesNode=dojo.create("div",{id:this.wStylesNodeID,style:{"display":"none"}},dojo.body());this.wStylesNode.innerHTML=["<p>&nbsp;</p><style>",_246a,"</style>"].join("");dojo.destroy(_246b);}else{var _246c=dojo.contentBox(_2469).h;var _246d=dojo.byId(this.MAXIMIZE_BUFFER_ID);dojo.addClass(_2468,this.MAXIMIZE_CLASS);dojo.create("div",{id:this.MAXIMIZE_PLACEHOLDER_ID,style:{display:"none"}},_2468,"after");if(dojo.isIE){_2469.focus();}var nodes=dojo.query("> DIV",_2469);for(var i=0,j=nodes.length;i<j;i++){var node=nodes[i];if(dojo.hasClass(node,"component-container")||dojo.hasClass(node,"component-container-resizer")){_246d.appendChild(node);}}dojo.place(_2468,_2469,"last");}lgr.exiting(mname,arguments);},_removeMinimize:function(_246e){var mname="_removeMinimize",lgr=this.LOGGER;lgr.entering(mname,arguments);dojo.removeClass(_246e,this.MINIMIZE_CLASS);lgr.exiting(mname,arguments);},_removeMaximize:function(_246f){var mname="_removeMaximize",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.wStylesNode){previous=this.wStylesNode;dojo.destroy(previous);}else{dojo.removeClass(_246f,this.MAXIMIZE_CLASS);var _2470=dojo.byId(this.MAXIMIZE_PLACEHOLDER_ID);if(_2470){_2470.parentNode.replaceChild(_246f,_2470);dojo.query(".component-container").forEach(function(_2471){if(_2471.getAttribute("name")!=this.HIDDEN_CONTAINER_NAME){this.layoutContainers.appendChild(_2471);}},this);}}lgr.exiting(mname,arguments);},_setActiveElement:function(){if(document.activeElement){this.activeElement=document.activeElement;}},_setActiveElementFocus:function(){if(this.activeElement.nodeName=="IFRAME"){return;}this.activeElement.focus();this.activeElement=null;},_updateNavStateModel:function(_2472){var mname="_updateNavStateModel",lgr=this.LOGGER;lgr.entering(mname,arguments);this.evtSvc.publishEvent(com.ibm.mashups.iwidget.Constants.WIDGET_WINDOWSTATECHANGED,{id:_2472.id,oldWindowState:_2472.oldWindowState,newWindowState:_2472.newWindowState});this.navStateModel.commit().start();lgr.exiting(mname,arguments);},handleBrowserResize:function(val){if(val==true&&!this.isHandleBrowserResize){this.isHandleBrowserResize=val;this.browserResizeHandler=dojo.connect(window,"onresize",this,"_handleBrowserResize");}else{if(val==false&&this.isHandleBrowserResize){this.isHandleBrowserResize=val;if(this.browserResizeHandler){dojo.disconnect(this.browserResizeHandler);this.browserResizeHandler=null;}}}},_handleBrowserResize:function(){var _2473=dojo.byId("lotusMain");if(_2473){var cols=dojo.query(".ibmDndColumn",_2473);for(var i=0,_2474=cols.length;i<_2474;i++){var nodes=dojo.query(".iw-iWidget",cols[i]);for(var j=0,_2475=nodes.length;j<_2475;j++){var _2476=nodes[j].id;var box=dojo.contentBox(nodes[j].parentNode);var _2477={"newWidth":box.w,"newHeight":box.h};var _2478=com.ibm.mashups.services.ServiceManager.getService("eventService");_2478.publishEvent(com.ibm.mashups.iwidget.Constants.RESIZE_WIDGET+"."+_2476,_2477);}}}}});(function(){var _2479=null;com.ibm.pb.control.RenderingController.getController=function(){if(!_2479){_2479=new com.ibm.pb.control.RenderingController();}return _2479;};})();}if(!dojo._hasResource["com.ibm.domUtilities"]){dojo._hasResource["com.ibm.domUtilities"]=true;dojo.provide("com.ibm.domUtilities");dojo.require("dojox.xml.parser");dojo.require("com.ibm.portal.xslt");(function(){var dUtil=com.ibm.domUtilities={constants:{NodeTypes:{element:1,attribute:2,text:3,cdata:4,entity_reference:5,entity:6,processing_instruction:7,comment:8,document:9,document_type:10,document_fragment:11,notation:12}},nsInfo:function(str,_247a){var parts=str.split(":");var _247b,_247c;if(parts.length>1){_247b=parts[0];_247c=parts[1];return {namespaceURI:_247a[_247b],prefix:_247b,localName:_247c};}else{return {namespaceURI:null,prefix:null,localName:str};}},getAttribute:function(node,_247d,_247e){var ret=null;var parts=dUtil.nsInfo(_247d,_247e);if(parts.namespaceURI){if(node.getAttributeNS){ret=node.getAttributeNS(parts.namespaceURI,parts.localName);}else{if(dojo.isIE||window.ActiveXObject!==undefined){ret=node.attributes.getQualifiedItem(parts.localName,parts.namespaceURI);if(ret){ret=ret.value;}}else{ret=node.getAttribute(_247d);}}}else{ret=node.getAttribute(_247d);}return ret;},setAttribute:function(node,_247f,value,_2480){if(value===true){value="true";}else{if(value===false){value="false";}else{if(value===null){value="";}}}var parts=dUtil.nsInfo(_247f,_2480);if(parts.namespaceURI){if(node.setAttributeNS){node.setAttributeNS(parts.namespaceURI,_247f,value);}else{if((dojo.isIE||window.ActiveXObject!==undefined)&&node.ownerDocument){var _2481=node.ownerDocument.createNode(dUtil.constants.NodeTypes.attribute,_247f,parts.namespaceURI);_2481.value=value;node.setAttributeNode(_2481);}else{node.setAttribute(_247f,value);}}}else{node.setAttribute(_247f,value);}},removeAttribute:function(node,_2482,_2483){var parts=dUtil.nsInfo(_2482,_2483);if(parts.namespaceURI){if(node.removeAttributeNS){node.removeAttributeNS(parts.namespaceURI,_2482);}else{if(dojo.isIE||window.ActiveXObject!==undefined){node.attributes.removeQualifiedItem(parts.localName,parts.namespaceURI);}else{node.removeAttribute(_2482);}}}else{node.removeAttribute(_2482);}},hasAttribute:function(node,_2484,_2485){var ret=null;var parts=dUtil.nsInfo(_2484,_2485);if(parts.namespaceURI){if(node.hasAttributeNS){ret=node.hasAttributeNS(parts.namespaceURI,parts.localName);}else{if(dojo.isIE||window.ActiveXObject!==undefined){ret=node.attributes.getQualifiedItem(parts.localName,parts.namespaceURI)!==null;}else{ret=node.hasAttribute(_2484);}}}else{if(!(dojo.isIE||window.ActiveXObject!==undefined)){ret=node.hasAttribute(_2484);}else{ret=node.getAttributeNode(_2484)!==null;}}return ret;},createDocument:function(data,_2486){if(typeof ActiveXObject!="undefined"||window.ActiveXObject!==undefined){var _2487=["MSXML2.FreeThreadedDOMDocument.6.0","Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.3.0"];for(var i=0;i<_2487.length;i++){try{oXml=new ActiveXObject(_2487[i]);if(oXml){break;}}catch(e){if(i==_2487.length){console.warn("Error creating Msxml.DOMDocument; reason: ",e);}}}oXml.async=false;if(data){oXml.loadXML(data);if(oXml.parseError.errorCode!=0){var error=oXml.parseError;console.warn("Error parsing XML data. Reason: '"+error.reason+"'; data: '"+data+"'.");}}return oXml;}else{return dojox.xml.parser.parse(data,_2486);}},createElement:function(doc,_2488,_2489,_248a){var node=null;var parts=dUtil.nsInfo(_2488,_2489);if(parts.namespaceURI){if(doc.createElementNS){node=doc.createElementNS(parts.namespaceURI,_2488);}else{if(dojo.isIE||window.ActiveXObject!==undefined){node=doc.createNode("element",_2488,parts.namespaceURI);}}}if(!node){node=doc.createElement(_2488);}for(var name in _248a){dUtil.setAttribute(node,name,_248a[name],_2489);}return node;},createFromJson:function(doc,def,_248b,_248c){var obj=null;if(!dojo.isObject(def)){obj=doc.createTextNode(def);if(_248c){_248c.appendChild(obj);}}else{obj=dUtil.createElement(doc,def.name,_248b,def.attributes);if(_248c){_248c.appendChild(obj);}dojo.forEach(def.children,function(_248d){dUtil.createFromJson(doc,_248d,_248b,obj);});}return obj;},removeChildren:function(node){var arr=[];while(node.hasChildNodes()){arr.push(node.removeChild(node.firstChild));}return dojo.NodeList.apply(null,arr);},textContent:function(node,text){return dojox.xml.parser.textContent.apply(null,arguments);},innerXML:function(node){return dojox.xml.parser.innerXML(node);},stringFromDoc:function(node){return dUtil.innerXML(node);},docFromString:function(str){return dUtil.createDocument(str&&str.length>0?str:null);},encodeXML:function(_248e,_248f){if(dojo.isString(_248e)){_248e=_248e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;");if(_248f){_248e=_248e.replace(/'/gm,"&#039;").replace(/"/gm,"&#034;");}return _248e;}else{if(_248e!==null){return _248e;}else{return "";}}},decodeXML:function(_2490,_2491){if(dojo.isString(_2490)){_2490=_2490.replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&amp;/gm,"&");if(_2491){_2490=_2490.replace(/&#039;/gm,"'").replace(/&#034;/gm,"\"");}return _2490;}else{if(_2490!=null){return _2490;}else{return "";}}}};dUtil.constants.MSXML_NodeTypes=dUtil.constants.NodeTypes;})();}if(!dojo._hasResource["com.ibm.pb.decorations.DecorationManager"]){dojo._hasResource["com.ibm.pb.decorations.DecorationManager"]=true;dojo.provide("com.ibm.pb.decorations.DecorationManager");dojo.declare("com.ibm.pb.decorations.DecorationManager",com.ibm.pb.logging.Loggable,{controlClass:"component-control",layoutParser:com.ibm.pb.layout.LayoutParser,constructor:function(){this._comps={};this.evtSvc=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");this.evtSvc.subscribeEvent("com.ibm.mashups.builder.pageSwitched",this,"reset");this.evtSvc.subscribeEvent("com.ibm.mashups.builder.widgetDeleted",this,"unregisterControl");},processTag:function(tag){var mname="processTag",lgr=this.LOGGER;lgr.entering(mname,arguments);if(dojo.hasClass(tag,this.controlClass)){lgr.trace(mname,"Found control ${0}",[tag]);var _2492=dojo.query("a[rel=decoration],span.decoration",tag)[0];if(_2492){lgr.trace(mname,"Found decoration ${0} on control",[_2492]);this.registerControl(tag,_2492);}}lgr.exiting(mname,arguments);},unprocessTag:function(tag){if(dojo.hasClass(tag,this.controlClass)){lgr.trace(mname,"Found control ${0}",[tag]);var id=this.layoutParser.extractID(tag);if(id){this.unregisterControl(id);}}},reset:function(){for(var id in this._comps){this.unregisterControl(id);}},registerControl:function(_2493,_2494){var mname="registerControl",lgr=this.LOGGER;lgr.entering(mname,arguments);var ret=null;try{var id=this.layoutParser.extractID(_2493),name=com.ibm.domUtilities.textContent(_2494);var ctr=dojo.getObject(name);if(!ctr){dojo["require"](name);ctr=dojo.getObject(name);if(!ctr){lgr.severe(mname,"${0} not found",[name]);return;}}ret=this._comps[id]=new ctr(id,_2493);this.evtSvc.broadcastEvent("com.ibm.mashups.builder.skinLoaded",{widgetId:id,skinNodeId:id,skinParam:{}});}catch(err){lgr.severe(mname,"Error instantiating control delegate ${0}",[err]);}lgr.exiting(mname,[ret]);return ret;},unregisterControl:function(id){var mname="unregisterControl",lgr=this.LOGGER;lgr.entering(mname,arguments);var ret=false;if(this._comps[id]){this._comps[id].destroy();delete this._comps[id];ret=true;}lgr.exiting(mname,[ret]);return ret;}});com.ibm.pb.decorations.DECORATION_MANAGER=new com.ibm.pb.decorations.DecorationManager();}if(!dojo._hasResource["com.ibm.pb.decorations.Control"]){dojo._hasResource["com.ibm.pb.decorations.Control"]=true;dojo.provide("com.ibm.pb.decorations.Control");dojo.declare("com.ibm.pb.decorations.Control",com.ibm.pb.logging.Loggable,{evtSvc:com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService"),constructor:function(id,node){this.id=id;this.node=node;this.connections=[];},connect:function(scope,func,cbk){this.connections.push(dojo.connect.apply(dojo,[scope,func,this,cbk]));return this.connections.slice(-1);},destroy:function(){while(this.connections.length>0){dojo.disconnect(this.connections.shift());}}});}if(!dojo._hasResource["com.ibm.pb.contextMenu.ShadowContextMenuLoader"]){dojo._hasResource["com.ibm.pb.contextMenu.ShadowContextMenuLoader"]=true;dojo.provide("com.ibm.pb.contextMenu.ShadowContextMenuLoader");dojo.declare("com.ibm.pb.contextMenu.ShadowContextMenuLoader",[com.ibm.mashups.builder.model.ContextMenuLoader,com.ibm.pb.logging.Loggable],{builderFactory:com.ibm.mashups.builder.model.Factory,shadowedMenuId:"",constructor:function(_2495){this.shadowedMenuId=_2495;this.builderFactory.getContextMenuModel().registerListener(_2495,this,"onChange");},getItems:function(_2496,_2497,_2498,_2499){return this.builderFactory.getContextMenuModel().getContextMenuDeferred(this.shadowedMenuId,_2497,_2498,_2499);}});}if(!dojo._hasResource["com.ibm.pb.decorations.ControlMenu"]){dojo._hasResource["com.ibm.pb.decorations.ControlMenu"]=true;dojo.provide("com.ibm.pb.decorations.ControlMenu");dojo.declare("com.ibm.pb.decorations.ControlMenu",com.ibm.pb.logging.Loggable,{builderFactory:com.ibm.mashups.builder.model.Factory,baseContextMenuId:"widgetActions",constructor:function(_249a,_249b,_249c){var mname="constructor",lgr=this.LOGGER,me=this;this._connections=[];if(_249c){this.baseContextMenuId=_249c;}this.controlId=_249a;this.contextMenuId=_249b;this.contextMenuLoader=new com.ibm.pb.contextMenu.ShadowContextMenuLoader(this.baseContextMenuId);this.builderFactory.getContextMenuModel().registerContextMenu(_249b,this.contextMenuLoader);this.evtSvc=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");dojo.forEach(["com.ibm.mashups.iwidget.widgetmodechanged","com.ibm.mashups.iwidget.widgetwindowstatechanged"],function(evt){this._connections.push(this.evtSvc.subscribeEvent(evt,this,this._checkChange));},this);dojo.forEach(["com.ibm.mashups.builder.moveAction","com.ibm.mashups.builder.hideWidget","com.ibm.mashups.builder.displayWidget"],function(evt){this._connections.push(this.evtSvc.subscribeEvent(evt,this,function(id){this._checkChange({id:id});}));},this);this._connections.push(this.evtSvc.subscribeEvent("com.ibm.mashups.builder.changePageMode",this,function(){this._checkChange({id:this.controlId});}));},_checkChange:function(obj){var mname="_checkChange",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);if(this.controlId==obj.id){lgr.trace(mname,"Firing change event for widget context menu ${0}",[this.controlId]);this.contextMenuLoader.onChange();}lgr.exiting(mname,arguments);},destroy:function(){this.builderFactory.getContextMenuModel().registerContextMenu(this.contextMenuId,null);delete this.contextMenuLoader;while(this._connections.length>0){this.evtSvc.unsubscribeEvent(this._connections.shift());}}});}if(!dojo._hasResource["com.ibm.pb.extension.contextmenu.ContextMenuAcOperation"]){dojo._hasResource["com.ibm.pb.extension.contextmenu.ContextMenuAcOperation"]=true;dojo.provide("com.ibm.pb.extension.contextmenu.ContextMenuAcOperation");dojo.declare("com.ibm.pb.extension.contextmenu.ContextMenuAcOperation",[com.ibm.mashups.enabler.ac.operation.Operation],{id:"none",url:"",sync:true,roleCheck:"",finished:null,allowed:false,constructor:function(id,url,sync,_249d,_249e){if(!com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations){com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations={};}this.id=id;this.url=url;this.sync=sync;this.roleCheck=_249d;this.finished=_249e||function(){};this._checkForFeed();},_checkForFeed:function(){if(com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations[this.id]){if(com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations[this.id][this.roleCheck]){this.allowed=true;}else{this.allowed=false;}this.finished(this);}else{this._getXml();}},_getXml:function(){var me=this,_249f=dojo.isIE||dojo.isOpera||dojo.isFF<3.5;dojo.xhrGet({url:this.url,handleAs:(_249f)?"text":"xml",sync:this.sync,load:function(data){var xml=data;com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations[me.id]={};if(_249f){var _24a0=xml.match(/label="(\w+)"/g);for(var i in _24a0){if((typeof _24a0[i])=="string"){var label=_24a0[i].substring(7,_24a0[i].length-1);com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations[me.id][label]=true;}}}else{var _24a0=xml.querySelectorAll("menuitem");for(var i in _24a0){if(_24a0[i].getAttribute){var label=_24a0[i].getAttribute("label");com.ibm.pb.extension.contextmenu.ContextMenuAcOperation.allowedOperations[me.id][label]=true;}}}me._checkForFeed();}});},isAllowed:function(_24a1){return this.allowed;}});}if(!dojo._hasResource["com.ibm.pb.extension.Operations"]){dojo._hasResource["com.ibm.pb.extension.Operations"]=true;dojo.provide("com.ibm.pb.extension.Operations");dojo.declare("com.ibm.pb.extension.SimpleOperation",[com.ibm.mashups.enabler.ac.operation.Operation],{allowed:false,constructor:function(_24a2,_24a3){this.allowed=_24a2;if(_24a3){_24a3(this);}},isAllowed:function(_24a4){return this.allowed;}});(function(){var ops=com.ibm.pb.extension.Operations={PAGE_ACTIONS:"com.ibm.pb.extension.Operations.pageActions",CREATE_PAGE:"com.ibm.pb.extension.Operations.createPage"},_24a5=com.ibm.pb.extension.SimpleOperation,_24a6=com.ibm.mashups.enabler,_24a7=_24a6.ac.operation.AllowedOperationsModelFactory.getAllowedOperationsModel(),_24a8=_24a6.navigation.Factory.getNavigationModel(),_24a9=_24a6.navigation.Constants;_24a7.setOperation(ops.PAGE_ACTIONS,function(_24aa,_24ab,sync,_24ac){new _24a5(_24a6.model.Factory.getUserModel().getAnonymousMode()!=_24a6.user.AnonymousMode.ANONYMOUS,_24ac);});_24a7.setOperation(ops.CREATE_PAGE,function(_24ad,_24ae,sync,_24af){var _24b0=_24ae.navNode||_24ae.contentNode,_24b1=dojo.some([true,false],function(_24b2){var res=false,args={type:_24a9.NAVIGATION_PAGE};if(_24b2){args["private"]=true;}if(_24a8.confirmCreate(args)){var _24b3=_24a8.create(args);res=_24a8.confirmInsert(_24b3,_24b0);}return res;});new _24a5(_24b1,_24af);});})();}if(!dojo._hasResource["com.ibm.pb.contextMenu.sharedActions"]){dojo._hasResource["com.ibm.pb.contextMenu.sharedActions"]=true;dojo.provide("com.ibm.pb.contextMenu.sharedActions");(function(){var _24b4=com.ibm.mashups.enabler,_24b5=com.ibm.mashups.builder,_24b6=com.ibm.pb.iwidget.control,_24b7=_24b5.model.Factory.getRuntimeModel(),_24b8=com.ibm.mashups.services.ServiceManager.getService("eventService"),_24b9=_24b4.model.Factory.getUserModel(),_24ba=_24b4.navigation.Factory.getNavigationModel(),_24bb=_24b4.widget.Factory.getWidgetModel(),_24bc=_24b4.ac.operation.AllowedOperationsModelFactory.getAllowedOperationsModel(),_24bd=com.ibm.pb.extension.Operations,_24be=_24b4.model.state.NavigationStateModelFactory,_24bf=_24b4.model.state.AccessorFactory,_24c0=com.ibm.pb.layout.LayoutParser,_24c1=_24b4.context.Factory.getLocalizedContext();var _24c2=com.ibm.pb.contextMenu.sharedActions={confirmAdvancedActions:function(_24c3,_24c4,_24c5,_24c6){currentContentID=_24c2.getContentId(_24c3);return (_24c2.isOperationAllowed(_24b4.ac.operation.Constants.EDIT_LAYOUT,{contentNode:currentContentID})||_24c2.isOperationAllowed(_24b4.ac.operation.Constants.EDIT_PROPERTIES,{contentNode:_24c3}));},confirmEditPage:function(_24c7,_24c8,_24c9,_24ca){_24c7=_24c2.getContentId(_24c7);return (_24c2.isOperationAllowed(_24b4.ac.operation.Constants.EDIT_LAYOUT,{contentNode:_24c7}));},isEditActive:function(_24cb,_24cc,_24cd,_24ce){return (_24b7.getCurrentPage().getPageMode()!="edit");},editPage:function(_24cf,_24d0,_24d1,_24d2){if(_24b9.getAnonymousMode()!=_24b4.user.AnonymousMode.ANONYMOUS&&_24b7.getCurrentPage().getPageMode()!="edit"){var _24d3=dojo.getObject("ibmCfg.controllers.rendering");if(_24d3){_24d3.changePageMode("edit");}else{_24b8.broadcastEvent("com.ibm.mashups.builder.changePageMode",mode);_24b7.getCurrentPage().setPageMode(mode);}}},isOperationAllowed:function(_24d4,_24d5){if(_24d5&&typeof _24d5.contentNode=="string"){_24d5.contentNode=_24ba.find(_24d5.contentNode).start();}return _24bc.getOperation(_24d4,_24d5).start().isAllowed();},confirmOperation:function(ID,_24d6,_24d7,_24d8){var _24d9={id:ID};if(!_24d6||_24d6=="com.ibm.mashups.enabler.navigation.NavigationNode"){_24d9.navID=ID;}else{_24d9.navID=_24b7.getCurrentPage().getID();}if(_24d7.operation==com.ibm.mashups.enabler.ac.operation.Constants.EDIT_PROPERTIES){_24d9.contentID=_24d9.navID;}var _24da=_24c2.replaceMapVars(_24d9,_24d7.jsonContext);return _24c2.isOperationAllowed(_24d7.operation,_24da);},confirmChangeLayout:function(ID,_24db,_24dc,_24dd){var page=_24ba.find(ID).start();if(!page.getContent){return false;}var _24de=page.getContent().start();if(_24de.getMetaData("com.ibm.portal.layout.template.ref")||page.getMetaData("com.ibm.portal.static.page.file.name.html")){return false;}else{return _24c2.confirmOperation(ID,_24db,_24dc,_24dd);}},confirmAssignPermissions:function(ID,_24df,_24e0,_24e1){var page=_24ba.find(ID).start();if(!page.getContent){return false;}return _24c2.confirmOperation(ID,_24df,_24e0,_24e1);},confirmTagAndRatePage:function(_24e2,_24e3,_24e4,_24e5){return true;},confirmCPAction:function(_24e6,_24e7,_24e8,_24e9){var _24ea=_24e8.configCheck,_24eb=false,node=null;if(_24ea){if(_24e7==="com.ibm.mashups.enabler.navigation.NavigationNode"){node=_24ba.find(_24e6).start();}else{if(_24e7==="com.ibm.mashups.iwidget.widget.IWidgetDefinition"){var nsm=_24be.getNavigationStateModel();var _24ec=_24bf.getSpaceAccessor(nsm).getSpaceID();var _24ed=_24bf.getPageAccessor(nsm,_24ec);var _24ee=_24ed.getPageID();var _24ef=_24ba.find(_24ee).start();var _24f0=_24ba.getLayoutModel(_24ef);node=_24f0.find(_24e6).start();}else{console.warn("resourceType %o is not valid for a CP action",_24e7);return;}}var scope=node.getMetaData(_24e8.metadataName);_24eb=scope!=="true";}return (_24ea&&_24eb);},confirmbrowseTags:function(_24f1,_24f2,_24f3,_24f4){return true;},browseTags:function(_24f5,_24f6,_24f7,_24f8){var _24f9={};_24f9.uri="tm:browsetags";_24f9.rmparam="rm:oid:"+_24f5;var url=_24c2.createURL(_24f5,_24f9);_24c2.savePageChecker(function(){top.location.href=url;});},confirmSharing:function(_24fa,_24fb,_24fc,_24fd){return (_24c2.confirmAddSharedPages(_24fa,_24fb,_24fc,_24fd)||_24c2.confirmSharePage(_24fa,_24fb,_24fc,_24fd)||_24c2.isOperationAllowed(_24b4.ac.operation.Constants.ASSIGN_ROLES,{contentNode:_24fa}));},confirmSharePage:function(_24fe,_24ff,_2500,_2501){if(!_24fe){return false;}if(!_24ba.hasLayoutModel(_24fe)){return false;}return _24c2.isPrivatePage(_24fe)&&_24c2.isPageOwner(_24fe);},sharePage:function(_2502,_2503,_2504,_2505){var node=_24ba.find(_2502).start();try{var _2506=_24c1.getLocale(node);}catch(e){}var _2507=node.getTitle(_2506||dojo.locale)||node.getTitle(ibmConfig["default.locale"])||"";var title=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsStrings.I_ACL_DIALOG_TITLE,[_2507]);_24c2.showInShareDialog(_2502,title);},assignPagePermissions:function(_2508,_2509,_250a,_250b){var title=dojo.i18n.getLocalization("com.ibm.bundles","Theme")["assignPagePermissions_title"];_24c2.showInShareDialog(_2508,title);},showInShareDialog:function(_250c,title){var _250d={widgetTypeId:"sharePage",eventName:"com.ibm.mashups.builder.sharePage",eventPayload:_250c,requestRefresh:true,dialogParam:{title:title.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),nodeWidth:"774px",hasRightBottomResizer:false}};_24c2.savePageChecker(function(){_24b8.broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_250d);},function(){_24b8.broadcastEvent("com.ibm.mashups.builder.switchPage",_250c);_24b8.broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_250d);});},confirmAddSharedPages:function(_250e,_250f,_2510,_2511){var _2512=_24ba.find(ibmConfig.sharedPagesParent).start();if(_2512.hasRole(com.ibm.mashups.enabler.ac.RoleType.ADMIN)||_2512.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER)||_2512.hasRole(com.ibm.mashups.enabler.ac.RoleType.EDITOR)||_2512.hasRole("Privileged User")){return true;}return false;},addSharedPages:function(_2513,_2514,_2515,_2516){nlsBundle=dojo.i18n.getLocalization("com.ibm.bundles","Theme");var title=nlsBundle["theme_add_pages_shared"];var _2517={nodeWidth:"600px",containerBackgroundColor:"white",hasLeftBottomResizer:false,hasRightBottomResizer:false,title:title};var _2518={widgetTypeId:"viewMorePage",eventName:"com.ibm.mashups.builder.viewMorePage",eventPayload:"",dialogParam:_2517,requestRefresh:true};_24c2.savePageChecker(function(){_24b8.broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_2518);},function(){_24b8.broadcastEvent("com.ibm.mashups.builder.switchPage",_2513);_24b8.broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_2518);});},confirmPageActions:function(_2519,_251a,_251b,_251c){return (_24c2.confirmMovePage(_2519,_251a,_251b,_251c)||_24c2.confirmDeletePage(_2519,_251a,_251b,_251c)||_24c2.confirmCreatePage(_2519,_251a,_251b,_251c));},confirmCreatePage:function(_251d,_251e,_251f,_2520){var _2521=_24ba.find(_251d).start();return _24bc.getOperation(_24bd.CREATE_PAGE,{navNode:_2521}).start().isAllowed();},createPage:function(_2522,_2523,_2524,_2525){_24c2.savePageChecker(function(){_24b6.onLoad(_2524&&_2524.widgetId,function(){var _2526=_24be.getNavigationStateModel();var _2527=_24bf.getSpaceAccessor(_2526);_24b8.broadcastEvent("com.ibm.mashups.builder.createPage",{spaceId:_2527.getSpaceID(),parentPageId:_2522});});});},confirmMovePage:function(_2528,_2529,_252a,_252b){var page=_24ba.find(_2528).start();if(!page.getContent){return false;}if(_24c2.isPrivatePage(_2528)){return true;}var page=_24ba.find(_2528).start();var _252c=_24ba.getParent(page).start();if(_252c.hasRole(com.ibm.mashups.enabler.ac.RoleType.ADMIN)||_252c.hasRole(com.ibm.mashups.enabler.ac.RoleType.MANAGER)){return true;}return false;},movePage:function(_252d,_252e,_252f,_2530){com.ibm.pb.contextMenu.sharedActions.savePageChecker(function(){var _2531={widgetTypeId:"reorderPage",eventName:"com.ibm.mashups.builder.reorderPage",eventPayload:{pageId:_252d,spaceId:null},requestRefresh:true,dialogParam:{id:_252d+"_reorderPane",title:dojo.string.substitute(com.ibm.mm.builder.coreWidgetsStrings.I_REORDER_PAGE_DIALOG_TITLE,[com.ibm.mm.builder.utils.pageUtil.getPageTitle(_252d)]),nodeWidth:"420px",containerBackgroundColor:"white",hasRightBottomResizer:false}};com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_2531);});},isRemovePage:function(_2532,_2533,_2534,_2535){var node=_24ba.find(_2532).start(),_2536=_24ba.confirmRemove(node),_2537=_24c2.getContentId(_2532),_2538=_24ba.find(_2537).start(),_2539=_24ba.confirmRemove(_2538);if(_2536&&_2539){return false;}else{return true;}},confirmDeletePage:function(_253a,_253b,_253c,_253d){var node=_24ba.find(_253a).start();return _24ba.confirmRemove(node);},deletePage:function(_253e,_253f,_2540,_2541){var _2542=dojo.i18n.getLocalization("com.ibm.bundles","Theme");var _2543=_24ba.find(_253e).start();if(confirm(dojo.string.substitute(_2542[_2540.confirmMsgKey],[_24c1.getTitle(_2543)]))){var node=_24ba.find(_253e).start();var _2544=_24ba.getParent(node).start();if(_24ba.confirmRemove(node)){_24ba.remove(node);}_24ba.commit().setFinishedCallback(function(){console.log("Deleted page, now auto nav");com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setDirty(false);var _2545=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");_2545.broadcastEvent("com.ibm.mashups.builder.switchPage",_2544.getID());_2545.broadcastEvent("com.ibm.mashups.builder.refreshNavigation",_2544.getID());}).start(false);}},confirmEditWiring:function(ID,_2546,_2547,_2548){if(_24b7.getCurrentPage().getPageMode()=="view"){return false;}var _2549=_24c2.getLayoutModel(_24b7.getCurrentPage().getID()),_254a=_2549.getWireModel();return _254a.confirmCreate();},editWiring:function(ID,_254b,_254c,_254d){var _254e={nodeWidth:"486px",title:com.ibm.mm.builder.coreWidgetsStrings.I_WIRING_NAME||"Wiring",leftBarWidth:"18px",rightBarWidth:"12px",displayCloseButton:true,hasRightBottomResizer:false};var _254f={widgetTypeId:"wireInterface",eventName:"com.ibm.mashups.builder.editWire",eventPayload:ID,dialogParam:_254e,hasRightBottomResizer:false,requestRefresh:true};_24b8.broadcastEvent("com.ibm.mashups.builder.displayInMashupDialog",_254f);_24b7.getCurrentPage().setDirty(true);},confirmChangeWidgetMode:function(ID,_2550,_2551,_2552){var _2553=_24c2.getWidgetAccessor(ID).getWidgetMode()||com.ibm.mm.iwidget.Constants.mode.VIEW;if(_2553==_2551.mode){return false;}return _24c2.confirmOperation(ID,_2550,_2551,_2552);},changeWidgetMode:function(ID,_2554,_2555,_2556){if(_2555.mode==com.ibm.mm.iwidget.Constants.mode.HELP){var _2557=com.ibm.mashups.enabler.model.state.UrlGeneratorFactory.getURLGenerator(),_2558=_24be.getNavigationStateModel(),_2559=_24c2.getWidgetAccessor(ID);_2559.setWidgetMode(com.ibm.mm.iwidget.Constants.mode.HELP);_2557.getURL(_2558,function(url){window.open(url,"","resizable=yes,scrollbars=yes,menubar=no,toolbar=no,status=no,width=800,height=600,screenX=10,screenY=10,top=10,left=10");_2558.discard();},{"newWindow":true,"themeTemplate":"Plain","soloState":{"portletWindowID":ID,"returnSelection":_24b7.getCurrentPage().getID()}});}else{_24b8.publishEvent(_2555.event,{id:ID,newMode:_2555.mode});if(_24c2.getWidgetAccessor(ID).getWidgetMode()==_2555.mode){}else{var _2558=_24be.getNavigationStateModel();_24c2.getWidgetAccessor(ID).setWidgetMode(_2555.mode);_24b7.getCurrentPage().setID(_24b7.getCurrentPage().getID());_2558.commit().start();_24c2.savePageChecker(function(){document.location.href=_24b4.model.state.UrlGeneratorFactory.getUrlGenerator().getUrl(_2558);});}}},getWidgetAccessor:function(id){var _255a=_24be.getNavigationStateModel(),_255b=_24bf.getWidgetAccessor(_255a,id);return _255b;},confirmChangeWindowState:function(ID,_255c,_255d,_255e){if(_24c2.isPlainThemeTemplate()){return false;}var _255f=_24be.getNavigationStateModel(),_2560=_24bf.getWidgetAccessor(_255f,ID),_2561=_2560.getWindowState();if(!_2561){_2561=_2560.NORMAL;}if(_255d.newWindowState==_2560.NORMAL&&_2561==_2560.NORMAL){return false;}else{if(_255d.newWindowState==_2560.MIN&&_2561==_2560.MIN){return false;}else{if(_255d.newWindowState==_2560.MAX&&_2561==_2560.MAX){return false;}}}return true;},changeWindowState:function(ID,_2562,_2563,_2564){var _2565=_24be.getNavigationStateModel(),_2566=_24bf.getWidgetAccessor(_2565,ID);if(ibmCfg.themeConfig.isPageRenderModeCSA){var _2567=_2566.getWindowState();if(!_2567){_2567=_2566.NORMAL;}_24b8.publishEvent(_2563.event,{id:ID,newWindowState:_2563.newWindowState,oldWindowState:_2567});}else{var pid=_24b7.getCurrentPage().getID();_2566.setWindowState(_2563.newWindowState);_24b7.getCurrentPage().setID(pid);_2565.commit().start();_24c2.savePageChecker(function(){top.location.href=_24b4.model.state.UrlGeneratorFactory.getUrlGenerator().getUrl(_2565);});}},confirmHideControl:function(ID,_2568,_2569,_256a){if(_24b7.getCurrentPage().getPageMode()=="view"){return false;}var _256b=_24c2.getHiddenContainer();if(!_256b){return false;}var _256c=_24c2.getLayoutModel(_24b7.getCurrentPage().getID()),_256d=_256c.find(ID).start(),_256e=_256c.getParent(_256d).start();if(_256e.getID()==_256b.getID()){return false;}return _256c.confirmInsert(_256d,_256b);},hideControl:function(ID,_256f,_2570,_2571){var _2572=_24c2.getLayoutModel(_24b7.getCurrentPage().getID()),_2573=_24c2.getHiddenContainer(),_2574=_24c0.findById(_2573.getID()),_2575=_2572.find(ID).start(),_2576=_24c0.findById(_2575.getID());_2572.insert(_2575,_2573);_2574.appendChild(_2576);_24b7.getCurrentPage().setDirty(true);_24b8.broadcastEvent("com.ibm.mashups.builder.widgetMoved",ID);if(com.ibm.pb.control.DNDController){com.ibm.pb.control.DNDController.getController().dndSources[_2573.getID()].sync();}},confirmDeleteControl:function(ID,_2577,_2578,_2579){if(_24b7.getCurrentPage().getPageMode()=="view"){return false;}var _257a=_24c2.getLayoutModel(_24b7.getCurrentPage().getID()),_257b=_257a.find(ID).start();return _257a.confirmRemove(_257b);},deleteControl:function(ID,_257c,_257d,_257e){var _257f=_24c2.getLayoutModel(_24b7.getCurrentPage().getID()),_2580=_24c0.findById(ID);_257f.remove(ID);if(_2580){_2580.parentNode.removeChild(_2580);}_24b7.getCurrentPage().setDirty(true);_24b8.broadcastEvent("com.ibm.mashups.builder.widgetDeleted",ID);},savePageChecker:function(_2581,_2582,_2583){if(_24b7.getCurrentPage().isDirty()){ibmCfg.themeConfig.savePageCheckerUnloading=true;if(!_2582){_2582=_2581;}var cws=com.ibm.mm.builder.coreWidgetsStrings;var _2584=new com.ibm.mm.builder.dialog.PageSaveConfirmDialog({contentWarning:cws.I_PAGE_SAVE_WARNING,contentQuestion:cws.I_PAGE_SAVE_SUGGEST,btnSaveText:cws.I_COMMON_SAVE,btnNotSaveText:cws.I_PAGE_SAVE_NO_SAVE,btnCancelText:cws.I_PAGE_SAVE_KEEP_EDIT,hideNotSave:true,callbackSave:function(){ibmCfg.themeConfig.savePageCheckerUnloading=false;if(_2581){_2581();}},callbackNotSave:function(){ibmCfg.themeConfig.savePageCheckerUnloading=false;if(_2582){_2582();}},callbackCancel:function(){ibmCfg.themeConfig.savePageCheckerUnloading=false;if(_2583){_2583();}}});_2584.show();}else{if(_2581){_2581();}}},getContentId:function(navId){var _2585=_24ba.find(navId).start();if(_2585&&_2585.getContent){var _2586=_2585.getContent().start();if(_2586){navId=_2586.getID();}}return navId;},getHiddenContainer:function(){var _2587=_24c2.getLayoutModel(_24b7.getCurrentPage().getID()),root=_2587.getRoot().start(),_2588=_2587.getChildren(root);while(_2588.hasNext()){var child=_2588.next();if(child.getMetaData("com.ibm.portal.layoutnode.localname")=="ibmHiddenWidgets"){return child;}}return null;},getLayoutModel:function(_2589){return _24ba.getLayoutModel(_2589);},isPrivatePage:function(_258a){var _258b=_24ba.find(_258a).start(),xml=_258b.getXml(),expr="./atom:content/*/ac:allowed-access[@ac:private='true']";return com.ibm.mashups.enabler.xml.XPath.evaluateBoolean(expr,xml,{app:"http://www.w3.org/2007/app",atom:"http://www.w3.org/2005/Atom",ac:"http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0"});},isPageOwner:function(_258c){var _258d=_24c2.getLayoutModel(_258c),_258e=_258d.getRoot().start(),_258f=com.ibm.mashups.enabler.ac.AccessControlModelFactory.getAccessControlModel(_258e),_2590=_258f.getOwner();if(_2590){var _2591=com.ibm.mashups.enabler.model.Factory.getUserModel(),_2592=_2591.findCurrentUser().start();if(_2590.getID()==_2592.getID()){return true;}}return false;},isAuthenticated:function(){return _24b9.getAnonymousMode()!=_24b4.user.AnonymousMode.ANONYMOUS;},isAnonymous:function(){return !_24c2.isAuthenticated();},isPlainThemeTemplate:function(){if(ibmCfg&&ibmCfg.portalConfig&&ibmCfg.portalConfig.bootstrapState&&ibmCfg.portalConfig.bootstrapState.indexOf("<theme-template>Plain</theme-template>")>=0){return true;}else{return false;}},broadcastEventFromCurrentPage:function(_2593,_2594,_2595,_2596){return _24c2.broadcastEvent.call(this,_24b7.getCurrentPage().getID(),_2594,_2595,_2596);},broadcastEvent:function(_2597,_2598,_2599,_259a){var _259b=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");_259b.broadcastEvent(_2599.event,{resourceId:_2597,resourceType:_2598,domNode:this});},openWidget:function(_259c,_259d,_259e,_259f){var scope=this;_24b6.onLoad(_259e&&_259e.widgetId,function(_25a0){if(_25a0&&_25a0.iScope){_25a0.iScope.open({resourceId:_259c,resourceType:_259d,domNode:scope});}});},loadURL:function(_25a1,_25a2,_25a3,_25a4){_24c2.savePageChecker(function(){top.location.href=_25a3.url;});},refreshPage:function(){_24c2.savePageChecker(function(){var url=_24c2.createRefreshURL();dojo.cookie("DigestTracker",(new Date()).getTime(),{path:"/"});top.location.href=url;});},createRefreshURL:function(){var _25a5=_24be.getNavigationStateModel();var _25a6=_24b4.model.state.UrlGeneratorFactory.getURLGenerator();return _25a6.getURL(_25a5,null,{"nohash":true});},createURL:function(_25a7,_25a8){var _25a9=_24be.getNavigationStateModel();var _25aa=_24bf.getSpaceAccessor(_25a9);var _25ab=_24bf.getPageAccessor(_25a9,_25aa.getSpaceID());_25ab.setPageID(_25a7);var _25ac=_24b4.model.state.UrlGeneratorFactory.getURLGenerator();return (_25ac.getURL(_25a9,null,{})+"?"+dojo.objectToQuery(_25a8));},createURL:function(_25ad,_25ae,_25af){var _25b0=_24be.getNavigationStateModel();var _25b1=_24bf.getSpaceAccessor(_25b0);var _25b2=_24bf.getPageAccessor(_25b0,_25b1.getSpaceID()),_25b3,_25b4;_25b2.setPageID(_25ad);for(var id in _25af){_25b4=_25af[id];_25b3=_24bf.getWidgetAccessor(_25b0,id);if(_25b4.mode){_25b3.setWidgetMode(_25b4.mode);}if(_25b4.windowState){_25b3.setWindowState(_25b4.windowState);}for(var p in _25b4.parameters){_25b3.setWidgetState(p,_25b4.parameters[p]);}}var _25b5=_24b4.model.state.UrlGeneratorFactory.getURLGenerator();return (_25b5.getURL(_25b0,null,{})+"?"+dojo.objectToQuery(_25ae));},navigateToPageFromCurrent:function(_25b6,_25b7,_25b8,_25b9){return _24c2.redirectToHiddenPage.call(this,_24b7.getCurrentPage().getID(),_25b7,_25b8,_25b9);},navigateToPage:function(){return _24c2.redirectToHiddenPage.apply(this,arguments);},redirectToHiddenPage:function(_25ba,_25bb,_25bc,_25bd){var _25be=_25ba,_25bf=_24ba.find(_25ba).start();if(_25bf.getContent){var _25c0=_25bf.getContent().start();_25be=_25c0.getID();}var _25c1={navID:_25ba,contentID:_25be};var _25c2=_24c2.replaceMapVars(_25c1,_25bc.urlParams);var _25c3=_24c2.replaceMapVars(_25c1,_25bc.widgetParams);var url=_24c2.createURL(_25bc.targetPageID,_25c2,_25c3);_24c2.savePageChecker(function(){if(_25bc&&_25bc.refreshCache){dojo.cookie("DigestTracker",(new Date()).getTime(),{path:"/"});}top.location.href=url;});},replaceMapVars:function(_25c4,_25c5){var ret=_25c5;if(dojo.isString(_25c5)){ret=dojo.string.substitute(_25c5,_25c4,function(value,key){if(value===undefined){if(key==="contentID"){return _24c2.getContentId(_25c4.navID);}else{return "";}}else{return value;}});}else{if(dojo.isArray(_25c5)){ret=[];for(var i=0;i<_25c5.length;i++){ret.push(_24c2.replaceMapVars(_25c4,_25c5[i]));}}else{if(dojo.isObject(_25c5)){ret={};for(var key in _25c5){ret[key]=_24c2.replaceMapVars(_25c4,_25c5[key]);}}}}return ret;}};})();}if(!dojo._hasResource["com.ibm.pb.control.DNDController"]){dojo._hasResource["com.ibm.pb.control.DNDController"]=true;dojo.provide("com.ibm.pb.control.DNDController");dojo.declare("com.ibm.pb.control.DNDController",com.ibm.pb.logging.Loggable,{DND_TYPE:"lm",SHELF_TYPE:"sm",CONTROL_CLASS:"component-control",CONTAINER_CLASS:"component-container",DND_HANDLE_CLASS:"component-control-draghandle",DND_ORIENTATION:{vertical:"vertical",horizontal:"horizontal",freeform:"freeform"},dndSources:{},isDndLoaded:false,ghostHeight:0,currentNode:null,layoutParser:com.ibm.pb.layout.LayoutParser,nm:null,constructor:function(){var lgr=this.LOGGER,mname="constructor";lgr.entering(mname,arguments);com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService").subscribeEvent("com.ibm.mashups.builder.changePageMode",this,this.onPageModeChanged);this.sourceDefinitions=ibmCfg.themeConfig.dndSourceDefinitions;this.nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();lgr.exiting(mname,arguments);},init:function(){var lgr=this.LOGGER,mname="init";lgr.entering(mname,arguments);this.getContainers().forEach(function(_25c6){dojo.query("."+this.CONTROL_CLASS,_25c6).forEach(function(_25c7){dojo.addClass(_25c7,"dojoDndItem");dojo.attr(_25c7,"dndType",this.DND_TYPE);},this);var cls=null;var _25c8=null;var _25c9=null;dojo.forEach(this.sourceDefinitions,function(_25ca){if(dojo.hasClass(_25c6,_25ca.id)){_25c8=_25ca.object;_25c9=_25ca.orientation;cls=dojo.getObject(_25c8);if(!cls){dojo["require"](_25c8);cls=dojo.getObject(_25c8);if(!cls){console.error("%o not found",_25c8);return;}}}},this);if(cls){this.dndSources[this.layoutParser.extractID(_25c6)]=new cls(_25c6,{horizontal:(this.DND_ORIENTATION.horizontal==_25c9),creator:dojo.getObject(_25c8+".creator"),accept:[this.DND_TYPE,this.SHELF_TYPE],withHandles:dojo.getObject(_25c8+".withHandles")?true:false,singular:true,skipForm:true});}},this);this.isDndLoaded=true;lgr.exiting(mname,arguments);},getContainers:function(){if(!this.containers){this.containers=dojo.query("."+this.CONTAINER_CLASS);}return this.containers;},destroySources:function(){for(var name in this.dndSources){if(name){this.dndSources[name].destroy();}}this.dndSources={};},reset:function(){this.destroySources();this.isDndLoaded=false;delete this.containers;},onPageModeChanged:function(_25cb){var lgr=this.LOGGER,mname="onPageModeChanged";lgr.entering(mname,arguments);if(_25cb=="edit"){if(!this.isDndLoaded){this.init();}else{for(var i in this.dndSources){this.dndSources[i].isSource=true;}}}else{if(this.isDndLoaded){for(var i in this.dndSources){this.dndSources[i].isSource=false;}}}lgr.exiting(mname,arguments);}});(function(){var _25cc=null;com.ibm.pb.control.DNDController.getController=function(){if(!_25cc){_25cc=new com.ibm.pb.control.DNDController();}return _25cc;};})();}if(!dojo._hasResource["com.ibm.pb.iwidget.PageModeWidgetHandler"]){dojo._hasResource["com.ibm.pb.iwidget.PageModeWidgetHandler"]=true;dojo.provide("com.ibm.pb.iwidget.PageModeWidgetHandler");dojo.declare("com.ibm.pb.iwidget.PageModeWidgetHandler",null,{CLASS_PREFIX:"pb-pageMode-",renderingController:null,matchingModes:[],constructor:function(args){dojo.safeMixin(this,args);if(!this.matchingModes){this.matchingModes=[];}this.modeWidgets={};dojo.forEach(this.matchingModes,function(mode){this.modeWidgets[mode]=[];},this);},preProcessCallbackFunc:function(_25cd,_25ce,_25cf){if(this.renderingController&&this._isMatchingIWidgets(_25cf)){dojo.forEach(_25ce,function(node){for(var mode in this.modeWidgets){if(dojo.hasClass(node,this.CLASS_PREFIX+mode)){node.setAttribute("lazyLoad","true");var id=node.getAttribute("id");this.modeWidgets[mode].push(id);this.renderingController.addModeWidgets(mode,[id]);}}},this);}},postProcessCallbackFunc:function(_25d0,_25d1,_25d2,_25d3){},_isMatchingIWidgets:function(_25d4){return _25d4.match&&_25d4.match.indexOf(".iw-iWidget")>-1;}});}if(!dojo._hasResource["com.ibm.pb.data.NavigationPrimer"]){dojo._hasResource["com.ibm.pb.data.NavigationPrimer"]=true;dojo.provide("com.ibm.pb.data.NavigationPrimer");dojo.declare("com.ibm.pb.data.NavigationPrimer",com.ibm.pb.logging.Loggable,{LEVEL_ATTR:"data-nm-level",PRIMED_ATTR:"data-nm-primed",END:{},selPath:null,map:null,constructor:function(){this.selPath=[];this.map={};},parse:function(_25d5){var mname="parse",lgr=this.LOGGER;lgr.entering(mname,[_25d5]);_25d5=dojo.byId(_25d5);var level=dojo.attr(_25d5,this.LEVEL_ATTR);if(level!==null&&level!==undefined){lgr.trace(mname,"Priming the parse root node itself");this._prime(_25d5);}var _25d6=dojo.query("["+this.LEVEL_ATTR+"]",_25d5);if(_25d6.length>0){_25d6.forEach(this._prime,this);}else{lgr.trace(mname,"No level nodes detected in descendant nodes");lgr.exiting(mname,[null]);return;}lgr.exiting(mname,[_25d5]);},_prime:function(_25d7){var mname="_prime",lgr=this.LOGGER;lgr.entering(mname,[_25d7]);var level=dojo.attr(_25d7,this.LEVEL_ATTR);var _25d8=this.extractData(_25d7);if(_25d8){this.addItem(_25d8);if(!this.selPath[level]){lgr.trace(mname,"No previous selection path data at level ${0}",[level]);}}else{if(this.selPath[level]){_25d8=this.selPath[level];lgr.trace(mname,"No data provided for selection path data, using previously known",[]);}else{lgr.trace(mname,"No data provided for selection path data, and no previous data to use",[]);lgr.exiting(mname,[]);return;}}_25d8=this.byId(_25d8.id);this.selPath[level]=_25d8;lgr.trace(mname,"Priming selection path data at level ${0}",[level]);var _25d9=dojo.query("["+this.PRIMED_ATTR+"]",_25d7);if(_25d9.length>0){lgr.trace(mname,"Found children of ${0}",[_25d8.id]);if(!_25d8.children){_25d8.children=[];}_25d9.forEach(function(_25da){var _25db=this.extractData(_25da);if(_25db){lgr.trace(mname,"Adding child ${0} of ${1}",[_25db.id,_25d8.id]);this.addItem(_25db);_25db=this.byId(_25db.id);_25d8.children.push(_25db);}},this);_25d8.children.push(this.END);}else{lgr.trace(mname,"Found NO children of ${0}",[_25d8.id]);}lgr.exiting(mname,[_25d8]);},addItem:function(data){var mname="addItem",lgr=this.LOGGER;if(data&&data.id){if(this.map[data.id]){lgr.trace(mname,"Adding properties ${0} for ${1} to existing data",[data,data.id]);dojo.mixin(this.map[data.id],data);}else{lgr.trace(mname,"Adding new data ${0} for ${1}",[data,data.id]);this.map[data.id]=data;}}},byId:function(id){return this.map[id];},_normalizeType:function(type){type=type?type.toLowerCase():"page";switch(type){case "internalurl":case "externalurl":type="url";break;case "staticpage":type="page";break;}return type;},extractData:function(_25dc){var mname="extractData",lgr=this.LOGGER;var data=dojo.attr(_25dc,this.PRIMED_ATTR);if(data){data=dojo.fromJson(data);data.locale=ibmConfig.locale;data.type=this._normalizeType(data.type);lgr.trace(mname,"Extracted data ${0}",[data]);}else{data=null;}return data;},finalize:function(){var mname="finalize",lgr=this.LOGGER;for(var i=this.selPath.length-1;i>=0;i--){if(i>0){if(this.selPath[i-1]&&!this.selPath[i-1].children){this.selPath[i-1].children=[this.selPath[i]];}else{if(this.selPath[i-1]&&this.selPath[i-1].children.length==0){this.selPath[i-1].children.push(this.END,this.selPath[i]);}}}}var nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();if(lgr.isLoggable(com.ibm.mashups.enabler.logging.LogLevel.TRACE)){lgr.trace(mname,"Priming navigation model ${0}",[this]);lgr.trace(mname,"Priming data:\n  ${0}",[dojo.toJson(this.selPath[0],true)]);}nm.setPrimingData(this.selPath[0]);}});}if(!dojo._hasResource["com.ibm.pb.themes.commonInit"]){dojo._hasResource["com.ibm.pb.themes.commonInit"]=true;dojo.provide("com.ibm.pb.themes.commonInit");com.ibm.pb.themes.commonInit=function(_25dd){if(!_25dd){_25dd={};}var lgr=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.pb.themes.commonInit"),mname="commonInit",_25de=dojo.i18n.getLocalization("com.ibm.bundles","SharedMessages");lgr.entering(mname);if(ibmConfig.primeNavigation&&_25dd.navPrimingContainers){lgr.trace(mname,"Priming navigation model");var np=new com.ibm.pb.data.NavigationPrimer();dojo.forEach(_25dd.navPrimingContainers,np.parse,np);np.finalize();ibmCfg.themeConfig.navigationPrimed=true;}var _25df=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");lgr.trace(mname,"Initializing navigation model and HiddenMetaDataLoadingStrategy");var nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel(),_25e0=new com.ibm.mashups.enabler.strategy.HiddenMetaDataLoadingStrategy(ibmCfg.themeConfig.navHiddenMetadata);nm.addStrategy(_25e0);lgr.trace(mname,"Initializing page load ahead strategy");var _25e1=new com.ibm.mashups.enabler.strategy.PageLoadAheadStrategy(true,false,false);nm.addStrategy(_25e1);lgr.trace(mname,"Initializing navigation node to content node meta data sync strategy");var _25e2=new com.ibm.mashups.enabler.strategy.SyncMetaDataStrategy();nm.addStrategy(_25e2);lgr.trace(mname,"Initializing builder RuntimeModel");var _25e3=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _25e4=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(_25e3);var _25e5=_25e4.getPageID();if(!_25e5){_25e5=ibmPortalConfig.currentPageOID;lgr.trace(mname,"Could not retrieve selected page from navigation state, retrieving from bootstrap config: ${0}",[_25e5]);_25e4.setPageID(_25e5);}var _25e6=com.ibm.mashups.builder.model.Factory.getRuntimeModel();var _25e7=_25e6.getCurrentPage();_25e7.setID(_25e5);_25e7.setPageMode("view");_25e6.getCurrentTheme().setID(ibmCfg.themeConfig.themeUniqueName);lgr.trace(mname,"Setting window title with current page title");nm.find(_25e5).setFinishedCallback(function(res,_25e8){if(_25e8!=200){lgr.severe(mname,_25de.nav_renderingError_0);dojo.publish("/portal/status/theme",["error",_25de.nav_renderingError_0,_25de["nav_renderingError_0.useraction"]]);if(_25e8=="404"||_25e8==404||_25e8==0){window.location=window.location.protocol+"//"+window.location.host+ibmCfg.portalConfig?ibmCfg.portalConfig.portalURI:ibmConfig["com.ibm.mashups.contextroot"];}}else{if(_25dd.setWindowTitle){var title="";var _25e9=res;var _25ea=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();var _25eb=_25ea.getTitle(_25e9);if(ibmCfg.themeConfig.portletOverridePageTitle!=_25eb){title=ibmCfg.themeConfig.portletOverridePageTitle.replace(/&amp;/g,"&").replace(/&quot;/g,"\"").replace(/&gt;/g,">").replace(/&lt;/g,"<");}else{title=_25eb;}com.ibm.mashups.enabler.context.Factory.getPageContext().setBrowserTitle(title);}}}).start();if(_25dd.useNavigationController){lgr.trace(mname,"Initializing navigation controller");ibmCfg.controllers.navigation=com.ibm.pb.control.NavigationController.getController();ibmCfg.controllers.navigation.getTreeModel().newItem=function(args,_25ec){var nm=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();var _25ed={type:com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE};if(args["private"]=="on"){_25ed["private"]=true;}var _25ee=false;if(args["template"]&&args["template"]!==""){_25ee=true;_25ed.pageTemplate=args["template"];}var _25ef=nm.create(_25ed);_25ef.setTitle(args.title,dojo.locale);_25ef.setTitle(args.title,ibmCfg.enablerConfig["default.locale"]);if(args.friendlyURL){_25ef.setMetaData("com.ibm.portal.friendly.name",args.friendlyURL);}var _25f0=this.getIdentity(_25ec);var _25f1=nm.find(_25f0).start();nm.insert(_25ef,_25f1);var _25f2=_25ef.getContent().start();if(!_25ee){_25f2.setStaticContentURL(ibmConfig.defaultLayoutTemplateURI);}var dfd=nm.commit();dfd.setOperationCallback(function(page,mode,_25f3,_25f4){if(page&&page.getID&&_25f3<300){_25df.broadcastEvent("com.ibm.mashups.builder.refreshNavigation");_25df.broadcastEvent("com.ibm.mashups.builder.switchPage",page.getID());}else{if(_25f3>=400){var _25f5=dojo.i18n.getLocalization("com.ibm.bundles","PageCreatorDialog");var _25f6=new com.ibm.widgets.StatusMessage("error",_25f5["page_dialog_error_creating_page"],"");dojo.publish("/portal/status",[{message:_25f6,uid:"ibmStatusBox"}]);}}if(args.callback){args.callback(page,mode,_25f3,_25f4);}});dfd.setFinishedCallback(function(page,_25f7){if(_25f7>=400){var _25f8=dojo.i18n.getLocalization("com.ibm.bundles","PageCreatorDialog");var _25f9=new com.ibm.widgets.StatusMessage("error",_25f8["page_dialog_error_creating_page"],"");dojo.publish("/portal/status",[{message:_25f9,uid:"ibmStatusBox"}]);console.log("published status");}if(args.callback){args.callback(page,null,_25f7);}});dfd.start(true);return _25ef;};}if(_25dd.useRenderingController){lgr.trace(mname,"Initializing rendering controller");ibmCfg.controllers.rendering=com.ibm.pb.control.RenderingController.getController();ibmCfg.controllers.rendering.boostrapPreRenderProcess();}if(_25dd.useDNDController){lgr.trace(mname,"Initializing page layout drag-and-drop controller");ibmCfg.controllers.dnd=com.ibm.pb.control.DNDController.getController();}if(ibmCfg.themeConfig["handleBrowserResize"]&&ibmCfg.themeConfig["handleBrowserResize"]=="true"){com.ibm.pb.control.RenderingController.getController().handleBrowserResize(true);}if(_25dd.serverRuntimeContentPrimingNode){}if(_25dd.customInit){_25dd.customInit();}if(_25dd.initLiveTextService){lgr.trace(mname,"Initializing live text service");var _25fa=_25dd.liveTextInitArgs||{},_25fb=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.livetext.ServiceModel.SERVICE_NAME);if(_25dd.lazyLoadModeWidgets){var _25fc=new com.ibm.pb.iwidget.PageModeWidgetHandler({renderingController:ibmCfg.controllers.rendering,matchingModes:["edit"]});_25fa.preProcessCallbackFunc=dojo.hitch(_25fc,"preProcessCallbackFunc");_25fa.postProcessCallbackFunc=dojo.hitch(_25fc,"postProcessCallbackFunc");}_25fb.init(_25fa);}if(typeof (stproxy)!="undefined"&&!stproxy.isLoggedIn&&ibmCfg.portalConfig.currentUser.length>0){lgr.trace(mname,"Logging "+ibmCfg.portalConfig.currentUser+" onto Sametime");stproxy.login.loginByToken(ibmCfg.portalConfig.currentUser,stproxy.awareness.AVAILABLE,stproxy.i18nStrings.statusAvailable,null,function(){lgr.severe(mname,"Sametime login for "+ibmCfg.portalConfig.currentUser+" failed.");});}};}if(!dojo._hasResource["com.ibm.skins.Standard.skin"]){dojo._hasResource["com.ibm.skins.Standard.skin"]=true;dojo.provide("com.ibm.skins.Standard.skin");dojo.declare("com.ibm.skins.Standard.skin",com.ibm.pb.decorations.Control,{contextMenuOpenEvent:null,contextMenuCloseEvent:null,contextMenuMarkup:"<div class=\"iw-iWidget iw-Standalone\" id=\"${iWidgetMenuId}\">"+"<a class=\"iw-Definition\" href=\"${builderRoot}/widget-catalog/ContentSetMenu.xml?pragma=cache&max-age=1209600&cache-scope=public&vary=none&user-context=false\"></a>"+"<span class=\"iw-ItemSet\" title=\"attributes\" style=\"display: none;\">"+"<a class=\"iw-Item\" href=\"#contextMenuID\">widgetActions_${id}</a>"+"<a class=\"iw-Item\" href=\"#menuCSSClass\">lotusActionMenu</a>"+"<a class=\"iw-Item\" href=\"#resourceType\">com.ibm.mashups.iwidget.widget.IWidgetDefinition</a>"+"<a class=\"iw-Item\" href=\"#openEvent\">WidgetActions_${id}.open</a>"+"<a class=\"iw-Item\" href=\"#closeEvent\">WidgetActions_${id}.close</a>"+"</span>"+"</div>",constructor:function(id,node){var mname="constructor",lgr=this.LOGGER;this.id=id;this.iWidgetMenuId="widgetActionsMenu_"+id;this.root=node;this.contextMenuOpenEvent="WidgetActions_"+id+".open";this.contextMenuCloseEvent="WidgetActions_"+id+".close";this.contextMenu=new com.ibm.pb.decorations.ControlMenu(id,"widgetActions_"+id);var _25fd=dojo.query(".decoration-contextMenu",node)[0];if(_25fd){var map=dojo.delegate(this,{builderRoot:ibmConfig["com.ibm.mashups.contextroot.builder"]});lgr.trace(mname,"Creating hidden context menu widget in skin ${0}",[_25fd]);_25fd.innerHTML=dojo.string.substitute(this.contextMenuMarkup,map);dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[_25fd,true]);}this.contextMenuLink=dojo.query(".decoration-contextMenuAction",node)[0];if(this.contextMenuLink){lgr.trace(mname,"Attaching event handler to element ${0}",[this.contextMenuLink]);this.connect(this.contextMenuLink,"onclick","openContextMenu");}this.dndHandle=dojo.query(".decoration-dndHandle",node)[0];if(this.dndHandle){lgr.trace(mname,"Adding dojo dnd handle class to element ${0}",[this.dndHandle]);dojo.addClass(this.dndHandle,"dojoDndHandle");}var asaId=dojo.query("*[class~=asa.portlet.id]",node)[0];if(asaId){asaId.innerHTML=id;}var _25fe=dojo.query(".decoration-aria-region",node)[0];if(_25fe){lgr.trace(mname,"Creating ARIA region for element ${0}",[_25fe]);dojo.attr(_25fe,"role","region");dojo.attr(_25fe,"aria-labelledby","title."+id);dojo.attr(dojo.query(".decoration-title",node)[0],"id","title."+id);}},openContextMenu:function(evt){var mname="openContextMenu",lgr=this.LOGGER;lgr.entering(mname,arguments);this.evtSvc.broadcastEvent(this.contextMenuOpenEvent,{resourceId:this.id,domNode:evt.target});lgr.exiting(mname,arguments);},destroy:function(){this.evtSvc.broadcastEvent("com.ibm.mashups.iwidget.unloadwidgets",[this.iWidgetMenuId]);this.contextMenu.destroy();delete this.contextMenu;this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.skins.NoSkin.skin"]){dojo._hasResource["com.ibm.skins.NoSkin.skin"]=true;dojo.provide("com.ibm.skins.NoSkin.skin");dojo.declare("com.ibm.skins.NoSkin.skin",com.ibm.pb.decorations.Control,{constructor:function(id,node){var mname="constructor",lgr=this.LOGGER;this.id=id;this.root=node;var asaId=dojo.query("*[class~=asa.portlet.id]",node)[0];if(asaId){asaId.innerHTML=id;}var _25ff=dojo.query(".decoration-aria-region",node)[0];if(_25ff){lgr.trace(mname,"Creating ARIA region for element ${0}",[_25ff]);dojo.attr(_25ff,"role","region");dojo.attr(_25ff,"aria-labelledby","title."+id);dojo.attr(dojo.query(".decoration-title",node)[0],"id","title."+id);}},destroy:function(){this.inherited(arguments);}});}if(!dojo._hasResource["com.ibm.themes.PageBuilder2.iwidgets"]){dojo._hasResource["com.ibm.themes.PageBuilder2.iwidgets"]=true;dojo.provide("com.ibm.themes.PageBuilder2.iwidgets");(function(rc){var _2600={};_2600[dojo.moduleUrl("widget_catalog","ControlledNavWidget.xml")]={templateString:"<!-- ***************************************************************** -->\n<!--                                                                   -->\n<!-- Licensed Materials - Property of IBM                              -->\n<!--                                                                   -->\n<!-- 5724-U69                                                          -->\n<!--                                                                   -->\n<!-- Copyright IBM Corp. 2010  All Rights Reserved.                    -->\n<!--                                                                   -->\n<!-- US Government Users Restricted Rights - Use, duplication or       -->\n<!-- disclosure restricted by GSA ADP Schedule Contract with           -->\n<!-- IBM Corp.                                                         -->\n<!--                                                                   -->\n<!-- ***************************************************************** -->\n<iw:iwidget name=\"com.ibm.mm.builder.systemwidget.ControlledNavWidget\" xmlns:iw=\"http://www.ibm.com/xmlns/prod/iWidget\" iScope=\"com.ibm.mm.builder.systemwidget.ControlledNavWidget\" allowInstanceContent=\"true\" supportedModes=\"view\" mode=\"view\" lang=\"en\">\n    <iw:resource uri=\"ControlledNavWidget.js\" skipLoad=\"dojo.getObject('com.ibm.mm.builder.systemwidget.ControlledNavWidget') != null\" />\n    <iw:itemSet id=\"attributes\">\n        <iw:item id=\"version\" value=\"2.4\"/>\n    </iw:itemSet>\n\n\t<iw:event id=\"com.ibm.mashups.builder.refreshNavigation\" handled=\"true\" onEvent=\"onRefreshNavigation\" eventDescName=\"desc_refreshNavigation\"/>\n\t<iw:eventDescription id=\"desc_refreshNavigation\" payloadType=\"json\" description=\"Refresh the Navigation\" lang=\"en\" />\n\t\n\t<iw:event id=\"com.ibm.mashups.builder.pageSwitched\" handled=\"true\" onEvent=\"onPageSwitched\" eventDescName=\"desc_pageSwitched\"/>\n\t<iw:eventDescription id=\"desc_pageSwitched\" payloadType=\"json\" description=\"Handle the page switched event\" lang=\"en\" />\n\t\n\t<iw:event id=\"com.ibm.mashups.builder.changePageMode\" handled=\"true\" onEvent=\"onPageModeChanged\" eventDescName=\"desc_onPageModeChanged\"/>\n\t<iw:eventDescription id=\"desc_onPageModeChanged\" payloadType=\"text\" description=\"Enable or Disable DND when page mode changes\" lang=\"en\" />\n\t\n    <iw:content mode=\"view\">\n    </iw:content>\n</iw:iwidget>\n"};_2600[dojo.moduleUrl("widget_catalog","ContentSetList.xml")]={templateString:"<iw:iwidget name=\"ContentSetList\" xmlns:iw=\"http://www.ibm.com/xmlns/prod/iWidget\" \n\tiScope=\"com.ibm.mm.builder.systemwidget.ContentSetList\" allowInstanceContent=\"true\" \n\tsupportedModes=\"view\" mode=\"view\" lang=\"en\">\n\t\n\t<iw:resource uri=\"ContentSetList.js\" skipLoad=\"dojo.getObject('com.ibm.mm.builder.systemwidget.ContentSetList') != null\" />\n\t<iw:itemSet id=\"attributes\" >\n        <iw:item id=\"version\" value=\"1.0.0.0.0\"/>\n    </iw:itemSet>\n\t<iw:content mode=\"view\"></iw:content>\n</iw:iwidget>\n"};_2600[dojo.moduleUrl("widget_catalog","ContentSetMenu.xml")]={templateString:"<iw:iwidget name=\"ContentSetMenu\" xmlns:iw=\"http://www.ibm.com/xmlns/prod/iWidget\" \n\tiScope=\"com.ibm.mm.builder.systemwidget.ContentSetMenu\" allowInstanceContent=\"true\" \n\tsupportedModes=\"view\" mode=\"view\" lang=\"en\">\n\t\n\t<iw:resource uri=\"ContentSetMenu.js\" skipLoad=\"dojo.getObject('com.ibm.mm.builder.systemwidget.ContentSetMenu') != null\" />\n\t<iw:itemSet id=\"attributes\" >\n        <iw:item id=\"version\" value=\"2.4\"/>\n    </iw:itemSet>\n\t<iw:content mode=\"view\"></iw:content>\n</iw:iwidget>\n"};_2600[dojo.moduleUrl("widget_catalog","breadcrumbWidget.xml")]={templateString:"<!-- ***************************************************************** -->\n<!--                                                                   -->\n<!-- Licensed Materials - Property of IBM                              -->\n<!--                                                                   -->\n<!-- 5724-U69                                                          -->\n<!--                                                                   -->\n<!-- Copyright IBM Corp. 2009  All Rights Reserved.                    -->\n<!--                                                                   -->\n<!-- US Government Users Restricted Rights - Use, duplication or       -->\n<!-- disclosure restricted by GSA ADP Schedule Contract with           -->\n<!-- IBM Corp.                                                         -->\n<!--                                                                   -->\n<!-- ***************************************************************** -->\n\n<iw:iwidget name=\"com.ibm.mm.builder.Breadcrumb\" xmlns:iw=\"http://www.ibm.com/xmlns/prod/iWidget\" iScope=\"com.ibm.mm.builder.systemwidget.Breadcrumb\" allowInstanceContent=\"true\" supportedModes=\"view\" mode=\"view\" lang=\"en\">\n    <iw:resource uri=\"breadcrumbWidget.js\" skipLoad=\"dojo.getObject('com.ibm.mm.builder.systemwidget.Breadcrumb') != null\" />\n    <iw:itemSet id=\"attributes\">\n        <iw:item id=\"version\" value=\"2.4\"/>\n    </iw:itemSet>\n\n\t<iw:event id=\"com.ibm.mashups.builder.pageSwitched\" handled=\"true\" onEvent=\"onPageSwitched\" eventDescName=\"desc_onPageSwitched\"/>\n\t<iw:eventDescription id=\"desc_onPageSwitched\" payloadType=\"text\" description=\"adjust breadcrumb when page changed \" lang=\"en\" />\n\t\n    <iw:event id=\"com.ibm.mashups.builder.refreshNavigation\" handled=\"true\" onEvent=\"onRefreshNavigation\" eventDescName=\"desc_refreshNavigation\"/>\n\t<iw:eventDescription id=\"desc_refreshNavigation\" payloadType=\"json\" description=\"refresh breadcrumb UI\" lang=\"en\" />\n\t\t\n    <iw:content mode=\"view\">\n        <![CDATA[\n        \t\t<div class=\"\"></div>\n     \t]]>\n    </iw:content>\n</iw:iwidget>\n"};_2600[dojo.moduleUrl("widget_catalog","templateLayout.xml")]={templateString:"<!--author: Scott Consolatti (sconso@us.ibm.com); Michelle Young (smamos@us.ibm.com);  iWidget spec v1 -->\n<iw:iwidget name=\"templateLayout\" xmlns:iw=\"http://www.ibm.com/xmlns/prod/iWidget\" iScope=\"com.ibm.mm.builder.systemwidget.TemplateLayout\" supportedModes=\"view\" mode=\"view\">\n\t<iw:resource uri=\"templateLayout.js\" skipLoad=\"dojo.getObject('com.ibm.mm.builder.systemwidget.TemplateLayout') != null\" /> \n    <iw:itemSet id=\"attributes\" private=\"true\">\n    \t<iw:item id=\"version\" value=\"1.0.0.0.0\"/>\n    \t<iw:item id=\"targetDiv\" value=\"layoutContainers\"/>\n     </iw:itemSet>\n\t  \n\t<iw:event id=\"com.ibm.mashups.builder.layoutRefresh\" handled=\"true\" onEvent=\"onLayoutRefresh\" eventDescName=\"desc_onLayoutRefresh\"/>\n\t<iw:eventDescription id=\"desc_onLayoutRefresh\" payloadType=\"text\" description=\"refresh layout \" lang=\"en\">\n\t</iw:eventDescription>  \n\t\n    <iw:event id=\"com.ibm.mashups.builder.pageSwitched\" handled=\"true\" onEvent=\"onPageSwitched\" eventDescName=\"desc_onPageSwitched\"/>\n\t<iw:eventDescription id=\"desc_onPageSwitched\" payloadType=\"text\" description=\"adjust layout when page changed \" lang=\"en\">\n\t</iw:eventDescription>\t\n\n    <iw:event id=\"com.ibm.mashups.builder.addNewWire\" handled=\"true\" onEvent=\"onNewWireAdded\" eventDescName=\"desc_onNewWireAdded\"/>\n\t<iw:eventDescription id=\"desc_onNewWireAdded\" payloadType=\"text\" description=\"update widget instance markup to add new wire\" lang=\"en\">\n\t</iw:eventDescription>\n\t\n    <iw:event id=\"com.ibm.mashups.builder.removeWire\" handled=\"true\" onEvent=\"onWireRemoved\" eventDescName=\"desc_onWireRemoved\"/>\n\t<iw:eventDescription id=\"desc_onWireRemoved\" payloadType=\"text\" description=\"update widget instance markup to remove wire\" lang=\"en\">\n\t</iw:eventDescription>\n\t\n\t<iw:event id=\"com.ibm.mashups.builder.viewHiddenWidgets\" handled=\"true\" onEvent=\"onViewHiddenWidgets\" eventDescName=\"desc_onViewHiddenWidgets\"/>\n\t<iw:eventDescription id=\"desc_onViewHiddenWidgets\" payloadType=\"text\" description=\"show hidden widgets \" lang=\"en\">\n\t</iw:eventDescription>\n\t\n\t<iw:event id=\"com.ibm.mashups.builder.hideHiddenWidgets\" handled=\"true\" onEvent=\"onHideHiddenWidgets\" eventDescName=\"desc_onHideHiddenWidgets\"/>\n\t<iw:eventDescription id=\"desc_onHideHiddenWidgets\" payloadType=\"text\" description=\"hide hidden widgets \" lang=\"en\">\n\t</iw:eventDescription>\n\n\t<iw:event id=\"com.ibm.mashups.builder.preRenderComplete\" handled=\"true\" onEvent=\"onPreRenderComplete\" eventDescName=\"desc_onPreRenderComplete\"/>\n\t<iw:eventDescription id=\"desc_onPreRenderComplete\" payloadType=\"any\" description=\"render markup after pre-render processing is complete\" lang=\"en\">\n\t</iw:eventDescription>  \n\t\n  \t<iw:event id=\"com.ibm.mashups.builder.preRenderProcess\" published=\"true\" eventDescName=\"desc_preRenderProcess\" />\n    <iw:eventDescription id=\"desc_preRenderProcess\" payloadType=\"any\" description=\"Publish markup for pre-render processing\" lang=\"en\">\n    </iw:eventDescription>\n\n\t<iw:event id=\"com.ibm.mashups.builder.layoutRefreshed\" published=\"true\" eventDescName=\"desc_layoutRefreshed\"/>\n\t<iw:eventDescription id=\"desc_layoutRefreshed\" payloadType=\"text\" description=\"layout has been refreshed\" lang=\"en\">\n\t</iw:eventDescription>  \n\t\n  \t<iw:event id=\"com.ibm.mashups.builder.defXMLUrlPublished\" published=\"true\" onNewWire=\"publishFreeFormXMLUrl\" eventDescName=\"desc_publishFreeFormXMLUrl\" />\n    <iw:eventDescription id=\"desc_publishFreeFormXMLUrl\" payloadType=\"text\" description=\"Publish free form widget xml url\" lang=\"en\">\n    </iw:eventDescription>\n\n \n\t\t\t\t             \t          \t\t\n    <iw:content mode=\"view\">\n\t\t<![CDATA[\n\t\t\t<div>\n\t\t\t\t<div id=\"_IWID_templateLayoutDiv\"></div>\n\t\t\t</div>\n     ]]>\n\t</iw:content>\n \n</iw:iwidget>\n"};_2600[dojo.moduleUrl("widget_catalog","displayHelper.xml")]={templateString:"<!-- ***************************************************************** -->\n<!--                                                                   -->\n<!-- Licensed Materials - Property of IBM                              -->\n<!--                                                                   -->\n<!-- 5724-U69                                                          -->\n<!--                                                                   -->\n<!-- Copyright IBM Corp. 2015  All Rights Reserved.                    -->\n<!--                                                                   -->\n<!-- US Government Users Restricted Rights - Use, duplication or       -->\n<!-- disclosure restricted by GSA ADP Schedule Contract with           -->\n<!-- IBM Corp.                                                         -->\n<!--                                                                   -->\n<!-- ***************************************************************** -->\n\n<iw:iwidget name=\"displayHelper\" xmlns:iw=\"http://www.ibm.com/xmlns/prod/iWidget\" iScope=\"com.ibm.mm.builder.systemwidget.displayHelper\" allowInstanceContent=\"true\" supportedModes=\"view edit\" mode=\"view\" lang=\"en\">\n\n<iw:itemSet id=\"attributes\" >\n    <iw:item id=\"version\" value=\"1.0.0.0.0\"/>\n</iw:itemSet>\n\t\n<iw:event id=\"com.ibm.mashups.builder.displayInMashupDialog\" handled=\"true\" onEvent=\"handleDisplayInDialog\" eventDescName=\"desc_displayInDialog\"/>\n<iw:eventDescription id=\"desc_displayInDialog\" payloadType=\"JSON\" title=\"Widget and Event\" description=\"Receives a widget ID, iEvent Name and payload for that event from another widget and displays the widget in a model dialog\" lang=\"en\">\n\t<!--@displayHelper.ondisplayHelperDisplay@-->\n</iw:eventDescription>\n\n<iw:event id=\"com.ibm.mashups.builder.closeMashupDialog\" handled=\"true\" onEvent=\"onCloseDialog\" eventDescName=\"desc_closeDialog\"/>\n<iw:eventDescription id=\"desc_closeDialog\" payloadType=\"text\" description=\"\" lang=\"en\">\n\t<iw:alt discription=\"\" lang=\"de\"/>\n\t<iw:alt discription=\"\" lang=\"cn\"/>\n</iw:eventDescription>\n\n<iw:resource uri=\"displayHelper.js\" skipLoad=\"dojo.getObject('com.ibm.mm.builder.systemwidget.displayHelper') != null\" />\n\n<iw:content mode=\"view\">\n\t<![CDATA[\n\t]]>\n</iw:content>\n</iw:iwidget>\n"};for(var k in _2600){if(_2600.hasOwnProperty(k)&&_2600[k]&&_2600[k].templateString){rc.set(k,_2600[k].templateString);}}})(com.ibm.pb.io.RESOURCE_CACHE);}if(!dojo._hasResource["com.ibm.mm.builder.systemwidget.ControlledNavWidget"]){dojo._hasResource["com.ibm.mm.builder.systemwidget.ControlledNavWidget"]=true;dojo.provide("com.ibm.mm.builder.systemwidget.ControlledNavWidget");dojo.declare("com.ibm.mm.builder.systemwidget.ControlledNavWidget",com.ibm.pb.iwidget.iWidgetBase,{controller:null,dndOperable:false,varyLevelCondition:false,attachNode:null,firstItemClass:null,editorIWidgetID:null,selectionModel:null,onLoad:function(){var mname="onLoad",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);var attrs=this.iContext.getiWidgetAttributes();var _2601=this.getItemSetValues(["dndType","dndAccept","firstItemClass","attachNode","editorIWidgetID","varyLevelCondition","openDelay","popupDelay","closeDelay","level","levels","baseClass","tabListClass","tabClass","class","selectedClass","showInlineEditor","tiedToSelection","dndOperable","item","controller","dndCreator"]);this.convertMapTypes(_2601,["openDelay","popupDelay","closeDelay","level","levels"],"Number");this.convertMapTypes(_2601,["showInlineEditor","tiedToSelection","dndOperable"],"Boolean");this.convertMapTypes(_2601,["item","controller","dndCreator"],"Object");if(_2601.editorIWidgetID){this.editorIWidgetID=_2601.editorIWidgetID;}dojo.forEach(["dndOperable","controller","firstItemClass","attachNode","varyLevelCondition"],function(key){this[key]=_2601[key];delete _2601[key];},this);this.baseLevel=_2601.level;this.selectionModel=this.controller.getSelectionModel();var _2602=dojo.delegate({model:this.controller.getTreeModel(),selectionModel:this.selectionModel,tiedToSelection:true,skipPreload:true,openDelay:0,closeDelay:500,popupDelay:500,dndClass:"com.ibm.pb.dnd.ControlledModeledSource",dndType:"nm",dndAccept:"nm",dndEnabled:false,dndCreator:com.ibm.dnd.PAGE_CREATOR.creator,showInlineEditor:this.showInlineEditor,baseClass:"",tabListClass:"lotusInlinelist lotusLinks",tabClass:"","class":"",selectedClass:"lotusSelected",getVariedLevel:function(){if(me.checkVaryLevel()){return me.baseLevel+1;}else{return me.baseLevel;}},inlineEditorWidgetParams:{onClick:function(){var cb=dojo.hitch(me,function(){com.ibm.pb.iwidget.control.onLoad(me.editorIWidgetID,function(){me.evtSvc.broadcastEvent(me.builderEvents.CREATE_PAGE,{spaceId:me.controller.getCurrentSpaceId(),parentPageId:me.widget.model.getIdentity(me.widget.item)});});});if(com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().isDirty()){var cws=com.ibm.mm.builder.coreWidgetsStrings;var _2603=new com.ibm.mm.builder.dialog.PageSaveConfirmDialog({contentWarning:cws.I_PAGE_SAVE_WARNING,contentQuestion:cws.I_PAGE_SAVE_SUGGEST,btnSaveText:cws.I_COMMON_SAVE,btnNotSaveText:cws.I_PAGE_SAVE_NO_SAVE,btnCancelText:cws.I_PAGE_SAVE_KEEP_EDIT,callbackSave:cb,callbackNotSave:cb,hideNotSave:true,callbackCancel:function(){}});_2603.show();}else{cb();}}},onModelItemClick:function(_2604,item){lgr.trace("closure","SWITCH_PAGE called via onModelItemClick ${0} ${1}",[_2604,item]);me.evtSvc.broadcastEvent(me.builderEvents.SWITCH_PAGE,this.model.getIdentity(item));}},_2601);if(this.attachNode){this.attachNode=dojo.byId(this.attachNode);}if(!this.attachNode){this.attachNode=this.iContext.getRootElement();}this.widget=new com.ibm.widgets.NavigationWidget(_2602,this.attachNode);if(this.firstItemClass){dojo.connect(this.widget,"onLoad",this.widget,function(){var ch=this.getChildren();if(ch.length>0){dojo.addClass(ch[0].domNode,me.firstItemClass);}});}this.widget.startup();lgr.exiting(mname,arguments);},checkVaryLevel:function(){var mname="checkVaryLevel",lgr=this.LOGGER;lgr.entering(mname,arguments);var ret=false;if(this.varyLevelCondition&&(!this.widget||this.widget.level==this.baseLevel)){lgr.trace(mname,"Checking varyLevelCondition");ret=eval(this.varyLevelCondition);}lgr.exiting(mname,[ret]);return ret;},onPageSwitched:function(_2605){var mname="onPageSwitched",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.dndOperable){this.widget.disableDnd();}lgr.exiting(mname,arguments);},onPageModeChanged:function(_2606){var mname="onPageModeChanged",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.dndOperable){if(_2606.payload==="edit"){this.widget.setupDnd();}else{this.widget.disableDnd();}}lgr.exiting(mname,arguments);},onRefreshNavigation:function(_2607){var mname="onRefreshNavigation",lgr=this.LOGGER;lgr.entering(mname,arguments);try{this.refresh(_2607.payload);}catch(e){var msg=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_NAV_REFRESH_NAVIGATION_1,[e.message]);lgr.severe(mname,msg);}lgr.exiting(mname,arguments);},refresh:function(pid){var mname="refresh",lgr=this.LOGGER;lgr.entering(mname,arguments);this.widget.reload();lgr.exiting(mname,arguments);},onUnload:function(){var mname="onUnload",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.widget){this.widget.destroy(true);this.widget=null;}lgr.exiting(mname,arguments);}});}if(!dojo._hasResource["com.ibm.mm.builder.systemwidget.ContentSetList"]){dojo._hasResource["com.ibm.mm.builder.systemwidget.ContentSetList"]=true;dojo.provide("com.ibm.mm.builder.systemwidget.ContentSetList");dojo.declare("com.ibm.mm.builder.systemwidget.ContentSetList",[com.ibm.pb.iwidget.iWidgetBase],{listCSSClass:"",initEvent:"",targetDOMNode:null,contextMenuID:"",resourceType:"",constructor:function(){this._listConnections=[];},getData:function(_2608){var mname="getData",lgr=this.LOGGER;lgr.entering(mname,arguments);var _2609=this.builderFactory.getContextMenuModel();var data=_2609.getContextMenu(this.contextMenuID,_2608,this.resourceType,{context:this});lgr.exiting(mname,[data]);return data;},onLoad:function(){var mname="onLoad",lgr=this.LOGGER;lgr.entering(mname,arguments);this.inherited(arguments);dojo.mixin(this,this.getItemSetValues(["contextMenuID","resourceType","resourceId","init_resourceId","listCSSClass","targetDOMNode","initEvent"]));if(!this.resourceId&&this.init_resourceId){this.resourceId=dojo.eval(this.init_resourceId);}lgr.trace(mname,"Loaded ${0} with resourceId %{1}",[this,this.resourceId]);this.targetDOMNode=dojo.byId(this.targetDOMNode);if(!this.targetDOMNode){this.targetDOMNode=this.iContext.getRootElement();this.listNode=dojo.create("ul",{},this.targetDOMNode);}else{this.listNode=dojo.query("ul",this.targetDOMNode)[0];}if(this.listCSSClass){dojo.addClass(this.listNode,this.listCSSClass);}this.init(this.resourceId);if(this.initEvent){this.evtSvc.subscribeEvent(this.initEvent,this,"init");}lgr.exiting(mname,arguments);},init:function(_260a){this.resourceId=_260a;if(!this.refNode){this.refNode=dojo.query("li.content",this.listNode)[0];if(!this.refNode){this.refNode=dojo.create("li",{"class":"content",style:{"display":"none"}},this.listNode);}}dojo.query("> .content-set-item",this.listNode).forEach(dojo.destroy,dojo);this.buildList();},buildList:function(){var mname="buildList",lgr=this.LOGGER;lgr.entering(mname,arguments);while(this._listConnections.length>0){dojo.disconnect(this._listConnections.shift());}var data=this.getData(this.resourceId);dojo.forEach(data,function(item){var li=dojo.create("li",{"class":"content-set-item","id":item.id},this.refNode,"before");if(item.markup){li.innerHTML=dojo.string.substitute(item.markup,{title:item.title||"",description:item.description||""});}else{var anc=dojo.create("a",{href:"javascript:;"},li);anc.appendChild(document.createTextNode(item.title));}if(item.iconClass){dojo.addClass(li,item.iconClass);}this._listConnections.push(dojo.connect(li,"onclick",li,item.actionCallBackFunction));},this);lgr.exiting(mname,arguments);},onUnload:function(){while(this._listConnections.length>0){dojo.disconnect(this._listConnections.shift());}}});}if(!dojo._hasResource["com.ibm.mm.builder.systemwidget.ContentSetMenu"]){dojo._hasResource["com.ibm.mm.builder.systemwidget.ContentSetMenu"]=true;dojo.provide("com.ibm.mm.builder.systemwidget.ContentSetMenu");dojo.declare("com.ibm.mm.builder.systemwidget.ContentSetMenu",[com.ibm.pb.iwidget.iWidgetBase],{openEvent:"",closeEvent:"",menuCSSClass:"",anchorCSSClass:"",menu:null,contextMenuID:"",resourceType:"",constructor:function(){this._menuConnections=[];},getData:function(_260b){var mname="getData",lgr=this.LOGGER;lgr.entering(mname,arguments);var _260c=this.builderFactory.getContextMenuModel();var data=_260c.getContextMenu(this.contextMenuID,_260b,this.resourceType,{context:this});lgr.exiting(mname,[data]);return data;},onLoad:function(){var mname="onLoad",lgr=this.LOGGER;lgr.entering(mname,arguments);this.inherited(arguments);dojo.mixin(this,this.getItemSetValues(["contextMenuID","resourceType","openEvent","closeEvent","menuCSSClass","anchorCSSClass"]));this.id=this.iContext.widgetId;if(this.openEvent){lgr.trace(mname,"Subscribing to open event ${0}",[this.openEvent]);this.evtSvc.subscribeEvent(this.openEvent,this,this.open,null,this.id);}if(this.closeEvent){lgr.trace(mname,"Subscribing to close event ${0}",[this.closeEvent]);this.evtSvc.subscribeEvent(this.closeEvent,this,this.close,null,this.id);}this._initMenu();lgr.exiting(mname,arguments);},open:function(_260d){var mname="open",lgr=this.LOGGER;lgr.entering(mname,arguments);try{if(this._currentResourceId!=_260d.resourceId){this.initContents(_260d.resourceId);}var me=this,ori=_260d.orientation;if(!ori){ori=this.menu.isLeftToRight()?{"BL":"TL","TL":"BL","BR":"TR","TR":"BR"}:{"BR":"TR","TR":"BR","BL":"TL","TL":"BL"};}var menu=this.menu,_260e=dijit.getFocus(menu),_260f=function(){if(menu.refocus){dijit.focus(_260e);}me.close();};lgr.trace(mname,"Popping up menu ${0} around ${1} using orientation ${2}",[this.menu,_260d.domNode,ori]);if(_260d.domNode&&this.anchorCSSClass){dojo.addClass(_260d.domNode,this.anchorCSSClass);}dijit.popup.open({parent:this,popup:this.menu,orient:ori,around:_260d.domNode,onExecute:_260f,onCancel:_260f,onClose:function(){if(_260d.domNode&&me.anchorCSSClass){dojo.removeClass(_260d.domNode,me.anchorCSSClass);}}});this.menu.focus();}catch(err){lgr.severe(mname,"Error opening menu ${0} ${1}",[this,err]);throw err;}lgr.exiting(mname,arguments);},close:function(_2610){var mname="close",lgr=this.LOGGER;lgr.entering(mname,arguments);if(this.menu.close){this.menu.close();}else{dijit.popup.close(this.menu);}lgr.exiting(mname,arguments);},refreshContents:function(){this.initContents(this._currentResourceId);},_initMenu:function(){var mname="_initMenu",lgr=this.LOGGER;lgr.entering(mname,arguments);while(this._menuConnections.length>0){dojo.disconnect(this._menuConnections.shift());}if(this.menu){this.menu.destroyRecursive();}this.menu=new dijit.Menu({leftClickToOpen:true,offset_y:9});this._menuConnections.push(dojo.connect(this.menu,"onBlur",this,this.close));dojo.addClass(this.menu.domNode,this.menuCSSClass);this.menu.startup();lgr.exiting(mname,arguments);},initContents:function(_2611){var mname="initContents",lgr=this.LOGGER;lgr.entering(mname,arguments);this._currentResourceId=_2611;this.clearContents();this.fillContents(_2611);if(!this._menuListener){this._menuListener=this.builderFactory.getContextMenuModel().registerListener(this.contextMenuID,this,this.refreshContents);}lgr.exiting(mname,arguments);},clearContents:function(){this.menu.destroyDescendants();},fillContents:function(_2612){var mname="fillContents",lgr=this.LOGGER;lgr.entering(mname,arguments);var data=this.getData(_2612);dojo.forEach(data,function(item){var _2613=item.isSeparator?new dijit.MenuSeparator():new dijit.MenuItem({label:item.title,iconClass:item.iconClass||"",disabled:!item.enabled,onClick:item.actionCallBackFunction,pageActionType:item.id});if(item.itemClass){dojo.addClass(_2613.domNode,item.itemClass);}lgr.trace(mname,"Adding menu item ${0} to menu ${1} backed by item ${2}",[_2613,this.menu,item]);this.menu.addChild(_2613);},this);lgr.exiting(mname,[data]);},onUnload:function(){console.log("unloading");if(this.menu){this.menu.destroyRecursive();}if(this._menuListener){console.log("disconnecting menu listener %o",this._menuListener);this.builderFactory.getContextMenuModel().unregisterListener(this._menuListener);}}});}dojo.declare("com.ibm.mm.builder.systemwidget.Breadcrumb",com.ibm.pb.iwidget.iWidgetBase,{startLevel:1,controller:null,varyLevelInSpace:false,attachNode:null,onLoad:function(){var mname="onLoad",lgr=this.LOGGER;lgr.entering(mname,arguments);this.navWidgetBundle=dojo.i18n.getLocalization("com.ibm.bundles","NavWidget");var _2614=this.getItemSetValues(["attachNode","startLevel","levels","containerClass","listClass","siblingSeparator","renderSiblings","levelVaryInSpace","controller"]);this.convertMapTypes(_2614,["startLevel","levels"],"Number");this.convertMapTypes(_2614,["renderSiblings","levelVaryInSpace"],"Boolean");this.convertMapTypes(_2614,["controller"],"Object");this.startLevel=_2614.startLevel;dojo.forEach(["controller","attachNode","varyLevelInSpace"],function(key){this[key]=_2614[key];delete _2614[key];},this);var _2615=dojo.delegate({model:this.controller.getSelectionModel(),startLevel:1,renderSiblings:false,siblingSeparator:"",allowNew:false,listDOM:"span",itemDOM:"span",listClass:"lotusBreadcrumbs",containerClass:"ibmPortalBreadcrumbs lotusLeft",onClickItem:function(item){return;}},_2614);if(this.attachNode){this.attachNode=dojo.byId(this.attachNode);}if(!this.attachNode){this.attachNode=this.iContext.getRootElement();}this.breadcrumb=new com.ibm.widgets.Breadcrumbs(_2615,this.attachNode);this.breadcrumb.createDomLink=function(item,_2616,_2617,node){var _2618=document.createElement(this.itemDOM);dojo.addClass(_2618,_2616);var link=document.createElement("a");_2618.appendChild(link);_2618.appendChild(document.createTextNode(_2617));link.innerHTML=this.treeModel.getLabel(item);link.href="javascript:;";if(ibmCfg.themeConfig.isPageRenderModeCSA){dojo.connect(link,"onclick",dojo.hitch(this,function(){var cb=dojo.hitch(this,function(){var es=com.ibm.mashups.iwidget.services.ServiceManager.getService("eventService");es.broadcastEvent("com.ibm.mashups.builder.switchPage",this.treeModel.getIdentity(item));});com.ibm.mm.builder.utils.pageUtil.savePageWithConfirm(cb);}));}else{dojo.connect(link,"onclick",dojo.hitch(this,function(){var cb=dojo.hitch(this,function(){var pid=this.treeModel.getIdentity(item);com.ibm.mm.builder.utils.pageUtil.setPageId(pid);var _2619=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();var _261a=com.ibm.mashups.enabler.model.state.UrlGeneratorFactory.getUrlGenerator().getUrl(_2619);setTimeout(function(){location.href=_261a;},10);return;});com.ibm.mm.builder.utils.pageUtil.savePageWithConfirm(cb);}));}this.trail.insertBefore(_2618,node);return _2618;};this.breadcrumb.startup();lgr.exiting(mname,arguments);},onRefreshNavigation:function(_261b){var mname="onRefreshNavigation",lgr=this.LOGGER;lgr.entering(mname,arguments);try{this.refresh(_261b.payload);}catch(e){var msg=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_NAV_REFRESH_NAVIGATION_1,[e.message]);lgr.severe(mname,msg);}lgr.exiting(mname,arguments);},onPageSwitched:function(_261c){var mname="onPageSwitched",lgr=this.LOGGER;lgr.entering(mname,arguments);try{if(this.varyLevelInSpace&&this.controller.getCurrentSpaceId()&&this.breadcrumb.startLevel==this.startLevel){lgr.trace(mname,"Navigated into a space, reset level of breadcrumb widget ${0} to ${1}",[this,this.startLevel+1]);this.widget.attr("level",this.startLevel+1);this.refresh(_261c.payload);}}catch(e){var msg=dojo.string.substitute(com.ibm.mm.builder.coreWidgetsMessages.E_NAVIGATION_SWITCH_PAGE_1,[e.message]);lgr.severe(mname,msg);}lgr.exiting(mname,arguments);},refresh:function(pid){var mname="refresh",lgr=this.LOGGER;lgr.entering(mname,arguments);this.breadcrumb.redraw();lgr.exiting(mname,arguments);},onUnload:function(){if(this.breadcrumb!=null){this.breadcrumb.destroy();this.breadcrumb=null;}}});if(!dojo._hasResource["com.ibm.mm.builder.systemwidget.TemplateLayout"]){dojo._hasResource["com.ibm.mm.builder.systemwidget.TemplateLayout"]=true;dojo.provide("com.ibm.mm.builder.systemwidget.TemplateLayout");dojo.declare("com.ibm.mm.builder.systemwidget.TemplateLayout",null,{WID:null,targetDiv:null,pageId:null,defaultInitialSettings:{},navStateModel:null,pageAccessor:null,navModel:null,currentPageID:null,currentPage:null,serverRuntimeContent:null,layoutModel:null,onLoad:function(){this.WID="_"+this.iContext.widgetId+"_";var _261d=this.iContext.getiWidgetAttributes();var _261e=_261d.getItemValue("targetDiv");this.targetDiv=dojo.byId(_261e);if(!this.targetDiv){this.targetDiv=dojo.byId(this.WID+"templateLayoutDiv");}this.navStateModel=com.ibm.mashups.enabler.model.state.NavigationStateModelFactory.getNavigationStateModel();this.pageAccessor=com.ibm.mashups.enabler.model.state.AccessorFactory.getPageAccessor(this.navStateModel);this.navModel=com.ibm.mashups.enabler.model.Factory.getNavigationModel();this.configService=com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.enabler.services.ConfigService.SERVICE_NAME);if(this.pageAccessor.getPageID()!==ibmPortalConfig.currentPageOID){this.getCurrentPage(dojo.hitch(this,"refreshLayoutTimer"));}else{this.getCurrentPage();}},refreshLayoutTimer:function(){setTimeout(dojo.hitch(this,function(){this.refreshLayout();}),50);},getCurrentPage:function(cbk){var _261f=this.pageAccessor.getPageID();if(_261f==this.currentPageID){return;}this.currentPageID=_261f;this.currentPage=null;this.serverRuntimeContent=null;this.layoutModel=null;if(!this.currentPageID){return null;}var _2620=this.navModel.find(this.currentPageID);_2620.setFinishedCallback(dojo.hitch(this,"getCurrentPageContinue"),{callback:cbk});_2620.start(false);},getCurrentPageContinue:function(_2621,_2622,_2623){var _2624=_2621.getID();this.currentPage=_2621;if(_2623&&_2623.callback){_2623.callback(_2624);}},getLayoutModel:function(){this.layoutModel=this.currentPage?this.navModel.getLayoutModel(this.currentPage):null;return this.layoutModel;},getServerRuntimeContent:function(){if(this.currentPage&&this.currentPage.getNavigationElementType()!=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL){this.serverRuntimeContent=this.currentPage.getServerRuntimeContent();}else{this.serverRuntimeContent=null;}return this.serverRuntimeContent;},primeServerRuntimeContent:function(value){if(this.currentPage&&this.currentPage.getNavigationElementType()!=com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_LABEL){}},onview:function(){},onUnload:function(){},onLayoutRefresh:function(_2625){if(!this.currentPage){return;}if(_2625&&_2625.payload&&(typeof _2625.payload=="string")&&(_2625.payload.length>0)){var lm=this.getLayoutModel();if(lm){var _2626=lm.find(_2625.payload);if(_2626){_2626.setFinishedCallback(dojo.hitch(this,"refreshContainer"));_2626.start(false);}}}else{this.unloadAllControls();this.refreshLayout();}},refreshLayout:function(_2627){_2627=_2627||null;var _2628=this.getServerRuntimeContent();if(!_2628){var _2629=this.configService.getValue("labelDefaultRuntimeContent");if(_2629){if(dojo.isFunction(_2629)){_2629=_2629(this.currentPageID);}this.preRenderProcessLayout(_2629,200,_2627);}}else{var _262a=_2628.getServerRuntimeMarkup(null);_262a.setFinishedCallback(dojo.hitch(this,"preRenderProcessLayout"),_2627);_262a.start(false);}},preRenderProcessLayout:function(_262b,_262c,_262d){com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.preRenderProcess",{"id":null,"markup":_262b,"_pageId":_262d},"any",this.iContext.widgetId);},refreshContainer:function(_262e){if(_262e){var div=dojo.byId(_262e.getID());if(div){this.unloadControl(_262e);var _262f=_262e.getRuntimeContent().getRuntimeMarkup();_262f.setFinishedCallback(dojo.hitch(this,"preRenderProcessContainer"),div);_262f.start(false);}}},preRenderProcessContainer:function(_2630,_2631,div){com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.preRenderProcess",{"id":div.id,"markup":_2630},"any",this.iContext.widgetId);},refreshAllContainers:function(){if(!this.currentPage){return;}var lm=this.getLayoutModel();if(lm){var _2632=lm.getRoot();_2632.setFinishedCallback(dojo.hitch(this,"refreshAllContainersContinue"));_2632.start(false);}},refreshAllContainersContinue:function(_2633){var lm=this.getLayoutModel();if(_2633&&lm&&lm.hasChildren(_2633)){var _2634=lm.getChildren(_2633);_2634.setForeachCallback(dojo.hitch(this,"refreshContainer"));_2634.start(false);}},onPreRenderComplete:function(_2635){if(_2635&&_2635.payload){var _2636=_2635.payload;if(_2636._pageId&&this.pageId&&(_2636._pageId!=this.pageId)){return;}if(_2636.id&&typeof _2636.id=="string"){var div=dojo.byId(_2636.id);if(div&&_2636.markup&&typeof _2636.markup=="string"){this.refreshContainerContinue(_2636.markup,null,div);}}else{if(typeof _2636=="string"){this.refreshLayoutContinue(_2636,null);}else{if(_2636.markup&&typeof _2636.markup=="string"){this.refreshLayoutContinue(_2636.markup,_2636.fn);}}}}},refreshLayoutContinue:function(_2637,fn){if(typeof fn==="function"){fn(this.targetDiv,_2637,dojo.hitch(this,"updateLiveText"));}else{this.targetDiv.innerHTML=_2637;this.primeServerRuntimeContent(this.targetDiv);this.updateLiveText(this.targetDiv,null);}this.resetDND();},refreshContainerContinue:function(_2638,_2639,div){var id=div.id;dojo.place(_2638,div,"replace");var _263a=dojo.byId(id);this.primeServerRuntimeContent(this.targetDiv);this.updateLiveText(this.targetDiv,id);this.resetDND();},updateLiveText:function(_263b,id){dojo.publish("/com/ibm/mashups/livetext/livetextchanged",[_263b,true]);com.ibm.mashups.services.ServiceManager.getService("eventService").broadcastEvent("com.ibm.mashups.builder.layoutRefreshed",id,"text",this.iContext.widgetId);},resetDND:function(){ibmCfg.controllers.dnd.reset();if(com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().getPageMode()=="edit"){ibmCfg.controllers.dnd.init();}},onPageSwitched:function(_263c){this.pageId=_263c.payload;var _263d=null;if(this.pageId=="com.ibm.mm.builder.embedPageFailErrMsg"){this.loadMsgToLayout(com.ibm.mm.builder.coreWidgetsMessages.E_EMBEDDING_PAGEACCESS_ERROR_0);return;}if(!this.pageId){this.unloadAllControls();this.loadMsgToLayout(com.ibm.mm.builder.coreWidgetsStrings.W_NO_PAGE_TO_SHOW);return;}else{this.unloadAllControls();this.getCurrentPage(dojo.hitch(this,"refreshLayout"));}var _263e=_263d?this.filterLayoutAttr(_263d.pageAttributes):null;if(!_263e){_263e=this.defaultInitialSettings;}if(this.pageId){var _263f=_263e[com.ibm.mm.builder.constant.autoWiringEnabled];com.ibm.mashups.builder.model.Factory.getRuntimeModel().getCurrentPage().setAutoWiringEnablement(_263f);}},unloadAllControls:function(){if(!this.currentPage){return;}var lm=this.getLayoutModel();if(lm){var _2640=lm.getRoot();_2640.setFinishedCallback(dojo.hitch(this,"unloadAllControlsContinue"));_2640.start(false);}},unloadAllControlsContinue:function(_2641){var lm=this.getLayoutModel();if(_2641&&lm.hasChildren(_2641)){var _2642=lm.getChildren(_2641);_2642.setForeachCallback(dojo.hitch(this,"unloadControl"));_2642.start(false);}},unloadControl:function(_2643){if(_2643){if(_2643.getLayoutNodeType()==com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTAINER){this.unloadAllControlsContinue(_2643);}else{if(_2643.getLayoutNodeType()==com.ibm.mashups.enabler.layout.Constants.LAYOUT_CONTROL){com.ibm.mashups.services.ServiceManager.getService("eventService").publishEvent(com.ibm.mashups.iwidget.Constants.UNLOAD_WIDGETS,[_2643.getID(),"widgetActionsMenu_"+_2643.getID()]);}}}},onViewHiddenWidgets:function(_2644){dojo.query(".hiddenWidgetsContainer").forEach(function(node,index,arr){node.style.display="block";});},onHideHiddenWidgets:function(_2645){dojo.query(".hiddenWidgetsContainer").forEach(function(node,index,arr){node.style.display="none";});},loadMsgToLayout:function(msg){this.targetDiv.innerHTML=this.getEmptyPageMessage(msg);},getEmptyPageMessage:function(msg){var _2646="<div class='empty_div'>"+"<div class='empty_outer_div'>"+"<div class='empty_inner_div'>"+com.ibm.mm.builder.utils.htmlUtil.formatMessage(msg)+"</div>"+"</div>"+"</div>";return _2646;},loadNullToLayout:function(){this.targetDiv.innerHTML="";},filterLayoutAttr:function(_2647){var _2648={};var keys=["com.ibm.mashups.builder.autoWiringEnabled"];for(var key in _2647){if(dojo.indexOf(keys,key)>=0){_2648[key]=_2647[key];}}return dojo.toJson(_2648)=="{}"?null:_2648;},publishFreeFormXMLUrl:function(){this.iContext.iEvents.publishEvent("com.ibm.mashups.builder.defXMLUrlPublished",this.getWidgetDefURL());},getWidgetDefUrl:function(){var def=dojo.query(".iw-Definition",dojo.byId(this.iContext.widgetId))[0];if(!def){def=dojo.query(".mm_Definition",dojo.byId(this.iContext.widgetId))[0];}if(def){return def.getAttribute("href");}else{return "";}}});}dojo.declare("com.ibm.mm.builder.systemwidget.displayHelper",null,{dialogContent:null,uniDialog:null,widgetDialogMap:null,idMap:null,onLoad:function(){this.widgetDialogMap={};this.idMap=this.iContext.getiWidgetAttributes();this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger("com.ibm.mm.builder.systemwidget.displayHelper");},onCloseDialog:function(_2649){var _264a=_2649.payload;if(_264a){this.closeDialog(_264a);}},closeDialog:function(_264b){if(this.widgetDialogMap[_264b]){this.widgetDialogMap[_264b].hide();}},displayWidgetInDialog:function(_264c,_264d,_264e,_264f,_2650){if(_264c===null){return;}var _2651=false;var _2652=this.idMap.getItemValue(_264c);if(!_2652){this.LOGGER.severe("displayWidgetInDialog","Can not find the widget in theme to display");return;}if(!this.widgetDialogMap[_2652]){var _2653=document.createElement("div");_2653.appendChild(dojo.byId(_2652));var _2654=null;if(_264f!==null){if(!_264f.id){_264f.id=_2652+"_uniDialog";}_2654=new com.ibm.mm.builder.widget.CustomDialog(_264f,_2653);}else{_2654=new com.ibm.mm.builder.widget.CustomDialog({id:_2652+"_uniDialog"},_2653);}dojo.removeClass(dojo.byId(_2652),"mumHiddenWidget");if(dojo.isIE&&dojo.isIE==6){dojo.byId(_2652).style.display="";}this.widgetDialogMap[_2652]=_2654;_2651=true;}else{if(_2650===true){if(_264f.title){this.widgetDialogMap[_2652].setTitle(_264f.title);}}}var _2655=com.ibm.mashups.iwidget.model.Factory.getGlobalWidgetModel().find(_2652);var cb=function(_2656,_2657,_2658,id,_2659,_265a){var _265b=_2657.widgetDialogMap[id];_2656.iScope.iContext.dialogContainer=_265b;if(_2659){com.ibm.mashups.services.ServiceManager.getService("eventService").fireEvent(id,_2659,_265a);}com.ibm.mm.builder.utils.htmlUtil.truncateAllChildNodesText(dojo.byId(_2658));if(_2651&&_2656.iScope.onDialogResize){dojo.connect(_265b,"onResize",_2656.iScope,"onDialogResize");}try{_2657.widgetDialogMap[id].show();}catch(e){}};if(_2655.isLoaded()===false){var me=this;com.ibm.mashups.services.ServiceManager.getService("eventService").subscribeEvent(com.ibm.mashups.iwidget.Constants.WIDGET_LOADED+"."+_2652,null,dojo.partial(cb,_2655,me,_264c,_2652,_264d,_264e));}else{cb(_2655,this,_264c,_2652,_264d,_264e);}},handleDisplayInDialog:function(_265c){var _265d=_265c.payload;var _265e=_265d.widgetTypeId;var _265f=_265d.eventName;var _2660=_265d.eventPayload;var _2661=_265d.dialogParam;var _2662=_265d.requestRefresh;this.displayWidgetInDialog(_265e,_265f,_2660,_2661,_2662);}});if(!dojo._hasResource["ibm.portal.search.widgets.common"]){dojo._hasResource["ibm.portal.search.widgets.common"]=true;dojo.provide("ibm.portal.search.widgets.common");dojo.declare("ibm.portal.search.scope.XmlWriter",null,{SPACE:" ",EQUALS:"=",QUOTES:"\"",SLASH:"/",START_TAG:"<",END_TAG:">",SCOPE_ELEMENT:"scope",TITLE_ELEMENT:"title",DESCRIPTION_ELEMENT:"description",QUERY_TEXT_ELEMENT:"querytext",SCOPE_PROPERTY_ELEMENT:"scopeproperty",KEY_ATTRIBUTE:"key",VALUE_ATTRIBUTE:"value",ID_ATTRIBUTE:"id",SELECTED_SCOPE:"SELECTED_SCOPE",SCOPEELEMENT_ELEMENT:"scopeelement",LOCATION_ELEMENT:"location",FEATURE_ELEMENT:"feature",FEATURE_VALUE_ELEMENT:"feature_value",FEATURE_ID:"feature_id",SOURCE_ATTRIBUTE:"source",PATH_ATTRIBUTE:"path",writeAttribute:function(key,value,_2663){_2663.push(this.SPACE);_2663.push(key);_2663.push(this.EQUALS);_2663.push(this.QUOTES);_2663.push(value);_2663.push(this.QUOTES);},startElement:function(_2664,_2665,_2666,close,_2667){_2667.push(this.START_TAG);_2667.push(_2664);if(_2665!==null){if(_2665.constructor==Array){for(i=0;i<_2665.length;i++){this.writeAttribute(_2665[i],_2666[i],_2667);}}else{this.writeAttribute(_2665,_2666,_2667);}}if(close){_2667.push(this.SLASH);}_2667.push(this.END_TAG);},writeNoAttributeElement:function(_2668,_2669,_266a){this.startElement(_2668,null,null,false,_266a);_266a.push(_2669);this.endElement(_2668,_266a);},endElement:function(_266b,_266c){_266c.push(this.START_TAG);_266c.push(this.SLASH);_266c.push(_266b);_266c.push(this.END_TAG);},writeScope:function(scope){var _266d=[];this.startElement(this.SCOPE_ELEMENT,this.ID_ATTRIBUTE,scope.id,false,_266d);this.writeNoAttributeElement(this.TITLE_ELEMENT,scope.label,_266d);this.writeNoAttributeElement(this.DESCRIPTION_ELEMENT,scope.description,_266d);if(scope.query!=null){this.writeNoAttributeElement(this.QUERY_TEXT_ELEMENT,scope.query,_266d);}for(elementIndex=0;elementIndex<scope.scopeElements.length;elementIndex++){this.writeScopeElement(scope.scopeElements[elementIndex],_266d);}for(property in scope.properties){this.startElement(this.SCOPE_PROPERTY_ELEMENT,[this.KEY_ATTRIBUTE,this.VALUE_ATTRIBUTE],[property,scope.properties[property]],true,_266d);}this.endElement(this.SCOPE_ELEMENT,_266d);return _266d.join("");},writeScopeElement:function(_266e,_266f){this.startElement(this.SCOPEELEMENT_ELEMENT,null,null,false,_266f);for(index=0;index<_266e.locations.length;index++){var _2670=_266e.locations[index];var _2671=_2670[0];var path=_2670[1];if(path===null){this.startElement(this.LOCATION_ELEMENT,this.SOURCE_ATTRIBUTE,_2671,true,_266f);}else{this.startElement(this.LOCATION_ELEMENT,[this.SOURCE_ATTRIBUTE,this.PATH_ATTRIBUTE],_2670,true,_266f);}}for(id in _266e.features){this.startElement(this.FEATURE_ELEMENT,this.FEATURE_ID,id,false,_266f);var value=_266e.features[id];if(dojo.isArray(value)){for(i=0;i<value.length;i++){this.writeNoAttributeElement(this.FEATURE_VALUE_ELEMENT,value[i],_266f);}}else{this.writeNoAttributeElement(this.FEATURE_VALUE_ELEMENT,value,_266f);}this.endElement(this.FEATURE_ELEMENT,_266f);}this.endElement(this.SCOPEELEMENT_ELEMENT,_266f);}});dojo.declare("ibm.portal.search.scope.Scope",null,{id:null,label:null,description:null,icon:null,constructor:function(name,_2672,icon,id){this.label=name;this.description=_2672;this.icon=icon;this.id=(id!=null)?id:name;},addElement:function(_2673){if(this.scopeElements==null){this.scopeElements=[];}this.scopeElements.push(_2673);},addProperty:function(key,value){if(this.properties==null){this.properties={};}this.properties[key]=value;},addQuery:function(query){this.query=query;},isContextual:function(){return (this.scopeElements!=null);},getValue:function(){if(this.isContextual()){var _2674=new ibm.portal.search.scope.XmlWriter();return _2674.writeScope(this);}else{return this.id;}}});dojo.declare("ibm.portal.search.scope.ScopeElement",null,{constructor:function(){this.locations=[];this.features={};},addLocation:function(_2675,path){this.locations.push([_2675,path]);},addFeature:function(id,value){if(dojo.isArray(value)){this.features[id]=[];for(i=0;i<value.length;i++){this.features[id].push(value[i]);}}else{this.features[id]=value;}}});ibm.portal.search.scope.SCOPE_SELECTED_TOPIC="ibm.portal.search.SCOPE_SELECTED_TOPIC";ibm.portal.search.scope.ADD_SCOPE_TOPIC="ibm.portal.search.ADD_SCOPE_TOPIC";ibm.portal.search.scope.SUBMIT_SCOPE_TOPIC="ibm.portal.search.SUBMIT_SCOPE_TOPIC";ibm.portal.search.NEW_QUERY_TOPIC="ibm.portal.search.NEW_QUERY_TOPIC";ibm.portal.search.scope.SELECTED_SCOPE="ibm.portal.search.scope.SELECTED_SCOPE";ibm.portal.search.scope.addContextualScope=function(scope,_2676){dojo.publish(ibm.portal.search.scope.ADD_SCOPE_TOPIC,[scope,_2676]);};ibm.portal.search.scope.submit=function(scope,query){dojo.publish(ibm.portal.search.scope.SUBMIT_SCOPE_TOPIC,[scope,query]);};dojo.declare("ibm.portal.search.Query",null,{text:null,language:null,scope:null,advancedQueries:null,getFullQueryText:function(){var _2677=this.text;if(this.advancedQueries.length>0){return _2677+" "+this.advancedQueries.join(" ");}return _2677;},addAdvancedQuery:function(_2678){this.advancedQueries.push(_2678);},constructor:function(_2679){this.advancedQueries=[];dojo.mixin(this,_2679);}});if(ibm.portal.search.util==undefined){ibm.portal.search.util={};}ibm.portal.search.util.getServiceUrl=function(root,_267a,_267b){var _267c=[root];_267c.push(_267a);_267c.push("?");_267c.push(dojo.objectToQuery(_267b));return _267c.join("");};ibm.portal.search.util.getContextRoot=function(){var end=window.location.pathname.indexOf("/",1);return window.location.pathname.substring(0,end);};ibm.portal.search.util.openSideWindow=function(_267d){var _267e="width=800,height=600,toolbar=yes,location=no,directories=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,";var _267f=dojo.isIE?"left=15,top=15":"screenX=15,screenY=15";window.open(_267d,"",_267e+_267f);};ibm.portal.search.util.getLocale=function(){return document.documentElement.lang;};ibm.portal.search.util.xmlNamespaces={"atom":"http://www.w3.org/2005/Atom","opensearch":"http://a9.com/-/spec/opensearch/1.1/","xsl":"http://www.w3.org/1999/XSL/Transform","xhtml":"http://www.w3.org/1999/xhtml"};ibm.portal.search.util.getXpathValue=function(_2680,_2681){var nodes=com.ibm.portal.xpath.evaluateXPath(_2681,_2680,ibm.portal.search.util.xmlNamespaces);if(nodes==null||nodes.length==0){return null;}var node=nodes[0];if(node.firstChild==null){return node.data;}return node.firstChild.data;};ibm.portal.search.util.retrieveServer=function(_2682){var _2683=ibm.portal.search.util.getXpathValue(_2682,"/atom:feed/atom:id");var idx1=_2683.indexOf("//");var idx2=_2683.indexOf("/",idx1+3);_2683=_2683.substring(0,idx2);_2683=_2683.replace(/\[|\]/,"");return _2683;};}if(!dojo._hasResource["ibm.portal.search.Enhanced.widgets.searchBox"]){dojo._hasResource["ibm.portal.search.Enhanced.widgets.searchBox"]=true;dojo.provide("ibm.portal.search.Enhanced.widgets.searchBox");ibm.portal.search.util.getNodes=function(_2684,_2685){return com.ibm.portal.xpath.evaluateXPath(_2685,_2684,ibm.portal.search.util.xmlNamespaces);};dojo.declare("ibm.portal.search.Enhanced.widgets.ScopeSearchWidget",[dijit._Widget,dijit._Templated,dijit._Container],{templateString:"<form dojoAttachPoint=\"queryForm\" action=\"${submitUrl}\" dojoAttachEvent=\"onsubmit:submitQueryForm\" \n\tmethod=\"post\" name=\"searchQueryForm\" class=\"lotusSearch\"\n\t><table class=\"lotusLayout\" cellspacing=\"0\" summary=\"layout table\"\n\t\t><tr><td style=\"display: none\" dojoAttachPoint=\"scopeSelectionNode\"><a href=\"javascript:;\" class=\"lotusScope\" title=\"${resourceBundle.scopeButtonTooltip}\" dojoAttachPoint=\"scopeNode\" dojoAttachEvent=\"onclick:openMenu\"\n\t\t\t\t><img class=\"lotusIcon lotusHidden\" dojoAttachPoint=\"scopeIconNode\" alt=\"\" /\n\t\t\t\t><span dojoAttachPoint=\"scopeNameNode\"></span\n\t\t\t\t><span class=\"lotusAltText\">&#x25bc;</span\n\t\t\t></a></td><td\n\t\t><input type=\"hidden\" dojoAttachPoint=\"scope\" name=\"scope\"/\n\t\t><input type=\"hidden\" name=\"sourceContentNode\" value=\"${sourceContentNode}\"/\n\t\t><label class=\"lotusHidden\" for=\"${id}searchInput\">${resourceBundle.searchInstruction}</label\n\t\t><input type=\"text\"\n\t\t\tdojoAttachPoint=\"query\"\n\t\t\tdojoAttachEvent=\"onfocus:onTextFocus, onblur:onTextBlur\"\n\t\t\tname=\"query\"\n\t\t\tid=\"${id}searchInput\"\n\t\t\tclass=\"${disabledTextClass} lotusText\" \n\t\t\tvalue=\"${resourceBundle.searchInstruction}\"/\n\t\t></td><td><span class=\"lotusBtnImg\"\n\t\t><input class=\"lotusSearchButton\" type=\"image\" alt=\"${resourceBundle.searchInstruction}\" title=\"${resourceBundle.searchAltText}\" src=\"${blankIcon}\"/\n\t\t><span class=\"lotusAltText\">${resourceBundle.searchAltText}</span></span></td></tr></table\n></form>\n",widgetsInTemplate:true,submitUrl:"",sourceContentNode:"",disabledTextClass:"lotusInactive",contextualScopes:null,searchLinks:null,menuTTL:1000*60*15,resourceBundle:null,scopes:null,emptyScope:{id:"",label:"",description:"",icon:""},searchFeedUrl:null,timeStamp:null,displayScopes:true,subscriptions:null,postMixInProperties:function(){this.blankIcon=dojo.moduleUrl("dojo.resources","blank.gif").toString();this.subscriptions=[];},startup:function(){this.subscriptions.push(dojo.subscribe(ibm.portal.search.scope.SCOPE_SELECTED_TOPIC,this,"scopeSelected"));this.subscriptions.push(dojo.subscribe(ibm.portal.search.NEW_QUERY_TOPIC,this,"newQuery"));this.subscriptions.push(dojo.subscribe(ibm.portal.search.scope.ADD_SCOPE_TOPIC,this,"addContextualScope"));this.subscriptions.push(dojo.subscribe(ibm.portal.search.scope.SUBMIT_SCOPE_TOPIC,this,"submitScope"));if(dojo.isIE<8){dojo.style(this.scopeNode,"width","11em");dojo.style(this.scopeNode,"overflow","hidden");dojo.style(this.scopeNode,"text-overflow","ellipsis");}},destroy:function(){this.inherited(arguments);for(var i=0;i<this.subscriptions.length;i++){dojo.unsubscribe(this.subscriptions[i]);}},postCreate:function(){this.scopeService=ibm.portal.search.util.getServiceUrl(this.searchFeedUrl,"scopes",{locale:djConfig.locale,customLinks:true,timeStamp:this.timeStamp});if(this.displayScopes){this.retrieveScopes();}},scopeSelected:function(_2686){if(djConfig.isDebug){console.debug("scopeSelected");}this.selectedScope=_2686;if(_2686.icon!=undefined){this.scopeIconNode.src=_2686.icon;}dojo.toggleClass(this.scopeIconNode,"lotusHidden",(_2686.icon==null));this.scopeNameNode.innerHTML=_2686.label;this.scope.value=_2686.id;this.closeMenu();},addContextualScope:function(scope,_2687){if(djConfig.isDebug){console.debug("addContextualScope");}if(this.contextualScopes==null){this.contextualScopes=[];}if(_2687){this.scopeSelected(scope);}this.contextualScopes.push(scope);},newQuery:function(_2688){if(djConfig.isDebug){console.debug("ScopeSearchWidget: newQuery");}this.query.value=_2688.text;if(dojo.hasClass(this.query,this.disabledTextClass)){dojo.removeClass(this.query,this.disabledTextClass);}this.onBlur();},retrieveScopes:function(){dojo.xhrGet({url:this.scopeService,load:dojo.hitch(this,"handleScopes"),error:dojo.hitch(this,"handleScopeError"),handleAs:"text"});},handleScopes:function(_2689,_268a){var _268b=com.ibm.portal.xslt.loadXmlString(_2689);var feed=ibm.portal.search.util.getNodes(_268b,"/atom:feed")[0];var _268c=ibm.portal.search.util.getNodes(feed,"atom:entry");this.scopes=[];for(var i=0;i<_268c.length;i++){var id=ibm.portal.search.util.getXpathValue(_268c[i],"atom:id");var label=ibm.portal.search.util.getXpathValue(_268c[i],"atom:title");var link=ibm.portal.search.util.getXpathValue(_268c[i],"atom:link/@href");var _268d=ibm.portal.search.util.getXpathValue(_268c[i],"atom:summary");var icon=ibm.portal.search.util.getXpathValue(_268c[i],"opensearch:image");var scope=new ibm.portal.search.scope.Scope(label,_268d,icon,id);if(link!=null){scope.link=link;}this.scopes.push(scope);}dojo.publish("ibm.portal.search.scope.SCOPES",[this.scopes]);if(this.scopes.length==0){this.scopes.push(this.emptyScope);}this.showHideScopeSelector();var _268e=this.scopes[0];if(this.selectedScope==undefined){this.scopeSelected(new ibm.portal.search.scope.Scope(_268e.label,_268e.description,_268e.icon,_268e.id));}},handleScopeError:function(_268f,_2690){this.scopes=[this.emptyScope];},showHideScopeSelector:function(){if(this.scopes.length>1&&this.displayScopes){dojo.style(this.scopeSelectionNode,"display","");}},addContextualScopesMenuItems:function(){if(this.contextualScopes==null){return;}for(var i=0;i<this.contextualScopes.length;i++){this.addScopeMenuItem(this.contextualScopes[i]);}this.scopeMenu.addChild(new dijit.MenuSeparator({}));},addScopeMenuItem:function(_2691){var _2692={obj:_2691,label:_2691.label,parentMenu:this.scopeMenu,scopeSearchWidget:this};if(_2691.icon!=null){_2692._blankGif=_2691.icon;}var _2693=new dijit.MenuItem(_2692);this.scopeMenu.addChild(_2693);if(_2691.description!=null){_2693.iconNode.title=_2691.description;}},addScopeMenuItems:function(){if(djConfig.isDebug){console.debug("addScopeMenuItems");}var _2694=this.scopes;var _2695=true;for(var i=0;i<_2694.length;i++){var _2696=_2694[i];if(_2696.link!=null&&_2695){this.scopeMenu.addChild(new dijit.MenuSeparator({}));_2695=false;}this.addScopeMenuItem(_2696);}},getQueryText:function(){return this.query.value;},submitQueryForm:function(event){if(djConfig.isDebug){console.debug("submitQueryForm");}var _2697=this.getQueryText();if(dojo.hasClass(this.query,this.disabledTextClass)){this.query.value="";}if(this.selectedScope!==undefined){this.scope.value=encodeURIComponent(dojo.toJson(this.selectedScope));}else{this.scope.value="";}return true;},submitScope:function(scope,query){if(djConfig.isDebug){console.debug("submitScope");}if(scope!=ibm.portal.search.scope.SELECTED_SCOPE){this.queryForm.method.value="POST";this.scope.value=encodeURIComponent(dojo.toJson(scope));}else{this.scope.value=encodeURIComponent(dojo.toJson(this.selectedScope));}this.query.value=(query!=null)?query:"";if(scope.query!=null){this.query.value=this.query.value+" "+scope.query;}this.queryForm.submit();},onTextFocus:function(){if(dojo.hasClass(this.query,this.disabledTextClass)){this.query.value="";dojo.removeClass(this.query,this.disabledTextClass);}},onTextBlur:function(){if(this.query.value==""){dojo.addClass(this.query,this.disabledTextClass);this.query.value=this.resourceBundle.searchInstruction;}},selectOption:function(_2698){if(_2698.obj.link!=null){var _2699=_2698.scopeSearchWidget.getQueryText();_2699=_2699.replace(/"/g,"\\\"");var _269a=window.open();_269a.setTimeout("focus(); document.location = \""+_2698.obj.link+_2699+"\";",100);this.scopeSearchWidget.closeMenu();}else{dojo.publish(ibm.portal.search.scope.SCOPE_SELECTED_TOPIC,[_2698.obj]);this.query.focus();}},getScopeMenu:function(){if(this.scopeMenu!=null){return this.scopeMenu;}this.scopeMenu=new dijit.Menu({onItemClick:dojo.hitch(this,"selectOption")});this.connect(this.scopeMenu,"_onBlur","closeMenu");this.addContextualScopesMenuItems();this.addScopeMenuItems();return this.scopeMenu;},openMenu:function(evt){var menu=this.getScopeMenu();dijit.popup.open({popup:menu,around:this.scopeNode,orient:(dojo._isBodyLtr()?{"BL":"TL","BR":"TR"}:{"BR":"TR","BL":"TL"}),onExecute:function(){},onCancel:dojo.hitch(this,function(){dijit.popup.close(menu);dijit.focus(this.scopeNode);}),onClose:function(){}});menu.focus();dojo.stopEvent(evt);},closeMenu:function(){if(this.scopeMenu){dijit.popup.close(this.scopeMenu);var _269b=this.scopeMenu.getChildren();for(var i=0;i<_269b.length;i++){dojo.removeClass(_269b[i].domNode,"dijitMenuItemHover");}}}});}if(!dojo._hasResource["com.ibm.cp.EnablerDeferred"]){dojo._hasResource["com.ibm.cp.EnablerDeferred"]=true;dojo.provide("com.ibm.cp.EnablerDeferred");dojo.declare("com.ibm.cp.EnablerDeferred",[com.ibm.mashups.enabler.Deferred],{constructor:function(_269c,_269d,_269e){this.context=_269c;this.startfn=_269d;this.params=_269e;},setFinishedCallback:function(_269f,_26a0){this.finishedCallback2=_269f;this.finishedCallbackParameters2=_26a0;return this;},start:function(sync){var mode=(sync||typeof (sync)=="undefined")?true:false;return dojo.hitch(this.context,this.startfn)(this,mode,this.params);},finish:function(res,_26a1){var _26a2=this.getFinishedCallback(),_26a3=this.getFinishedCallbackParameters();if(_26a2&&!this._finished){this._finished=true;_26a2(res,_26a1,_26a3);}},getFinishedCallback:function(){return this.finishedCallback2;},getFinishedCallbackParameters:function(){return this.finishedCallbackParameters2;}});}if(!dojo._hasResource["com.ibm.xml.xpath"]){dojo._hasResource["com.ibm.xml.xpath"]=true;dojo.provide("com.ibm.xml.xpath");com.ibm.xml.xpath=ibm.portal.xml.xpath;if(dojo.isIE||window.ActiveXObject!==undefined){com.ibm.xml.xpath.evaluate=function(expr,_26a4,_26a5,_26a6){var _26a7=null;if(_26a5){var ns="";for(var prop in _26a5){ns+="xmlns:"+prop+"='"+_26a5[prop]+"' ";}if(_26a4.ownerDocument){_26a4.ownerDocument.setProperty("SelectionNamespaces",ns);}else{_26a4.setProperty("SelectionNamespaces",ns);}}if(!_26a6){_26a7=_26a4.selectNodes(expr);var _26a8=[];for(var i=0;i<_26a7.length;i++){if(_26a7[i]){_26a8.push(_26a7[i]);}}return _26a8;}else{return _26a4.selectSingleNode(expr);}};}else{com.ibm.xml.xpath.evaluate=function(expr,_26a9,_26aa,_26ab){var _26ac=null;var _26ad=_26a9;if(!_26ad.evaluate){_26ad=_26a9.ownerDocument;}try{_26ac=_26ad.evaluate(expr,_26a9,function(_26ae){return _26aa[_26ae]||null;},_26ab?XPathResult.FIRST_ORDERED_NODE_TYPE:XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);}catch(err){throw new Error("Error with xpath expr: "+expr+" - "+err);}if(!_26ab){var _26af;var _26b0=new Array();var len=0;do{_26af=_26ac.iterateNext();if(_26af){_26b0[len]=_26af;len++;}}while(_26af);return _26b0;}else{return _26ac.singleNodeValue;}};}}if(!dojo._hasResource["com.ibm.xml.XmlNodeList"]){dojo._hasResource["com.ibm.xml.XmlNodeList"]=true;dojo.provide("com.ibm.xml.XmlNodeList");(function(){var xpath=function(expr,ctx,_26b1){return com.ibm.xml.xpath.evaluate.call(this,expr,ctx,this.ns,_26b1);};var wrap=function(arr,ns){arr.constructor=com.ibm.xml.XmlNodeList;dojo._mixin(arr,com.ibm.xml.XmlNodeList.prototype);arr.ns=ns;return arr;};com.ibm.xml.XmlNodeList=function(){var ret=wrap(Array.apply(null,arguments),null);return ret;};var xnl=com.ibm.xml.XmlNodeList,xnlp=xnl.prototype,d=dojo,dom=com.ibm.domUtilities;xnl.fromArray=function(arr,ns){return wrap(arr,ns);};var _26b2=function(arr,ctr){if(arr&&(arr instanceof Array||typeof arr=="array")){var _26b3=ctr?new ctr():[];d.forEach(arr,function(item){_26b3=_26b3.concat(_26b2(item,ctr));});return _26b3;}else{return arr;}};var _26b4=function(def,_26b5){return dom.createFromJson(_26b5.ownerDocument,def,this.ns,_26b5);};d.extend(xnl,{map:function(func,scope){var ret=d.map(this,func,scope,xnl);ret.ns=this.ns;return ret;},indexOf:function(pred,_26b6,_26b7){var last=this.length||0,jump=1,i=0;if(_26b7){jump=last=-1;i=this.length-1;}if(_26b6!=undefined){i=_26b6;}if(!d.isFunction(pred)){while((_26b7&&i>last)||i<last){if(pred==this[i]){return i;}i+=jump;}}else{while((_26b7&&i>last)||i<last){if(pred(this[i])){return i;}i+=jump;}}return -1;},lastIndexOf:function(pred,_26b8){return this.indexOf(pred,_26b8,true);},forEach:function(func,scope){d.forEach(this,func,scope);return this;},removeProp:function(prop){switch(prop){case "childNodes":this.prop(prop).forEach(function(_26b9){_26b9.remove();});return this;case "firstChild":case "lastChild":case "parentNode":case "nextSibling":case "previousSibling":this.prop(prop).remove();return this;case "text":case "textContent":case "xml":case "innerXML":return this.prop(prop,"");case "localName":case "baseName":return this;default:this.forEach(function(node){delete node[prop];},this);return this;}},removeAttr:function(attr){this.forEach(function(node){com.ibm.domUtilities.removeAttribute(node,attr,this.ns);},this);return this;},prop:function(prop,value){var asXnl=false,f=null,ns=this.ns;if(arguments.length<2){switch(prop){case "childNodes":f=function(node){var ret=xnl.apply(null,dojo._toArray(node[prop]));ret.ns=ns;return ret;};asXnl=true;break;case "firstChild":case "lastChild":case "parentNode":case "nextSibling":case "previousSibling":f=function(node){return node[prop];};asXnl=true;break;case "text":case "textContent":f=function(node){return dom.textContent(node);};break;case "xml":case "innerXML":f=function(node){return dom.innerXML(node);};break;case "localName":case "baseName":prop=[d.isIE?"baseName":"localName"];default:f=function(node){return node[prop];};}var _26ba=d.map(this,f,this);if(asXnl){_26ba=xnl.apply(_26ba,_26ba);_26ba.ns=ns;}return _26ba;}else{var _26bb=value;switch(prop){case "text":case "textContent":f=function(node){dojox.data.dom.textContent(node,_26bb);};break;default:f=function(node){node[prop]=_26bb;};}if(dojo.isArrayLike(value)){var sf=f,idx=0;f=function(node){_26bb=value[idx++];if(_26bb!==undefined){sf(node);}};}d.map(this,f,this);return this;}},attr:function(attr,value){var ns=this.ns;if(arguments.length<2){return d.map(this,function(node){if(!dom.hasAttribute(node,attr,ns)){return;}return dom.getAttribute(node,attr,ns);},this);}else{if(value==null){return this.removeAttr(attr);}var _26bc=value;var f=function(node){dom.setAttribute(node,attr,_26bc,ns);};if(dojo.isArrayLike(value)){var sf=f,idx=0;f=function(node){_26bc=value[idx++];if(_26bc!==undefined){sf(node);}};}d.map(this,f,this);return this;}},hasAttr:function(attr){return d.map(this,function(node){return dom.hasAttribute(node,attr,this.ns);},this);},every:function(func,scope){return d.every(this,func,scope);},some:function(func,scope){return d.some(this,func,scope);},filter:function(_26bd){var _26be=this,a=arguments,fIdx=0;if(d.isString(_26bd)){_26be=_26be.select(".["+_26bd+"]");fIdx=1;}if(a.length>1){_26be=xnl.apply(_26be,d.filter(_26be,a[fIdx],a[fIdx+1]));_26be.ns=this.ns;}return _26be;},select:function(_26bf,_26c0){if(!_26bf){return this;}var _26c1=[];this.forEach(function(node){_26c1=_26c1.concat(xpath.call(this,_26bf,node,_26c0)||[]);},this);_26c1=wrap(_26c1,this.ns);return _26c1;},remove:function(){return this.forEach(function(node){if(node.parentNode){node.parentNode.removeChild(node);}},this);},replace:function(_26c2){for(var i=0;i<_26c2.length&&i<this.length;i++){this[i].parentNode.replaceChild(_26c2[i],this[i]);}return this;},destroy:function(){this.remove();this.splice(0,this.length);return this;},createFromJson:function(def){return this.forEach(dojo.partial(_26b4,def),this);},toString:function(){return "XmlNodeList{ "+Array.prototype.toString.call(this)+" }";}});d.forEach(["slice","splice","concat"],function(name){xnlp[name]=function(){return wrap(Array.prototype[name].apply(this,arguments),this.ns);};},this);d.forEach(["attributes","baseURI","childNodes","firstChild","lastChild","localName","baseName","namespaceURI","nextSibling","nodeName","nodeType","ownerDocument","parentNode","prefix","previousSibling","tagName","innerXML","text","textContent"],function(name){xnlp[name]=function(){return this.prop(name);};},this);xnlp.$=xnlp.select;xnlp._$=xnlp.prop;xnlp.text=xnlp.textContent;})();}if(!dojo._hasResource["com.ibm.xml.SimpleXmlAccessor"]){dojo._hasResource["com.ibm.xml.SimpleXmlAccessor"]=true;dojo.provide("com.ibm.xml.SimpleXmlAccessor");(function(){var dom=com.ibm.domUtilities,xpath=com.ibm.xml.xpath,xnl=com.ibm.xml.XmlNodeList;dojo.declare("com.ibm.xml.SimpleXmlAccessor",null,{namespaces:{},constructor:function(args){dojo.mixin(this,args);},evaluate:function(expr,_26c3,_26c4){var ret=xpath.evaluate(expr,_26c3,this.namespaces,_26c4);if(_26c4){if(ret){ret=[ret];}else{ret=[];}}return ret;},select:function(_26c5,data,_26c6){ret=xnl.apply(null,this.evaluate.apply(this,arguments));ret.ns=this.namespaces;return ret;},prop:function(node,prop,value){if(arguments.length<3){switch(prop){case "textContent":return dom.textContent(node);case "localName":case "baseName":return node[dojo.isIE||window.ActiveXObject!==undefined?"baseName":"localName"];default:return node[prop];}}else{switch(prop){case "textContent":dom.textContent(node,value);return true;default:node[prop]=value;return true;}}},attr:function(node,attr,value){if(arguments.length<3){if(!dom.hasAttribute(node,attr,this.namespaces)){return;}return dom.getAttribute(node,attr,this.namespaces);}else{return dom.setAttribute(node,attr,value,this.namespaces);}},replace:function(node,value){return node.parentNode.replaceChild(value,node);},getSelf:function(node){return node;},createElement:function(doc,_26c7,_26c8){return dom.createElement(doc,_26c7,this.namespaces,_26c8);},createFromJson:function(node,def){return dom.createFromJson(node.nodeType!=dom.constants.NodeTypes.document?node.ownerDocument:node,def,this.namespaces,node);}});})();}if(!dojo._hasResource["com.ibm.data.resolver.FaultFactory"]){dojo._hasResource["com.ibm.data.resolver.FaultFactory"]=true;dojo.provide("com.ibm.data.resolver.FaultFactory");dojo.declare("com.ibm.data.resolver.FaultFactory",null,{namespaces:{env:"http://www.w3.org/2003/05/soap-envelope"},selectors:{subcode:"/env:Fault/env:Code/env:Subcode/env:Value",reason:"/env:Fault/env:Reason/env:Text["+(dojo.isIE||window.ActiveXObject!==undefined?"@xml:lang = '${0}'":"lang('${0}')")+"]",role:"/env:Fault/env:Role",detail:"/env:Fault/env:Detail"},constructor:function(){this.engine=new com.ibm.xml.SimpleXmlAccessor({namespaces:this.namespaces});},getFaultError:function(_26c9,error){var data=com.ibm.domUtilities.docFromString(_26c9);error.name="Fault - "+this._getRole(data);error.number=this._getSubCode(data);error.message=this._getReason(data);error.description=this._getDetail(data);return error;},_getSubCode:function(data){return this.engine.select(this.selectors.subcode,data,true).text()[0];},_getReason:function(data,_26ca){if(!_26ca){_26ca=dojo.locale;}var query=this.selectors.reason;query=dojo.string.substitute(query,[_26ca]);return this.engine.select(query,data,true).text()[0];},_getRole:function(data){return this.engine.select(this.selectors.role,data,true).text()[0];},_getDetail:function(data){return this.engine.select(this.selectors.detail,data,true).text()[0];},toString:function(){return this.declaredClass;}});if(!(dojo.isIE||window.ActiveXObject!==undefined)){com.ibm.data.resolver.FaultFactory.prototype.namespaces["xml"]="http://www.w3.org/XML/1998/namespace";}}if(!dojo._hasResource["dojo.DeferredList"]){dojo._hasResource["dojo.DeferredList"]=true;dojo.provide("dojo.DeferredList");dojo.declare("dojo.DeferredList",dojo.Deferred,{constructor:function(list,_26cb,_26cc,_26cd,_26ce){this.list=list;this.resultList=new Array(this.list.length);this.chain=[];this.id=this._nextId();this.fired=-1;this.paused=0;this.results=[null,null];this.canceller=_26ce;this.silentlyCancelled=false;if(this.list.length===0&&!_26cb){this.callback(this.resultList);}this.finishedCount=0;this.fireOnOneCallback=_26cb;this.fireOnOneErrback=_26cc;this.consumeErrors=_26cd;dojo.forEach(this.list,function(d,index){d.addCallback(this,function(r){this._cbDeferred(index,true,r);return r;});d.addErrback(this,function(r){this._cbDeferred(index,false,r);return r;});},this);},_cbDeferred:function(index,_26cf,_26d0){this.resultList[index]=[_26cf,_26d0];this.finishedCount+=1;if(this.fired!==0){if(_26cf&&this.fireOnOneCallback){this.callback([index,_26d0]);}else{if(!_26cf&&this.fireOnOneErrback){this.errback(_26d0);}else{if(this.finishedCount==this.list.length){this.callback(this.resultList);}}}}if(!_26cf&&this.consumeErrors){_26d0=null;}return _26d0;},gatherResults:function(_26d1){var d=new dojo.DeferredList(_26d1,false,true,false);d.addCallback(function(_26d2){var ret=[];dojo.forEach(_26d2,function(_26d3){ret.push(_26d3[1]);});return ret;});return d;}});}if(!dojo._hasResource["com.ibm.planner.SimplePOPlan"]){dojo._hasResource["com.ibm.planner.SimplePOPlan"]=true;dojo.provide("com.ibm.planner.SimplePOPlan");dojo.declare("com.ibm.planner.SimplePOPlan",null,{constructor:function(steps){this.steps={};this.orderedSteps=[];this._nctr=Math.floor(Math.random()*100001);if(steps){for(var i=0;i<steps.length;i++){this.insertStep(steps[i]);}}},destroy:function(){for(var s in this.steps){this.steps[s].destroy();}delete this.steps;delete this.orderedSteps;},_genName:function(){return "s_"+this._nctr++;},indexOf:function(step){return dojo.indexOf(this.orderedSteps,step);},getStep:function(name){return this.steps[name];},hasStep:function(name){return !!this.steps[name];},makeStep:function(name,_26d4){var step=new com.ibm.planner.SimplePOStep(name,_26d4);this.insertStep(step);return step;},_insStep:function(step,map){if(!map[step.name]){var _26d5=0;for(var i=0,pre;pre=step.preSteps[i],i<step.preSteps.length;i++){var pidx;if(map[pre.name]){pidx=this.indexOf(pre);if(pidx>=_26d5){_26d5=pidx+1;}}else{pidx=this._insStep(pre,map);if(pidx<=_26d5){_26d5++;}else{_26d5=pidx+1;}}}this.orderedSteps.splice(_26d5,0,step);map[step.name]=step;return _26d5;}},orderSteps:function(){this.orderedSteps=[],map={};for(var name in this.steps){this._insStep(this.steps[name],map);}return this;},insertStep:function(step){if(!step.name){step.name=this._genName();}if(!this.steps[step.name]){this.steps[step.name]=step;}return this;},_reset:function(){delete this.groupList;},replan:function(){this._reset();this.orderSteps();return this;},_insertIntoGroupList:function(gList,step){for(var j=gList.length-1;j>=0;j--){if(!gList[j].hasPreStepOf(step)){if(j>0){continue;}else{gList[j].addStep(step);}}else{if(j<gList.length-1){gList[j+1].addStep(step);return;}else{gList.push(new com.ibm.planner.SimplePOStepGroup([step]));return;}}}},size:function(){return this.orderedSteps.length;},getList:function(){return this.orderedSteps;},filter:function(_26d6){this.orderedSteps=dojo.filter(this.orderedSteps,_26d6);return this;},getGroupList:function(){if(!this.groupList){var _26d7=[],list=this.getList();if(list.length>0){_26d7.push(new com.ibm.planner.SimplePOStepGroup([list[0]]));}for(var i=1,st;st=list[i],i<list.length;i++){this._insertIntoGroupList(_26d7,st);}this.groupList=_26d7;}return this.groupList;}});dojo.declare("com.ibm.planner.SimplePOStep",null,{constructor:function(name,_26d8){this.name=name;this.contents=_26d8;this.preSteps=[];},destroy:function(){delete this.preSteps;delete this.contents;delete this.name;},isPreStepOf:function(step){return step.hasPreStep(this);},hasPreStep:function(step){return dojo.indexOf(this.preSteps,step)>-1;},addPreStep:function(step){this.preSteps.push(step);},toString:function(){return "<Step '"+this.name+"'>";}});dojo.declare("com.ibm.planner.SimplePOStepGroup",null,{constructor:function(steps){this.steps=steps?steps.slice():[];},destroy:function(){delete this.steps;},getSteps:function(){return this.steps;},addStep:function(step){this.steps.push(step);},hasPreStepOf:function(step){for(var i=0,st;st=this.steps[i],i<this.steps.length;i++){if(st.isPreStepOf(step)){return true;}}return false;},toString:function(){return "<StepGroup ("+this.steps+")>";}});}if(!dojo._hasResource["com.ibm.data.DependencyManager"]){dojo._hasResource["com.ibm.data.DependencyManager"]=true;dojo.provide("com.ibm.data.DependencyManager");dojo.declare("com.ibm.data.DependencyManager",null,{constructor:function(store){this._st=store;this._rels={};},destroy:function(){delete this._st;delete this._rels;},_initItemDep:function(id){var r=this._rels;if(!r[id]){r[id]=[{}];for(var t in com.ibm.data.DependencyManager.types){r[id].push({});}}return this;},updateDependencyId:function(oldId,newId){var r=this._rels;if(r[oldId]){r[newId]=r[oldId];delete r[oldId];}for(var id in r){for(var i=0,typeR;typeR=r[id],i<r[id].length;i++){if(typeR[oldId]){typeR[newId]=typeR[oldId];delete typeR[oldId];}}}return this;},getDependencies:function(_26d9){this._initItemDep(_26d9);return this._rels[_26d9];},getSourcesByType:function(_26da,type){var arr=this.getDependencies(_26da);var _26db=[];if(arr){for(var id in arr[0]){if(arr[0][id][type]){_26db.push(id);}}}return _26db;},getTargetsByType:function(_26dc,type){type++;var arr=this.getDependencies(_26dc);var _26dd=[];if(arr){for(var id in arr[type]){_26dd.push(id);}}return _26dd;},addDependency:function(_26de,_26df,type){var r=this._rels,sType=type+1;this._initItemDep(_26de);r[_26de][sType][_26df]=1;this._initItemDep(_26df);if(!r[_26df][0][_26de]){r[_26df][0][_26de]=[];}r[_26df][0][_26de][type]=1;return this;},removeDependency:function(_26e0,_26e1,type){var r=this._rels,sType=type+1;if(r[_26e0]&&r[_26e0][sType][_26e1]){delete r[_26e0][sType][_26e1];}if(r[_26e1]&&r[_26e1][0][_26e0]&&r[_26e1][0][_26e0][type]){delete r[_26e1][0][_26e0][type];}return this;},getPlan:function(items,type){var plan=new com.ibm.planner.SimplePOPlan();dojo.forEach(items,function(_26e2){this._buildPlan(plan,this._st.getIdentity(_26e2),type);},this);return plan;},_buildPlan:function(plan,_26e3,type){if(!plan.hasStep(_26e3)){var _26e4=plan.makeStep(_26e3,null);var _26e5=this.getTargetsByType(_26e3,type);for(var i=0;i<_26e5.length;i++){var _26e6=this._buildPlan(plan,_26e5[i],type);if(_26e6){_26e4.addPreStep(_26e6);}}return _26e4;}else{return plan.getStep(_26e3);}}});com.ibm.data.DependencyManager.types={"create":0,"delete":1,"load":2,"order":3};}if(!dojo._hasResource["com.ibm.utilities"]){dojo._hasResource["com.ibm.utilities"]=true;dojo.provide("com.ibm.utilities");com.ibm.utilities={urlToProxyUrl:function(url,_26e7){var ret=_26e7?_26e7:"/proxy";var _26e8="http";var colon=url.indexOf("://");if(colon>-1){_26e8=url.substring(0,colon);url=url.substring(colon+3);}url=url.replace(/:/g,"%3A");return ret+"/"+_26e8+"/"+url;},withBaseUrl:function(_26e9){if(_26e9.charAt(0)=="/"){return _26e9;}return com.ibm.utilities.baseUrl()+_26e9;},baseUrl:function(){if(!this._baseUrl){var base=dojo.doc.getElementsByTagName("base")[0];if(base){this._baseUrl=base.getAttribute("href");}if(!this._baseUrl){this._baseUrl="";}}return this._baseUrl;},stripUrlFragment:function(url){var h=url.indexOf("#");if(h>-1){url=url.substr(0,h);}return url;},stripTrailingSlash:function(url){if(!url){return "";}else{return url.replace(/\/+$/g,"");}},actionIO:function(url,_26ea){if(url){var form=dojo.doc.createElement("form");form.setAttribute("action",url);if(_26ea){_26ea=_26ea.toLowerCase();}switch(_26ea){case "get":form.setAttribute("method","GET");break;case "post":case "delete":case "put":form.setAttribute("method","POST");break;default:}dojo.body().appendChild(form);form.submit();}},refreshPage:function(){var url,hash=-1,bases=document.getElementsByTagName("base");if(bases.length>0){url=bases[0].href;}else{url=top.location.href;hash=url.indexOf("#");if(dojo.isSafari<4&&hash>-1){window.location.reload();}if(hash>-1){url=url.substring(0,hash);}}window.location.assign(url);}};(function(){var _26eb="{EB2F8DA2-5B2C-F66A-CDD0-A2D42143F5AC}";var newL="\r\n";var sep="--";var _26ec=newL+sep+_26eb+newL;var endB=sep+_26eb+sep+newL;var _26ed=new RegExp(newL+newL);var _26ee=new RegExp(newL+"s*([^\r]*)s*","mg");var _26ef=/\s*([^:]*):\s*(.+)/;var _26f0=/boundary\s*=\s*\"?([^\"]*)\"?/;var _26f1=function(_26f2,_26f3,_26f4){try{if(_26f3 instanceof Error){if(_26f2.error){_26f2.error(_26f3,_26f4);}}else{try{if(_26f2.load){_26f2.load(_26f3,_26f4);}}catch(err){if(_26f2.error){_26f2.error(err,_26f4);}}}if(_26f2.handle){_26f2.handle(_26f3,_26f4);}}catch(err2){}};function xhrMime(){this.respHeaders=[];this.responseText="";this.responseXML=null;this.status=0;this.statusText="";this.readyState=0;this.onreadystatechange=function(){};};dojo.extend(xhrMime,{getResponseHeader:function(key){key=key.toLowerCase();for(var i=0,_26f5,l=this.respHeaders.length;i<l;i++){_26f5=this.respHeaders[i];if(_26f5[0].toLowerCase()==key){return _26f5[1];}}return null;},getAllResponseHeaders:function(){var str="";for(var i=0,_26f6,l=this.respHeaders.length;i<l;i++){_26f6=this.respHeaders[i];str+=_26f6[0]+": "+_26f6[1];if(i<l-1){str+="\n";}}return str;},send:function(){},open:function(){},abort:function(){},setRequestHeader:function(){}});var _26f7=function(_26f8){return _26f8.replace(/\r\n\s/mg," ");};var _26f9=function(_26fa,_26fb){var _26fc=null;if(_26fa.handleAs=="xml"){try{_26fc=com.ibm.domUtilities.docFromString(_26fb.responseText);}catch(err){}}_26fb.responseXML=_26fc;var djCh=dojo.contentHandlers?"contentHandlers":"_contentHandlers";return dojo[djCh][_26fa.handleAs](_26fb);};dojo.mixin(com.ibm.utilities,{handleMultiPartResponse:function(parts,_26fd,_26fe){var _26ff=_26fe.xhr.getResponseHeader("Content-Type").match(_26f0);if(!_26ff){throw new Error("No boundary specified in Content-Type response header");}var bound=_26ff[1];var _2700=new RegExp(newL+sep+bound,"mg");var _2701=_26fd.split(_2700);for(var i=1,j=i-1;i<_2701.length-1;i++,j++){var _2702=new xhrMime(),part=_2701[i],_2703=null;_26ee.lastIndex=0;var _2704=part.split(_26ed);var _2705=_26f7(_2704[0]),_2706=_2704[1];if(!_2706){_2706="";}while((_2703=_26ee.exec(_2705))!==null&&(_2703[1].length>0)){var _2707=_2703[1].match(_26ef);if(_2707){_2702.respHeaders.push([_2707[1],_2707[2]]);}}part=dojo.string.trim(_2706);_2702.responseText=part;if(_26fe.args.partContentHandler){part=_26fe.args.partContentHandler(parts[j],_2702,_26f9);}else{part=_26f9(parts[j],_2702);}_26f1(parts[j],part,dojo.mixin({},_26fe,{xhr:_2702}));}},multiPartXhr:function(_2708,args,parts){var body="",_2709=null;dojo.forEach(parts,function(part){part.handleAs=part.handleAs?part.handleAs.toLowerCase():"text";_2709="";for(var x in part.headers){_2709+=x+": "+part.headers[x]+newL;}body+=_26ec+_2709+newL;if(part.data&&part.data.length>0){body+=part.data+newL;}});body+=endB;if(_2708.toUpperCase()!="PUT"){_2708="POST";}args.headers=dojo.mixin({},args.headers,{"Content-type":"multipart/mixed; boundary=\""+_26eb+"\""});var _270a=dojo.mixin({},args,{load:function(_270b,_270c){if(args.preHandle){args.preHandle(_270b,_270c);}com.ibm.utilities.handleMultiPartResponse(parts,_270b,_270c);if(args.postHandle){args.postHandle(_270b,_270c);}},error:function(_270d,_270e){if(args.preHandle){args.preHandle(_270d,_270e);}dojo.forEach(parts,function(part){_26f1(part,_270d,_270e,null);});if(args.error){args.error(_270d,_270e);}if(args.postHandle){args.postHandle(_270d,_270e);}},handleAs:"text",form:null,content:null,postData:null,putData:null});_270a[_2708.toLowerCase()+"Data"]=body;return dojo.xhr(_2708,_270a,true);}});})();}if(!dojo._hasResource["com.ibm.data.TemplateInstantiator"]){dojo._hasResource["com.ibm.data.TemplateInstantiator"]=true;dojo.provide("com.ibm.data.TemplateInstantiator");dojo.declare("com.ibm.data.TemplateInstantiator",null,{_retrieveTemplate:function(_270f,args){if(!_270f){throw new Error("No template defined for "+this.toString());}return _270f;},_fillOutTemplate:function(str,args,_2710,obj){return dojo.string.substitute(str,args,_2710,obj);},getTemplateInstance:function(_2711,args,_2712){var str=this._fillOutTemplate(_2711,args,com.ibm.domUtilities.encodeXML,_2712);var doc=com.ibm.domUtilities.docFromString(str);return doc;}});}if(!dojo._hasResource["com.ibm.data.resolver.SiteMap"]){dojo._hasResource["com.ibm.data.resolver.SiteMap"]=true;dojo.provide("com.ibm.data.resolver.SiteMap");dojo.declare("com.ibm.data.resolver.SiteMap",com.ibm.data.TemplateInstantiator,{namespaces:{mashup:"http://www.ibm.com/xmlns/prod/websphere/portal/v6.0.2/mashup-sitemap"},constructor:function(args){dojo.mixin(this,args);this.engine=new com.ibm.xml.SimpleXmlAccessor({namespaces:this.namespaces});this.data=this.getTemplateInstance(this.template,{});this.data=this.engine.select("/mashup:sitemap",this.data,true)[0];},addEntry:function(args){var map=dojo.delegate(args,{mode:null,uri:null});var ent=new com.ibm.xml.XmlNodeList(this.engine.createFromJson(this.data,{name:"mashup:entry",attributes:{uri:args.uri}}));ent.ns=this.namespaces;var defs=[];for(var p in map){if(map[p]!=null){defs.push({name:"mashup:parameter",attributes:{name:p},children:this._getValuesDef(map[p])});}}if(args.mode){ent.attr("mode",args.mode);}else{ent.removeAttr("mode");}dojo.forEach(defs,function(def){ent.createFromJson(def);},this);},_getValuesDef:function(_2713){if(!dojo.isArray(_2713)){_2713=[_2713];}return dojo.map(_2713,this._getValueDef,this);},_getValueDef:function(value){return {name:"mashup:value",children:[value+""]};},getEntries:function(){return this.engine.select("mashup:entry",this.data);},serialize:function(){return com.ibm.domUtilities.stringFromDoc(this.data);}});(function(){var prot=com.ibm.data.resolver.SiteMap.prototype,_2714=[];for(var _2715 in prot.namespaces){_2714.push("xmlns:",_2715,"=\"",prot.namespaces[_2715],"\" ");}dojo.extend(com.ibm.data.resolver.SiteMap,{template:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<mashup:sitemap "+_2714.join("")+">"+"</mashup:sitemap>"});})();}if(!dojo._hasResource["com.ibm.lang.Tokenizer"]){dojo._hasResource["com.ibm.lang.Tokenizer"]=true;dojo.provide("com.ibm.lang.Tokenizer");dojo.declare("com.ibm.lang.Tokenizer",null,{splitter:/[ ]/g,constructor:function(_2716){if(_2716){if(dojo.isString(_2716)){_2716=new RegExp(_2716,"g");}this.splitter=_2716;}},tokenize:function(str){var match=null,parts=[],_2717=0;while((match=this.splitter.exec(str))!=null){if(_2717<match.index){parts.push(str.substring(_2717,match.index));}_2717=match.index;}if(_2717<str.length){parts.push(str.substring(_2717,str.length));}return parts;}});}if(!dojo._hasResource["com.ibm.stream.BitStream"]){dojo._hasResource["com.ibm.stream.BitStream"]=true;dojo.provide("com.ibm.stream.BitStream");(function(){var _2718=com.ibm.stream;_2718.BitStream=function(_2719,_271a){this.bsize=_2719?_2719:8;this.revEndian=_271a;this.init();};dojo.extend(_2718.BitStream,{init:function(){this.slot=0;this.rem=this.bsize;this.buf=[];},getSize:function(){return (this.buf.length*this.bsize)+(this.rem<this.bsize?this.rem:0);},_applyEndianness:function(bval){if(this.revEndian){var lval=0,mask=1;for(var i=0;i<this.bsize;i++){lval<<=1;lval|=((bval>>>i)&mask);}return lval;}else{return bval;}},pushBits:function(value,len){while(len){var n=Math.min(len,this.rem),v=(value>>>(len-=n))&((1<<n)-1);this.rem-=n;this.slot<<=n;this.slot|=v;if(!this.rem){this._pushVal(this.buf,this.slot);this.slot=0;this.rem=this.bsize;}}},pushBitArray:function(_271b){var arr=_271b.slice();if(this.rem<this.bsize&&arr.length>this.rem){this.pushBitArray(arr.splice(0,this.rem));}var v=0,s=0,start=0,end=this.bsize,copy=arr.slice();while(arr.length>0){v<<=1;v|=(arr.shift()?1:0);if(++s==this.bsize){this.pushBits(v,s);v=0,s=0,start=end,end+=this.bsize;}}this.pushBits(v,s);},getBlocks:function(_271c){var b=this.buf.slice(),rem=this.rem;if(this.rem<this.bsize){if(_271c){this._pushVal(b,this.slot);}else{this._pushVal(b,this.slot<<this.rem);rem=0;}}return {blocks:b,remaining:rem};},_pushVal:function(buf,val){val=this._applyEndianness(val);buf.push(val);},toBitStream:function(_271d){var bs=new _2718.BitStream(_271d?_271d:this.bsize);var b=this.buf.slice();for(var i=0;i<b.length;i++){bs.pushBits(b[i],this.bsize);}if(this.rem<this.bsize){bs.pushBits(this.slot,this.bsize-this.rem);}return bs;}});})();}if(!dojo._hasResource["com.ibm.encoding.base64"]){dojo._hasResource["com.ibm.encoding.base64"]=true;dojo.provide("com.ibm.encoding.base64");(function(){var abc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b64=com.ibm.encoding.base64={alphabets:{standard:abc,url:abc.replace("+/=","-_!"),regexp:abc.replace("+/","!-"),filename:abc.replace("/","-")},encodeUrl:function(val){return b64.encode(b64._toCharCode(val),b64.alphabets.url).join("");},encodeRegexp:function(val){return b64.encode(b64._toCharCode(val),b64.alphabets.regexp).join("");},encodeFilename:function(val){return b64.encode(b64._toCharCode(val),b64.alphabets.filename).join("");},_toCharCode:function(val){var arr=[];for(var i=0;i<val.length;i++){arr.push(val.charCodeAt(i));}return arr;},encode:function(val,alph){var bs8=new com.ibm.stream.BitStream(8),abc=alph.split("");var copy=val.slice(),_271e=[],_271f=val.length%3;while(copy.length>0){var buf=copy.splice(0,3);for(var i=0;i<buf.length;i++){bs8.pushBits(buf[i],8);}_271e=_271e.concat(b64._encodeStream(bs8,abc));bs8.init();}if(_271f){for(var c=3;c>_271f;c--){_271e.push(abc[64]);}}return _271e.join("");},decode:function(str,alph){var s=str.split(""),abc=alph.split("");var _2720=s.indexOf(abc[64]);var bs6=new com.ibm.stream.BitStream(6);var buf=[];for(var i=0;i<s.length;i+=4){for(var j=i;j<i+4;j++){bs6.pushBits(abc.indexOf(s[j]),6);}var _2721=b64._decodeStream(bs6,abc);while(j-->_2720){_2721.pop();}buf=buf.concat(_2721);bs6.init();}return buf;},encodeBits:function(val,alph,_2722){var bs8=new com.ibm.stream.BitStream(8,_2722);bs8.pushBitArray(val);var _2723=bs8.getBlocks().blocks;return b64.encode(_2723,alph);},_encodeStream:function(_2724,alph){var bs6=_2724.toBitStream(6),_2725=bs6.getBlocks().blocks,out=[];for(var j=0;j<_2725.length;j++){out.push(alph[_2725[j]]);}return out;},_decodeStream:function(_2726,alph){var bs8=_2726.toBitStream(8),_2727=bs8.getBlocks().blocks,out=[];for(var j=0;j<_2727.length;j++){out.push(_2727[j]);}return out;}};})();}if(!dojo._hasResource["com.ibm.encoding.huffman"]){dojo._hasResource["com.ibm.encoding.huffman"]=true;dojo.provide("com.ibm.encoding.huffman");(function(){var _2728=/[\/\. ]/g,b64=com.ibm.encoding.base64,_2729=function(arr){return b64.encode(arr,b64.alphabets.url);},_272a=function(str){return b64.decode(str,b64.alphabets.url);},_272b=function(str){return encodeURIComponent(str.replace(/Z/g,"Z5A")).replace(/%/g,"Z").replace(/~/g,"Z7E");},_272c=function(str){decodeURIComponent(str.replace(/Z7E/g,"~").replace(/Z/g,"%")).replace(/Z5A/g,"Z");};var huff=com.ibm.encoding.huffman={encodeUrlByRegexp:function(url,_272d){return huff.encodeUrlByTokens((new com.ibm.lang.Tokenizer(_272d||_2728)).tokenize(url));},encodeUrlByTokens:function(_272e){var tree=huff.getTree(_272e),url=_2729(tree.encodedTree.getBlocks().blocks);for(var i=0;i<tree.alphTokens.length;i++){url+="/"+_272b(tree.alphTokens[i]);}url+="/"+_2729(tree.encodedData.getBlocks().blocks);window.tree=tree;return url;},getTree:function(parts){return new com.ibm.encoding.huffman.Tree(parts);},decodeUrl:function(url){}};})();dojo.declare("com.ibm.encoding.huffman.Tree",null,{parts:[],root:null,encodedData:null,alphTokens:[],codes:{},encodedTree:null,constructor:function(parts,_272f){this.parts=parts;this._nid=0;if(!_272f){this._buildTree();}},_initTreeCodes:function(){this.codes={};this.alphTokens=[];this.encodedTree=new com.ibm.stream.BitStream(8,true);this._walk(this.root,[]);this._encodeParts();},_walk:function(node,_2730){if(node[0] instanceof Array||typeof node[0]=="array"){this.encodedTree.pushBits(1,1);this._walk(node[0][0],_2730.concat(0));this._walk(node[0][1],_2730.concat(1));}else{this.encodedTree.pushBits(0,1);this.codes[node[0]]=_2730;this.alphTokens.push(node[0]);}},_buildTree:function(){var list=this._getSortedParts();while(list.length>1){var l=list.shift(),r=list.shift();list.push([[l,r],l[1]+r[1]]);list.sort(this._compareFrequency);}this.root=list[0];this._initTreeCodes();},_encodeParts:function(){this.encodedData=new com.ibm.stream.BitStream(8,true);for(var i=0;i<this.parts.length;i++){this.encodedData.pushBitArray(this.codes[this.parts[i]]);}},_getSortedParts:function(){var _2731={},node;for(var i=this.parts.length-1,p;p=this.parts[i],i>=0;i--){if(p in _2731){_2731[p]++;}else{_2731[p]=1;}}var list=[];for(var p in _2731){list.push([p,_2731[p]]);}return list.sort(this._compareFrequency);},_compareFrequency:function(p1,p2){return p1[1]-p2[1];}});}if(!dojo._hasResource["com.ibm.data.ItemsLoader"]){dojo._hasResource["com.ibm.data.ItemsLoader"]=true;dojo.provide("com.ibm.data.ItemsLoader");dojo.declare("com.ibm.data.ItemsLoader",null,{store:null,query:null,queryOptions:null,cacheContext:null,cacheProperty:null,preload:true,fetchOnReload:false,resultSet:null,status:0,constructor:function(args){dojo.mixin(this,args);if(!this.queryOptions){this.queryOptions={};}this._lastModified=(new Date()).getTime();if(this.preload){setTimeout(dojo.hitch(this,"_load"),1);}},filter:function(_2732){return _2732;},_getResultSet:function(){if(this._lastModified==this.resultSet._lastModified){return this.resultSet;}else{this.resultSet=this.filter(this.resultSet);this._lastModified=this.resultSet._lastModified=(new Date()).getTime();if(this.cacheContext&&this.cacheProperty){this.cacheContext[this.cacheProperty]=this.resultSet;}return this.resultSet;}},_load:function(){if(!this._def){this._def=new dojo.Deferred();if(this.cacheContext&&this.cacheProperty){this.resultSet=this.cacheContext[this.cacheProperty];if(this.resultSet){if(!this.status){this.status=200;}this.resultSet.loaded=true;this._def.callback();return this._def;}}this._fetch();}return this._def;},_getFetchArgs:function(){return {query:this.query,queryOptions:this.queryOptions,onBegin:function(size,_2733){this.totalSize=size;this._request=_2733;this.status=_2733.xhr.status;},onComplete:function(items){items.loaded=true;this.resultSet=items;this._def.callback();},onError:function(err,_2734){this._request=_2734;this._def.errback(err);},scope:this};},_fetch:function(){this._request=this.store.fetch(this._getFetchArgs());},addOnLoad:function(_2735){this._load().addCallback(this._wrap(_2735));return this;},addOnError:function(_2736){this._load().addErrback(this._wrap(_2736,true));return this;},addOnResult:function(_2737){return this.addOnLoad(_2737).addOnError(_2737);},_wrap:function(f,isErr){if(f){return dojo.hitch(this,function(res){try{f(isErr?res:this._getResultSet());}catch(err){this.raiseError(err);}});}},raiseError:function(err){console.error(err);},reload:function(){if(this._def){this._def.cancel();}delete this._def;if(this.fetchOnReload&&this.cacheContext&&this.cacheProperty){delete this.cacheContext[this.cacheProperty];}this._load();return this;}});}if(!dojo._hasResource["com.ibm.data.PagedItemsLoader"]){dojo._hasResource["com.ibm.data.PagedItemsLoader"]=true;dojo.provide("com.ibm.data.PagedItemsLoader");dojo.declare("com.ibm.data.PagedItemsLoader",com.ibm.data.ItemsLoader,{pageSize:0,constructor:function(args){this._pages=[];this._pageDfd=new dojo.Deferred();this.resultSet=[];},_load:function(){if(!this._def){this._def=new dojo.Deferred();if(this.cacheContext&&this.cacheProperty){this._orphanItems=this.cacheContext[this.cacheProperty];if(this._orphanItems){this.query=this._orphanItems.query;}}}return this._def;},hasNext:function(){return (this._orphanItems&&this._orphanItems.length>0)||new Boolean(this.query)==true;},next:function(){if(this.hasNext()){if(!this._curPage){this._makePage();}if(this._curPage&&!this._curPage.loading){this._curPage.load();}}return this;},end:function(){this.addOnPageLoad(dojo.hitch(this,"next"));this.next();return this;},_makePage:function(){var pg=this._curPage=new com.ibm.data.ItemsPage({store:this.store,query:this.query,size:this.pageSize,filter:this.filter});dojo.connect(pg,"onFull",dojo.hitch(this,"_pageFull"));dojo.connect(pg,"onError",dojo.hitch(this,"_pageError"));this._pages.push(pg);if(this._orphanItems){pg.fill(this._orphanItems);}return pg;},_pageFull:function(items,_2738,_2739){this.resultSet.push.apply(this.resultSet,items);dojo.mixin(this.resultSet,{_lastModified:this._lastModified=(new Date()).getTime(),query:this.query=_2739});this._orphanItems=_2738;delete this._curPage;this._copyDfd().callback(items);if(!_2739&&(!_2738||_2738.length==0)){this.resultSet.push.apply(this.resultSet,this._orphanItems);delete this._orphanItems;this._def.callback();}},_pageError:function(err,items){this._copyDfd().errback(err);this.resultSet=this.resultSet.concat(this._orphanItems);delete this._orphanItems;this._def.errback(err);},_copyDfd:function(){var df=new dojo.Deferred();df.chain=this._pageDfd.chain.slice();return df;},addOnPageLoad:function(_273a){this._pageDfd.addCallback(this._wrapPage(_273a));return this;},addOnPageError:function(_273b){this._pageDfd.addErrback(this._wrapPage(_273b));return this;},addOnPageResult:function(_273c){return this.addOnPageLoad(_273c).addOnPageError(_273c);},_wrapPage:function(f){if(f){return dojo.hitch(this,function(res){try{f(res);}catch(err){this.raiseError(err);}});}}});dojo.declare("com.ibm.data.ItemsPage",null,{store:null,query:null,items:[],size:50,constructor:function(args){this.items=[];dojo.mixin(this,args);this.full=false;this.loading=false;},filter:function(_273d){return _273d;},_makeLdr:function(){this._ldr=new com.ibm.data.ItemsLoader({query:this.query,store:this.store,preload:false,filter:this.filter});},load:function(){if(!this.loading&&!this.full){this.loading=true;this._load();}},_load:function(){if(this.query){if(!this._ldr){this._makeLdr();}this._startLoader();}else{this.onFull(this.items,[],null);}},_startLoader:function(){this._ldr.addOnLoad(dojo.hitch(this,"_onLoadFill")).addOnError(dojo.hitch(this,"error"));},_onLoadFill:function(items){this.query=this._ldr._request.nextQuery;this.fill(items);},fill:function(items){var dif=this.size-this.items.length;if(dif>0){this.items.push.apply(this.items,items.slice(0,dif));if(this.items.length==this.size){this.onFull(this.items,items.slice(dif),this.query);}else{if(this.loading){this._load();}}}},error:function(err){this.onError(err,this.items);},onFull:function(items,_273e,_273f){this.full=true;},onError:function(err,items){this.full=true;this.err=err;}});}if(!dojo._hasResource["com.ibm.data.Resolver"]){dojo._hasResource["com.ibm.data.Resolver"]=true;dojo.provide("com.ibm.data.Resolver");(function(){var _2740={};com.ibm.data.Resolver={register:function(_2741,cntr){if(!_2740[_2741]){_2740[_2741]=cntr;}},getHandler:function(_2742){return _2740[_2742];},getStore:function(args){return new com.ibm.data.ResolverStore(args);},_flagDigestUpdate:function(){dojo.cookie("DigestTracker",(new Date()).getTime(),{path:"/"});},TOPICS:{UpdateDigest:"/resolver/UpdateDigest"}};dojo.subscribe(com.ibm.data.Resolver.TOPICS.UpdateDigest,com.ibm.data.Resolver._flagDigestUpdate);})();dojo.declare("com.ibm.data.ResolverStore",null,{tunnel:false,states:{"new":0,"dirty":1,"deletedExpl":2,"deletedImpl":3,"deleted":4,"loaded":5,"saving":6},_features:{"dojo.data.api.Read":true,"dojo.data.api.Write":true,"dojo.data.api.Identity":true,"dojo.data.api.Notification":true,"com.ibm.data.api.ServerGenerated":true},namespaces:{},headers:{"DIGEST":"X-Request-Digest","STATUS":"X-Status-Code","URI":"Content-ID","CONTENT_TYPE":"Content-Type","METHOD":"X-Method-Override","AUTH_OVERRIDE":"X-IBM-XHR"},URL_LIMIT:2000,_huffmanTokenizer:/[\/ ]/g,_digest:"",url:"",isAuthenticated:false,saveWait:1,fetchWait:1,constructor:function(args){dojo.mixin(this,args);this._handlers={};this._cachedItems={};this._itemLoaders={};this._cidMap={};this._ioOutQueue=this._getDeferredQueue(new dojo.Deferred()).fire();this._fetchQueue=[];this._laundryQueue=[];this._cidCntr=Math.floor(Math.random()*10000001);this._etagMap={};this._notifyOn=true;this.multiPart=true;var qi=this.url.indexOf("?");if(qi>-1){this.multiPartUrl=this.url.substr(0,qi)+"?uri=mashup:multiplex&"+this.url.substr(qi+1);}else{this.multiPartUrl=this.url+"?uri=mashup:multiplex";}this._auth=dojo.getObject("com.ibm.ajax.auth");this._depMgr=new com.ibm.data.DependencyManager(this);this._messages=dojo.i18n.getLocalization("com.ibm.bundles","Resolver");this._faultFactory=new com.ibm.data.resolver.FaultFactory();dojo.addOnWindowUnload(dojo.hitch(this,function(){this.destroy();}));},destroy:function(){for(var id in this._cachedItems){var item=this._cachedItems[id];try{if(this._isItem(item)){this._getHandlerByItem(item).uninitialize(item);}for(var p in item){delete item[p];}}catch(err){}}delete this._cachedItems;for(var _2743 in this._handlers){var h=this._getHandlerByScheme(_2743);h.destroy();delete h._$;}delete this._handlers;delete this._itemLoaders;this._depMgr.destroy();delete this._depMgr;delete this._ioOutQueue;delete this._laundryQueue;delete this._messages;},getNamespaces:function(){return this.namespaces;},applyHandlerStrategy:function(_2744,_2745){var h=this._getHandlerByScheme(_2744);return com.ibm.strategy.Strategy.applyStrategy(h,_2745);},unapplyHandlerStrategy:function(adv){com.ibm.strategy.Strategy.removeStrategy(adv);},_initStoreMeta:function(item,mixin){if(item._$==null){item._$={states:[],store:this};}item._$=dojo.mixin(item._$,mixin);return item;},_getDeferredQueue:function(dfd){var dfdq=new com.ibm.lang.DeferredQueue(dfd);dfdq.raiseError=dojo.hitch(this,"raiseError");return dfdq;},_getSchemeFromUri:function(uri){if(!uri){var err=new Error(this.fmt("errorNoPocHandler",[uri]));this.raiseError(err);throw err;}return uri.split(":")[0];},_getHandlerByScheme:function(_2746){if(!this._handlers[_2746]){var h=com.ibm.data.Resolver.getHandler(_2746);if(!h){var err=new Error(this.fmt("errorNoPocHandler",[_2746]));this.raiseError(err);throw err;}var inst=new h(this,this._depMgr);this._handlers[_2746]=inst;inst._$={stateLists:[[],[],[]]};}return this._handlers[_2746];},_getHandlerByItem:function(item){this._assertItem(item);return this._getHandlerByScheme(item._$.scheme);},_getHandlerByUri:function(uri){return this._getHandlerByScheme(this._getSchemeFromUri(uri));},raiseError:function(error){console.error(error);},urlToQuery:function(url,_2747){return new com.ibm.data.resolver.Query({url:url,scheme:_2747});},fmt:function(key,map){return dojo.string.substitute(this._messages[key],map,function(_2748,_2749){if(_2748===null){return "null";}if(_2748===undefined){return "undefined";}return _2748;});},_isItem:function(_274a){return _274a&&_274a._$&&_274a._$.scheme&&_274a._$.store===this;},_assertItem:function(_274b){if(!this._isItem(_274b)){var err=new Error(this.fmt("errorInvalidItem",[_274b]));this.raiseError(err);throw err;}return true;},_assertString:function(_274c){if(!dojo.isString(_274c)){var err=new Error(this.fmt("errorInvalidString",[_274c]));this.raiseError(err);throw err;}return true;},_getDigestFromResponse:function(_274d,_274e){var _274f=_274e.xhr.getResponseHeader(this.headers.DIGEST);if(_274f){if(this._digest){this.url=this.url.replace(this._digest,_274f);}this._digest=_274f;}},_flagDigestUpdate:function(){dojo.publish(com.ibm.data.Resolver.TOPICS.UpdateDigest);},_queryToHeader:function(query){return dojo.objectToQuery(query).replace(/&/mg,"; ");},_isResponseError:function(_2750,xhr){var s=xhr.status;if((s>=200&&s<300)||s==302||s==1223){return false;}return true;},_multiPartContentHandler:function(_2751,xhr,_2752){var _2753=xhr.getResponseHeader(this.headers.STATUS);xhr.status=_2753?_2753-0:200;var _2754=xhr.responseText;if(this._isResponseError(_2751,xhr)){if(xhr.getResponseHeader(this.headers.CONTENT_TYPE)=="application/soap+xml"){_2754=this._faultFactory.getFaultError(_2754,new Error());}else{_2754=new Error(_2754);}}else{_2754=_2752(_2751,xhr);}return _2754;},_createIOMPartDfd:function(_2755,_2756){var dfd=new dojo.Deferred(),queue;var _2757=_2756.method.toUpperCase();switch(_2757){case "GET":case "PROPFIND":delete _2756.query.digest;queue=_2755.inboundQueue;break;default:if(!_2756.headers){_2756.headers={};}_2756.headers[this.headers.METHOD]=_2757;var query=null;if(dojo.isString(_2756.query)){_2756.headers[this.headers.URI]="res:/"+_2756.query;}else{_2756.headers[this.headers.URI]=_2756.query.uri;delete _2756.query.uri;var query=this._queryToHeader(_2756.query);if(query.length>0){_2756.headers[this.headers.URI]+="; "+query;}}delete _2756.query;queue=_2755.outboundQueue;break;}var _2758=_2756.error;_2756.error=function(error,args){try{if(_2758){_2758.call(_2756,error,args);}}catch(err){}};var _2759=_2756.handle;_2756.handle=function(_275a,args){try{if(_2759){_2759.call(_2756,_275a,args);}}catch(err){}if(_275a instanceof Error){dfd.errback(_275a);}else{dfd.callback(_275a);}};queue.push(_2756);return dfd;},_getSiteMap:function(_275b){var sm=new com.ibm.data.resolver.SiteMap();var q;for(var i=0;i<_275b.length;i++){q=_275b[i].query;if(dojo.isString(q)){q={uri:"res:/"+q};}sm.addEntry(q);}return sm;},_encodeSiteMap:function(sm){return com.ibm.encoding.huffman.encodeUrlByRegexp(sm.serialize(),this._huffmanTokenizer);},_exceedsURLLimit:function(url){return (url.length+window.location.protocol.length+window.location.hostname.length+window.location.port.length+3)>this.URL_LIMIT;},_sendHuffmanRequest:function(queue){if(queue&&queue.length>0){var sm=this._getSiteMap(queue),_275c=this._encodeSiteMap(sm);var _275d;var qi=this.url.indexOf("?");if(qi>-1){_275d=this.url.substr(0,qi)+"mashup/mashup:huffman/"+_275c+"?"+this.url.substr(qi+1);}else{_275d=this.url+"mashup/mashup:huffman/"+_275c;}if(this._exceedsURLLimit(_275d)){this._sendHuffmanRequest(queue.slice(0,queue.length/2));this._sendHuffmanRequest(queue.slice(queue.length/2,queue.length));}else{var hdrs={};hdrs[this.headers.AUTH_OVERRIDE]="true";dojo.xhrGet({headers:hdrs,partContentHandler:dojo.hitch(this,"_multiPartContentHandler"),url:_275d,load:dojo.hitch(this,function(_275e,args){if(!this._authHandler(_275e,args)){return;}this._getDigestFromResponse(_275e,args);com.ibm.utilities.handleMultiPartResponse(queue,_275e,args);}),error:function(err,args){dojo.forEach(queue,function(obj){if(obj.error){try{obj.error(err,args);}catch(e){}}if(obj.handle){try{obj.handle(err,args);}catch(e){}}},this);}});}}},_io:function(_275f){var _2760=null,_2761=null;if(this.multiPart&&_275f.length>1){var _2762=[],_2763={inboundQueue:[],outboundQueue:[]};_2760=dojo.partial(this._createIOMPartDfd,_2763);_2761=dojo.hitch(this,function(){var hdrs={};hdrs[this.headers.AUTH_OVERRIDE]="true";if(_2763.outboundQueue.length>0){com.ibm.utilities.multiPartXhr("POST",{headers:hdrs,url:this.multiPartUrl,partContentHandler:dojo.hitch(this,"_multiPartContentHandler"),preHandle:dojo.hitch(this,function(_2764,args){if(!this._authHandler(_2764,args)){return;}this._getDigestFromResponse(_2764,args);})},_2763.outboundQueue);}if(_2763.inboundQueue.length>0){this._sendHuffmanRequest(_2763.inboundQueue);}});}else{var _2765=[];_2760=function(_2766){if(dojo.isString(_2766.query)){_2766.url=_2766.query;}else{var _2767=dojo.objectToQuery(_2766.query);if(this.url.indexOf("?")>-1){_2766.url=this.url+"&"+_2767;}else{_2766.url=this.url+"?"+_2767;}}delete _2766.query;_2766.method=_2766.method.toLowerCase();if(_2766.method=="put"||_2766.method=="post"){_2766[_2766.method+"Data"]=_2766.data;}if(!_2766.headers){_2766.headers={};}_2766.headers[this.headers.AUTH_OVERRIDE]="true";if(this.tunnel&&_2766.method!="post"&&_2766.method!="get"){_2766.headers[this.headers.METHOD]=_2766.method.toUpperCase();_2766.method="post";}var _2768=_2766.handle;_2766.handle=dojo.hitch(this,function(_2769,args){if(!this._authHandler(_2769,args)){return;}if(_2768){_2768.call(args,_2769,args);}});var _276a=_2766.load;_2766.load=dojo.hitch(this,function(_276b,args){this._getDigestFromResponse(_276b,args);if(_276a){_276a.call(args,_276b,args);}});var ioDef=new dojo.Deferred();_2765.push(function(){return dojo.xhr(_2766.method,_2766,true).addCallbacks(function(resp){return ioDef.callback(resp);},function(err){return ioDef.errback(err);});});return ioDef;};_2761=function(){dojo.forEach(_2765,function(_276c){_276c();});};}var dfds=dojo.map(_275f,_2760,this),dfdl=new dojo.DeferredList(dfds);dfdl.addCallback(function(_276d){return dojo.map(_276d,function(res){return res[1];});});return {start:function(res){_2761();return dfdl;},deferredList:dfdl};},_authHandler:function(_276e,args){if(this._auth){if(this._auth.isAuthenticationRequired(_276e,args)){this._auth.authenticationHandler();return false;}}return true;},_ioOut:function(_276f){if(!_276f||_276f.length==0){var _2770=new dojo.Deferred();_2770.callback([]);return _2770;}var ioObj=this._io(_276f);this._flagDigestUpdate();return ioObj.start();},_ioIn:function(_2771){var ioObj=this._io(_2771);return ioObj.start();},_fromCache:function(id){return this._cachedItems[id];},_toCache:function(id,item){this._cachedItems[id]=item;},getValue:function(item,_2772,_2773){this._assertString(_2772);return this._getHandlerByItem(item).getValue(item,_2772,_2773);},getValues:function(item,_2774){this._assertString(_2774);return this._getHandlerByItem(item).getValues(item,_2774);},getAttributes:function(item){return this._getHandlerByItem(item).getAttributes(item);},hasAttribute:function(item,_2775){this._assertString(_2775);return this._getHandlerByItem(item).hasAttribute(item,_2775);},containsValue:function(item,_2776,value){this._assertString(_2776);return this._getHandlerByItem(item).containsValue(item,_2776,value);},isItem:function(_2777){return this._isItem(_2777)&&!this._hasState(_2777,this.states["deleted"]);},isItemLoaded:function(_2778){return this.isItem(_2778)&&this._hasState(_2778,this.states["loaded"]);},loadItem:function(_2779){var it=_2779.item;if(this.isItemLoaded(it)){return;}var ldr=this._getItemLoader(it);if(_2779.onItem){ldr.addOnLoad(dojo.hitch(_2779.scope,_2779.onItem));}if(_2779.onError){ldr.addOnError(dojo.hitch(_2779.scope,_2779.onError));}},getLoader:function(_277a){var _277b=dojo.delegate(_277a,{store:this,preload:false}),cls;if(_277a.pageSize!=null){cls=com.ibm.data.PagedItemsLoader;}else{cls=com.ibm.data.ItemsLoader;}return new cls(_277b);},fetch:function(_277c){if(!_277c){_277c={};}_277c.aborted=false;if(!_277c.scope){_277c.scope=dojo.global;}if(!_277c.queryOptions){_277c.queryOptions={};}var _277d=_277c.queryOptions.preventCache;_277c=this._prepareQuery(_277c);var _277e=_277c.scheme,_277f=this._getHandlerByScheme(_277e),cType=_277f.definition.handleAs;var _2780=dojo.hitch(this,function(_2781,_2782){try{if(_277c.aborted){return;}if((dojo.isIE||window.ActiveXObject!==undefined)&&cType=="xml"){_2781=com.ibm.domUtilities.docFromString(_2781);}this.processResponse(_2781,_277c,_277e,_2782);}catch(err){this.raiseError(err);}});var _2783=function(error,_2784){if(_277c.onError){_277c.onError.call(_277c.scope,error,_277c);}};if(_277c.url){_277c.query=_277c.url+"?"+dojo.objectToQuery(_277c.query);delete _277c.url;}var sync=_277c.sync||_277c.queryOptions.sync;var args={method:"GET",preventCache:_277d,content:{},query:_277c.query,handleAs:"text",headers:{"X-IBM-XHR":"true"},load:_2780,error:_2783};if(cType){if(!(dojo.isIE||window.ActiveXObject!==undefined)||cType!="xml"){args.handleAs=cType;}}if(_277c.queryOptions.timeout!=null){args.timeout=_277c.queryOptions.timeout;}else{if(this.timeout){args.timeout=this.timeout;}}_277c.abort=function(){_277c.aborted=true;};args=this.modifyRequestArgs(args,_277c);if(this._fetchQueue.length==0){setTimeout(dojo.hitch(this,"_flushFetchQueue"),this.fetchWait);}if(sync||_277c.queryOptions.bypassBatch){args.sync=sync;this._ioIn([args]);}else{this._fetchQueue.push([args]);}this._lastRequest=_277c;return _277c;},_flushFetchQueue:function(){try{var q=[],fq=this._fetchQueue.splice(0,this._fetchQueue.length);for(var i=0;i<fq.length;i++){q.push.apply(q,fq[i]);}this._ioIn(q);}catch(err){this.raiseError(err);}},modifyRequestArgs:function(_2785,_2786){return _2785;},_splitUrlParts:function(_2787){if(!_2787||_2787.length==0){return {};}var start=_2787.indexOf("?");var str=_2787,path;if(start>-1&&(start<str.length-1)){str=_2787.substring(start+1);path=_2787.substring(0,start);}else{str="";path=_2787;}return {query:dojo.queryToObject(str),path:path};},_attachDigestToQuery:function(_2788){if(this._digest){var base=_2788.path?_2788.path:this.url,dIdx=base.indexOf(this._digest);if(dIdx<0||(dIdx>=0&&_2788.query.digest&&_2788.query.digest!=this._digest)){_2788.query.digest=this._digest;}}},_prepareQuery:function(_2789){var q=_2789.query,_278a,_278b;if(!q){q={};}else{if(q.declaredClass=="com.ibm.data.resolver.Query"){_2789.scheme=q.scheme;q=q.url;}}if(dojo.isString(q)){_278b=this._splitUrlParts(q);}else{_278b={query:q};}if(!_2789.scheme){_2789.scheme=this._getSchemeFromUri(_278b.query.uri);}_278a=this._getHandlerByUri(_2789.scheme);var _278c=dojo.mixin({},_2789);dojo.forEach(["onBegin","onItem","onComplete","onError","scope","query","scheme"],function(p){delete _278c[p];});_278b.query=_278a.modifyFetchQuery(_278b.query,_278c);this._attachDigestToQuery(_278b);_2789.query=_278b.query;_2789.url=_278b.path;return this.prepareQuery(_2789);},prepareQuery:function(_278d){return _278d;},_buildUrl:function(_278e,_278f){var ret="";var _278e=this._prepareQuery(_278e);var _2790=dojo.objectToQuery(_278e.query);if(_278f.indexOf("?")>-1){ret=_278f+"&"+_2790;}else{ret=_278f+"?"+_2790;}return (this.modifyUrl(_278e,ret));},modifyUrl:function(_2791,url){return url;},processFetchedItems:function(items,meta,_2792,_2793,_2794){var _2795=(_2792.queryOptions&&_2792.queryOptions.preventClientCache);var _2796=(_2792.queryOptions&&_2792.queryOptions.replaceCache);for(var i=0;i<items.length;i++){this._initStoreMeta(items[i],{scheme:_2793,pocHandler:_2794});this._addState(items[i],_2794,this.states["loaded"]);this._toCache(this.getIdentity(items[i]),items[i]);}return items;},processResponse:function(data,_2797,_2798,_2799){_2797.xhr=_2799.xhr;if(_2797.aborted){return;}var _279a=this._getHandlerByScheme(_2798);var _279b=_279a.processFetch(data,_2797);items=this.processFetchedItems(_279b.items,_279b.meta,_2797,_2798,_279a);if(_2797.onBegin){_2797.onBegin.call(_2797.scope,_279b.meta.resultSize,_2797);}if(_2797.aborted){return;}if(_2797.onItem){for(var i=0;i<items.length;i++){if(_2797.aborted){return;}_2797.onItem.call(_2797.scope,items[i],_2797);}}if(_2797.aborted){return;}if(_2797.onComplete){_2797.onComplete.call(_2797.scope,_2797.onItem?null:items,_2797);}},getFeatures:function(){return this._features;},close:function(_279c){if(_279c&&_279c.abort){_279c.abort();}},getLabel:function(item){return this._getHandlerByItem(item).getLabel(item);},getLabelAttributes:function(item){return this._getHandlerByItem(item).getLabelAttributes(item);},getIdentity:function(item){return this._getHandlerByItem(item).getIdentity(item);},getIdentityAttributes:function(item){return this._getHandlerByItem(item).getIdentityAttributes(item);},fetchItemByIdentity:function(_279d){var item=this.byId(_279d.identity);if(this.isItemLoaded(item)){if(_279d.onItem){_279d.onItem.call(scope?scope:dojo.global,item);}}else{this.loadItem({item:item,onItem:_279d.onItem,onError:_279d.onError,scope:_279d.scope});}},byId:function(id){var item=this._fromCache(id);if(!item){item=this.byCId(id);if(!item){var type=this._getSchemeFromUri(id),h=this._getHandlerByScheme(type);item=h.createStub({id:id});this._initStoreMeta(item,{scheme:type});this._toCache(id,item);}}return item;},_createItemFromProps:function(_279e,_279f,_27a0){var _27a1=_279e.scheme;delete _279e.scheme;if(!_279f){_279f={};}if(_279f.parent&&!_279e.parentId){_279e.parentId=this.getIdentity(_279f.parent);}else{if(!_279f.parent&&_279e.parentId){_279f.parent=this.byId(_279e.parentId);}}if(!_279e.locale){_279e.locale=dojo.locale;}var _27a2=this._initStoreMeta(_27a0.newItem(_279e,_279f),{scheme:_27a1});this._addState(_27a2,_27a0,this.states["loaded"]);return _27a2;},newItem:function(_27a3,_27a4){if(!_27a3.scheme){_27a3.scheme=_27a3.pocType;}var h=this._getHandlerByScheme(_27a3.scheme);var _27a5=_27a4?_27a4.parent:null;if(!_27a3.id){_27a3.id=h.definition.scheme+":"+this.getUniqueCId();}var id=_27a3.id;var item=this._createItemFromProps(_27a3,_27a4,h);item._$.onCreateDefQueue=this._getDeferredQueue(new dojo.Deferred());this.registerCId(h.getIdentity(item),item);this._toCache(id,item);this._changeState(item,h,this.states["new"]);if(this._notifyOn){this.onNew(item,{item:_27a5});}return item;},deleteItem:function(item){var h=this._getHandlerByItem(item);this._changeState(item,h,this.states["deletedExpl"]);if(this._notifyOn){}},_getItemLoader:function(item){var id=this.getIdentity(item);if(!this._itemLoaders[id]){this._itemLoaders[id]=(new com.ibm.data.ItemsLoader({query:{uri:id},store:this,filter:function(_27a6){return _27a6[0];}})).addOnResult(dojo.hitch(this,function(){delete this._itemLoaders[id];}));}return this._itemLoaders[id];},_setValue:function(item,_27a7,value,multi){this._assertString(_27a7);if(this._notifyOn){var _27a8=this[multi?"getValues":"getValue"](item,_27a7);}var h=this._getHandlerByItem(item);if(!this.isItemLoaded(item)){var err=new Error(this.fmt("errorWriteNotLoaded"));this.raiseError(err);throw err;}h.backup(item);var res=h[multi?"setValues":"setValue"](item,_27a7,value);if(res){this._changeState(item,h,this.states["dirty"]);if(this._notifyOn){}}return res;},setValue:function(item,_27a9,value){return this._setValue(item,_27a9,value,false);},setValues:function(item,_27aa,_27ab){return this._setValue(item,_27aa,_27ab,true);},unsetAttribute:function(item,_27ac){this._assertString(_27ac);if(this._notifyOn){var _27ad=this.getValue(item,_27ac);}var h=this._getHandlerByItem(item);h.backup(item);var res=h.unsetAttribute(item,_27ac);if(res){this._changeState(item,h,this.states["dirty"]);if(this._notifyOn){}}return res;},onSaveComplete:function(_27ae){},save:function(_27af){var clist=this._getUnSavedStateList(this.states["new"]),ulist=this._getUnSavedStateList(this.states["dirty"]),dlist=this._getUnSavedStateList(this.states["deletedExpl"]);var _27b0=clist.concat(ulist);if(!_27af){_27af={};}_27af._itemsOfInterest=_27b0.concat(dlist);this._queueForLaundry(_27b0,dlist,_27af);},saveItems:function(items,_27b1){var _27b2=[],_27b3=[];dojo.forEach(items,function(item){if(this._hasState(item,this.states["saving"])){return;}if(this._hasState(item,this.states["new"])||this._hasState(item,this.states["dirty"])){_27b2.push(item);}else{if(this._hasState(item,this.states["deletedExpl"])){_27b3.push(item);}}},this);if(!_27b1){_27b1={};}_27b1._itemsOfInterest=dojo.isArray(items)?items.slice():null;this._queueForLaundry(_27b2,_27b3,_27b1);},saveScheme:function(_27b4,_27b5){var h=this._getHandlerByScheme(_27b4);var clist=this._cleanList(this._getHandlerStateList(h,this.states["new"]),this.states["new"]),ulist=this._cleanList(this._getHandlerStateList(h,this.states["dirty"]),this.states["dirty"]),dlist=this._cleanList(this._getHandlerStateList(h,this.states["deletedExpl"]),this.states["deletedExpl"]);var _27b6=clist.concat(ulist);if(!_27b5){_27b5={};}_27b5._itemsOfInterest=_27b6.concat(dlist);this._queueForLaundry(_27b6,dlist,_27b5);},_itemToIOArgs:function(item,_27b7){var _27b8=this._getHandlerByItem(item);var _27b9=_27b8.processSave(item);var _27ba=this._hasState(item,this.states["new"]);var _27bb=_27b9.load;_27b9.load=dojo.hitch(this,function(data,_27bc){this._removeState(item,_27b8,this.states["new"]);this._removeState(item,_27b8,this.states["dirty"]);if(_27ba){this._fireCreated(item);}if(_27bb){_27bb.call(_27b9,data,_27bc);}_27bb=null;return data;});var _27bd=_27b9.error;_27b9.error=dojo.hitch(this,function(err,_27be){_27b7.setError(item,err);if(_27bd){_27bd.call(_27b9,err,_27be);}_27bd=null;return err;});var _27bf=_27b9.handle;_27b9.handle=dojo.hitch(this,function(data,_27c0){this._removeState(item,_27b8,this.states["saving"]);if(_27bf){_27bf.call(_27b9,data,_27c0);}_27bf=null;return data;});return _27b9;},_planStepsMapper:function(step,_27c1){var item=this.byId(step.name);var args=this._itemToIOArgs(item,_27c1);if(this._hasState(item,this.states["new"])){args.method="POST";}else{args.method="PUT";}return args;},_filterUnmetDependencies:function(steps,type,_27c2){return dojo.filter(steps,function(step){var item=this.byId(step.name);var _27c3=this._depMgr.getTargetsByType(step.name,type);return dojo.every(_27c3,function(id){var _27c4=this.byId(id);if(!this.isCreated(_27c4)){_27c2.setError(item,_27c2.getError(_27c4));this._removeState(item,this._getHandlerByItem(item),this.states["saving"]);return false;}return true;},this);},this);},_queueForLaundry:function(_27c5,_27c6,_27c7){if(this._laundryQueue.length==0){setTimeout(dojo.hitch(this,"_launder"),this.saveWait);}dojo.forEach([_27c5,_27c6],function(list){dojo.forEach(list,function(item){this._addState(item,this._getHandlerByItem(item),this.states["saving"]);},this);},this);this._laundryQueue.push({dirtyList:_27c5,delList:_27c6,keywordArgs:_27c7});},_callSaveCallbacks:function(_27c8,_27c9){dojo.forEach(_27c8,function(kw){var _27ca=_27c9.getErrors(kw._itemsOfInterest),_27cb;if(_27ca.length>0){_27cb="onError";}else{_27cb="onComplete";}if(kw[_27cb]){try{kw[_27cb].call(kw.scope?kw.scope:dojo.global,_27c9);}catch(err){this.raiseError(err);}}},this);},_launder:function(){var _27cc=[],_27cd=[],_27ce=[],pile;var _27cf=new com.ibm.data.SaveList({store:this});while((pile=this._laundryQueue.shift())!=null){_27cc=_27cc.concat(pile.dirtyList);_27cd=_27cd.concat(pile.delList);if(pile.keywordArgs){_27ce.push(pile.keywordArgs);}}var _27d0=this._getDeferredQueue(),_27d1=this._getDeferredQueue();dojo.forEach(_27ce,function(_27d2){if(_27d2.onComplete){_27d0.add((new dojo.Deferred()).addCallback(dojo.hitch(_27d2.scope?_27d2.scope:dojo.global,_27d2.onComplete,_27cf)));}if(_27d2.onError){_27d1.add((new dojo.Deferred()).addCallback(dojo.hitch(_27d2.scope?_27d2.scope:dojo.global,_27d2.onError,_27cf)));}},this);var _27d3=this._depMgr.getPlan(_27cc,com.ibm.data.DependencyManager.types["create"]).orderSteps().filter(dojo.hitch(this,function(step){var item=this.byId(step.name);ret=this.isDirty(item);if(ret){_27cf.addItem(item);}return ret;})),piles=_27d3.getGroupList();dojo.forEach(piles,function(pile){var map={};var _27d4=dojo.map(pile.steps,function(step){var item=this.byId(step.name);map[step.name]=item;return item;},this);var _27d5=this._depMgr.getPlan(_27d4,com.ibm.data.DependencyManager.types["order"]).orderSteps().filter(dojo.hitch(this,function(step){return map[step.name]!=null;}));pile.steps=_27d5.orderedSteps;},this);_27cd=dojo.map(_27cd,function(item){_27cf.addItem(item);var args={query:{uri:this.getIdentity(item),rep:"empty"},method:"DELETE",load:dojo.hitch(this,function(){var h=this._getHandlerByItem(item);dojo.forEach(["dirty","deletedExpl","deletedImpl","deleted","saving"],function(stStr){this._removeState(item,h,this.states[stStr]);},this);h.uninitialize(item);for(var p in item){delete item[p];}})};var _27d6=args.error;args.error=dojo.hitch(this,function(err,_27d7){_27cf.setError(item,err);if(_27d6){_27d6.call(args,err,_27d7);}_27d6=null;return err;});return args;},this);var _27d8=piles.shift(),_27d9=new dojo.Deferred();_27d9.addCallback(dojo.hitch(this,function(){var _27da;if(_27d8!=null){_27da=dojo.map(_27d8.steps,function(step){return this._planStepsMapper(step,_27cf);},this);}else{_27da=[];}var _27db=_27da.concat(_27cd);var _27dc=dojo.hitch(this,function(res){if((_27d8=piles.shift())!=null){try{_27d8.steps=this._filterUnmetDependencies(_27d8.steps,com.ibm.data.DependencyManager.types["create"],_27cf);_27db=dojo.map(_27d8.steps,function(step){return this._planStepsMapper(step,_27cf);},this);return this._ioOut(_27db).addCallback(_27dc);}catch(err){this.raiseError(err);}}else{var _27dd=_27cf.getErrors();if(_27dd.length==0){_27d0.fire(_27cf);}if(_27dd.length>0){_27d1.fire(_27cf,new Error());}this.onSaveComplete(_27cf);_27cf.destroy();}return res;});return this._ioOut(_27db).addCallback(_27dc);}));this._ioOutQueue.add(_27d9);},revert:function(){for(var pre in this._handlers){this.revertHandler(this._handlers[pre]);}},revertHandler:function(_27de){var h=this._handlers[_27de];if(h){var _27df=["dirty","deletedExpl","new"];dojo.forEach(_27df,function(state){var list=this._getHandlerStateList(h,this.states[state]);dojo.forEach(list,function(item){this._revertHandlerItem(item,h);},this);},this);}},revertItem:function(item){var h=this._getHandlerByItem(item);if(h){this._revertHandlerItem(item,h);}},_revertHandlerItem:function(item,_27e0){if(this._hasState(item,this.states["new"])){this._removeState(item,_27e0,this.states["new"]);_27e0.uninitialize(item);}else{this._removeState(item,_27e0,this.states["dirty"]);this._removeState(item,_27e0,this.states["deletedExpl"]);_27e0.restore(item);}},_changeState:function(item,_27e1,state){if(this._hasState(item,state)){return;}switch(state){case this.states["new"]:if(this._hasState(item,this.states["dirty"])||this._hasState(item,this.states["deleted"])){return;}this._addState(item,_27e1,state);return;case this.states["dirty"]:if(this._hasState(item,this.states["new"])||this._hasState(item,this.states["deleted"])){return;}this._addState(item,_27e1,state);break;case this.states["deletedExpl"]:case this.states["deletedImpl"]:this._addState(item,_27e1,state);state=this.states["deleted"];case this.states["deleted"]:this._removeState(item,_27e1,this.states["dirty"]);this._removeState(item,_27e1,this.states["new"]);this._addState(item,_27e1,state);var _27e2=this._depMgr.getTargetsByType(this.getIdentity(item),com.ibm.data.DependencyManager.types["delete"]);dojo.forEach(_27e2,function(_27e3){var _27e4=this.byId(_27e3);this._changeState(_27e4,this._getHandlerByItem(_27e4),this.states["deletedImpl"]);},this);break;case this.states["loaded"]:default:this._addState(item,_27e1,state);}},_removeState:function(item,_27e5,state,_27e6){if(!this._hasState(item,state)){return;}delete item._$.states[state];if(!_27e6){var list=this._getHandlerStateList(_27e5,state);if(list){for(var i=0;i<list.length;i++){if(list[i]==item){list.splice(i,1);}break;}}}switch(state){case this.states["deleted"]:var _27e7=this._depMgr.getTargetsByType(this.getIdentity(item),com.ibm.data.DependencyManager.types["delete"]);dojo.forEach(_27e7,function(_27e8){this._removeState(_27e8,this._getHandlerByItem(_27e8),this.states["deletedImpl"]);},this);break;case this.states["deletedImpl"]:if(!this._hasState(item,this.states["deletedExpl"])){this._removeState(item,_27e5,"deleted");}break;case this.states["deletedExpl"]:if(!this._hasState(item,this.states["deletedImpl"])){this._removeState(item,_27e5,"deleted");}break;default:}},_addState:function(item,_27e9,state){if(this._hasState(item,state)){return;}item._$.states[state]=true;var list=this._getHandlerStateList(_27e9,state);if(list){list.push(item);}},_hasState:function(item,state){if(item._$.states[state]){return true;}return false;},_getHandlerStateList:function(_27ea,state){switch(state){case this.states["new"]:case this.states["dirty"]:case this.states["deletedExpl"]:return _27ea._$.stateLists[state];break;default:return null;}},_cleanList:function(list,state){for(var i=0;i<list.length;i++){if(!this._hasState(list[i],state)){list.splice(i,1);}}return list;},_getHandlerUnSavedStateList:function(_27eb){var arr=[];dojo.forEach(["new","dirty","deletedExpl"],function(st){var list=this._getHandlerStateList(_27eb,this.states[st]);this._cleanList(list,this.states[st]);arr=arr.concat(list);},this);return arr;},_getUnSavedStateList:function(state){var arr=[];for(var _27ec in this._handlers){var h=this._handlers[_27ec];if(state!=null){arr=arr.concat(this._getHandlerStateList(h,state));}else{arr=arr.concat(this._getHandlerUnSavedStateList(h));}}return dojo.filter(arr,function(item){return !this._hasState(item,this.states["saving"]);},this);},isDirty:function(item){if(item&&this._assertItem(item)){return this._hasState(item,this.states["dirty"])||this._hasState(item,this.states["new"])||this._hasState(item,this.states["deleted"]);}else{for(var _27ed in this._handlers){var h=this._handlers[_27ed],l;if((l=this._getHandlerStateList(h,this.states["dirty"])&&l.length>0)||(l=this._getHandlerStateList(h,this.states["deleted"])&&l.length>0)||(l=this._getHandlerStateList(h,this.states["new"])&&l.length>0)){return true;}}return false;}},isCreated:function(item){this._assertItem(item);return !this._hasState(item,this.states["new"]);},_fireCreated:function(item){if(item._$.onCreateDefQueue){item._$.onCreateDefQueue.fire(item);item._$.onCreateDefQueue.destroy();delete item._$.onCreateDefQueue;}},addOnCreate:function(item,_27ee){this._assertItem(item);if(!item._$.onCreateDefQueue){_27ee(item);}else{item._$.onCreateDefQueue.add((new dojo.Deferred()).addCallback(_27ee));}},getUniqueCId:function(){return "cid:"+this._cidCntr++;},registerCId:function(cid,item){this._cidMap[cid]=item;item._$.cid=cid;this.addOnCreate(item,dojo.hitch(this,function(item){var id=this.getIdentity(item);this._toCache(id,item);this._depMgr.updateDependencyId(cid,id);}));},getCId:function(item){this._assertItem(item);return item._$.cid;},byCId:function(cid){return this._cidMap[cid];},seedStore:function(_27ef,_27f0){if(_27ef.id&&!_27ef.scheme){_27ef.scheme=this._getSchemeFromUri(_27ef.id);}var h=this._getHandlerByScheme(_27ef.scheme);_27ef._$seeded=true;var item=this._createItemFromProps(_27ef,_27f0,h);this._toCache(h.getIdentity(item),item);return item;},onDelete:function(_27f1){return _27f1;},onNew:function(_27f2,_27f3){return {newItem:_27f2,parentInfo:_27f3};},onSet:function(item,_27f4,_27f5,_27f6){return {item:item,attribute:_27f4,oldValue:_27f5,newValue:_27f6};}});dojo.declare("com.ibm.data.resolver.Query",null,{url:null,params:null,scheme:"",constructor:function(args){dojo.mixin(this,args);if(this.url){var qi=this.url.indexOf("?");if(qi>-1){this.params=dojo.queryToObject(this.url.substr(qi+1));}}else{this.url="?"+dojo.objectToQuery(this.params);}},param:function(name,_27f7){if(arguments.length>1){this.params[name]=_27f7;this._updateUrl();}else{return this.params[name];}},_updateUrl:function(){var qi=this.url.indexOf("?");if(qi>-1){this.url=this.url.substring(0,qi+1)+dojo.objectToQuery(this.params);}},toString:function(){return this.url;}});dojo.declare("com.ibm.data.SaveList",null,{store:null,list:null,constructor:function(args){this.list=[];dojo.mixin(this,args);},addItem:function(item){var id=this.store.getIdentity(item);if(!this.list[id]){var inf=[item,null];this.list.push(inf);this.list[id]=inf;}},removeItem:function(item){var id=this.store.getIdentity(item);if(this.list[id]){delete this.list[id];for(var i=0,inf;inf=this.list[i],i<this.list.length;i++){if(this.store.getIdentity(inf[0])==id){this.list.splice(i,1);return;}}}},_getInf:function(item){if(this.store.isItem(item)){var id=this.store.getIdentity(item);if(this.list[id]){return this.list[id];}else{return this.list[this.store.getCId(item)];}}else{for(var i=0;i<this.list.length;i++){if(item==this.list[i][0]){return this.list[i];}}return null;}},hasItem:function(item){return this._getInf(item)!=null;},getData:function(item){return this._getInfResource(item,2);},setData:function(item,data){this._setInfResource(item,data,2);},getDataSet:function(items){return this._getInfSet(items,2);},getError:function(item){return this._getInfResource(item,1);},setError:function(item,err){this._setInfResource(item,err,1);},getErrors:function(items){return this._getInfSet(items,1);},_setInfResource:function(item,res,type){var inf=this._getInf(item);if(inf){inf[type]=res;}},_getInfResource:function(item,type){var inf=this._getInf(item);return inf?inf[type]:null;},_getInfSet:function(items,type){var set=[],_27f8=(type==1?"getError":"getData");if(items){dojo.forEach(items,function(item){var res=this[_27f8](item);if(res){set.push(err);}},this);}else{dojo.forEach(this.list,function(inf){if(inf[type]){set.push(inf[type]);}},this);}return set;},destroy:function(){delete this.list;delete this.store;}});}if(!dojo._hasResource["com.ibm.query.TypeHandler"]){dojo._hasResource["com.ibm.query.TypeHandler"]=true;dojo.provide("com.ibm.query.TypeHandler");(function(){var th=com.ibm.query.TypeHandler;var dst=dojo.date.stamp;th.types={"Number":{to:function(value){return value-0;},from:function(value){return value.toString();}},"Date":{to:function(value){return dst.fromISOString(value);},from:function(value){return dst.toISOString(value);}}};th.toType=function(value,type){if(th.types[type]&&dojo.isFunction(th.types[type].to)){return th.types[type].to(value);}else{return value;}};th.fromType=function(value,type){if(th.types[type]&&dojo.isFunction(th.types[type].from)){return th.types[type].from(value);}else{return value;}};})();}if(!dojo._hasResource["com.ibm.query.QueryRuleEngine"]){dojo._hasResource["com.ibm.query.QueryRuleEngine"]=true;dojo.provide("com.ibm.query.QueryRuleEngine");dojo.declare("com.ibm.query.QueryRuleEngine",null,{queryRules:{},context:null,types:{},constructor:function(args){this.context=this;dojo.mixin(this,args);},isReadOnly:function(rule){return rule.readOnly;},toType:function(value,type){if(type){var _27f9=this.extractKeyParts(type),_27fa=_27f9.parameters;type=_27f9.key;if(this.types[type]){return this.types[type].to.call(this.context,value,_27fa);}else{return com.ibm.query.TypeHandler.toType(value,type);}}else{return value;}},fromType:function(value,type){if(type){var _27fb=this.extractKeyParts(type),_27fc=_27fb.parameters;type=_27fb.key;if(this.types[type]){return this.types[type].from.call(this.context,value,_27fc);}else{return com.ibm.query.TypeHandler.fromType(value,type);}}else{return value;}},isParameterizable:function(key){return key.charAt(key.length-1)=="$";},getRulesWithParams:function(map){var _27fd={};if(!map){map=this.queryRules;}for(var key in map){if(this.isParameterizable(key)){_27fd[key]=map[key];}}return _27fd;},getQuery:function(_27fe,map,_27ff){var obj=this.extractKeyParts(_27fe);if(!map){map=this.queryRules;}var rule=map[obj.key];if(!rule){return rule;}if(!obj.parameters){rule.parameters=null;rule.ruleKey=obj.key;rule.multiValued=!!_27ff;return rule;}var _2800={};for(var prop in rule){if(dojo.isString(rule[prop])){_2800[prop]=dojo.string.substitute(rule[prop],obj.parameters,function(part){return dojo.string.trim(part);});}else{_2800[prop]=rule[prop];}}_2800.parameters=obj.parameters;_2800.ruleKey=obj.key;_2800.multiValued=!!_27ff;return _2800;},extractKeyParts:function(_2801){if(this.isParameterizable(_2801)){var start=_2801.indexOf("[");var end=_2801.lastIndexOf("]");if(start>-1&&end>start){var _2802=_2801.substring(0,start)+"$";var parms=_2801.substring(start+1,end).split(",");return {key:_2802,parameters:parms};}}return {key:_2801,parameters:null};},getByRule:function(data,rule,_2803){return data;},setByRule:function(data,rule,value,_2804){if(this.isReadOnly(rule)){return false;}return true;},unsetByRule:function(data,rule,_2805){if(this.isReadOnly(rule)){return false;}return true;}});}if(!dojo._hasResource["com.ibm.data.resolver.QueryRulePocHandler"]){dojo._hasResource["com.ibm.data.resolver.QueryRulePocHandler"]=true;dojo.provide("com.ibm.data.resolver.QueryRulePocHandler");dojo.declare("com.ibm.data.resolver.QueryRulePocHandler",null,{definition:{scheme:"",handleAs:"text",features:{}},queryRules:{},bodyQueryRules:{},customAttributes:{},queryEngineClass:"com.ibm.query.QueryRuleEngine",types:{"Item":{to:function(value){if(value){return this.resolver.byId(value);}return null;},from:function(value){if(this.resolver.isItem(value)){return this.resolver.getIdentity(value);}else{return value;}}},"decodedURI":{to:function(value){return decodeURI(value);},from:function(value){return encodeURI(value);}},"QueryURL$":{to:function(value,_2806){return new com.ibm.data.resolver.Query({url:value,scheme:_2806[0]});},from:function(value,_2807){return value?value.url:"";}},"QueryURL":{to:function(value){return this.types["QueryURL$"].to(value,[this.handler.definition.scheme]);},from:function(value){return this.types["QueryURL$"].from(value,[this.handler.definition.scheme]);}}},constructor:function(_2808,_2809){this.resolver=_2808;this.depMgr=_2809;this.engine=this.buildEngine();},buildEngine:function(){var cls=dojo.getObject(this.queryEngineClass);return new cls({queryRules:this.queryRules,types:this.types,resolver:this.resolver,handler:this});},_getValue:function(item,_280a,_280b,_280c){if(item._unsetAttrs[_280a]){return _280b;}var rule=this.engine.getQuery(_280a,this.customAttributes,_280c);if(rule){return this.customAttributes[_280a].get.call(this,item,_280c,rule.parameters);}else{if(item.data){rule=this.engine.getQuery(_280a,this.queryRules,_280c);if(!rule){return _280b;}var res=this.engine.getByRule(item.data,rule,_280c);if(!res.found){if(item._backupData){res=this.engine.getByRule(item._backupData,rule,_280c);if(res.found){return res.value;}}return _280b;}return res.value;}}return _280b;},getValue:function(item,_280d,_280e){return this._getValue(item,_280d,_280e,false);},getValues:function(item,_280f){return this._getValue(item,_280f,[],true);},getAttributes:function(item){var attrs=[];for(var x in this.queryRules){attrs.push(x);}for(var y in this.customAttributes){attrs.push(y);}return attrs;},hasAttribute:function(item,_2810){if(item._unsetAttrs[_2810]){return false;}var rule=this.engine.getQuery(_2810,this.queryRules);if(!rule){rule=this.engine.getQuery(_2810,this.customAttributes);if(rule){return this.customAttributes[_2810].get.call(this,item,false,rule.parameters)!==undefined;}return false;}var res=this.engine.getByRule(item.data,rule);if(!res.found){return false;}return true;},containsValue:function(item,_2811,value){return dojo.some(this.getValues(item,_2811),function(val){if(val==value){return true;}return false;},this);},getLabel:function(item){var arr=this.getLabelAttributes(item);var str="";for(var i=0;i<arr.length;i++){str+=this.getValue(item,arr[i]);}return str;},getLabelAttributes:function(item){},getIdentity:function(item){var arr=this.getIdentityAttributes(item);var str="";for(var i=0;i<arr.length;i++){str+=this.getValue(item,arr[i]);}return str;},getIdentityAttributes:function(item){},newItem:function(_2812,_2813){},deleteItem:function(item){},_setValue:function(item,_2814,value,_2815){var res=false,rule=this.engine.getQuery(_2814,this.customAttributes,_2815);if(rule){res=this.customAttributes[_2814].set.call(this,item,value,_2815,rule.parameters);}else{if(item.data){rule=this.engine.getQuery(_2814,this.queryRules,_2815);if(!rule){return false;}res=this.engine.setByRule(item.data,rule,value,_2815);}}if(res){delete item._unsetAttrs[_2814];}return res;},setValue:function(item,_2816,value){return this._setValue(item,_2816,value,false);},setValues:function(item,_2817,_2818){return this._setValue(item,_2817,_2818,true);},unsetAttribute:function(item,_2819){var rule=this.engine.getQuery(_2819,this.queryRules);if(!rule){rule=this.engine.getQuery(_2819,this.customAttributes);return false;}var res=this.engine.unsetByRule(item.data,rule);if(res){item._unsetAttrs[_2819]=true;}return res;},backup:function(item){if(!item._backupData){}return false;},restore:function(item){if(item._backupData){}return false;},persist:function(item){delete item._backupData;},modifyFetchQuery:function(query){return query;},dataToItem:function(data){var item=this.createStub({});item.data=data;return item;},processFetch:function(data,_281a){},processSave:function(item){this.updateReferences(item);},updateReferences:function(item){},createStub:function(_281b){var stub={toString:function(){return this.id;},data:_281b.data,id:_281b.id,_unsetAttrs:{},_writeLog:[],_cachedMeta:{}};this.resolver._toCache(stub.id,stub);return stub;},uninitialize:function(item){delete item.id;delete item._unsetAttrs;delete item._cachedMeta;delete item._backupData;delete item._writeLog;delete item.data;},destroy:function(){delete this.resolver;delete this.depMgr;delete this.engine;},_makeModifiable:function(item){},toString:function(){return "["+this.declaredClass+" - "+this.definition.scheme+"]";}});}if(!dojo._hasResource["com.ibm.query.XmlQueryRuleEngine"]){dojo._hasResource["com.ibm.query.XmlQueryRuleEngine"]=true;dojo.provide("com.ibm.query.XmlQueryRuleEngine");dojo.declare("com.ibm.query.XmlQueryRuleEngine",[com.ibm.query.QueryRuleEngine,com.ibm.xml.SimpleXmlAccessor],{queryRules:{},getField:function(_281c,field,_281d){var _281e=this._mapField(field),_281f=field?field.substr(1):null,value=_281c;if(_281e){value=dojo.map(_281d?_281c:_281c.slice(0,1),function(data){return this[_281e](data,_281f);},this);}if(!_281d){value=value[0];}return value;},setField:function(_2820,field,value,_2821){var _2822=this._mapField(field),_2823=field?field.substr(1):null;if(!_2822){dojo.map(_2820,function(data){this.replace(data,value);},this);}else{dojo.map(_2820,function(data){this[_2822](data,_2823,value);},this);}return true;},unsetField:function(_2824,field,_2825){var _2826=null,_2827=field.substr(1);switch(_2825.charAt(0)){case "!":_2826="remove";break;default:switch(_2827.charAt(0)){case "$":_2826="removeProp";break;case "@":_2826="removeAttr";break;default:_2826="remove";break;}}_2824[_2826](_2827);return true;},getByRule:function(data,rule,_2828){var ret={found:false};var _2829=this.evaluate(rule.selector,data,!_2828);if(_2829.length==0){return ret;}ret.found=true;var _282a=this.getField(_2829,rule.field,_2828);if(_2828){ret.value=dojo.map(_282a,function(fRes){return this.toType(fRes,rule.type);},this);}else{ret.value=this.toType(_282a,rule.type);}if(ret.value===undefined){ret.found=false;}return ret;},setByRule:function(data,rule,value,_282b){if(this.isReadOnly(rule)){return false;}if(_282b){value=dojo.map(value,function(val){return this.fromType(val,rule.type);},this);}else{value=this.fromType(value,rule.type);}if((rule.deferSet||(_282b&&rule.deferMultiValued))&&rule.setter){return rule.setter.call(this.context,data,rule,value,_282b);}var _282c=this.evaluate(rule.selector,data,!_282b);if(_282c.length==0){if(rule.setter){return rule.setter.call(this.context,data,rule,value,_282b);}return false;}return this.setField(_282c,rule.field,value,_282b);},unsetByRule:function(data,rule){if(this.isReadOnly(rule)){return false;}var _282d=this.select(rule.selector,data,true);if(_282d.length==0){return true;}return this.unsetField(_282d,rule.field,rule.unset);},_mapField:function(field){if(field){switch(field.charAt(0)){case "$":return "prop";case "@":return "attr";default:return null;}}else{return null;}}});}if(!dojo._hasResource["com.ibm.data.resolver.XmlPocHandler"]){dojo._hasResource["com.ibm.data.resolver.XmlPocHandler"]=true;dojo.provide("com.ibm.data.resolver.XmlPocHandler");dojo.declare("com.ibm.data.resolver.XmlPocHandler",[com.ibm.data.resolver.QueryRulePocHandler,com.ibm.data.TemplateInstantiator],{definition:{scheme:"",handleAs:"xml",features:{}},namespaces:{},queryEngineClass:"com.ibm.query.XmlQueryRuleEngine",constructor:function(){this.namespaces=dojo.mixin({},this.namespaces,this.resolver.getNamespaces());this.engine.namespaces=this.namespaces;this._createTemplates();},_createTemplates:function(){},syncNamespaces:function(node){var myNs=this.namespaces;dojo.forEach(node.ownerDocument.documentElement.attributes,function(_282e){var idx=_282e.nodeName.indexOf("xmlns:");if(idx==0){var _282f=_282e.nodeName.substr(6);if(myNs[_282f]!=_282e.nodeValue){myNs[_282f]=_282e.nodeValue;}}});},setValue:function(item,_2830,value){var res=this.inherited(arguments);if(res){this._logWrite(item,{attribute:_2830,value:value});}return res;},setValues:function(item,_2831,_2832){var res=this.inherited(arguments);if(res){this._logWrite(item,{attribute:_2831,values:_2832});}return res;},unsetAttribute:function(item,_2833){var res=this.inherited(arguments);if(res){this._logWrite(item,{attribute:_2833});}return res;},newItem:function(_2834,_2835){this.modifyNewItemArgs(_2834,_2835);return this.createItem(_2834,_2835);},createItem:function(_2836,_2837){var _2838=_2836._$seeded;delete _2836._$seeded;var _2839=null;if(_2836.id){_2839=this.resolver._fromCache(_2836.id);if(_2839&&_2839.data){for(var p in _2836){this[dojo.isArray(_2836[p])?"setValues":"setValue"](_2839,p,_2836[p]);}return _2839;}}var _283a=this.getTemplate(_2836,_2837);_2836=dojo.mixin({},_283a.templateProps,_2836);var _283b=this.instantiateTemplate(_283a,_2836,_2837);var _283c=_2839?_2839:this.createStub(_2836);_283c.data=_283b;_283c._logEnabled=!_2838;return this.fillInProperties(_283c,_283a,_2836,_2837);},fillInProperties:function(_283d,_283e,_283f,_2840){for(var p in _283f){if(!(p in _283e.templateProps)){this[dojo.isArray(_283f[p])?"setValues":"setValue"](_283d,p,_283f[p]);}}return _283d;},getTemplate:function(args,_2841){return {templateString:"",templateProps:{}};},modifyNewItemArgs:function(args,_2842){return args;},instantiateTemplate:function(_2843,args,_2844){return this.getTemplateInstance(_2843.templateString,args);},backup:function(item){if(!item._backupData){item._backupData=item.data.cloneNode(true);this._makeModifiable(item);item._logEnabled=true;return true;}return false;},restore:function(item){if(item._backupData){delete item.data;item.data=item._backupData;delete item._backupData;item._writeLog.splice(0,item._writeLog.length);return true;}return false;},persist:function(item){this._writeLogToBackup(item);this.inherited(arguments);},processFetch:function(_2845,_2846){return this.inherited(arguments);},processSave:function(item){return this.inherited(arguments);},_logWrite:function(item,map){if(item._logEnabled){item._writeLog.push(map);}},_writeLogToBackup:function(item){if(item._backupData){item.data=item._backupData;item._logEnabled=false;for(var i=0;i<item._writeLog.length;i++){var op=item._writeLog[i];if(op.values){this.setValues(item,op.attribute,op.values);}else{if(op.value!==undefined){this.setValue(item,op.attribute,op.value);}else{this.unsetValue(item,op.attribute);}}}item._writeLog.splice(0,item._writeLog.length);}}});}if(!dojo._hasResource["com.ibm.query.rules.Atom"]){dojo._hasResource["com.ibm.query.rules.Atom"]=true;dojo.provide("com.ibm.query.rules.Atom");com.ibm.query.rules.Atom={namespaces:{"atom":"http://www.w3.org/2005/Atom","app":"http://www.w3.org/2007/app"},syndication:{mimeTypes:{atom:"application/atom+xml"},common:{title:{selector:"./atom:title",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:title",children:[value]});return true;}},id:{selector:"./atom:id",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:id",children:[value]});return true;}},updated:{selector:"./atom:updated",field:"$textContent",type:"Date"},category:{selector:"./atom:category",field:"@term"},categoryScheme:{selector:"./atom:category",field:"@scheme"},categoryLabel:{selector:"./atom:category",field:"@label"},contributer:{selector:"./atom:contributer",type:"Node"},author:{selector:"./atom:author",type:"Node"},summary:{selector:"./atom:summary",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:summary",children:[value]});return true;}},source:{selector:"./atom:source",type:"Node",setter:function(data,rule,value){data.appendChild(value);return true;}},rights:{selector:"./atom:rights",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:rights",children:[value]});return true;}},selfLink:{selector:"./atom:link[@rel='self']",field:"@href",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:link",attributes:{"rel":"self","href":value}});return true;}},link:{selector:"./atom:link[@href]",field:"@href",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:link",attributes:{"href":value}});return true;}},content:{selector:"./atom:content",type:"Node",setter:function(data,rule,value){data.appendChild(value);return true;}}},entry:{subtitle:{selector:"./atom:subtitle",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:subtitle",children:[value]});return true;}},generator:{selector:"./atom:generator",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:generator",children:[value]});return true;}},icon:{selector:"./atom:icon",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:icon",children:[value]});return true;}},logo:{selector:"./atom:logo",field:"$textContent",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:logo",children:[value]});return true;}}}},publishing:{mimeTypes:{service:"application/atomsvc+xml",contentTypeReg:"application/atomcat+xml"},serviceDoc:{workspace:{selector:"./app:workspace",type:"Node"},workspaceTitle:{selector:"./app:workspace/atom:title",field:"$textContent"}},categoriesDoc:{category:{selector:"./app:categories/atom:category",type:"Node"},categoryTerm:{selector:"./app:categories/atom:category",field:"@term"},categoryScheme:{selector:"../app:categories",field:"@scheme"},categoriesScheme:{selector:"./app:categories",field:"@scheme"},categoriesFixed:{selector:"./app:categories",field:"@fixed"},categoriesLink:{selector:"./app:categories",field:"@href"}},member:{selector:"./app:collection/app:member",type:"Node"}}};(function(){var _2847=com.ibm.query.rules.Atom.syndication.common;var _2848=function(_2849,data,rule,value,_284a){var _284b={name:"atom:category",attributes:{}};var _284c=this.select(_284b.name,data,_284a);if(_284a){var i=0;for(;i<_284c.length&&i<value.length;i++){this.attr(_284c[i],_2849,value[i]);}if(i<value.length){for(;i<value.length;i++){_284b.attributes[_2849]=value[i];this.createFromJson(data,_284b);}}}else{if(_284c.length>0){this.attr(_284c[0],_2849,value);}else{_284b.attributes[_2849]=value;this.createFromJson(data,_284b);}}return true;};_2847.category.setter=dojo.partial(_2848,"term");_2847.categoryScheme.setter=dojo.partial(_2848,"scheme");_2847.categoryLabel.setter=dojo.partial(_2848,"label");})();if(!(dojo.isIE||window.ActiveXObject!==undefined)){com.ibm.query.rules.Atom.namespaces["xml"]="http://www.w3.org/XML/1998/namespace";}}if(!dojo._hasResource["com.ibm.data.resolver.AtomPocHandler"]){dojo._hasResource["com.ibm.data.resolver.AtomPocHandler"]=true;dojo.provide("com.ibm.data.resolver.AtomPocHandler");dojo.declare("com.ibm.data.resolver.AtomPocHandler",com.ibm.data.resolver.XmlPocHandler,{queryRules:dojo.mixin({},com.ibm.query.rules.Atom.syndication.common,com.ibm.query.rules.Atom.syndication.entry),bodyQueryRules:dojo.mixin({},com.ibm.query.rules.Atom.syndication.common),namespaces:{"atom":"http://www.w3.org/2005/Atom"},mergeItems:function(_284d,_284e){if(this.resolver.isDirty(_284e)){_284e._backupData=_284d.data;}else{_284e.data=_284d.data;}return _284e;},processEntryData:function(_284f){var _2850=this.dataToItem(_284f);var _2851=this.getIdentity(_2850);var _2852=this.resolver._fromCache(_2851);if(_2852){_2850=this.mergeItems(_2850,_2852);}return _2850;},parseFeed:function(_2853,_2854){var items=[],root=null,_2855=this.engine.evaluate("/atom:feed",_2854,true);if(_2855.length==0){_2855=this.engine.evaluate("/atom:entry",_2854);if(_2855.length==0){throw new Error(this.resolver.fmt("errorDataFormat"));}else{root=_2855[0];items.push(this.processEntryData(root));}}else{root=_2855[0];_2855=this.engine.evaluate("./atom:entry",root);dojo.forEach(_2855,function(entry){items.push(this.processEntryData(entry));},this);}return {items:items,root:root};},processFetch:function(_2856,_2857){var _2858=this.parseFeed(_2857,_2856),meta={root:_2858.root,resultSize:_2858.items.length};if(!this._nsSynced){this.syncNamespaces(_2858.root);this._nsSynced=true;}dojo.forEach(_2858.items,function(item){item._cachedMeta.requestMeta=meta;},this);return {items:_2858.items,meta:meta};},processSave:function(item){this.inherited(arguments);var args={data:this._serializeSaveData(item),headers:{},handleAs:dojo.isIE||window.ActiveXObject!==undefined?"text":this.definition.handleAs};args.headers[this.resolver.headers.CONTENT_TYPE]="application/atom+xml";if(!this.resolver.isCreated(item)){args.load=dojo.hitch(this,function(_2859,_285a){if(dojo.isIE||window.ActiveXObject!==undefined){_2859=com.ibm.portal.xslt.loadXmlString(_2859);}var _285b=this.engine.evaluate("//atom:entry",_2859);var cid=this.getIdentity(item);if(_285b&&_285b.length>0){item.data=_285b[0];item.cid=item.id;delete item.id;var genId=this.getIdentity(item);}return _2859;});}args.query=this.getSaveQuery(item);return args;},_serializeSaveData:function(item){return com.ibm.domUtilities.stringFromDoc(item.data);},getSaveQuery:function(item){var q={uri:this.getIdentity(item)};if(this.resolver.isCreated(item)){q.mode="merge";}return q;},getLabel:function(item){return this.getValue(item,"title");},getLabelAttributes:function(item){return ["title"];},getIdentity:function(item){if(!item.id){item.id=this.getValue(item,"id");}return item.id;},getIdentityAttributes:function(item){return ["id"];},instantiateTemplate:function(_285c,args,_285d){var _285e=this.inherited(arguments);var nodes=this.engine.evaluate("//atom:entry",_285e);if(nodes&&nodes.length>0){_285e=nodes[0];}return _285e;}});(function(){var prot=com.ibm.data.resolver.AtomPocHandler.prototype;prot.queryRules.selfLink=dojo.mixin({},prot.queryRules.selfLink,{type:"QueryURL"});})();}if(!dojo._hasResource["com.ibm.query.rules.OpenSearch"]){dojo._hasResource["com.ibm.query.rules.OpenSearch"]=true;dojo.provide("com.ibm.query.rules.OpenSearch");com.ibm.query.rules.OpenSearch={namespaces:dojo.mixin({},com.ibm.query.rules.Atom.namespaces,{"os":"http://a9.com/-/spec/opensearch/1.1/"}),common:{nextLink:{selector:"./atom:link[@rel='next']",field:"@href"},startIndex:{selector:"./os:startIndex",field:"$textContent",type:"Number"},itemsPerPage:{selector:"./os:itemsPerPage",field:"$textContent",type:"Number"},totalResults:{selector:"./os:totalResults",field:"$textContent",type:"Number"},query:{selector:"./os:Query",type:"Node"}}};}if(!dojo._hasResource["com.ibm.data.resolver.OpenSearchPocHandler"]){dojo._hasResource["com.ibm.data.resolver.OpenSearchPocHandler"]=true;dojo.provide("com.ibm.data.resolver.OpenSearchPocHandler");dojo.declare("com.ibm.data.resolver.OpenSearchPocHandler",com.ibm.data.resolver.AtomPocHandler,{bodyQueryRules:dojo.mixin({},com.ibm.data.resolver.AtomPocHandler.prototype.bodyQueryRules,com.ibm.query.rules.OpenSearch.common),namespaces:dojo.mixin({},com.ibm.data.resolver.AtomPocHandler.prototype.namespaces,com.ibm.query.rules.OpenSearch.namespaces),processFetch:function(_285f,_2860){var _2861=this.inherited(arguments);_2861.meta.resultSize=this.engine.getByRule(_2861.meta.root,this.bodyQueryRules["totalResults"]).value;_2860.nextQuery=_2861.meta.nextURL=this.engine.getByRule(_2861.meta.root,this.bodyQueryRules["nextLink"]).value;_2860.startIndex=_2861.meta.startIndex=this.engine.getByRule(_2861.meta.root,this.bodyQueryRules["startIndex"]).value;_2860.itemsPerPage=_2861.meta.itemsPerPage=this.engine.getByRule(_2861.meta.root,this.bodyQueryRules["itemsPerPage"]).value;return _2861;}});(function(){var prot=com.ibm.data.resolver.OpenSearchPocHandler.prototype;prot.bodyQueryRules.nextLink=dojo.mixin({},prot.bodyQueryRules.nextLink,{type:"QueryURL"});})();}if(!dojo._hasResource["com.ibm.data.resolver.ResolverQueryRules"]){dojo._hasResource["com.ibm.data.resolver.ResolverQueryRules"]=true;dojo.provide("com.ibm.data.resolver.ResolverQueryRules");com.ibm.data.resolver.ResolverQueryRules={namespaces:dojo.mixin({},com.ibm.query.rules.OpenSearch.namespaces,{"xsl":"http://www.w3.org/1999/XSL/Transform","thr":"http://purl.org/syndication/thread/1.0","xhtml":"http://www.w3.org/1999/xhtml","service":"http://www.ibm.com/xmlns/prod/sw/model/service/1.0","ac":"http://www.ibm.com/xmlns/prod/lotus/access-control/v1.0","trc":"http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-tag-rate-comment","cp":"http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal","um":"http://www.ibm.com/xmlns/prod/websphere/um.xsd","xs":"http://www.w3.org/2001/XMLSchema-datatypes","xsi":"http://www.w3.org/2001/XMLSchema-instance"}),atom:{modelExt:{modelNodeType:{selector:"./atom:content/*",field:"$localName",readOnly:true}},uniqueNameExt:{uniqueName:{selector:"./atom:id",field:"@ext:uniquename",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:id",attributes:{"ext:uniquename":value}});return true;}}},threadExt:{parent:{selector:"./thr:in-reply-to",field:"@ref",type:"Item"},parentId:{selector:"./thr:in-reply-to",field:"@ref"},parentURI:{selector:"./thr:in-reply-to",field:"@href",type:"QueryURL"}},treeExt:{childrenURI:{selector:"./atom:link[@rel='replies']",field:"@href",readOnly:true,type:"QueryURL"},next:{selector:"./atom:link[@rel='next']",field:"@ext:uri",type:"Item",unset:"!"},nextId:{selector:"./atom:link[@rel='next']",field:"@ext:uri",unset:"!"},nextURI:{selector:"./atom:link[@rel='next']",field:"@href",unset:"!",type:"QueryURL"}},L10nExt:{localizedTitle$:{selector:"./atom:content/*[model:title]/model:title/base:nls-string["+(dojo.isIE||window.ActiveXObject!==undefined?"@xml:lang = '${0}'":"lang('${0}')")+"]",field:"$textContent",locale:"${0}"},localizedDescription$:{selector:"./atom:content/*[model:description]/model:description/base:nls-string["+(dojo.isIE||window.ActiveXObject!==undefined?"@xml:lang = '${0}'":"lang('${0}')")+"]",field:"$textContent",locale:"${0}"}},acExt:{userOwned:{selector:"./atom:content/*/ac:allowed-access",field:"@ac:user-owned",readOnly:true},isPrivate:{selector:"./atom:content/*/ac:allowed-access",field:"@ac:private",readOnly:true},accessLevel:{selector:"./atom:content/*/ac:allowed-access/ac:access-level",field:"@ac:type"},accessLevel$:{selector:"./atom:content/*/ac:allowed-access/ac:access-level[@ac:type='${0}']",field:"@ac:type",acType:"${0}"}},operationsExt:{contextMenu:{selector:"./atom:link[@ext:rel='contextMenu']",field:"@ext:uri",readOnly:true},contextMenuURI:{selector:"./atom:link[@ext:rel='contextMenu']",field:"@href",readOnly:true}},contentExt:{layoutURI:{selector:"./atom:link[@ext:rel='layout']",field:"@href",type:"QueryURL[lm]$",readOnly:true},theme:{selector:"./atom:link[@ext:rel='theme']",field:"@ext:uri",setter:function(data,rule,value){this.createFromJson(data,{name:"atom:link",attributes:{"ext:rel":"theme","ext:uri":value,"href":value}});return true;}}},cpExt:{cpScope:{selector:"./atom:id",field:"@cp:scope"},resource:{selector:"./atom:link[@portal:rel]",field:"@href",setter:null},uri:{selector:"./atom:link",field:"@portal:uri"},count:{selector:"./atom:link",field:"@thr:count"},isMine:{selector:"./atom:link",field:"@thr:isMine"},deleteLink:{selector:"./atom:link[@ext:rel='tagfeed']",field:"@href"},deleteAllLink:{selector:"./atom:link[@portal:rel='managerDelete']",field:"@href"}},metaExt:{metadata$:{selector:"./atom:content/*/model:metadata[@name='${0}']/base:value",field:"@value",mdname:"${0}",deferSet:true,setter:function(data,rule,value,_2862){var _2863={name:"base:value",attributes:{"xsi:type":"base:String"}};var _2864=this.select("./atom:content/*",data,true);var _2865=_2864.select("model:metadata[@name='"+rule.mdname+"']",true);if(_2865.length==0){_2864.createFromJson({name:"model:metadata",attributes:{"name":rule.mdname}});}_2865=_2864.select("model:metadata[@name='"+rule.mdname+"']",true);_2865.select("*").destroy();if(_2862){dojo.forEach(value,function(val){_2863.attributes.value=val;_2865.createFromJson(_2863);},this);}else{_2863.attributes.value=value;_2865.createFromJson(_2863);}return true;}}}}};(function(){var _2866=com.ibm.data.resolver.ResolverQueryRules.atom;var _2867=function(data,rule,value,_2868){var _2869=this.select(rule.selector,data,false);if(_2869.length==0){this.createFromJson(data,{name:"thr:in-reply-to",attributes:{"ext:uri":value,"type":"application/atom+xml","ref":value,"href":value}});}else{_2869.attr("ext:uri",value).attr("ref",value).attr("href",value);}return true;};_2866.threadExt.parent.setter=_2867;_2866.threadExt.parentId.setter=_2867;_2866.threadExt.parentURI.setter=_2867;_2866.threadExt.parent.deferSet=true;_2866.threadExt.parentId.deferSet=true;_2866.threadExt.parentURI.deferSet=true;var _286a=function(data,rule,value){var attrs={"ext:uri":value,"rel":"next","type":"application/atom+xml"};attrs[rule.field.substr(1)]=value;this.createFromJson(data,{name:"atom:link",attributes:attrs});return true;};_2866.treeExt.next.setter=_286a;_2866.treeExt.nextId.setter=_286a;_2866.treeExt.nextURI.setter=_286a;var _286b=function(_286c,data,rule,value){var _286d=this.select("./atom:content/*",data,true);var _286e=_286d.select("model:title",true);var _286f={name:"base:nls-string",attributes:{"xml:lang":rule.locale},children:[value]};if(_286e.length==0){_286d.createFromJson({name:_286c,children:[_286f]});}else{_286e.createFromJson(_286f);}return true;};_2866.L10nExt.localizedTitle$.setter=dojo.partial(_286b,"model:title");_2866.L10nExt.localizedDescription$.setter=dojo.partial(_286b,"model:description");var _2870=function(_2871,data,rule,value,_2872){var attrs={};attrs[rule.field.substr(1)]=value;this.createFromJson(item.data,{name:_2871,attributes:attrs});return true;};_2866.cpExt.cpScope.setter=dojo.partial(_2870,"atom:id");_2866.cpExt.uri.setter=dojo.partial(_2870,"atom:link");_2866.cpExt.count.setter=dojo.partial(_2870,"atom:link");_2866.cpExt.isMine.setter=dojo.partial(_2870,"atom:link");}());}if(!dojo._hasResource["com.ibm.data.resolver.LanguageListPocHandler"]){dojo._hasResource["com.ibm.data.resolver.LanguageListPocHandler"]=true;dojo.provide("com.ibm.data.resolver.LanguageListPocHandler");dojo.declare("com.ibm.data.resolver.LanguageListPocHandler",[com.ibm.data.resolver.OpenSearchPocHandler],{namespaces:dojo.mixin({},com.ibm.data.resolver.OpenSearchPocHandler.prototype.namespaces,com.ibm.data.resolver.ResolverQueryRules.namespaces)});(function(){var r=com.ibm.data.resolver,_2873=r.LanguageListPocHandler,prot=_2873.prototype,def=prot.definition,_2874=r.ResolverQueryRules.atom;def=dojo.mixin({},def,{scheme:"ll"});prot.definition=def;dojo.extend(_2873,{queryRules:dojo.mixin({},r.OpenSearchPocHandler.prototype.queryRules,_2874.L10nExt,_2874.modelExt,{locale:{selector:"./atom:content/*[model:locale]/model:locale",field:"$textContent",readOnly:true}})});com.ibm.data.Resolver.register(def.scheme,_2873);})();}if(!dojo._hasResource["com.ibm.widgets._Traceable"]){dojo._hasResource["com.ibm.widgets._Traceable"]=true;dojo.provide("com.ibm.widgets._Traceable");dojo.declare("com.ibm.widgets._Traceable",[],{LOGGER:null,LOG_LEVEL:null,_traceChecker:null,_isSimpleLogging:false,_isLoggable:false,isTracing:function(){var _2875=false;if(this._isSimpleLogging){if(this._isLoggable){_2875=true;}}else{_2875=this.LOGGER.isLoggable(this.LOG_LEVEL);}return _2875;},traceEntry:function(_2876,args){if(this._isSimpleLogging){if(this._isLoggable){var msg=" ENTRY";var _2877="";if(args||(args===0)||(args===null)||(args==="")){if(!dojo.isArray(args)){_2877=args;}else{if(args&&args.length>0){for(arg in args){if(_2877===""){_2877=_2877+args[arg];}else{_2877=_2877+", "+args[arg];}}}}msg=msg+" [ "+_2877+" ]";}window.console.log(this.declaredClass+" "+_2876+msg);}}else{var _2878=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_2878){this.LOGGER.entering(_2876,args);}}},traceExit:function(_2879,_287a){if(this._isSimpleLogging){if(this._isLoggable){if(_287a||(_287a===0)||(_287a===null)||(_287a==="")){window.console.log(this.declaredClass+" "+_2879+" EXIT [ "+_287a+" ]");}else{window.console.log(this.declaredClass+" "+_2879+" EXIT");}}}else{var _287b=this.LOGGER.isLoggable(this.LOG_LEVEL);if(_287b){if(typeof _287a==="boolean"){_287a=_287a?"true":"false";}this.LOGGER.exiting(_2879,_287a);}}},trace:function(_287c,_287d,args){var _287e=this.isTracing();if(_287e){var msg=_287d;var _287f="";if(args||(args===0)||(args===null)||(args==="")){if(!dojo.isArray(args)){_287f=args;}else{if(args&&args.length>0){for(arg in args){if(_287f===""){_287f=_287f+args[arg];}else{_287f=_287f+", "+args[arg];}}}}msg=msg+" [ "+_287f+" ]";}if(this._isSimpleLogging){window.console.log(this.declaredClass+" "+_287c+" : "+msg);}else{this.LOGGER.log(this.LOG_LEVEL,_287c,msg);}}},isLoggable:function(){if(!(ibmCfg&&ibmCfg.enablerConfig&&ibmCfg.enablerConfig.isDebug)){return false;}else{var _2880=this._traceChecker;return _2880&&_2880.test(this.declaredClass);}},_initConfig:function(_2881){if(_2881&&_2881.length>0){this._traceChecker=new RegExp(dojo.isArray(_2881)?_2881.join("|"):_2881);}else{this._traceChecker=null;}},constructor:function(){if(dojo.exists("com.ibm.mashups.enabler.logging.Logger")){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this._isSimpleLogging=false;this.LOG_LEVEL=com.ibm.mashups.enabler.logging.LogLevel.TRACE;}else{this._initConfig(ibmCfg&&ibmCfg.enablerConfig&&ibmCfg.enablerConfig.traceConfig);this._isSimpleLogging=true;this._isLoggable=this.isLoggable();}}});}if(!dojo._hasResource["com.ibm.widgets.DoneCheckDialog"]){dojo._hasResource["com.ibm.widgets.DoneCheckDialog"]=true;dojo.provide("com.ibm.widgets.DoneCheckDialog");dojo.declare("com.ibm.widgets.DoneCheckDialog",[dijit._Widget,dijit._Templated,dijit.Dialog,com.ibm.widgets._Traceable],{bIsTracing:false,bundle:null,blankImg:dojo.moduleUrl("dojo","resources/blank.gif").toString(),parentWidget:null,callbackOnYes:null,templateString:null,templateString:"<div class=\"lotusDialogBorder lotusui\" waistate=\"labelledby-${id}\" wairole=\"dialog\" role=\"dialog\" index=\"-1\" aria-labelledby=\"${id}\" dojoAttachPoint=\"dialogDiv\">\n    <div class=\"lotusDialog\">\n\t    <h1>\n\t        <a href=\"javascript:void(0);\" dojoAttachPoint=\"closeButtonNode\" class=\"lotusBtnImg lotusClose\" title=\"${bundle.title_click_to_close}\">\n\t\t        <img src=\"${blankImg}\" alt=\"\" aria-label=\"${bundle.title_close}\" />\n\t\t\t    <span class=\"lotusAltText\">X</span>\n\t\t    </a>\n\t\t    <span dojoAttachPoint=\"titleNode\">${bundle.text_are_you_sure}</span>\n\t    </h1>\n\t\t<form dojoAttachPoint=\"newPageForm\" action=\"javascript:;\">\n\t\t\t<div dojoAttachPoint=\"containerNode\" class=\"lotusDialogContent\">\n            \t${bundle.text_want_to_close_without_saving}\n\t\t\t</div>\n\t\t    <div class=\"lotusDialogFooter\" dojoAttachPoint=\"dialogFooter\">\n\t\t       \t<input value=\"${bundle.button_yes}\" class=\"lotusFormButton\" dojoAttachPoint=\"submitDialog\" type=\"submit\"/>\n\t\t\t\t<a href=\"javascript:void(0);\" class=\"lotusAction\" dojoAttachPoint=\"dialogCancel\">${bundle.link_no}</a>\n\t\t    </div>\n\t\t</form>\n    </div>\n</div>\n",constructor:function(){this.inherited("constructor","com.ibm.widgets.DoneCheckDialog");},postMixInProperties:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","DoneCheckDialog");},postCreate:function(){var m="postCreate()";this.traceEntry(m);this.inherited(arguments);this.submitDialog.onclick=dojo.hitch(this,function(){this.submit();return false;});this.dialogCancel.onclick=dojo.hitch(this,function(){this.cancelDialog();return false;});this.closeButtonNode.onclick=dojo.hitch(this,function(){this.cancelDialog();return false;});this.traceExit(m);},setCloseCallback:function(_2882){var m="setCloseCallback(method)";this.traceEntry(m);this.callbackOnYes=_2882;this.traceExit(m);},setLoadDataCallback:function(_2883){var m="setLoadDataCallback(method)";this.traceEntry(m);this.callbackOnNo=_2883;this.traceExit(m);},submit:function(){var m="submit()";this.traceEntry(m);this.hide();this.destroy();if(this.callbackOnYes){this.callbackOnYes();}this.traceExit(m);},cancelDialog:function(){var m="cancel()";this.traceEntry(m);this.hide();this.traceExit(m);},_getFocusItems:function(_2884){var _2885=this.containerNode;this.containerNode=_2884;this.inherited(arguments);this.containerNode=_2885;}});}if(!dojo._hasResource["dijit.Tooltip"]){dojo._hasResource["dijit.Tooltip"]=true;dojo.provide("dijit.Tooltip");dojo.declare("dijit._MasterTooltip",[dijit._Widget,dijit._Templated],{duration:dijit.defaultDuration,templateString:dojo.cache("dijit","templates/Tooltip.html","<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\">\n\t<div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" waiRole='alert'></div>\n\t<div class=\"dijitTooltipConnector\"></div>\n</div>\n"),postCreate:function(){dojo.body().appendChild(this.domNode);this.bgIframe=new dijit.BackgroundIframe(this.domNode);this.fadeIn=dojo.fadeIn({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onShow")});this.fadeOut=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onHide")});},show:function(_2886,_2887,_2888){if(this.aroundNode&&this.aroundNode===_2887){return;}if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_2886;this.domNode.style.top=(this.domNode.offsetTop+1)+"px";var pos=dijit.placeOnScreenAroundElement(this.domNode,_2887,dijit.getPopupAroundAlignment((_2888&&_2888.length)?_2888:dijit.Tooltip.defaultPosition,this.isLeftToRight()),dojo.hitch(this,"orient"));dojo.style(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_2887;},orient:function(node,_2889,_288a){node.className="dijitTooltip "+{"BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_2889+"-"+_288a];},_onShow:function(){if(dojo.isIE){this.domNode.style.filter="";}},hide:function(_288b){if(this._onDeck&&this._onDeck[1]==_288b){this._onDeck=null;}else{if(this.aroundNode===_288b){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}}});dijit.showTooltip=function(_288c,_288d,_288e){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.show(_288c,_288d,_288e);};dijit.hideTooltip=function(_288f){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.hide(_288f);};dojo.declare("dijit.Tooltip",dijit._Widget,{label:"",showDelay:400,connectId:[],position:[],constructor:function(){this._nodeConnectionsById={};},_setConnectIdAttr:function(_2890){for(var oldId in this._nodeConnectionsById){this.removeTarget(oldId);}dojo.forEach(dojo.isArrayLike(_2890)?_2890:[_2890],this.addTarget,this);},_getConnectIdAttr:function(){var ary=[];for(var id in this._nodeConnectionsById){ary.push(id);}return ary;},addTarget:function(id){var node=dojo.byId(id);if(!node){return;}if(node.id in this._nodeConnectionsById){return;}this._nodeConnectionsById[node.id]=[this.connect(node,"onmouseenter","_onTargetMouseEnter"),this.connect(node,"onmouseleave","_onTargetMouseLeave"),this.connect(node,"onfocus","_onTargetFocus"),this.connect(node,"onblur","_onTargetBlur")];if(dojo.isIE&&!node.style.zoom){node.style.zoom=1;}},removeTarget:function(node){var id=node.id||node;if(id in this._nodeConnectionsById){dojo.forEach(this._nodeConnectionsById[id],this.disconnect,this);delete this._nodeConnectionsById[id];}},postCreate:function(){dojo.addClass(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;dojo.forEach(dojo.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onTargetMouseEnter:function(e){this._onHover(e);},_onTargetMouseLeave:function(e){this._onUnHover(e);},_onTargetFocus:function(e){this._focus=true;this._onHover(e);},_onTargetBlur:function(e){this._focus=false;this._onUnHover(e);},_onHover:function(e){if(!this._showTimer){var _2891=e.target;this._showTimer=setTimeout(dojo.hitch(this,function(){this.open(_2891);}),this.showDelay);}},_onUnHover:function(e){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_2892){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}dijit.showTooltip(this.label||this.domNode.innerHTML,_2892,this.position);this._connectNode=_2892;this.onShow(_2892,this.position);},close:function(){if(this._connectNode){dijit.hideTooltip(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(_2893,_2894){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});dijit.Tooltip.defaultPosition=["after","before"];}if(!dojo._hasResource["dijit.form.ValidationTextBox"]){dojo._hasResource["dijit.form.ValidationTextBox"]=true;dojo.provide("dijit.form.ValidationTextBox");dojo.declare("dijit.form.ValidationTextBox",dijit.form.TextBox,{templateString:dojo.cache("dijit.form","templates/ValidationTextBox.html","<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\"\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\" waiRole=\"presentation\"\n\t><div style=\"overflow:hidden;\"\n\t\t><div class=\"dijitReset dijitValidationIcon\"><br></div\n\t\t><div class=\"dijitReset dijitValidationIconText\">&Chi;</div\n\t\t><div class=\"dijitReset dijitInputField\"\n\t\t\t><input class=\"dijitReset\" dojoAttachPoint='textbox,focusNode' autocomplete=\"off\"\n\t\t\t${nameAttrSetting} type='${type}'\n\t\t/></div\n\t></div\n></div>\n"),baseClass:"dijitTextBox",required:false,promptMessage:"",invalidMessage:"$_unset_$",constraints:{},regExp:".*",regExpGen:function(_2895){return this.regExp;},state:"",tooltipPosition:[],_setValueAttr:function(){this.inherited(arguments);this.validate(this._focused);},validator:function(value,_2896){return (new RegExp("^(?:"+this.regExpGen(_2896)+")"+(this.required?"":"?")+"$")).test(value)&&(!this.required||!this._isEmpty(value))&&(this._isEmpty(value)||this.parse(value,_2896)!==undefined);},_isValidSubset:function(){return this.textbox.value.search(this._partialre)==0;},isValid:function(_2897){return this.validator(this.textbox.value,this.constraints);},_isEmpty:function(value){return /^\s*$/.test(value);},getErrorMessage:function(_2898){return this.invalidMessage;},getPromptMessage:function(_2899){return this.promptMessage;},_maskValidSubsetError:true,validate:function(_289a){var _289b="";var _289c=this.disabled||this.isValid(_289a);if(_289c){this._maskValidSubsetError=true;}var _289d=!_289c&&_289a&&this._isValidSubset();var _289e=this._isEmpty(this.textbox.value);if(_289e){this._maskValidSubsetError=true;}this.state=(_289c||(!this._hasBeenBlurred&&_289e)||_289d)?"":"Error";if(this.state=="Error"){this._maskValidSubsetError=false;}this._setStateClass();dijit.setWaiState(this.focusNode,"invalid",_289c?"false":"true");if(_289a){if(_289e){_289b=this.getPromptMessage(true);}if(!_289b&&(this.state=="Error"||(_289d&&!this._maskValidSubsetError))){_289b=this.getErrorMessage(true);}}this.displayMessage(_289b);return _289c;},_message:"",displayMessage:function(_289f){if(this._message==_289f){return;}this._message=_289f;dijit.hideTooltip(this.domNode);if(_289f){dijit.showTooltip(_289f,this.domNode,this.tooltipPosition);}},_refreshState:function(){this.validate(this._focused);this.inherited(arguments);},constructor:function(){this.constraints={};},postMixInProperties:function(){this.inherited(arguments);this.constraints.locale=this.lang;this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);if(this.invalidMessage=="$_unset_$"){this.invalidMessage=this.messages.invalidMessage;}var p=this.regExpGen(this.constraints);this.regExp=p;var _28a0="";if(p!=".*"){this.regExp.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(re){switch(re.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":_28a0+=re;break;case ")":_28a0+="|$)";break;default:_28a0+="(?:"+re+"|$)";break;}});}try{"".search(_28a0);}catch(e){_28a0=this.regExp;console.warn("RegExp error in "+this.declaredClass+": "+this.regExp);}this._partialre="^(?:"+_28a0+")$";},_setDisabledAttr:function(value){this.inherited(arguments);this._refreshState();},_setRequiredAttr:function(value){this.required=value;dijit.setWaiState(this.focusNode,"required",value);this._refreshState();},postCreate:function(){if(dojo.isIE){var s=dojo.getComputedStyle(this.focusNode);if(s){var ff=s.fontFamily;if(ff){this.focusNode.style.fontFamily=ff;}}}this.inherited(arguments);},reset:function(){this._maskValidSubsetError=true;this.inherited(arguments);},_onBlur:function(){this.displayMessage("");this.inherited(arguments);}});dojo.declare("dijit.form.MappedTextBox",dijit.form.ValidationTextBox,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},serialize:function(val,_28a1){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.attr("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=dojo.place("<input type='hidden'"+(this.name?" name='"+this.name+"'":"")+">",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});dojo.declare("dijit.form.RangeBoundTextBox",dijit.form.MappedTextBox,{rangeMessage:"",rangeCheck:function(_28a2,_28a3){return ("min" in _28a3?(this.compare(_28a2,_28a3.min)>=0):true)&&("max" in _28a3?(this.compare(_28a2,_28a3.max)<=0):true);},isInRange:function(_28a4){return this.rangeCheck(this.attr("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.attr("value");var _28a5=false;var _28a6=false;if("min" in this.constraints){var min=this.constraints.min;min=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min);_28a5=(typeof min=="number")&&min<0;}if("max" in this.constraints){var max=this.constraints.max;max=this.compare(val,((typeof max!="number")||max>0)?max:0);_28a6=(typeof max=="number")&&max>0;}return _28a5||_28a6;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_28a7){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_28a7));},getErrorMessage:function(_28a8){var v=this.attr("value");if(v!==null&&v!==""&&v!==undefined&&!this.isInRange(_28a8)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=dojo.i18n.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},postCreate:function(){this.inherited(arguments);if(this.constraints.min!==undefined){dijit.setWaiState(this.focusNode,"valuemin",this.constraints.min);}if(this.constraints.max!==undefined){dijit.setWaiState(this.focusNode,"valuemax",this.constraints.max);}},_setValueAttr:function(value,_28a9){dijit.setWaiState(this.focusNode,"valuenow",value);this.inherited(arguments);}});}if(!dojo._hasResource["dijit.form.ComboBox"]){dojo._hasResource["dijit.form.ComboBox"]=true;dojo.provide("dijit.form.ComboBox");dojo.declare("dijit.form.ComboBoxMixin",null,{item:null,pageSize:Infinity,store:null,fetchProperties:{},query:{},autoComplete:true,highlightMatch:"first",searchDelay:100,searchAttr:"name",labelAttr:"",labelType:"text",queryExpr:"${0}*",ignoreCase:true,hasDownArrow:true,templateString:dojo.cache("dijit.form","templates/ComboBox.html","<div class=\"dijit dijitReset dijitInlineTable dijitLeft\"\n\tid=\"widget_${id}\"\n\tdojoAttachEvent=\"onmouseenter:_onMouse,onmouseleave:_onMouse,onmousedown:_onMouse\" dojoAttachPoint=\"comboNode\" waiRole=\"combobox\" tabIndex=\"-1\"\n\t><div style=\"overflow:hidden;\"\n\t\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton'\n\t\t\tdojoAttachPoint=\"downArrowNode\" waiRole=\"presentation\"\n\t\t\tdojoAttachEvent=\"onmousedown:_onArrowMouseDown,onmouseup:_onMouse,onmouseenter:_onMouse,onmouseleave:_onMouse\"\n\t\t\t><div class=\"dijitArrowButtonInner\">&thinsp;</div\n\t\t\t><div class=\"dijitArrowButtonChar\">&#9660;</div\n\t\t></div\n\t\t><div class=\"dijitReset dijitValidationIcon\"><br></div\n\t\t><div class=\"dijitReset dijitValidationIconText\">&Chi;</div\n\t\t><div class=\"dijitReset dijitInputField\"\n\t\t\t><input ${nameAttrSetting} type=\"text\" autocomplete=\"off\" class='dijitReset'\n\t\t\tdojoAttachEvent=\"onkeypress:_onKeyPress,compositionend\"\n\t\t\tdojoAttachPoint=\"textbox,focusNode\" waiRole=\"textbox\" waiState=\"haspopup-true,autocomplete-list\"\n\t\t/></div\n\t></div\n></div>\n"),baseClass:"dijitComboBox",_getCaretPos:function(_28aa){var pos=0;if(typeof (_28aa.selectionStart)=="number"){pos=_28aa.selectionStart;}else{if(dojo.isIE){var tr=dojo.doc.selection.createRange().duplicate();var ntr=_28aa.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_28ab,_28ac){_28ac=parseInt(_28ac);dijit.selectInputText(_28ab,_28ac,_28ac);},_setDisabledAttr:function(value){this.inherited(arguments);dijit.setWaiState(this.comboNode,"disabled",value);},_abortQuery:function(){if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}if(this._fetchHandle){if(this._fetchHandle.abort){this._fetchHandle.abort();}this._fetchHandle=null;}},_onKeyPress:function(evt){var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==dojo.keys.SHIFT){return;}var _28ad=false;var _28ae="_startSearchFromInput";var pw=this._popupWidget;var dk=dojo.keys;var _28af=null;this._prev_key_backspace=false;this._abortQuery();if(this._isShowingNow){pw.handleKey(key);_28af=pw.getHighlightedOption();}switch(key){case dk.PAGE_DOWN:case dk.DOWN_ARROW:case dk.PAGE_UP:case dk.UP_ARROW:if(!this._isShowingNow){this._arrowPressed();_28ad=true;_28ae="_startSearchAll";}else{this._announceOption(_28af);}dojo.stopEvent(evt);break;case dk.ENTER:if(_28af){if(_28af==pw.nextButton){this._nextSearch(1);dojo.stopEvent(evt);break;}else{if(_28af==pw.previousButton){this._nextSearch(-1);dojo.stopEvent(evt);break;}}}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}evt.preventDefault();case dk.TAB:var _28b0=this.attr("displayedValue");if(pw&&(_28b0==pw._messages["previousMessage"]||_28b0==pw._messages["nextMessage"])){break;}if(_28af){this._selectOption();}if(this._isShowingNow){this._lastQuery=null;this._hideResultList();}break;case " ":if(_28af){dojo.stopEvent(evt);this._selectOption();this._hideResultList();}else{_28ad=true;}break;case dk.ESCAPE:if(this._isShowingNow){dojo.stopEvent(evt);this._hideResultList();}break;case dk.DELETE:case dk.BACKSPACE:this._prev_key_backspace=true;_28ad=true;break;default:_28ad=typeof key=="string"||key==229;}if(_28ad){this.item=undefined;this.searchTimer=setTimeout(dojo.hitch(this,_28ae),1);}},_autoCompleteText:function(text){var fn=this.focusNode;dijit.selectInputText(fn,fn.value.length);var _28b1=this.ignoreCase?"toLowerCase":"substr";if(text[_28b1](0).indexOf(this.focusNode.value[_28b1](0))==0){var cpos=this._getCaretPos(fn);if((cpos+1)>fn.value.length){fn.value=text;dijit.selectInputText(fn,cpos);}}else{fn.value=text;dijit.selectInputText(fn);}},_openResultList:function(_28b2,_28b3){this._fetchHandle=null;if(this.disabled||this.readOnly||(_28b3.query[this.searchAttr]!=this._lastQuery)){return;}this._popupWidget.clearResultList();if(!_28b2.length){this._hideResultList();return;}_28b3._maxOptions=this._maxOptions;var nodes=this._popupWidget.createOptions(_28b2,_28b3,dojo.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if(_28b3.direction){if(1==_28b3.direction){this._popupWidget.highlightFirstOption();}else{if(-1==_28b3.direction){this._popupWidget.highlightLastOption();}}this._announceOption(this._popupWidget.getHighlightedOption());}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_28b3.query[this.searchAttr])){this._announceOption(nodes[1]);}}},_showResultList:function(){this._hideResultList();this._arrowPressed();this.displayMessage("");dojo.style(this._popupWidget.domNode,{width:"",height:""});var best=this.open();var _28b4=dojo.marginBox(this._popupWidget.domNode);this._popupWidget.domNode.style.overflow=((best.h==_28b4.h)&&(best.w==_28b4.w))?"hidden":"auto";var _28b5=best.w;if(best.h<this._popupWidget.domNode.scrollHeight){_28b5+=16;}dojo.marginBox(this._popupWidget.domNode,{h:best.h,w:Math.max(_28b5,this.domNode.offsetWidth)});if(_28b5<this.domNode.offsetWidth){this._popupWidget.domNode.parentNode.style.left=dojo.position(this.domNode).x+"px";}dijit.setWaiState(this.comboNode,"expanded","true");},_hideResultList:function(){this._abortQuery();if(this._isShowingNow){dijit.popup.close(this._popupWidget);this._arrowIdle();this._isShowingNow=false;dijit.setWaiState(this.comboNode,"expanded","false");dijit.removeWaiState(this.focusNode,"activedescendant");}},_setBlurValue:function(){var _28b6=this.attr("displayedValue");var pw=this._popupWidget;if(pw&&(_28b6==pw._messages["previousMessage"]||_28b6==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.attr("displayedValue",_28b6);}else{if(this.value!=this._lastValueReported){dijit.form._FormValueWidget.prototype._setValueAttr.call(this,this.value,true);}this._refreshState();}}},_onBlur:function(){this._hideResultList();this._arrowIdle();this.inherited(arguments);},_setItemAttr:function(item,_28b7,_28b8){if(!_28b8){_28b8=this.labelFunc(item,this.store);}this.value=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_28b8;this.item=item;dijit.form.ComboBox.superclass._setValueAttr.call(this,this.value,_28b7,_28b8);},_announceOption:function(node){if(!node){return;}var _28b9;if(node==this._popupWidget.nextButton||node==this._popupWidget.previousButton){_28b9=node.innerHTML;this.item=undefined;this.value="";}else{_28b9=this.labelFunc(node.item,this.store);this.attr("item",node.item,false,_28b9);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);dijit.setWaiState(this.focusNode,"activedescendant",dojo.attr(node,"id"));this._autoCompleteText(_28b9);},_selectOption:function(evt){if(evt){this._announceOption(evt.target);}this._hideResultList();this._setCaretPos(this.focusNode,this.focusNode.value.length);dijit.form._FormValueWidget.prototype._setValueAttr.call(this,this.value,true);},_onArrowMouseDown:function(evt){if(this.disabled||this.readOnly){return;}dojo.stopEvent(evt);this.focus();if(this._isShowingNow){this._hideResultList();}else{this._startSearchAll();}},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_getQueryString:function(text){return dojo.string.substitute(this.queryExpr,[text]);},_startSearch:function(key){if(!this._popupWidget){var _28ba=this.id+"_popup";this._popupWidget=new dijit.form._ComboBoxMenu({onChange:dojo.hitch(this,this._selectOption),id:_28ba});dijit.removeWaiState(this.focusNode,"activedescendant");dijit.setWaiState(this.textbox,"owns",_28ba);}var query=dojo.clone(this.query);this._lastInput=key;this._lastQuery=query[this.searchAttr]=this._getQueryString(key);this.searchTimer=setTimeout(dojo.hitch(this,function(query,_28bb){this.searchTimer=null;var fetch={queryOptions:{ignoreCase:this.ignoreCase,deep:true},query:query,onBegin:dojo.hitch(this,"_setMaxOptions"),onComplete:dojo.hitch(this,"_openResultList"),onError:function(_28bc){_28bb._fetchHandle=null;console.error("dijit.form.ComboBox: "+_28bc);dojo.hitch(_28bb,"_hideResultList")();},start:0,count:this.pageSize};dojo.mixin(fetch,_28bb.fetchProperties);this._fetchHandle=_28bb.store.fetch(fetch);var _28bd=function(_28be,_28bf){_28be.start+=_28be.count*_28bf;_28be.direction=_28bf;this._fetchHandle=this.store.fetch(_28be);};this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,_28bd,this._fetchHandle);},query,this),this.searchDelay);},_setMaxOptions:function(size,_28c0){this._maxOptions=size;},_getValueField:function(){return this.searchAttr;},_arrowPressed:function(){if(!this.disabled&&!this.readOnly&&this.hasDownArrow){dojo.addClass(this.downArrowNode,"dijitArrowButtonActive");}},_arrowIdle:function(){if(!this.disabled&&!this.readOnly&&this.hasDownArrow){dojo.removeClass(this.downArrowNode,"dojoArrowButtonPushed");}},compositionend:function(evt){this._onKeyPress({charOrCode:229});},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.hasDownArrow){this.baseClass="dijitTextBox";}if(!this.store){var _28c1=this.srcNodeRef;this.store=new dijit.form._ComboBoxDataStore(_28c1);if(!this.value||((typeof _28c1.selectedIndex=="number")&&_28c1.selectedIndex.toString()===this.value)){var item=this.store.fetchSelectedItem();if(item){var _28c2=this._getValueField();this.value=_28c2!=this.searchAttr?this.store.getValue(item,_28c2):this.labelFunc(item,this.store);}}}this.inherited(arguments);},postCreate:function(){var label=dojo.query("label[for=\""+this.id+"\"]");if(label.length){label[0].id=(this.id+"_label");var cn=this.comboNode;dijit.setWaiState(cn,"labelledby",label[0].id);}this.inherited(arguments);},uninitialize:function(){if(this._popupWidget&&!this._popupWidget._destroyed){this._hideResultList();this._popupWidget.destroy();}this.inherited(arguments);},_getMenuLabelFromItem:function(item){var label=this.labelAttr?this.store.getValue(item,this.labelAttr):this.labelFunc(item,this.store);var _28c3=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){label=this.doHighlight(label,this._escapeHtml(this._lastInput));_28c3="html";}return {html:_28c3=="html",label:label};},doHighlight:function(label,find){var _28c4="i"+(this.highlightMatch=="all"?"g":"");var _28c5=this._escapeHtml(label);find=dojo.regexp.escapeString(find);var ret=_28c5.replace(new RegExp("(^|\\s)("+find+")",_28c4),"$1<span class=\"dijitComboBoxHighlightMatch\">$2</span>");return ret;},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},open:function(){this._isShowingNow=true;return dijit.popup.open({popup:this._popupWidget,around:this.domNode,parent:this});},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,store){return store.getValue(item,this.searchAttr).toString();}});dojo.declare("dijit.form._ComboBoxMenu",[dijit._Widget,dijit._Templated],{templateString:"<ul class='dijitReset dijitMenu' dojoAttachEvent='onmousedown:_onMouseDown,onmouseup:_onMouseUp,onmouseover:_onMouseOver,onmouseout:_onMouseOut' tabIndex='-1' style='overflow: \"auto\"; overflow-x: \"hidden\";'>"+"<li class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton' waiRole='option'></li>"+"<li class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton' waiRole='option'></li>"+"</ul>",_messages:null,postMixInProperties:function(){this._messages=dojo.i18n.getLocalization("dijit.form","ComboBox",this.lang);this.inherited(arguments);},_setValueAttr:function(value){this.value=value;this.onChange(value);},onChange:function(value){},onPage:function(_28c6){},postCreate:function(){this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];this.inherited(arguments);},onClose:function(){this._blurOptionNode();},_createOption:function(item,_28c7){var _28c8=_28c7(item);var _28c9=dojo.doc.createElement("li");dijit.setWaiRole(_28c9,"option");if(_28c8.html){_28c9.innerHTML=_28c8.label;}else{_28c9.appendChild(dojo.doc.createTextNode(_28c8.label));}if(_28c9.innerHTML==""){_28c9.innerHTML="&nbsp;";}_28c9.item=item;return _28c9;},createOptions:function(_28ca,_28cb,_28cc){this.previousButton.style.display=(_28cb.start==0)?"none":"";dojo.attr(this.previousButton,"id",this.id+"_prev");dojo.forEach(_28ca,function(item,i){var _28cd=this._createOption(item,_28cc);_28cd.className="dijitReset dijitMenuItem";dojo.attr(_28cd,"id",this.id+i);this.domNode.insertBefore(_28cd,this.nextButton);},this);var _28ce=false;if(_28cb._maxOptions&&_28cb._maxOptions!=-1){if((_28cb.start+_28cb.count)<_28cb._maxOptions){_28ce=true;}else{if((_28cb.start+_28cb.count)>(_28cb._maxOptions-1)){if(_28cb.count==_28ca.length){_28ce=true;}}}}else{if(_28cb.count==_28ca.length){_28ce=true;}}this.nextButton.style.display=_28ce?"":"none";dojo.attr(this.nextButton,"id",this.id+"_next");return this.domNode.childNodes;},clearResultList:function(){while(this.domNode.childNodes.length>2){this.domNode.removeChild(this.domNode.childNodes[this.domNode.childNodes.length-2]);}},_onMouseDown:function(evt){dojo.stopEvent(evt);},_onMouseUp:function(evt){if(evt.target===this.domNode){return;}else{if(evt.target==this.previousButton){this.onPage(-1);}else{if(evt.target==this.nextButton){this.onPage(1);}else{var tgt=evt.target;while(!tgt.item){tgt=tgt.parentNode;}this._setValueAttr({target:tgt},true);}}}},_onMouseOver:function(evt){if(evt.target===this.domNode){return;}var tgt=evt.target;if(!(tgt==this.previousButton||tgt==this.nextButton)){while(!tgt.item){tgt=tgt.parentNode;}}this._focusOptionNode(tgt);},_onMouseOut:function(evt){if(evt.target===this.domNode){return;}this._blurOptionNode();},_focusOptionNode:function(node){if(this._highlighted_option!=node){this._blurOptionNode();this._highlighted_option=node;dojo.addClass(this._highlighted_option,"dijitMenuItemSelected");}},_blurOptionNode:function(){if(this._highlighted_option){dojo.removeClass(this._highlighted_option,"dijitMenuItemSelected");this._highlighted_option=null;}},_highlightNextOption:function(){var fc=this.domNode.firstChild;if(!this.getHighlightedOption()){this._focusOptionNode(fc.style.display=="none"?fc.nextSibling:fc);}else{var ns=this._highlighted_option.nextSibling;if(ns&&ns.style.display!="none"){this._focusOptionNode(ns);}}dijit.scrollIntoView(this._highlighted_option);},highlightFirstOption:function(){this._focusOptionNode(this.domNode.firstChild.nextSibling);dijit.scrollIntoView(this._highlighted_option);},highlightLastOption:function(){this._focusOptionNode(this.domNode.lastChild.previousSibling);dijit.scrollIntoView(this._highlighted_option);},_highlightPrevOption:function(){var lc=this.domNode.lastChild;if(!this.getHighlightedOption()){this._focusOptionNode(lc.style.display=="none"?lc.previousSibling:lc);}else{var ps=this._highlighted_option.previousSibling;if(ps&&ps.style.display!="none"){this._focusOptionNode(ps);}}dijit.scrollIntoView(this._highlighted_option);},_page:function(up){var _28cf=0;var _28d0=this.domNode.scrollTop;var _28d1=dojo.style(this.domNode,"height");if(!this.getHighlightedOption()){this._highlightNextOption();}while(_28cf<_28d1){if(up){if(!this.getHighlightedOption().previousSibling||this._highlighted_option.previousSibling.style.display=="none"){break;}this._highlightPrevOption();}else{if(!this.getHighlightedOption().nextSibling||this._highlighted_option.nextSibling.style.display=="none"){break;}this._highlightNextOption();}var _28d2=this.domNode.scrollTop;_28cf+=(_28d2-_28d0)*(up?-1:1);_28d0=_28d2;}},pageUp:function(){this._page(true);},pageDown:function(){this._page(false);},getHighlightedOption:function(){var ho=this._highlighted_option;return (ho&&ho.parentNode)?ho:null;},handleKey:function(key){switch(key){case dojo.keys.DOWN_ARROW:this._highlightNextOption();break;case dojo.keys.PAGE_DOWN:this.pageDown();break;case dojo.keys.UP_ARROW:this._highlightPrevOption();break;case dojo.keys.PAGE_UP:this.pageUp();break;}}});dojo.declare("dijit.form.ComboBox",[dijit.form.ValidationTextBox,dijit.form.ComboBoxMixin],{_setValueAttr:function(value,_28d3,_28d4){this.item=null;if(!value){value="";}dijit.form.ValidationTextBox.prototype._setValueAttr.call(this,value,_28d3,_28d4);}});dojo.declare("dijit.form._ComboBoxDataStore",null,{constructor:function(root){this.root=root;dojo.query("> option",root).forEach(function(node){node.innerHTML=dojo.trim(node.innerHTML);});},getValue:function(item,_28d5,_28d6){return (_28d5=="value")?item.value:(item.innerText||item.textContent||"");},isItemLoaded:function(_28d7){return true;},getFeatures:function(){return {"dojo.data.api.Read":true,"dojo.data.api.Identity":true};},_fetchItems:function(args,_28d8,_28d9){if(!args.query){args.query={};}if(!args.query.name){args.query.name="";}if(!args.queryOptions){args.queryOptions={};}var _28da=dojo.data.util.filter.patternToRegExp(args.query.name,args.queryOptions.ignoreCase),items=dojo.query("> option",this.root).filter(function(_28db){return (_28db.innerText||_28db.textContent||"").match(_28da);});if(args.sort){items.sort(dojo.data.util.sorter.createSortFunction(args.sort,this));}_28d8(items,args);},close:function(_28dc){return;},getLabel:function(item){return item.innerHTML;},getIdentity:function(item){return dojo.attr(item,"value");},fetchItemByIdentity:function(args){var item=dojo.query("option[value='"+args.identity+"']",this.root)[0];args.onItem(item);},fetchSelectedItem:function(){var root=this.root,si=root.selectedIndex;return dojo.query("> option:nth-child("+(si!=-1?si+1:1)+")",root)[0];}});dojo.extend(dijit.form._ComboBoxDataStore,dojo.data.util.simpleFetch);}if(!dojo._hasResource["com.ibm.widgets.TypeAheadComboBox"]){dojo._hasResource["com.ibm.widgets.TypeAheadComboBox"]=true;dojo.provide("com.ibm.widgets.TypeAheadComboBox");dojo.declare("com.ibm.widgets.TypeAheadComboBox",[dijit._Widget,dijit._Templated,dijit.form.ComboBox,com.ibm.widgets._Traceable],{bIsTraceable:false,parentWidget:"",validationCallback:"",typeAheadFetchDelay:80,validationDelay:80,allowTypeAheadDataCaching:false,typeAheadFetchURL:"",separatorChars:[" ",","],maxResponses:32,_splitRegExp:null,_typeAheadTimerHandle:"",_typeAheadStore:new dojo.data.ItemFileWriteStore({data:{items:[]}}),_validateTimerHandle:"",_lastUnsuccessfulSearchTerm:"",_lastSuccessfulSearchTerm:"",_responseCache:[],constructor:function(){this.inherited("constructor","com.ibm.widgets.TypeAheadComboBox");this.bIsTracing=this.isTracing();this.hasDownArrow=false;this.autoComplete=false;this.highlightMatch="none";this._splitRegExp=new RegExp("[,| ]");},postMixInProperties:function(){this.inherited("postMixInProperties",arguments);},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}dojo.connect(dojo.byId(this.domNode),"onkeyup",dojo.hitch(this,"onKeyupEvent"));dojo.attr(this.textbox,"title",dojo.attr(this.domNode,"title"));if(this.bIsTracing){this.traceExit(m);}},uninitialize:function(){this.inherited("uninitialize",arguments);},onKeyupEvent:function(evnt){if(this.bIsTracing){var m="onKeyupEvent(evnt)";this.traceEntry(m,evnt);}var key=evnt.keyCode;var keys=dojo.keys;if(this.bIsTracing){this.trace(m,"key",key);this.trace(m,"keys",keys);this.trace(m,"keys.DOWN_ARROW",keys.DOWN_ARROW);}switch(key){case keys.DOWN_ARROW:case keys.END:case keys.HOME:case keys.LEFT_ARROW:case keys.LEFT_WINDOW:case keys.PAGE_DOWN:case keys.PAGE_UP:case keys.RIGHT_ARROW:case keys.RIGHT_WINDOW:case keys.TAB:case keys.UP_ARROW:break;default:clearTimeout(this._validateTimerHandle);this._validateTimerHandle=setTimeout(dojo.hitch(this,"validate",true),this.validationDelay);clearTimeout(this._typeAheadTimerHandle);this._typeAheadTimerHandle=setTimeout(dojo.hitch(this,"_requestTypeAheadData"),this.typeAheadFetchDelay);break;}if(this.bIsTracing){this.traceExit(m);}},onTypeAheadDataLoad:function(_28dd,_28de){if(this.bIsTracing){var m="onTypeAheadDataLoad(response, ioArgs)";this.traceEntry(m,[_28dd,_28de]);}var _28df=_28dd[0];if(_28df==this.attr("value")){if(_28dd[1].length===0){this._lastUnsuccessfulSearchTerm=_28df;}else{this._lastSuccessfulSearchTerm=_28df;this._pushResponseForSearchTerm(_28dd);}this._convertOpenSearchResponse(_28dd);}if(this.bIsTracing){this.traceExit(m);}},validator:function(value,_28e0){if(this.bIsTracing){var m="validator(value, constraints)";this.traceEntry(m,[value,_28e0]);}var _28e1=true;var v=this.attr("value");if(v!==""){var _28e2=v.split(this._splitRegExp);var _28e3;for(var i=0;i<_28e2.length;i++){if(_28e2[i].length>0){_28e3=_28e2[i].match(this.regExp);if(_28e3!==null&&_28e3.length>0){if(_28e3[0].length!=_28e2[i].length){_28e1=false;}}else{_28e1=false;}}}if(this.bIsTracing){this.trace(m,"isValid",_28e1);this.trace(m,"parent widget",this.parentWidget);}}if(_28e1!==true){if(this.validationCallback!==""){this.validationCallback(false);}if(this.bIsTracing){this.traceExit(m,false);}return false;}else{if(this.validationCallback!==""){if(dojo.trim(this.attr("value")).length===0){this.validationCallback(false);}else{this.validationCallback(true);}}if(this.bIsTracing){this.traceExit(m,true);}return true;}},_replaceVariables:function(_28e4){return _28e4.replace("${searchTerm}",this.attr("value"));},_searchTermHasInvalidChars:function(_28e5){if(this.bIsTracing){var m="_searchTermHasInvalidChars(searchTerm)";this.traceEntry(m,_28e5);}for(var i=0;i<this.separatorChars.length;i++){if(_28e5.indexOf(this.separatorChars[i])>-1){if(this.bIsTracing){this.traceExit(m,true);}return true;}}if(this.bIsTracing){this.traceExit(m,false);}return false;},_searchTermCouldReturnResults:function(_28e6){if(this.bIsTracing){var m="_searchTermCouldReturnResults(searchTerm)";this.traceEntry(m,_28e6);}var _28e7=true;if((this._lastUnsuccessfulSearchTerm!=="")&&(_28e6.indexOf(this._lastUnsuccessfulSearchTerm)===0)){_28e7=false;}if(this.bIsTracing){this.traceExit(m,_28e7);}return _28e7;},_getResponseForSearchTerm:function(_28e8){if(this.bIsTracing){var m="_getResponseForSearchTerm(searchTerm)";this.traceEntry(m,_28e8);}for(var i=0;i<this._responseCache.length;i++){if(this._responseCache[i][0]==_28e8){if(this.bIsTracing){this.traceExit(this._responseCache[i]);}return this._responseCache[i];}}if(this.bIsTracing){this.traceExit(m,null);}return null;},_pushResponseForSearchTerm:function(_28e9){if(this.bIsTracing){var m="_pushResponseForSearchTerm(response)";this.traceEntry(m,_28e9);}if(this._responseCache.length>=this.maxResponses){this._responseCache.shift();}this._responseCache.push(_28e9);if(this.bIsTracing){this.traceExit(m);}},_requestTypeAheadData:function(){if(this.bIsTracing){var m="_requestTypeAheadData()";this.traceEntry(m);}var _28ea=this.attr("value");if(this.bIsTracing){this.trace(m,"searchTerm",_28ea);}if(_28ea.length>2){if((!this._searchTermHasInvalidChars(_28ea))&&(this._searchTermCouldReturnResults(_28ea))){var _28eb=this._getResponseForSearchTerm(_28ea);if(_28eb){this._convertOpenSearchResponse(_28eb);}else{var _28ec=true;if(this.allowTypeAheadDataCaching===true){_28ec=false;}if(this.bIsTracing){this.trace(m,"Sending xhrGet http request to portal");this.trace(m,"xhrGet URL",this._replaceVariables(this.typeAheadFetchURL));}this._fetchSearchTerm=_28ea;var _28ed=dojo.xhrGet({url:this._replaceVariables(this.typeAheadFetchURL),load:dojo.hitch(this,"onTypeAheadDataLoad"),handleAs:"json",preventCache:_28ec});}}}else{this._typeAheadStore=new dojo.data.ItemFileWriteStore({data:{items:[]}});this.store=this._typeAheadStore;this._startSearchAll();}if(this.bIsTracing){this.traceExit(m);}},_convertOpenSearchResponse:function(_28ee){if(this.bIsTracing){var m="_convertOpenSearchResponse(response)";this.traceEntry(m,_28ee);}this._typeAheadStore=new dojo.data.ItemFileWriteStore({data:{identifier:"name",items:[]}});if(this.bIsTracing){this.trace(m,"Response Length",_28ee[1].length);}for(var i=0;i<_28ee[1].length;i++){if(this.bIsTracing){this.trace(m,"Response[1][i]",_28ee[1][i]);}var item=this._typeAheadStore.newItem({name:_28ee[1][i]});}this._typeAheadStore.save();this.store=this._typeAheadStore;this._startSearchAll();if(this.bIsTracing){this.traceExit(m);}}});}if(!dojo._hasResource["com.ibm.widgets.AddTag"]){dojo._hasResource["com.ibm.widgets.AddTag"]=true;dojo.provide("com.ibm.widgets.AddTag");dojo.declare("com.ibm.widgets.AddTag",[dijit.Dialog,dijit._Templated,com.ibm.widgets._Traceable],{widgetsInTemplate:true,bIsTracing:false,resourceID:"",resourceTitle:"",resourceType:"",validationRegex:"",resourceCategories:null,resourcePrivate:false,maxCommunityTags:50,maxPersonalTags:50,orderMetric:"tag_space_count_reverse_name",order:"DESC",messageFadeOutDuration:1000,defaultView:"PUBLIC",deletingEnabled:true,countsEnabled:false,customLabelCommunityTags:"",customLabelPersonalPublicTags:"",customLabelPersonalPrivateTags:"",customLabelAddTags:"",privateTaggingEnabled:true,mineTaggingEnabled:true,displayTabs:true,localePickerEnabled:true,customMessageNoCommunityTags:"",customMessageNoPersonalTags:"",genericParameterMap:null,fetch_totalResults:30,tagName:"",resourceSchema:"",resource:null,tagsForResource:"",myTags:[],myPrivateTags:[],privateTagsToDelete:[],publicTagsToDelete:[],tagSpacesToDelete:[],collaborativeScope:["AUTHOR","COLLABORATIVE"],privateScope:["PRIVATE"],isAnonymous:false,numberOfTagsToAdd:0,numberOfTagsToDelete:0,numberOfRejectedTags:0,numberOfDuplicateTags:0,errorMsgDetails:"",isPreventCache:false,itemsToSave:[],_triggerRefresh:false,locale:ibmPortalConfig.locale,_tagSpacesDeleted:false,_deletedTagSpaceName:"",_checkDialog:null,maxPersonalPublicTagsReached:false,maxPersonalPrivateTagsReached:false,publicTagAlreadyAssigned:false,privateTagAlreadyAssigned:false,numberOfTagsAdded:0,isPrivate:false,tagStore:null,_tagData:null,tagsChangedEventID:"",tagsChangedEvent:"tagsChanged",_tagScope:"community",_dapTagsForResource:null,_dapMyTagsForResource:null,_dapPrivateTagsForResource:null,_dapDeleteTagNames:[],_dapDeleteTagSpaces:[],_dapDeletePrivateTagNames:{},_dapSuccessDiv:null,_dapLocalePickerButton:null,templateString:null,templateString:"<div class=\"lotusDialogBorder lotusui trc trcTagging\" waistate=\"labelledby-${id}\" wairole=\"dialog\" role=\"dialog\" index=\"-1\" aria-labelledby=\"${id}\" dojoAttachPoint=\"addTagDiv\">\n\t<div class=\"lotusDialog trc trcTagging trcDialog trcDialogTagging\">\n\t\t<h1>\n\t\t\t<a href=\"javascript:void(0);\" dojoAttachPoint=\"closeButtonNode\" class=\"lotusBtnImg lotusClose\" title=\"${bundle.title_close_widget}\">\n\t\t\t\t<img src=\"${blankImage}\" alt=\"\" aria-label=\"${bundle.title_close_widget}\" />\n\t\t\t\t\t<span class=\"lotusAltText\">X</span>\n\t\t\t</a>\n\t\t\t<span dojoAttachPoint=\"titleNode\"></span>\n\t\t</h1>\n\t\t<form dojoAttachPoint=\"addTagForm\" id=\"addForm\" action=\"javascript:;\" class=\"lotusForm2\">\n\t\t\t<div dojoAttachPoint=\"containerNode\" class=\"lotusDialogContent\">\n\t\t\t\t<div dojoAttachPoint=\"errorDiv\" id=\"errorDiv\" title=\"${bundle.title_error_message}\" style=\"display:none;\" class=\"lotusMessage\">\n\t\t\t\t\t<img src=\"${blankImage}\" width=\"16\" height=\"16\" class=\"trcErrorIcon\" alt=\"${bundle.title_error_message}\" /> \n\t\t\t\t\t\t<span dojoAttachPoint=\"errorSpan\"></span>\n\t\t\t\t\t<div style=\"background-color: white;\" style=\"display:block;\">\n\t\t\t\t\t  <span dojoAttachPoint=\"errorDetailsSpan\"></span>\n\t\t\t\t\t</div> \n\t\t\t\t</div>\n\t\t\t\t<div dojoAttachPoint=\"successMessageDiv\" id=\"successMessageDiv\"></div>\n\t\t\t\t<div dojoAttachPoint=\"informationDiv\" id=\"informationDiv\"></div>\n\t\t\t\t<div dojoAttachPoint=\"communitySection\" class=\"lotusFormField\">\n\t\t\t\t\t<label dojoAttachPoint=\"communityTagsLabel\" for=\"tagDiv\" class=\"trcText\">${bundle.text_community_tags_for_this_resource}</label>\n\t\t\t\t\t<div dojoAttachPoint=\"loadingDiv\" class=\"trcLoading\">\n\t\t\t\t\t\t<span class=\"lotusLoading\"><img width=\"16\" height=\"16\" src=\"${blankImage}\"></span>&nbsp;<span>${bundle.text_loading}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div dojoAttachpoint=\"tagDiv\" title=\"${bundle.title_community_tags}\" id=\"tagDiv\"></div>\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div dojoAttachPoint=\"editSection\"> \n\t\t\t\t\t<table class=\"trcTabTable\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<div dojoAttachPoint=\"editTabs\" class=\"lotusTabContainer\">\n\t\t\t\t\t\t\t\t<ul class=\"lotusTabs\" >\n\t\t\t\t\t\t\t\t\t<li dojoAttachPoint=\"liTabPublic\" role=\"tab\" class=\"lotusSelected\"><div><a id=\"tabPublic\" dojoAttachPoint=\"tabPublic\" title=\"${bundle.title_switch_to_community_view}\" selected=\"true\" href=\"javascript:;\"><strong>${bundle.button_public}</strong></a></div></li>\n\t\t\t\t\t\t\t\t\t<li dojoAttachPoint=\"liTabPrivate\"  role=\"tab\" ><div><a id=\"tabPrivate\" dojoAttachPoint=\"tabPrivate\" title=\"${bundle.title_switch_to_priv_view}\" href=\"javascript:;\">${bundle.button_private}</a></div></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div dojoAttachPoint=\"tabContent\" role=\"tabpanel\" class=\"lotusTabContent\" aria-labelledby=\"tabPublic\" aria-hidden=\"false\">\n\t\t\t\t\t\t\t<div dojoAttachPoint=\"informationCell\"></div>\n\t\t\t\t\t\t\t<div class=\"lotusFormField trcFormFieldRow\" dojoAttachPoint=\"myOrPrivateTags\">\n\t\t\t\t\t\t\t\t<label for=\"myOrPrivateTagDiv\" dojoAttachPoint=\"myOrPrivateTagsLabel\" class=\"trcText\">${bundle.text_your_tags_for_this_resource}</label>\n\t\t\t\t\t\t\t\t <div class=\"trcLoading\" dojoAttachPoint=\"personalLoadingDiv\">\n            \t\t\t\t\t\t<span class=\"lotusLoading\"><img width=\"16\" height=\"16\" src=\"${blankImage}\"></span>&nbsp;<span>${bundle.text_loading}</span>\n        \t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div dojoAttachpoint=\"myOrPrivateTagDiv\" title=\"${bundle.title_your_tags}\" id=\"myOrPrivateTagDiv\"></div>\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"lotusFormField trcFormFieldRow\" dojoAttachPoint=\"tagsInput\">\n\t\t\t\t\t\t\t\t<label for=\"tagNameInput\" dojoAttachPoint=\"tagsInputLabel\" class=\"trcText\">${bundle.text_add_tags}</label>\n\t\t\t\t\t\t\t\t<div><select class=\"lotusText\" role=\"combobox\" title=\"${bundle.title_input_tag_names}\" dojoAttachPoint=\"tagNameInput\" parentWidget=\"${parentWidget}\" name=\"tagNameInput\" class =\"lotusText\" id=\"tagNameInput\" dojoType=\"com.ibm.widgets.TypeAheadComboBox\" allowTypeAheadDataCaching=\"true\" invalidMessage=\"${bundle.text_invalid_tag_name}\"></select></div>\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"trcLocalePicker\" dojoAttachPoint=\"localePicker\" id=\"localePicker\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"lotusDialogFooter\" dojoAttachPoint=\"dialogFooter\">\n\t\t\t\t<input type=\"submit\" dojoAttachPoint=\"submitDialog\" value=\"${bundle.button_save}\" role=\"button\" class=\"lotusFormButton\" title=\"${bundle.title_submit_tags}\" id=\"submitTags\" name=\"submitTags\" /> \n\t\t\t\t<a href=\"javascript:;\" role=\"link\" dojoAttachPoint=\"dialogCancel\" role=\"link\" id=\"cancelTags\" title=\"${bundle.title_done_with_tagging}\" class=\"lotusAction\">${bundle.link_done}</a>\n\t\t\t</div>\n\t\t</form>\t\n\t</div>\n</div>\n",blankImage:dojo.moduleUrl("dojo","resources/blank.gif").toString(),getTagStore:function(){this.tagStore=ibmPortalConfig.resolver;return this.tagStore;},constructor:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","AddTag");this.parentWidget=this;this.isAnonymous=!ibmPortalConfig.currentUser;},postCreate:function(){var m="postCreate()";this.traceEntry(m);this.inherited(arguments);this.id="addTags_"+this.resourceID;this.tagsChangedEventID=this.resourceID+this.tagsChangedEvent;this._initializeParameters();if(this.isAnonymous===true){this.displayTabs=false;this.privateTaggingEnabled=false;this.mineTaggingEnabled=false;}this._initializeWidget();if(this.genericParameterMap){if(this.genericParameterMap.renderMode===com.ibm.widgets.AddTag._parameterMap_Value_RenderMode_WSRP){dojo.destroy(this.communitySection);dojo.destroy(this.editSection);this.errorDisplay(null,this.bundle.text_error_renderMode_wsrp,null);}}this.show();this.traceExit(m);},initializeTracing:function(){this.bIsTracing=this.isTracing();},fetchTags:function(){var m="fetchTags()";this.traceEntry(m);this.trace(m,"retrieving URI: ",[com.ibm.widgets.AddTag._tagSpaceEmptyURI,this.resource,com.ibm.widgets.AddTag._tagScope_community,com.ibm.widgets.AddTag._tagScope_personal_public,this.maxCommunityTags,this.orderMetric,this.order,this.isPreventCache]);this._displayLoading();var _28ef={};if(this.isPreventCache){_28ef.preventCache=true;}this._tagData=this.getTagStore().fetch({query:{uri:com.ibm.widgets.AddTag._tagSpaceEmptyURI,rmparam:this.resource,scope:com.ibm.widgets.AddTag._tagScope_community_plus_personal_public,"max-results":this.maxCommunityTags,"start-index":0,orderMetric:this.orderMetric,order:this.order},queryOptions:_28ef,onBegin:dojo.hitch(this,"_onFetchBegin"),onComplete:dojo.hitch(this,"displayCollaborativeTags"),onError:dojo.hitch(this,"errorDisplay")});this.isPreventCache=false;this.traceExit(m);},fetchMyTags:function(){var m="fetchMyTags()";this.traceEntry(m);this.trace(m,"retrieving URI: ",[com.ibm.widgets.AddTag._tagSpaceEmptyURI,this.resource,com.ibm.widgets.AddTag._tagScope_personal_public,this.maxPersonalTags,this.orderMetric,this.order]);this._displayLoading(com.ibm.widgets.AddTag._tagTypePersonal);var _28f0={};if(this.isPreventCache){_28f0.preventCache=true;}this._tagData=this.getTagStore().fetch({query:{uri:com.ibm.widgets.AddTag._tagSpaceEmptyURI,rmparam:this.resource,scope:com.ibm.widgets.AddTag._tagScope_personal_public,"max-results":this.maxPersonalTags,"start-index":0,orderMetric:this.orderMetric,order:this.order},queryOptions:_28f0,onComplete:dojo.hitch(this,"displayMyTags"),onError:dojo.hitch(this,"errorDisplay")});this.isPreventCache=false;this.traceExit(m);},fetchPrivateTags:function(){var m="fetchMyTags()";this.traceEntry(m);this.trace(m,"retrieving URI: ",[com.ibm.widgets.AddTag._tagSpaceEmptyURI,this.resource,com.ibm.widgets.AddTag._tagScope_personal_private,com.ibm.widgets.AddTag._tagScope_personal_public,this.maxPersonalTags,this.orderMetric,this.order]);this._displayLoading(com.ibm.widgets.AddTag._tagTypePersonal);var _28f1={};if(this.isPreventCache){_28f1.preventCache=true;}this._tagData=this.getTagStore().fetch({query:{uri:com.ibm.widgets.AddTag._tagSpaceEmptyURI,rmparam:this.resource,scope:com.ibm.widgets.AddTag._tagScope_personal_private,"max-results":this.maxPersonalTags,"start-index":0,orderMetric:this.orderMetric,order:this.order},queryOptions:_28f1,onComplete:dojo.hitch(this,"displayPrivateTags"),onError:dojo.hitch(this,"errorDisplay")});this.isPreventCache=false;this.traceExit(m);},_onFetchBegin:function(_28f2,_28f3){var m="_onFetchBegin(totalResultSize, requestObject)";this.traceEntry(m);this.trace(m,"totalResultSize : ",[_28f2,_28f3]);this.fetch_totalResults=_28f2;this.traceExit(m);},displayCollaborativeTags:function(items,_28f4){var m="displayCollaborativeTags(items, request)";this.traceEntry(m);this.trace(m,"items.length : ",[items.length]);if(this.isAnonymous){this.handleAnonymousCase();}if(this.customLabelCommunityTags!==null){dojo.attr(this.communityTagsLabel,"innerHTML",this.customLabelCommunityTags);dojo.attr(this.tagDiv,"title",this.customLabelCommunityTags);}else{dojo.attr(this.communityTagsLabel,"innerHTML",this.bundle.text_community_tags_for_this_resource);dojo.attr(this.tagDiv,"title",this.bundle.title_community_tags);}var _28f5=this._dapTagsForResource;if(_28f5){_28f5.parentNode.removeChild(_28f5);}this._displayTags();var div=dojo.create("div",{id:"tagsForResource"},this.tagDiv);dojo.addClass(div,"lotusTagCloud lotusui");this._dapTagsForResource=div;if(items.length<1){if(this.customMessageNoPersonalTags){dojo.place(dojo.doc.createTextNode(this.customMessageNoCommunityTags),div,"last");}else{dojo.place(dojo.doc.createTextNode(this.bundle.text_no_tags_on_this_resource),div,"last");}}else{if(items.length>this.maxCommunityTags||items.length<this.fetch_totalResults){this.displayInfoMessage(this.bundle.text_info_max_number_of_community_tags_reached,null,this.informationDiv);}var ul=dojo.create("ul",{id:"collaborativeTagList"},div);dojo.forEach(items,function(item){var _28f6=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._nameAttribute);var li=dojo.create("li",{title:_28f6},ul);var text="";if(this.countsEnabled){text=dojo.doc.createTextNode(_28f6+" ("+this.getTagStore().getValue(item,com.ibm.widgets.AddTag._countAttribute)+") ");}else{text=dojo.doc.createTextNode(_28f6+" ");}var span=dojo.create("span",null,li);dojo.addClass(span,"lotusNowrap");if(ibmPortalCPConfig.operations.canDeleteOtherUsersTags){var _28f7=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._deleteAllLinkAttribute);var _28f8=dojo.create("a",{href:"javascript:;",title:dojo.string.substitute(this.bundle.title_delete_all_tags_of_name,[_28f6])},span);var img=dojo.create("img",{src:this.blankImage},_28f8);img.style.width="10px";img.style.height="10px";dojo.addClass(_28f8,"trcDeleteIcon");_28f8.onclick=dojo.hitch(this,function(){this.markCommunityTagForDeletion(_28f6,_28f7);return false;});var _28f9=dojo.create("span",null,_28f8,"first");_28f9.innerHTML="X";dojo.addClass(_28f9,"trcDeleteText");_28f9.onclick=dojo.hitch(this,function(){this.markCommunityTagForDeletion(_28f6,_28f7);return false;});}dojo.place(text,span,"first");if(items.length==1||item==items[items.length-1]){dojo.place(dojo.doc.createTextNode(" "),li,"last");}else{dojo.place(dojo.doc.createTextNode(", "),li,"last");}this._dapDeleteTagSpaces[_28f6]=li;},this);}this.tagNameInput.focus();this.traceExit(m);},displayMyTags:function(items,_28fa){var m="displayMyTags(items, request)";this.traceEntry(m);this.trace(m,"items.length : ",[items.length]);this.myTags=[];this._tagScope=com.ibm.widgets.AddTag._tagScope_personal_public;if(this.customLabelPersonalPublicTags!==null){dojo.attr(this.myOrPrivateTagsLabel,"innerHTML",this.customLabelPersonalPublicTags);dojo.attr(this.myOrPrivateTagDiv,"title",this.customLabelPersonalPublicTags);}else{dojo.attr(this.myOrPrivateTagsLabel,"innerHTML",this.bundle.text_your_tags_for_this_resource);dojo.attr(this.myOrPrivateTagDiv,"title",this.bundle.title_your_tags);}if(this.customLabelAddTags!==null){dojo.attr(this.tagsInputLabel,"innerHTML",this.customLabelAddTags);dojo.attr(this.tagNameInput,"title",this.customLabelAddTags);}else{dojo.attr(this.tagsInputLabel,"innerHTML",this.bundle.text_add_tags);dojo.attr(this.tagNameInput,"title",this.bundle.title_input_tag_names);}var _28fb=this._dapMyTagsForResource;if(_28fb){_28fb.parentNode.removeChild(_28fb);}this._displayTags(com.ibm.widgets.AddTag._tagTypePersonal);var div=dojo.create("div",{id:"myTagsForResource"},this.myOrPrivateTagDiv);dojo.addClass(div,"lotusTagCloud lotusui");this._dapMyTagsForResource=div;if(items.length<1){if(this.customMessageNoPersonalTags){dojo.place(dojo.doc.createTextNode(this.customMessageNoPersonalTags),div,"last");}else{dojo.place(dojo.doc.createTextNode(this.bundle.text_you_have_no_tags_on_this_resource),div,"last");}}else{var ul=dojo.create("ul",{id:"collaborativeTagList"},div);dojo.forEach(items,function(item){var _28fc=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._nameAttribute);this.tagName=_28fc;var li=dojo.create("li",{title:_28fc},ul);var span=dojo.create("span",null,li);dojo.addClass(span,"lotusNowrap");var text=dojo.doc.createTextNode(_28fc+" ");dojo.place(text,span,"first");var _28fd={};_28fd.name=_28fc;if(this.deletingEnabled){var _28fe=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._deleteLinkAttribute);_28fd.delLink=_28fe;var link=dojo.create("a",{href:"javascript:;",title:dojo.string.substitute(this.bundle.title_delete,[_28fc])},span);var img=dojo.create("img",{src:this.blankImage},link);img.style.width="10px";img.style.height="10px";dojo.addClass(link,"trcDeleteIcon");link.onclick=dojo.hitch(this,function(){this.markForDeletion(_28fc);return false;});var _28ff=dojo.create("span",null,link,"first");_28ff.innerHTML="X";dojo.addClass(_28ff,"trcDeleteText");_28ff.onclick=dojo.hitch(this,function(){this.markForDeletion(_28fc);return false;});}else{this.trace(m,"The user is not allowed to delete his own tags, therefore no delete icon is displayed");}if(items.length==1||item==items[items.length-1]){dojo.place(dojo.doc.createTextNode(" "),li,"last");}else{dojo.place(dojo.doc.createTextNode(", "),li,"last");}this.myTags.push(_28fd);dojo.parser.parse(li);this._dapDeleteTagNames[_28fc]=li;},this);}this.tagNameInput.focus();this.traceExit(m);},displayPrivateTags:function(items,_2900){var m="displayPrivateTags(items, request)";this.traceEntry(m);this.trace(m,"items.length : ",[items.length]);this.myPrivateTags=[];this._tagScope=com.ibm.widgets.AddTag._tagScope_personal_private;if(this.customLabelPersonalPrivateTags!==null){dojo.attr(this.myOrPrivateTagsLabel,"innerHTML",this.customLabelPersonalPrivateTags);dojo.attr(this.myOrPrivateTagDiv,"title",this.customLabelPersonalPrivateTags);}else{dojo.attr(this.myOrPrivateTagsLabel,"innerHTML",this.bundle.text_your_tags_for_this_resource);dojo.attr(this.myOrPrivateTagDiv,"title",this.bundle.title_your_tags);}var _2901=this._dapPrivateTagsForResource;if(_2901){_2901.parentNode.removeChild(_2901);}this._displayTags(com.ibm.widgets.AddTag._tagTypePersonal);var div=dojo.create("div",{id:"privateTagsForResource"},this.myOrPrivateTagDiv);dojo.addClass(div,"lotusTagCloud lotusui");this._dapPrivateTagsForResource=div;if(items.length<1){if(this.customMessageNoPersonalTags){dojo.place(dojo.doc.createTextNode(this.customMessageNoPersonalTags),div,"last");}else{dojo.place(dojo.doc.createTextNode(this.bundle.text_you_have_no_tags_on_this_resource),div,"last");}}else{var ul=dojo.create("ul",{id:"privateTagList"},div);dojo.forEach(items,function(item){var scope=this.getTagStore().getValue(item,"tagScope");var _2902=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._nameAttribute);var _2903={};_2903.name=_2902;var li=dojo.create("li",{title:_2902},ul);var text=dojo.doc.createTextNode(_2902+" ");var span=dojo.create("span",null,li);dojo.addClass(span,"lotusNowrap");dojo.place(text,span,"first");if(this.deletingEnabled){var _2904=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._deleteLinkAttribute);_2903.delLink=_2904;var link=dojo.create("a",{href:"javascript:;",title:dojo.string.substitute(this.bundle.title_delete_all_tags_of_name,[_2902])},span);var img=dojo.create("img",{src:this.blankImage},link);img.style.width="10px";img.style.height="10px";dojo.addClass(link,"trcDeleteIcon");link.onclick=dojo.hitch(this,function(){this.markForDeletion(_2902);return false;});var _2905=dojo.create("span",null,link,"first");_2905.innerHTML="X";dojo.addClass(_2905,"trcDeleteText");_2905.onclick=dojo.hitch(this,function(){this.markForDeletion(_2902);return false;});}else{this.trace(m,"The user is not allowed to delete tags, therefore no delete icon is displayed.");}if(items.length==1||item==items[items.length-1]){dojo.place(dojo.doc.createTextNode(" "),li,"last");}else{dojo.place(dojo.doc.createTextNode(", "),li,"last");}this.myPrivateTags.push(_2903);dojo.parser.parse(li);this._dapDeleteTagNames[_2902]=li;},this);}this.tagNameInput.focus();this.traceExit(m);},markForDeletion:function(_2906){var m="markForDeletion(tagName)";this.traceEntry(m);this.trace(m,"tagName : ",[_2906]);this.handleValidation(true);this._checkForMessages();var _2907=this._dapDeleteTagNames[_2906];_2907.parentNode.removeChild(_2907);var _2908={};if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_public){_2908.name=_2906;_2908.delLink=this.findDeleteLinkForTagName(this.myTags,_2906);this.publicTagsToDelete.push(_2908);}else{_2908.name=_2906;_2908.delLink=this.findDeleteLinkForTagName(this.myPrivateTags,_2906);this.privateTagsToDelete.push(_2908);}this.traceExit(m);},markCommunityTagForDeletion:function(_2909,_290a){var m="markCommunityTagForDeletion(tagName, deleteAllLink)";this.traceEntry(m);this.trace(m,"tagName : ",[_2909]);this.trace(m,"manager delete link : ",[_290a]);this.handleValidation(true);this._checkForMessages();var _290b=this._dapDeleteTagSpaces[_2909];_290b.parentNode.removeChild(_290b);var _290c=this._dapDeleteTagNames[_2909];if(_290c){if(_290c.parentNode){_290c.parentNode.removeChild(_290c);}}var _290d={};_290d.name=_2909;_290d.delAllLink=_290a;this.tagSpacesToDelete.push(_290d);this.traceExit(m);},findDeleteLinkForTagName:function(_290e,_290f){var m="findDeleteLinkForTagName(tagName, tagsArray)";this.traceEntry(m);this.trace(m,"tagName : ",[_290f]);this.trace(m,"tagsArray : ",[_290e]);var _2910="";for(var i=0;i<_290e.length;i++){if(_290e[i].name===_290f){_2910=_290e[i].delLink;this.trace(m,"tagsArray[i].delLink",_290e[i].delLink);break;}}this.trace(m,"deleteLink : ",[_2910]);this.traceExit(m);return _2910;},deleteTagByLink:function(_2911,_2912){var m="deleteTagByLink(tagDeleteLink, tagScope)";this.traceEntry(m);this.trace(m,"tagDeleteLink : ",[_2911]);this.trace(m,"tagScope : ",[_2912]);var st=this.getTagStore();var def=new dojo.Deferred();def.addCallback(dojo.hitch(this,function(_2913,_2914){this.deleteTagsInStore(_2913,_2914);}));callback=dojo.hitch(this,function(_2915,_2916){def.callback(_2915,_2916);});if(_2912==com.ibm.widgets.AddTag._tagScope_personal_private){st.fetch({query:st.urlToQuery(_2911+"&scope="+com.ibm.widgets.AddTag._tagScope_personal_private,"tm"),queryOptions:{preventCache:true,bypassBatch:true},onComplete:callback,onError:null,scope:this});}else{st.fetch({query:st.urlToQuery(_2911+"&scope="+com.ibm.widgets.AddTag._tagScope_personal_public,"tm"),queryOptions:{preventCache:true,bypassBatch:true},onComplete:callback,onError:null,scope:this});}this.traceExit(m,def);return def;},deleteTagsInStore:function(_2917,_2918){var m="deleteTagsInStore(tagitems, request)";this.traceEntry(m);this.trace(m,"tagitems.length : ",[_2917.length]);var _2919=[],st=this.getTagStore();dojo.forEach(_2917,function(_291a){this.trace(m,"tagitem : ",[_291a]);_2919.push(_291a);st.deleteItem(_291a);},this);this.traceExit(m);},destroyDialog:function(){var m="destroyDialog()";this.traceEntry(m);if(this.tagNameInput){this.tagNameInput.destroy();}if(this._dapLocalePickerButton){this._dapLocalePickerButton.destroy();}this.traceExit(m);},hideAndCancelTags:function(event){var m="hideAndCancelTags(event)";this.traceEntry(m);setTimeout(dojo.hitch(this,"destroyDialog"),dijit.defaultDuration+10);this.traceExit(m);},cancelTags:function(event){var m="cancelTags(event)";this.traceEntry(m);if(this.tagNameInput.attr("value")!==""||this.privateTagsToDelete.length>0||this.publicTagsToDelete.length>0||this.tagSpacesToDelete.length>0){if(!this._checkDialog){this._checkDialog=new com.ibm.widgets.DoneCheckDialog({id:"doneCheckDialog",parentWidget:this,callbackOnYes:function(){this.parentWidget.hide();this.parentWidget.destroyDialog();}});}this._checkDialog.show();}else{this.hide();this.destroyDialog();}this.traceExit(m);},handleCreatesAndDeletes:function(event,input){var m="handleCreatesAndDeletes(event, input)";this.traceEntry(m);this.trace(m,"input : ",[input]);this._displayLoading(com.ibm.widgets.AddTag._tagTypePersonal);if(event){dojo.stopEvent(event);}var _291b="";this.itemsToSave=[];var _291c=[];var _291d=[];var _291e=[];var _291f=[];var _2920=[];var _2921=this._triggerRefresh;var _2922=this.tagSpacesToDelete;if(input||this.tagNameInput.attr("value")!==""){if(input){_291b=input;}else{if(this.tagNameInput.attr("value")!==""){_291b=this.tagNameInput.attr("value");}}var tags=_291b.split(new RegExp("[,| ]"));var _2923=this._cleanArray(tags);if(this.debug===true){dojo.forEach(this.myTags,function(myTag){this.trace(m,"myTag : ",[myTag.name]);});}_2923=this._cleanArrayFromDuplicates(_2923);var _2924=this.myTags;var _2925=this.myPrivateTags;var _2926=this._tagScope;var _2927=com.ibm.widgets.AddTag._tagScope_personal_public;var _2928=com.ibm.widgets.AddTag._tagScope_personal_private;var _2929=this.privateTagsToDelete;var _292a=this.publicTagsToDelete;if(this.privateTagsToDelete.length>0||this.publicTagsToDelete.length>0||this.tagSpacesToDelete.length>0){dojo.forEach(_2923,function(_292b){if(_2922.length>0&&dojo.every(_2922,function(_292c){return _292c.name!=_292b;})){_2920.push(_292b);}else{_2921=true;}if(_2926==_2928){if(_2929.length>0&&dojo.every(_2929,function(_292d){return _292d.name!=_292b;})){_2920.push(_292b);}else{_2921=true;}}else{if(_292a.length>0&&dojo.every(_292a,function(_292e){return _292e.name!=_292b;})){_2920.push(_292b);}else{_2921=true;}}});}else{_2920=_2923;}if(_2923.length>0){if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_private){dojo.forEach(this.privateTagsToDelete,function(_292f){if(dojo.every(_2923,function(_2930){return _2930!=_292f.name;})){_291c.push(_292f);}else{_2921=true;}});}else{dojo.forEach(this.publicTagsToDelete,function(_2931){if(dojo.every(_2923,function(_2932){return _2932!=_2931.name;})){_291d.push(_2931);}else{_2921=true;}});}}else{_291c=this.privateTagsToDelete;_291d=this.publicTagsToDelete;}this.numberOfTagsToAdd=_2920.length;dojo.forEach(_2920,function(_2933){if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_private){this.isPrivate=true;if(dojo.some(this.myPrivateTags,function(_2934){return _2934.name==_2933;})){this.numberOfTagsToAdd--;if(!this.privateTagAlreadyAssigned){this.displayInfoMessage(this.bundle.text_error_tag_already_assigned,null,this.informationDiv);this.privateTagAlreadyAssigned=true;}if(_2920.length==1){this._displayTags(com.ibm.widgets.AddTag._tagTypePersonal);}}else{if(_2933.length>50||_2933.length<1){this.numberOfTagsToAdd--;this.displayInfoMessage(this.bundle.text_info_length_of_tag_invalid,null,this.informationDiv);_2921=true;}else{if((this.numberOfTagsAdded+this.myPrivateTags.length)>=this.maxPersonalTags){this.numberOfTagsToAdd--;if(!this.maxPersonalPrivateTagsReached){this.displayInfoMessage(dojo.string.substitute(this.bundle.text_info_max_number_of_private_tags_reached,[this.maxPersonalTags]),null,this.informationCell);this.maxPersonalPrivateTagsReached=true;}_2921=true;}else{this.numberOfTagsAdded++;this.storeTag(_2933,this.isPrivate,this.resource);}}}}else{this.isPrivate=false;if(dojo.some(this.myTags,function(myTag){return myTag.name==_2933;})){this.numberOfTagsToAdd--;if(!this.publicTagAlreadyAssigned){this.displayInfoMessage(this.bundle.text_error_tag_already_assigned,null,this.informationDiv);this.publicTagAlreadyAssigned=true;}if(_2920.length==1){this._displayTags(com.ibm.widgets.AddTag._tagTypePersonal);}}else{if(_2933.length>50||_2933.length<1){this.numberOfTagsToAdd--;this.displayInfoMessage(this.bundle.text_info_length_of_tag_invalid,null,this.informationDiv);_2921=true;}else{if((this.numberOfTagsAdded+this.myTags.length)>=this.maxPersonalTags){this.numberOfTagsToAdd--;if(!this.maxPersonalPublicTagsReached){this.displayInfoMessage(dojo.string.substitute(this.bundle.text_info_max_number_of_public_tags_reached,[this.maxPersonalTags]),null,this.informationCell);this.maxPersonalPublicTagsReached=true;}_2921=true;}else{this.numberOfTagsAdded++;this.storeTag(_2933,this.isPrivate,this.resource);}}}}},this);dojo.attr(this.tagNameInput,"displayedValue","");}else{_291c=this.privateTagsToDelete;_291d=this.publicTagsToDelete;}if(_291c.length>0&&_2922.length>0){dojo.forEach(_291c,function(_2935){if(dojo.every(_2922,function(_2936){return _2936.name!=_2935.name;})){_291e.push(_2935);}else{_2921=true;}});}else{if(_291d.length>0&&_2922.length>0){dojo.forEach(_291d,function(_2937){if(dojo.every(_2922,function(_2938){return _2938.name!=_2937.name;})){_291f.push(_2937);}else{_2921=true;}});}else{_291e=_291c;_291f=_291d;}}var _2939;var _293a=[];dojo.forEach(_2922,function(_293b){_293a.push(this._deleteAllUsersTags(_293b.delAllLink,_293b.name));},this);if(_291e.length>0){if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_private){dojo.forEach(_291e,function(_293c){_293a.push(this.deleteTagByLink(_293c.delLink,com.ibm.widgets.AddTag._tagScope_personal_private));},this);this.numberOfTagsToDelete=_291e.length;}}else{if(_291f.length>0){if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_public){dojo.forEach(_291f,function(_293d){_293a.push(this.deleteTagByLink(_293d.delLink,com.ibm.widgets.AddTag._tagScope_personal_public));},this);this.numberOfTagsToDelete=_291f.length;}}}if(_293a.length>0){_2939=new dojo.DeferredList(_293a);_2939.addCallback(dojo.hitch(this,function(){var st=this.getTagStore();st.saveScheme("tm",{onError:this._onSaveErrors,onComplete:this._onSave,scope:this});}));}this._triggerRefresh=_2921;if(this._triggerRefresh){if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_public){this.refreshCollaborativeTags();this.refreshMyTags();}else{this.refreshPrivateTags();}}if(this.itemsToSave.length>0){this.getTagStore().saveScheme("tm",{onError:this._onSaveErrors,onComplete:this._onSave,scope:this});}this.privateTagsToDelete=[];this.publicTagsToDelete=[];this.tagSpacesToDelete=[];this.maxPersonalPublicTagsReached=false;this.publicTagAlreadyAssigned=false;this.maxPersonalPrivateTagsReached=false;this.privateTagAlreadyAssigned=false;this.numberOfTagsAdded=0;this.traceExit(m);},storeTag:function(tag){var m="storeTag(tag)";this.traceEntry(m);this.trace(m,"tag : ",[tag]);this.trace(m,"parameters : ",[this.resource,this.resourceCategories]);var item;if(this.resourceCategories!==null){item=this.getTagStore().newItem({scheme:"tm",isPrivate:this.isPrivate,locale:this.locale,tagname:tag,title:tag,resourceURI:this.resource,category:this.resourceCategories});}else{item=this.getTagStore().newItem({scheme:"tm",isPrivate:this.isPrivate,locale:this.locale,tagname:tag,title:tag,resourceURI:this.resource});}this.itemsToSave.push(item);this.traceExit(m);},refreshCollaborativeTags:function(){var m="refreshCollaborativeTags()";this.traceEntry(m);this._tagData=null;this.isPreventCache=true;this.fetchTags();this._triggerRefresh=false;this.traceExit(m);},refreshMyTags:function(){var m="refreshMyTags()";this.traceEntry(m);this._tagData=null;this.isPreventCache=true;if(!this.isAnonymous){this.fetchMyTags();}this._triggerRefresh=false;this.traceExit(m);},refreshPrivateTags:function(){var m="refreshPrivateTags()";this.traceEntry(m);this._tagData=null;this.isPreventCache=true;if(!this.isAnonymous){this.fetchPrivateTags();}this._triggerRefresh=false;this.traceExit(m);},switchToPrivateView:function(event){var m="switchToPrivateView(event)";this.traceEntry(m);this._checkForMessages();if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_public){this._tagScope=com.ibm.widgets.AddTag._tagScope_personal_private;if(this.customLabelPersonalPrivateTags!==null){dojo.attr(this.myOrPrivateTagsLabel,"innerHTML",this.customLabelPersonalPrivateTags);dojo.attr(this.myOrPrivateTagDiv,"title",this.customLabelPersonalPrivateTags);}if(ibmPortalCPConfig.operations.canCreatePrivateTags){dojo.style(this.tagsInputLabel,"display","block");dojo.style(this.tagsInput,"display","block");this._setComboboxProperties();if(!this._dapLocalePickerButton&&this.localePickerEnabled){this._createLanguageMenu();}}else{dojo.style(this.tagsInputLabel,"display","none");dojo.style(this.tagsInput,"display","none");if(this._dapLocalePickerButton){this._dapLocalePickerButton.destroy();this._dapLocalePickerButton=null;}}if(this.tagNameInput.attr("value")!==""||this.publicTagsToDelete.length>0){this.displayInfoMessage(this.bundle.text_info_changes_lost,null,this.informationCell);}if(this.tagNameInput){dojo.attr(this.tagNameInput,"displayedValue","");}this.publicTagsToDelete=[];this._dapMyTagsForResource.parentNode.removeChild(this._dapMyTagsForResource);this._dapMyTagsForResource=null;this.fetchPrivateTags();dojo.addClass(this.liTabPrivate,"lotusSelected");dojo.removeClass(this.liTabPublic,"lotusSelected");dojo.attr(this.tabPrivate,"selected","true");dojo.attr(this.tabContent,"aria-labelled-by","tabPrivate");this.tabPublic.removeAttribute("selected");}this.traceExit(m);},switchToPublicView:function(event){var m="switchToPublicView(event)";this.traceEntry(m);this._checkForMessages();if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_private){this._tagScope=com.ibm.widgets.AddTag._tagScope_personal_public;if(this.customLabelPersonalPublicTags){dojo.attr(this.myOrPrivateTagsLabel,"innerHTML",this.customLabelPersonalPublicTags);dojo.attr(this.myOrPrivateTagDiv,"title",this.customLabelPersonalPublicTags);}if(ibmPortalCPConfig.operations.canCreatePublicTags){dojo.style(this.tagsInputLabel,"display","block");dojo.style(this.tagsInput,"display","block");this._setComboboxProperties();if(!this._dapLocalePickerButton&&this.localePickerEnabled){this._createLanguageMenu();}}else{dojo.style(this.tagsInputLabel,"display","none");dojo.style(this.tagsInput,"display","none");if(this._dapLocalePickerButton){this._dapLocalePickerButton.destroy();this._dapLocalePickerButton=null;}}if(this.tagNameInput.attr("value")!==""||this.privateTagsToDelete.length>0){this.displayInfoMessage(this.bundle.text_info_changes_lost,null,this.informationCell);}if(this.tagNameInput){dojo.attr(this.tagNameInput,"displayedValue","");}this.privateTagsToDelete=[];this._dapPrivateTagsForResource.parentNode.removeChild(this._dapPrivateTagsForResource);this._dapPrivateTagsForResource=null;this.fetchMyTags();dojo.addClass(this.liTabPublic,"lotusSelected");dojo.removeClass(this.liTabPrivate,"lotusSelected");dojo.attr(this.tabPublic,"selected","true");dojo.attr(this.tabContent,"aria-labelled-by","tabPublic");this.tabPrivate.removeAttribute("selected");}this.traceExit(m);},handleValidation:function(_293e){var m="handleValidation(isValid)";this.traceEntry(m);this.trace(m,"isValid: ",[_293e]);if((_293e===false)&&(this.privateTagsToDelete.length===0)&&(this.publicTagsToDelete.length===0)&&(this.tagSpacesToDelete.length===0)){this.submitDialog.disabled=true;this.submitDialog.className="lotusBtn lotusBtnDisabled trcDisabledButton";}else{if((this.privateTagsToDelete.length>0)||(this.publicTagsToDelete.length>0)||(this.tagSpacesToDelete.length>0)||(_293e===true)){this.submitDialog.disabled=false;this.submitDialog.className="lotusFormButton";}}this.traceExit(m);},errorDisplay:function(err,_293f,_2940){var m="errorDisplay(err, errText, errDetails)";this.traceEntry(m);this.trace(m,"err: ",[err]);this.trace(m,"errText: ",[_293f]);this.trace(m,"errDetails: ",[_2940]);if((err!==null)&&(err.status==401)){top.location.href=document.location.href;}else{dojo.style(this.errorDiv,"display","block");if(_293f&&_293f!=""){dojo.attr(this.errorSpan,"innerHTML",_293f);}if(_2940&&_2940!==""){dojo.attr(this.errorDetailsSpan,"innerHTML",_2940);}}this.traceExit(m);},handleAnonymousCase:function(){var m="handleAnonymousCase()";this.traceEntry(m);if(!ibmPortalCPConfig.operations.canCreatePublicTags){dojo.destroy(this.editSection);}this.traceExit(m);},displayInfoMessage:function(_2941,_2942,dap){var m="displayInfoMessage(message, messageDetails, dap)";this.traceEntry(m);this.trace(m,"message: ",[_2941]);this.trace(m,"messageDetails: ",[_2942]);this.trace(m,"dap: ",[dap]);if(!this._dapInfoDiv){var _2943=dojo.create("div",{role:"status"},dap);dojo.addClass(_2943,"lotusMessage lotusInfo");this._dapInfoDiv=_2943;var _2944=dojo.create("img",{src:this.blankImage,alt:this.bundle.title_info},_2943);_2944.style.width="16px";_2944.style.height="16px";dojo.addClass(_2944,"trcInformationIcon");var _2945=dojo.create("span",{innerHTML:_2941},_2943);}else{if(this._dapInfoDiv.parentNode!=dap){var _2943=dojo.create("div",{role:"status"},dap);dojo.addClass(_2943,"lotusMessage lotusInfo");this._dapInfoDiv=_2943;var _2944=dojo.create("img",{src:this.blankImage,alt:this.bundle.title_info},_2943);_2944.style.width="16px";_2944.style.height="16px";dojo.addClass(_2944,"trcInformationIcon");var _2945=dojo.create("span",{innerHTML:_2941},_2943);}else{var _2946=dojo.create("span",{innerHTML:_2941},this._dapInfoDiv,"last");}}this.traceExit(m);},_createLanguageMenu:function(){var m="_createLanguageMenu()";this.traceEntry(m);this._loadSupportedLanguages();this.traceExit(m);},_loadSupportedLanguages:function(){var m="_loadSupportedLanguages()";this.traceEntry(m);var _2947=this.getTagStore().fetch({query:{uri:"ll:all"},queryOptions:{preventCache:true},onComplete:dojo.hitch(this,"languagesLoaded"),onError:dojo.hitch(this,"errorDisplay")});this.traceExit(m);},languagesLoaded:function(items,_2948){var m="languagesLoaded()";this.traceEntry(m);var _2949="";var _294a=[];if(items.length>0){dojo.forEach(items,function(item){var _294b=this.getTagStore().getValue(item,com.ibm.widgets.AddTag._nameAttribute);var _294c=this.getTagStore().getValue(item,"locale");var _294d=[];_294d.title=_294b;_294d.locale=_294c;_294a.push(_294d);},this);}this.trace(m,"supportedLanguages: ",[_294a]);dojo.forEach(_294a,function(_294e){if(_294e.locale==ibmPortalConfig.locale){_2949=_294e.title;}},this);var _294f=new dijit.Menu({style:"display: none;"});var _2950=_294a;dojo.forEach(_2950,function(_2951){var _2952=new dijit.MenuItem({label:_2951.title,name:_2951.title,onClick:dojo.hitch(this,"changeLocale",_2951.title,_2951.locale)});if(_2951.locale==ibmPortalConfig.locale){_2952.focus();}_294f.addChild(_2952);},this);this._dapLocalePickerButton=new dijit.form.DropDownButton({label:_2949,dropDown:_294f,id:"languageSelector"});dojo.attr(this._dapLocalePickerButton.domNode,"title",this.bundle.title_locale_picker+_2949);dojo.place(this._dapLocalePickerButton.domNode,this.localePicker,"last");this.traceExit(m);},changeLocale:function(title,_2953){var m="changeLocale(title, locale)";this.traceEntry(m);this.trace(m,"title: ",[title]);this.trace(m,"locale: ",[_2953]);dojo.attr(this._dapLocalePickerButton,"label",title);dojo.attr(this._dapLocalePickerButton.domNode,"title",this.bundle.title_locale_picker+title);this.locale=_2953;this.traceExit(m);},_onSaveErrors:function(items,error){var m="_onSaveErrors(items, error)";this.traceEntry(m);this.trace(m,"items.length: ",[items.length]);this.trace(m,"error: ",[error]);if(items){this.messageDetails="";dojo.forEach(this.itemsToSave,function(item){if(items.hasItem(item)){var err=items.getError(item);if(err){if((err.number&&err.number=="http:403")||(err.status&&err.status=="403")){this.numberOfRejectedTags++;if(err.responseText&&(err.responseText!=="")){this.messageDetails+=err.responseText;this.messageDetails+="<br/>";}else{if(err.message&&(err.message!=="")){this.messageDetails+=err.message;this.messageDetails+="<br/>";}}}else{if((err.number&&err.number=="http:409")||(err.status&&err.status=="409")){this.numberOfDuplicateTags++;}else{this.errorDisplay(err,err.message,err.responseText);}}this.numberOfTagsToAdd--;}}},this);}this._onSave([],null);this.itemsToSave=[];this.traceExit(m);},_onSave:function(items,_2954){var m="_onSave(items, request)";this.traceEntry(m);this.trace(m,"items.length: ",[items.length]);if(this.numberOfRejectedTags>0){this.displayInfoMessage(dojo.string.substitute(this.bundle.text_error_tags_rejected,[this.numberOfRejectedTags]),this.messageDetails,this.informationDiv);}if(this.numberOfDuplicateTags>0){this.displayInfoMessage(this.bundle.text_error_tag_already_assigned,null,this.informationDiv);}var msg;if(this.numberOfTagsToAdd!==0&&this.numberOfTagsToAdd&&this.numberOfTagsToDelete!==0&&this.numberOfTagsToDelete){msg=this.bundle.text_success_changes_stored_successfully+this.numberOfTagsToAdd+this.bundle.text_tags_saved+", "+this.numberOfTagsToDelete+this.bundle.text_tags_deleted;}else{if(this.numberOfTagsToAdd!==0&&this.numberOfTagsToAdd){msg=this.bundle.text_success_changes_stored_successfully+this.numberOfTagsToAdd+this.bundle.text_tags_saved;}else{if(this.numberOfTagsToDelete!==0&&this.numberOfTagsToDelete){msg=this.bundle.text_success_changes_stored_successfully+this.numberOfTagsToDelete+this.bundle.text_tags_deleted;}else{if(this._tagSpacesDeleted){msg=this.bundle.text_all_tags_deleted;}else{msg="";}}}}if(this._tagScope==com.ibm.widgets.AddTag._tagScope_personal_private){this.refreshPrivateTags();}else{this.refreshCollaborativeTags();this.refreshMyTags();}if(this._tagSpacesDeleted){this.refreshCollaborativeTags();}if((!this._dapSuccessDiv||!this._dapSuccessDiv)&&(msg!=="")){var _2955=dojo.create("div",{id:"successDiv",role:"status"},this.successMessageDiv);dojo.addClass(_2955,"lotusMessage lotusConfirm");this._dapSuccessDiv=_2955;var _2956=dojo.create("img",{src:this.blankImage,alt:this.bundle.title_confirmation},_2955);_2956.style.width="16px";_2956.style.height="16px";dojo.addClass(_2956,"trcConfirmationIcon");var _2957=dojo.create("span",{innerHTML:msg},_2955);}this.numberOfTagsToAdd=0;this.numberOfTagsToDelete=0;this.handleValidation(false);this.numberOfRejectedTags=0;this._tagSpacesDeleted=false;dojo.publish(this.tagsChangedEventID,[{scope:this._tagScope}]);this.itemsToSave=[];this.traceExit(m);},_cleanArray:function(_2958){var m="_cleanArray(originalTagNames)";this.traceEntry(m);this.trace(m,"originalTagNames: ",[_2958]);var _2959=new Array();dojo.forEach(_2958,function(_295a){if(_295a){dojo.string.trim(_295a);_2959.push(_295a);}},this);this.traceExit(m);return _2959;},_checkForMessages:function(){var m="_checkForMessages()";this.traceEntry(m);if(this.errorDiv.style.display=="block"){this.errorDiv.style.display="none";}if(this._dapSuccessDiv){dojo.fadeOut({node:this._dapSuccessDiv,duration:this.messageFadeOutDuration,onEnd:dojo.hitch(this,function(){dojo.destroy(this._dapSuccessDiv);this._dapSuccessDiv=null;})}).play();}if(this._dapInfoDiv){dojo.fadeOut({node:this._dapInfoDiv,duration:this.messageFadeOutDuration,onEnd:dojo.hitch(this,function(){dojo.destroy(this._dapInfoDiv);this._dapInfoDiv=null;})}).play();}this.traceExit(m);},_setComboboxProperties:function(){var m="_setComboboxProperties()";this.traceEntry(m);dojo.connect(this.tagNameInput,"onKeyDown",dojo.hitch(this,"_checkForMessages"));dojo.connect(this.tagNameInput,"onClick",dojo.hitch(this,"_checkForMessages"));dojo.connect(this.tagNameInput.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit"));this.tagNameInput.parentWidget=this.parentWidget;this.tagNameInput.domNode.title=this.bundle.title_input_tag_names;dojo.attr(this.tagNameInput,"title",this.tagNameInput.domNode.title);this.tagNameInput.validationCallback=function(_295b){this.parentWidget.handleValidation(_295b);};this.tagNameInput.regExp=this.validationRegex;this.tagNameInput.typeAheadFetchURL=ibmPortalConfig.contentHandlerURI+"?uri=tos:typeahead&term=${searchTerm}";this.traceExit(m);},_determineResourceType:function(){var m="_setComboboxProperties()";this.traceEntry(m);this.trace(m,"resourceType: ",[this.resourceType]);switch(this.resourceType){case com.ibm.widgets.AddTag._RESOURCE_TYPE_CONTENT_NODE:this.resourceSchema=com.ibm.widgets.AddTag._navigationModelSchema;this.resource=com.ibm.widgets.AddTag._resourceModelSchema+this.resourceSchema+this.resourceID;break;case com.ibm.widgets.AddTag._RESOURCE_TYPE_NAVIGATION_NODE:this.resourceSchema=com.ibm.widgets.AddTag._portletModelSchema;this.resource=com.ibm.widgets.AddTag._resourceModelSchema+this.resourceSchema+this.resourceID;break;default:this.resource=com.ibm.widgets.AddTag._resourceModelSchema+this.resourceID;break;}this.traceExit(m);},_checkKeySubmit:function(event){var m="_checkKeySubmit(event)";this.traceEntry(m);if(event.keyCode==dojo.keys.ENTER){if(!this.submitDialog.disabled){var input=this.tagNameInput.attr("value");this.handleCreatesAndDeletes(event,input);}}this.traceExit(m);},_cleanArrayFromDuplicates:function(_295c){var _295d={};return dojo.filter(_295c,function(_295e){if(!_295d[_295e]){_295d[_295e]=true;return true;}return false;}).sort();},_determineTabDisplay:function(){var m="_determineTabDisplay()";this.traceEntry(m);if(this.resourcePrivate){dojo.style(this.liTabPublic,"display","none");this.tabPrivate.title=this.bundle.button_private;dojo.style(this.tagsInputLabel,"display","block");dojo.style(this.tagsInput,"display","block");dojo.addClass(this.liTabPrivate,"lotusSelected");dojo.removeClass(this.liTabPublic,"lotusSelected");dojo.attr(this.tabPrivate,"selected","true");this.tabPublic.removeAttribute("selected");dojo.removeAttr(this.tabContent,"aria-labelledby");dojo.attr(this.tabContent,"aria-labelledby","tabPrivate");this._setComboboxProperties();if(this.localePickerEnabled){this._createLanguageMenu();}}else{if(ibmPortalCPConfig.operations.canCreatePublicTags){this._setComboboxProperties();if(this.localePickerEnabled){this._createLanguageMenu();}}else{dojo.style(this.tagsInputLabel,"display","none");dojo.style(this.tagsInput,"display","none");}}if(!this.privateTaggingEnabled){dojo.style(this.liTabPrivate,"display","none");}if(this.defaultView==com.ibm.widgets.AddTag._viewPrivate&&this.liTabPrivate.style.display!="none"){dojo.addClass(this.liTabPrivate,"lotusSelected");dojo.removeClass(this.liTabPublic,"lotusSelected");dojo.attr(this.tabPrivate,"selected","true");this.tabPublic.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPrivate");}else{if(this.defaultView==com.ibm.widgets.AddTag._viewPublic&&this.liTabPublic.style.display!="none"){dojo.addClass(this.liTabPublic,"lotusSelected");dojo.removeClass(this.liTabPrivate,"lotusSelected");dojo.attr(this.tabPublic,"selected","true");this.tabPrivate.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPublic");}}if(!this.displayTabs){dojo.style(this.liTabPublic,"display","none");dojo.style(this.liTabPrivate,"display","none");}if(!this.mineTaggingEnabled){dojo.style(this.myOrPrivateTags,"display","none");}this.traceExit(m);},_displayLoading:function(_295f){var m="_displayLoading(tagType)";this.traceEntry(m);this.trace(m,"tagType: ",[_295f]);if(_295f==com.ibm.widgets.AddTag._tagTypePersonal){dojo.style(this.personalLoadingDiv,"display","block");dojo.style(this.myOrPrivateTagDiv,"display","none");}else{dojo.style(this.loadingDiv,"display","block");dojo.style(this.tagDiv,"display","none");}this.traceExit(m);},_displayTags:function(_2960){var m="_displayTags(tagType)";this.traceEntry(m);this.trace(m,"tagType: ",[_2960]);if(_2960==com.ibm.widgets.AddTag._tagTypePersonal){dojo.style(this.personalLoadingDiv,"display","none");dojo.style(this.myOrPrivateTagDiv,"display","block");}else{dojo.style(this.loadingDiv,"display","none");dojo.style(this.tagDiv,"display","block");}this.traceExit(m);},_initializeEvents:function(){var m="_initializeEvents()";this.traceEntry(m);this.submitDialog.onclick=dojo.hitch(this,function(){this.handleCreatesAndDeletes();return false;});this.closeButtonNode.onclick=this.dialogCancel.onclick=dojo.hitch(this,function(){this.cancelTags();return false;});this.tabPublic.onclick=dojo.hitch(this,function(){this.switchToPublicView();return false;});this.tabPrivate.onclick=dojo.hitch(this,function(){this.switchToPrivateView();return false;});this.traceExit(m);},_initializeWidget:function(){var m="_initializeEvents()";this.traceEntry(m);this._determineTabDisplay();this.handleValidation(false);this._initializeEvents();dojo.attr(this.titleNode,"innerHTML",dojo.string.substitute(this.bundle.text_tag,[com.ibm.domUtilities.encodeXML(this.resourceTitle)]));this._determineResourceType();this.fetchTags();if(!this.isAnonymous&&!this.resourcePrivate&&this.defaultView!=com.ibm.widgets.AddTag._viewPrivate){this.fetchMyTags();}else{if(this.resourcePrivate||this.defaultView==com.ibm.widgets.AddTag._viewPrivate){this.fetchPrivateTags();}}this.privateTagsToDelete=[];this.publicTagsToDelete=[];this.tagSpacesToDelete=[];this.traceExit(m);},_initializeParameters:function(){var m="_initializeParameters()";this.traceEntry(m);this.trace(m,"this.params",this.params);if(!("validationRegex" in this.params)){if(ibmPortalCPConfig.tagging.validation.validationRegex!=null){this.validationRegex=ibmPortalCPConfig.tagging.validation.validationRegex;}else{this.validationRegex=com.ibm.widgets.AddTag._validationRegex;}}if(!("orderMetric" in this.params)){if(ibmPortalCPConfig.tagging.dialog.orderMetric!=null){this.orderMetric=ibmPortalCPConfig.tagging.dialog.orderMetric;}else{this.orderMetric=com.ibm.widgets.AddTag._orderMetric;}}if(!("order" in this.params)){if(ibmPortalCPConfig.tagging.dialog.order!=null){this.order=ibmPortalCPConfig.tagging.dialog.order;}else{this.order=com.ibm.widgets.AddTag._order;}}if(!("messageFadeOutDuration" in this.params)){if(ibmPortalCPConfig.tagging.dialog.messageFadeOutDuration!=null){this.messageFadeOutDuration=ibmPortalCPConfig.tagging.dialog.messageFadeOutDuration;}else{this.messageFadeOutDuration=com.ibm.widgets.AddTag._messageFadeOutDuration;}}if(!("resolver" in this.params!==null)){this.tagStore=ibmPortalConfig.resolver;}if(!("maxCommunityTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.maxCommunityTags!=null){this.maxCommunityTags=ibmPortalCPConfig.tagging.dialog.maxCommunityTags;}else{this.maxCommunityTags=com.ibm.widgets.AddTag._maxCommunityTags;}}if(!("maxPersonalTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.maxPersonalTags!=null){this.maxPersonalTags=ibmPortalCPConfig.tagging.dialog.maxPersonalTags;}else{this.maxPersonalTags=com.ibm.widgets.AddTag._maxPersonalTags;}}if(!("defaultView" in this.params)){if(ibmPortalCPConfig.tagging.dialog.defaultView!=null){this.defaultView=ibmPortalCPConfig.tagging.dialog.defaultView;}else{this.defaultView=com.ibm.widgets.AddTag._viewPublic;}}if(!("deletingEnabled" in this.params)){if(ibmPortalCPConfig.tagging.dialog.deletingEnabled!=null){this.deletingEnabled=ibmPortalCPConfig.tagging.dialog.deletingEnabled;}else{this.deletingEnabled=com.ibm.widgets.AddTag._deletingEnabled;}}if(!("countsEnabled" in this.params)){if(ibmPortalCPConfig.tagging.dialog.countsEnabled!=null){this.countsEnabled=ibmPortalCPConfig.tagging.dialog.countsEnabled;}else{this.countsEnabled=com.ibm.widgets.AddTag._countsEnabled;}}if(!("customLabelCommunityTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.customLabelCommunityTags!=null){this.customLabelCommunityTags=ibmPortalCPConfig.tagging.dialog.customLabelCommunityTags;}else{this.customLabelCommunityTags=null;}}if(!("customLabelPersonalPublicTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.customLabelPersonalPublicTags!=null){this.customLabelPersonalPublicTags=ibmPortalCPConfig.tagging.dialog.customLabelPersonalPublicTags;}else{this.customLabelPersonalPublicTags=null;}}if(!("customLabelPersonalPrivateTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.customLabelPersonalPrivateTags!=null){this.customLabelPersonalPrivateTags=ibmPortalCPConfig.tagging.dialog.customLabelPersonalPrivateTags;}else{this.customLabelPersonalPrivateTags=null;}}if(!("customLabelAddTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.customLabelAddTags!=null){this.customLabelAddTags=ibmPortalCPConfig.tagging.dialog.customLabelAddTags;}else{this.customLabelAddTags=null;}}if(!("privateTaggingEnabled" in this.params)){if(ibmPortalCPConfig.tagging.dialog.privateTaggingEnabled!=null){this.privateTaggingEnabled=ibmPortalCPConfig.tagging.dialog.privateTaggingEnabled;}else{this.privateTaggingEnabled=com.ibm.widgets.AddTag._privateTaggingEnabled;}}if(!("displayTabs" in this.params)){if(ibmPortalCPConfig.tagging.dialog.displayTabs!=null){this.displayTabs=ibmPortalCPConfig.tagging.dialog.displayTabs;}else{this.displayTabs=com.ibm.widgets.AddTag._displayTabs;}}if(!("localePickerEnabled" in this.params)){if(ibmPortalCPConfig.tagging.dialog.localePickerEnabled!=null){this.localePickerEnabled=ibmPortalCPConfig.tagging.dialog.localePickerEnabled;}else{this.localePickerEnabled=com.ibm.widgets.AddTag._localePickerEnabled;}}if(!("customMessageNoCommunityTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.customMessageNoCommunityTags!=null){this.customMessageNoCommunityTags=ibmPortalCPConfig.tagging.dialog.customMessageNoCommunityTags;}else{this.customMessageNoCommunityTags=null;}}if(!("customMessageNoPersonalTags" in this.params)){if(ibmPortalCPConfig.tagging.dialog.customMessageNoPersonalTags!=null){this.customMessageNoPersonalTags=ibmPortalCPConfig.tagging.dialog.customMessageNoPersonalTags;}else{this.customMessageNoPersonalTags=null;}}this.traceExit(m);},_deleteAllUsersTags:function(_2961,_2962){var m="_deleteAllUsersTags(deleteURL, tagName)";this.traceEntry(m);this.trace(m,"deleteURL: ",[_2961]);this.trace(m,"tagName: ",[_2962]);this._tagSpacesDeleted=true;this._deletedTagSpaceName=_2962;var def=new dojo.Deferred();def.addCallback(dojo.hitch(this,function(_2963,_2964){this.deleteTagsInStore(_2963,_2964);}));callback=dojo.hitch(this,function(_2965,_2966){def.callback(_2965,_2966);});this.tagStore.fetch({query:this.tagStore.urlToQuery(_2961,"tm"),queryOptions:{preventCache:true,bypassBatch:true},onComplete:callback,onError:null,scope:this});this.traceExit(m);return def;},_getFocusItems:function(_2967){var _2968=this.containerNode;this.containerNode=_2967;this.inherited(arguments);this.containerNode=_2968;}});com.ibm.widgets.AddTag._nameAttribute="title";com.ibm.widgets.AddTag._countAttribute="count";com.ibm.widgets.AddTag._deleteLinkAttribute="deleteLink";com.ibm.widgets.AddTag._deleteAllLinkAttribute="deleteAllLink";com.ibm.widgets.AddTag._resourceModelSchema="rm:";com.ibm.widgets.AddTag._portletModelSchema="pm:oid:";com.ibm.widgets.AddTag._navigationModelSchema="nm:oid:";com.ibm.widgets.AddTag._cpUserModelSchema="cpum:oid:";com.ibm.widgets.AddTag._tagSpaceEmptyURI="tm:ts:empty";com.ibm.widgets.AddTag._tagTypePersonal="personal";com.ibm.widgets.AddTag._viewPrivate="PRIVATE";com.ibm.widgets.AddTag._viewPublic="PUBLIC";com.ibm.widgets.AddTag._tagScope_community="community";com.ibm.widgets.AddTag._tagScope_personal_public="personal_public";com.ibm.widgets.AddTag._tagScope_personal_private="personal_private";com.ibm.widgets.AddTag._tagScope_community_plus_personal_public=["personal_public","community"];com.ibm.widgets.AddTag._validationRegex="[^<>()[]:]{1,50}";com.ibm.widgets.AddTag._orderMetric="tag_space_count_reverse_name";com.ibm.widgets.AddTag._order="DESC";com.ibm.widgets.AddTag._messageFadeOutDuration=1000;com.ibm.widgets.AddTag._maxCommunityTags=50;com.ibm.widgets.AddTag._maxPersonalTags=50;com.ibm.widgets.AddTag._deletingEnabled=true;com.ibm.widgets.AddTag._countsEnabled=false;com.ibm.widgets.AddTag._privateTaggingEnabled=true;com.ibm.widgets.AddTag._displayTabs=true;com.ibm.widgets.AddTag._localePickerEnabled=true;com.ibm.widgets.AddTag._parameterMap_Key_RenderMode="renderMode";com.ibm.widgets.AddTag._parameterMap_Value_RenderMode_WSRP="wsrp";com.ibm.widgets.AddTag._RESOURCE_TYPE_CONTENT_NODE="CONTENT_NODE";com.ibm.widgets.AddTag._RESOURCE_TYPE_NAVIGATION_NODE="NAVIGATION_NODE";}if(!dojo._hasResource["com.ibm.widgets.AddRatingChart"]){dojo._hasResource["com.ibm.widgets.AddRatingChart"]=true;dojo.provide("com.ibm.widgets.AddRatingChart");dojo.declare("com.ibm.widgets.AddRatingChart",[dijit._Widget,dijit._Templated,com.ibm.widgets._Traceable],{blankImgUrl:dojo.moduleUrl("dojo","resources/blank.gif").toString(),bIsTracing:false,_starCount:5,values:[],max:0,sizes:[],txts:[],titles:[],hiddenImgs:[],bundle:null,LTR:"LTR",RTL:"RTL",bidi:null,fillSymbols:"++++++++++",emptySymbols:"----------",templateString:"<table class='lotusVertTable' border='0' summary='${bundle.title_community_rating_distribution}' id='ratingDistributionWidget' name='ratingDistributionWidget' dojoAttachPoint='ratingDistributionTable'>"+"<tbody id='ratingDistributionTableBody' dojoAttachPoint='ratingDistributionTableBody'></tbody></table>",constructor:function(){this.inherited("constructor","com.ibm.widgets.AddRatingChart");this.bIsTracing=this.isTracing();this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","AddRating");if(this.bidi===null){if(this.isLeftToRight()){this.bidi=this.LTR;}else{this.bidi=this.RTL;}}this._starCount=ibmPortalCPConfig.rating.dialog.numStars;},initializeTable:function(){if(this.bIsTracing){var m="initializeTable()";this.traceEntry(m);}var tr;var th;var td;var span;var span2;var img;if(this.bIsTracing){this.trace(m,"this._starCount",this._starCount);}for(var i=this._starCount-1;i>=0;i--){tr=dojo.doc.createElement("tr");th=dojo.doc.createElement("th");dojo.attr(th,"scope","row");th.innerHTML=dojo.string.substitute(this.bundle["text_stars_count"],[(i+1)]);dojo.place(th,tr,"last");td=dojo.doc.createElement("td");img=dojo.doc.createElement("img");dojo.attr(img,"src",this.blankImgUrl);dojo.place(img,td,"first");this.hiddenImgs[i]=img;span=dojo.doc.createElement("span");dojo.attr(span,"class","trcRatingDistributionEmptyBar");dojo.place(span,td,"last");this.titles[i]=span;span2=dojo.doc.createElement("span");dojo.attr(span2,"class","trcRatingDistributionEmptyFillBar");dojo.place(span2,span,"last");this.sizes[i]=span2;dojo.place(td,tr,"last");hcmSpan=dojo.doc.createElement("span");dojo.attr(hcmSpan,"class","trcRatingDistributionText");dojo.place(hcmSpan,span2,"last");td=dojo.doc.createElement("td");dojo.place(dojo.doc.createTextNode("("),td,"last");span=dojo.doc.createElement("span");this.txts[i]=span;dojo.place(span,td,"last");dojo.place(dojo.doc.createTextNode(")"),td,"last");dojo.place(td,tr,"last");dojo.place(tr,this.ratingDistributionTableBody,"last");}if(this.bIsTracing){this.traceExit(m);}},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}this.inherited(arguments);this.initializeTable();this.update();if(this.bIsTracing){this.traceExit(m);}},update:function(array){if(this.bIsTracing){var m="update(array)";this.traceEntry(m,array);}this.max=0;if(array){this.values=array;}var i;for(i=0;i<this._starCount;i++){if(this.max<this.values[i]){this.max=this.values[i];}}if(this.bIsTracing){this.trace(m,"this.max",this.max);}if(this.max===0){this.max=1;}if(this.bIsTracing){this.trace(m,"this.max",this.max);}for(i=0;i<this._starCount;i++){dojo.query(this.sizes[i]).forEach(function(node,index,arr){var _2969=this.values[i]/this.max*100;if(this.bIsTracing){this.trace(m,"currentRatingDistributionValue",_2969);}dojo.style(node,"width",_2969+"%");if(this.bidi==this.RTL){dojo.style(node,"float","right");}var _296a=dojo.number.round(_2969/10);if(this.bIsTracing){this.trace(m,"roundedCurrentRatingDistributionValue",_296a);}node.childNodes[0].innerHTML=this.fillSymbols.substring(0,_296a)+this.emptySymbols.substring(_296a,10);},this);this.txts[i].innerHTML=this.values[i];dojo.attr(this.titles[i],"title",dojo.string.substitute(this.bundle["title_rating_distribution"],[this.values[i],(i+1)]));dojo.attr(this.hiddenImgs[i],"alt",dojo.string.substitute(this.bundle["title_rating_distribution"],[this.values[i],(i+1)]));}if(this.bIsTracing){this.traceExit(m);}}});}if(!dojo._hasResource["com.ibm.widgets.Rating"]){dojo._hasResource["com.ibm.widgets.Rating"]=true;dojo.provide("com.ibm.widgets.Rating");dojo.declare("com.ibm.widgets.Rating",[dijit.form._FormWidget],{templateString:null,LTR:"LTR",RTL:"RTL",numStars:5,value:0,bidi:null,hoverable:true,clickable:true,halfStarSupport:false,titleText:"",_MODE_HOVER:"HOVER",_MODE_CHECK:"CHECK",_mode:"HOVER",_dijitInline:"dijitInline",_focused:"Focused",_dijitFocused:"dijitFocused",_ratingContainer:"trcRatingContainer",_ratingStar:"trcRatingStar",_ratingStarHovered:"trcRatingStarHover",_ratingStarChecked:"trcRatingStarChecked",_ratingStarLeftHalfChecked:"trcRatingStarLeftHalfChecked",_ratingStarRightHalfChecked:"trcRatingStarRightHalfChecked",_ratingStarWidth:15,_ratingStarHeight:15,_ratingStarText:"trcRatingStarText",_ratingStarText_Symbol:"o",_ratingStarText_HoveredSymbol:"x",_ratingStarText_CheckedSymbol:"*",constructor:function(_296b){dojo.mixin(this,_296b);if(this.bidi===null){if(this.isLeftToRight()){this.bidi=this.LTR;}else{this.bidi=this.RTL;}}var _296c=this.numStars*this._ratingStarWidth;var _296d="<div class=\""+this._ratingContainer+" dijitInline dijitFocused Focused\" role=\"link\" title=\""+this.titleText+"\" dojoAttachPoint=\"focusNode\" widgetid=\"trcRatingWidget\"><ul style=\"width:"+_296c+"px\">${stars}</ul></div>";var _296e="<li class=\""+this._ratingStar+" dijitInline\" dojoAttachEvent=\"onclick:onStarClick, onmouseover:_onMouseOver, onmouseout:_onMouseOut\" value=\"${value}\"><span class=\""+this._ratingStarText+"\" dojoAttachEvent=\"onclick:onStarClick, onmouseover:_onMouseOver, onmouseout:_onMouseOut\" value=\"${value}\">"+this._ratingStarText_Symbol+"</span></li>";var _296f="";for(var star=1;star<=this.numStars;star++){_296f+=dojo.string.substitute(_296e,{value:star});}this.templateString=dojo.string.substitute(_296d,{stars:_296f});},postCreate:function(){this.inherited(arguments);this._updateStars(this.value,this._MODE_CHECK);},_onMouseOver:function(event){if(this.hoverable){var _2970=event.target;var _2971=_2970.getAttribute("value");this._updateStars(_2971,this._MODE_HOVER);}},_onMouseOut:function(event){if(this.hoverable){dojo.query("."+this._ratingStarHovered,this.domNode).forEach(function(node,index,arr){dojo.removeClass(node,this._ratingStarHovered);},this);this._updateStars(this.value,this._MODE_CHECK);}},onStarClick:function(event){if(this.clickable){var _2972=event.target;var _2973=_2972.getAttribute("value");this.value=_2973;this._updateStars(_2973,this._MODE_CHECK);}},setAttribute:function(key,value){if(key=="value"){this.value=value;this._updateStars(value,this._MODE_CHECK);}else{if(key=="bidi"){this.bidi=value;this._updateStars(this.value,this._MODE_CHECK);}else{if(key=="hoverable"){this.hoverable=value;}else{if(key=="clickable"){this.clickable=value;}else{if(key=="halfStarSupport"){this.halfStarSupport=value;this._updateStars(this.value,this._MODE_CHECK);}}}}}},_updateStars:function(_2974,mode){var _2975=this._roundStars(_2974);var _2976=null;if(mode==this._MODE_HOVER){_2976=this._ratingStarHovered;}else{if(mode==this._MODE_CHECK){_2976=this._ratingStarChecked;}}var _2977=this._ratingStarText_Symbol;if(mode==this._MODE_HOVER){_2977=this._ratingStarText_HoveredSymbol;}else{if(mode==this._MODE_CHECK){_2977=this._ratingStarText_CheckedSymbol;}}dojo.query("."+this._ratingStar,this.domNode).forEach(function(node,index,arr){dojo.removeClass(node,this._ratingStarHovered);dojo.removeClass(node,this._ratingStarChecked);dojo.removeClass(node,this._ratingStarLeftHalfChecked);dojo.removeClass(node,this._ratingStarRightHalfChecked);node.childNodes[0].innerHTML=this._ratingStarText_Symbol;var _2978=node.value;if(_2978<=_2975){dojo.addClass(node,_2976);node.childNodes[0].innerHTML=_2977;}else{if(this.halfStarSupport){if(_2978-_2975==0.5){if(this.bidi==this.LTR){dojo.addClass(node,this._ratingStarLeftHalfChecked);}else{dojo.addClass(node,this._ratingStarRightHalfChecked);}node.childNodes[0].innerHTML=_2977;}}}},this);},_roundStars:function(value){if(this.halfStarSupport){return dojo.number.round(value,0,5);}else{return dojo.number.round(value);}}});}if(!dojo._hasResource["com.ibm.widgets.AddRating"]){dojo._hasResource["com.ibm.widgets.AddRating"]=true;dojo.provide("com.ibm.widgets.AddRating");dojo.declare("com.ibm.widgets.AddRating",[dijit.Dialog,com.ibm.widgets._Traceable],{widgetsInTemplate:true,bIsTracing:false,resourceID:"",resourceTitle:"",resourceType:"",resourceCategories:null,resourcePrivate:false,messageFadeOutDuration:1000,numStars:5,defaultView:"PUBLIC",deletingEnabled:true,customLabelCommunityRatings:"",customLabelPersonalPublicRatings:"",customLabelPersonalPrivateRatings:"",privateRatingEnabled:true,mineRatingEnabled:true,displayTabs:true,genericParameterMap:null,resourceSchema:"",resource:null,ratingValue:"",currentIsMineRating:null,currentPrivateRating:null,newIsMineRating:null,newPrivateRating:null,currentAnonymousRating:null,newAnonymousRating:null,myChart:null,isAnonymous:false,isPreventCache:false,_checkDialog:null,isPrivate:false,ratingStore:null,ratingData:null,ratingsChangedEventID:"",ratingsChangedEvent:"ratingsChanged",_ratingScope:"community",_actionAddIsMineRating:false,_actionAddPrivateRating:false,_actionUpdateIsMineRating:false,_actionUpdatePrivateRating:false,_actionDeletePrivateRating:false,_actionDeleteIsMineRating:false,_actionAddAnonymousRating:false,_actionDeleteAllRatingsOfResource:false,_dapCollaborativeRatingDiv:null,_dapIsMineRatingDiv:null,_dapPrivateRatingDiv:null,_dapSuccessDiv:null,_dapInfoDiv:null,_dapChartDiv:null,_deleteAllLink:null,connectionHandlers:[],connectionHandlersPrivate:[],templateString:null,templateString:"<div class=\"lotusDialogBorder lotusui\" waistate=\"labelledby-${id}\" wairole=\"dialog\" role=\"dialog\" index=\"-1\" aria-labelledby=\"${id}\" dojoAttachPoint=\"addTagDiv\">\n\t<div class=\"lotusDialog trc trcRating trcDialog trcDialogRating\">\n\t\t<h1>\n\t\t\t<a href=\"javascript:void(0);\" dojoAttachPoint=\"closeButtonNode\" class=\"lotusBtnImg lotusClose\" title=\"${bundle.title_close_widget}\">\n\t\t\t\t<img src=\"${blankImage}\" alt=\"\" aria-label=\"${bundle.title_close_widget}\" />\n\t\t\t\t\t<span class=\"lotusAltText\">X</span>\n\t\t\t</a>\n\t\t\t<span dojoAttachPoint=\"titleNode\"></span>\n\t\t</h1>\n\t\t<form dojoAttachPoint=\"addRatingForm\" id=\"addForm\" class=\"lotusDialog\">\n\t\t\t<div dojoAttachPoint=\"containerNode\" class=\"lotusDialogContent trcDialogContent\">\n\t\t\t\t<div dojoAttachPoint=\"errorDiv\" id=\"errorDiv\" title=\"${bundle.title_error_message}\" style=\"display:none;\" class=\"lotusMessage\">\n\t\t\t\t\t<img src=\"${blankImage}\" width=\"16\" height=\"16\" class=\"trcErrorIcon\" alt=\"${bundle.title_error_message}\" /> \n\t\t\t\t\t\t<span dojoAttachPoint=\"errorSpan\"></span>\n\t\t\t\t\t<div style=\"background-color: white;\" style=\"display:block;\">\n\t\t\t\t\t  <span dojoAttachPoint=\"errorDetailsSpan\"></span>\n\t\t\t\t\t</div> \n\t\t\t\t</div>\n\t\t\t\t<div dojoAttachPoint=\"successMessageDiv\" id=\"successMessageDiv\"></div>\n\t\t\t\t<fieldset dojoAttachPoint=\"mainContentDiv\" class=\"trcFieldset\">\n\t\t\t\t\t<table class=\"lotusFormTable\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" summary=\"\">\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr class=\"lotusFieldRow\">\n\t\t\t\t\t\t\t<td dojoAttachPoint=\"communityRatingsLabel\" colspan=\"2\" class=\"trcText\" title=\"${bundle.title_community_rating}\">${bundle.text_community_rating_for_this_resource}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td dojoAttachPoint=\"loadingDiv\" >\n\t\t\t\t\t\t\t\t<span class=\"lotusLoading\"><img width=\"20\" height=\"20\" src=\"${blankImage}\"></span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr class=\"lotusFieldRow\" dojoAttachPoint=\"communityRatingRow\">\n\t\t\t\t\t\t\t<td dojoAttachPoint=\"collaborativeRatingDiv\" class=\"trc75CellWidth\" title=\"${bundle.title_community_rating}\"></td>\n\t\t\t\t\t\t\t<td dojoAttachPoint=\"deleteAllLink\"><a href=\"javascript:;\" dojoAttachPoint=\"deleteAllLinkAnchor\" class=\"lotusAction trcRatingDelete\" role=\"link\" title=\"${bundle.title_delete_ratings_for_this_resource}\">${bundle.link_delete}</a></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr class=\"lotusFieldRow\">\n\t\t\t\t\t\t\t<td colspan=\"2\" dojoAttachpoint=\"collaborativeRatingDistributionDiv\" title=\"${bundle.title_community_rating_distribution}\"></td>\n\t\t\t\t\t\t</tr>\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t<tr class=\"lotusFieldRow\"> \n\t\t\t\t\t\t\t<td colspan=\"2\" dojoAttachPoint=\"editSection\">\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"editTabs\" class=\"lotusTabContainer\">\n\t\t\t\t\t\t\t\t\t<ul class=\"lotusTabs\">\n\t\t\t\t\t\t\t\t\t\t<li dojoAttachPoint=\"liTabPublic\" role=\"tab\" class=\"lotusSelected\"><div><a id=\"tabPublic\" dojoAttachPoint=\"tabPublic\" title=\"${bundle.title_switch_to_pub_view}\" selected=\"true\" href=\"javascript:;\"><strong>${bundle.button_public}</strong></a></div></li>\n\t\t\t\t\t\t\t\t\t\t<li dojoAttachPoint=\"liTabPrivate\" role=\"tab\"><div><a id=\"tabPrivate\" dojoAttachPoint=\"tabPrivate\" title=\"${bundle.title_switch_to_priv_view}\" href=\"javascript:;\">${bundle.button_private}</a></div></li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div dojoAttachPoint=\"tabContent\" role=\"tabpanel\" class=\"lotusTabContent\" aria-labelledby=\"tabPublic\" aria-hidden=\"false\">\n\t\t\t\t\t\t\t\t<table class=\"trcTabTable\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\" dojoAttachPoint=\"informationCell\"></td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr class=\"lotusFieldRow\">\n\t\t\t\t\t\t\t\t\t\t<td dojoAttachpoint=\"isMineOrPrivateRatingLabel\" class=\"trcText trc75CellWidth\" title=\"${bundle.title_your_rating}\">${bundle.text_your_rating_for_this_resource}</td>\n\t\t\t\t\t\t\t\t\t\t<td>&nbsp;</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td dojoAttachPoint=\"personalLoadingDiv\" >\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"lotusLoading\"><img width=\"20\" height=\"20\" src=\"${blankImage}\"></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr class=\"lotusFieldRow\" dojoAttachPoint=\"personalRatingRow\">\n\t\t\t\t\t\t\t\t\t\t<td dojoAttachpoint=\"isMineOrPrivateRatingDiv\"></td>\n\t\t\t\t\t\t\t\t\t\t<td dojoAttachPoint=\"deleteLink\"><a href=\"javascript:;\" dojoAttachPoint=\"deleteLinkAnchor\" class=\"lotusAction trcRatingDelete\" role=\"link\" title=\"${bundle.title_delete_rating}\">${bundle.link_delete}</a></td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</fieldset>\n\t\t\t</div>\n\t\t\t<div class=\"lotusDialogFooter\">\n\t\t\t\t<input dojoAttachPoint=\"submitDialog\" id=\"saveRatings\" name=\"save\" type=\"submit\" value=\"${bundle.button_save}\" class=\"lotusFormButton\" role=\"button\" title=\"${bundle.title_submit_rating}\"/> \n\t\t\t\t<a href=\"javascript:;\" dojoAttachPoint=\"dialogCancel\" id=\"cancelRatings\" class=\"lotusAction\" role=\"link\" title=\"${bundle.title_done_with_rating}\">${bundle.link_done}</a>\t\t\t\n\t\t\t</div>\n\t\t</form>\t\n\t</div>\n</div>\n",blankImage:dojo.moduleUrl("dojo","resources/blank.gif").toString(),constructor:function(){this.inherited("constructor","com.ibm.widgets.AddRating");this.bIsTracing=this.isTracing();this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","AddRating");this.isAnonymous=!ibmPortalConfig.currentUser;},getRatingStore:function(){this.ratingStore=ibmPortalConfig.resolver;return this.ratingStore;},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}this.inherited(arguments);this.id="addRatings_"+this.resourceID;this.ratingsChangedEventID=this.resourceID+this.ratingsChangedEvent;this._initializeParameters();if(this.isAnonymous===true){this.displayTabs=false;this.privateRatingEnabled=false;this.mineRatingEnabled=false;}this._initializeWidget();if(this.genericParameterMap){if(this.genericParameterMap.renderMode===com.ibm.widgets.AddRating._parameterMap_Value_RenderMode_WSRP){dojo.destroy(this.mainContentDiv);this.errorDisplay(null,this.bundle.text_error_renderMode_wsrp,null);}}this.show();if(this.bIsTracing){this.traceExit(m);}},fetchCollaborativeRatings:function(){if(this.bIsTracing){var m="fetchCollaborativeRatings()";this.traceEntry(m);this.trace(m,"Retrieving URI",com.ibm.widgets.AddRating._ratingSpaceEmptyURI+"&rmparam="+com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID+"&scope="+com.ibm.widgets.AddRating._ratingScope_community+"&scope="+com.ibm.widgets.AddRating._ratingScope_personal_public);}this._displayLoading();var _2979={};if(this.isPreventCache){_2979.preventCache=true;}this.ratingData=null;this.ratingData=this.getRatingStore().fetch({query:{uri:com.ibm.widgets.AddRating._ratingSpaceEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_community_plus_personal_public},queryOptions:_2979,onComplete:dojo.hitch(this,"displayCollaborativeRatings"),onError:dojo.hitch(this,"errorDisplay")});this.isPreventCache=false;if(this.bIsTracing){this.traceExit(m);}},fetchPrivateRatings:function(){if(this.bIsTracing){var m="fetchPrivateRatings()";this.traceEntry(m);this.trace(m,"Retrieving URI",com.ibm.widgets.AddRating._ratingSpaceEmptyURI+"&rmparam="+com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID+"&scope="+com.ibm.widgets.AddRating._ratingScope_personal_private);this.trace(m,"currentPrivateRating",this.currentPrivateRating);this.trace(m,"newPrivateRating",this.newPrivateRating);}this._displayLoading(com.ibm.widgets.AddRating._ratingTypePersonal);var _297a={};if(this.isPreventCache){_297a.preventCache=true;}this.ratingData=null;this.ratingData=this.getRatingStore().fetch({query:{uri:com.ibm.widgets.AddRating._ratingSpaceEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_personal_private},queryOptions:_297a,onComplete:dojo.hitch(this,"displayPrivateRatings"),onError:dojo.hitch(this,"errorDisplay")});this.isPreventCache=false;if(this.bIsTracing){this.traceExit(m);}},fetchIsMineRatings:function(){if(this.bIsTracing){var m="fetchIsMineRatings()";this.traceEntry(m);this.trace(m,"Retrieving URI",com.ibm.widgets.AddRating._ratingSpaceEmptyURI+"&rmparam="+com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID+"&scope="+com.ibm.widgets.AddRating._ratingScope_personal_public);this.trace(m,"currentIsMineRating",this.currentIsMineRating);this.trace(m,"newIsMineRating",this.newIsMineRating);}this._displayLoading(com.ibm.widgets.AddRating._ratingTypePersonal);var _297b={};if(this.isPreventCache){_297b.preventCache=true;}this.ratingData=null;this.ratingData=this.getRatingStore().fetch({query:{uri:com.ibm.widgets.AddRating._ratingSpaceEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_personal_public},queryOptions:_297b,onComplete:dojo.hitch(this,"displayIsMineRatings"),onError:dojo.hitch(this,"errorDisplay")});this.isPreventCache=false;if(this.bIsTracing){this.traceExit(m);}},displayCollaborativeRatings:function(items,_297c){if(this.bIsTracing){var m="displayCollaborativeRatings(items, request)";this.traceEntry(m,[items,_297c]);}var _297d=false;if(this.customLabelCommunityRatings!==null){this.communityRatingsLabel.innerHTML=this.customLabelCommunityRatings;this.communityRatingsLabel.title=this.customLabelCommunityRatings;this.collaborativeRatingDiv.title=this.customLabelCommunityRatings;}else{this.communityRatingsLabel.innerHTML=this.bundle.title_community_rating;this.communityRatingsLabel.title=this.bundle.title_community_rating;this.collaborativeRatingDiv.title=this.bundle.title_community_rating;}var _297e=0;var _297f=0;var _2980=[];for(var k=0;k<this.numStars;k++){_2980[k]=0;}this._displayRatings();dojo.forEach(items,function(item){_297d=true;var _2981=parseInt(this.getRatingStore().getValue(item,com.ibm.widgets.AddRating._valueAttribute),10);if(this.bIsTracing){this.trace(m,"ratingValue",_2981);}var count=parseInt(this.getRatingStore().getValue(item,com.ibm.widgets.AddRating._countAttribute),10);if(this.bIsTracing){this.trace(m,"count",count);}_2980[_2981-1]=_2980[_2981-1]+count;_297e=_297e+count;_297f=_297f+(_2981*count);if(ibmPortalCPConfig.operations.canResetRatingPerResource){this._deleteAllLink=this.getRatingStore().getValue(item,com.ibm.widgets.AddRating._deleteAllLinkAttribute);}},this);var _2982=null;this._dapCollaborativeRatingDiv=dojo.create("div",null,this.collaborativeRatingDiv);if(dijit.byId(com.ibm.widgets.AddRating._collaborativeRatingWidgetID)){_2982=dijit.byId(com.ibm.widgets.AddRating._collaborativeRatingWidgetID);}if(_297d){if(this.bIsTracing){this.trace(m,"numberOfRatings",_297e);this.trace(m,"totalRatingValue",_297f);}var _2983=_297f/_297e;if(this.bIsTracing){this.trace(m,"averageRatingValue",_2983);}var _2984=Math.round(_2983);if(this.bIsTracing){this.trace(m,"roundedAverageRatingValue",_2984);}if(_2982){_2982.setAttribute("value",_2983);dojo.attr(_2982.domNode,"title",dojo.string.substitute(this.bundle.title_rating_percentage,[(Math.round(_2983*100)/100),this.numStars]));}else{_2982=dijit.byId(this.resourceID+this.ratingScope+com.ibm.widgets.InlineRating.inlineRatingWidgetID);if(!this._dapRatingWidget){_2982=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._collaborativeRatingWidgetID,numStars:this.numStars,value:_2983,hoverable:false,clickable:false,halfStarSupport:true,title:dojo.string.substitute(this.bundle.title_rating_percentage,[(Math.round(_2983*100)/100),this.numStars])},this._dapCollaborativeRatingDiv);dojo.attr(_2982.domNode,"tabindex","0");}else{dojo.place(_2982,this._dapCollaborativeRatingDiv,"last");}}if(ibmPortalCPConfig.operations.canResetRatingPerResource){dojo.style(this.deleteAllLink,"display","inline");dojo.removeAttr(this.deleteAllLink,"style");this.deleteAllLinkAnchor.onclick=dojo.hitch(this,function(){this.markAllRatingsOfResourceForDeletion();return false;});}else{dojo.style(this.deleteAllLink,"display","none");}this.displayCollaborativeRatingDistribution(_2980);}else{dojo.style(this.deleteAllLink,"display","none");if(_2982){_2982.setAttribute("value",0);dojo.attr(_2982.domNode,"title",this.bundle.title_not_set);}else{_2982=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._collaborativeRatingWidgetID,numStars:this.numStars,value:0,hoverable:false,clickable:false,halfStarSupport:true,title:this.bundle.title_not_set},this._dapCollaborativeRatingDiv);dojo.attr(_2982.domNode,"tabindex","0");}if(this.myChart){this.myChart.destroy();this.myChart=null;}}if(this.bIsTracing){this.traceExit(m);}},displayCollaborativeRatingDistribution:function(_2985){if(this.bIsTracing){var m="displayCollaborativeRatingDistribution(aNumberOfRatingValues)";this.traceEntry(m,_2985);}if(this.myChart){this.myChart.update(_2985);}else{var div=dojo.create("div",null,this.collaborativeRatingDistributionDiv);this.myChart=new com.ibm.widgets.AddRatingChart({values:_2985},div);}this.myChart.startup();if(this.bIsTracing){this.traceExit(m);}},displayPrivateRatings:function(items,_2986){if(this.bIsTracing){var m="displayPrivateRatings(items, request)";this.traceEntry(m,[items,_2986]);}var _2987=false;var _2988=null;this._ratingScope=com.ibm.widgets.AddRating._ratingScope_personal_private;if(this.customLabelPersonalPrivateRatings!==null){this.isMineOrPrivateRatingLabel.innerHTML=this.customLabelPersonalPrivateRatings;this.isMineOrPrivateRatingLabel.title=this.customLabelPersonalPrivateRatings;}else{this.isMineOrPrivateRatingLabel.innerHTML=this.bundle.text_your_rating_for_this_resource;this.isMineOrPrivateRatingLabel.title=this.bundle.title_your_rating;}this._dapPrivateRatingDiv=dojo.create("div",{id:"privateRatingDiv"},this.isMineOrPrivateRatingDiv);if(dijit.byId(com.ibm.widgets.AddRating._privateRatingWidgetID)){_2988=dijit.byId(com.ibm.widgets.AddRating._privateRatingWidgetID);}this._displayRatings(com.ibm.widgets.AddRating._ratingTypePersonal);if(items&&items.length!==0){if(this.deletingEnabled){dojo.style(this.deleteLink,"display","inline");dojo.removeAttr(this.deleteLink,"style");}else{dojo.style(this.deleteLink,"display","none");}dojo.forEach(items,function(item){_2987=true;var _2989=parseInt(this.getRatingStore().getValue(item,com.ibm.widgets.AddRating._valueAttribute),10);if(this.bIsTracing){this.trace(m,"ratingValue",_2989);}if(ibmPortalCPConfig.operations.canCreatePrivateRatings){if(_2988){_2988.setAttribute("value",_2989);}else{_2988=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._privateRatingWidgetID,numStars:this.numStars,value:_2989},this._dapPrivateRatingDiv);dojo.attr(_2988.domNode,"tabindex","0");}this.connectionHandlersPrivate.push(dojo.connect(_2988,"onStarClick",dojo.hitch(this,"updatePrivateRating")));this.connectionHandlersPrivate.push(dojo.connect(_2988.domNode,"onkeypress",dojo.hitch(this,"keyChangePrivateRating","update")));dojo.connect(_2988.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit"));dojo.connect(_2988,"onStarClick",dojo.hitch(this,"_checkForMessages"));dojo.connect(_2988.domNode,"onkeypress",dojo.hitch(this,"_checkForMessages"));}else{if(_2988){_2988.setAttribute("value",_2989);}else{_2988=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._privateRatingWidgetID,numStars:this.numStars,value:_2989,hoverable:false,clickable:false},this._dapPrivateRatingDiv);dojo.attr(_2988.domNode,"tabindex","0");}}_2988.domNode.title=dojo.string.substitute(this.bundle.title_rating_percentage,[_2989,this.numStars]);dojo.attr(_2988,"title",_2988.domNode.title);_2988.focus();this.currentPrivateRating=_2988.value;if(this.bIsTracing){this.trace(m,"currentPrivateRating",this.currentPrivateRating);}},this);}else{dojo.style(this.deleteLink,"display","none");var _298a=0;if(this.newPrivateRating){_298a=this.newPrivateRating;}else{if(this.currentPrivateRating){_298a=this.currentPrivateRating;}}if(ibmPortalCPConfig.operations.canCreatePrivateRatings){if(_2988){_2988.setAttribute("value",_298a);}else{_2988=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._privateRatingWidgetID,numStars:this.numStars,value:_298a},this._dapPrivateRatingDiv);dojo.attr(_2988.domNode,"tabindex","0");}if(this.currentPrivateRating&&this.currentPrivateRating!==0){this.connectionHandlersPrivate.push(dojo.connect(_2988,"onStarClick",dojo.hitch(this,"updatePrivateRating")));this.connectionHandlersPrivate.push(dojo.connect(_2988.domNode,"onkeypress",dojo.hitch(this,"keyChangePrivateRating","update")));}else{this.connectionHandlersPrivate.push(dojo.connect(_2988,"onStarClick",dojo.hitch(this,"addPrivateRating")));this.connectionHandlersPrivate.push(dojo.connect(_2988.domNode,"onkeypress",dojo.hitch(this,"keyChangePrivateRating","add")));}dojo.connect(_2988.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit"));dojo.connect(_2988,"onStarClick",dojo.hitch(this,"_checkForMessages"));dojo.connect(_2988.domNode,"onkeypress",dojo.hitch(this,"_checkForMessages"));}else{if(_2988){_2988.setAttribute("value",_298a);}else{_2988=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._privateRatingWidgetID,numStars:this.numStars,value:_298a,hoverable:false,clickable:false},this._dapPrivateRatingDiv);dojo.attr(_2988.domNode,"tabindex","0");}}_2988.domNode.title=this.bundle.title_not_set;dojo.attr(_2988,"title",_2988.domNode.title);_2988.focus();}if(this.bIsTracing){this.traceExit(m);}},displayIsMineRatings:function(items,_298b){if(this.bIsTracing){var m="displayIsMineRatings(items, request)";this.traceEntry(m,[items,_298b]);}var _298c=false;var _298d=null;this._ratingScope=com.ibm.widgets.AddRating._ratingScope_personal_public;if(this.customLabelPersonalPublicRatings!==null){this.isMineOrPrivateRatingLabel.innerHTML=this.customLabelPersonalPublicRatings;this.isMineOrPrivateRatingLabel.title=this.customLabelPersonalPublicRatings;}else{this.isMineOrPrivateRatingLabel.innerHTML=this.bundle.text_your_rating_for_this_resource;this.isMineOrPrivateRatingLabel.title=this.bundle.title_your_rating;}this._dapIsMineRatingDiv=dojo.create("div",{id:"isMineRatingDiv"},this.isMineOrPrivateRatingDiv);if(dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID)){_298d=dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID);}this._displayRatings(com.ibm.widgets.AddRating._ratingTypePersonal);if(items&&items.length!==0){if(this.deletingEnabled){dojo.style(this.deleteLink,"display","inline");dojo.removeAttr(this.deleteLink,"style");}else{dojo.style(this.deleteLink,"display","none");}dojo.forEach(items,function(item){_298c=true;var _298e=parseInt(this.getRatingStore().getValue(item,com.ibm.widgets.AddRating._valueAttribute),10);if(this.bIsTracing){this.trace(m,"ratingValue",_298e);}if(ibmPortalCPConfig.operations.canCreatePublicRatings){if(_298d){_298d.setAttribute("value",_298e);}else{_298d=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._isMineRatingWidgetID,numStars:this.numStars,value:_298e},this._dapIsMineRatingDiv);dojo.attr(_298d.domNode,"tabindex","0");_298d.focus();}this.connectionHandlers.push(dojo.connect(_298d,"onStarClick",dojo.hitch(this,"updateIsMineRating")));this.connectionHandlers.push(dojo.connect(_298d.domNode,"onkeypress",dojo.hitch(this,"keyChangeIsMineRating","update")));dojo.connect(_298d.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit"));dojo.connect(_298d,"onStarClick",dojo.hitch(this,"_checkForMessages"));dojo.connect(_298d.domNode,"onkeypress",dojo.hitch(this,"_checkForMessages"));}else{if(_298d){_298d.setAttribute("value",_298e);}else{_298d=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._isMineRatingWidgetID,numStars:this.numStars,value:_298e,hoverable:false,clickable:false},this._dapIsMineRatingDiv);dojo.attr(_298d.domNode,"tabindex","0");}}_298d.domNode.title=dojo.string.substitute(this.bundle.title_rating_percentage,[_298e,this.numStars]);dojo.attr(_298d,"title",_298d.domNode.title);this.currentIsMineRating=_298d.value;if(this.bIsTracing){this.trace(m,"currentIsMineRating",this.currentIsMineRating);}},this);}else{dojo.style(this.deleteLink,"display","none");var _298f=0;if(this.newIsMineRating){_298f=this.newIsMineRating;}else{if(this.currentIsMineRating){_298f=this.currentIsMineRating;}}if(ibmPortalCPConfig.operations.canCreatePublicRatings){if(_298d){_298d.setAttribute("value",_298f);}else{_298d=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._isMineRatingWidgetID,numStars:this.numStars,value:0},this._dapIsMineRatingDiv);dojo.attr(_298d.domNode,"tabindex","0");_298d.focus();}if(this.currentIsMineRating&&this.currentIsMineRating!==0){this.connectionHandlers.push(dojo.connect(_298d,"onStarClick",dojo.hitch(this,"updateIsMineRating")));this.connectionHandlers.push(dojo.connect(_298d.domNode,"onkeypress",dojo.hitch(this,"keyChangeIsMineRating","update")));}else{this.connectionHandlers.push(dojo.connect(_298d,"onStarClick",dojo.hitch(this,"addIsMineRating")));this.connectionHandlers.push(dojo.connect(_298d.domNode,"onkeypress",dojo.hitch(this,"keyChangeIsMineRating","add")));}dojo.connect(_298d.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit"));dojo.connect(_298d,"onStarClick",dojo.hitch(this,"_checkForMessages"));dojo.connect(_298d.domNode,"onkeypress",dojo.hitch(this,"_checkForMessages"));}else{if(_298d){_298d.setAttribute("value",ratingValue);}else{_298d=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._isMineRatingWidgetID,numStars:this.numStars,value:0,hoverable:false,clickable:false},this._dapIsMineRatingDiv);dojo.attr(_298d.domNode,"tabindex","0");}}_298d.domNode.title=this.bundle.title_not_set;dojo.attr(_298d,"title",_298d.domNode.title);}if(this.bIsTracing){this.traceExit(m);}},addIsMineRating:function(event){if(this.bIsTracing){var m="addIsMineRating(event)";this.traceEntry(m,event);}var _2990=event.target;var _2991=0;if(_2990.tagName=="SPAN"){_2991=_2990.parentNode.getAttribute("value");}else{_2991=_2990.getAttribute("value");}if(_2991==this.newIsMineRating){this.newIsMineRating=null;this._actionAddIsMineRating=false;}else{this.newIsMineRating=_2991;if(this.bIsTracing){this.trace(m,"newIsMineRating",this.newIsMineRating);}this._actionDeleteIsMineRating=false;this._actionAddPrivateRating=false;this._actionUpdatePrivateRating=false;this._actionDeletePrivateRating=false;this.activateSubmitDialog(true);this._actionAddIsMineRating=true;}if(this.bIsTracing){this.traceExit(m);}},addAnonymousRating:function(event){if(this.bIsTracing){var m="addAnonymousRating(event)";this.traceEntry(m,event);}var _2992=event.target;var _2993=0;if(_2992.tagName=="SPAN"){_2993=_2992.parentNode.getAttribute("value");}else{_2993=_2992.getAttribute("value");}this.newAnonymousRating=_2993;if(this.bIsTracing){this.trace(m,"newAnonymousRating",this.newAnonymousRating);}this.activateSubmitDialog(true);this._actionAddAnonymousRating=true;if(this.bIsTracing){this.traceExit(m);}},addPrivateRating:function(event){if(this.bIsTracing){var m="addPrivateRating(event)";this.traceEntry(m,event);}var _2994=event.target;var _2995=0;if(_2994.tagName=="SPAN"){_2995=_2994.parentNode.getAttribute("value");}else{_2995=_2994.getAttribute("value");}if(_2995==this.newPrivateRating){this.newPrivateRating=null;this._actionAddPrivateRating=false;}else{this.newPrivateRating=_2995;if(this.bIsTracing){this.trace(m,"newPrivateRating",this.newPrivateRating);}this._actionDeletePrivateRating=false;this._actionAddIsMineRating=false;this._actionUpdateIsMineRating=false;this._actionDeleteIsMineRating=false;this.activateSubmitDialog(true);this._actionAddPrivateRating=true;}if(this.bIsTracing){this.traceExit(m);}},addRating:function(_2996,_2997,_2998){if(this.bIsTracing){var m="addRating(resource, isPrivateRating, newRatingValue)";this.traceEntry(m,[_2996,_2997,_2998]);this.trace(m,"resource",_2996);this.trace(m,"isPrivateRating",_2997);this.trace(m,"newRatingValue",_2998);}this._displayLoading(com.ibm.widgets.AddRating._ratingTypePersonal);this.storeRatingStore(_2996,_2997,_2998);if(this.bIsTracing){this.traceExit(m);}},storeRatingStore:function(_2999,_299a,_299b){if(this.bIsTracing){var m="storeRatingStore(resource, isPrivateRating, newRatingValue)";this.traceEntry(m,[_2999,_299a,_299b]);this.trace(m,"resource",_2999);this.trace(m,"isPrivateRating",_299a);this.trace(m,"newRatingValue",_299b);}var item=null;if(this.resourceCategory){item=this.getRatingStore().newItem({scheme:"rtm",isPrivate:_299a,rating:_299b,resourceURI:_2999,category:this.resourceCategory});}else{item=this.getRatingStore().newItem({scheme:"rtm",isPrivate:_299a,rating:_299b,resourceURI:_2999});}this.ratingStore.saveScheme("rtm",{onError:this.errorDisplay,onComplete:this.onSave,scope:this});if(this.isAnonymous){this.currentAnonymousRating=_299b;}if(this.bIsTracing){this.traceExit(m);}},updateIsMineRating:function(event){if(this.bIsTracing){var m="updateIsMineRating(event)";this.traceEntry(m,event);}var _299c=event.target;var _299d=0;if(_299c.tagName=="SPAN"){_299d=_299c.parentNode.getAttribute("value");}else{_299d=_299c.getAttribute("value");}if(_299d==this.currentIsMineRating||_299d==this.newIsMineRating){this.deleteIsMineOrPrivateRating(event);}else{this.newIsMineRating=_299d;if(this.bIsTracing){this.trace(m,"newIsMineRating",this.newIsMineRating);}this._actionDeleteIsMineRating=false;this._actionAddPrivateRating=false;this._actionDeletePrivateRating=false;this._actionUpdatePrivateRating=false;this.activateSubmitDialog(true);this._actionUpdateIsMineRating=true;}if(this.bIsTracing){this.traceExit(m);}},keyChangeIsMineRating:function(mode,event){if(this.bIsTracing){var m="keyChangeIsMineRating(mode, event)";this.traceEntry(m,[mode,event]);}this._actionDeleteIsMineRating=false;this._actionAddPrivateRating=false;this._actionDeletePrivateRating=false;this._actionUpdatePrivateRating=false;if(mode=="update"){this._actionUpdateIsMineRating=true;}else{if(!this.currentIsMineRating){this.currentIsMineRating=0;}this._actionAddIsMineRating=true;}switch(event.keyCode){case dojo.keys.UP_ARROW:case dojo.keys.RIGHT_ARROW:this.currentIsMineRating+=1;this.newIsMineRating=this.currentIsMineRating;this.newIsMineRating=Math.min(this.newIsMineRating,this.numStars);this.currentIsMineRating=Math.min(this.newIsMineRating,this.numStars);dojo.stopEvent(event);break;case dojo.keys.DOWN_ARROW:case dojo.keys.LEFT_ARROW:this.currentIsMineRating-=1;this.newIsMineRating=this.currentIsMineRating;this.newIsMineRating=Math.max(this.newIsMineRating,1);this.currentIsMineRating=Math.max(this.newIsMineRating,1);dojo.stopEvent(event);break;case dojo.keys.HOME:this.currentIsMineRating=1;this.newIsMineRating=1;dojo.stopEvent(event);break;case dojo.keys.END:this.currentIsMineRating=this.numStars;this.newIsMineRating=this.numStars;dojo.stopEvent(event);break;default:break;}if(event.keyCode!=dojo.keys.TAB){this.activateSubmitDialog(true);}dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID).setAttribute("value",this.newIsMineRating);if(this.bIsTracing){this.traceExit(m);}},updatePrivateRating:function(event){if(this.bIsTracing){var m="updatePrivateRating(event)";this.traceEntry(m,event);}var _299e=event.target;var _299f=0;if(_299e.tagName=="SPAN"){_299f=_299e.parentNode.getAttribute("value");}else{_299f=_299e.getAttribute("value");}if(_299f==this.currentPrivateRating||_299f==this.newPrivateRating){this.deleteIsMineOrPrivateRating(event);}else{this.newPrivateRating=_299f;if(this.bIsTracing){this.trace("newPrivateRating",this.newPrivateRating);}this._actionDeletePrivateRating=false;this._actionAddIsMineRating=false;this._actionDeleteIsMineRating=false;this._actionUpdateIsMineRating=false;this.activateSubmitDialog(true);this._actionUpdatePrivateRating=true;}if(this.bIsTracing){this.traceExit(m);}},keyChangePrivateRating:function(mode,event){if(this.bIsTracing){var m="keyChangePrivateRating(mode, event)";this.traceEntry(m,[mode,event]);}this._actionDeletePrivateRating=false;this._actionAddIsMineRating=false;this._actionDeleteIsMineRating=false;this._actionUpdateIsMineRating=false;if(mode=="update"){this._actionUpdatePrivateRating=true;}else{if(mode=="add"){if(!this.currentPrivateRating){this.currentPrivateRating=0;}this._actionAddPrivateRating=true;}}switch(event.keyCode){case dojo.keys.UP_ARROW:case dojo.keys.RIGHT_ARROW:this.currentPrivateRating+=1;this.newPrivateRating=this.currentPrivateRating;this.newPrivateRating=Math.min(this.newPrivateRating,this.numStars);this.currentPrivateRating=Math.min(this.newPrivateRating,this.numStars);dojo.stopEvent(event);break;case dojo.keys.DOWN_ARROW:case dojo.keys.LEFT_ARROW:this.currentPrivateRating-=1;this.newPrivateRating=this.currentPrivateRating;this.newPrivateRating=Math.max(this.newPrivateRating,1);this.currentPrivateRating=Math.max(this.newPrivateRating,1);dojo.stopEvent(event);break;case dojo.keys.HOME:this.currentPrivateRating=1;this.newPrivateRating=1;dojo.stopEvent(event);break;case dojo.keys.END:this.currentPrivateRating=this.numStars;this.newPrivateRating=this.numStars;dojo.stopEvent(event);break;default:break;}if(event.keyCode!=dojo.keys.TAB){this.activateSubmitDialog(true);}dijit.byId(com.ibm.widgets.AddRating._privateRatingWidgetID).setAttribute("value",this.newPrivateRating);if(this.bIsTracing){this.traceExit(m);}},keyChangeAnonymousRating:function(event){if(this.bIsTracing){var m="keyChangeAnonymousRating(event)";this.traceEntry(m,event);}if(!this.currentAnonymousRating){this.currentAnonymousRating=0;}this._actionAddAnonymousRating=true;switch(event.keyCode){case dojo.keys.UP_ARROW:case dojo.keys.RIGHT_ARROW:this.currentAnonymousRating+=1;this.newAnonymousRating=this.currentAnonymousRating;this.newAnonymousRating=Math.min(this.newAnonymousRating,this.numStars);this.currentAnonymousRating=Math.min(this.newAnonymousRating,this.numStars);dojo.stopEvent(event);break;case dojo.keys.DOWN_ARROW:case dojo.keys.LEFT_ARROW:this.currentAnonymousRating-=1;this.newAnonymousRating=this.currentAnonymousRating;this.newAnonymousRating=Math.max(this.newAnonymousRating,1);this.currentAnonymousRating=Math.max(this.newAnonymousRating,1);dojo.stopEvent(event);break;case dojo.keys.HOME:this.currentAnonymousRating=1;this.newAnonymousRating=1;dojo.stopEvent(event);break;case dojo.keys.END:this.currentAnonymousRating=this.numStars;this.newAnonymousRating=this.numStars;dojo.stopEvent(event);break;default:break;}if(event.keyCode!=dojo.keys.TAB){this.activateSubmitDialog(true);}dijit.byId(com.ibm.widgets.AddRating._anonymousRatingWidgetID).setAttribute("value",this.newAnonymousRating);if(this.bIsTracing){this.traceExit(m);}},updateRating:function(_29a0,_29a1,_29a2){if(this.bIsTracing){var m="updateRating(resource, isPrivateRating, newRatingValue)";this.traceEntry(m,[_29a0,_29a1,_29a2]);this.trace(m,"resource",_29a0);this.trace(m,"isPrivateRating",_29a1);this.trace(m,"newRatingValue",_29a2);}this._displayLoading(com.ibm.widgets.AddRating._ratingTypePersonal);this.updateRatingStore(_29a0,_29a1,_29a2);if(this.bIsTracing){this.traceExit(m);}},updateRatingStore:function(_29a3,_29a4,_29a5){if(this.bIsTracing){var m="updateRatingStore(resource, isPrivateRating, newRatingValue)";this.traceEntry(m,[_29a3,_29a4,_29a5]);this.trace(m,"Invoking URI",_29a5+"@"+_29a3+" in resourcexcategory: "+this.resourceCategory);this.trace(m,"resource",_29a3);this.trace(m,"isPrivateRating",_29a4);this.trace(m,"newRatingValue",_29a5);}var _29a6=this.getRatingStore();var _29a7=null;var _29a8=dojo.hitch(this,"onSave");var _29a9=dojo.hitch(this,"errorDisplay");if(!_29a4){_29a7=_29a6.fetch({query:{uri:com.ibm.widgets.AddRating._ratingEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_personal_public},onComplete:function(_29aa){dojo.forEach(_29aa,function(_29ab){if(!_29a6.isItemLoaded(_29ab)){_29a6.loadItem({item:_29ab,onItem:function(item){_29a6.setValue(item,com.ibm.widgets.AddRating._valueAttribute,_29a5);_29a6.saveScheme("rtm",{onError:_29a9,onComplete:_29a8,scope:this});}});}else{_29a6.setValue(_29ab,com.ibm.widgets.AddRating._valueAttribute,_29a5);_29a6.saveScheme("rtm",{onError:_29a9,onComplete:_29a8,scope:this});}},this);},onError:dojo.hitch(this,"errorDisplay")},this);}else{_29a7=_29a6.fetch({query:{uri:com.ibm.widgets.AddRating._ratingEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_personal_private},onComplete:function(_29ac){dojo.forEach(_29ac,function(_29ad){if(!_29a6.isItemLoaded(_29ad)){_29a6.loadItem({item:_29ad,onItem:function(item){_29a6.setValue(item,com.ibm.widgets.AddRating._valueAttribute,_29a5);_29a6.saveScheme("rtm",{onError:_29a9,onComplete:_29a8,scope:this});}});}else{_29a6.setValue(_29ad,com.ibm.widgets.AddRating._valueAttribute,_29a5);_29a6.saveScheme("rtm",{onError:_29a9,onComplete:_29a8,scope:this});}},this);},onError:dojo.hitch(this,"errorDisplay")},this);}if(this.bIsTracing){this.traceExit(m);}},deleteIsMineOrPrivateRating:function(event){if(this.bIsTracing){var m="deleteIsMineOrPrivateRating(event)";this.traceEntry(m,event);}if(this._ratingScope==com.ibm.widgets.AddRating._ratingScope_personal_public){if(this.bIsTracing){this.trace(m,"Delete the isMine rating");}this._checkForMessages();this.currentIsMineRating=0;this.newIsMineRating=null;this._actionUpdateIsMineRating=false;this._actionAddIsMineRating=false;this.activateSubmitDialog(true);dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID).setAttribute("value",0);this._actionDeleteIsMineRating=true;}else{if(this._ratingScope==com.ibm.widgets.AddRating._ratingScope_personal_private){if(this.bIsTracing){this.trace(m,"Delete the private rating");}this._checkForMessages();this.currentPrivateRating=0;this.newPrivateRating=null;this._actionUpdatePrivateRating=false;this._actionAddPrivateRating=false;this.activateSubmitDialog(true);dijit.byId(com.ibm.widgets.AddRating._privateRatingWidgetID).setAttribute("value",0);this._actionDeletePrivateRating=true;}}if(this.bIsTracing){this.traceExit(m);}},markAllRatingsOfResourceForDeletion:function(event){if(this.bIsTracing){var m="markAllRatingsOfResourceForDeletion(event)";this.traceEntry(m,event);}this._checkForMessages();this.currentIsMineRating=0;this.newIsMineRating=null;dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID).setAttribute("value",0);dijit.byId(com.ibm.widgets.AddRating._collaborativeRatingWidgetID).setAttribute("value",0);this._actionUpdateIsMineRating=false;this._actionAddIsMineRating=false;this._actionDeleteIsMineRating=false;this.activateSubmitDialog(true);this._actionDeleteAllRatingsOfResource=true;if(this.bIsTracing){this.traceExit(m);}},deleteRating:function(_29ae){if(this.bIsTracing){var m="deleteRating(isPrivateRating)";this.traceEntry(m,_29ae);}this._displayLoading(com.ibm.widgets.AddRating._ratingTypePersonal);var _29af=this.getRatingStore();var _29b0=null;var _29b1=dojo.hitch(this,"onSave");var _29b2=dojo.hitch(this,"errorDisplay");if(!_29ae){_29b0=_29af.fetch({query:{uri:com.ibm.widgets.AddRating._ratingEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_personal_public},onComplete:function(_29b3){dojo.forEach(_29b3,function(_29b4){_29af.deleteItem(_29b4);_29af.saveScheme("rtm",{onError:_29b2,onComplete:_29b1,scope:this});},this);},onError:dojo.hitch(this,"errorDisplay")},this);}else{_29b0=_29af.fetch({query:{uri:com.ibm.widgets.AddRating._ratingEmptyURI,rmparam:com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID,scope:com.ibm.widgets.AddRating._ratingScope_personal_private},onComplete:function(_29b5){dojo.forEach(_29b5,function(_29b6){_29af.deleteItem(_29b6);_29af.saveScheme("rtm",{onError:_29b2,onComplete:_29b1,scope:this});},this);},onError:dojo.hitch(this,"errorDisplay")},this);}if(this.bIsTracing){this.traceExit(m);}},saveRatings:function(event){if(this.bIsTracing){var m="saveRatings(event)";this.traceEntry(m,event);}if(event){dojo.stopEvent(event);}var _29b7=com.ibm.widgets.AddRating._resourceModelSchema+this.resourceSchema+this.resourceID;if(this._actionAddIsMineRating){if(this.bIsTracing){this.trace(m,"Adding isMine rating");}this.addRating(_29b7,false,this.newIsMineRating);}if(this._actionAddPrivateRating){if(this.bIsTracing){this.trace(m,"Adding private rating");}this.addRating(_29b7,true,this.newPrivateRating);}if(this._actionUpdateIsMineRating){if(this.bIsTracing){this.trace(m,"Updating isMine rating");}this.updateRating(_29b7,false,this.newIsMineRating);}if(this._actionUpdatePrivateRating){if(this.bIsTracing){this.trace(m,"Updating private rating");}this.updateRating(_29b7,true,this.newPrivateRating);}if(this._actionDeletePrivateRating){if(this.bIsTracing){this.trace(m,"Deleting private rating");}this.deleteRating(true);}if(this._actionDeleteIsMineRating){if(this.bIsTracing){this.trace(m,"Deleting isMine rating");}this.deleteRating(false);}if(this._actionAddAnonymousRating){if(this.bIsTracing){this.trace(m,"Adding isMine rating");}this.addRating(_29b7,false,this.newAnonymousRating);}if(this._actionDeleteAllRatingsOfResource){if(this.bIsTracing){this.trace(m,"Deleting all ratings of this resource");}this._deleteAllRatingsOfResource(this._deleteAllLink);}if(this.bIsTracing){this.traceExit(m);}},destroyDialog:function(){if(this.bIsTracing){var m="destroyDialog()";this.traceEntry(m);}this.newIsMineRating=null;this.newPrivateRating=null;this._actionAddIsMineRating=false;this._actionAddPrivateRating=false;this._actionUpdateIsMineRating=false;this._actionUpdatePrivateRating=false;this._actionDeleteIsMineRating=false;this._actionDeletePrivateRating=false;this._actionAddAnonymousRating=false;var _29b8=dijit.byId(com.ibm.widgets.AddRating._collaborativeRatingWidgetID);if(_29b8){_29b8.destroy();}var _29b9=dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID);if(_29b9){_29b9.destroy();}var _29ba=dijit.byId(com.ibm.widgets.AddRating._privateRatingWidgetID);if(_29ba){_29ba.destroy();}var _29bb=dijit.byId(com.ibm.widgets.AddRating._anonymousRatingWidgetID);if(_29bb){_29bb.destroy();}if(this.bIsTracing){this.traceExit(m);}},hideAndCancelRatings:function(event){if(this.bIsTracing){var m="hideAndCancelRatings(event)";this.traceEntry(m,event);}setTimeout(dojo.hitch(this,"destroyDialog"),dijit.defaultDuration+10);if(this.bIsTracing){this.traceExit(m);}},cancelRatings:function(event){if(this.bIsTracing){var m="cancelRatings(event)";this.traceEntry(m,event);}if(this._actionAddPrivateRating||this._actionDeletePrivateRating||this._actionUpdatePrivateRating||this._actionAddIsMineRating||this._actionDeleteIsMineRating||this._actionUpdateIsMineRating||this._actionDeleteAllRatingsOfResource){if(!this._checkDialog){this._checkDialog=new com.ibm.widgets.DoneCheckDialog({id:"doneCheckDialog",parentWidget:this,callbackOnYes:function(){this.parentWidget.hide();this.parentWidget.destroyDialog();}});}this._checkDialog.show();}else{this.hide();this.destroyDialog();}if(this.bIsTracing){this.traceExit(m);}},switchToPrivateView:function(event){if(this.bIsTracing){var m="switchToPrivateView(event)";this.traceEntry(m,event);}if(this._ratingScope==com.ibm.widgets.AddRating._ratingScope_personal_public){if(this._actionAddIsMineRating||this._actionDeleteIsMineRating||this._actionUpdateIsMineRating){this.displayInfoMessage(this.bundle.text_info_changes_lost);this.activateSubmitDialog(false);}if(this.customLabelPersonalPrivateRatings!==null){this.isMineOrPrivateRatingLabel.innerHTML=this.customLabelPersonalPrivateRatings;this.isMineOrPrivateRatingLabel.title=this.customLabelPersonalPrivateRatings;}this._actionAddIsMineRating=false;this._actionUpdateIsMineRating=false;this._actionDeleteIsMineRating=false;this.newIsMineRating=null;this._ratingScope=com.ibm.widgets.AddRating._ratingScope_personal_private;dojo.addClass(this.liTabPrivate,"lotusSelected");dojo.removeClass(this.liTabPublic,"lotusSelected");dojo.attr(this.tabPrivate,"selected","true");this.tabPublic.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPrivate");var _29bc=dijit.byId(com.ibm.widgets.AddRating._privateRatingWidgetID);if(_29bc){_29bc.destroy();}this.isMineOrPrivateRatingDiv.innerHTML="";this.fetchPrivateRatings();}if(this.bIsTracing){this.traceExit(m);}},switchToPublicView:function(event){if(this.bIsTracing){var m="switchToPublicView(event)";this.traceEntry(m,event);}if(this._ratingScope==com.ibm.widgets.AddRating._ratingScope_personal_private){if(this._actionAddPrivateRating||this._actionDeletePrivateRating||this._actionUpdatePrivateRating){this.displayInfoMessage(this.bundle.text_info_changes_lost);this.activateSubmitDialog(false);}if(this.customLabelPersonalPublicRatings!==null){this.isMineOrPrivateRatingLabel.innerHTML=this.customLabelPersonalPublicRatings;this.isMineOrPrivateRatingLabel.title=this.customLabelPersonalPublicRatings;}this._actionAddPrivateRating=false;this._actionUpdatePrivateRating=false;this._actionDeletePrivateRating=false;this.newPrivateRating=null;this._ratingScope=com.ibm.widgets.AddRating._ratingScope_personal_public;dojo.addClass(this.liTabPublic,"lotusSelected");dojo.removeClass(this.liTabPrivate,"lotusSelected");dojo.attr(this.tabPublic,"selected","true");this.tabPrivate.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPublic");var _29bd=dijit.byId(com.ibm.widgets.AddRating._isMineRatingWidgetID);if(_29bd){_29bd.destroy();}this.isMineOrPrivateRatingDiv.innerHTML="";this.fetchIsMineRatings();}if(this.bIsTracing){this.traceExit(m);}},onSave:function(){if(this.bIsTracing){var m="onSave()";this.traceEntry(m);}this._displayRatings(com.ibm.widgets.AddRating._ratingTypePersonal);this._displayRatings();if((this.errorDiv&&this.errorDiv.style.display!="block")||!this.errorDiv){if(!this._dapSuccessDiv){var _29be=dojo.create("div",{id:"successDiv2",role:"status"},this.successMessageDiv);dojo.addClass(_29be,"lotusMessage lotusConfirm");this._dapSuccessDiv=_29be;var _29bf=dojo.create("img",{src:this.blankImage,alt:this.bundle.title_confirmation},_29be);_29bf.style.width="16px";_29bf.style.height="16px";dojo.addClass(_29bf,"trcConfirmationIcon");var _29c0=dojo.create("span",null,_29be);if(this._actionAddAnonymousRating||this._actionAddIsMineRating||this._actionAddPrivateRating||this._actionUpdateIsMineRating||this._actionUpdatePrivateRating){dojo.attr(_29c0,"innerHTML",this.bundle.text_success_changes_stored_successfully+this.bundle.text_rating_saved);}else{if(this._actionDeleteIsMineRating||this._actionDeletePrivateRating){dojo.attr(_29c0,"innerHTML",this.bundle.text_success_changes_stored_successfully+this.bundle.text_rating_deleted);}else{if(this._actionDeleteAllRatingsOfResource){dojo.attr(_29c0,"innerHTML",this.bundle.text_all_ratings_deleted);}}}}if(this._ratingScope==com.ibm.widgets.AddRating._ratingScope_personal_private){this.refreshPrivateRatings();}else{this.refreshCollaborativeRatings();this.refreshIsMineRatings();}this.activateSubmitDialog(false);}else{if(this._ratingScope==com.ibm.widgets.AddRating._ratingScope_personal_private){this.refreshPrivateRatings();}else{this.refreshIsMineRatings();this.refreshCollaborativeRatings();}}dojo.publish(this.ratingsChangedEventID,[{scope:this._ratingScope}]);if(this.bIsTracing){this.traceExit(m);}},refreshCollaborativeRatings:function(){if(this.bIsTracing){var m="refreshCollaborativeRatings()";this.traceEntry(m);}this.isPreventCache=true;this._actionDeleteAllRatingsOfResource=false;this.fetchCollaborativeRatings();if(this.bIsTracing){this.traceExit(m);}},refreshIsMineRatings:function(){if(this.bIsTracing){var m="refreshIsMineRatings()";this.traceEntry(m);}this.newIsMineRating=null;this.newAnonymousRating=null;this._actionAddIsMineRating=false;this._actionUpdateIsMineRating=false;this._actionDeleteIsMineRating=false;this._actionAddAnonymousRating=false;this.isPreventCache=true;dojo.forEach(this.connectionHandlers,dojo.disconnect);if(!this.isAnonymous&&!this.resourcePrivate){this.fetchIsMineRatings();}else{if(this.isAnonymous){this.refreshAnonymousRating();}}if(this.bIsTracing){this.traceExit(m);}},refreshPrivateRatings:function(){if(this.bIsTracing){var m="refreshPrivateRatings()";this.traceEntry(m);}this.isPreventCache=true;this.newPrivateRating=null;this._actionAddPrivateRating=false;this._actionUpdatePrivateRating=false;this._actionDeletePrivateRating=false;dojo.forEach(this.connectionHandlersPrivate,dojo.disconnect);this.fetchPrivateRatings();if(this.bIsTracing){this.traceExit(m);}},refreshAnonymousRating:function(){if(this.bIsTracing){var m="refreshAnonymousRating()";this.traceEntry(m);this.trace(m,"new",this.newAnonymousRating);this.trace(m,"current",this.currentAnonymousRating);}dijit.byId(com.ibm.widgets.AddRating._anonymousRatingWidgetID).setAttribute("value",this.currentAnonymousRating);dijit.byId(com.ibm.widgets.AddRating._anonymousRatingWidgetID).domNode.title=dojo.string.substitute(this.bundle.title_rating_percentage,[this.currentAnonymousRating,this.numStars]);if(this.bIsTracing){this.traceExit(m);}},errorDisplay:function(err,_29c1,_29c2){if(this.bIsTracing){var m="errorDisplay(err, errText, errDetails)";this.traceEntry(m,[err,_29c1,_29c2]);}this._displayRatings(com.ibm.widgets.AddRating._ratingTypePersonal);if((err!==null)&&(err.status==401)){top.location.href=document.location.href;}else{dojo.style(this.errorDiv,"display","block");if(_29c1&&_29c1!==""){this.errorSpan.innerHTML=_29c1;}if(_29c2&&_29c2!==""){this.errorDetailsSpan.innerHTML=_29c2;}}if(this.bIsTracing){this.traceExit(m);}},activateSubmitDialog:function(_29c3){if(this.bIsTracing){var m="activateSubmitDialog(activate)";this.traceEntry(m,_29c3);}if(_29c3){this.submitDialog.disabled=false;this.submitDialog.className="lotusFormButton";}else{this.submitDialog.disabled=true;this.submitDialog.className="lotusBtn lotusBtnDisabled trcDisabledButton";}if(this.bIsTracing){this.traceExit(m);}},handleAnonymousCase:function(){if(this.bIsTracing){var m="handleAnonymousCase()";this.traceEntry(m);}if(ibmPortalCPConfig.operations.canCreatePublicRatings){this._dapIsMineRatingDiv=dojo.create("div",{id:"isMineRatingDiv"},this.isMineOrPrivateRatingDiv);var _29c4=null;if(this.currentAnonymousRating){_29c4=dojo.string.substitute(this.bundle.title_rating_percentage,[this.currentAnonymousRating,this.numStars]);}else{_29c4=this.bundle.title_not_set;}var _29c5=new com.ibm.widgets.Rating({id:com.ibm.widgets.AddRating._anonymousRatingWidgetID,numStars:this.numStars,value:0,title:_29c4},this._dapIsMineRatingDiv);dojo.connect(_29c5,"onStarClick",dojo.hitch(this,"addAnonymousRating"));dojo.connect(_29c5.domNode,"onkeypress",dojo.hitch(this,"keyChangeAnonymousRating"));dojo.attr(_29c5.domNode,"tabindex","0");this._displayRatings(com.ibm.widgets.AddRating._ratingTypePersonal);}else{dojo.destroy(this.editSection);}if(this.bIsTracing){this.traceExit(m);}},displayInfoMessage:function(_29c6){if(this.bIsTracing){var m="displayInfoMessage(message)";this.traceEntry(m,_29c6);}var _29c7=dojo.create("div",{role:"status"},this.informationCell);dojo.addClass(_29c7,"lotusMessage lotusInfo");this._dapInfoDiv=_29c7;var _29c8=dojo.create("img",{src:this.blankImage,alt:this.bundle.title_info},_29c7);_29c8.style.width="16px";_29c8.style.height="16px";dojo.addClass(_29c8,"trcInformationIcon");var _29c9=dojo.create("span",{innerHTML:_29c6},_29c7);if(this.bIsTracing){this.traceExit(m);}},_checkForMessages:function(){if(this.bIsTracing){var m="_checkForMessages()";this.traceEntry(m);}if(this.errorDiv.style.display=="block"){this.errorDiv.style.display="none";}if(this._dapSuccessDiv){dojo.fadeOut({node:this._dapSuccessDiv,duration:this.messageFadeOutDuration,onEnd:dojo.hitch(this,function(){dojo.destroy(this._dapSuccessDiv);this._dapSuccessDiv=null;})}).play();}if(this._dapInfoDiv){dojo.fadeOut({node:this._dapInfoDiv,duration:this.messageFadeOutDuration,onEnd:dojo.hitch(this,function(){dojo.destroy(this._dapInfoDiv);this._dapInfoDiv=null;})}).play();}if(this.bIsTracing){this.traceExit(m);}},_determineResourceType:function(){if(this.bIsTracing){var m="_determineResourceType()";this.traceEntry(m);}switch(this.resourceType){case com.ibm.widgets.AddRating._resourceType_contentnode:this.resourceSchema=com.ibm.widgets.AddRating._navigationModelSchema;break;case com.ibm.widgets.AddRating._resourceType_navigationnode:this.resourceSchema=com.ibm.widgets.AddRating._portletModelSchema;break;default:break;}if(this.bIsTracing){this.traceExit(m);}},_checkKeySubmit:function(event){if(this.bIsTracing){var m="_checkKeySubmit()";this.traceEntry(m);}if(event.keyCode==dojo.keys.ENTER){if(!this.submitDialog.disabled){this.saveRatings(event);}}if(this.bIsTracing){this.traceExit(m);}},_initializeWidget:function(){if(this.bIsTracing){var m="_initializeWidget()";this.traceEntry(m);}this._determineTabDisplay();this._initializeEvents();this._determineResourceType();this.titleNode.innerHTML=dojo.string.substitute(this.bundle.text_rate,[com.ibm.domUtilities.encodeXML(this.resourceTitle)]);this.fetchCollaborativeRatings();if(!this.isAnonymous&&!this.resourcePrivate&&this.defaultView!=com.ibm.widgets.AddRating._viewPrivate){this.fetchIsMineRatings();}else{if(this.resourcePrivate||this.defaultView==com.ibm.widgets.AddRating._viewPrivate){this.fetchPrivateRatings();}}if(this.isAnonymous){this.handleAnonymousCase();}this.activateSubmitDialog(false);if(this.bIsTracing){this.traceExit(m);}},_initializeEvents:function(){if(this.bIsTracing){var m="_initializeEvents()";this.traceEntry(m);}this.submitDialog.onclick=dojo.hitch(this,function(){this.saveRatings();return false;});this.closeButtonNode.onclick=this.dialogCancel.onclick=dojo.hitch(this,function(){this.cancelRatings();return false;});this.tabPublic.onclick=dojo.hitch(this,function(){this.switchToPublicView();return false;});this.tabPrivate.onclick=dojo.hitch(this,function(){this.switchToPrivateView();return false;});this.deleteLinkAnchor.onclick=dojo.hitch(this,function(){this.deleteIsMineOrPrivateRating();return false;});if(this.bIsTracing){this.traceExit(m);}},_initializeParameters:function(){if(this.bIsTracing){var m="_initializeEvents()";this.traceEntry(m);}if(!("numStars" in this.params)){if(ibmPortalCPConfig.rating.dialog.numStars!=null){this.numStars=ibmPortalCPConfig.rating.dialog.numStars;}else{this.numStars=com.ibm.widgets.AddRating._numStars;}}if(!("defaultView" in this.params)){if(ibmPortalCPConfig.rating.dialog.defaultView!=null){this.defaultView=ibmPortalCPConfig.rating.dialog.defaultView;}else{this.defaultView=com.ibm.widgets.AddRating._viewPublic;}}if(!("deletingEnabled" in this.params)){if(ibmPortalCPConfig.rating.dialog.deletingEnabled!=null){this.deletingEnabled=ibmPortalCPConfig.rating.dialog.deletingEnabled;}else{this.deletingEnabled=com.ibm.widgets.AddRating._deletingEnabled;}}if(!("customLabelCommunityRatings" in this.params)){if(ibmPortalCPConfig.rating.dialog.customLabelCommunityRatings!=null){this.customLabelCommunityRatings=ibmPortalCPConfig.rating.dialog.customLabelCommunityRatings;}else{this.customLabelCommunityRatings=null;}}if(!("customLabelPersonalPublicRatings" in this.params)){if(ibmPortalCPConfig.rating.dialog.customLabelPersonalPublicRatings!=null){this.customLabelPersonalPublicRatings=ibmPortalCPConfig.rating.dialog.customLabelPersonalPublicRatings;}else{this.customLabelPersonalPublicRatings=null;}}if(!("customLabelPersonalPrivateRatings" in this.params)){if(ibmPortalCPConfig.rating.dialog.customLabelPersonalPrivateRatings!=null){this.customLabelPersonalPrivateRatings=ibmPortalCPConfig.rating.dialog.customLabelPersonalPrivateRatings;}else{this.customLabelPersonalPrivateRatings=null;}}if(!("privateRatingEnabled" in this.params)){if(ibmPortalCPConfig.rating.dialog.privateRatingEnabled!=null){this.privateRatingEnabled=ibmPortalCPConfig.rating.dialog.privateRatingEnabled;}else{this.privateRatingEnabled=com.ibm.widgets.AddRating._privateRatingEnabled;}}if(!("displayTabs" in this.params)){if(ibmPortalCPConfig.rating.dialog.displayTabs!=null){this.displayTabs=ibmPortalCPConfig.rating.dialog.displayTabs;}else{this.displayTabs=com.ibm.widgets.AddRating._displayTabs;}}if(!("messageFadeOutDuration" in this.params)){if(ibmPortalCPConfig.rating.dialog.messageFadeOutDuration!=null){this.messageFadeOutDuration=ibmPortalCPConfig.rating.dialog.messageFadeOutDuration;}else{this.messageFadeOutDuration=com.ibm.widgets.AddRating._messageFadeOutDuration;}}if(!("resolver" in this.params)){this.ratingStore=ibmPortalConfig.resolver;}if(this.bIsTracing){this.traceExit(m);}},_determineTabDisplay:function(){if(this.bIsTracing){var m="_determineTabDisplay()";this.traceEntry(m);}if(this.resourcePrivate){dojo.style(this.liTabPublic,"display","none");this.tabPrivate.title=this.bundle.button_private;dojo.addClass(this.liTabPrivate,"lotusSelected");dojo.removeClass(this.liTabPublic,"lotusSelected");dojo.attr(this.tabPrivate,"selected","true");this.tabPublic.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPrivate");}if(!this.privateRatingEnabled){dojo.style(this.liTabPrivate,"display","none");}if(this.defaultView==com.ibm.widgets.AddRating._viewPrivate&&this.liTabPrivate.style.display!="none"){dojo.addClass(this.liTabPrivate,"lotusSelected");dojo.removeClass(this.liTabPublic,"lotusSelected");dojo.attr(this.tabPrivate,"selected","true");this.tabPublic.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPrivate");}else{if(this.defaultView==com.ibm.widgets.AddTag._viewPublic&&this.liTabPublic.style.display!="none"){dojo.addClass(this.liTabPublic,"lotusSelected");dojo.removeClass(this.liTabPrivate,"lotusSelected");dojo.attr(this.tabPublic,"selected","true");this.tabPrivate.removeAttribute("selected");dojo.attr(this.tabContent,"aria-labelledby","tabPublic");}}if(!this.displayTabs){dojo.style(this.liTabPublic,"display","none");dojo.style(this.liTabPrivate,"display","none");}if(!this.mineRatingEnabled){dojo.style(this.deleteLink,"display","none");}if(this.bIsTracing){this.traceExit(m);}},_displayLoading:function(_29ca){var m="_displayLoading(ratingType)";this.traceEntry(m);this.trace(m,"ratingType: ",[_29ca]);if(_29ca==com.ibm.widgets.AddRating._ratingTypePersonal){dojo.attr(this.personalLoadingDiv,"style","");dojo.removeAttr(this.personalLoadingDiv,"style");dojo.style(this.personalRatingRow,"display","none");}else{dojo.attr(this.loadingDiv,"style","");dojo.removeAttr(this.loadingDiv,"style");dojo.style(this.communityRatingRow,"display","none");}this.traceExit(m);},_displayRatings:function(_29cb){var m="_displayTags(ratingType)";this.traceEntry(m);this.trace(m,"ratingType: ",[_29cb]);if(_29cb==com.ibm.widgets.AddRating._ratingTypePersonal){dojo.style(this.personalLoadingDiv,"display","none");dojo.attr(this.personalRatingRow,"style","");dojo.removeAttr(this.personalRatingRow,"style");}else{dojo.style(this.loadingDiv,"display","none");dojo.attr(this.communityRatingRow,"style","");dojo.removeAttr(this.communityRatingRow,"style");}this.traceExit(m);},_deleteAllRatingsOfResource:function(_29cc){if(this.bIsTracing){var m="_deleteAllRatingsOfResource";this.traceEntry(m);}dojo.publish(com.ibm.data.Resolver.TOPICS.UpdateDigest);var _29cd=dojo.xhrDelete({url:_29cc,load:dojo.hitch(this,function(_29ce,_29cf){this.ratingStore._getDigestFromResponse(_29ce,_29cf);this.onSave();}),preventCache:true});this._actionDeleteAllRatingsOfResource=true;if(this.bIsTracing){this.traceExit(m);}},_getFocusItems:function(_29d0){var _29d1=this.containerNode;this.containerNode=_29d0;this.inherited(arguments);this.containerNode=_29d1;}});com.ibm.widgets.AddRating._valueAttribute="title";com.ibm.widgets.AddRating._countAttribute="count";com.ibm.widgets.AddRating._scopeAttribute="ratingScope";com.ibm.widgets.AddRating._deleteAllLinkAttribute="deleteAllLink";com.ibm.widgets.AddRating._resourceModelSchema="rm:";com.ibm.widgets.AddRating._portletModelSchema="pm:oid:";com.ibm.widgets.AddRating._navigationModelSchema="nm:oid:";com.ibm.widgets.AddRating._cpUserModelSchema="cpum:oid:";com.ibm.widgets.AddRating._ratingSpaceEmptyURI="rtm:rs:empty";com.ibm.widgets.AddRating._ratingEmptyURI="rtm:empty";com.ibm.widgets.AddRating._widgetName="addRatings";com.ibm.widgets.AddRating._collaborativeRatingWidgetID="collaborativeRatingWidgetID";com.ibm.widgets.AddRating._isMineRatingWidgetID="isMineRatingWidgetID";com.ibm.widgets.AddRating._privateRatingWidgetID="privateRatingWidgetID";com.ibm.widgets.AddRating._anonymousRatingWidgetID="anonymousRatingWidgetID";com.ibm.widgets.AddRating._ratingTypePersonal="personal";com.ibm.widgets.AddRating._viewPrivate="PRIVATE";com.ibm.widgets.AddRating._viewPublic="PUBLIC";com.ibm.widgets.AddRating._numStars=5;com.ibm.widgets.AddRating._privateRatingEnabled=true;com.ibm.widgets.AddRating._deletingEnabled=true;com.ibm.widgets.AddRating._displayTabs=true;com.ibm.widgets.AddRating._messageFadeOutDuration=1000;com.ibm.widgets.AddRating._parameterMap_Key_RenderMode="renderMode";com.ibm.widgets.AddRating._parameterMap_Value_RenderMode_WSRP="wsrp";com.ibm.widgets.AddRating._ratingScope_community="community";com.ibm.widgets.AddRating._ratingScope_personal_public="personal_public";com.ibm.widgets.AddRating._ratingScope_personal_private="personal_private";com.ibm.widgets.AddRating._ratingScope_community_plus_personal_public=["personal_public","community"];com.ibm.widgets.AddRating._resourceType_contentnode="CONTENT_NODE";com.ibm.widgets.AddRating._resourceType_navigationnode="NAVIGATION_NODE";}if(!dojo._hasResource["com.ibm.widgets.CPLauncher"]){dojo._hasResource["com.ibm.widgets.CPLauncher"]=true;dojo.provide("com.ibm.widgets.CPLauncher");dojo.declare("com.ibm.widgets.CPLauncher",null,{init:function(){},constructor:function(){},launchTagWidget:function(_29d2){var _29d3=dijit.byId("addTags_"+_29d2.rId);if(_29d3!=null){_29d3.hideAndCancelTags();}var _29d4=dojo.isString(_29d2.resolver)?dojo.getObject(_29d2.resolver):_29d2.resolver;_29d3=new com.ibm.widgets.AddTag(_29d2);_29d3.show();console.debug("CPLauncher.launchTagWidget");},launchRatingWidget:function(_29d5){var _29d6=dijit.byId("addRatings_"+_29d5.rId);if(_29d6!=null){_29d6.hideAndCancelRatings();}var _29d7=dojo.isString(_29d5.resolver)?dojo.getObject(_29d5.resolver):_29d5.resolver;_29d6=new com.ibm.widgets.AddRating(_29d5);_29d6.show();console.debug("CPLauncher.launchRatingWidget");}});com.ibm.widgets.CP_LAUNCHER=new com.ibm.widgets.CPLauncher();}if(!dojo._hasResource["com.ibm.cp.DojoLocalized"]){dojo._hasResource["com.ibm.cp.DojoLocalized"]=true;dojo.provide("com.ibm.cp.DojoLocalized");dojo.declare("com.ibm.cp.DojoLocalized",[com.ibm.mashups.enabler.Localized],{bundlePackage:"",bundleName:"",bundleKey:"",constructor:function(_29d8){this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.bundlePackage=_29d8.bundlePackage;this.bundleName=_29d8.bundleName;this.bundleKey=_29d8.bundleKey;this._locales=[dojo.locale];var extra=dojo.config&&dojo.config.extraLocale;if(extra){this._locales.push.apply(this._locales,extra);}dojo["require"+"Localization"](this.bundlePackage,this.bundleName);},_getBundle:function(_29d9){var mname="_getBundle",ret={};try{ret=dojo.i18n.getLocalization(this.bundlePackage,this.bundleName,_29d9);this.LOGGER.trace(mname,"Found bundle for locale ${0}",[_29d9]);}catch(err){this.LOGGER.warning("_getBundle","Bundle not found for locale ${0}",[_29d9]);}return ret;},getLocales:function(){var mname="getLocales";this.LOGGER.entering(mname,[]);if(!this._locales.filtered){this.LOGGER.trace(mname,"Filtering locales",[]);this._locales=dojo.filter(this._locales,function(_29da){var _29db=this._getBundle(_29da);var ret=_29db[this.bundleKey]||_29db[this.bundleKey+"_title"]||_29db[this.bundleKey+"_description"];this.LOGGER.trace(mname,"Does title or description exist for locale ${0}? ${1}",[_29da,ret]);return ret;},this);this._locales.filtered=true;}this.LOGGER.exiting(mname,[this._locales]);return this._locales;},getTitle:function(_29dc){var mname="getTitle";this.LOGGER.entering(mname,[_29dc]);var _29dd=this._getBundle(_29dc);var ret=_29dd[this.bundleKey+"_title"]||_29dd[this.bundleKey];this.LOGGER.exiting(mname,[_29dc]);return ret;},getDescription:function(_29de){var mname="getDescription";this.LOGGER.entering(mname,[_29de]);var ret=this._getBundle(_29de)[this.bundleKey+"_description"];this.LOGGER.exiting(mname,[_29de]);return ret;}});}if(!dojo._hasResource["com.ibm.cp.TRContextMenuLoader"]){dojo._hasResource["com.ibm.cp.TRContextMenuLoader"]=true;dojo.provide("com.ibm.cp.TRContextMenuLoader");dojo.declare("com.ibm.cp.TRContextMenuLoader",com.ibm.mashups.builder.model.ContextMenuLoader,{actions:[{bundlePackage:"com.ibm.bundles",bundleName:"Theme",bundleKey:"rate",ordinal:80,enabled:true,cpLaunchMethod:"launchRatingWidget",visibility:{configCheck:ibmPortalCPConfig?ibmPortalCPConfig.operations.canViewRatings&&ibmPortalCPConfig.isRatingEnabled:null,pageConfigCheck:ibmPortalCPConfig?ibmPortalCPConfig.contextMenu.isRatingEnabled:null,portletConfigCheck:ibmPortalCPConfig?ibmPortalCPConfig.portletContextMenu.isRatingEnabled:null,metadataName:"com.ibm.portal.cp.rating.isRatingDisabled"},id:"CP:rate"},{bundlePackage:"com.ibm.bundles",bundleName:"Theme",bundleKey:"tag",ordinal:100,enabled:true,cpLaunchMethod:"launchTagWidget",visibility:{configCheck:ibmPortalCPConfig?ibmPortalCPConfig.operations.canViewTags&&ibmPortalCPConfig.isTaggingEnabled:null,pageConfigCheck:ibmPortalCPConfig?ibmPortalCPConfig.contextMenu.isTaggingEnabled:null,portletConfigCheck:ibmPortalCPConfig?ibmPortalCPConfig.portletContextMenu.isTaggingEnabled:null,metadataName:"com.ibm.portal.cp.tagging.isTaggingDisabled"},id:"CP:tag"},{bundlePackage:"com.ibm.bundles",bundleName:"Theme",bundleKey:"browseTags",ordinal:110,enabled:true,actionFn:"browseTags",visibility:{configCheck:ibmPortalCPConfig?ibmPortalCPConfig.operations.canBrowseTags&&ibmPortalCPConfig.isTaggingEnabled:null,pageConfigCheck:ibmPortalCPConfig?ibmPortalCPConfig.contextMenu.isTaggingEnabled:null,portletConfigCheck:ibmPortalCPConfig?ibmPortalCPConfig.portletContextMenu.isTaggingEnabled:null,metadataName:"com.ibm.portal.cp.tagging.isTaggingDisabled"},id:"CP:browseTags"}],navStateModelFactory:com.ibm.mashups.enabler.model.state.NavigationStateModelFactory,accessorFactory:com.ibm.mashups.enabler.model.state.AccessorFactory,rtSkinConstants:com.ibm.mashups.enabler.runtime.skin.Constants,runtimeModel:com.ibm.mashups.builder.model.Factory.getRuntimeModel(),includeHeader:true,constructor:function(_29df){if(_29df!=undefined){this.includeHeader=_29df;}this.LOGGER=com.ibm.mashups.enabler.logging.Logger.getLogger(this.declaredClass);this.navModel=com.ibm.mashups.enabler.navigation.Factory.getNavigationModel();this.rtSkinModel=com.ibm.mashups.enabler.runtime.skin.Factory.getRuntimeSkinModel();this.lclCtx=com.ibm.mashups.enabler.context.Factory.getLocalizedContext();},getItems:function(_29e0,_29e1,_29e2,_29e3){var mname="getItems",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);dfd=new com.ibm.cp.EnablerDeferred(this,function(_29e4,sync,_29e5){var res=me._initItems(_29e0,_29e1,_29e2,_29e3);_29e4.finish(res,200);return res;});lgr.exiting(mname,arguments);return dfd;},_initItems:function(_29e6,_29e7,_29e8,_29e9){var mname="_initItems",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);var ret=[];dojo.forEach(this.actions,function(_29ea){if(this.isVisible(_29e7,_29e8,_29ea)){var _29eb=new com.ibm.cp.DojoLocalized({bundlePackage:_29ea.bundlePackage,bundleName:_29ea.bundleName,bundleKey:_29ea.bundleKey});ret.push({localized:_29eb,ordinal:_29ea.ordinal,enabled:_29ea.enabled,id:_29ea.id,actionCallBackFunction:this.getActionFn(_29e7,_29e8,_29e9,_29ea)});}},this);if(ret.length>0&&this.includeHeader){ret.splice(0,0,{isSeparator:true,actionCallBackFunction:function(){},ordinal:60,itemClass:"menuSectionHeader",id:"CP:headSeparator"},{actionCallBackFunction:function(){},localized:new com.ibm.cp.DojoLocalized({bundlePackage:"com.ibm.bundles",bundleName:"Theme",bundleKey:"tagAndRate"}),itemClass:"menuSectionHeader",ordinal:70,enabled:true,id:"CP:header"});}lgr.exiting(mname,[ret]);return ret;},getActionFn:function(_29ec,_29ed,_29ee,_29ef){var me=this;if(_29ef.cpLaunchMethod){return function(){me.cpLaunchFunc(_29ef.cpLaunchMethod,{resourceId:_29ec,resourceType:_29ed});};}else{var _29f0=_29ef.actionFn;return function(){if(dojo.isString(_29f0)){_29f0=me[_29f0];}return _29f0.apply(me,[_29ec,_29ed,_29ee]);};}},cpLaunchFunc:function(_29f1,_29f2){var mname="cpLaunchFunc",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);var title="",rType=null,_29f3=this.runtimeModel.getCurrentPage().getID()||_29f2.navID,_29f4=this.navModel.find(_29f3).start();if(_29f2.resourceType==="com.ibm.mashups.enabler.navigation.NavigationNode"){var _29f5=_29f4.getNavigationElementType();if(_29f5===com.ibm.mashups.enabler.navigation.Constants.NAVIGATION_PAGE){var _29f6=_29f4.getContent().start();var _29f7=_29f6.getID();var xml=_29f6.getXml(),expr="./atom:content/*/ac:allowed-access[@ac:private='true']",nodes=com.ibm.portal.xpath.evaluateXPath(expr,xml,com.ibm.data.resolver.ResolverQueryRules.namespaces),_29f8=nodes!=null?nodes.length>0:false;}else{var _29f7=_29f4.getID();var xml=_29f4.getXml(),expr="./atom:content/*/ac:allowed-access[@ac:private='true']",nodes=com.ibm.portal.xpath.evaluateXPath(expr,xml,com.ibm.data.resolver.ResolverQueryRules.namespaces),_29f8=nodes!=null?nodes.length>0:false;}title=this.lclCtx.getTitle(_29f4);rType="CONTENT_NODE";}else{if(_29f2.resourceType==="com.ibm.mashups.iwidget.widget.IWidgetDefinition"){var _29f7=_29f2.resourceId;if(this.navModel.hasLayoutModel(_29f3)){var _29f9=this.navModel.getLayoutModel(_29f3);var _29fa=_29f9.find(_29f7).start();var xml=_29fa.getXml(),expr="./atom:content/*/ac:allowed-access[@ac:private='true']",nodes=com.ibm.portal.xpath.evaluateXPath(expr,xml,com.ibm.data.resolver.ResolverQueryRules.namespaces),_29f8=nodes!=null?nodes.length>0:false;}else{lgr.warn("Could not find a layout model.");return;}var _29fb=this.rtSkinModel.find(_29f7);if(_29fb){title=_29fb.getDynamicContent(this.rtSkinConstants.DYNAMIC_CONTENT_TITLE);rType="NAVIGATION_NODE";}else{lgr.warn("Could not find runtime skin node with id ${0}",[_29f2.resourceId]);return;}}else{lgr.warn("resourceType ${0} is not a valid CP resource type",[_29f2.resourceType]);return;}}try{lgr.trace(mname,"Launching CP widget ${0} ${1} ${2} ${3} ${4}",[_29f2.resourceId,title,rType,_29f8,ibmPortalConfig.resolver]);var _29fc=null;if(_29f1=="launchTagWidget"){_29fc=new com.ibm.widgets.AddTag({resourceID:_29f7,resourceTitle:title,resourceType:rType,resourcePrivate:_29f8,resolver:ibmPortalConfig.resolver});}else{if(_29f1=="launchRatingWidget"){_29fc=new com.ibm.widgets.AddRating({resourceID:_29f7,resourceTitle:title,resourceType:rType,resourcePrivate:_29f8,resolver:ibmPortalConfig.resolver});}}}catch(err){lgr.severe(mname,err,[err]);throw err;}lgr.exiting(mname,arguments);},isVisible:function(_29fd,_29fe,_29ff){var vbl=_29ff.visibility,ret=true;if(vbl){if("configCheck" in vbl&&"pageConfigCheck" in vbl&&"portletConfigCheck" in vbl&&"metadataName" in vbl){ret=this.confirmCPAction(_29fd,_29fe,vbl.configCheck,vbl.pageConfigCheck,vbl.portletConfigCheck,vbl.metadataName);}else{if(vbl.resourceType&&vbl.resourceType!=_29fe){ret=false;}}}this.LOGGER.trace("isVisible","Action ${0} is visible? ${1}",[_29ff,ret]);return ret;},confirmCPAction:function(_2a00,_2a01,_2a02,_2a03,_2a04,_2a05){var mname="confirmCPAction",lgr=this.LOGGER,me=this;lgr.entering(mname,arguments);var ret=false,node;if(_2a02){if(_2a01==="com.ibm.mashups.enabler.navigation.NavigationNode"){if(_2a03){node=this.navModel.find(_2a00).start();}else{return false;}}else{if(_2a01==="com.ibm.mashups.iwidget.widget.IWidgetDefinition"){if(_2a04){var nsm=this.navStateModelFactory.getNavigationStateModel();var _2a06=this.accessorFactory.getSpaceAccessor(nsm).getSpaceID();var _2a07=this.accessorFactory.getPageAccessor(nsm,_2a06);var _2a08=_2a07.getPageID();var _2a09=this.navModel.find(_2a08).start();var _2a0a=this.navModel.getLayoutModel(_2a09);node=_2a0a.find(_2a00).start();}else{return false;}}else{lgr.warn("resourceType ${0} is not valid for a CP action",[_2a01]);lgr.exiting(mname,[false]);return false;}}var scope=node.getMetaData(_2a05);ret=scope!=="true";}lgr.exiting(mname,[ret]);return ret;},browseTags:function(_2a0b,_2a0c,_2a0d,_2a0e){var _2a0f={};_2a0f.uri="tm:browsetags";_2a0f.rmparam="rm:oid:"+_2a0b;var url=com.ibm.pb.contextMenu.sharedActions.createURL(_2a0b,_2a0f);com.ibm.pb.contextMenu.sharedActions.savePageChecker(function(){top.location.href=url;});}});}if(!dojo._hasResource["com.ibm.data.resolver.UMPocHandler"]){dojo._hasResource["com.ibm.data.resolver.UMPocHandler"]=true;dojo.provide("com.ibm.data.resolver.UMPocHandler");dojo.declare("com.ibm.data.resolver.UMPocHandler",[com.ibm.data.resolver.OpenSearchPocHandler],{namespaces:dojo.mixin({},com.ibm.data.resolver.OpenSearchPocHandler.prototype.namespaces,com.ibm.data.resolver.ResolverQueryRules.namespaces),_secureRegx:null,constructor:function(){this._secureRegx=new RegExp(this.definition.scheme+":secure/");},_createTemplates:function(){var _2a10=[];for(var _2a11 in this.namespaces){_2a10.push("xmlns:",_2a11,"=\"",this.namespaces[_2a11],"\" ");}dojo.mixin(this,{userTemplate:{templateString:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<atom:feed "+_2a10.join("")+">"+"<atom:author>"+"<atom:name>IBM WebSphere Portal/6.1</atom:name>"+"</atom:author>"+"<atom:title>IBM WebSphere Portal Model Feed</atom:title>"+"<atom:link href=\".\" rel=\"self\" type=\"application/atom+xml\"/>"+"<atom:entry creation-context:private=\"${isPrivate}\">"+"<atom:title>${tagname}</atom:title>"+"<atom:id>${id}</atom:id>"+"<atom:link portal:uri=\"${resourceURI}\" rel=\"replies\" href=\"example.org\" />"+"</atom:entry>"+"</atom:feed>",templateProps:{id:"",tagname:"",title:"",resourceURI:""}},groupTemplate:{templateString:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<atom:feed "+_2a10.join("")+">"+"<atom:author>"+"<atom:name>IBM WebSphere Portal/6.1</atom:name>"+"</atom:author>"+"<atom:title>IBM WebSphere Portal Model Feed</atom:title>"+"<atom:link href=\".\" rel=\"self\" type=\"application/atom+xml\"/>"+"<atom:entry creation-context:private=\"${isPrivate}\">"+"<atom:title>${tagname}</atom:title>"+"<atom:id>${id}</atom:id>"+"<atom:link portal:uri=\"${resourceURI}\" rel=\"replies\" href=\"example.org\" />"+"</atom:entry>"+"</atom:feed>",templateProps:{id:"",tagname:"",title:"",resourceURI:""}}});},getTemplate:function(args,_2a12){return this.tagTemplate;},getSaveQuery:function(item){var q=this.inherited(arguments);if(this.resolver.isCreated(item)){q.rep="empty";}else{q.uri=this._newTagURI;}return q;},modifyFetchQuery:function(query,_2a13){var uri=query.uri,match=uri.match(this._secureRegx),sch=this.definition.scheme;if(match!=null&&!this.resolver.isAuthenticated){query.uri=sch+":"+uri.substr(match[0].length);}else{if(match==null&&this.resolver.isAuthenticated){query.uri=sch+":secure/"+uri.substr(sch.length+1);}}return query;}});(function(){var r=com.ibm.data.resolver;var _2a14=r.ResolverQueryRules.atom;var r=com.ibm.data.resolver,tmPoc=r.UMPocHandler,prot=tmPoc.prototype,def=prot.definition,_2a14=r.ResolverQueryRules.atom;def=dojo.mixin({},def,{scheme:"um"});prot.definition=def;var _2a15=function(data,name,type){var _2a16=this.engine.select("./atom:content/um:profile/um:attribute[@name='"+name+"']",data,true);if(_2a16.length>0){return _2a16;}else{var _2a17=this.engine.select("./atom:content/um:profile",data,true);if(_2a17.length>0){return _2a17.createFromJson({name:"um:attribute",attributes:{"name":name,"type":type?type:"xs:string","multivalued":"false"}}).select("./um:attribute[@name='"+name+"']",true);}else{return null;}}},_2a18=function(_2a19,value){_2a19.createFromJson({name:"um:attributeValue",children:[value]});};dojo.extend(tmPoc,{queryRules:dojo.mixin({},r.OpenSearchPocHandler.prototype.queryRules,{umType:{selector:"./atom:content/um:profile",field:"@type",readOnly:true},umIdentifier:{selector:"./atom:content/um:profile",field:"@identifier",readOnly:true},groupMembershipURL:{selector:"./atom:link[@rel='related']",field:"@href",readOnly:true},umAttrIsMultivalued$:{selector:"./atom:content/um:profile/um:attribute[@name='${0}']",field:"@multiValued"},umAttrType$:{selector:"./atom:content/um:profile/um:attribute[@name='${0}']",field:"@type",attrName:"${0}",deferSet:true,setter:function(data,rule,value,_2a1a){var _2a1b=_2a15.call(this,data,rule.attrName,value);if(_2a1b.length>0){_2a1b.attr("type",value);return true;}else{return false;}}},umAttrValue$:{selector:"./atom:content/um:profile/um:attribute[@name='${0}']/um:attributeValue",field:"$textContent",attrName:"${0}",deferSet:true,setter:function(data,rule,value,_2a1c){var _2a1d=_2a15.call(this,data,rule.attrName,value);if(_2a1d.length>0){_2a1d.select("um:attributeValue").destroy();if(_2a1c){dojo.forEach(value,dojo.hitch(this,_2a18,_2a1d));}else{_2a18.call(this,_2a1d,value);}return true;}else{return false;}}},umAttributes:{selector:"./atom:content/um:profile/um:attribute",field:"@name",readOnly:true}})});com.ibm.data.Resolver.register(def.scheme,tmPoc);})();}if(!dojo._hasResource["com.ibm.data.resolver.PrivateAtomModelExt"]){dojo._hasResource["com.ibm.data.resolver.PrivateAtomModelExt"]=true;dojo.provide("com.ibm.data.resolver.PrivateAtomModelExt");dojo.declare("com.ibm.data.resolver.PrivateAtomModelExt",null,{_privacyNodeSelector:"./atom:content/*",modifyNewItemArgs:function(args,_2a1e){this.inherited("modifyNewItemArgs",arguments);if(args.isPrivate!=null){if(dojo.isString(args.isPrivate)){args.isPrivate=args.isPrivate.toLowerCase();switch(args.isPrivate){case "true":case "yes":args.isPrivate="true";break;default:args.isPrivate="false";}}else{if(args.isPrivate==true){args.isPrivate="true";}else{args.isPrivate="false";}}}return args;},fillInProperties:function(_2a1f,_2a20,_2a21,_2a22){this._initItemPrivacy(_2a1f,_2a21);return this.inherited("fillInProperties",arguments);},_initItemPrivacy:function(item,_2a23){if(_2a23.isPrivate!=null){this.engine.select(this._privacyNodeSelector,item.data,true).attr("creationcontext:private",_2a23.isPrivate);}delete _2a23.isPrivate;}});}if(!dojo._hasResource["com.ibm.data.resolver.TMPocHandler"]){dojo._hasResource["com.ibm.data.resolver.TMPocHandler"]=true;dojo.provide("com.ibm.data.resolver.TMPocHandler");dojo.declare("com.ibm.data.resolver.TMPocHandler",[com.ibm.data.resolver.OpenSearchPocHandler,com.ibm.data.resolver.PrivateAtomModelExt],{_newTagURI:"tm:all",_newIdPrefix:"tm:name:",_privacyNodeSelector:".",namespaces:dojo.mixin({},com.ibm.data.resolver.OpenSearchPocHandler.prototype.namespaces,com.ibm.data.resolver.ResolverQueryRules.namespaces),_createTemplates:function(){var _2a24=[];for(var _2a25 in this.namespaces){_2a24.push("xmlns:",_2a25,"=\"",this.namespaces[_2a25],"\" ");}this._nsDeclString=_2a24.join("");dojo.mixin(this,{tagTemplate:{templateString:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<atom:feed "+this._nsDeclString+">"+"<atom:author>"+"<atom:name>IBM WebSphere Portal/7.0</atom:name>"+"</atom:author>"+"<atom:title>IBM WebSphere Portal Model Feed</atom:title>"+"<atom:link href=\".\" rel=\"self\" type=\"application/atom+xml\"/>"+"<atom:entry>"+"<atom:title xml:lang=\"${locale}\">${title}</atom:title>"+"<atom:id>${id}</atom:id>"+"<atom:link ext:uri=\"${resourceURI}\" rel=\"replies\" href=\"example.org\" />"+"</atom:entry>"+"</atom:feed>",templateProps:{id:"",title:"",resourceURI:"",locale:dojo.locale.replace(/-/g,"_")}}});},_serializeSaveData:function(item){return "<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<atom:feed "+this._nsDeclString+">"+"<atom:author>"+"<atom:name>IBM WebSphere Portal/7.0</atom:name>"+"</atom:author>"+"<atom:title>WebSphere Portal Server TagSpace Feed</atom:title>"+"<atom:id>tm:ts:empty</atom:id>"+"<atom:link href=\".\" rel=\"self\" type=\"application/atom+xml\"/>"+com.ibm.domUtilities.stringFromDoc(item.data)+"</atom:feed>";},getTemplate:function(args,_2a26){return this.tagTemplate;},getSaveQuery:function(item){var q=this.inherited(arguments);if(this.resolver.isCreated(item)){q.rep="empty";}else{q.uri=this._newTagURI;}return q;}});(function(){var r=com.ibm.data.resolver;var _2a27=r.ResolverQueryRules.atom;var r=com.ibm.data.resolver,tmPoc=r.TMPocHandler,prot=tmPoc.prototype,def=prot.definition,_2a27=r.ResolverQueryRules.atom;def=dojo.mixin({},def,{scheme:"tm"});prot.definition=def;dojo.extend(tmPoc,{queryRules:dojo.mixin({},r.OpenSearchPocHandler.prototype.queryRules,_2a27.uniqueNameExt,_2a27.L10nExt,_2a27.modelExt,_2a27.cpExt,{tagScope:_2a27.cpExt.cpScope})});com.ibm.data.Resolver.register(def.scheme,tmPoc);})();}if(!dojo._hasResource["com.ibm.data.resolver.RTMPocHandler"]){dojo._hasResource["com.ibm.data.resolver.RTMPocHandler"]=true;dojo.provide("com.ibm.data.resolver.RTMPocHandler");dojo.declare("com.ibm.data.resolver.RTMPocHandler",[com.ibm.data.resolver.OpenSearchPocHandler,com.ibm.data.resolver.PrivateAtomModelExt],{_newRatingURI:"rtm:all",_privacyNodeSelector:".",namespaces:dojo.mixin({},com.ibm.data.resolver.OpenSearchPocHandler.prototype.namespaces,com.ibm.data.resolver.ResolverQueryRules.namespaces),_createTemplates:function(){var _2a28=[];for(var _2a29 in this.namespaces){_2a28.push("xmlns:",_2a29,"=\"",this.namespaces[_2a29],"\" ");}this._nsDeclString=_2a28.join("");dojo.mixin(this,{ratingTemplate:{templateString:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<atom:feed "+this._nsDeclString+">"+"<atom:author>"+"<atom:name>IBM WebSphere Portal/7.0</atom:name>"+"</atom:author>"+"<atom:title>IBM WebSphere Portal Model Feed</atom:title>"+"<atom:link href=\".\" rel=\"self\" type=\"application/atom+xml\"/>"+"<atom:entry>"+"<atom:title>${rating}</atom:title>"+"<atom:id>${id}</atom:id>"+"<atom:link ext:uri=\"${resourceURI}\" rel=\"replies\" href=\"example.org\" />"+"</atom:entry>"+"</atom:feed>",templateProps:{id:"",rating:"",title:"",resourceURI:"",isPrivate:""}}});},_serializeSaveData:function(item){return "<?xml version=\"1.0\" encoding=\"UTF-8\"?>"+"<atom:feed "+this._nsDeclString+">"+"<atom:author>"+"<atom:name>IBM WebSphere Portal/7.0</atom:name>"+"</atom:author>"+"<atom:title>WebSphere Portal Server RatingSpace Feed</atom:title>"+"<atom:id>rtm:rs:empty</atom:id>"+"<atom:link href=\".\" rel=\"self\" type=\"application/atom+xml\"/>"+com.ibm.domUtilities.stringFromDoc(item.data)+"</atom:feed>";},getTemplate:function(args,_2a2a){return this.ratingTemplate;},getSaveQuery:function(item){var q=this.inherited(arguments);if(this.resolver.isCreated(item)){q.rep="empty";}else{q.uri=this._newRatingURI;}return q;}});(function(){var r=com.ibm.data.resolver;var _2a2b=r.ResolverQueryRules.atom;var r=com.ibm.data.resolver,_2a2c=r.RTMPocHandler,prot=_2a2c.prototype,def=prot.definition,_2a2b=r.ResolverQueryRules.atom;def=dojo.mixin({},def,{scheme:"rtm"});prot.definition=def;dojo.extend(_2a2c,{queryRules:dojo.mixin({},r.OpenSearchPocHandler.prototype.queryRules,_2a2b.uniqueNameExt,_2a2b.L10nExt,_2a2b.modelExt,_2a2b.cpExt,{ratingScope:_2a2b.cpExt.cpScope})});com.ibm.data.Resolver.register(def.scheme,_2a2c);})();}if(!dojo._hasResource["dojox.lang.aspect"]){dojo._hasResource["dojox.lang.aspect"]=true;dojo.provide("dojox.lang.aspect");(function(){var d=dojo,aop=dojox.lang.aspect,ap=Array.prototype,_2a2d=[],_2a2e;var _2a2f=function(){this.next_before=this.prev_before=this.next_around=this.prev_around=this.next_afterReturning=this.prev_afterReturning=this.next_afterThrowing=this.prev_afterThrowing=this;this.counter=0;};d.extend(_2a2f,{add:function(_2a30){var dyn=d.isFunction(_2a30),node={advice:_2a30,dynamic:dyn};this._add(node,"before","",dyn,_2a30);this._add(node,"around","",dyn,_2a30);this._add(node,"after","Returning",dyn,_2a30);this._add(node,"after","Throwing",dyn,_2a30);++this.counter;return node;},_add:function(node,topic,_2a31,dyn,_2a32){var full=topic+_2a31;if(dyn||_2a32[topic]||(_2a31&&_2a32[full])){var next="next_"+full,prev="prev_"+full;(node[prev]=this[prev])[next]=node;(node[next]=this)[prev]=node;}},remove:function(node){this._remove(node,"before");this._remove(node,"around");this._remove(node,"afterReturning");this._remove(node,"afterThrowing");--this.counter;},_remove:function(node,topic){var next="next_"+topic,prev="prev_"+topic;if(node[next]){node[next][prev]=node[prev];node[prev][next]=node[next];}},isEmpty:function(){return !this.counter;}});var _2a33=function(){return function(){var self=arguments.callee,_2a34=self.advices,ret,i,a,e,t;if(_2a2e){_2a2d.push(_2a2e);}_2a2e={instance:this,joinPoint:self,depth:_2a2d.length,around:_2a34.prev_around,dynAdvices:[],dynIndex:0};try{for(i=_2a34.prev_before;i!=_2a34;i=i.prev_before){if(i.dynamic){_2a2e.dynAdvices.push(a=new i.advice(_2a2e));if(t=a.before){t.apply(a,arguments);}}else{t=i.advice;t.before.apply(t,arguments);}}try{ret=(_2a34.prev_around==_2a34?self.target:aop.proceed).apply(this,arguments);}catch(e){_2a2e.dynIndex=_2a2e.dynAdvices.length;for(i=_2a34.next_afterThrowing;i!=_2a34;i=i.next_afterThrowing){a=i.dynamic?_2a2e.dynAdvices[--_2a2e.dynIndex]:i.advice;if(t=a.afterThrowing){t.call(a,e);}if(t=a.after){t.call(a);}}throw e;}_2a2e.dynIndex=_2a2e.dynAdvices.length;for(i=_2a34.next_afterReturning;i!=_2a34;i=i.next_afterReturning){a=i.dynamic?_2a2e.dynAdvices[--_2a2e.dynIndex]:i.advice;if(t=a.afterReturning){t.call(a,ret);}if(t=a.after){t.call(a);}}var ls=self._listeners;for(i in ls){if(!(i in ap)){ls[i].apply(this,arguments);}}}finally{for(i=0;i<_2a2e.dynAdvices.length;++i){a=_2a2e.dynAdvices[i];if(a.destroy){a.destroy();}}_2a2e=_2a2d.length?_2a2d.pop():null;}return ret;};};aop.advise=function(obj,_2a35,_2a36){if(typeof obj!="object"){obj=obj.prototype;}var _2a37=[];if(!(_2a35 instanceof Array)){_2a35=[_2a35];}for(var j=0;j<_2a35.length;++j){var t=_2a35[j];if(t instanceof RegExp){for(var i in obj){if(d.isFunction(obj[i])&&t.test(i)){_2a37.push(i);}}}else{if(d.isFunction(obj[t])){_2a37.push(t);}}}if(!d.isArray(_2a36)){_2a36=[_2a36];}return aop.adviseRaw(obj,_2a37,_2a36);};aop.adviseRaw=function(obj,_2a38,_2a39){if(!_2a38.length||!_2a39.length){return null;}var m={},al=_2a39.length;for(var i=_2a38.length-1;i>=0;--i){var name=_2a38[i],o=obj[name],ao=new Array(al),t=o.advices;if(!t){var x=obj[name]=_2a33();x.target=o.target||o;x.targetName=name;x._listeners=o._listeners||[];x.advices=new _2a2f;t=x.advices;}for(var j=0;j<al;++j){ao[j]=t.add(_2a39[j]);}m[name]=ao;}return [obj,m];};aop.unadvise=function(_2a3a){if(!_2a3a){return;}var obj=_2a3a[0],_2a3b=_2a3a[1];for(var name in _2a3b){var o=obj[name],t=o.advices,ao=_2a3b[name];for(var i=ao.length-1;i>=0;--i){t.remove(ao[i]);}if(t.isEmpty()){var empty=true,ls=o._listeners;if(ls.length){for(i in ls){if(!(i in ap)){empty=false;break;}}}if(empty){obj[name]=o.target;}else{var x=obj[name]=d._listener.getDispatcher();x.target=o.target;x._listeners=ls;}}}};aop.getContext=function(){return _2a2e;};aop.getContextStack=function(){return _2a2d;};aop.proceed=function(){var _2a3c=_2a2e.joinPoint,_2a3d=_2a3c.advices;for(var c=_2a2e.around;c!=_2a3d;c=_2a2e.around){_2a2e.around=c.prev_around;if(c.dynamic){var a=_2a2e.dynAdvices[_2a2e.dynIndex++],t=a.around;if(t){return t.apply(a,arguments);}}else{return c.advice.around.apply(c.advice,arguments);}}return _2a3c.target.apply(_2a2e.instance,arguments);};})();}if(!dojo._hasResource["com.ibm.strategy.Strategy"]){dojo._hasResource["com.ibm.strategy.Strategy"]=true;dojo.provide("com.ibm.strategy.Strategy");dojo.declare("com.ibm.strategy.Strategy",null,{extensions:[],extensionsMap:{},strategyInit:function(obj){},getStrategyContext:function(){return dojox.lang.aspect.getContext();},around:function(){var fName=this.getStrategyContext().joinPoint.targetName;if(this.extensionsMap[fName]){return this[this.extensionsMap[fName]].apply(this,arguments);}else{if(this[fName]){return this[fName].apply(this,arguments);}else{return this.proceed(arguments);}}},proceed:function(args){return dojox.lang.aspect.proceed.apply(null,args);}});com.ibm.strategy.Strategy.applyStrategy=function(obj,_2a3e){_2a3e.strategyInit(obj);var adv=dojox.lang.aspect.advise(obj,_2a3e.extensions,_2a3e);return adv;};com.ibm.strategy.Strategy.removeStrategy=function(adv){dojox.lang.aspect.unadvise(adv);};}if(!dojo._hasResource["com.ibm.data.resolver.strategy.PocHandlerStrategy"]){dojo._hasResource["com.ibm.data.resolver.strategy.PocHandlerStrategy"]=true;dojo.provide("com.ibm.data.resolver.strategy.PocHandlerStrategy");dojo.declare("com.ibm.data.resolver.strategy.PocHandlerStrategy",com.ibm.strategy.Strategy,{handler:null,around:function(){this.handler=this.getStrategyContext().instance;var ret=this.inherited(arguments);this.handler=this.getStrategyContext().instance;return ret;}});}if(!dojo._hasResource["com.ibm.data.resolver.strategy.AspectsStrategy"]){dojo._hasResource["com.ibm.data.resolver.strategy.AspectsStrategy"]=true;dojo.provide("com.ibm.data.resolver.strategy.AspectsStrategy");dojo.declare("com.ibm.data.resolver.strategy.AspectsStrategy",com.ibm.data.resolver.strategy.PocHandlerStrategy,{extensions:["modifyFetchQuery"],constructor:function(_2a3f){this._aspects=_2a3f||[];},modifyFetchQuery:function(query){if(!query.aspect){query.aspect=[];}query.aspect=query.aspect.concat(this._aspects);return this.proceed(arguments);}});}if(!dojo._hasResource["com.ibm.data.resolver.strategy.MetadataStrategy"]){dojo._hasResource["com.ibm.data.resolver.strategy.MetadataStrategy"]=true;dojo.provide("com.ibm.data.resolver.strategy.MetadataStrategy");dojo.declare("com.ibm.data.resolver.strategy.MetadataStrategy",com.ibm.data.resolver.strategy.PocHandlerStrategy,{extensions:["modifyFetchQuery"],constructor:function(keys){this._keys=keys||[];},modifyFetchQuery:function(query){if(!query.mdname){query.mdname=[];}else{if(!dojo.isArray(query.mdname)){query.mdname=[query.mdname];}}query.mdname=query.mdname.concat(this._keys);return this.proceed(arguments);}});}if(!dojo._hasResource["com.ibm.widgets.InlineTag"]){dojo._hasResource["com.ibm.widgets.InlineTag"]=true;dojo.provide("com.ibm.widgets.InlineTag");dojo.declare("com.ibm.widgets.InlineTag",[dijit._Widget,dijit._Templated,com.ibm.widgets._Traceable],{widgetsInTemplate:true,bIsTracing:false,resourceID:"",resourceTitle:"",resourceType:"",resourcePrivate:false,resourceCategories:null,tagScope:"COMMUNITY_PERSONAL_PUBLIC",orderMetric:"tag_space_count_reverse_name",order:"DESC",maxResults:5,showDialogLauncher:true,tagsClickable:true,tagClickActionMode:"TAG_CENTER",tagClickTransmitScopes:false,displayTwisty:"collapsed",tagsChangedEvent:"tagsChanged",customLabel:"",customMessageNoTags:"",countsEnabled:false,tagDialogWidgetParameters:null,genericParameterMap:null,_tagCenterAvailable:true,_fetchingScope:null,_fetchUserParam:null,_dapTags:null,_dapTagsList:null,_dapLoadingDiv:null,_resourceSchema:"",_resource:null,_totalResults:0,defaultView:com.ibm.widgets.InlineTag._viewPublic,tagsChangedEventID:"",_isAnonymous:false,_isPreventCache:false,_tagStore:null,_tagData:null,templateString:null,templateString:"<div dojoAttachPoint=\"inlineTagsDiv\" class=\"trc trcTagging  trcInline trcInlineTagging\">\n\t<div dojoAttachPoint=\"sectionHeader\" class=\"trcInlineSection\">\n\t\t<span dojoAttachPoint=\"tagsTitle\" class=\"trcText\" title=\"${bundle.title_community_tags}\">${bundle.title_community_tags}</span>\n\t</div>\n\t<div dojoAttachPoint=\"sectionBody\" class=\"trcInlineSection\">\n\t\t<div dojoAttachPoint=\"loadingDiv\">\n\t\t\t<span class=\"lotusLoading\"><img width=\"20\" height=\"20\" src=\"${blankImage}\"></span>\n\t\t</div>\n\t\t<div dojoAttachpoint=\"tagsList\"></div>\n\t</div>\n\t<div dojoAttachPoint=\"hiddenFormDiv\" name=\"hiddenFormDiv\" style=\"display:none\">\n\t    <form dojoAttachPoint=\"hiddenForm\" name=\"hiddenForm\" action=\".\" method=\"GET\">\n\t      \t<input dojoAttachPoint=\"hiddenFormQNameSelectedTag\" type=\"hidden\"/>\n\t      \t<input dojoAttachPoint=\"hiddenFormQNameTagCloudRedirectView\" type=\"hidden\"/>\n\t      \t<input dojoAttachPoint=\"hiddenFormQNameSelectedTagMode\" type=\"hidden\"/>\n\t\t  \t<input dojoAttachPoint=\"hiddenFormUri\" type=\"hidden\" name=\"uri\" />\n\t\t</form>\n  \t</div>\n\t<div style=\"clear:both;\"></div>\n</div>\n",blankImage:dojo.moduleUrl("dojo","resources/blank.gif").toString(),getTagStore:function(){this._tagStore=ibmPortalConfig.resolver;return this._tagStore;},constructor:function(){this.inherited("constructor","com.ibm.widgets.InlineTag");this.bIsTracing=this.isTracing();this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","AddTag");this._isAnonymous=(ibmPortalConfig.currentUser)?false:true;},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}this._dapLoadingDiv=this.loadingDiv;this._dapTagsList=this.tagsList;if(ibmPortalCPConfig.operations.canViewTags){this.tagsChangedEventID=this.resourceID+this.tagsChangedEvent;this._initializeParameters();this._determineResourceType();this._determineTagsType();this._determineSectionDisplay();var _2a40=dojo.subscribe(this.tagsChangedEventID,this,function(args){this._updateTagsOnEvent(args);});}else{this.destroy();if(this.bIsTracing){this.trace(m,"The user does not have sufficient rights to view tags.");}}if(this.bIsTracing){this.traceExit(m);}},fetchTags:function(){if(this.bIsTracing){var m="fetchTags()";this.traceEntry(m);this.trace(m,"retrieving URI: ",[com.ibm.widgets.InlineTag._tagSpaceEmptyURI,this._resource,this._fetchingScope,this.maxResults,this.orderMetric,this.order]);this.trace(m,"fetchUserParam URI: ",[this._fetchUserParam]);}this._displayLoading();var _2a41={uri:com.ibm.widgets.InlineTag._tagSpaceEmptyURI,rmparam:this._resource,scope:this._fetchingScope,"max-results":this.maxResults,orderMetric:this.orderMetric,order:this.order};if(this._fetchUserParam){_2a41.cpumparam=com.ibm.widgets.InlineTag._cpUserModelSchema+this._fetchUserParam;}this._tagData=this.getTagStore().fetch({query:_2a41,queryOptions:{preventCache:true},onBegin:dojo.hitch(this,"onFetchBegin"),onComplete:dojo.hitch(this,"displayTags"),onError:dojo.hitch(this,"fetchError")});if(this.bIsTracing){this.traceExit(m);}},fetchError:function(err,_2a42,_2a43){if(this.bIsTracing){var m="fetchError(err, errText, errDetails)";this.traceEntry(m);this.trace(m,"errText: ",[_2a42]);this.trace(m,"errDetails: ",[_2a43]);}if((err!==null)&&(err.status==401)){top.location.href=document.location.href;}else{if(this.bIsTracing){this.trace(m,"errText: ",[_2a42]);}}if(this.bIsTracing){this.traceExit(m);}},displayTags:function(items,_2a44){if(this.bIsTracing){var m="displayTags(items, request)";this.traceEntry(m);}var div=dojo.create("div",null,this.tagsList);dojo.addClass(div,"lotusTagCloud lotusui");this._dapTags=div;var img,link,span;this._displayTags();if(items.length<1){if(this.customMessageNoTags!==null){dojo.place(dojo.doc.createTextNode(this.customMessageNoTags),div,"last");dojo.attr(div,"title",this.customMessageNoTags);}else{dojo.place(dojo.doc.createTextNode(this.bundle.text_no_tags_on_this_resource),div,"last");dojo.attr(div,"title",this.bundle.text_no_tags_on_this_resource);}if(this.showDialogLauncher&&(ibmPortalCPConfig.operations.canCreatePrivateTags||ibmPortalCPConfig.operations.canCreatePublicTags)){link=dojo.create("a",{href:"javascript:;",title:this.bundle.title_open_widget},div);img=dojo.create("img",{src:this.blankImage},link);img.style.width="16px";img.style.height="16px";dojo.addClass(link,"trcInlineAddIcon");span=dojo.create("span",{innerHTML:this.bundle.title_open_widget},link);dojo.addClass(span,"lotusAltText");link.onclick=dojo.hitch(this,function(){this.openTagWidget();return false;});}}else{var ul=dojo.create("ul",null,div);dojo.forEach(items,function(item){var _2a45=this.getTagStore().getValue(item,com.ibm.widgets.InlineTag._nameAttribute);var li=dojo.create("li",null,ul);var tag="";if(this.tagsClickable){tag=dojo.create("a",{href:"javascript:;",title:_2a45,id:_2a45},li);tag.onclick=dojo.hitch(this,function(){this.selectTagRedirect(_2a45);return false;});if(this.countsEnabled){dojo.attr(tag,"innerHTML",_2a45+" ("+this.getTagStore().getValue(item,com.ibm.widgets.InlineTag._countAttribute)+")");}else{dojo.attr(tag,"innerHTML",_2a45);}}else{tag=dojo.create("a",{title:_2a45,id:_2a45},li);if(this.countsEnabled){dojo.attr(tag,"innerHTML",_2a45+" ("+this.getTagStore().getValue(item,com.ibm.widgets.InlineTag._countAttribute)+")");}else{dojo.attr(tag,"innerHTML",_2a45);}}if(items.length==1||item==items[items.length-1]){dojo.place(dojo.doc.createTextNode(" "),ul,"last");}else{dojo.place(dojo.doc.createTextNode(", "),ul,"last");}},this);var _2a46=dojo.create("a",{title:this.bundle.title_open_widget,href:"javascript:;",innerHTML:"..."});_2a46.onclick=dojo.hitch(this,function(){this.openTagWidget();return false;});if(this._totalResults>items.length){dojo.place(_2a46,ul,"last");}if(this.showDialogLauncher&&(ibmPortalCPConfig.operations.canCreatePrivateTags||ibmPortalCPConfig.operations.canCreatePublicTags)){link=dojo.create("a",{href:"javascript:;",title:this.bundle.title_open_widget},ul);img=dojo.create("img",{src:this.blankImage},link);img.style.width="16px";img.style.height="16px";dojo.addClass(link,"trcInlineAddIcon");span=dojo.create("span",{innerHTML:this.bundle.title_open_widget},link);dojo.addClass(span,"lotusAltText");link.onclick=dojo.hitch(this,function(){this.openTagWidget();return false;});}}if(this.bIsTracing){this.traceExit(m);}},_displayLoading:function(){var m="_displayLoading()";this.traceEntry(m);dojo.style(this._dapLoadingDiv,"display","block");dojo.style(this._dapTagsList,"display","none");this.traceExit(m);},_displayTags:function(){var m="_displayTags()";this.traceEntry(m);dojo.style(this._dapLoadingDiv,"display","none");dojo.style(this._dapTagsList,"display","block");this.traceExit(m);},_determineSectionDisplay:function(){if(this.bIsTracing){var m="_determineSectionDisplay()";this.traceEntry(m);}var _2a47=dojo.create("a",{title:this.bundle.title_view_tags,href:"javascript:;"});var _2a48=dojo.create("span",null,_2a47);dojo.addClass(_2a48,"lotusAltText");_2a47.onclick=dojo.hitch(this,function(){this.showWidget();return false;});this.twistyLink=_2a47;this.twistySpan=_2a48;if(!this.displayTwisty){this.displayTwisty=ibmPortalCPConfig.metaDataLine.displayTwisty;}switch(this.displayTwisty){case com.ibm.widgets.InlineTag._displayTwisty_hidden:this.showWidget();break;case com.ibm.widgets.InlineTag._displayTwisty_hidden.toUpperCase():this.showWidget();break;case com.ibm.widgets.InlineTag._displayTwisty_collapsed:dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.place(this.twistyLink,this.sectionHeader,"first");dojo.style(this.loadingDiv,"display","none");break;case com.ibm.widgets.InlineTag._displayTwisty_collapsed.toUpperCase():dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.place(this.twistyLink,this.sectionHeader,"first");dojo.style(this.loadingDiv,"display","none");break;case com.ibm.widgets.InlineTag._displayTwisty_expanded:dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_tags);dojo.attr(this.twistySpan,"innerHTML","&#x25C4;");dojo.place(this.twistyLink,this.sectionHeader,"first");this.showWidget();break;case com.ibm.widgets.InlineTag._displayTwisty_expanded.toUpperCase():dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_tags);dojo.attr(this.twistySpan,"innerHTML","&#x25C4;");dojo.place(this.twistyLink,this.sectionHeader,"first");this.showWidget();break;default:this.displayTwisty=com.ibm.widgets.InlineTag._displayTwisty_collapsed;dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.place(this.twistyLink,this.sectionHeader,"first");dojo.style(this.loadingDiv,"display","none");break;}if(this.bIsTracing){this.traceExit(m);}},showWidget:function(event){if(this.bIsTracing){var m="showWidget(event)";this.traceEntry(m);}if(!this._dapTags){dojo.attr(this.twistyLink,"title",this.bundle.title_hide_tags);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistySpan,"innerHTML","&#x25C4;");this.fetchTags();}else{dojo.attr(this.twistyLink,"title",this.bundle.title_view_tags);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.destroy(this._dapTags);this._dapTags=null;}if(this.bIsTracing){this.traceExit(m);}},selectTagRedirect:function(_2a49){if(this.bIsTracing){var m="selectTagRedirect(tagName)";this.traceEntry(m);this.trace(m,"tagName: ",[_2a49]);}this.hiddenFormQNameSelectedTag.name=com.ibm.widgets.InlineTag._qnameSelectedTagAll;this.hiddenFormQNameSelectedTag.value=_2a49;this.hiddenFormQNameTagCloudRedirectView.name=com.ibm.widgets.InlineTag._qnameTagCloudRedirectView;this.hiddenFormQNameTagCloudRedirectView.value=com.ibm.widgets.InlineTag._tagCloudView_all;this.hiddenFormQNameSelectedTagMode.name=com.ibm.widgets.InlineTag._qnameSelectedTagMode;this.hiddenFormQNameSelectedTagMode.value=com.ibm.widgets.InlineTag._tagCloudView_all;if(this._tagCenterAvailable){if(this.tagClickActionMode==com.ibm.widgets.InlineTag._tagClickActionMode_tag_center){this.hiddenFormUri.value=com.ibm.widgets.InlineTag._uriTagCenter;}else{this.hiddenFormUri.value=com.ibm.widgets.InlineTag._uriPRP;}}if(this.tagClickTransmitScopes){if(this.resourceCategories&&this.resourceCategories!==""){dojo.forEach(this.resourceCategories,function(_2a4a){var _2a4b=dojo.create("input",{type:"hidden",name:com.ibm.widgets.InlineTag._qnameSelectedCategories,value:_2a4a},this.hiddenForm);},this);}}this.hiddenForm.submit();if(this.bIsTracing){this.traceExit(m);}},_determineTagsType:function(){if(this.bIsTracing){var m="_determineTagsType()";this.traceEntry(m);}switch(this.tagScope){case com.ibm.widgets.InlineTag._tagScope_community:if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_community_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_community_tags);}this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_community.toUpperCase():if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_community_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_community_tags);}this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_personal:if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_your_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_your_tags);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_personal.toUpperCase():if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_your_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_your_tags);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_personal_public:if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_pub_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_pub_tags);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_personal_public.toUpperCase():if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_pub_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_pub_tags);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_personal_private:if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_priv_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_priv_tags);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_personal_private.toUpperCase():if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_priv_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_priv_tags);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_all:if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_all_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_all_tags);}this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_all.toUpperCase():if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_all_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_all_tags);}this._fetchingScope=this.tagScope;break;case com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public_name:if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_community_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_community_tags);}this._fetchingScope=com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public;break;case com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public_name.toLowerCase():if(this.customLabel!==null){this.tagsTitle.innerHTML=this.customLabel;dojo.attr(this.tagsTitle,"title",this.customLabel);}else{this.tagsTitle.innerHTML=this.bundle.title_community_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_community_tags);}this._fetchingScope=com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public;break;default:this._fetchingScope=com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public;this.tagsTitle.innerHTML=this.bundle.title_community_tags;dojo.attr(this.tagsTitle,"title",this.bundle.title_community_tags);this.tagScope=com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public_name;break;}if(this.bIsTracing){this.traceExit(m);}},openTagWidget:function(){if(this.bIsTracing){var m="openTagWidget()";this.traceEntry(m);}var _2a4c={resourceID:this.resourceID,resourceType:this.resourceType,resourceTitle:this.resourceTitle,resourceCategories:this.resourceCategories};if(!this.tagDialogWidgetParameters){this.tagDialogWidgetParameters=_2a4c;}else{this.tagDialogWidgetParameters.resourceID=this.resourceID;this.tagDialogWidgetParameters.resourceType=this.resourceType;this.tagDialogWidgetParameters.resourceTitle=this.resourceTitle;this.tagDialogWidgetParameters.resourceCategories=this.resourceCategories;}if(this.tagScope.toLowerCase()==com.ibm.widgets.InlineTag._tagScope_personal_private){_2a4c.defaultView=com.ibm.widgets.InlineTag._viewPrivate;}else{_2a4c.defaultView=com.ibm.widgets.InlineTag._viewPublic;}if(this.genericParameterMap){this.tagDialogWidgetParameters.genericParameterMap=this.genericParameterMap;}var _2a4d=new com.ibm.widgets.AddTag(this.tagDialogWidgetParameters);if(this.bIsTracing){this.traceExit(m);}},_determineResourceType:function(){if(this.bIsTracing){var m="_determineResourceType()";this.traceEntry(m);}switch(this.resourceType){case com.ibm.widgets.InlineTag._resourceType_contentnode:this._resourceSchema=com.ibm.widgets.InlineTag._navigationModelSchema;this._setResource(com.ibm.widgets.InlineTag._resourceModelSchema+this._resourceSchema+this.resourceID);break;case com.ibm.widgets.InlineTag._resourceType_navigationnode:this._resourceSchema=com.ibm.widgets.InlineTag._portletModelSchema;this._setResource(com.ibm.widgets.InlineTag._resourceModelSchema+this._resourceSchema+this.resourceID);break;default:this._setResource(com.ibm.widgets.InlineTag._resourceModelSchema+this.resourceID);break;}if(this.bIsTracing){this.traceExit(m);}},_setResource:function(_2a4e){if(this.bIsTracing){var m="_setResource(resource)";this.traceEntry(m);this.trace(m,"resource: ",[_2a4e]);}this._resource=_2a4e;if(this.bIsTracing){this.traceExit(m);}},_updateTagsOnEvent:function(args){if(this.bIsTracing){var m="_updateTagsOnEvent(args)";this.traceEntry(m);}if((this.tagScope==com.ibm.widgets.InlineTag._tagScope_personal)||(this.tagScope==com.ibm.widgets.InlineTag._tagScope_all)||(this.tagScope==com.ibm.widgets.InlineTag._tagScope_all.toUpperCase())||(this.tagScope==com.ibm.widgets.InlineTag._tagScope_personal.toUpperCase())||(args.scope==com.ibm.widgets.InlineTag._tagScope_personal_public&&this.tagScope==com.ibm.widgets.InlineTag._tagScope_personal_public)||(args.scope==com.ibm.widgets.InlineTag._tagScope_personal_public&&this.tagScope==com.ibm.widgets.InlineTag._tagScope_personal_public.toUpperCase())||(args.scope==com.ibm.widgets.InlineTag._tagScope_personal_private&&this.tagScope==com.ibm.widgets.InlineTag._tagScope_personal_private)||(args.scope==com.ibm.widgets.InlineTag._tagScope_personal_private&&this.tagScope==com.ibm.widgets.InlineTag._tagScope_personal_private.toUpperCase())||(args.scope==com.ibm.widgets.InlineTag._tagScope_personal_public&&this.tagScope==com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public_name)||(args.scope==com.ibm.widgets.InlineTag._tagScope_personal_public&&this.tagScope==com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public_name.toLowerCase())){if(!this._dapTags){dojo.attr(this.twistyLink,"title",this.bundle.title_hide_tags);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"alt","&#x25C4;");this.fetchTags();}else{dojo.attr(this.twistyLink,"alt","&#x25bc;");dojo.destroy(this._dapTags);this._dapTags=null;this.fetchTags();}}if(this.bIsTracing){this.traceExit(m);}},onFetchBegin:function(_2a4f,_2a50){if(this.bIsTracing){var m="onFetchBegin(totalResultSize, requestObject)";this.traceEntry(m);this.trace(m,"totalResultSize: ",[_2a4f]);}this._totalResults=_2a4f;if(this.bIsTracing){this.traceExit(m);}},_initializeParameters:function(){if(this.bIsTracing){var m="_initializeParameters()";this.traceEntry(m);}if(!("resolver" in this.params)){this.tagStore=ibmPortalConfig.resolver;}if(!("tagScope" in this.params)){if(ibmPortalCPConfig.tagging.inline.tagScope!=null){this.tagScope=ibmPortalCPConfig.tagging.inline.tagScope;}else{this.tagScope=com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public;}}if(!("orderMetric" in this.params)){if(ibmPortalCPConfig.tagging.inline.orderMetric!=null){this.orderMetric=ibmPortalCPConfig.tagging.inline.orderMetric;}else{this.orderMetric=com.ibm.widgets.InlineTag._DEFAULT_ORDER_METRIC;}}if(!("order" in this.params)){if(ibmPortalCPConfig.tagging.inline.order!=null){this.order=ibmPortalCPConfig.tagging.inline.order;}else{this.order=com.ibm.widgets.InlineTag._DEFAULT_ORDER;}}if(!("maxResults" in this.params)){if(ibmPortalCPConfig.tagging.inline.maxResults!=null){this.maxResults=ibmPortalCPConfig.tagging.inline.maxResults;}else{this.maxResults=com.ibm.widgets.InlineTag._maxResults;}}if(!("showDialogLauncher" in this.params)){if(ibmPortalCPConfig.tagging.inline.showDialogLauncher!=null){this.showDialogLauncher=ibmPortalCPConfig.tagging.inline.showDialogLauncher;}else{this.showDialogLauncher=com.ibm.widgets.InlineTag._showDialogLauncher;}}if(!("tagsClickable" in this.params)){if(ibmPortalCPConfig.tagging.inline.tagsClickable!=null){this.tagsClickable=ibmPortalCPConfig.tagging.inline.tagsClickable;}else{this.tagsClickable=com.ibm.widgets.InlineTag._tagsClickable;}}if(!("displayTwisty" in this.params)){if(ibmPortalCPConfig.tagging.inline.displayTwisty!=null){this.displayTwisty=ibmPortalCPConfig.tagging.inline.displayTwisty;}else{this.displayTwisty=com.ibm.widgets.InlineTag._displayTwisty;}}if(!("customLabel" in this.params)){if(ibmPortalCPConfig.tagging.inline.customLabel!=null){this.customLabel=ibmPortalCPConfig.tagging.inline.customLabel;}else{this.customLabel=null;}}if(!("tagClickActionMode" in this.params)){if(ibmPortalCPConfig.tagging.inline.tagClickActionMode!=null){this.tagClickActionMode=ibmPortalCPConfig.tagging.inline.tagClickActionMode;}else{this.tagClickActionMode=com.ibm.widgets.InlineTag._tagClickActionMode;}}if(!("tagClickTransmitScopes" in this.params)){if(ibmPortalCPConfig.tagging.inline.tagClickTransmitScopes!=null){this.tagClickTransmitScopes=ibmPortalCPConfig.tagging.inline.tagClickTransmitScopes;}else{this.tagClickTransmitScopes=com.ibm.widgets.InlineTag._tagClickTransmitScopes;}}if(!("tagsChangedEvent" in this.params)){if(ibmPortalCPConfig.tagging.inline.tagsChangedEvent!=null){this.tagsChangedEvent=ibmPortalCPConfig.tagging.inline.tagsChangedEvent;}else{this.tagsChangedEvent=com.ibm.widgets.InlineTag._DEFAULT_TAGSCHANGED_EVENT_NAME;}}if(!("customMessageNoTags" in this.params)){if(ibmPortalCPConfig.tagging.inline.customMessageNoTags!=null){this.customMessageNoTags=ibmPortalCPConfig.tagging.inline.customMessageNoTags;}else{this.customMessageNoTags=null;}}if(!("countsEnabled" in this.params)){if(ibmPortalCPConfig.tagging.inline.countsEnabled!=null){this.countsEnabled=ibmPortalCPConfig.tagging.inline.countsEnabled;}else{this.countsEnabled=com.ibm.widgets.InlineTag._countsEnabled;}}if(this.bIsTracing){this.traceExit(m);}}});com.ibm.widgets.InlineTag._qnameSelectedTagAll="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stv_all";com.ibm.widgets.InlineTag._qnameSelectedCategories="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}sc";com.ibm.widgets.InlineTag._qnameTagCloudRedirectView="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}tcrv";com.ibm.widgets.InlineTag._qnameSelectedTagMode="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stm";com.ibm.widgets.InlineTag._uriTagCenter="tm:tc";com.ibm.widgets.InlineTag._uriPRP="tm:prp";com.ibm.widgets.InlineTag._tagScope_all="all";com.ibm.widgets.InlineTag._tagScope_community="community";com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public=["personal_public","community"];com.ibm.widgets.InlineTag._tagScope_community_plus_personal_public_name="COMMUNITY_PERSONAL_PUBLIC";com.ibm.widgets.InlineTag._tagScope_personal="personal";com.ibm.widgets.InlineTag._tagScope_personal_public="personal_public";com.ibm.widgets.InlineTag._tagScope_personal_private="personal_private";com.ibm.widgets.InlineTag._viewPrivate="PRIVATE";com.ibm.widgets.InlineTag._viewPublic="PUBLIC";com.ibm.widgets.InlineTag._tagCloudView_all="all";com.ibm.widgets.InlineTag._tagClickActionMode_tag_center="TAG_CENTER";com.ibm.widgets.InlineTag._tagClickActionMode_public_render_parameter="PUBLIC_RENDER_PARAMETER";com.ibm.widgets.InlineTag._nameAttribute="title";com.ibm.widgets.InlineTag._countAttribute="count";com.ibm.widgets.InlineTag._resourceModelSchema="rm:";com.ibm.widgets.InlineTag._portletModelSchema="pm:oid:";com.ibm.widgets.InlineTag._navigationModelSchema="nm:oid:";com.ibm.widgets.InlineTag._cpUserModelSchema="cpum:oid:";com.ibm.widgets.InlineTag._tagSpaceEmptyURI="tm:ts:empty";com.ibm.widgets.InlineTag._displayTwisty_collapsed="collapsed";com.ibm.widgets.InlineTag._displayTwisty_hidden="hidden";com.ibm.widgets.InlineTag._displayTwisty_expanded="expanded";com.ibm.widgets.InlineTag._resourceType_contentnode="CONTENT_NODE";com.ibm.widgets.InlineTag._resourceType_navigationnode="NAVIGATION_NODE";com.ibm.widgets.InlineTag._DEFAULT_ORDER_METRIC="tag_space_count_reverse_name";com.ibm.widgets.InlineTag._DEFAULT_ORDER="DESC";com.ibm.widgets.InlineTag._DEFAULT_DISPLAY_TWISTY_VALUE="collapsed";com.ibm.widgets.InlineTag._DEFAULT_TAGSCHANGED_EVENT_NAME="tagsChanged";com.ibm.widgets.InlineTag._maxResults=5;com.ibm.widgets.InlineTag._showDialogLauncher=true;com.ibm.widgets.InlineTag._tagsClickable=true;com.ibm.widgets.InlineTag._displayTwisty="collapsed";com.ibm.widgets.InlineTag._tagClickActionMode="TAG_CENTER";com.ibm.widgets.InlineTag._tagClickTransmitScopes=true;com.ibm.widgets.InlineTag._countsEnabled=false;}if(!dojo._hasResource["com.ibm.widgets.InlineRating"]){dojo._hasResource["com.ibm.widgets.InlineRating"]=true;dojo.provide("com.ibm.widgets.InlineRating");dojo.declare("com.ibm.widgets.InlineRating",[com.ibm.widgets._Traceable,dijit._Widget,dijit._Templated],{widgetsInTemplate:true,bIsTraceable:false,resourceID:"",resourceTitle:"",resourceType:"",resourcePrivate:false,numStars:5,showDialogLauncher:true,onStarHoverShowRatingDistribution:true,onStarClickOpenDialog:true,ratingScope:"COMMUNITY_PERSONAL_PUBLIC",displayTwisty:"collapsed",customLabel:"",ratingDistributionPosition:[30,30],ratingsChangedEvent:"ratingsChanged",ratingDialogWidgetParameters:null,genericParameterMap:null,_resourceSchema:"",_resource:null,_myChart:null,_isAnonymous:false,_isPreventCache:false,_fetchingScope:null,_fetchUserParam:null,_dapRatings:null,_dapRatingWidget:null,_dapRatingDistDiv:null,_dapOpenWidgetLink:null,_dapRatingsDiv:null,_dapLoadingDiv:null,_dapSectionBody:null,_connHandlers:[],defaultView:"PUBLIC",_ratingStore:null,_ratingData:null,ratingsChangedEventID:"",templateString:null,templateString:"<div dojoAttachPoint=\"inlineRatingsDiv\" class=\"trc trcRating trcInline trcInlineRating\">\n\t<div dojoAttachPoint=\"sectionHeader\" class=\"trcInlineSection\">\n\t\t<span dojoAttachPoint=\"ratingsTitle\" class=\"trcText\" title=\"${bundle.title_community_rating}\">${bundle.title_community_rating}</span>\n\t</div>\n\t<div dojoAttachPoint=\"sectionBody\" class=\"trcInlineSection trcRelative\">\n\t\t<div dojoAttachPoint=\"loadingDiv\">\n\t\t\t<span class=\"lotusLoading\"><img width=\"20\" height=\"20\" src=\"${blankImage}\"></span>\n\t\t</div>\n\t\t<div dojoAttachpoint=\"ratingsDiv\"></div>\n\t\t<div dojoAttachPoint=\"popupRatingDistWrapper\" class=\"lotusHelp trcRatingDist\">\n\t\t\t<div class=\"lotusInfoBox\" dojoAttachPoint=\"popupRatingDist\"></div>\n\t\t</div>\n\t</div>\n\t<div style=\"clear:both;\"></div>\n</div>\n",blankImage:dojo.moduleUrl("dojo","resources/blank.gif").toString(),getRatingStore:function(){return this._ratingStore;},constructor:function(){dojo.forEach(this._connHandlers,dojo.disconnect);this.inherited("constructor","com.ibm.widgets.InlineRating");this.bIsTracing=this.isTracing();this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","AddRating");this._isAnonymous=(ibmPortalConfig.currentUser)?false:true;},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}this._dapLoadingDiv=this.loadingDiv;this._dapRatingsDiv=this.ratingsDiv;this._dapSectionBody=this.sectionBody;if(ibmPortalCPConfig.operations.canViewRatings){if(this.bIsTracing){this.trace(m,"The user has sufficient rights to view ratings.");}this.ratingsChangedEventID=this.resourceID+this.ratingsChangedEvent;if(!this._ratingStore){this._ratingStore=ibmPortalConfig.resolver;}var _2a51=dojo.subscribe(this.ratingsChangedEventID,this,function(args){this._updateRatingsOnEvent(args);});this._initializeParameters();this._determineResourceType();this._determineRatingsType();this._determineSectionDisplay();}else{this.destroy();if(this.bIsTracing){this.trace(m,"The user does not have sufficient rights to view ratings.");}}if(this.bIsTracing){this.traceExit(m);}},fetchRatings:function(){if(this.bIsTracing){var m="fetchRatings()";this.traceEntry(m);this.trace(m,"fetchUserParam",this.fetchUserParam);}this._displayLoading();var _2a52={uri:com.ibm.widgets.InlineRating._ratingSpaceEmptyURI,rmparam:com.ibm.widgets.InlineRating._resourceModelSchema+this._resourceSchema+this.resourceID,scope:this._fetchingScope};if(this._fetchUserParam){_2a52.cpumparam=com.ibm.widgets.InlineRating._cpUserModelSchema+this._fetchUserParam;}this._ratingData=this.getRatingStore().fetch({query:_2a52,queryOptions:{preventCache:true},onComplete:dojo.hitch(this,"displayRatings"),onError:dojo.hitch(this,"fetchError")});if(this.bIsTracing){this.traceExit(m);}},fetchError:function(err,_2a53,_2a54){if(this.bIsTracing){var m="fetchError(err, errText, errDetails)";this.traceEntry(m);this.trace(m,"errText: ",[_2a53]);this.trace(m,"errDetails: ",[_2a54]);}if((err!==null)&&(err.status==401)){top.location.href=document.location.href;}else{if(this.bIsTracing){this.trace(m,"errText: ",[_2a53]);}}if(this.bIsTracing){this.traceExit(m);}},displayRatings:function(items,_2a55){if(this.bIsTracing){var m="displayRatings(items, request)";this.traceEntry(m,[items,_2a55]);}if(!dojo.hasClass(this.twistyLink,"lotusTwistyOpen")){dojo.style(this._dapSectionBody,"float","left");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_ratings);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"alt","&#x25C4;");}var _2a56=false;var _2a57=0;var _2a58=0;var _2a59=[];for(var k=0;k<this.numStars;k++){_2a59[k]=0;}var _2a5a=0;var _2a5b=0;var _2a5c=0;var _2a5d=0;var _2a5e=0;dojo.forEach(items,function(item){_2a56=true;var _2a5f=parseInt(this.getRatingStore().getValue(item,com.ibm.widgets.InlineRating._valueAttribute),10);if(this.bIsTracing){this.trace(m,"ratingValue",_2a5f);}var count=parseInt(this.getRatingStore().getValue(item,com.ibm.widgets.InlineRating._countAttribute),10);if(this.bIsTracing){this.trace(m,"Count",_2a5f);}if(this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_community||this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_all||this.ratingScope.toUpperCase()==com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name){_2a59[_2a5f-1]=_2a59[_2a5f-1]+count;}switch(_2a5f){case 1:_2a5a=_2a5a+count;break;case 2:_2a5b=_2a5b+count;break;case 3:_2a5c=_2a5c+count;break;case 4:_2a5d=_2a5d+count;break;case 5:_2a5e=_2a5e+count;break;default:break;}_2a57=_2a57+count;_2a58=_2a58+(_2a5f*count);},this);var div=null;var link=null;var img=null;var span=null;this._displayRatings();if(_2a56){if(this.bIsTracing){this.trace(m,"numberOfRatings",_2a57);this.trace(m,"totalRatingValue",_2a58);}var _2a60=_2a58/_2a57;if(this.bIsTracing){this.trace(m,"averageRatingValue",_2a60);}if(this._dapRatingWidget){dojo.attr(this._dapRatingWidget,"value",_2a60);dojo.parser.parse(this.ratingsDiv).parent;}else{div=dojo.create("div",{id:"dapRatings"},this.ratingsDiv);this._dapRatings=div;this._dapRatingWidget=dijit.byId(this.resourceID+this.ratingScope+com.ibm.widgets.InlineRating.inlineRatingWidgetID);if(this._dapRatingWidget){this._dapRatingWidget.destroy();}var _2a61=dojo.string.substitute(this.bundle.title_rating_percentage,[(Math.round(_2a60*100)/100),this.numStars]);if(this.bundle.title_click_to_add_ratings){_2a61+=this.bundle.title_click_to_add_ratings;}this._dapRatingWidget=new com.ibm.widgets.Rating({id:this.resourceID+this.ratingScope+com.ibm.widgets.InlineRating.inlineRatingWidgetID,numStars:this.numStars,value:_2a60,role:"link",hoverable:false,clickable:false,titleText:_2a61},this._dapRatings);if(this.showDialogLauncher&&(ibmPortalCPConfig.operations.canCreatePrivateRatings||ibmPortalCPConfig.operations.canCreatePublicRatings)){link=dojo.create("a",{href:"javascript:;",title:this.bundle.title_open_widget},this.ratingsDiv);img=dojo.create("img",{style:"padding: 3px",src:this.blankImage},link);img.style.width="16px";img.style.height="16px";dojo.addClass(link,"trcInlineAddIcon");span=dojo.create("span",{innerHTML:"Open the rating widget"},link);dojo.addClass(span,"lotusAltText");link.onclick=dojo.hitch(this,function(){this.openRatingWidget();return false;});this._dapOpenWidgetLink=link;}if(this.onStarHoverShowRatingDistribution&&(this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_community||this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_all||this.ratingScope.toUpperCase()==com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name)){this.displayCollaborativeRatingDistribution(_2a59);this._connHandlers.push(dojo.connect(this._dapRatingWidget.domNode,"onmouseover",dojo.hitch(this,"_showPopup")));this._connHandlers.push(dojo.connect(this._dapRatingWidget.domNode,"onmouseout",dojo.hitch(this,"_hidePopup")));}if(this.onStarClickOpenDialog){this._connHandlers.push(dojo.connect(this._dapRatingWidget.domNode,"onclick",dojo.hitch(this,"openRatingWidget")));this._connHandlers.push(dojo.connect(this._dapRatingWidget.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit")));}if(this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_community||this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_all||this.ratingScope.toUpperCase()==com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name){this._dapRatingWidget.setAttribute("halfStarSupport","true");}}}else{div=dojo.create("div",{id:"dapRatings"},this.ratingsDiv);this._dapRatings=div;this._dapRatingWidget=dijit.byId(this.resourceID+this.ratingScope+com.ibm.widgets.InlineRating.inlineRatingWidgetID);if(this._dapRatingWidget){this._dapRatingWidget.destroy();}var _2a61=this.bundle.title_not_set;if(this.bundle.title_click_to_add_ratings){_2a61+=this.bundle.title_click_to_add_ratings;}this._dapRatingWidget=new com.ibm.widgets.Rating({id:this.resourceID+this.ratingScope+com.ibm.widgets.InlineRating.inlineRatingWidgetID,numStars:this.numStars,value:0,role:"link",hoverable:false,clickable:false,titleText:_2a61},this._dapRatings);if(this.onStarClickOpenDialog){this._connHandlers.push(dojo.connect(this._dapRatingWidget.domNode,"onclick",dojo.hitch(this,"openRatingWidget")));this._connHandlers.push(dojo.connect(this._dapRatingWidget.domNode,"onkeyup",dojo.hitch(this,"_checkKeySubmit")));}if(this.showDialogLauncher&&(ibmPortalCPConfig.operations.canCreatePrivateRatings||ibmPortalCPConfig.operations.canCreatePublicRatings)){link=dojo.create("a",{href:"javascript:;",title:this.bundle.title_open_widget},this.ratingsDiv);img=dojo.create("img",{src:this.blankImage},link);img.style.width="16px";img.style.height="16px";dojo.addClass(link,"trcInlineAddIcon");span=dojo.create("span",{innerHTML:"Open the rating widget"},link);dojo.addClass(span,"lotusAltText");link.onclick=dojo.hitch(this,function(){this.openRatingWidget();return false;});this._dapOpenWidgetLink=link;}}if(this.bIsTracing){this.traceExit(m);}},_displayLoading:function(){var m="_displayLoading()";this.traceEntry(m);dojo.style(this._dapRatingsDiv,"display","none");dojo.style(this._dapLoadingDiv,"display","block");this.traceExit(m);},_displayRatings:function(){var m="_displayRatings()";this.traceEntry(m);dojo.style(this._dapLoadingDiv,"display","none");dojo.style(this._dapRatingsDiv,"display","block");this.traceExit(m);},_determineSectionDisplay:function(){if(this.bIsTracing){var m="_determineSectionDisplay()";this.traceEntry(m);}var _2a62=dojo.create("a",{href:"javascript:;",title:this.bundle.title_view_ratings});var _2a63=dojo.create("span",null,_2a62);dojo.addClass(_2a63,"lotusAltText");_2a62.onclick=dojo.hitch(this,function(){this.showWidget();return false;});this.twistyLink=_2a62;this.twistySpan=_2a63;switch(this.displayTwisty){case com.ibm.widgets.InlineRating._displayTwisty_hidden:this.showWidget();break;case com.ibm.widgets.InlineRating._displayTwisty_hidden.toUpperCase():this.showWidget();break;case com.ibm.widgets.InlineRating._displayTwisty_collapsed:dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.place(this.twistyLink,this.sectionHeader,"first");dojo.style(this.loadingDiv,"display","none");break;case com.ibm.widgets.InlineRating._displayTwisty_collapsed.toUpperCase():dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.place(this.twistyLink,this.sectionHeader,"first");dojo.style(this.loadingDiv,"display","none");break;case com.ibm.widgets.InlineRating._displayTwisty_expanded:dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_ratings);dojo.attr(this.twistySpan,"innerHTML","&#x25C4;");dojo.place(this.twistyLink,this.sectionHeader,"first");this.showWidget();break;case com.ibm.widgets.InlineRating._displayTwisty_expanded.toUpperCase():dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_ratings);dojo.attr(this.twistySpan,"innerHTML","&#x25C4;");dojo.place(this.twistyLink,this.sectionHeader,"first");this.showWidget();break;default:this.displayTwisty=com.ibm.widgets.InlineRating._displayTwisty_collapsed;dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");dojo.place(this.twistyLink,this.sectionHeader,"first");dojo.style(this.loadingDiv,"display","none");break;}if(this.bIsTracing){this.traceExit(m);}},showWidget:function(event){if(this.bIsTracing){var m="showWidget(event)";this.traceEntry(m,event);}if(!this._dapRatings){dojo.style(this.sectionBody,"float","left");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_ratings);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistySpan,"innerHTML","&#x25C4;");this.fetchRatings();}else{dojo.attr(this.twistyLink,"title",this.bundle.title_view_ratings);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistySpan,"innerHTML","&#x25bc;");var _2a64=this._dapRatingWidget.domNode;this._dapRatingWidget.destroy();dojo.destroy(_2a64);this._dapRatingWidget=null;dojo.destroy(this._dapRatings);this._dapRatings=null;dojo.destroy(this._dapOpenWidgetLink);this._dapOpenWidgetLink=null;if(this._myChart){this._myChart.destroy();this._myChart=null;}dojo.forEach(this._connHandlers,dojo.disconnect);}if(this.bIsTracing){this.traceExit(m);}},openRatingWidget:function(){if(this.bIsTracing){var m="openRatingWidget()";this.traceEntry(m);}var _2a65={resourceID:this.resourceID,resourceType:this.resourceType,resourceTitle:this.resourceTitle,resourceCategory:this.resourceCategory};if(this.bIsTracing){this.trace(m,"Rating dialog widget parameters",this.ratingDialogWidgetParameters);}if(!this.ratingDialogWidgetParameters){this.ratingDialogWidgetParameters=_2a65;}else{this.ratingDialogWidgetParameters.resourceID=this.resourceID;this.ratingDialogWidgetParameters.resourceType=this.resourceType;this.ratingDialogWidgetParameters.resourceTitle=this.resourceTitle;this.ratingDialogWidgetParameters.resourceCategories=this.resourceCategories;}if(this.ratingScope.toLowerCase()==com.ibm.widgets.InlineRating._ratingScope_personal_private){_2a65.defaultView=com.ibm.widgets.InlineRating._viewPrivate;}else{_2a65.defaultView=com.ibm.widgets.InlineRating._viewPublic;}if(this.bIsTracing){this.trace(m,"genericParameterMap",this.genericParameterMap);}if(this.genericParameterMap){this.ratingDialogWidgetParameters.genericParameterMap=this.genericParameterMap;}var _2a66=new com.ibm.widgets.AddRating(this.ratingDialogWidgetParameters);if(this.bIsTracing){this.traceExit(m);}},_determineRatingsType:function(){if(this.bIsTracing){var m="_determineRatingsType()";this.traceEntry(m);this.trace(m,"this.params",this.params);}switch(this.ratingScope){case com.ibm.widgets.InlineRating._ratingScope_community:if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_community_rating;dojo.attr(this.ratingsTitle,"title",this.title_community_rating);}this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_community.toUpperCase():if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_community_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_community_rating);}this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_personal:if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_your_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_your_rating);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_personal.toUpperCase():if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_your_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_your_rating);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_personal_private:if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_priv_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_priv_rating);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_personal_private.toUpperCase():if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_priv_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_priv_rating);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_personal_public:if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_pub_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_pub_rating);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_personal_public.toUpperCase():if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_pub_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_pub_rating);}this._fetchUserParam=ibmPortalConfig.currentUserOID;this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_all:if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_all_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_all_rating);}this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_all.toUpperCase():if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_all_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_all_rating);}this._fetchingScope=this.ratingScope;break;case com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name:if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_community_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_community_rating);}this._fetchingScope=com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public;break;case com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name.toLowerCase():if(this.customLabel!==null){this.ratingsTitle.innerHTML=this.customLabel;dojo.attr(this.ratingsTitle,"title",this.customLabel);}else{this.ratingsTitle.innerHTML=this.bundle.title_community_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_community_rating);}this._fetchingScope=com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public;break;default:this._fetchingScope=com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public;this.ratingsTitle.innerHTML=this.bundle.title_community_rating;dojo.attr(this.ratingsTitle,"title",this.bundle.title_community_rating);this.ratingScope=com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name;break;}if(this.bIsTracing){this.traceExit(m);}},_determineResourceType:function(){if(this.bIsTracing){var m="_determineResourceType()";this.traceEntry(m);}switch(this.resourceType){case "CONTENT_NODE":this._resourceSchema=com.ibm.widgets.InlineRating._navigationModelSchema;break;case "NAVIGATION_NODE":this._resourceSchema=com.ibm.widgets.InlineRating._portletModelSchema;break;default:break;}if(this.bIsTracing){this.traceExit(m);}},displayCollaborativeRatingDistribution:function(_2a67){if(this.bIsTracing){var m="displayCollaborativeRatingDistribution(aNumberOfRatingValues)";this.traceEntry(m,_2a67);}if(this._myChart){this._myChart.update(_2a67);}else{var div=dojo.create("div",null,this.popupRatingDist);this._myChart=new com.ibm.widgets.AddRatingChart({values:_2a67},div);}this._myChart.startup();if(this.bIsTracing){this.traceExit(m);}},_showPopup:function(){if(this.bIsTracing){var m="_showPopup()";this.traceEntry(m);this.trace(m,"ratingDistributionPosition",this.ratingDistributionPosition);}dojo.style(this.popupRatingDistWrapper,"display","block");dojo.style(this.popupRatingDistWrapper,"left",this.ratingDistributionPosition[0]+"px");dojo.style(this.popupRatingDistWrapper,"top",this.ratingDistributionPosition[1]+"px");if(this.bIsTracing){this.traceExit(m);}},_hidePopup:function(){if(this.bIsTracing){var m="_hidePopup()";this.traceEntry(m);}dojo.style(this.popupRatingDistWrapper,"display","none");if(this.bIsTracing){this.traceExit(m);}},_updateRatingsOnEvent:function(args){if(this.bIsTracing){var m="_updateRatingsOnEvent(args)";this.traceEntry(m,args);}if((this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_personal)||(this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_all)||(this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_all.toUpperCase())||(this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_personal.toUpperCase())||(args.scope==com.ibm.widgets.InlineRating._ratingScope_personal_public&&this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_personal_public)||(args.scope==com.ibm.widgets.InlineRating._ratingScope_personal_public&&this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_personal_public.toUpperCase())||(args.scope==com.ibm.widgets.InlineRating._ratingScope_personal_private&&this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_personal_private)||(args.scope==com.ibm.widgets.InlineRating._ratingScope_personal_private&&this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_personal_private.toUpperCase())||(args.scope==com.ibm.widgets.InlineRating._ratingScope_personal_public&&this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name)||(args.scope==com.ibm.widgets.InlineRating._ratingScope_personal_public&&this.ratingScope==com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name.toLowerCase())){if(!this._dapRatings){dojo.style(this.sectionBody,"float","left");dojo.attr(this.twistyLink,"title",this.bundle.title_hide_ratings);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyOpen trcFloatLeft");dojo.attr(this.twistyLink,"alt","&#x25C4;");this.fetchRatings();}else{dojo.attr(this.twistyLink,"title",this.bundle.title_view_ratings);dojo.attr(this.twistyLink,"class","lotusSprite lotusArrow lotusTwistyClosed");dojo.attr(this.twistyLink,"alt","&#x25bc;");var _2a68=this._dapRatingWidget.domNode;this._dapRatingWidget.destroy();dojo.destroy(_2a68);this._dapRatingWidget=null;dojo.destroy(this._dapRatings);this._dapRatings=null;dojo.destroy(this._dapOpenWidgetLink);this._dapOpenWidgetLink=null;if(this._myChart){this._myChart.destroy();this._myChart=null;}this.fetchRatings();}}if(this.bIsTracing){this.traceExit(m);}},_checkKeySubmit:function(event){if(this.bIsTracing){var m="_checkKeySubmit(event)";this.traceEntry(m,event);}if(event.keyCode==dojo.keys.ENTER){this.openRatingWidget();}if(this.bIsTracing){this.traceExit(m);}},_initializeParameters:function(){if(this.bIsTracing){var m="_initializeParameters()";this.traceEntry(m);this.trace(m,"this.params",this.params);}if(!("resolver" in this.params)){this.ratingStore=ibmPortalConfig.resolver;}if(!("numStars" in this.params)){if(ibmPortalCPConfig.rating.inline.numStars!=null){this.numStars=ibmPortalCPConfig.rating.inline.numStars;}else{this.numStars=com.ibm.widgets.InlineRating._numStars;}}if(!("showDialogLauncher" in this.params)){if(ibmPortalCPConfig.rating.inline.showDialogLauncher!=null){this.showDialogLauncher=ibmPortalCPConfig.rating.inline.showDialogLauncher;}else{this.showDialogLauncher=com.ibm.widgets.InlineRating._showDialogLauncher;}}if(!("onStarHoverShowRatingDistribution" in this.params)){if(ibmPortalCPConfig.rating.inline.onStarHoverShowRatingDistribution!=null){this.onStarHoverShowRatingDistribution=ibmPortalCPConfig.rating.inline.onStarHoverShowRatingDistribution;}else{this.onStarHoverShowRatingDistribution=com.ibm.widgets.InlineRating._onStarHoverShowRatingDistribution;}}if(!("onStarClickOpenDialog" in this.params)){if(ibmPortalCPConfig.rating.inline.onStarClickOpenDialog!=null){this.onStarClickOpenDialog=ibmPortalCPConfig.rating.inline.onStarClickOpenDialog;}else{this.onStarClickOpenDialog=com.ibm.widgets.InlineRating._onStarClickOpenDialog;}}if(!("ratingScope" in this.params)){if(ibmPortalCPConfig.rating.inline.ratingScope!=null){this.ratingScope=ibmPortalCPConfig.rating.inline.ratingScope;}else{this.ratingScope=com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public;}}if(!("displayTwisty" in this.params)){if(ibmPortalCPConfig.rating.inline.displayTwisty!=null){this.displayTwisty=ibmPortalCPConfig.rating.inline.displayTwisty;}else{this.displayTwisty=com.ibm.widgets.InlineRating._displayTwisty;}}if(!("customLabel" in this.params)){if(ibmPortalCPConfig.rating.inline.customLabel!=null){this.customLabel=ibmPortalCPConfig.rating.inline.customLabel;}else{this.customLabel=null;}}if(!("ratingDistributionPosition" in this.params)){if(ibmPortalCPConfig.rating.inline.ratingDistributionPosition!=null){this.ratingDistributionPosition=ibmPortalCPConfig.rating.inline.ratingDistributionPosition.split(/,/);}else{this.ratingDistributionPosition=com.ibm.widgets.InlineRating._ratingDistributionPosition;}}if(!("ratingsChangedEvent" in this.params)){if(ibmPortalCPConfig.rating.inline.ratingsChangedEvent!=null){this.ratingsChangedEvent=ibmPortalCPConfig.rating.inline.ratingsChangedEvent;}else{this.ratingsChangedEvent=com.ibm.widgets.InlineRating._ratingsChangedEvent;}}if(this.bIsTracing){this.traceExit(m);}}});com.ibm.widgets.InlineRating._viewPrivate="PRIVATE";com.ibm.widgets.InlineRating._viewPublic="PUBLIC";com.ibm.widgets.InlineRating._valueAttribute="title";com.ibm.widgets.InlineRating._countAttribute="count";com.ibm.widgets.InlineRating._resourceModelSchema="rm:";com.ibm.widgets.InlineRating._portletModelSchema="pm:oid:";com.ibm.widgets.InlineRating._navigationModelSchema="nm:oid:";com.ibm.widgets.InlineRating._cpUserModelSchema="cpum:oid:";com.ibm.widgets.InlineRating._ratingSpaceEmptyURI="rtm:rs:empty";com.ibm.widgets.InlineRating._ratingScope_personal_private="personal_private";com.ibm.widgets.InlineRating._ratingScope_personal_public="personal_public";com.ibm.widgets.InlineRating._ratingScope_community="community";com.ibm.widgets.InlineRating._ratingScope_personal="personal";com.ibm.widgets.InlineRating._ratingScope_all="all";com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public=["personal_public","community"];com.ibm.widgets.InlineRating._ratingScope_community_plus_personal_public_name="COMMUNITY_PERSONAL_PUBLIC";com.ibm.widgets.InlineRating._displayTwisty_collapsed="collapsed";com.ibm.widgets.InlineRating._displayTwisty_hidden="hidden";com.ibm.widgets.InlineRating._displayTwisty_expanded="expanded";com.ibm.widgets.InlineRating.inlineRatingWidgetID="_inlineRatingWidgetID";com.ibm.widgets.InlineRating._numStars=5;com.ibm.widgets.InlineRating._showDialogLauncher=true;com.ibm.widgets.InlineRating._onStarHoverShowRatingDistribution=true;com.ibm.widgets.InlineRating._onStarClickOpenDialog=true;com.ibm.widgets.InlineRating._displayTwisty="collapsed";com.ibm.widgets.InlineRating._ratingDistributionPosition=[30,30];com.ibm.widgets.InlineRating._ratingsChangedEvent="ratingsChanged";}if(!dojo._hasResource["dijit.form.FilteringSelect"]){dojo._hasResource["dijit.form.FilteringSelect"]=true;dojo.provide("dijit.form.FilteringSelect");dojo.declare("dijit.form.FilteringSelect",[dijit.form.MappedTextBox,dijit.form.ComboBoxMixin],{_isvalid:true,required:true,_lastDisplayedValue:"",isValid:function(){return this._isvalid||(!this.required&&this.attr("displayedValue")=="");},_callbackSetLabel:function(_2a69,_2a6a,_2a6b){if((_2a6a&&_2a6a.query[this.searchAttr]!=this._lastQuery)||(!_2a6a&&_2a69.length&&this.store.getIdentity(_2a69[0])!=this._lastQuery)){return;}if(!_2a69.length){this.valueNode.value="";dijit.form.TextBox.superclass._setValueAttr.call(this,"",_2a6b||(_2a6b===undefined&&!this._focused));this._isvalid=false;this.validate(this._focused);this.item=null;}else{this.attr("item",_2a69[0],_2a6b);}},_openResultList:function(_2a6c,_2a6d){if(_2a6d.query[this.searchAttr]!=this._lastQuery){return;}this._isvalid=_2a6c.length!=0;this.validate(true);dijit.form.ComboBoxMixin.prototype._openResultList.apply(this,arguments);},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(value,_2a6e){if(!this._onChangeActive){_2a6e=null;}this._lastQuery=value;if(value===null||value===""){this._setDisplayedValueAttr("",_2a6e);return;}var self=this;this.store.fetchItemByIdentity({identity:value,onItem:function(item){self._callbackSetLabel([item],undefined,_2a6e);}});},_setItemAttr:function(item,_2a6f,_2a70){this._isvalid=true;this.inherited(arguments);this.valueNode.value=this.value;this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(label,_2a71){if(!this._created){_2a71=false;}if(this.store){this._hideResultList();var query=dojo.clone(this.query);this._lastQuery=query[this.searchAttr]=this._getDisplayQueryString(label);this.textbox.value=label;this._lastDisplayedValue=label;var _2a72=this;var fetch={query:query,queryOptions:{ignoreCase:this.ignoreCase,deep:true},onComplete:function(_2a73,_2a74){_2a72._fetchHandle=null;dojo.hitch(_2a72,"_callbackSetLabel")(_2a73,_2a74,_2a71);},onError:function(_2a75){_2a72._fetchHandle=null;console.error("dijit.form.FilteringSelect: "+_2a75);dojo.hitch(_2a72,"_callbackSetLabel")([],undefined,false);}};dojo.mixin(fetch,this.fetchProperties);this._fetchHandle=this.store.fetch(fetch);}},postMixInProperties:function(){this.inherited(arguments);this._isvalid=!this.required;},undo:function(){this.attr("displayedValue",this._lastDisplayedValue);}});}if(!dojo._hasResource["com.ibm.widgets.ReadOnlyComboBox"]){dojo._hasResource["com.ibm.widgets.ReadOnlyComboBox"]=true;dojo.provide("com.ibm.widgets.ReadOnlyComboBox");dojo.declare("com.ibm.widgets.ReadOnlyComboBox",[dijit._Widget,dijit._Templated,dijit.form.ComboBox,com.ibm.widgets._Traceable],{bIsTracing:false,constructor:function(){this.inherited("constructor","com.ibm.widgets.ReadOnlyComboBox");this.bIsTracing=this.isTracing();this.autoComplete=false;},postMixInProperties:function(){this.inherited("postMixInProperties",arguments);},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}this.inherited("postCreate",arguments);dojo.connect(this.textbox,"onkeydown",dojo.hitch(this,"onKeydownEvent"));dojo.connect(this.textbox,"onmousedown",dojo.hitch(this,"onMousedownEvent"));if(this.bIsTracing){this.traceExit(m);}},uninitialize:function(){this.inherited("uninitialize",arguments);},setStore:function(_2a76){if(this.bIsTracing){var m="setStore(aStore)";this.traceEntry(m,_2a76);}this.store=_2a76;var _2a77=function(items,_2a78){if(items.length>0){this.textbox.value=this.store.getValue(items[0],"name","");}};this.store.fetch({onComplete:dojo.hitch(this,_2a77)});if(this.bIsTracing){this.traceExit(m);}},_startSearchFromInput:function(){return;},onMousedownEvent:function(evnt){if(this.bIsTracing){var m="onMousedownEvent(evnt)";this.traceEntry(m,evnt);}this._startSearch("");dojo.stopEvent(evnt);if(this.bIsTracing){this.traceExit(m);}},onKeydownEvent:function(evnt){if(this.bIsTracing){var m="onKeydownEvent(evnt)";this.traceEntry(m,evnt);}var key=evnt.keyCode;var keys=dojo.keys;if(this.bIsTracing){this.trace(m,"key",key);this.trace(m,"keys",keys);this.trace(m,"keys.DOWN_ARROW",keys.DOWN_ARROW);}switch(key){case keys.DOWN_ARROW:case keys.END:case keys.HOME:case keys.LEFT_ARROW:case keys.LEFT_WINDOW:case keys.PAGE_DOWN:case keys.PAGE_UP:case keys.RIGHT_ARROW:case keys.RIGHT_WINDOW:case keys.TAB:case keys.UP_ARROW:break;default:dojo.stopEvent(evnt);break;}if(this.bIsTracing){this.traceExit(m);}}});}if(!dojo._hasResource["com.ibm.widgets.TagCloud"]){dojo._hasResource["com.ibm.widgets.TagCloud"]=true;dojo.provide("com.ibm.widgets.TagCloud");dojo.declare("com.ibm.widgets.TagCloud",[dijit._Widget,dijit._Templated,com.ibm.widgets._Traceable],{bIsTracing:false,blankImgUrl:dojo.moduleUrl("dojo","resources/blank.gif").toString(),_isFullyInitialized:false,baseURL:".",bundle:null,bundlePageCreator:null,isRTL:false,widgetParent:null,widgetsInTemplate:true,_dapTagsList:null,_dapTagNames:{},_dapSelectedScopes:{},_dapPagingHeaderContainerDiv:null,_dapPagingFooterContainerDiv:null,_dapJumpToPageInput:null,_dapSelectedScopesNode:null,selectableCategories:null,selectableTypeSchemas:null,preselectedCategories:null,preselectedTypeSchemas:null,hiddenCategories:null,hiddenTypeSchemas:null,isDecodeCategories:true,isDecodeTypeSchemas:true,preselectedTagNamesAll:null,preselectedTagNamesCommunity:null,preselectedTagNamesPersonalPublic:null,preselectedTagNamesLatest:null,preselectedTagNamesPersonalPrivate:null,fetchRelatedTagsMode:false,_defaultPagingPage:-1,paging_currentPage:1,paging_totalResults:30,paging_resultsPerPage:10,paging_numPages:1,paging_pageToFetch:1,paging_firstPageLink:"",paging_prevPageLink:"",paging_nextPageLink:"",paging_lastPageLink:"",paging_numResultPages:5,defaultViewMode:"cloud",redirectView:null,_availableCategories:null,_selectedCategories:null,_transmittedCategories:null,_scopeStore:new dojo.data.ItemFileWriteStore({data:{items:[]}}),allowCategoryTransmission:true,showTransmittedCategories:false,_availableTypeSchemaScopes:null,_selectedTypeSchemaScopes:null,_transmittedTypeSchemaScopes:null,allowTypeSchemaScopeTransmission:true,showTransmittedTypeSchemaScopes:false,scopeBy:"category",isScopingEnabled:false,selectableScopesMode:"sel_sc_none",preselectedScopesMode:"presel_sc_none",isScopeSelectorExpanded:true,showScopes:true,showView:true,showDisplay:true,views:[["All","all","hint"],["Community","community","hint"],["Personal","personal","hint"],["Latest","latest","hint"],["Private","private","hint"]],_idxViewAll:0,_idxViewCommunity:1,_idxViewPersonal:2,_idxViewLatest:3,_idxViewPrivate:4,_viewAvailable:[true,true,true,true,true],isAllViewAllowed:true,isCommunityViewAllowed:true,isPersonalViewAllowed:true,isLatestViewAllowed:true,isPrivateViewAllowed:false,_leavingViewMode:"",_viewMode:"",displays:["cloud","list"],_displayNames:["cloud","list"],_displayMode:"",sharedRenderParameterMode:false,_discreteTags:50,minNumTags:1,maxNumTags:50,defaultSliderPosition:-1,_numTagsShown:0,_minTagsShown:1,_maxTagsShown:10,countsEnabled:true,isExtendedCountsDisplay:true,multiselectionEnabled:true,sliderEnabled:true,borderEnabled:false,borderColor:"#aab0bb",tagCountLevel1:1,tagCountLevel2:2,tagCountLevel3:3,tagCountLevel4:4,tagCountCssClasses:["lotusF1","lotusF2","lotusF3","lotusF4","lotusF5"],tagCloudWidth:250,tagCloudHeight:200,namespace:"",userID:"",userName:"",tagStore:null,tagData:null,widgetTitle:"",widgetName:"tagCloud",fetchURI:"",fetchRMParams:null,fetchCPUMParam:"",fetchOrderParam:"",fetchOrderDirection:"asc",templateString:null,templateString:"<div dojoAttachPoint=\"tagCloudContainer\" class=\"lotusui trc trcTagCloud\">\n    <h1 dojoAttachPoint=\"title\" id=\"${namespace}tagCloudTitleDiv\" name=\"${namespace}tagCloudTitleDiv\"></h1>\n    <div dojoAttachPoint=\"viewModeDiv\" id=\"${namespace}viewModeDiv\" name=\"${namespace}viewModeDiv\" style=\"display:none;\">\n    </div>\n    <div class=\"lotusSection lotusFirst\" dojoAttachPoint=\"scopeSelector\" id=\"${namespace}scopeSelector\" name=\"${namespace}scopeSelector\" style=\"display:none\">\n        <h2 class=\"trcSection\"><a dojoAttachPoint=\"scopeTwisty\" id=\"${namespace}scopeTwisty\" name=\"${namespace}scopeTwisty\" class=\"lotusSprite lotusArrow lotusTwistyOpen\" href=\"javascript:void(0);\" title=\"${bundle.title_click_to_collapse}\" tabIndex=\"0\"><span dojoAttachPoint=\"scopeSectionTwisty\" id=\"${namespace}scopeSectionTwisty\" name=\"${namespace}scopeSectionTwisty\" class=\"lotusAltText\">&#x25bc;</span></a><label dojoAttachPoint=\"scopeSectionHeader\" id=\"${namespace}scopeSectionHeader\" name=\"${namespace}scopeSectionHeader\" class=\"lotusLeft\" title=\"${bundle.title_click_to_collapse}\" tabIndex=\"0\" for=\"${namespace}categorySelect\">${bundle.text_select_scope}</label></h2>\n        <div dojoAttachPoint=\"scopeSectionBody\" id=\"${namespace}scopeSectionBody\" name=\"${namespace}scopeSectionBody\" class=\"lotusSectionBody\">\n            <div class=\"lotusChunk\">\n                <div dojoAttachPoint=\"categoryDiv\" id=\"${namespace}categoryDiv\" name=\"${namespace}categoryDiv\" tabIndex=\"0\">\n                    <span dojoAttachPoint=\"categoryCaptionSpan\" id=\"${namespace}categoryCaptionSpan\" name=\"${namespace}categoryCaptionSpan\"></span>\n                    <form dojoAttachPoint=\"categoryForm\" id=\"${namespace}categoryForm\" name=\"${namespace}categoryForm\">\n                        <input type=\"select\" style=\"width: 70%;\" dojoType=\"com.ibm.widgets.ReadOnlyComboBox\" dojoAttachPoint=\"categorySelect\" id=\"${namespace}categorySelect\" name=\"${namespace}categorySelect\" value=\"\" title=\"${bundle.title_scope_selector}\" /><a dojoAttachPoint=\"selectCategoryBtn\" href=\"javascript:void(0);\" class=\"lotusBtnImg lotusAdd trcTopAlign\" title=\"${bundle.title_scope_add_btn}\" role=\"button\" name=\"${namespace}selectCategoryBtn\"><img src=\"${blankImgUrl}\" alt=\"${bundle.title_scope_add_btn}\" aria-label=\"add\"><span class=\"lotusAltText\">+</span></a>\n                    </form>\n                    <span dojoAttachPoint=\"selectedCategoriesCaptionSpan\" id=\"${namespace}selectedCategoriesCaptionSpan\" name=\"${namespace}selectedCategoriesCaptionSpan\"></span>\n                    <div dojoAttachPoint=\"categoryListDiv\" id=\"${namespace}categoryListDiv\" name=\"${namespace}categoryListDiv\" style=\"display: none;\">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div tabIndex=\"0\" dojoType=\"dijit.form.HorizontalSlider\" title=\"${bundle.title_slider}\" class=\"sliderDiv\" id=\"${namespace}cloudSlider\" name=\"${namespace}cloudSlider\" dojoAttachPoint=\"cloudSliderDiv\" minimum=\"${minNumTags}\" maximum=\"${maxNumTags}\" showButtons=\"false\">\n    </div>\n    <div id=\"${namespace}progressDiv\" name=\"${namespace}progressDiv\" dojoAttachPoint=\"progressDiv\">\n        <div class=\"trcLoading\">\n            <span class=\"lotusLoading\"><img width=\"21\" height=\"21\" src=\"${blankImgUrl}\" alt=\"${bundle.title_loading_icon}\"></span>&nbsp;<span>${bundle.text_loading}</span>\n        </div>\n    </div>\n    <div id=\"${namespace}noTagsDiv\" name=\"${namespace}noTagsDiv\" dojoAttachPoint=\"noTagsDiv\" style=\"display:none;\" title=\"${bundle.text_information}\">\n        <div class=\"lotusMessage lotusInfo\" role=\"status\" title=\"${bundle.text_information}\">\n            <img class=\"lotusSprite trcInformationIcon\" src=\"${blankImgUrl}\" width=\"16\" height=\"16\" alt=\"${bundle.text_information}\" title=\"${bundle.text_information}\"/><span class=\"lotusAltText\">${bundle.text_information}:</span>\n            <span title=\"${bundle.text_information}\">${bundle.text_no_tags_found}</span>\n        </div>\n    </div>\n    <div id=\"${namespace}pagingHeaderDiv\" name=\"${namespace}pagingHeaderDiv\" dojoAttachPoint=\"pagingHeader\" style=\"display:none;\" class=\"lotusPaging trcPagingHeaderLine\" role=\"navigation\">\n    </div>\n    <div id=\"${namespace}tagListDiv\" name=\"${namespace}tagListDiv\" dojoAttachPoint=\"tagListContainer\">\n    </div>\n    <div id=\"${namespace}pagingFooterDiv\" name=\"${namespace}pagingFooterDiv\" dojoAttachPoint=\"pagingFooter\" style=\"display:none\" class=\"lotusPaging trcPagingFooterLine\" role=\"navigation\">\n    </div>\n    <div dojoAttachPoint=\"errorDiv\" name=\"${namespace}errorDiv\" id=\"${namespace}errorDiv\" class=\"lotusMessage\" style=\"display:none;\">\n        <img class=\"trcErrorIcon\" dojoAttachPoint=\"errorImg\" id=\"${namespace}errorImg\" name=\"${namespace}errorImg\" src=\"${blankImgUrl}\" width=\"16\" height=\"16\" alt=\"Error\" /><span class=\"lotusAltText\">${bundle.text_error}:</span>\n        <span dojoAttachPoint=\"errorSpan\" id=\"${namespace}errorSpan\" name=\"${namespace}errorSpan\"></span>\n        <div style=\"background-color: white;\" style=\"display:block;\">\n            <span dojoAttachPoint=\"errorDetailsSpan\" id=\"${namespace}errorDetailsSpan\"></span>\n        </div>\n    </div>\n    <div dojoAttachPoint=\"displayModeDiv\" id=\"${namespace}displayModeDiv\" name=\"${namespace}displayModeDiv\" style=\"display:none\">\n    </div>\n    <div dojoAttachPoint=\"hiddenFormDiv\" id=\"${namespace}hiddenFormDiv\" name=\"${namespace}hiddenFormDiv\" style=\"display:none\">\n        <form dojoAttachPoint=\"hiddenForm\" id=\"${namespace}hiddenForm\" name=\"${namespace}hiddenForm\" action=\".\" method=\"GET\">\n        </form>\n    </div>\n</div>\n",selectedTags:null,uriTagCenter:"tm:prp",uriPRP:"tm:prp",serializedSettings:"empty",isPersistClientSideState:true,_isShowPrevLink:false,_isShowNextLink:false,isTagCenterAvailable:false,_sliderPositions:[-2,-2,-2,-2,-2],_listPages:[-1,-1,-1,-1,-1],arrayToString:function(arr){var _2a79="";for(var i=0,l=arr.length;i<l;i++){_2a79+=arr[i];if(i<l-1){_2a79+=", ";}}return _2a79;},initializeTracing:function(){this.bIsTracing=this.isTracing();},initializeNLS:function(){this.bundle=dojo.i18n.getLocalization("com.ibm.widgets","TagCloud");this.bundlePageCreator=dojo.i18n.getLocalization("com.ibm.bundles","PageCreatorDialog");this.views[0][0]=this.bundlePageCreator.all;this.views[0][2]=this.bundlePageCreator.all;this.views[1][0]=this.bundle.text_all_tags;this.views[1][2]=this.bundle.title_alltags;this.views[2][0]=this.bundle.text_my_tags;this.views[2][2]=this.bundle.title_mytags;this.views[3][0]=this.bundle.text_latest_tags;this.views[3][2]=this.bundle.title_latesttags;this.views[4][0]=this.bundle.text_private_tags;this.views[4][2]=this.bundle.title_privatetags;this._displayNames[0]=this.bundle.text_cloud;this._displayNames[1]=this.bundle.text_list;},_saveClientSideState:function(){if(this.bIsTracing){var m="_saveClientSideState()";this.traceEntry(m);}if(this.isPersistClientSideState&&this._isFullyInitialized){if(this._isTracingLow){this.trace(m,"Persisting client side state");}var vm=this._displayMode;var dm=this._viewMode;var _2a7a=dojo.hasClass(this.scopeTwisty,"lotusTwistyOpen");var spos=this._numTagsShown;var lpage=this.paging_currentPage-1;if(this._leavingViewMode===""){this._leavingViewMode=this._viewMode;}if(this._leavingViewMode==this.views[this._idxViewAll][1]){this._sliderPositions[this._idxViewAll]=spos;this._listPages[this._idxViewAll]=lpage;}else{if(this._leavingViewMode==this.views[this._idxViewCommunity][1]){this._sliderPositions[this._idxViewCommunity]=spos;this._listPages[this._idxViewCommunity]=lpage;}else{if(this._leavingViewMode==this.views[this._idxViewLatest][1]){this._sliderPositions[this._idxViewLatest]=spos;this._listPages[this._idxViewLatest]=lpage;}else{if(this._leavingViewMode==this.views[this._idxViewPersonal][1]){this._sliderPositions[this._idxViewPersonal]=spos;this._listPages[this._idxViewPersonal]=lpage;}else{if(this._leavingViewMode==this.views[this._idxViewPrivate][1]){this._sliderPositions[this._idxViewPrivate]=spos;this._listPages[this._idxViewPrivate]=lpage;}}}}}var ntags=0;var _2a7b=0;if(vm=="cloud"){ntags=this._maxTagsShown;}else{_2a7b=this.paging_currentPage-1;}var _2a7c=this._sliderPositions.join("?");var _2a7d=this._listPages.join("?");var cval="spos="+_2a7c+"|"+"ntags="+ntags+"|"+"vm="+vm+"|"+"dm="+dm+"|"+"page="+_2a7b+"|"+"selexp="+_2a7a+"|"+"lpages="+_2a7d;if(this.bIsTracing){this.trace(m,"Storing serialized settings",cval);}this.serializedSettings=cval;}if(this.bIsTracing){this.traceExit(m);}},_parseCookieProperties:function(_2a7e){if(this.bIsTracing){var m="_parseCookieProperties(aProperties)";this.traceEntry(m,_2a7e);}dojo.forEach(_2a7e,dojo.hitch(this,function(val){if(this.bIsTracing){this.trace(m,"Parsing name/value pair",val);}var _2a7f=val.split("=");if(_2a7f.length>0){var _2a80=dojo.string.trim(_2a7f[0]);var _2a81="";if(_2a7f.length>1){_2a81=dojo.string.trim(_2a7f[1]);}if(_2a80=="spos"){if(_2a81!==""){var _2a82=_2a81;this._sliderPositions=_2a82.split("?");}}else{if(_2a80=="lpages"){var _2a83=_2a81;this._listPages=_2a83.split("?");}else{if(_2a80=="ntags"){var i;}else{if(_2a80=="vm"){if(_2a81!==""){this.defaultViewMode=_2a81;if(this.bIsTracing){this.trace(m,"this.defaultViewMode",this.defaultViewMode);}}}else{if(_2a80=="dm"){if(_2a81!==""){this._viewMode=_2a81;if(this.bIsTracing){this.trace(m,"this._viewMode",this._viewMode);}}}else{if(_2a80=="page"){if(_2a81!==""){this._defaultPagingPage=parseInt(_2a81,10);if(this.bIsTracing){this.trace(m,"defaultPagingPage",this._defaultPagingPage);}}}else{if(_2a80=="selexp"){if(_2a81!==""){this.isScopeSelectorExpanded=(_2a81=="true");if(this.bIsTracing){this.trace(m,"this.isScopeSelectorExpanded",this.isScopeSelectorExpanded);}}}}}}}}}}}));var _2a84=-2;var _2a85=-1;if(this._isViewModeAll()){_2a84=this._sliderPositions[this._idxViewAll];_2a85=this._listPages[this._idxViewAll];}else{if(this._isViewModeCommunity()){_2a84=this._sliderPositions[this._idxViewCommunity];_2a85=this._listPages[this._idxViewCommunity];}else{if(this._isViewModeLatest()){_2a84=this._sliderPositions[this._idxViewLatest];_2a85=this._listPages[this._idxViewLatest];}else{if(this._isViewModePersonal()){_2a84=this._sliderPositions[this._idxViewPersonal];_2a85=this._listPages[this._idxViewPersonal];}else{if(this._isViewModePrivate()){_2a84=this._sliderPositions[this._idxViewPrivate];_2a85=this._listPages[this._idxViewPrivate];}}}}}if(_2a84!=-2){this.defaultSliderPosition=_2a84;}this._defaultPagingPage=parseInt(_2a85,10);if(this.bIsTracing){this.trace(m,"this.defaultSliderPosition",this.defaultSliderPosition);this.traceExit(m);}},_loadClientSideState:function(){if(this.bIsTracing){var m="_loadClientSideState()";this.traceEntry(m);}if(this.isPersistClientSideState){if(this.serializedSettings!=com.ibm.widgets.TagCloud._EMPTY_TAG_CLOUD_SETTINGS){if(this.bIsTracing){this.trace(m,"Deserializing settings",this.serializedSettings);}var props=this.serializedSettings.split("|");this._parseCookieProperties(props);}}if(this.bIsTracing){this.traceExit(m);}},clearClientSideState:function(){this._deleteTagCloudCookie();},constructor:function(){this.inherited("constructor","com.ibm.widgets.TagCloud");_isFullyInitialized=false;this.initializeTracing();this._viewMode=this.views[0][1];this._displayMode=this.displays[0];this.initializeNLS();this._initializeInternalVariables();},_initializeInternalVariables:function(){this.selectableCategories=[];this.selectableTypeSchemas=[];this.preselectedCategories=[];this.preselectedTypeSchemas=[];this.hiddenCategories=[];this.hiddenTypeSchemas=[];this._availableCategories=[];this._selectedCategories=[];this._transmittedCategories=[];this.preselectedTagNamesCommunity=[];this.preselectedTagNamesPersonalPublic=[];this.preselectedTagNamesLatest=[];this.preselectedTagNamesPersonalPrivate=[];this._availableTypeSchemaScopes=[];this._selectedTypeSchemaScopes=[];this._transmittedTypeSchemaScopes=[];this.selectedTags=[];this.fetchRMParams=[];},postMixInProperties:function(){if(this.bIsTracing){var m="postMixInProperties()";this.traceEntry(m);}this._discreteTags=this.maxNumTags-this.minNumTags+1;if(this._discreteTags<1){this._discreteTags=1;}if(this.bIsTracing){this.trace(m,"Slider _discreteTags",this._discreteTags);this.traceExit(m);}},setupTitles:function(){dojo.attr(this.tagCloudContainer,"title",this.titleHint);},postCreate:function(){if(this.bIsTracing){var m="postCreate()";this.traceEntry(m);}if(this.widgetTitle===""){this.titleHint=this.bundle.text_tags;}else{this.titleHint=this.widgetTitle;}dojo.attr(this.title,"innerHTML",this.titleHint);dojo.attr(this.title,"title",this.titleHint);dojo.attr(this.categorySelect.focusNode,"title",this.bundle.title_scope_selector);if(this.isRTL&&this.bIsTracing){this.trace(m,"TagCloud is operating in RTL mode.");}else{this.trace(m,"TagCloud is operating in LTR (default) mode.");}this._loadClientSideState();if(this.borderEnabled){dojo.style(this.tagCloudContainer,"border","1px solid "+this.borderColor);}if(this.bIsTracing){this.trace(m,"DefaultViewMode",this.defaultViewMode);}if(this.defaultViewMode=="cloud"){this._displayMode=this.displays[0];}else{this._displayMode=this.displays[1];this._numTagsShown=this.defaultSliderPosition;}this.setupTitles();this.determineCurrentUser();this.initializeScoping();this.initializeTagCountSlider();this.initializeDisplayModes();this.initializeViewModes();this.initializeHiddenForm();this.initializeSelectedTags();dojo.attr(this.scopeSectionHeader,"innerHTML",this.bundle.text_select_scope);this.setFetchQueryParameters(this._viewMode);this.setFetchRMParameters();this.setDisplayMode(this._displayMode,true);this._isFullyInitialized=true;this.initializeTopicPublishAndSubscription();if(this.bIsTracing){this.traceExit(m);}},determineWeightClass:function(_2a86){if(this.bIsTracing){var m="determineWeightClass(tagCount)";this.traceEntry(m,[_2a86]);}if(_2a86>=this.tagCountLevel4){weightClass=this.tagCountCssClasses[4];}else{if(_2a86>=this.tagCountLevel3){weightClass=this.tagCountCssClasses[3];}else{if(_2a86>=this.tagCountLevel2){weightClass=this.tagCountCssClasses[2];}else{if(_2a86>=this.tagCountLevel1){weightClass=this.tagCountCssClasses[1];}else{weightClass=this.tagCountCssClasses[0];}}}}if(this.bIsTracing){this.traceExit(m,weightClass);}return weightClass;},_buildTagNamesList:function(){if(this.bIsTracing){var m="_buildTagNamesList()";this.traceEntry(m);}var _2a87="tm:name:";var _2a88=[];for(var w=0,l=this.selectedTags.length;w<l;w++){_2a88.push(_2a87+this.selectedTags[w].name);}if(this.bIsTracing){this.traceExit(m,_2a88);}return _2a88;},fetchTags:function(){if(this.bIsTracing){var m="fetchTags()";this.traceEntry(m);}var _2a89=null;var _2a8a=[];this.clearTags();var _2a8b=this.widgetName;var _2a8c=0;var _2a8d=this.maxNumTags;if(this._isDisplayModeList()){if(this._defaultPagingPage!=-1){this.paging_pageToFetch=this._defaultPagingPage+1;this._defaultPagingPage=-1;}_2a8c=(this.paging_pageToFetch-1)*this.paging_resultsPerPage;_2a8d=this.paging_resultsPerPage;}else{_2a8c=0;_2a8d=this.maxNumTags;}if(this.bIsTracing){this.trace(m,"uri             ",this.fetchURI);this.trace(m,"orderMetric     ",this.fetchOrderParam);this.trace(m,"order           ",this.fetchOrderDirection);this.trace(m,"start-index     ",_2a8c);this.trace(m,"max-results     ",_2a8d);}_2a89={uri:this.fetchURI,orderMetric:this.fetchOrderParam,order:this.fetchOrderDirection,"start-index":_2a8c,"max-results":_2a8d};if((this._isDisplayModeCloud())&&(!this._isViewModeLatest())){_2a89.rsOrderMetric="name";_2a89.rsOrder="asc";if(this.bIsTracing){this.trace(m,"rsOrderMetric   ","name");this.trace(m,"rsOrder         ","asc");}}if(this._isViewModeAll()){_2a89.scope=com.ibm.widgets.TagCloud._allScope;}else{if(this._isViewModeCommunity()){_2a89.scope=com.ibm.widgets.TagCloud._communityScope;}else{if(this._isViewModeLatest()){_2a89.scope=com.ibm.widgets.TagCloud._allScope;}else{if(this._isViewModePrivate()){_2a89.scope=com.ibm.widgets.TagCloud._privateScope;}else{if(this._isViewModePersonal()){_2a89.scope=com.ibm.widgets.TagCloud._personalScope;}else{_2a89.scope=com.ibm.widgets.TagCloud._allScope;}}}}}if(this.bIsTracing){this.trace(m,"scope       ",_2a89.scope);}if(this.fetchCPUMParam!==""){_2a89.cpumparam=this.fetchCPUMParam;this.trace(m,"fetchCPUMParam  ",this.fetchCPUMParam);}if((this.fetchRelatedTagsMode)&&(this.selectedTags.length>0)){_2a8a=this._buildTagNamesList();_2a89.tmparam=_2a8a;if(this.bIsTracing){this.trace(m,"tmparam         ",_2a8a);}}else{if(this.fetchRMParams.length>0){_2a89.rmparam=this.fetchRMParams;if(this.bIsTracing){this.trace(m,"rmparam         ",this.fetchRMParams);}}}if(this.bIsTracing){this.trace(m,"Query ",_2a89);}this.tagData=this.tagStore.fetch({query:_2a89,onComplete:dojo.hitch(this,"displayTags"),onError:dojo.hitch(this,"onFetchTagsError"),onBegin:dojo.hitch(this,"onFetchBegin")});if(this.bIsTracing){this.traceExit(m);}},clearTags:function(){if(this.bIsTracing){var m="clearTags()";this.traceEntry(m);this.trace(m,"_dapTagsList ",this._dapTagsList);}if(this._dapTagsList){var _2a8e=this._dapTagsList;if(_2a8e!==null){dojo.destroy(_2a8e);}}if(this._isDisplayModeList()){this._hidePagingHeaderAndFooter();}dojo.style(this.progressDiv,"display","inline");if(this.bIsTracing){this.traceExit(m);}},determineCurrentUser:function(){if(this.bIsTracing){var m="determineCurrentUser()";this.traceEntry(m);this.trace(m,"userID   ",this.userID);this.trace(m,"userName ",this.userName);this.traceExit(m);}},isSliderVisibleInMode:function(dm){if(this.bIsTracing){var m="isSliderVisibleInMode(dm)";this.traceEntry(m,dm);}var _2a8f=false;if(dm==this.displays[0]){_2a8f=true;}else{_2a8f=false;}if(this.bIsTracing){this.traceExit(m,_2a8f);}return _2a8f;},_showTagCloudSlider:function(){if(this.bIsTracing){var m="_showTagCloudSlider()";this.traceEntry(m);}dojo.style(this.cloudSliderDiv.domNode,"display","block");if(this.bIsTracing){this.traceExit(m);}},_hideTagCloudSlider:function(){if(this.bIsTracing){var m="_hideTagCloudSlider()";this.traceEntry(m);}dojo.style(this.cloudSliderDiv.domNode,"display","none");if(this.bIsTracing){this.traceExit(m);}},_showNoTagsWarning:function(){if(this.bIsTracing){var m="_showNoTagsWarning()";this.traceEntry(m);}dojo.style(this.noTagsDiv,"display","block");if(this.bIsTracing){this.traceExit(m);}},_hideNoTagsWarning:function(){if(this.bIsTracing){var m="_hideNoTagsWarning()";this.traceEntry(m);}dojo.style(this.noTagsDiv,"display","none");if(this.bIsTracing){this.traceExit(m);}},setDisplayMode:function(dm,force){if(this.bIsTracing){var m="setDisplayMode(dm, force)";this.traceEntry(m,[dm,force]);}if((this._displayMode!=dm)||(force)){if(this.isSliderVisibleInMode(dm)){this._showTagCloudSlider();}else{this._hideTagCloudSlider();}this._displayMode=dm;this.setFetchOrderParameter();this.setFetchQueryParameters(this._viewMode);this.fetchTags();this.initializeDisplayModes();}if(this.bIsTracing){this.traceExit(m);}},_isDisplayModeCloud:function(){return (this._displayMode==this.displays[0]);},_isDisplayModeList:function(){if(this._displayMode==this.displays[1]){return true;}else{return false;}},_isViewModeAll:function(){if(this._viewMode==this.views[0][1]){return true;}else{return false;}},_isViewModeCommunity:function(){if(this._viewMode==this.views[1][1]){return true;}else{return false;}},_isViewModePersonal:function(){if(this._viewMode==this.views[2][1]){return true;}else{return false;}},_isViewModeLatest:function(){if(this._viewMode==this.views[3][1]){return true;}else{return false;}},_isViewModePrivate:function(){if(this._viewMode==this.views[4][1]){return true;}else{return false;}},setFetchOrderParameter:function(){if(this.bIsTracing){var m="setFetchOrderParameter()";this.traceEntry(m);}if(this._isDisplayModeCloud()){if(this.bIsTracing){this.trace(m,"Cloud View");}if(this._viewMode==this.views[3][1]){if(this.bIsTracing){this.trace(m,"Cloud View : Latest Tags");}this.fetchOrderParam="TAG_SPACE_LAST_MODIFIED_DATE";this.fetchOrderDirection="desc";}else{if(this.bIsTracing){this.trace(m,"Cloud View : Others");}this.fetchOrderParam="TAG_SPACE_COUNT";this.fetchOrderDirection="desc";}}else{if(this.bIsTracing){this.trace(m,"List View");}if(this._viewMode==this.views[3][1]){if(this.bIsTracing){this.trace(m,"List View : Latest Tags");}this.fetchOrderParam="TAG_SPACE_LAST_MODIFIED_DATE";this.fetchOrderDirection="desc";}else{if(this.bIsTracing){this.trace(m,"List View : Others");}this.fetchOrderParam="TAG_SPACE_COUNT_REVERSE_NAME";this.fetchOrderDirection="desc";}}if(this.bIsTracing){this.trace(m,"fetchOrderParam     ",this.fetchOrderParam);this.trace(m,"fetchOrderDirection ",this.fetchOrderDirection);this.traceExit(m);}},setFetchQueryParameters:function(vm){if(this.bIsTracing){var m="setFetchQueryParameters(vm)";this.traceEntry(m,[vm]);}if((this.userID==="")||((vm==this.views[0][1])||(vm==this.views[1][1])||(vm==this.views[3][1]))){if(this.bIsTracing){this.trace(m,"UserID empty, or 'All' or 'Community' or 'Latest' View selected");}var _2a90=[];var _2a91=[];if(this.scopeBy=="category"){if(this.bIsTracing){this.trace(m,"Scoping by categories");}_2a90=this._selectedCategories;_2a91=this._transmittedCategories;}else{if(this.bIsTracing){this.trace(m,"Scoping by type schemas");}_2a90=this._selectedTypeSchemaScopes;_2a91=this._transmittedTypeSchemaScopes;}if((this.fetchRelatedTagsMode)&&(this.selectedTags.length>0)){if(this.bIsTracing){this.trace(m,"Fetching related tags");}this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceRelatedURI;}else{if((_2a90.length<=0)&&(_2a91.length<=0)){this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceAllURI;}else{this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceEmptyURI;}}this.fetchCPUMParam="";}else{if(this.bIsTracing){this.trace(m,"User present and 'Personal' or 'Private' View selected");}if((this.fetchRelatedTagsMode)&&(this.selectedTags.length>0)){this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceRelatedURI;}else{this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceEmptyURI;}this.fetchCPUMParam=com.ibm.widgets.TagCloud._cpUserModelSchema+this.userID;}if(this.bIsTracing){this.trace(m,"fetchCPUMParam ",this.fetchCPUMParam);this.trace(m,"fetchURI       ",this.fetchURI);this.traceExit(m);}},_arrayContains:function(arr,elem){for(var i in arr){if(arr[i]===elem){return true;}}return false;},setFetchRMParameters:function(){if(this.bIsTracing){var m="setFetchRMParameters()";this.traceEntry(m);}this.fetchRMParams=[];var _2a92=[];var _2a93=[];var _2a94=[];var _2a95="";if(this.scopeBy=="category"){if(this.bIsTracing){this.trace(m,"Scoping by categories");}_2a94=this._selectedCategories;_2a93=this._transmittedCategories;_2a95="rm:category:";}else{if(this.bIsTracing){this.trace(m,"Scoping by type schemas");}_2a94=this._selectedTypeSchemaScopes;_2a93=this._transmittedTypeSchemaScopes;_2a95="rm:type:";}for(var i=0,l=_2a94.length;i<l;i++){if(!this._arrayContains(_2a92,_2a94[i])){this.fetchRMParams.push(_2a95+_2a94[i]);this.trace(m,"Adding scope ",_2a94[i]);_2a92.push(_2a94[i]);}}for(var j=0,k=_2a93.length;j<k;j++){if(!this._arrayContains(_2a92,_2a93[j])){this.fetchRMParams.push(_2a95+_2a93[j]);this.trace(m,"Adding transmitted scope ",_2a93[j]);_2a92.push(_2a93[j]);}}if((this.fetchURI==com.ibm.widgets.TagCloud._tagSpaceAllURI)&&(_2a92.length>0)){this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceEmptyURI;}else{if((this.fetchURI==com.ibm.widgets.TagCloud._tagSpaceEmptyURI)&&(_2a92.length<=0)){this.fetchURI=com.ibm.widgets.TagCloud._tagSpaceAllURI;}}if(this.bIsTracing){this.trace(m,"fetchRMParams ",this.arrayToString(this.fetchRMParams));this.trace(m,"fetchURI      ",this.fetchURI);this.traceExit(m);}},setViewMode:function(vm,force){if(this.bIsTracing){var m="setViewMode(vm, force)";this.traceEntry(m,[vm,force]);this.trace(m,"ViewMode Name       ",vm[0]);this.trace(m,"ViewMode Identifier ",vm[1]);}this._leavingViewMode=this._viewMode;this._viewMode=vm[1];this._buildAndSubmitHiddenForm(null,true);if(this.bIsTracing){this.traceExit(m);}},_buildAndSubmitHiddenForm:function(_2a96,_2a97){if(this.bIsTracing){var m="_buildAndSubmitHiddenForm(tagName, noRedirect)";this.traceEntry(m,[_2a96,_2a97]);}this.buildQNameFormFieldsForSelectedTags(_2a96);if(_2a97==true){if(this.bIsTracing){this.trace(m,"Setting the uri to "+this.uriPRP+" as no redirect to the TagCenter is required for changing the mode only");}dojo.byId(this.namespace+"uri").value=this.uriPRP;}this.hiddenForm.submit();if(this.bIsTracing){this.traceExit(m);}},_isSelectedTagNode:function(node){for(var i=0,l=this.selectedTags.length;i<l;i++){if(this.selectedTags[i].node==node){return true;}}return false;},_isSelectedTagName:function(_2a98){for(var i=0,l=this.selectedTags.length;i<l;i++){if(this.selectedTags[i].name==_2a98){return true;}}return false;},_checkAddSelectedTagNode:function(aNode,_2a99){if(this.bIsTracing){var m="_checkAddSelectedTagNode(aNode, tagName)";this.traceEntry(m,[aNode,_2a99]);}var _2a9a=false;if(!this._isSelectedTagNode(aNode)){if(this.bIsTracing){this.trace(m,"Node not selected yet. Adding it to the list of selected nodes.");}_2a9a=true;}if(this.bIsTracing){this.traceExit(m,_2a9a);}return _2a9a;},_removeSelectedTagNode:function(aNode,_2a9b){if(this.bIsTracing){var m="_removeSelectedTagNode(aNode, tagName)";this.traceEntry(m,[aNode,_2a9b]);}var i=0;for(i=0,l=this.selectedTags.length;i<l;i++){if(this.selectedTags[i].node==aNode){if(this.bIsTracing){this.trace(m,"Found node. Removing it from the list of selected nodes.");}this.selectedTags.splice(i,1);break;}}if(this._viewMode==this.views[0][1]){var _2a9c=this.preselectedTagNamesAll;}else{if(this._viewMode==this.views[1][1]){var _2a9c=this.preselectedTagNamesCommunity;}else{if(this._viewMode==this.views[2][1]){var _2a9c=this.preselectedTagNamesPersonalPublic;}else{if(this._viewMode==this.views[3][1]){var _2a9c=this.preselectedTagNamesLatest;}else{if(this._viewMode==this.views[4][1]){var _2a9c=this.preselectedTagNamesPersonalPrivate;}}}}}for(i=0,k=_2a9c.length;i<k;i++){if(_2a9c[i]==_2a9b){if(this.bIsTracing){this.trace(m,"Found tag. Removing it from the list of selected nodes.");}_2a9c.splice(i,1);break;}}if(this.bIsTracing){this.traceExit(m);}},_visuallySelectTagNode:function(aNode,_2a9d){if(this.bIsTracing){var m="_visuallySelectTagNode(aNode, anchor)";this.traceEntry(m,[aNode,_2a9d]);}dojo.addClass(aNode,"lotusSelected");dijit.setWaiState(_2a9d,"selected","true");if(this.bIsTracing){this.traceExit(m);}},_visuallyDeselectTagNode:function(aNode,_2a9e){if(this.bIsTracing){var m="_visuallyDeselectTagNode(aNode, anchor)";this.traceEntry(m,[aNode,_2a9e]);}dojo.removeClass(aNode,"lotusSelected");dijit.removeWaiState(_2a9e,"selected");if(this.bIsTracing){this.traceExit(m);}},_deselectAllTagNodes:function(){if(this.bIsTracing){var m="_deselectAllTagNodes()";this.traceEntry(m);}for(var i=0,l=this.selectedTags.length;i<l;i++){this._visuallyDeselectTagNode(this.selectedTags[i].node);}this.selectedTags=[];if(this.bIsTracing){this.traceExit(m);}},onExpandCollapseCategorySection:function(){if(this.bIsTracing){var m="onExpandCollapseCategorySection()";this.traceEntry(m);}var _2a9f=dojo.hasClass(this.scopeTwisty,"lotusTwistyOpen");if(this.bIsTracing){this.trace(m,"isSectionOpen ",_2a9f);}if(_2a9f){dojo.removeClass(this.scopeTwisty,"lotusTwistyOpen");dojo.addClass(this.scopeTwisty,"lotusTwistyClosed");dojo.style(this.scopeSectionBody,"display","none");dojo.attr(this.scopeSectionHeader,"title",this.bundle.title_click_to_expand);dojo.attr(this.scopeSectionTwisty,"title",this.bundle.title_click_to_expand);dojo.attr(this.scopeTwisty,"title",this.bundle.title_click_to_expand);if(this.isRTL){dojo.attr(this.scopeSectionTwisty,"innerHTML","&#x25C4;");}else{dojo.attr(this.scopeSectionTwisty,"innerHTML","&#x25BA;");}}else{dojo.removeClass(this.scopeTwisty,"lotusTwistyClosed");dojo.addClass(this.scopeTwisty,"lotusTwistyOpen");dojo.style(this.scopeSectionBody,"display","block");dojo.attr(this.scopeSectionHeader,"title",this.bundle.title_click_to_collapse);dojo.attr(this.scopeSectionTwisty,"title",this.bundle.title_click_to_collapse);dojo.attr(this.scopeTwisty,"title",this.bundle.title_click_to_collapse);dojo.attr(this.scopeSectionTwisty,"innerHTML","&#x25BC;");}if(this.bIsTracing){this.traceExit(m);}},onToggleTagSelection:function(_2aa0,node,_2aa1){if(this.bIsTracing){var m="onToggleTagSelection(tagName, node, anchor)";this.traceEntry(m,[_2aa0,node,_2aa1]);}if(node!==null){var _2aa2=this._isSelectedTagNode(node);if(_2aa2===true){this._visuallyDeselectTagNode(node,_2aa1);this._removeSelectedTagNode(node,_2aa0);_2aa0=null;}else{if(!this.multiselectionEnabled){this._deselectAllTagNodes();}this._visuallySelectTagNode(node,_2aa1);if(!this._checkAddSelectedTagNode(node,_2aa0)){_2aa0=null;}}this._buildAndSubmitHiddenForm(_2aa0);}if(this.bIsTracing){this.traceExit(m);}},placeTag:function(_2aa3,_2aa4,_2aa5,_2aa6){if(this.bIsTracing){var m="placeTag(tagName, tagCount, tagLink, parentTag)";this.traceEntry(m,[_2aa3,_2aa4,_2aa5,_2aa6]);}var _2aa7=(this._displayMode==this.displays[1]);var _2aa8="";var li=dojo.create("li",{id:this.namespace+_2aa3+"_item",name:this.namespace+_2aa3+"_item",count:_2aa4},_2aa6);this._dapTagNames[_2aa3+"_item"]=li;dojo.place(dojo.doc.createTextNode("\n"),_2aa6,"last");if(_2aa7){_2aa8="lotusLeft lotusPerson";}else{_2aa8=this.determineWeightClass(_2aa4);}if(this.bIsTracing){this.trace(m,"Weight class ",_2aa8);}var _2aa9=dojo.create("a",{href:"javascript:void(0);",id:this.namespace+_2aa3+"_link",name:this.namespace+_2aa3+"_link",title:_2aa3,"class":_2aa8},li);dojo.place(dojo.doc.createTextNode(_2aa3),_2aa9);dojo.connect(_2aa9,"onclick",dojo.hitch(this,"onToggleTagSelection",_2aa3,li,_2aa9));dijit.setWaiRole(_2aa9,"gridcell");if(this._isSelectedTagName(_2aa3)){this._updateSelectedTagNameWithNode(_2aa3,li);this._visuallySelectTagNode(li,_2aa9);}if((this.countsEnabled)&&(_2aa7)){var _2aaa;if(this.isExtendedCountsDisplay){if(_2aa4>1){_2aaa=dojo.string.substitute(this.bundle.text_times,[_2aa4]);}else{_2aaa=dojo.string.substitute(this.bundle.text_time,[_2aa4]);}}else{_2aaa=_2aa4;}var _2aab=dojo.doc.createTextNode("\n"+_2aaa);dojo.attr(li,"title",dojo.string.substitute(this.bundle.title_tagged_times,[_2aa3,_2aa4]));dojo.place(_2aab,li,"last");}if(this.bIsTracing){this.traceExit(m);}},initializeHiddenForm:function(){if(this.bIsTracing){var m="initializeHiddenForm()";this.traceEntry(m);this.trace(m,"QnameAll ",com.ibm.widgets.TagCloud._qnameAll);this.trace(m,"QnameCommunity ",com.ibm.widgets.TagCloud._qnameCommunity);this.trace(m,"QnamePersonalPublic ",com.ibm.widgets.TagCloud._qnamePersonalPublic);this.trace(m,"QnameLatest ",com.ibm.widgets.TagCloud._qnameLatest);this.trace(m,"QnamePersonalPrivate ",com.ibm.widgets.TagCloud._qnamePersonalPrivate);this.trace(m,"QnameSettings ",com.ibm.widgets.TagCloud._qnameSettings);}dojo.attr(this.hiddenForm,"action",this.baseURL);var _2aac;if(this.sharedRenderParameterMode||(!this.isTagCenterAvailable)){if(!this.isTagCenterAvailable){this.trace(m,"Tag Center is not available");}if(this.bIsTracing){this.trace(m,"Using Shared Render Parameter mode");}_2aac=this.uriPRP;}else{if(this.bIsTracing){this.trace(m,"Using redirect to Tag Center mode");}_2aac=this.uriTagCenter;}dojo.create("input",{type:"hidden",name:"uri",id:this.namespace+"uri",value:_2aac},this.hiddenForm);if(this.bIsTracing){this.traceExit(m);}},_updateSelectedTagNameWithNode:function(_2aad,_2aae){if(this.bIsTracing){var m="_updateSelectedTagNameWithNode(tagName, tagNode)";this.traceEntry(m,[_2aad,_2aae]);}for(var i=0,l=this.selectedTags.length;i<l;i++){if(this.selectedTags[i].name==_2aad){if(this.bIsTracing){this.trace(m,"Tag found. Updating with node",_2aae);}this.selectedTags[i].node=_2aae;}}if(this.bIsTracing){this.traceExit(m);}},initializeSelectedTags:function(){if(this.bIsTracing){var m="initializeSelectedTags()";this.traceEntry(m);}this.selectedTags=[];if(this._viewMode==this.views[0][1]){var _2aaf=this.preselectedTagNamesAll;}else{if(this._viewMode==this.views[1][1]){var _2aaf=this.preselectedTagNamesCommunity;}else{if(this._viewMode==this.views[2][1]){var _2aaf=this.preselectedTagNamesPersonalPublic;}else{if(this._viewMode==this.views[3][1]){var _2aaf=this.preselectedTagNamesLatest;}else{if(this._viewMode==this.views[4][1]){var _2aaf=this.preselectedTagNamesPersonalPrivate;}}}}}for(var i=0,l=_2aaf.length;i<l;i++){if(this.bIsTracing){this.trace(m,"Preselected Tag Name ",_2aaf[i]);}this.selectedTags.push({name:_2aaf[i],domNode:null});}if(this.bIsTracing){this.traceExit(m);}},buildQNameFormFieldsForSelectedTags:function(_2ab0){if(this.bIsTracing){var m="buildQNameFormFieldsForSelectedTags(aTagName)";this.traceEntry(m,_2ab0);}var _2ab1;if(this.bIsTracing){this.trace(m,"Number of selected all tags  ",this.preselectedTagNamesAll);this.trace(m,"Number of selected community tags  ",this.preselectedTagNamesCommunity);this.trace(m,"Number of selected personal public tags ",this.preselectedTagNamesPersonalPublic);this.trace(m,"Number of selected latest tags ",this.preselectedTagNamesLatest);this.trace(m,"Number of selected personal private tags ",this.preselectedTagNamesPersonalPrivate);}var i=0;var l=0;var _2ab2;var _2ab3=this.preselectedTagNamesAll;for(i=0,l=_2ab3.length;i<l;i++){_2ab2=_2ab3[i];dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameAll,id:this.namespace+com.ibm.widgets.TagCloud._qnameAll+i,value:_2ab2},this.hiddenForm);}var _2ab3=this.preselectedTagNamesCommunity;for(i=0,l=_2ab3.length;i<l;i++){_2ab2=_2ab3[i];dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameCommunity,id:this.namespace+com.ibm.widgets.TagCloud._qnameCommunity+i,value:_2ab2},this.hiddenForm);}var _2ab3=this.preselectedTagNamesPersonalPublic;for(i=0,l=_2ab3.length;i<l;i++){_2ab2=_2ab3[i];dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnamePersonalPublic,id:this.namespace+com.ibm.widgets.TagCloud._qnamePersonalPublic+i,value:_2ab2},this.hiddenForm);}var _2ab3=this.preselectedTagNamesLatest;for(i=0,l=_2ab3.length;i<l;i++){_2ab2=_2ab3[i];dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameLatest,id:this.namespace+com.ibm.widgets.TagCloud._qnameLatest+i,value:_2ab2},this.hiddenForm);}_2ab3=this.preselectedTagNamesPersonalPrivate;for(i=0,l=_2ab3.length;i<l;i++){_2ab2=_2ab3[i];dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnamePersonalPrivate,id:this.namespace+com.ibm.widgets.TagCloud._qnamePersonalPrivate+i,value:_2ab2},this.hiddenForm);}if(_2ab0==null){if((this._viewMode==this.views[0][1])&&this.preselectedTagNamesAll.length==0){if(this.bIsTracing){this.trace(m,"Clearing all tag selection");}dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameAll,id:this.namespace+com.ibm.widgets.TagCloud._qnameAll+0,value:""},this.hiddenForm);}else{if((this._viewMode==this.views[1][1])&&this.preselectedTagNamesCommunity.length==0){if(this.bIsTracing){this.trace(m,"Clearing community tag selection");}dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameCommunity,id:this.namespace+com.ibm.widgets.TagCloud._qnameCommunity+0,value:""},this.hiddenForm);}else{if((this._viewMode==this.views[2][1])&&this.preselectedTagNamesPersonalPublic.length==0){if(this.bIsTracing){this.trace(m,"Clearing personal public tag selection");}dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnamePersonalPublic,id:this.namespace+com.ibm.widgets.TagCloud._qnamePersonalPublic+0,value:""},this.hiddenForm);}else{if((this._viewMode==this.views[3][1])&&this.preselectedTagNamesLatest.length==0){if(this.bIsTracing){this.trace(m,"Clearing latest tag selection");}dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameLatest,id:this.namespace+com.ibm.widgets.TagCloud._qnameLatest+0,value:""},this.hiddenForm);}else{if((this._viewMode==this.views[4][1])&&this.preselectedTagNamesPersonalPrivate.length==0){if(this.bIsTracing){this.trace(m,"Clearing personal private tag selection");}dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnamePersonalPrivate,id:this.namespace+com.ibm.widgets.TagCloud._qnamePersonalPrivate+0,value:""},this.hiddenForm);}}}}}}else{var qname=null;if(this._viewMode==this.views[0][1]){var qname=com.ibm.widgets.TagCloud._qnameAll;}else{if(this._viewMode==this.views[1][1]){var qname=com.ibm.widgets.TagCloud._qnameCommunity;}else{if(this._viewMode==this.views[2][1]){var qname=com.ibm.widgets.TagCloud._qnamePersonalPublic;}else{if(this._viewMode==this.views[3][1]){var qname=com.ibm.widgets.TagCloud._qnameLatest;}else{if(this._viewMode==this.views[4][1]){var qname=com.ibm.widgets.TagCloud._qnamePersonalPrivate;}}}}}dojo.create("input",{type:"hidden",name:qname,id:this.namespace+qname+(_2ab3.length+1),value:_2ab0},this.hiddenForm);}var _2ab4=this._viewMode;dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameMode,id:this.namespace+com.ibm.widgets.TagCloud._qnameMode,value:_2ab4},this.hiddenForm);this._saveClientSideState();dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameSettings,id:this.namespace+com.ibm.widgets.TagCloud._qnameSettings,value:this.serializedSettings},this.hiddenForm);if(this.scopeBy=="category"){if(this._selectedCategories.length>0){dojo.forEach(this._selectedCategories,function(_2ab5){_2ab1=dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameSelectedCategories,value:_2ab5},this.hiddenForm);},this);}else{_2ab1=dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameSelectedCategories,value:""},this.hiddenForm);}}else{if(this.scopeBy=="typeSchema"){if(this._selectedTypeSchemaScopes.length>0){dojo.forEach(this._selectedTypeSchemaScopes,function(_2ab6){_2ab1=dojo.create("input",{type:"hidden",name:com.ibm.widgets.TagCloud._qnameSelectedSchemas,value:_2ab6},this.hiddenForm);},this);}}}if(this.bIsTracing){this.traceExit(m);}},initializeDisplayModes:function(){if(this.bIsTracing){var m="initializeDisplayModes()";this.traceEntry(m);this.trace(m,"Show display section ",this.showDisplay);}if(this.showDisplay){var _2ab7=this.displayModeDiv;if(_2ab7&&_2ab7.firstChild){dojo.destroy(_2ab7.firstChild);}var ul=dojo.create("ul",{"class":"lotusInlinelist",id:this.namespace+"display_mode_list",name:this.namespace+"display_mode_list"},_2ab7);var _2ab8=dojo.create("li",{innerHTML:this.bundle.text_view_as,title:this.bundle.text_view_as,id:this.namespace+"view_as_node",name:this.namespace+"view_as_node","class":"lotusFirst"},ul);if(this.bIsTracing){this.trace(m,"Number of display modes ",this.displays.length);}for(var i=0,l=this.displays.length;i<l;i++){var dm=this.displays[i];var dName=this._displayNames[i];if(this.bIsTracing){this.trace(m,"DisplayMode initializing ",dm);}var _2ab9=dName;var li=dojo.create("li",{id:this.namespace+"display_node_"+i,name:this.namespace+"display_node_"+i},ul);if(i===0){dojo.addClass(li,"lotusFirst");}var _2aba=this.bundle.title_cloud_view;if(i==1){_2aba=this.bundle.title_list_view;}if(this._displayMode!=dm){var a=dojo.create("a",{innerHTML:_2ab9,title:_2aba,id:this.namespace+dm,name:this.namespace+dm,"class":"lotusAction",href:"javascript:void(0);"},li);dojo.connect(a,"onclick",dojo.hitch(this,"setDisplayMode",dm,false));}else{var span=dojo.create("span",{innerHTML:"<strong>"+_2ab9+"</strong>",title:_2aba,id:this.namespace+dm,name:this.namespace+dm},li);}}dojo.style(this.displayModeDiv,"display","inline");}if(this.bIsTracing){this.traceExit(m);}},initializeViewModes:function(){if(this.bIsTracing){var m="initializeViewModes()";this.traceEntry(m);}if(this.redirectView){for(var k=0,ml=this.views.length;k<ml;k++){if(this.redirectView==this.views[k][1]){this._viewMode=this.views[k][1];}}}this._viewAvailable[this._idxViewAll]=this.isAllViewAllowed;this._viewAvailable[this._idxViewCommunity]=this.isCommunityViewAllowed;this._viewAvailable[this._idxViewPersonal]=this.isPersonalViewAllowed&&(this.userName!=="");this._viewAvailable[this._idxViewLatest]=this.isLatestViewAllowed;this._viewAvailable[this._idxViewPrivate]=this.isPrivateViewAllowed&&(this.userName!=="");var _2abb=false;var runs=0;do{_2abb=false;for(var j=0,ml=this.views.length;j<ml;j++){if((_2abb)&&(this._viewAvailable[j])){this._viewMode=this.views[j][1];if(this.bIsTracing){this.trace(m,"Default view mode is unavailable, changing to ",this._viewMode);}break;}else{if(this._viewMode==this.views[j][1]){if(!this._viewAvailable[j]){_2abb=true;}}}}runs++;}while((_2abb)&&(runs<2));if(this.bIsTracing){this.trace(m,"Show view section ",this.showView);}if(this.showView){var _2abc=this.viewModeDiv;if(_2abc&&_2abc.firstChild){dojo.destroy(_2abc.firstChild);}var ul=dojo.create("ul",{"class":"lotusInlinelist",id:this.namespace+"view_mode_list",name:this.namespace+"view_mode_list"},_2abc);if(this.bIsTracing){this.trace(m,"Number of view modes ",this.views.length);}var _2abd=true;for(var i=0,l=this.views.length;i<l;i++){if(this._viewAvailable[i]){var vm=this.views[i][0];if(this.bIsTracing){this.trace(m,"ViewMode initializing ",vm);}var _2abe=vm;var li=dojo.create("li",{id:this.namespace+"view_node_"+i,name:this.namespace+"view_node_"+i},ul);if(_2abd===true){dojo.addClass(li,"lotusFirst");_2abd=false;}if(this._viewMode!=this.views[i][1]){var a=dojo.create("a",{title:this.views[i][2],id:this.namespace+vm,name:this.namespace+vm,"class":"lotusAction",innerHTML:vm,href:"javascript:void(0);"},li);dojo.connect(a,"onclick",dojo.hitch(this,"setViewMode",this.views[i],false));}else{var span=dojo.create("span",{innerHTML:"<strong>"+vm+"</strong>",title:this.views[i][2],id:this.namespace+vm,name:this.namespace+vm},li);}}}dojo.style(this.viewModeDiv,"display","inline");}if(this.bIsTracing){this.traceExit(m);}},getAvailableScopeIndex:function(_2abf){if(this.bIsTracing){var m="getAvailableScopeIndex(scopeName)";this.traceEntry(m);}var _2ac0=null;if(this.scopeBy=="category"){_2ac0=this._availableCategories;}else{_2ac0=this._availableTypeSchemaScopes;}var _2ac1=-1;for(var i=0,l=_2ac0.length;i<l;i++){if(_2ac0[i]==_2abf){_2ac1=i;break;}}if(this.bIsTracing){this.traceExit(m,_2ac1);}return _2ac1;},_encodePartialHTML:function(_2ac2){if(this.bIsTracing){var m="_encodePartialHTML(htmlFragment)";this.traceEntry(m,[_2ac2]);}var _2ac3=_2ac2;_2ac3=_2ac3.replace(/\u0022/g,"&#34;");_2ac3=_2ac3.replace(/\u0027/g,"&#39;");_2ac3=_2ac3.replace(/\u003c/g,"&#60;");_2ac3=_2ac3.replace(/\u003e/g,"&#62;");if(this.bIsTracing){this.traceExit(m,_2ac3);}return _2ac3;},selectScope:function(_2ac4,_2ac5){if(this.bIsTracing){var m="selectScope(scopeName, reloadTags)";this.traceEntry(m,[_2ac4,_2ac5]);}var _2ac6=null;var _2ac7=null;if(this.scopeBy=="category"){_2ac6=this._availableCategories;_2ac7=this._selectedCategories;}else{_2ac6=this._availableTypeSchemaScopes;_2ac7=this._selectedTypeSchemaScopes;}var _2ac8=false;for(var i=0,l=_2ac6.length;i<l;i++){if(_2ac6[i]==_2ac4){_2ac8=true;break;}}if(_2ac8){var _2ac9=false;for(var j=0,k=_2ac7.length;j<k;j++){if(_2ac7[j]==_2ac4){_2ac9=true;break;}}if(!_2ac9){_2ac7.push(_2ac4);var _2aca=this.getAvailableScopeIndex(_2ac4);var _2acb=this._encodePartialHTML(_2ac6[_2aca]);var ul=this._dapSelectedScopesNode;if(this.bIsTracing){this.trace(m,"Adding selected scope ",_2ac4);}var _2acc;if(this.isRTL){aInnerHTML="<span class=\"lotusClose\">X</span> "+_2acb;}else{aInnerHTML=_2acb+" <span class=\"lotusClose\">X</span>";}var a=dojo.create("a",{"class":"lotusFilter lotusNowrap",id:this.namespace+"scope_"+_2acb,name:this.namespace+"scope_"+_2acb,title:this.bundle.title_remove_scope,href:"javascript:void(0);",innerHTML:aInnerHTML},ul);var _2acd="remove_scope_"+_2acb;dojo.connect(a,"onclick",dojo.hitch(this,"removeSelectedScope",_2aca+","+_2acd,false));this._dapSelectedScopes[_2acd]=a;dojo.place(dojo.doc.createTextNode(" "),ul,"last");this.setFetchRMParameters();if((_2ac5)&&(this._isFullyInitialized)){this.fetchTags();}}else{if(this.bIsTracing){this.trace(m,"Selected scope already selected ",_2ac4);}}}else{if(this.bIsTracing){this.trace(m,"Selected scope not in list of available scopes ",_2ac4);}}if(this.bIsTracing){this.traceExit(m);}},transmitTypeSchema:function(_2ace,_2acf){if(this.bIsTracing){var m="transmitTypeSchema(typeSchemaName, isSelected)";this.traceEntry(m,[_2ace,_2acf]);}var _2ad0=(this.scopeBy=="typeSchema");if(this.allowTypeSchemaScopeTransmission){var _2ad1=false;var _2ad2=null;if((this.showTransmittedTypeSchemaScopes)&&_2ad0){_2ad2=this._availableCategories;}else{_2ad2=this._transmittedCategories;}if(this._arrayContains(_2ad2,_2ace)){_2ad1=true;}if(!_2ad1){if((this.showTransmittedTypeSchemaScopes)&&_2ad0){if(this.bIsTracing){this.trace(m,"Adding type schema to list of available type schemas",_2ace);}this._availableTypeSchemaScopes.push(_2ace);var item=this._scopeStore.newItem({name:_2ace});this._scopeStore.save();this.categorySelect.setStore(this._scopeStore);}else{if(this.bIsTracing){this.trace(m,"Adding type schema to list of transmitted type schemas",_2ace);}this._transmittedTypeSchemaScopes.push(_2ace);}}if((_2acf)&&(this.showTransmittedTypeSchemaScopes)&&_2ad0){this.selectScope(_2ace,true);}}if(this.bIsTracing){this.traceExit(m);}},transmitCategory:function(_2ad3,_2ad4){if(this.bIsTracing){var m="transmitCategory(categoryName, isSelected)";this.traceEntry(m,[_2ad3,_2ad4]);}var _2ad5=(this.scopeBy=="category");if(this.allowCategoryTransmission){var _2ad6=false;var _2ad7=null;if((this.showTransmittedCategories)&&_2ad5){_2ad7=this._availableCategories;}else{_2ad7=this._transmittedCategories;}for(var i=0,l=_2ad7.length;i<l;i++){if(_2ad7[i]==_2ad3){_2ad6=true;break;}}if(!_2ad6){if((this.showTransmittedCategories)&&_2ad5){if(this.bIsTracing){this.trace(m,"Adding category to list of available categories",_2ad3);}this._availableCategories.push(_2ad3);var item=this._scopeStore.newItem({name:_2ad3});this._scopeStore.save();this.categorySelect.setStore(this._scopeStore);}else{if(this.bIsTracing){this.trace(m,"Adding category to list of transmitted categories",_2ad3);}this._transmittedCategories.push(_2ad3);}}if((_2ad4)&&(this.showTransmittedCategories)&&_2ad5){this.selectScope(_2ad3,true);}}if(this.bIsTracing){this.traceExit(m);}},removeSelectedScope:function(_2ad8){if(this.bIsTracing){var m="removeSelectedScope(scopeParams)";this.traceEntry(m,[_2ad8]);}var _2ad9=_2ad8.split(",");var _2ada=[];var _2adb=[];if(this.scopeBy=="category"){_2ada=this._selectedCategories;_2adb=this._availableCategories;}else{_2ada=this._selectedTypeSchemaScopes;_2adb=this._availableTypeSchemaScopes;}var _2adc=_2adb[_2ad9[0]];var _2add=this._dapSelectedScopes[_2ad9[1]];for(var i=0;i<_2ada.length;i++){if(_2ada[i]==_2adc){_2ada.splice(i,1);if(_2add){dojo.destroy(_2add);}break;}}this.setFetchRMParameters();this.fetchTags();if(this.bIsTracing){this.traceExit(m);}},onClickSelectScopeBtn:function(){if(this.bIsTracing){var m="onClickSelectScopeBtn()";this.traceEntry(m);}var _2ade=this.categorySelect.attr("value");this.selectScope(_2ade,true);if(this.bIsTracing){this.traceExit(m);}},initializeScoping:function(){if(this.bIsTracing){var m="initializeScoping()";this.traceEntry(m);}if(this.showScopes&&(((this.scopeBy=="category")&&(this.selectableCategories.length>0))||((this.scopeBy=="typeSchema")&&(this.selectableTypeSchemas.length>0)))){dojo.style(this.scopeSelector,"display","block");}if(this.scopeBy=="category"){this.initializeCategories();}else{this.initializeTypeSchemas();}if(!this.isScopeSelectorExpanded){if(dojo.hasClass(this.scopeTwisty,"lotusTwistyOpen")){this.onExpandCollapseCategorySection();}}if(this.bIsTracing){this.traceExit(m);}},initializeCategories:function(){if(this.bIsTracing){var m="initializeCategories()";this.traceEntry(m);}var _2adf="";var _2ae0="";this._availableCategories=[];for(var k=0,l=this.selectableCategories.length;k<l;k++){_2adf=this.selectableCategories[k];if(this.isDecodeCategories===true){if(this.bIsTracing){this.trace(m,"Decoding and adding category",_2adf);}_2ae0=decodeURIComponent(_2adf);if(this.bIsTracing){this.trace(m,"Decoded category",_2ae0);}if(this._arrayContains(this._availableCategories,_2ae0)){if(this.bIsTracing){this.trace(m,"Duplicate category found",_2ae0);}}else{this._availableCategories.push(_2ae0);}}else{if(this.bIsTracing){this.trace(m,"Adding category as-is",_2adf);}if(this._arrayContains(this._availableCategories,_2adf)){if(this.bIsTracing){this.trace(m,"Duplicate category found",_2adf);}}else{this._availableCategories.push(_2adf);}}}this._transmittedCategories=[];for(var i=0,ml=this.hiddenCategories.length;i<ml;i++){_2adf=this.hiddenCategories[i];if(this.isDecodeCategories===true){if(this.bIsTracing){this.trace(m,"Decoding and adding transmitted category",_2adf);}_2ae0=decodeURIComponent(_2adf);if(this.bIsTracing){this.trace(m,"Decoded category",_2ae0);}if(this._arrayContains(this._transmittedCategories,_2ae0)){if(this.bIsTracing){this.trace(m,"Duplicate category found",_2ae0);}}else{this._transmittedCategories.push(_2ae0);}}else{if(this.bIsTracing){this.trace(m,"Adding transmitted category as-is",_2adf);}if(this._arrayContains(this._transmittedCategories,_2adf)){if(this.bIsTracing){this.trace(m,"Duplicate category found",_2adf);}}else{this._transmittedCategories.push(_2adf);}}}this._scopeStore=new dojo.data.ItemFileWriteStore({data:{identifier:"name",items:[]}});for(i=0,mk=this._availableCategories.length;i<mk;i++){var item=this._scopeStore.newItem({name:this._availableCategories[i]});}this._scopeStore.save();this.categorySelect.setStore(this._scopeStore);if((this.showScopes)&&(this.scopeBy=="category")){this._dapSelectedScopesNode=dojo.create("div",{"class":"lotusFilters",id:this.namespace+"category_list",name:this.namespace+"category_list"},this.categoryListDiv);for(var j=0,n=this.preselectedCategories.length;j<n;j++){var sc="";if(this.isDecodeCategories===true){sc=decodeURIComponent(this.preselectedCategories[j]);}else{sc=this.preselectedCategories[j];}this.selectScope(sc,false);}dojo.style(this.categoryListDiv,"display","block");dojo.connect(this.selectCategoryBtn,"onclick",dojo.hitch(this,"onClickSelectScopeBtn"));dojo.connect(this.scopeTwisty,"onclick",dojo.hitch(this,"onExpandCollapseCategorySection"));dojo.connect(this.scopeSectionHeader,"onclick",dojo.hitch(this,"onExpandCollapseCategorySection"));}else{dojo.style(this.categoryListDiv,"display","none");}this.setFetchRMParameters();if(this.bIsTracing){this.traceExit(m);}},initializeTypeSchemas:function(){if(this.bIsTracing){var m="initializeTypeSchemas()";this.traceEntry(m);}var _2ae1="";var _2ae2="";this._availableTypeSchemaScopes=[];for(var k=0,l=this.selectableTypeSchemas.length;k<l;k++){_2ae1=this.selectableTypeSchemas[k];if(this.isDecodeTypeSchemas===true){if(this.bIsTracing){this.trace(m,"Decoding and adding type schema",_2ae1);}_2ae2=decodeURIComponent(_2ae1);if(this.bIsTracing){this.trace(m,"Decoded type schema",_2ae2);}if(this._arrayContains(this._availableTypeSchemaScopes,_2ae2)){if(this.bIsTracing){this.trace(m,"Duplicate type schema found",_2ae2);}}else{this._availableTypeSchemaScopes.push(_2ae2);}}else{if(this.bIsTracing){this.trace(m,"Adding type schema as-is",_2ae1);}if(this._arrayContains(this._availableTypeSchemaScopes,_2ae1)){if(this.bIsTracing){this.trace(m,"Duplicate type schema found",_2ae1);}}else{this._availableTypeSchemaScopes.push(_2ae1);}}}this._transmittedTypeSchemaScopes=[];for(var i=0,ml=this.hiddenTypeSchemas.length;i<ml;i++){_2ae1=this.hiddenTypeSchemas[i];if(this.isDecodeTypeSchemas===true){if(this.bIsTracing){this.trace(m,"Decoding and adding transmitted type schema",_2ae1);}_2ae2=decodeURIComponent(_2ae1);if(this.bIsTracing){this.trace(m,"Decoded type schema",_2ae2);}if(this._arrayContains(this._transmittedTypeSchemaScopes,_2ae2)){if(this.bIsTracing){this.trace(m,"Duplicate type schema found",_2ae2);}}else{this._transmittedTypeSchemaScopes.push(_2ae2);}}else{if(this.bIsTracing){this.trace(m,"Adding transmitted type schema as-is",_2ae1);}if(this._arrayContains(this._transmittedTypeSchemaScopes,_2ae1)){if(this.bIsTracing){this.trace(m,"Duplicate type schema found",_2ae1);}}else{this._transmittedTypeSchemaScopes.push(_2ae1);}}}this._scopeStore=new dojo.data.ItemFileWriteStore({data:{identifier:"name",items:[]}});for(i=0,mk=this._availableTypeSchemaScopes.length;i<mk;i++){var item=this._scopeStore.newItem({name:this._availableTypeSchemaScopes[i]});}this._scopeStore.save();this.categorySelect.setStore(this._scopeStore);if((this.showScopes)&&(this.scopeBy=="typeSchema")){this._dapSelectedScopesNode=dojo.create("div",{"class":"lotusFilters",id:this.namespace+"typeSchema_list",name:this.namespace+"typeSchema_list"},this.categoryListDiv);for(var j=0,n=this.preselectedTypeSchemas.length;j<n;j++){var sc="";if(this.isDecodeTypeSchemas===true){sc=decodeURIComponent(this.preselectedTypeSchemas[j]);}else{sc=this.preselectedTypeSchemas[j];}this.selectScope(sc,false);}dojo.style(this.categoryListDiv,"display","block");dojo.connect(this.selectCategoryBtn,"onclick",dojo.hitch(this,"onClickSelectScopeBtn"));dojo.connect(this.scopeTwisty,"onclick",dojo.hitch(this,"onExpandCollapseCategorySection"));dojo.connect(this.scopeSectionHeader,"onclick",dojo.hitch(this,"onExpandCollapseCategorySection"));}else{dojo.style(this.categoryListDiv,"display","none");}this.setFetchRMParameters();if(this.bIsTracing){this.traceExit(m);}},_showPagingHeaderAndFooter:function(){if(this.bIsTracing){var m="_showPagingHeaderAndFooter()";this.traceEntry(m);}dojo.style(this.pagingHeader,"display","block");if(_isShowPrevLink||_isShowNextLink){dojo.style(this.pagingFooter,"display","block");}if(this.bIsTracing){this.traceExit(m);}},_hidePagingHeaderAndFooter:function(){if(this.bIsTracing){var m="_hidePagingHeaderAndFooter()";this.traceEntry(m);}dojo.style(this.pagingHeader,"display","none");dojo.style(this.pagingFooter,"display","none");if(this.bIsTracing){this.traceExit(m);}},loadPreviousPage:function(){if(this.bIsTracing){var m="loadPreviousPage()";this.traceEntry(m);}this.paging_pageToFetch=this.paging_currentPage-1;this.fetchTags();if(this.bIsTracing){this.traceExit(m);}},loadNextPage:function(){if(this.bIsTracing){var m="loadNextPage()";this.traceEntry(m);}this.paging_pageToFetch=this.paging_currentPage+1;this.fetchTags();if(this.bIsTracing){this.traceExit(m);}},fetchSpecificPage:function(_2ae3){if(this.bIsTracing){var m="fetchSpecificPage(pageToLoad)";this.traceEntry(m,_2ae3);}this.paging_pageToFetch=_2ae3;this.fetchTags();if(this.bIsTracing){this.traceExit(m);}},initializePagingHeader:function(){if(this.bIsTracing){var m="initializePagingHeader()";this.traceEntry(m);}if(this._dapPagingHeaderContainerDiv){dojo.destroy(this._dapPagingHeaderContainerDiv);}this._dapPagingHeaderContainerDiv=dojo.create("div",{id:this.namespace+"pagingHeaderContainerDiv"},this.pagingHeader);var _2ae4=(((this.paging_currentPage-1)*this.paging_resultsPerPage)+1);var _2ae5=_2ae4+this.paging_resultsPerPage-1;if(_2ae5>this.paging_totalResults){_2ae5=this.paging_totalResults;}var _2ae6=this.bundle.text_page_of_pages;dojo.create("span",{"class":"lotusLeft trcPagingSpan",id:this.namespace+"countSpan",name:this.namespace+"countSpan",title:dojo.string.substitute(this.bundle.title_tagsshown,[_2ae4,_2ae5,this.paging_totalResults]),innerHTML:dojo.string.substitute(_2ae6,[_2ae4,_2ae5,this.paging_totalResults])},this._dapPagingHeaderContainerDiv);var _2ae7=dojo.create("span",{"class":"lotusRight",id:this.namespace+"pagesSpan",name:this.namespace+"pagesSpan"},this._dapPagingHeaderContainerDiv);var _2ae8=dojo.create("span",{id:this.namespace+"pageTitleSpan",name:this.namespace+"pageTitleSpan",title:this.bundle.title_pagepicker},_2ae7);var _2ae9=dojo.create("ul",{"class":"lotusInlinelist",id:this.namespace+"pagesList",name:this.namespace+"pagesList",title:this.bundle.title_pagepicker},_2ae8);var _2aea=Math.ceil(this.paging_totalResults/this.paging_resultsPerPage);var _2aeb=this.paging_numResultPages-2;var _2aec=Math.floor((_2aeb-1)/2);var _2aed=this.paging_currentPage-_2aec;var _2aee=this.paging_currentPage+_2aec;if(_2aed<=1){_2aed=1;_2aee=_2aeb+1;}if(_2aee>=_2aea){_2aee=_2aea;_2aed=_2aea-_2aeb;}var li=null;for(var i=0;i<_2aea;i++){if((i===0)||(i>=(_2aea-1))||((i>=(_2aed-2))&&(i<=(_2aee)))){var _2aef=(((i==_2aed-2)||(i==_2aee))&&(i!==0)&&(i!=_2aea-1));li=dojo.create("li",{"class":"trcPagingLine",id:this.namespace+"page_item_"+i,name:this.namespace+"page_item_"+i},_2ae9);if(i===0){dojo.addClass(li,"lotusFirst");}if(i!=this.paging_currentPage-1){if(_2aef){dojo.attr(li,"innerHTML",this.bundle.text_ellipsis);}else{if(i===0){dojo.attr(li,"innerHTML",dojo.string.substitute(this.bundle.text_page,[""]));}var a=dojo.create("a",{title:dojo.string.substitute(this.bundle.title_goto_page,[(i+1)]),id:this.namespace+"page_link_"+i,name:this.namespace+"page_link_"+i,innerHTML:i+1,href:"javascript:void(0);"},li);dojo.connect(a,"onclick",dojo.hitch(this,"fetchSpecificPage",i+1));var img;if(this.isRTL===true){img=dojo.create("img",{src:this.blankImgUrl,"alt":" "+this.bundle.alt_goto_page},a);}else{img=dojo.create("img",{src:this.blankImgUrl,"alt":this.bundle.alt_goto_page+" "},a,"first");}}}else{if(i===0){dojo.attr(li,"innerHTML",dojo.string.substitute(this.bundle.text_page,["1"]));}else{dojo.attr(li,"innerHTML",i+1);}}}}if(this.bIsTracing){this.traceExit(m);}},jumpToPage:function(event){if(this.bIsTracing){var m="jumpToPage(event)";this.traceEntry(m,[event]);}var key=event.keyCode;var keys=dojo.keys;if(key==keys.ENTER){var page=this._dapJumpToPageInput.value;var _2af0=parseInt(page,10);var mPos=page.match("[0-9]*");if((isNaN(_2af0))||(mPos!=page)){if(this.bIsTracing){this.traceExit(m,page);}return false;}else{var _2af1=Math.ceil(this.paging_totalResults/this.paging_resultsPerPage);if(_2af0<1){_2af0=1;}if(_2af0>_2af1){_2af0=_2af1;}this.fetchSpecificPage(_2af0);}}if(this.bIsTracing){this.traceExit(m);}return true;},initializePagingFooter:function(){if(this.bIsTracing){var m="initializePagingFooter()";this.traceEntry(m);}if(this._dapPagingFooterContainerDiv){dojo.destroy(this._dapPagingFooterContainerDiv);}this._dapPagingFooterContainerDiv=dojo.create("div",{},this.pagingFooter);var _2af2=dojo.create("div",{id:this.namespace+"jumpToPageSpan",name:this.namespace+"jumpToPageSpan",title:this.bundle.title_jump_to_page,"class":"lotusLeft"},this._dapPagingFooterContainerDiv);var _2af3=dojo.create("label",{innerHTML:this.bundle.text_jump_to_page+"&nbsp;"},_2af2);this._dapJumpToPageInput=dojo.create("input",{value:"",title:this.bundle.title_jump_to_page},_2af2);dojo.connect(this._dapJumpToPageInput,"onkeyup",dojo.hitch(this,"jumpToPage"));var _2af4=dojo.create("div",{id:this.namespace+"prevNextSpan",name:this.namespace+"prevNextSpan","class":"lotusRight"},this._dapPagingFooterContainerDiv);_isShowPrevLink=this.paging_currentPage>1;_isShowNextLink=(this.paging_currentPage*this.paging_resultsPerPage)<this.paging_totalResults;var ul=dojo.create("ul",{"class":"lotusInlinelist",id:this.namespace+"prevNextSpanList",name:this.namespace+"prevNextSpanList"},_2af4);var li;var a;var span;li=dojo.create("li",{"class":"lotusFirst",id:this.namespace+"prevLinkItem",name:this.namespace+"prevLinkItem"},ul);if(_isShowPrevLink){a=dojo.create("a",{id:this.namespace+"prevLink",name:this.namespace+"prevLink",onclick:dojo.hitch(this,"loadPreviousPage"),innerHTML:this.bundle.text_previous,title:this.bundle.title_previous,href:"javascript:void(0);"},li);}else{span=dojo.create("span",{id:this.namespace+"prevSpan",name:this.namespace+"prevSpan",innerHTML:this.bundle.text_previous,title:this.bundle.title_previous},li);}li=dojo.create("li",{id:this.namespace+"nextLinkItem",name:this.namespace+"nextLinkItem"},ul);if(_isShowNextLink){a=dojo.create("a",{id:this.namespace+"nextLink",name:this.namespace+"nextLink",onclick:dojo.hitch(this,"loadNextPage"),innerHTML:this.bundle.text_next,title:this.bundle.title_next,href:"javascript:void(0);"},li);}else{span=dojo.create("span",{id:this.namespace+"nextSpan",name:this.namespace+"nextSpan",innerHTML:this.bundle.text_next,title:this.bundle.title_next},li);}if(this.bIsTracing){this.traceExit(m);}},initializeTagCountSlider:function(){if(this.bIsTracing){var m="initializeTagCountSlider()";this.traceEntry(m);}var _2af5=this.cloudSliderDiv;if(this.sliderEnabled){_2af5.attr("minimum",this.minNumTags);_2af5.attr("maximum",this.maxNumTags);var _2af6=this.minNumTags+((this.maxNumTags-this.minNumTags)/2)+1;_2af5.attr("value",_2af6);_2af5.attr("discreteValues",this._discreteTags);_2af5.attr("intermediateChanges",true);_2af5.attr("showButtons",false);_2af5.onChange=dojo.hitch(this,this.onTagCountSliderChanged);if(this.bIsTracing){this.trace(m,"Slider Minimum Value ",_2af5.minimum);this.trace(m,"Slider Maximum Value ",_2af5.maximum);this.trace(m,"Slider Value         ",_2af5.value);this.trace(m,"Slider Discrete Tags ",_2af5.discreteValues);this.trace(m,"Slider OnChange      ",_2af5.onChange);}}else{if(this.bIsTracing){this.trace(m,"Hiding slider");}this._hideTagCloudSlider();}if(this.bIsTracing){this.traceExit(m);}},resetSliderTo50Percent:function(){if(this.bIsTracing){var m="resetSliderTo50Percent()";this.traceEntry(m);}var _2af7=this._maxTagsShown;var _2af8=this._minTagsShown;this.cloudSliderDiv.attr("maximum",_2af7);this.cloudSliderDiv.attr("minimum",_2af8);if(this.bIsTracing){this.trace(m,"maxValue ",_2af7);this.trace(m,"minValue ",_2af8);this.trace(m,"defaultSliderPosition ",this.defaultSliderPosition);}if(_2af8<_2af7){this._showTagCloudSlider();if(this.defaultSliderPosition==-1){var _2af9=_2af8+((_2af7-_2af8)/2)+1;if(_2af9>_2af7){_2af9=_2af7;}}else{_2af9=this.defaultSliderPosition;if(_2af9<_2af8){_2af9=_2af8;}if(_2af9>_2af7){_2af9=_2af7;}}this.cloudSliderDiv.attr("value",[_2af9]);this._numTagsShown=_2af9;this.updateTags();}else{this._hideTagCloudSlider();if(_2af7===0){this._numTagsShown=0;}else{this._numTagsShown=_2af7;this.updateTags();}}if(this.bIsTracing){this.traceExit(m);}},onTagCountSliderChanged:function(pos){if(this.bIsTracing){var m="onTagCountSliderChanged(pos)";this.traceEntry(m,[pos]);}this._numTagsShown=this.cloudSliderDiv.attr("value");this.updateTags();if(this.bIsTracing){this.traceExit(m);}},onFetchTagsError:function(err,_2afa,_2afb){if(this.bIsTracing){var m="onFetchTagsError(err, errText, errDetails)";this.traceEntry(m,[err,_2afa,_2afb]);}if(err.status==401){top.location.href=document.location.href;}else{if(err.status==403){dojo.attr(this.errorSpan,"innerHTML",this.bundle.text_error_insufficient_permissions);}else{dojo.attr(this.errorSpan,"innerHTML",_2afa);}dojo.style(this.errorDiv,"display","block");dojo.style(this.progressDiv,"display","none");if(_2afb&&_2afb!==""){dojo.attr(this.errorDetailsSpan,"innerHTML",_2afb);}}if(this.bIsTracing){this.traceExit(m);}},putTagsAsList:function(ul,items,_2afc){if(this.bIsTracing){var m="putTagsAsList(ul, items, request)";this.traceEntry(m,[ul,items,_2afc]);}var _2afd=this.tagStore;var _2afe=items.length;dojo.forEach(items,function(item){var _2aff=_2afd.getValue(item,com.ibm.widgets.TagCloud._nameAttribute);var _2b00=_2afd.getValue(item,com.ibm.widgets.TagCloud._countAttribute);var _2b01=_2afd.getValue(item,com.ibm.widgets.TagCloud._isMineAttribute);var uri=_2afd.getValue(item,com.ibm.widgets.TagCloud._hrefAttribute);this.placeTag(_2aff,_2b00,uri,ul);},this);if(this.bIsTracing){this.traceExit(m);}},putTagsAsCloud:function(ul,items,_2b02){if(this.bIsTracing){var m="putTagsAsCloud(ul, items, request)";this.traceEntry(m,[ul,items,_2b02]);}var _2b03=items.length;var _2b04=this.tagStore;dojo.forEach(items,function(item){var _2b05=_2b04.getValue(item,com.ibm.widgets.TagCloud._nameAttribute);var _2b06=_2b04.getValue(item,com.ibm.widgets.TagCloud._countAttribute);var _2b07=_2b04.getValue(item,com.ibm.widgets.TagCloud._isMineAttribute);var uri=_2b04.getValue(item,com.ibm.widgets.TagCloud._hrefAttribute);this.placeTag(_2b05,_2b06,uri,ul);},this);this._maxTagsShown=items.length;this._minTagsShown=this.minNumTags;if(items.length>0){this._hideNoTagsWarning();}else{this._showNoTagsWarning();}this.resetSliderTo50Percent();if(this.bIsTracing){this.traceExit(m);}},onFetchBegin:function(_2b08,_2b09){if(this.bIsTracing){var m="onFetchBegin(totalResultSize, requestObject)";this.traceEntry(m,[_2b08,_2b09]);}this.paging_totalResults=_2b08;if(this.bIsTracing){this.traceExit(m,_2b08);}},displayTags:function(items,_2b0a){if(this.bIsTracing){var m="displayTags(items, request)";this.traceEntry(m,[items,_2b0a]);}var _2b0b=(this._displayMode==this.displays[1]);dojo.style(this.errorDiv,"display","none");dojo.style(this.progressDiv,"display","none");var div=this.tagListContainer;var ul=dojo.create("ul",{id:this.namespace+"tagsList",name:this.namespace+"tagsList"},div);this._dapTagsList=ul;if(_2b0b){dojo.addClass(ul,"lotusList lotusEditable lotusMeta");}else{dojo.addClass(ul,"lotusTagCloud lotusList");}dijit.setWaiRole(ul,"grid");dijit.setWaiState(ul,"multiselectable","true");if(_2b0b){if((items.length===0)&&(this.paging_totalResults>0)){this.paging_pageToFetch=Math.ceil(this.paging_totalResults/this.paging_resultsPerPage);this.fetchTags();}else{this._hidePagingHeaderAndFooter();this.putTagsAsList(ul,items,_2b0a);this.paging_currentPage=this.paging_pageToFetch;this.initializePagingHeader();this.initializePagingFooter();if(items.length>0){this._hideNoTagsWarning();this._showPagingHeaderAndFooter();}else{this._hidePagingHeaderAndFooter();this._showNoTagsWarning();}}}else{this._hidePagingHeaderAndFooter();this.putTagsAsCloud(ul,items,_2b0a);}if(this.bIsTracing){this.traceExit(m);}},updateTags:function(){if(this.bIsTracing){var m="updateTags()";this.traceEntry(m);}var _2b0c=(this._displayMode==this.displays[1]);var _2b0d=this.tagListContainer;var _2b0e=_2b0d.getElementsByTagName("li");var _2b0f=Math.round(this._numTagsShown);var _2b10=new Array();var j;var l;if(this.bIsTracing){this.trace(m,"Number of tags in list",_2b0e.length);}var _2b11=0;for(j=0,l=_2b0e.length;j<l;j++){if(this._isSelectedTagNode(_2b0e[j])){_2b11++;}_2b10.push(_2b0e[j]);}if(!this._isViewModeLatest()){_2b10.sort(function(a,b){return (b.getAttribute("count")-a.getAttribute("count"));});}_2b10=_2b10.slice(0,_2b0f);if(this.bIsTracing){this.trace(m,"Number of tags in filteredTagsArray after slice",_2b10.length,_2b0f);}var _2b12=0;for(var z=0,ml=_2b10.length;z<ml;z++){if(this._isSelectedTagNode(_2b10[z])){_2b12++;}}var _2b13=(_2b10.length-(_2b11-_2b12));if(this.bIsTracing){this.trace(m,"New size of filteredTagsArray, based on calculation",_2b13);}if(_2b13<0){_2b13=0;}_2b10=_2b10.slice(0,_2b13);for(var x=0,n=_2b0e.length;x<n;x++){var _2b14=_2b0e[x];if((!this._arrayContains(_2b10,_2b14))&&(!this._isSelectedTagNode(_2b14))){dojo.style(_2b14,"display","none");}else{if(_2b0c){dojo.style(_2b14,"display",null);}else{dojo.style(_2b14,"display","inline");}}}if(this.bIsTracing){this.traceExit(m);}},refresh:function(){if(this.bIsTracing){var m="refresh()";this.traceEntry(m);}this.tagData=null;this.fetchTags();dojo.parser.parse(this.tagDiv);if(this.bIsTracing){this.traceExit(m);}},initializeTopicPublishAndSubscription:function(){if(this.bIsTracing){var m="initializeTopicPublishAndSubscription()";this.traceEntry(m);}dojo.subscribe("com/ibm/widgets/TagCloud",this,this.topicListener);dojo.publish("com/ibm/widgets/TagCloud",[{action:"TAGCLOUD_READY"}]);if(this.bIsTracing){this.traceExit(m);}},topicListener:function(args){if(this.bIsTracing){var m="topicListener(args)";this.traceEntry(m,args);}if(args!==null){var _2b15=args.action;if(this.bIsTracing){this.trace(m,"Transmitted args",args);}if(_2b15!==null){if(_2b15=="TAGCLOUD_READY"){if(this.bIsTracing){this.trace(m,"Received an event stating the TagCloud is ready");}}else{if(_2b15=="SENDER_READY"){if(this.bIsTracing){this.trace(m,"Received an event stating the a component able to transmit scopes is ready");}var _2b16=args.categories;var _2b17=args.typeSchemas;if((_2b16!==null)||(_2b17!==null)){if(this.bIsTracing){this.trace(m,"Transmitted categories ",_2b16);this.trace(m,"Transmitted typeSchemas",_2b17);this.trace(m,"isScopingEnabled",this.isScopingEnabled);this.trace(m,"scopeBy",this.scopeBy);this.trace(m,"selectableScopesMode",this.selectableScopesMode);this.trace(m,"preselectedScopesMode",this.preselectedScopesMode);}if(this.isScopingEnabled){if(this.bIsTracing){this.trace(m,"Scoping enabled");}if(this.scopeBy=="category"){if(this.bIsTracing){this.trace(m,"Scoping by",this.scopeBy);}if(this.selectableScopesMode=="sel_sc_manual"){if(this.bIsTracing){this.trace(m,"Only manual scopes selectable");}if((this.preselectedScopesMode=="presel_sc_trans")||(this.preselectedScopesMode=="presel_sc_both")){if(this.bIsTracing){this.trace(m,"Transmitted scopes preselected (hidden)");}this.hiddenCategories=this.hiddenCategories.concat(_2b16);if(this.bIsTracing){this.trace(m,"hiddenCategories",this.hiddenCategories);}}}else{if((this.selectableScopesMode=="sel_sc_trans")||(this.selectableScopesMode=="sel_sc_both")){if(this.bIsTracing){this.trace(m,"Transmitted scopes selectable");}this.selectableCategories=this.selectableCategories.concat(_2b16);if(this.bIsTracing){this.trace(m,"selectableCategories",this.selectableCategories);}if((this.preselectedScopesMode=="presel_sc_trans")||(this.preselectedScopesMode=="presel_sc_both")){if(this.bIsTracing){this.trace(m,"Transmitted scopes preselected");}this.preselectedCategories=this.preselectedCategories.concat(_2b16);if(this.bIsTracing){this.trace(m,"preselectedCategories",this.preselectedCategories);}}}}}else{if(this.bIsTracing){this.trace(m,"Scoping by",this.scopeBy);}if(this.selectableScopesMode=="sel_sc_manual"){if(this.bIsTracing){this.trace(m,"Only manual scopes selectable");}if((this.preselectedScopesMode=="presel_sc_trans")||(this.preselectedScopesMode=="presel_sc_both")){if(this.bIsTracing){this.trace(m,"Transmitted scopes preselected (hidden)");}this.hiddenTypeSchemas=this.hiddenTypeSchemas.concat(_2b17);if(this.bIsTracing){this.trace(m,"hiddenTypeSchemas",this.hiddenTypeSchemas);}}}else{if((this.selectableScopesMode=="sel_sc_trans")||(this.selectableScopesMode=="sel_sc_both")){if(this.bIsTracing){this.trace(m,"Transmitted scopes selectable");}this.selectableTypeSchemas=this.selectableTypeSchemas.concat(_2b17);if(this.bIsTracing){this.trace(m,"selectableTypeSchemas",this.selectableTypeSchemas);}if((this.preselectedScopesMode=="presel_sc_trans")||(this.preselectedScopesMode=="presel_sc_both")){if(this.bIsTracing){this.trace(m,"Transmitted scopes preselected");}this.preselectedTypeSchemas=this.preselectedTypeSchemas.concat(_2b17);if(this.bIsTracing){this.trace(m,"preselectedTypeSchemas",this.preselectedTypeSchemas);}}}}}}this.initializeScoping();}if(this.bIsTracing){this.trace(m,"Sending an event stating the the TagCloud is ready.");}dojo.publish("com/ibm/widgets/TagCloud",[{action:"TAGCLOUD_READY"}]);}}}}if(this.bIsTracing){this.traceExit(m);}}});com.ibm.widgets.TagCloud._allScope=["all"];com.ibm.widgets.TagCloud._communityScope=["community"];com.ibm.widgets.TagCloud._personalScope=["personal_public"];com.ibm.widgets.TagCloud._privateScope=["personal_private"];com.ibm.widgets.TagCloud._nameAttribute="title";com.ibm.widgets.TagCloud._isMineAttribute="isMine";com.ibm.widgets.TagCloud._countAttribute="count";com.ibm.widgets.TagCloud._hrefAttribute="href";com.ibm.widgets.TagCloud._cpUserModelSchema="cpum:oid:";com.ibm.widgets.TagCloud._tagSpaceEmptyURI="tm:ts:empty";com.ibm.widgets.TagCloud._tagSpaceAllURI="tm:ts:all";com.ibm.widgets.TagCloud._tagSpaceRelatedURI="tm:ts:related";com.ibm.widgets.TagCloud._EMPTY_TAG_CLOUD_SETTINGS="empty";com.ibm.widgets.TagCloud._qnameAll="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stv_all";com.ibm.widgets.TagCloud._qnameCommunity="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stv_community";com.ibm.widgets.TagCloud._qnamePersonalPublic="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stv_personalpublic";com.ibm.widgets.TagCloud._qnameLatest="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stv_latest";com.ibm.widgets.TagCloud._qnamePersonalPrivate="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stv_personalprivate";com.ibm.widgets.TagCloud._qnameMode="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}stm";com.ibm.widgets.TagCloud._qnameSettings="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}tcs";com.ibm.widgets.TagCloud._qnameSelectedCategories="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}sc";com.ibm.widgets.TagCloud._qnameSelectedSchemas="{http://www.ibm.com/xmlns/prod/websphere/portal/v7.0/portal-contextual-portal}sty";}
