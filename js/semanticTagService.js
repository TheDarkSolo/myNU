var SemTagSvcPortalGlobal={debug:!1,trace:!1,lang:"en",bidi:"ltr",service:("",{entries:[{id:"com.ibm.portal.action",test:"(globalTestNode.className.match(SemTagSvcPortal.actionRE))",js:"",classnames:[".com\\.ibm\\.portal\\.action"]},{id:"hcard",test:"(globalTestNode.className.match(SemTagSvcPortal.hcardRE))",js:"/javascript/semanticTagPerson.js",classnames:[".vcard"]},{id:"sametime",test:"id:hcard",js:"/javascript/semanticTagAwareness.js",classnames:[]},{id:"c2a",test:"(globalTestNode.className.match(/(^|\\s)c2a:(source|target)(\\s|$)/)) ",js:"/javascript/semanticTagC2A.js",classnames:[".c2a\\:source",".c2a\\:target"]}]}),ifConnUrlExists:"false",connUrl:"null",isconnServerNew:!1,contextUrl:"/wps_semanticTag",wpsBaseURL:"/wps",ptTimeout:1500,preferredImIds:["X-imn","email","uid","fn"],externalServiceEntries:"",c2a_click_for_actions:"Click for Actions",hover_label_menu:"Click for options",a11y_hover:"more information",a11y_photo:"photo",a11y_close:"close",ally_expandImage:"Click to hide information",ally_collapsedImage:"Click to display more information",ally_showMore:"Show More",ally_showLess:"Show Less",ally_buisnessCardLabel:"Business Card",ally_moreAction:"More Actions",start_chat:"Chat",add_to_contact:"Add as Sametime Contact",send_email:"Send Mail",view_person:"Profile",hover_label_person:"Click for Person Card",work_location:"person.adr.locality+', '+person.adr.region+' '+person.adr.countryname",specify_email_if_connection:"When Portal is integrated with Connections, Connection Business Card appears only if email is specified",expandedItems:"ibm-primaryEmail,street,stateOrProvinceName,postalCode,countryName",collapsedItems:"ibm-jobTitle,telephoneNumber",showDetailsFlag:!0,isDynamicLoading:!1,isC2AHandlerRequired:!0,isPersonCardHandlerRequired:!0,isActionHandlerRequired:!0,newSametimeCommunityServer:!0,getPersonResolverUrl:function(){return"?uri=personrecord%3ATOBEREPLACED"}},externalEntries=new Array;try{externalEntries=eval(SemTagSvcPortalGlobal.externalServiceEntries),SemTagSvcPortalGlobal.debug&&console.log("SemTagSvcPortalGlobal.service.entries is:"+SemTagSvcPortalGlobal.service.entries+": before merge:"+externalEntries+":"+SemTagSvcPortalGlobal.externalServiceEntries+":"),SemTagSvcPortalGlobal.service.entries.concat(externalEntries),SemTagSvcPortalGlobal.debug&&console.log("SemTagSvcPortalGlobal.service.entries is:"+SemTagSvcPortalGlobal.service.entries+": after merge")}catch(e){SemTagSvcPortalGlobal.debug&&console.error("Error occured doing eval on:"+SemTagSvcPortalGlobal.externalServiceEntries)}var SemTagSvcPortal={debug:SemTagSvcPortalGlobal.debug,trace:SemTagSvcPortalGlobal.trace,version:"1.0",lang:SemTagSvcPortalGlobal.lang,bidi:SemTagSvcPortalGlobal.bidi,tagScope:["*"],service:SemTagSvcPortalGlobal.service,scripts:new Array,actionRegistry:null,refcntAttr:"semtag_refcnt",hoverIdPrefix:"semtag_hover_",hoverIdx:0,liveElemPrefix:"semtag_live_",reMap:new Array,actionRE:new RegExp("(^|\\s)com.ibm.portal.action(\\s|$)"),hcardRE:new RegExp("(^|\\s)vcard(\\s|$)"),specialMenuProviders:new Array,parseElem:null,availAttribStr:"",ifConnUrlExists:SemTagSvcPortalGlobal.ifConnUrlExists,connUrl:SemTagSvcPortalGlobal.connUrl,isconnServerNew:SemTagSvcPortalGlobal.isconnServerNew,sametimeSTProxy:"undefined"!=typeof stproxy,sametimeSTLinks:"undefined"==typeof stproxy&&"undefined"!=typeof prepareSametimeLink,sametimeNotIntegrated:"undefined"==typeof stproxy&&"undefined"==typeof prepareSametimeLink,DELAY:10,init:function(e){var t=SemTagSvcPortal.DELAY;if(SemTagSvcPortal.debug&&console.log("inside init of SemtagSvc:"),null==window.ibmCfg||"undefined"===window.ibmCfg||null==window.ibmCfg.enablerConfig||"undefined"===window.ibmCfg.enablerConfig||null==com.ibm.mashups||"undefined"===com.ibm.mashups)SemTagSvcPortal.debug&&console.log("inside init of SemtagSvc for non csa2.theme"),SemTagSvcPortal.parseElem=SemTagSvcPortal.getElementFromEvent(e),window.setTimeout(SemTagSvcPortal.parseDom,SemTagSvcPortal.DELAY);else{SemTagSvcPortal.debug&&console.log("inside init of SemtagSvc for csa2.theme");var a=SemTagSvcPortal.service.entries;if(SemTagSvcPortal.debug&&console.log("In case of csa2.theme"+(a?a.length:0)),SemTagSvcPortalGlobal.isDynamicLoading)for(var r=0;r<a.length;r++){var n=a[r];SemTagSvcPortal.debug&&console.log("Calling SemTagSvcPortal.loadScript for:"+n.js+":"+n.id),"hcard"==n.id&&(SemTagSvcPortal.loadScript("/javascript/attributes.js"),SemTagSvcPortal.loadScript("/javascript/semanticTagMenu.js")),SemTagSvcPortal.loadScript(n.js)}}SemTagSvcPortalGlobal.isActionHandlerRequired&&SemTagSvcPortal.setCallback("com.ibm.portal.action",SemTagSvcPortal.processActions),!SemTagSvcPortalGlobal.isDynamicLoading&&SemTagSvcPortalGlobal.isPersonCardHandlerRequired&&window.setTimeout(SemTagMenu.init,t)},loadConnScript:function(){var e=document.createElement("script"),t=SemTagSvcPortal.connUrl,a=t;a=t+"/profiles/portalJS/portalBizCard.js",a+=-1==a.indexOf("?")?"?":"&",a+="lang="+SemTagSvcPortal.lang,e.src=a;try{document.body.insertBefore(e,document.body.firstChild)}catch(e){alert("Svc.loadConnScript caught: "+e)}},watchEvent:function(e,t,a,r){try{e.addEventListener?e.addEventListener(t,a,r):e.attachEvent&&e.attachEvent("on"+t,a)}catch(e){SemTagSvcPortal.debug&&alert("Svc.watchEvent caught: "+e)}},clearEventWatch:function(e,t,a,r){try{e.removeEventListener?e.removeEventListener(t,a,r):e.detachEvent&&e.detachEvent("on"+t,a)}catch(e){SemTagSvcPortal.debug&&alert("Svc.clearEventWatch caught: "+e)}},parseDomUsingMashupHandlerSingleNode:function(e,t){SemTagSvcPortal.debug&&console.log("Inside parseDomUsingMashupHandlerSingleNode :"+e+":"+t);var a=SemTagSvcPortal.getService(t);if(a.nodes)for(var r=0;r<a.nodes.length;r++)a.nodes.pop();else a.nodes=new Array;if(a.nodes.push(e),SemTagSvcPortal.debug&&console.log("parseDomUsingMashupHandlerSingleNode entry.callback got is:"+a.callback+":"+a.id+":"+a.nodes.length+":"+("hcard"==a.id)),a.callback&&a.callback.call(this),"hcard"==a.id){var n=SemTagSvcPortal.getService("sametime");SemTagSvcPortal.debug&&console.log("Entry for sametime got is:"+n),n.callback.call(this)}},parseDomUsingMashupHandler:function(e,t){SemTagSvcPortal.debug&&console.log("Inside parseDomUsingMashupHandler :"+e+":"+t);var a=SemTagSvcPortal.getService(t);"com.ibm.portal.action"===t&&SemTagSvcPortal.setCallback(t,SemTagSvcPortal.processActions),a.nodes||(a.nodes=new Array);for(var r=0;r<e.length;r++)a.nodes.push(e[r]);SemTagSvcPortal.debug&&console.log("parseDomUsingMashupHandler entry.callback got is:"+a.callback+":"+a.id+":"+a.nodes.length+":"+("hcard"==a.id)),a.callback&&a.callback.call(this),SemTagSvcPortal.loadScript(a.js);try{for(var n=SemTagSvcPortal.service.entries,o=0;o<n.length;o++){var l=n[o];SemTagSvcPortal.debug&&console.log("entryTemp.callback got is:"+l.id+":"+l.nodes+":"+l.js+":And original entry id is:"+a.id);var i=!1;if(l.id!==a.id){if(l.test.match(/^id:/)){var s=l.test.substr(3);if(s!=a.id)continue;SemTagSvcPortal.debug&&console.log("svcName got is:"+s);e=SemTagSvcPortal.getNodes(s);SemTagSvcPortal.debug&&console.log("nodes for "+s+" got is:"+e+":"+e.length),e&&0<e.length&&(i=!0)}i&&SemTagSvcPortalGlobal.isDynamicLoading&&SemTagSvcPortal.loadScript(l.js),l.callback&&l.callback.call(this)}}}catch(e){SemTagSvcPortal.debug&&console.error("Exception occured while doing match of services in SemTagSvcPortal.parseDonMashup"+e)}},parseDom:function(e,t){SemTagSvcPortal.debug&&console.log("inside parseDom of SemtagSvc"),SemTagSvcPortal.trace&&SemTagUtil.log("parseDom("+e+","+t+")"),!t&&e&&(t=SemTagSvcPortal.getElementFromEvent(e)),!t&&SemTagSvcPortal.parseElem?t=SemTagSvcPortal.parseElem:t?"string"==typeof t&&(t=document.getElementById(t)):t=document;for(var a=SemTagSvcPortal.service.entries,r=0;r<a.length;r++){if((o=a[r]).nodes){if(t==document)for(;0<o.nodes.length;)o.nodes.pop()}else o.nodes=new Array}SemTagSvcPortal.traverseNodes(t);for(var n=0;n<a.length;n++){var o,l=!1;if(0<(o=a[n]).nodes.length)l=!0;else if(o.test.match(/^id:/)){var i=o.test.substr(3),s=SemTagSvcPortal.getNodes(i);s&&0<s.length&&(l=!0)}l&&SemTagSvcPortalGlobal.isDynamicLoading&&("hcard"==o.id&&(SemTagSvcPortal.loadScript("/javascript/attributes.js"),SemTagSvcPortal.loadScript("/javascript/semanticTagMenu.js")),SemTagSvcPortal.loadScript(o.js)),SemTagSvcPortal.debug&&console.log("entry.callback got is:"+o.id+":"+o.nodes),o.callback&&o.callback.call(this)}SemTagSvcPortal.parseElem=null},traverseNodes:function(e){SemTagSvcPortal.traverse_children(e)},traverse_tagscope:function(_23){for(var _24=SemTagSvcPortal.service.entries,_25=_23.getElementsByTagName(SemTagSvcPortal.tagScope),i=0;i<_25.length;i++)for(var _23=_25[i],j=0;j<_24.length;j++){var _26=_24[j];_26.nodes||(_26.nodes=new Array),eval(_26.test)&&_26.nodes.push(_23)}},traverse_children:function(e){SemTagSvcPortal.testNode(e);var t=e&&e.childNodes?e.childNodes:null;if(SemTagSvcPortalGlobal.isPersonCardHandlerRequired&&e&&e.tagName&&"IFRAME"==e.tagName){try{if("undefined"!=typeof ActiveXObject){var a=document.frames[e.id].document;a&&(t=a.childNodes)}else e.contentDocument&&e.contentDocument.childNodes&&(t=e.contentDocument.childNodes)}catch(e){t=null}if(SemTagSvcPortal.trace&&SemTagUtil.log("IFRAME(id="+e.id+",children="+(t?t.length:"is null")+")"),t&&0<t.length)SemTagMenu.includeCSS(t[0].parentNode)&&(SemTagSvcPortal.watchEvent(e,"load",SemTagSvcPortal.parseDom,!1),SemTagMenu.registerMenuEventHandlers(t[0].parentNode))}if(null!=t&&"undefined"!=t)for(var r=0;r<t.length;r++)SemTagSvcPortal.traverse_children(t[r])},testNode:function(_2b){if(globalTestNode=_2b,null!=_2b&&null!=_2b.className&&"undefined"!=_2b.className&&null!=_2b.tagName&&"undefined"!=_2b.tagName)for(var _2c=SemTagSvcPortal.service.entries,j=0;j<_2c.length;j++){var _2d=_2c[j];!_2d.test.match(/^id:/)&&eval(_2d.test)&&(_2b.alreadyadded||(_2b.alreadyadded=!0,_2d.nodes.push(_2b)))}},getService:function(e){for(var t=SemTagSvcPortal.service.entries,a=0;a<t.length;a++){var r=t[a];if(r.id==e)return r}},setSemanticTagValue:function(e,t,a){t.semTagValues||(t.semTagValues={}),t.semTagValues[e]=a},getSemanticTagValues:function(e){return e.semTagValues},getNodes:function(e){var t=SemTagSvcPortal.getService(e);return SemTagSvcPortal.debug&&console.log("Inside SemTagSvcPortal.getNodes for:"+e),t&&t.test.match(/^id:/)&&(t=SemTagSvcPortal.getService(t.test.substr(3))),SemTagSvcPortal.debug&&console.log("Inside SemTagSvcPortal.getNodes for:"+e+"and service  is:"+t),t&&SemTagSvcPortal.debug&&console.log("Inside SemTagSvcPortal.getNodes for:"+e+"and service.nodes  is:"+t.nodes),t?t.nodes:null},setCallback:function(e,t){var a=SemTagSvcPortal.getService(e);a?(a.callback=t,SemTagSvcPortal.debug&&console.log("Callback setting for :"+e),SemTagSvcPortal.debug&&console.log("Callback set for :"+a.id)):SemTagSvcPortal.debug&&console.log("Did not get service for :"+e)},loadScript:function(e,t){if(e&&""!=e&&("undefined"!=t&&null!=t||(t=!1),!SemTagSvcPortal.scripts[e])){SemTagSvcPortal.scripts[e]=!0;var a=document.createElement("script"),r=e.match(/^http/)?e:SemTagSvcPortalGlobal.contextUrl+e;r+=-1==r.indexOf("?")?"?":"&",r+="language="+SemTagSvcPortal.lang,a.src=r,SemTagSvcPortal.debug&&console.log("URL in LOADSCRIPT GOT IS :"+r),(SemTagSvcPortalGlobal.isDynamicLoading||t)&&document.body.insertBefore(a,document.body.firstChild)}},setSpecialMenuProvider:function(e){SemTagSvcPortal.specialMenuProviders.push(e)},getElementsByClassName:function(e,t,a,r){t||(t=document.body),a||(limit=0),r||(r=["*"]);var n=SemTagSvcPortal.getRegExp(e);if(t&&t.className&&t.className.match(n))return new Array(t);for(var o=new Array,l=0;l<r.length;l++)for(var i=t.getElementsByTagName(r[l]),s=0;s<i.length;s++){var c=i[s];if(c.className&&c.className.match(n)&&o.push(c),0<a&&a==o.length)break}return o},getParentByClassName:function(e,t){if(!t)return null;var a=SemTagSvcPortal.getRegExp(e);if(t.className&&t.className.match(a))return t;for(;t.parentNode;)if((t=t.parentNode).className&&t.className.match(a))return t;return null},addHover:function(e,t,a,r){for(;null==typeof SemTagMenu;)alert("waiting...");var n=e.getAttribute(SemTagSvcPortal.refcntAttr);if(SemTagSvcPortal.debug&&console.log("Refcount got is:"+n+":"+SemTagMenu.staticHover+":"+(null!==t)+":"+a),n)e.setAttribute(SemTagSvcPortal.refcntAttr,parseInt(Number(n)+1)),SemTagMenu.staticHover?(o=SemTagMenu.findHoverFromLiveElement(e))?(SemTagSvcPortal.watchEvent(o,"click",a,!1),o.setAttribute("href","javascript:SemTagMenu.a11y()")):SemTagSvcPortal.debug&&alert("couldn't find the hover for this element!"):SemTagSvcPortal.watchEvent(e,"mouseover",t,!1);else if(e.setAttribute(SemTagSvcPortal.refcntAttr,"1"),SemTagSvcPortal.hoverIdx++,e.setAttribute(SemTagSvcPortal.liveElemPrefix+"id",SemTagSvcPortal.hoverIdx),SemTagMenu.staticHover){var o=SemTagSvcPortal.createHoverImage(r);SemTagSvcPortal.watchEvent(o,"click",a,!1),SemTagSvcPortal.watchEvent(o,"keydown",SemTagMenu.a11y,!1),o.setAttribute("href","javascript:void()");var l=e.nextSibling;l?l.parentNode.insertBefore(o,l):e.parentNode.appendChild(o),e.setAttribute(SemTagSvcPortal.hoverIdPrefix+"idx",parseInt(SemTagSvcPortal.hoverIdx)),e.id=SemTagSvcPortal.liveElemPrefix+SemTagSvcPortal.hoverIdx}else{var i=SemTagUtil.getNodeClassValue(e);i&&0<i.length?i+=" hasHover":i="hasHover",SemTagUtil.setNodeClassValue(e,i),SemTagSvcPortal.watchEvent(e,"mouseover",t,!1),e.setAttribute("tabIndex","0"),SemTagSvcPortal.watchEvent(e,"focus",t,!1),SemTagSvcPortal.watchEvent(e,"blur",SemTagMenu.mouseout,!1),e.setAttribute("title",r)}},removeHover:function(e,t,a){var r=e.getAttribute(SemTagSvcPortal.refcntAttr);if(r){var n=Number(r)-1;if(n<0&&SemTagSvcPortal.debug&&alert("SemTagSvcPortal.removeHover called on an element with refcnt="+r),SemTagMenu.staticHover){var o=SemTagSvcPortal.getHoverElement(e);SemTagSvcPortal.clearEventWatch(o,"click",a,!1),0==n&&o.parentNode.removeChild(o)}else if(SemTagSvcPortal.clearEventWatch(e,"mouseover",t,!1),SemTagSvcPortal.clearEventWatch(e,"focus",t,!1),e.setAttribute(SemTagSvcPortal.refcntAttr,n),0==n){var l=SemTagUtil.getNodeClassValue(e).replace(/hasHover/,"");SemTagUtil.setNodeClassValue(e,l),e.removeAttribute(SemTagSvcPortal.refcntAttr),e.removeAttribute("tabIndex")}}},createHoverImage:function(e){var t=document.createElement("img");t.id=SemTagSvcPortal.hoverIdPrefix+SemTagSvcPortal.hoverIdx,t.className=SemTagMenu.iconName,t.setAttribute("src",SemTagSvcPortalGlobal.contextUrl+"/ui/menu_selected.gif"),t.setAttribute("border","0"),t.setAttribute("alt",e);var a=document.createElement("a");return SemTagSvcPortal.watchEvent(a,"mouseover",SemTagMenu.activateHover,!1),SemTagSvcPortal.watchEvent(a,"mouseout",SemTagMenu.deactivateHover,!1),a.appendChild(t),a},getHoverElement:function(e){if(!e)return null;if(SemTagMenu.staticHover){var t=e.getAttribute(SemTagSvcPortal.hoverIdPrefix+"idx"),a=document.getElementById(SemTagSvcPortal.hoverIdPrefix+t);if(a)return a.parentNode}else{if(SemTagUtil.getNodeClassValue(e).match(/hasHover/))return e}return null},showHover:function(e,t,a){SemTagMenu.showHover(e,t,a)},setMenuData:function(e,t,a,r,n){SemTagMenu.setMenuData(e,t,a,r,n)},getMenuItemJson:function(e,t,a,r){return{label:e,href:t,order:a||0,icon:r||""}},getMenuHeaderJson:function(e,t,a){return"text/html"!=t?null:e&&0<e.length?{markup:e,order:a}:void 0},getMenuFooterJson:function(e,t,a){return"text/html"!=t?null:e&&0<e.length?{markup:e,order:a}:void 0},getElementFromEvent:function(e){var t=e.target?e.target:e.srcElement;return t==window&&(t=t.document),t},getLiveElementFromEvent:function(e){return SemTagMenu.findLiveElementFromEventSource(SemTagSvcPortal.getElementFromEvent(e))},getEventAbsoluteX:function(e){var t=0;return e.pageX?t=e.pageX:e.clientX&&(t=document.body.scrollLeft>document.documentElement.scrollLeft?e.clientX+document.body.scrollLeft:e.clientX+document.documentElement.scrollLeft),t},getEventAbsoluteY:function(e){var t=0;return e.pageY?t=e.pageY:e.clientY&&(t=document.body.scrollTop>document.documentElement.scrollTop?e.clientY+document.body.scrollTop:e.clientY+document.documentElement.scrollTop),t},findPosition:function(e,t){var a=0,r=0,n=e.offsetWidth;if(e.offsetParent){for(t&&(a+="rtl"==SemTagSvcPortal.bidi?0:n),r+=e.offsetHeight;null!=e;)a+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;return[a+("rtl"==SemTagSvcPortal.bidi?n:0),r]}return[e.x+("rtl"==SemTagSvcPortal.bidi?n:0),e.y]},createGroupJson:function(e,t){return{context:e,extenders:t}},createActionJson:function(e,t,a,r,n,o,l,i){return{id:e&&0<e.length?e[0].innerHTML:null,impl:t&&0<t.length?t[0].innerHTML:null,context:a&&0<a.length?a[0].innerHTML:null,label:r&&0<r.length?r[0].innerHTML:null,description:n&&0<n.length?n[0].innerHTML:null,showif:o&&0<o.length?o[0].innerHTML:null,url:l&&0<l.length?l[0].innerHTML:null,order:i&&0<i.length?parseInt(i[0].innerHTML):0}},parseOrder:function(e){return null==e||0==e.length?0:"-"==e.charAt(0)?-1*parseInt(e.substr(1)):parseInt(e)},getActions:function(e){SemTagSvcPortal.actionRegistry||SemTagSvcPortal.processActions();for(var t=0;t<SemTagSvcPortal.actionRegistry.length;t++)if(SemTagSvcPortal.actionRegistry[t].context==e)return SemTagSvcPortal.actionRegistry[t].extenders;return SemTagSvcPortal.actionRegistry[0].extenders},processActions:function(){var e;SemTagSvcPortal.debug&&console.log("inside processActions of SemtagSvcPortal"),SemTagSvcPortal.actionRegistry||(SemTagSvcPortal.actionRegistry=new Array,SemTagSvcPortal.actionRegistry[0]=SemTagSvcPortal.createGroupJson("dummy",new Array));var t=SemTagSvcPortal.getNodes("com.ibm.portal.action");for(SemTagSvcPortal.debug&&console.log("Nodes got for com.ibm.portal.action is:"+t);t&&0<t.length;){SemTagSvcPortal.debug&&console.log("Inside while loop of actions");var a=t.pop(),r=SemTagSvcPortal.getElementsByClassName("action-id",a),n=SemTagSvcPortal.getElementsByClassName("action-impl",a),o=SemTagSvcPortal.getElementsByClassName("action-context",a),l=SemTagSvcPortal.getElementsByClassName("action-label",a),i=SemTagSvcPortal.getElementsByClassName("action-description",a),s=SemTagSvcPortal.getElementsByClassName("action-showif",a),c=SemTagSvcPortal.getElementsByClassName("action-url",a),m=SemTagSvcPortal.getElementsByClassName("action-order",a),g=SemTagSvcPortal.createActionJson(r,n,o,l,i,s,c,m);for(e=1;e<SemTagSvcPortal.actionRegistry.length;e++)if(SemTagSvcPortal.actionRegistry[e].context==g.context){for(var S=SemTagSvcPortal.actionRegistry[e].extenders.length,u=0;u<S&&g.id!=SemTagSvcPortal.actionRegistry[e].extenders[u].id;u++);u==S&&SemTagSvcPortal.actionRegistry[e].extenders.push(g);break}e==SemTagSvcPortal.actionRegistry.length&&(SemTagSvcPortal.actionRegistry[e]=SemTagSvcPortal.createGroupJson(o[0].innerHTML,new Array),SemTagSvcPortal.actionRegistry[e].extenders.push(g)),SemTagSvcPortal.debug&&console.log("Action.impl got is:"+g.impl),g.impl&&SemTagSvcPortal.loadScript(g.impl,!0)}for(e=0;e<SemTagSvcPortal.actionRegistry.length;e++)SemTagSvcPortal.actionRegistry[e].extenders.sort(SemTagSvcPortal.sortByOrder)},sortByOrder:function(e,t){return e.order>t.order?1:e.order<t.order?-1:0},getTextValue:function(e){return e?e.innerHTML.replace(/<[a-zA-Z\/][^>]*>/gi,""):""},getTypedValue:function(e,t){t||(t="def");var a=new Array,r=SemTagSvcPortal.getElementsByClassName("type",e),n=SemTagSvcPortal.getElementsByClassName("value",e),o="";n.length<1&&(o=SemTagSvcPortal.getTextValue(e));for(var l=0;l<n.length;l++)o+=SemTagSvcPortal.getTextValue(n[l]);if(r.length<1)a[t]=o;else for(var i=0;i<r.length;i++){var s=r[i];a[(s.tagName.match(/^abbr$/i)?s.getAttribute("title"):SemTagSvcPortal.getTextValue(s)).toLowerCase()]=o}return a},findNameElementInHcard:function(e){"vcard"!=e.className&&(e=SemTagSvcPortal.getParentByClassName("vcard",e));var t=SemTagSvcPortal.getElementsByClassName("fn",e)[0];return t||(t=SemTagSvcPortal.getElementsByClassName("n",e)[0]),t},getEmailFromHcard:function(e){if(!e)return"";"vcard"!=e.className&&(e=SemTagSvcPortal.getParentByClassName("vcard",e));var t="";if(e){var a=SemTagSvcPortal.getElementsByClassName("email",e)[0];t=SemTagSvcPortal.getTypedValue(a,"internet").internet}return t},findElementByNameInHcard:function(e,t){return"vcard"!=e.className&&(e=SemTagSvcPortal.getParentByClassName("vcard",e)),SemTagSvcPortal.getElementsByClassName(t,e)[0]},getRegExp:function(e){var t=SemTagSvcPortal.reMap[e];return t||(t=new RegExp("(^|\\s)"+e+"(\\s|$)"),SemTagSvcPortal.reMap[e]=t),t}},SemTagSvcConfig=null;"true"==SemTagSvcPortal.ifConnUrlExists&&!0===SemTagSvcPortal.isconnServerNew&&(SemTagSvcConfig={isPortal:!0,baseUrl:SemTagSvcPortal.connUrl+"/profiles",loadCssFiles:!0,isBidiRTL:!1}),SemTagSvcPortal.watchEvent(window,"load",SemTagSvcPortal.init,!1);var SemTagSvc=SemTagSvcPortal,SemTagUtil={isGecko:!document.all,getNodeClassValue:function(e){var t;return void 0!==(t=SemTagUtil.isGecko?void 0!==e.getAttribute?e.getAttribute("class"):"":e.className)&&null!=t?t:""},setNodeClassValue:function(e,t){SemTagUtil.isGecko?e.setAttribute("class",t):e.className=t},fireEvent:function(e,t){try{e.fireEvent?e.fireEvent(t):e.dispatchEvent&&e.dispatchEvent(t)}catch(e){SemTagSvcPortal.debug&&alert("Svc.fireEvent caught: "+e)}},getOwnerDocument:function(e){if(!e)return null;if(SemTagUtil.isGecko)return e.ownerDocument;for(var t=e;t.parentNode;)t=t.parentNode;return t},getFrameElement:function(e){if(SemTagUtil.isGecko)return e.ownerDocument.defaultView.frameElement;for(var t=e;t.parentNode;)t=t.parentNode;return t.parentWindow.frameElement},getHcardAttributeValue:function(e,t){switch(e){case"email":return SemTagUtil.getHcardTypedAttribute(t,e,"internet");case"tel":return SemTagUtil.getHcardTypedAttribute(t,e,"voice");case"adr":return SemTagUtil.getHcardTypedAttribute(t,e,"intl")}var a=SemTagSvcPortal.getParentByClassName("vcard",t),r=SemTagSvcPortal.getElementsByClassName(e,a,1);if(r.length>0&&r[0].tagName.match(/^abbr$/i))return r[0].getAttribute("title");switch(e){case"X-person-display-inline":return r.length>0;case"fn":var n=SemTagUtil.getSinglePropertyValue(r[0]);return n||SemTagUtil.getHcardAttributeValue("n",t);case"X-person-header-only":case"X-person-inside-inline":return r&&0<r.length;case"X-sametime-resolve":var o=r[0];return void 0!==o&&null!=o;case"n":if(r.length>0){for(var l=r[0],i="",s=["honorific-prefix","given-name","additional-name","family-name","honorific-suffix"],c=0;c<5;c++){var m=SemTagUtil.getSinglePropertyValue(SemTagSvcPortal.getElementsByClassName(s[c],l,1)[0]);m&&(i+=m+" ")}return i}return"";case"photo":var g=r[0];return g?g.getAttribute("src"):void 0;case"X-sametime-status":var S=r[0];if(!S)return"";var u=S.getAttribute("value");return u||SemTagUtil.getSinglePropertyValue(S);default:return SemTagUtil.getSinglePropertyValue(r[0])}},getHcardTypedAttribute:function(e,t,a){for(var r=new Object,n=SemTagSvcPortal.getParentByClassName("vcard",e),o=SemTagSvcPortal.getElementsByClassName(t,n),l=0;l<o.length;l++){var i=o[l];if("email"==t&&"a"==i.nodeName.toLowerCase()&&i.href.match(/^mailto:/)){var s=i.href.indexOf("?");r[a]=s>-1?i.href.slice(7,s):i.href.slice(7)}else r=SemTagSvcPortal.getTypedValue(i,a)}return r},getSinglePropertyValue:function(e){return!!e&&e.innerHTML.replace(/<[a-zA-Z\/][^>]*>/gi,"")},crossDomainRequest:function(){var e=new Array,t=new Array,a=this;createTimeoutFunction=function(e){return function(){a.cancelRequest(e)}},this.getScriptId=function(e){return"_JVLN_"+e},this.getScriptObject=function(e){var t=SemTagUtil.isGecko?this.getScriptId(e):this.$_getScriptId(e);return document.getElementById(t)},this.request=function(a,r,n,o,l){var i=this.getScriptId(l);n&&(e[l]=n),o&&(t[l]=o);var s=document.createElement("script");s.id=i;try{s.src=a}catch(e){return SemTagSvcPortal.debug&&alert("crossDomainRequest.request: "+e),!1}if(document.body.insertBefore(s,document.body.firstChild),r){window.setTimeout(createTimeoutFunction(l),r)}},this.cancelRequest=function(a){SemTagSvcPortal.debug&&(window.status="crossDomainRequest.cancelRequest");var r=e[a];e[a]=null;var n=t[a];if(t[a]=null,r)try{if(r){var o={target:n};r.call(this,!1,null,o)}var l=this.getScriptObject(a);l&&document.body.removeChild(l)}catch(e){SemTagSvcPortal.trace&&SemTagUtil.log("crossDomainRequest.cancelRequest caught: "+e+"(callback="+r+")")}},this.dispatch=function(a,r){if(a)try{var n=e[a];if(SemTagSvcPortal.debug&&!n&&alert("dispatch got null callback for: "+a),n){var o={target:t[a]};n.call(this,!0,r,o),e[a]=null,t[a]=null;var l=this.getScriptObject(a);l&&document.body.removeChild(l)}}catch(e){SemTagSvcPortal.trace&&SemTagUtil.log("crossDomainRequest.dispatch caught: "+e)}}},log:function(e){var t=document.getElementById("javlin.logger");if(t){var a=document.createTextNode(e+"..... ");t.appendChild(a)}}},availAttrib={availAttribUrl:SemTagSvcPortalGlobal.wpsBaseURL+"/um/secure/attributes/users",req:"",userAttributesRetrieved:!1,retrieveAttribute:function(){if(!availAttrib.userAttributesRetrieved&&""==SemTagSvcPortal.availAttribStr){availAttrib.req=ibm.portal.xml.getXmlHttpRequest(),availAttrib.req.onreadystatechange=availAttrib.processStateChange;try{availAttrib.req.open("GET",availAttrib.availAttribUrl,!0)}catch(e){alert(e)}availAttrib.req.send(null),availAttrib.userAttributesRetrieved=!0}},getAttributesFromTags:function(e,t,a){return"undefined"!=typeof ActiveXObject?e.getElementsByTagName(a+":"+t):e.getElementsByTagNameNS("*",t)},processStateChange:function(){if(4==availAttrib.req.readyState)if(200==availAttrib.req.status){var e=availAttrib.req.responseText;if(e.length>1){var t,a=ibm.portal.xml.loadXmlString(e),r=availAttrib.getAttributesFromTags(a.documentElement,"title","atom");for(t=1;t<r.length;t++)""==SemTagSvcPortal.availAttribStr?null!=r[t].firstChild.nodeValue&&(SemTagSvcPortal.availAttribStr=r[t].firstChild.nodeValue):null!=r[t].firstChild.nodeValue&&(SemTagSvcPortal.availAttribStr=r[t].firstChild.nodeValue+","+SemTagSvcPortal.availAttribStr)}}else SemTagSvcPortal.debug&&console.log(availAttrib.req.statusText)}},mytest=null,liveNameElementId=null,SemTagMenu={needCss:!0,staticHover:!1,id:"semtagmenu",hideDelay:SemTagSvcPortalGlobal.ptTimeout,timeouts:[],iconName:"menu_drop_icon",showing:!1,currentElem:null,currentHoverLabel:null,refCount:-1,a11yMode:!1,svcHandlers:[],items:[],headers:[],footers:[],moreActionImgUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/ShowActions.gif",verticalRulerUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/Line_Tree.gif",hoverIdRE:new RegExp(SemTagSvcPortal.hoverIdPrefix),iconNameRE:new RegExp("(^|\\s)menu_drop_icon(\\s|$)"),sftflag:!1,init:function(){SemTagMenu.includeCSS(document)},includeCSS:function(e){var t=!1;if(void 0===e._JAVLIN_STYLE_){if(t=!0,SemTagMenu.needCss){var a=e.createElement("link");a.rel="stylesheet",a.href=SemTagSvcPortalGlobal.contextUrl+"/ui/"+("rtl"==SemTagSvcPortal.bidi?"styles_rtl.css":"styles.css"),a.type="text/css";var r=e.getElementsByTagName("head");r&&r[0]&&r[0].appendChild(a)}e._JAVLIN_STYLE_="loaded"}return t},registerMenuEventHandlers:function(e){SemTagSvcPortal.watchEvent(e,"click",SemTagMenu.click,!1),SemTagSvcPortal.watchEvent(e,"keydown",SemTagMenu.catchEscape,!1),SemTagSvcPortal.watchEvent(e,"keyup",SemTagMenu.catchKeyup,!1)},unregisterMenuEventHandlers:function(e){SemTagSvcPortal.clearEventWatch(e,"click",SemTagMenu.click,!1),SemTagSvcPortal.clearEventWatch(e,"keydown",SemTagMenu.catchEscape,!1),SemTagSvcPortal.clearEventWatch(e,"keyup",SemTagMenu.catchKeyup,!1)},nls:{hover_label:SemTagSvcPortalGlobal.hover_label_menu,a11y_hover:SemTagSvcPortalGlobal.a11y_hover,a11y_photo:SemTagSvcPortalGlobal.a11y_photo,a11y_close:SemTagSvcPortalGlobal.a11y_close,ally_expandImage:SemTagSvcPortalGlobal.ally_expandImage,ally_collapsedImage:SemTagSvcPortalGlobal.ally_collapsedImage,ally_showMore:SemTagSvcPortalGlobal.ally_showMore,ally_showLess:SemTagSvcPortalGlobal.ally_showLess,ally_buisnessCardLabel:SemTagSvcPortalGlobal.ally_buisnessCardLabel,ally_moreAction:SemTagSvcPortalGlobal.ally_moreAction},hoverDimension:[14,14],hoverOffset:[15,-1],menuOffset:[15,-1],writeHover:function(e,t,a){e.write("<div class='"+SemTagMenu.iconName+"' style='cursor:pointer;'>"+a+"</div>")},startMenu:function(e,t){e.write("<div class='personMenu' id='personMenuID'><ul style='padding:0px;margin:0px;list-style-type:none;float:left;'title='Person card dialog' alt='Person card dialog'><li tabindex=0 onkeydown=\"SemTagMenu.catchEscape();\" onkeyup=\"SemTagMenu.catchKeyup();\"></li></ul>")},writeHeader:function(e,t,a){e.write("<div class='semtag_header'>"+t.markup+"</div>")},startActionSection:function(e,t,a,r){for(a||(a="personMenuActions"),e.write("<div id='lessItem' style='display:block'><table class='personMenuActions' id='menuItemID' dir='"+t+"'><tr >"),0<SemTagMenu.items.length&&(tempitem=SemTagMenu.items.shift(),e.write("<td style='width:10'><a href='#' onClick='"+tempitem.href+";return false;' style='color:#105ec1;padding-top:5px;padding-bottom:5px;font-size:1.0em;'> "+tempitem.label+"</a></td>")),r.length>=1&&(e.write("<td style='width:1'><img src= '"+SemTagMenu.verticalRulerUrl+"' /> </td> "),e.write("<td ><a href='#' style='color:#105ec1;padding-top:5px;padding-bottom:5px;font-size:1.0em;width:90;'onClick=\"SemTagMenu.shtest();return false;\" onKeydown=\" if (event.keyCode==13){SemTagMenu.shtest();return false; }\"><label id='actionMore'>"+SemTagMenu.nls.ally_moreAction+"</label><span style='position: absolute; top: -9000px;'>Press Enter for more actions items and tab to move the focus on items</span><img style='border:none;' src='"+SemTagMenu.moreActionImgUrl+"' title='"+SemTagMenu.nls.ally_collapsedImage+" ' /></a></td>")),e.write("</tr></table></div>"),e.write("<div id='moreItem' style='display:none'><table id='moreActionItems' class='"+a+"' dir='"+t+"'>");0<SemTagMenu.items.length;)(r=SemTagMenu.items.shift()).href&&r.href.indexOf("mailto:")>-1?e.write("<tr ><td><a href='"+r.href+"'>"+r.label+"</a></td></tr>"):e.write("<tr ><td><a  onclick='"+r.href+";return false;' href='javascript;'>"+r.label+"</a></td></tr>");e.write("</table></div>")},writeFooter:function(e,t,a){e.write("<div class='semtag_footer'>"+t.markup+"</div>")},endMenu:function(e,t){e.write("<a style='width:0px; height:0px;' onblur=\"SemTagMenu.exitCard();\" onclick='return false;' href='exit from person card' title='exit from person card'></a></div>")},out:function(){this.buffer="",this.write=function(e){this.buffer+=e}},activateHover:function(e){var t=SemTagSvcPortal.getElementFromEvent(e);t&&(t.src=SemTagSvcPortalGlobal.contextUrl+"/ui/menu_selected_hover.gif"),SemTagMenu.setCurrentElement(SemTagMenu.findLiveElementFromEventSource(t))},deactivateHover:function(e){var t=SemTagSvcPortal.getElementFromEvent(e);t&&(t.src=SemTagSvcPortalGlobal.contextUrl+"/ui/menu_selected.gif")},showHover:function(e,t,a){if(!SemTagMenu.staticHover){var r=SemTagMenu.getMenuTag();if(!SemTagMenu.showing||"none"==r.style.display){SemTagSvcPortal.trace&&SemTagUtil.log("Menu.showHover");var n=SemTagSvcPortal.getElementFromEvent(e);SemTagSvcPortal.trace&&SemTagUtil.log("currentElem="+SemTagMenu.currentElem);var o=0;if(n&&n!=SemTagMenu.currentElem){if(SemTagMenu.clearAllSvcHandlers(r),o=n.getAttribute(SemTagSvcPortal.refcntAttr),SemTagSvcPortal.trace&&SemTagUtil.log("refcnt="+o),!o)return SemTagSvcPortal.debug&&alert("SemTagMenu.showHover called for a DOM element with no refcnt attribute!"),void SemTagMenu.setCurrentElement(null);SemTagMenu.setCurrentElement(n)}if(SemTagMenu.addSvcHandler(r,t),a&&0<a.length&&(SemTagMenu.currentHoverLabel=a),SemTagMenu.refCount--,!(0<SemTagMenu.refCount)){SemTagMenu.setRefCount(0<o?o:Number(n.getAttribute(SemTagSvcPortal.refcntAttr))),SemTagMenu.showing=!1,"focus"==e.type&&(SemTagMenu.a11yMode=!0,SemTagSvcPortal.watchEvent(n,"keydown",SemTagMenu.a11y,!1));var l=new SemTagMenu.out;a=SemTagMenu.currentHoverLabel?SemTagMenu.currentHoverLabel:SemTagMenu.nls.hover_label;SemTagMenu.writeHover(l,SemTagSvcPortal.bidi,a),SemTagSvcPortalGlobal.isPersonCardHandlerRequired&&availAttrib.retrieveAttribute(),SemTagMenu.offScreen(r),r.innerHTML=l.buffer;var i=SemTagSvcPortal.findPosition(SemTagMenu.currentElem,!1),s="rtl"==SemTagSvcPortal.bidi?0-SemTagMenu.hoverOffset[0]:SemTagMenu.hoverOffset[0];SemTagMenu.show(SemTagMenu.id,e,i[0]+s,i[1]+SemTagMenu.hoverOffset[1],r.offsetWidth,r.offsetHeight)}}}},addSvcHandler:function(e,t){SemTagMenu.svcHandlers.push(t),SemTagSvcPortal.watchEvent(e,"click",t,!1)},clearAllSvcHandlers:function(e){for(;0<SemTagMenu.svcHandlers.length;){var t=SemTagMenu.svcHandlers.pop();t&&SemTagSvcPortal.clearEventWatch(e,"click",t,!1)}},setCurrentElement:function(e){for(SemTagMenu.currentElem=e,SemTagMenu.setRefCount(e?Number(e.getAttribute(SemTagSvcPortal.refcntAttr)):0),SemTagMenu.currentHoverLabel=null;0<SemTagMenu.headers.length;)SemTagMenu.headers.pop();for(;0<SemTagMenu.items.length;)SemTagMenu.items.pop();for(;0<SemTagMenu.footers.length;)SemTagMenu.footers.pop()},setRefCount:function(e){SemTagMenu.refCount=e},setMenuData:function(e,t,a,r,n){if(SemTagSvcPortal.debug&&(window.status="Menu.setMenuData: items.length="+(t?t.length:0)),!SemTagMenu.staticHover&&SemTagMenu.refCount<0)SemTagSvcPortal.debug&&alert("setMenuData called when refCount="+SemTagMenu.refCount);else{var o=SemTagMenu.findLiveElementFromEventSource(SemTagSvcPortal.getElementFromEvent(e));if(o){if(SemTagMenu.staticHover&&(o!=SemTagMenu.currentElem||SemTagMenu.showing)&&SemTagMenu.setCurrentElement(o),t)for(var l=0;l<t.length;l++)SemTagMenu.items.push(t[l]);if(a&&(SemTagMenu.currentMenuCss=a),r&&SemTagMenu.headers.push(r),n&&SemTagMenu.footers.push(n),SemTagMenu.refCount--,!(0<SemTagMenu.refCount)){SemTagMenu.stopEvent(e);for(var i=0;i<SemTagSvcPortal.specialMenuProviders.length;i++){var s=SemTagSvcPortal.specialMenuProviders[i].call(e,SemTagMenu.currentElem);if(s&&0<s.length)for(var c=0;c<s.length;c++)SemTagMenu.items.push(s[c])}SemTagMenu.showMenu(e)}}else SemTagSvcPortal.debug&&alert("setMenuData called on a null live element")}},getCurrentElement:function(){return SemTagMenu.currentElem},showMenu:function(e){if(0!=SemTagMenu.headers.length+SemTagMenu.items.length+SemTagMenu.footers.length){SemTagSvcPortal.trace&&SemTagUtil.log("Menu.showMenu"),SemTagMenu.items.sort(SemTagSvcPortal.sortByOrder),1<SemTagMenu.headers.length&&SemTagMenu.headers.sort(SemTagSvcPortal.sortByOrder),1<SemTagMenu.footers.length&&SemTagMenu.footers.sort(SemTagSvcPortal.sortByOrder);var t=new SemTagMenu.out;SemTagMenu.startMenu(t,SemTagSvcPortal.bidi),0<SemTagMenu.headers.length&&SemTagMenu.writeHeader(t,SemTagMenu.headers[0],SemTagSvcPortal.bidi),SemTagMenu.startActionSection(t,SemTagSvcPortal.bidi,SemTagMenu.currentMenuCss,SemTagMenu.items),0<SemTagMenu.footers.length&&SemTagMenu.writeFooter(t,SemTagMenu.footers[0],SemTagSvcPortal.bidi),SemTagMenu.endMenu(t,SemTagSvcPortal.bidi);var a=SemTagMenu.getMenuTag();if(SemTagMenu.clearAllSvcHandlers(a),SemTagMenu.offScreen(a),a.innerHTML=t.buffer,SemTagMenu.showing=!0,SemTagMenu.defaultCursor(),SemTagMenu.a11yMode)if(SemTagUtil.isGecko){var r=a.getElementsByTagName("li");0<r.length&&r[0].focus()}else a.focus();SemTagMenu.registerMenuEventHandlers(document);var n=SemTagSvcPortal.findPosition(SemTagMenu.currentElem,!1),o="rtl"==SemTagSvcPortal.bidi?0-SemTagMenu.menuOffset[0]:SemTagMenu.menuOffset[0];SemTagMenu.show(SemTagMenu.id,e,n[0]+o,n[1]+SemTagMenu.menuOffset[1],a.offsetWidth,a.offsetHeight)}else SemTagMenu.hide()},getMenuTag:function(){var e=document.getElementById(SemTagMenu.id);return e||((e=document.createElement("div")).setAttribute("id",SemTagMenu.id),e.style.position="absolute",e.style.display="none",e.style.zIndex="99999",SemTagSvcPortal.watchEvent(e,"mouseout",SemTagMenu.mouseout,!1),SemTagSvcPortal.watchEvent(e,"mouseover",SemTagMenu.mouseover,!1),document.body.insertBefore(e,document.body.firstChild)),e},show:function(e,t,a,r,n,o){var l,i;SemTagSvcPortal.trace&&SemTagUtil.log("SemTagUtil.show"),SemTagMenu.clearTimeouts();var s=document.getElementById(e);if(null==n&&(n=0),null==o&&(o=0),null!=a&&null!=r)var c=r,m=a-("rtl"==SemTagSvcPortal.bidi?n:0);else c=SemTagSvcPortal.getEventAbsoluteY(t),m=SemTagSvcPortal.getEventAbsoluteX(t);var g=SemTagMenu.currentElem;mytest=g.parentNode;var S,u,d=document;void 0!==window.innerWidth?(S=window.innerWidth,u=window.innerHeight):d.documentElement&&void 0!==d.documentElement.clientWidth&&0!=d.documentElement.clientWidth?(S=d.documentElement.clientWidth,u=d.documentElement.clientHeight):d.body&&void 0!==d.body.clientWidth&&(S=d.body.clientWidth,u=d.body.clientHeight);var v=document.body.scrollLeft>document.documentElement.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft;m+n>S+v&&(m-=m+n-S-v);var T=document.body.scrollTop>document.documentElement.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;c+o>u+T&&(c-=c+o-u-T);if("rtl"==SemTagSvcPortal.bidi&&m<0&&(m=0),SemTagUtil.getOwnerDocument(g).location!=document.location){var f=SemTagUtil.getFrameElement(g);if(f){for(var p=f.offsetParent,h=0,P=0;p;)h+=p.offsetLeft,P+=p.offsetTop,p=p.offsetParent;for(var b=g.offsetParent,_=0,y=0;b;)_+=b.offsetLeft,y+=b.offsetTop,b=b.offsetParent;"wpsFLY_flyoutIFrame"==f.id?(c=P+y+g.offsetHeight,m=h+_+g.offsetWidth):(c+=f.offsetTop,m+=f.offsetLeft),SemTagUtil.isGecko&&"wpsFLY_flyoutIFrame"==f.id&&(i=f.contentWindow.pageXOffset,l=f.contentWindow.pageYOffset),SemTagUtil.isGecko||"wpsFLY_flyoutIFrame"!=f.id||(i=f.contentWindow.document.body.parentNode.scrollLeft,l=f.contentWindow.document.body.parentNode.scrollTop),c-=l,m-=i}}s.style.top=c+"px",s.style.left=m+"px",s.style.display="block",SemTagMenu.startHideTimer(e)},hide:function(e,t){SemTagMenu.unregisterMenuEventHandlers(document);var a=SemTagMenu.getMenuTag();if(!a)return!1;if(SemTagSvcPortal.trace&&SemTagUtil.log("Menu.hide"),"block"!=a.style.display)return!1;a.style.display="none",SemTagMenu.showing=!1;try{SemTagMenu.getNextEle(mytest)}catch(t){}return SemTagMenu.setCurrentElement(null),SemTagMenu.currentHoverLabel=null,SemTagMenu.clearAllSvcHandlers(a),SemTagMenu.a11yMode=!1,SemTagMenu.defaultCursor(),!0},getNextEle:function(e){for(var t=e.parentNode;;){if(null==t||"undefined"==t)return!1;if("BODY"==t.nodeName)return t;var a=t.nextSibling;if(null!=a)return a;t=t.parentNode}return!1},offScreen:function(e){e.style.top="-1000px",e.style.left="-1000px",e.style.display="block"},findLiveElementFromEventSource:function(e){if(SemTagMenu.staticHover){var t=e.id;if(!t.match(SemTagMenu.hoverIdRE))for(var a=e.getElementsByTagName("img"),r=0;r<a.length;r++)if(a[r].id&&a[r].id.match(SemTagMenu.hoverIdRE)){t=a[r].id;break}if(t&&0<t.length){var n=t.substr(SemTagSvcPortal.hoverIdPrefix.length);return document.getElementById(SemTagSvcPortal.liveElemPrefix+n)}return e}var o=SemTagMenu.getCurrentElement();return o||e},findHoverFromLiveElement:function(e){var t=e.getAttribute(SemTagSvcPortal.hoverIdPrefix+"idx");return document.getElementById(SemTagSvcPortal.hoverIdPrefix+t)},inMenu:function(e,t,a,r){if(!e)return!1;if(!SemTagMenu.showing)return!1;a||(a=0),r||(r=0);var n=SemTagSvcPortal.getEventAbsoluteX(t),o=SemTagSvcPortal.getEventAbsoluteY(t),l=e.style.left.replace(/px$/,""),i=e.style.top.replace(/px$/,""),s=parseInt(l)+parseInt(e.clientWidth),c=parseInt(i)+parseInt(e.clientHeight);return!(n-1<=l-a||o-1<=i-r||n>=s+a||o>=c+r)},mouseout:function(e){if(SemTagSvcPortal.trace&&SemTagUtil.log("Menu.mouseout"),"blur"==e.type){var t=SemTagSvcPortal.getElementFromEvent(e);SemTagMenu.currentElem&&(SemTagSvcPortal.trace&&SemTagUtil.log("clearEventWatch"),SemTagSvcPortal.clearEventWatch(SemTagMenu.currentElem,"keydown",SemTagMenu.a11y,!1)),SemTagMenu.showing||(SemTagSvcPortal.trace&&SemTagUtil.log("dismissing hover"),t.className.match(SemTagMenu.iconNameRE)||SemTagMenu.hide())}else{var a=SemTagMenu.id;menuElem=document.getElementById(a),SemTagMenu.inMenu(menuElem,e)||SemTagMenu.startHideTimer(a)}},mouseover:function(e){SemTagMenu.clearTimeouts()},click:function(e){if(e){var t=SemTagSvcPortal.getElementFromEvent(e),a=SemTagSvcPortal.getParentByClassName("semtag_header",t),r=SemTagSvcPortal.getParentByClassName("personMenuActions",t);a||r||SemTagMenu.hide(SemTagMenu.id)}},catchKeyup:function(e){var t,a=!1;e&&(t=e.which?e.which:e.keyCode),SemTagSvcPortal.trace&&SemTagUtil.log("Menu.catchKeyup:key="+t),document.activeElement.className.indexOf("lotusui")>-1&&(a=!0),16==t&&a&&SemTagMenu.sftflag&&SemTagMenu.exitCard(),SemTagMenu.sftflag=!1},catchEscape:function(e){var t;if(e&&(t=e.which?e.which:e.keyCode),SemTagSvcPortal.trace&&SemTagUtil.log("Menu.catchEscape:key="+t),16==t&&(SemTagMenu.sftflag=!0),27==t){var a=null;if(SemTagMenu.showing){var r=SemTagMenu.getCurrentElement();r&&(a=SemTagSvcPortal.getHoverElement(r))}SemTagMenu.hide(),a&&a.focus()}},a11y:function(e){var t,a;if(e){if(t=e.which?e.which:e.keyCode,SemTagSvcPortal.trace&&SemTagUtil.log("Menu.a11y:key="+t),13==t&&(a=SemTagSvcPortal.getElementFromEvent(e))){SemTagMenu.a11yMode=!0;var r=SemTagMenu.staticHover?a:SemTagMenu.getMenuTag();if(SemTagUtil.isGecko){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),SemTagUtil.fireEvent(r,n)}else r.click();SemTagMenu.stopEvent(e)}}else if(a=SemTagMenu.currentElem){SemTagMenu.a11yMode=!0;r=SemTagMenu.staticHover?a:SemTagMenu.getMenuTag();if(SemTagUtil.isGecko){var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!0),SemTagUtil.fireEvent(r,o)}else r.click();SemTagMenu.stopEvent(n)}return!0},stopEvent:function(e){if(e)if(SemTagUtil.isGecko)try{e.preventDefault(),e.stopPropagation()}catch(e){}else try{e.returnValue=!1,e.cancelBubble=!0}catch(e){SemTagSvcPortal.trace&&SemTagUtil.log("stopEvent caught "+e)}},startHideTimer:function(e){0<SemTagMenu.hideDelay&&!SemTagMenu.a11yMode&&!SemTagSvcPortal.debug&&SemTagMenu.timeouts.push(window.setTimeout('SemTagMenu.endHideTimer("'+e+'")',SemTagMenu.hideDelay))},endHideTimer:function(e){SemTagSvcPortal.trace&&SemTagUtil.log("Menu.endHideTimer"),SemTagMenu.hide(e)},clearTimeouts:function(){var e=SemTagMenu.timeouts;for(i=0;i<e.length;i++)window.clearTimeout(e[i])},defaultCursor:function(){document.body.style.cursor="default"},waitCursor:function(){document.body.style.cursor="progress"},shtest:function(){var e=document.getElementById("lessItem"),t=document.getElementById("moreItem");e.style.display="none",t.style.display="block"},exitCard:function(){var e=null;if(SemTagMenu.showing){var t=SemTagMenu.getCurrentElement();t&&(e=SemTagSvcPortal.getHoverElement(t))}SemTagMenu.hide(),e&&e.focus()}};SemTagSvcPortalGlobal.isDynamicLoading&&SemTagSvcPortalGlobal.isPersonCardHandlerRequired&&window.setTimeout(SemTagMenu.init,SemTagSvcPortal.DELAY);var SemTagPerson={INLINE:"X-person-display-inline",activeElems:new Array,requestor:new SemTagUtil.crossDomainRequest,servletUrl:SemTagSvcPortalGlobal.wpsBaseURL+"/um/secure/users/profiles?expandRefs=true&includeAttributes=@@@AVAILATTRIBUTES@@@&searchAttributes=@@@QUERY@@@",servletUrlForUID:SemTagSvcPortalGlobal.wpsBaseURL+"/um/secure/users/profiles?@@@QUERY@@@&includeAttributes=@@@AVAILATTRIBUTES@@@",servletUrlForObjectId:SemTagSvcPortalGlobal.wpsBaseURL+"/um/secure/users/profiles/@@@UserObjectID@@@?expandRefs=true&includeAttributes=@@@AVAILATTRIBUTES@@@",reqMethod:eval("callUserProfileServlet"),photoUrl:SemTagSvcPortalGlobal.wpsBaseURL+"/um/secure/users/profiles/@@@ObjectID@@@/jpegPhoto?index=0",collapsedImgUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/imgcollapsed.gif",expandedImgUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/imgexpanded.gif",moreActionImgUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/ShowActions.gif",verticalRulerUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/Line_Tree.gif",profileImageUrl:SemTagSvcPortalGlobal.contextUrl+"/ui/Properties.gif",showImage:!1,init:function(){if(SemTagSvcPortal.trace&&console.log("Inside init of SemTagPerson.init()"),"true"==SemTagSvcPortal.ifConnUrlExists&&0==SemTagSvcPortal.isconnServerNew){if(0==eval("document.body != null"))return void SemTagPerson.processUntilAvailable(SemTagPerson.init,"(document.body != null)",null,null,null,null);SemTagPerson.loadScript()}if("true"==SemTagSvcPortal.ifConnUrlExists&&1==SemTagSvcPortal.isconnServerNew){if(0==eval("document.body != null"))return void SemTagPerson.processUntilAvailable(SemTagPerson.init,"(document.body != null)",null,null,null,null);SemTagSvcPortal.loadConnScript()}SemTagSvcPortal.setCallback("hcard",SemTagPerson.hcardsAdded),SemTagSvcPortal.setCallback("mailto",SemTagPerson.mailtosAdded),SemTagPerson.processHcards(SemTagSvcPortal.getNodes("hcard")),SemTagPerson.processMailtos(SemTagSvcPortal.getNodes("mailto")),SemTagSvcPortal.watchEvent(window,"load",SemTagPerson.clearInternalData,!1)},loadScript:function(){var e=document.createElement("script"),t=SemTagSvcPortal.connUrl;t+=-1==t.indexOf("?")?"?":"&",t+="lang="+SemTagSvcPortal.lang,e.src=t,document.body.insertBefore(e,document.body.firstChild)},clearInternalData:function(){for(var e=SemTagPerson.activeElems;0<e.length;)e.pop()},nls:{start_chat:SemTagSvcPortalGlobal.start_chat,add_to_contact:SemTagSvcPortalGlobal.add_to_contact,send_email:SemTagSvcPortalGlobal.send_email,view_person:SemTagSvcPortalGlobal.view_person,hover_label:SemTagSvcPortalGlobal.hover_label_person,work_location:SemTagSvcPortalGlobal.work_location,specify_email_if_connection:SemTagSvcPortalGlobal.specify_email_if_connection},getPersonResolverUrl:SemTagSvcPortalGlobal.getPersonResolverUrl,getMarkup:function(_4,_5,_6,_7,_8,_9){var _a="",_b=void 0!==_4.email&&_4.email.internet?_4.email.internet:null;if("true"!=SemTagSvcPortal.ifConnUrlExists||null==_b){if(_4._profileinplace){var _c=_4.uid.replace(/\\/g,"&perc5C");_a='javascript:SemTagPerson.executeJSTargetInFrame("javascript:doShowProfile(\\"'+_c+'\\")")'}else _a="javascript:SemTagPerson.openPersonRecord()";_6.push(SemTagSvcPortal.getMenuItemJson(SemTagPerson.nls.view_person,_a,-100))}if(_b&&_6.push(SemTagSvcPortal.getMenuItemJson(SemTagPerson.nls.send_email,"mailto:"+_b,-90)),SemTagSvcPortal.debug&&console.log("ST Status got in person1.jsp is:"+typeof SemTagAwrns!="undefined"&&void 0!==_4.X.ststatus),SemTagSvcPortal.debug&&console.log(_4.X.ststatus+":"+("online"==_4.X.ststatus||"away"==_4.X.ststatus)),SemTagSvcPortal.sametimeSTProxy){var _d='javascript:SemTagAwrns.openAddToContacts("'+_4.X.imn+'")';_6.push(SemTagSvcPortal.getMenuItemJson(stproxy.uiControl.i18nStrings.contextMenuAddToContacts,_d,-40))}if(void 0!==SemTagAwrns&&void 0!==_4.X.ststatus&&("online"==_4.X.ststatus||"away"==_4.X.ststatus)){var _e='javascript:SemTagAwrns.openChat("'+_4.X.imn+'")';if(_6.push(SemTagSvcPortal.getMenuItemJson(SemTagPerson.nls.start_chat,_e,-80)),SemTagSvcPortal.sametimeSTProxy){var _f='javascript:SemTagAwrns.openCall("'+_4.X.imn+'")',_10='javascript:SemTagAwrns.openInstantMeeting("'+_4.X.imn+'")',_11='javascript:SemTagAwrns.openSendAnnouncement("'+_4.X.imn+'")';_6.push(SemTagSvcPortal.getMenuItemJson(stproxy.uiControl.i18nStrings.contextMenuCall,_f,-70)),_6.push(SemTagSvcPortal.getMenuItemJson(stproxy.uiControl.i18nStrings.contextMenuInstantMeeting,_10,-60)),_6.push(SemTagSvcPortal.getMenuItemJson(stproxy.uiControl.i18nStrings.contextMenuSendAnnouncement,_11,-50))}SemTagSvcPortal.sametimeSTLinks&&_6.push(SemTagSvcPortal.getMenuItemJson(SemTagPerson.nls.add_to_contact,"javascript:SemTagPerson.addToSametimeList()",-11))}var _12=SemTagSvcPortal.getActions("person");if(_12)for(i=0;i<_12.length;i++){var _13=_12[i].showif,_14=!0;if(_13)try{var _15=eval(_13);_14=_15.call(null,SemTagPerson.currentPerson)}catch(e){try{var _15=eval(_13);_14=_15.call(null,SemTagPerson.currentPerson)}catch(e){_14=!1}}if(_14){var _16=_12[i].label;if(_16.match(/nls\.[a-z]/)&&(_16=eval(_16)),!(_16.indexOf("Send Instant")>-1)){var _17=_12[i].url.replace(/@@@ARGS@@@/g,"SemTagPerson.currentPerson");_6.push(SemTagSvcPortal.getMenuItemJson(_16,_17,_12[i].order))}}}if(!_4._inline)if("true"==SemTagSvcPortal.ifConnUrlExists&&0==SemTagSvcPortal.isconnServerNew&&null!=_b)_8.write("<div class='popupPersonCard' id='businessCard'>"),_8.write("</div>");else{var _18="";void 0===SemTagAwrns||void 0===_4.X.ststatus||"online"!=_4.X.ststatus&&"away"!=_4.X.ststatus||(_18=_4.X.ststatus);var _19=null;_19=null!=_4.photo&&"undefined"!==_4.photo?_4.photo:"",_8.write("<div class ='businessCardMenu'>"),_8.write("<span class='photoCard' id ='imageSpan'><div id='imageDiv' style='height:90px; width:90px' >"),SemTagPerson.showImage&&_8.write("<img id='personImg' tabindex=0 style='border:1px solid rgb(192,192,192);float:right;padding:10px ; height:50px; width:50px; background-color:white;margin-right:6px' src='"+_19+"' onMouseover='SemTagPerson.imgHoverIn();return false;' alt='"+_4.fn+" "+SemTagMenu.nls.a11y_photo+"' title='"+_4.fn+" "+SemTagMenu.nls.a11y_photo+"'/>"),_8.write(" <img id='personImg1' tabindex=0 style='display:none;border:1px solid rgb(192,192,192);float:right;padding:10px ; height:82px; width:82px; background-color:white;margin-right:6px' src='"+_19+"' onMouseout='SemTagPerson.imgHoverOut();return false;' alt='"+_4.fn+" "+SemTagMenu.nls.a11y_photo+"' title='"+_4.fn+" "+SemTagMenu.nls.a11y_photo+"'/></div></span>"),_8.write("<div class='businessCard'><ul dir='"+_5+"'>"),_8.write("<li class='cardName' onkeydown=\"SemTagMenu.catchEscape();\" onkeyup=\"SemTagMenu.catchKeyup();\"><a href='#' style='text-Decoration:none;color:black'>"+_4.fn+"</a></li>"),void 0===SemTagAwrns||void 0===_4.X.ststatus||"online"!=_4.X.ststatus&&"away"!=_4.X.ststatus||_8.write("<span id='statusIcon' style='vertical-align:text-top'><a href='#' style='text-Decoration:none;color:black'>"+SemTagAwrns.st+_18+"</a></span>"),SemTagSvcPortalGlobal.debug&&console.log("person got in getMarkUp method is:"+_4),null!=SemTagSvcPortalGlobal.collapsedItems&&_8.write(SemTagPerson.getItemsAsHtml(SemTagSvcPortalGlobal.collapsedItems,"collapsed")),_8.write("</ul></div>"),SemTagSvcPortalGlobal.showDetailsFlag&&(_8.write("<div class='showMoreDiv'>"),_8.write("<span><img tabIndex=0 id='expCollapImg' src='"+SemTagPerson.collapsedImgUrl+"' title='"+SemTagMenu.nls.ally_collapsedImage+" ' onClick='SemTagPerson.imgClicked();' onKeydown='SemTagPerson.imgClicked();'/><label id='toggleLabel' class='showMoreLabel'>"+SemTagMenu.nls.ally_showMore+"</label></font></span>"),_8.write("</div>")),_8.write("<div class='businessCardExtended' id='expandedSection' style='display:none'><ul style='padding-top:5px;align:left;' dir='"+_5+"'>"),null!=SemTagSvcPortalGlobal.expandedItems&&_8.write(SemTagPerson.getItemsAsHtml(SemTagSvcPortalGlobal.expandedItems,"expanded")),_8.write("</ul></div>"),_8.write("</div>")}},getItemsAsHtml:function(_1a,_1b){var _1c=new String("");if(null!=_1a){var _1d=_1a.split(","),i=0;for(SemTagSvcPortal.debug&&console.log("Length of card items got is:"+_1d.length);i<_1d.length;){var _1e=_1d[i].replace(/^\s+|\s+$/g,""),_1f=new String("");if(_1e.match("businessCategory")?_1f=".category":_1e.match("carLicense")?_1f=".X.carlicense":_1e.match("cn")&&2==_1e.length?_1f=".fn":_1e.match("countryName")?_1f=".adr.countryname":_1e.match("departmentNumber")?_1f=".X.departmentnumber":_1e.match("description")?_1f=".note":_1e.match("displayName")?_1f=".fn":_1e.match("employeeNumber")?_1f=".X.employeenumber":_1e.match("employeeType")?_1f=".X.employeetype":_1e.match("facsimileTelephoneNumber")?_1f=".tel.fax":_1e.match("givenName")?_1f=".n.givenname":_1e.match("homePostalAddress")?_1f=".X.homeaddress":_1e.match("ibm-gender")?_1f=".X.gender":_1e.match("ibm-generationQualifier")?_1f=".n.honorificsuffix":_1e.match("ibm-hobby")?_1f=".X.hobby":_1e.match("ibm-jobTitle")?_1f=".title":_1e.match("ibm-middleName")?_1f=".n.additionalname":_1e.match("ibm-otherEmail")?_1f=".email.X_notes":_1e.match("ibm-personalTitle")?_1f=".n.honorificprefix":_1e.match("ibm-primaryEmail")||_1e.match("mail")&&4==_1e.length?_1f=".email.internet":_1e.match("ibm-regionalLocale")?_1f=".X.locale":_1e.match("ibm-timeZone")?_1f=".tz":_1e.match("initials")?_1f=".X.initials":_1e.match("localityName")?_1f=".adr.locality":_1e.match("manager")?_1f=".X.manager":_1e.match("mobile")?_1f=".tel.cell":_1e.match("o")&&1==_1e.length?_1f=".org.name":_1e.match("ou")&&2==_1e.length?_1f=".org.unit":_1e.match("pager")?_1f=".tel.pager":_1e.match("postalAddress")?_1f=".X.fulladdress":_1e.match("postalCode")?_1f=".adr.postalcode":_1e.match("preferredLanguage")?_1f=".X.language":_1e.match("roomNumber")?_1f=".adr.extendedaddress":_1e.match("secretary")?_1f=".X.secretary":_1e.match("seeAlso")?_1f=".url":_1e.match("sn")&&2==_1e.length?_1f=".n.familyname":_1e.match("stateOrProvinceName")?_1f=".adr.region":_1e.match("street")?_1f=".adr.streetaddress":_1e.match("telephoneNumber")?_1f=".tel.voice":_1e.match("uid")&&3==_1e.length&&(_1f=".uid"),0<_1f.length){for(var _20=new String(""),pos=_1f.indexOf(".",1);-1!=pos;)0<_20.length&&(_20+=" && "),_20+="SemTagPerson.currentPerson"+_1f.substring(0,pos),pos=_1f.indexOf(".",pos+1);0<_20.length&&(_20+=" && "),_20+="SemTagPerson.currentPerson"+_1f;var _21=0;_1b.match("expanded")&&(_21=0),_1b.match("collapsed")&&(_21=1),SemTagSvcPortal.debug&&console.log(_20.toString()),SemTagSvcPortal.debug&&console.log(eval(_20.toString()));var _22="<li +tabindex="+_21+" style='padding-bottom:3px'> "+eval(_20.toString())+"</li>";-1!=_1e.indexOf("mail")&&(_22="<li><a href='mailto: "+eval(_20.toString())+"'> "+eval(_20.toString())+"</a></li>"),eval(_20.toString())&&(_1c+=_22)}i++}}return _1c},imgClicked:function(){var e=document.getElementById("expCollapImg"),t=document.getElementById("toggleLabel"),a=document.getElementById("expandedSection"),r=navigator.appName;a.style.width="Netscape"==r?"240":"378",e.src.indexOf(SemTagPerson.expandedImgUrl)>1?(e.src=SemTagPerson.collapsedImgUrl,e.title=SemTagMenu.nls.ally_collapsedImage,t.innerHTML=SemTagMenu.nls.ally_showMore):(e.src=SemTagPerson.expandedImgUrl,e.title=SemTagMenu.nls.ally_expandImage,t.innerHTML=SemTagMenu.nls.ally_showLess);var n=document.getElementById("expandedSection");n.style.display="none"!=n.style.display?"none":""},imgHoverIn:function(){var e=document.getElementById("personImg"),t=document.getElementById("personImg1");e.style.display="none",t.style.display=""},imgHoverOut:function(){var e=document.getElementById("personImg"),t=document.getElementById("personImg1");e.style.display="",t.style.display="none"},getInlineMarkup:function(e,t,a){var r=e.email.internet;a.write("<div class='personMenu'>"),a.write("<div class='photoCard'><img src='"+e.photo+"' alt=''/></div>"),a.write("<div class='businessCard' dir='"+t+"'>");var n=e._headeronly?"class='vcard X-person-inside-inline'":"";a.write("<ul "+n+" dir='"+t+"'>"),a.write("<li class='cardName'><span class='fn'>"+e.fn+"</span></li>"),a.write("<li class='email'><span class'type' style='display:none;'>internet</span><span class='value'>"+r+"</span></li>"),e.title&&a.write("<li>"+e.title+"</li>"),e.tel&&e.tel.voice&&a.write("<li>"+e.tel.voice+"</li>"),a.write("</ul>"),a.write("</div>"),e._headeronly?a.write("<div style='clear:both;'>"):(a.write("<div class='personMenuActions' dir='"+t+"' style='clear:both;'>"),a.write("<ul>"),a.write("<li><a href='NEEDSWORK'>"+SemTagPerson.nls.view_person+"</a></li>"),a.write("<li><a href='mailto:"+r+"'>"+SemTagPerson.nls.send_email+"</a></li>"),a.write("<li><a href='NEEDSWORK'>"+SemTagPerson.nls.add_to_contact+"</a></li>"),a.write("</ul>")),a.write("</div>"),a.write("</div>")},openPersonRecord:function(){var e=SemTagPerson.currentPerson,t=null;"undefined"!=e.uid&&e.uid.length>0?t=e.uid:void 0!==e.email&&void 0!==e.email.internet&&0<e.email.internet.length&&(t=e.email);var a=encodeURIComponent(t),r=encodeURIComponent(a);SemTagSvcPortal.debug&&console.log("userId3is :"+r+":"+SemTagPerson.currentPerson.fn+":"+SemTagPerson.getPersonResolverUrl()+":"),SemTagSvcPortal.debug&&console.log("NEWReplaced string is:"+SemTagPerson.getPersonResolverUrl().replace("TOBEREPLACED",r)),window.open(SemTagPerson.getPersonResolverUrl().replace("TOBEREPLACED",r),null,"height=640,width=512,resizable=yes,scrollbars=yes,status=yes,toolbar=no,menubar=no,location=no")},addToSametimeList:function(){var e=SemTagPerson.currentPerson.email.internet,t=encodeURIComponent(SemTagPerson.currentPerson.fn),a=encodeURIComponent(t);window.open(SemTagPerson.getPersonResolverUrl().replace("TOBEREPLACED",e+"/"+a),null,"height=640,width=512,resizable=yes,scrollbars=yes,status=yes,toolbar=no,menubar=no,location=no")},out:function(){this.buffer="",this.write=function(e){this.buffer+=e}},processHcards:function(_36){if(SemTagSvcPortal.trace&&console.log("Inside processHcards of SemTagSerson and length of hcards is:"+(_36?_36.length:0)),_36&&0!=_36.length)for(var i=0;i<_36.length;i++){var _37=_36[i],_38=SemTagPerson.getNameElement(_37);if(_38){if("true"==SemTagSvcPortal.ifConnUrlExists&&!SemTagSvcPortal.isconnServerNew){var _39=SemTagUtil.getHcardAttributeValue("email",_37);if(!_39.internet){var uid=SemTagUtil.getHcardAttributeValue("uid",_37);if(!uid)continue}}var _3a=_38.getAttribute(SemTagSvcPortal.liveElemPrefix+"id");if(_3a&&"false"==SemTagSvcPortal.ifConnUrlExists){if(SemTagPerson.activeElems[_3a])continue;SemTagSvcPortal.trace&&SemTagUtil.log("Person.leid="+_3a+" being processed again!")}else{if("true"==SemTagSvcPortal.ifConnUrlExists&&!SemTagSvcPortal.isconnServerNew){var _3b=SemTagSvcPortal.getElementsByClassName("email",_37);_3b=_3b||null,null!=_3b&&0!=_3b.length||"true"!=SemTagSvcPortal.ifConnUrlExists||!1!==SemTagSvcPortal.isconnServerNew||console.info(SemTagPerson.nls.specify_email_if_connection+"Email is for user:"+uid)}if("true"==SemTagSvcPortal.ifConnUrlExists&&SemTagSvcPortal.isconnServerNew){SemTagSvcPortal.debug&&console.log("Beofore calling lconn.profiles.bizCard.bizCard.processTag");try{var _3c=SemTagSvcPortal.getElementsByClassName("userObjectId",_37);SemTagSvcPortal.debug&&console.log("userObjectid element got is:"+_3c),0==eval("window.lconn != null")||null==lconn.profiles||"undefined"==lconn.profiles?SemTagPerson.processUntilAvailable(SemTagPerson.processHcards,"window.lconn != null && !(lconn.profiles == null || lconn.profiles == 'undefined')",null,null,null,_36):lconn.profiles.bizCard.bizCard.processTag(_38)}catch(e){return console.log("Connection server is probably down please check following resource is up:"+SemTagSvcPortalGlobal.connUrl+"/profiles/portalJS/portalBizCard.js"),void console.log("Actual Error occured is:"+e)}}if(SemTagPerson.isInline(_37)){var _3d={target:_38};SemTagPerson.requestPersonInfo(_3d)}else{var _3e=SemTagSvcPortal.getTextValue(_38),_3f=_3e.indexOf("click"),_40=_3e.substring(0,_3f)+SemTagPerson.nls.hover_label+" "+SemTagMenu.nls.a11y_hover;if("false"==SemTagSvcPortal.ifConnUrlExists||"true"==SemTagSvcPortal.ifConnUrlExists&&0==SemTagSvcPortal.isconnServerNew)SemTagSvcPortal.debug&&console.log("Adding hover for old business card case or no business card"),SemTagSvcPortal.addHover(_38,SemTagPerson.showHover,SemTagPerson.showMenu,_40);else{SemTagSvcPortal.debug&&console.log("Inside  ifConnURLExistsnew"+SemTagSvcPortal.ifConnUrlExists+":"+SemTagSvcPortal.isconnServerNew);var _41=_38.getAttribute(SemTagSvcPortal.refcntAttr);_41?_38.setAttribute(SemTagSvcPortal.refcntAttr,parseInt(Number(_41)+1)):(_38.setAttribute(SemTagSvcPortal.refcntAttr,"1"),SemTagSvcPortal.hoverIdx++,_38.setAttribute(SemTagSvcPortal.liveElemPrefix+"id",SemTagSvcPortal.hoverIdx))}_3a=_38.getAttribute(SemTagSvcPortal.liveElemPrefix+"id"),SemTagSvcPortal.debug&&console.log("in semtagperson leid got is:"+_3a),_3a&&(SemTagPerson.activeElems[_3a]=!0)}}}}},processUntilAvailable:function(_42,_43,_44,_45,_46,_47){if("function"==typeof _42){var _48=500,_49=20,_4a=!0;"number"==typeof _45&&(_48=_45),"number"==typeof _46&&(_49=_46),"boolean"==typeof _44&&(_4a=_44);var _4b="",_4c=0;console.log("eval(test) is :"+eval(_43));var _4d=Array.prototype.slice.call(arguments),_4e=_4d.shift(),_4f=_4d.shift(),_50=_4d.shift(),_51=_4d.shift(),_52=_4d.shift();SemTagSvcPortal.trace&&console.log("shifted args length is:"+_4d.length+":"+_4d),eval(_43)?null!=_47?_42.apply(null,Array.prototype.slice.call(_4d)):_42():(SemTagSvcPortal.trace&&console.log("inside processUntilAvailable for time :"+_4c+":"+eval(_43)+":clearing intervalid:"+_4b),_4b=window.setInterval((function(){if(_4c++,SemTagSvcPortal.trace&&console.log("inside processUntilAvailable for time :"+_4c+":"+eval(_43)+":clearing intervalid:"+_4b),eval(_43))window.clearInterval(_4b),null!=_47?_42.apply(null,Array.prototype.slice.call(_4d)):_42();else if(_4c>=_49&&(window.clearInterval(_4b),_4a))throw new Error("processUntilAvailable: test was never met: "+_43)}),_48))}},isInline:function(e){return SemTagUtil.getHcardAttributeValue(SemTagPerson.INLINE,e)},processMailtos:function(e){if(e&&0!=e.length)for(;e.length>0;){var t=e.pop();SemTagSvcPortal.watchEvent(t,"mouseover",SemTagPerson.tagMouseover,!1)}},hcardsAdded:function(e){SemTagSvcPortal.trace&&SemTagUtil.log("hcardsAdded"),SemTagSvcPortal.trace&&console.log("INside hcardsAdded length of nodes got it:"+SemTagSvcPortal.getNodes("hcard").length+":"+e),e&&e.length>0?SemTagPerson.processHcards(e):SemTagPerson.processHcards(SemTagSvcPortal.getNodes("hcard"))},hcardsAdded:function(){SemTagSvcPortal.trace&&SemTagUtil.log("hcardsAdded"),SemTagSvcPortal.trace&&console.log("INside hcardsAdded length of nodes got it:"+SemTagSvcPortal.getNodes("hcard").length),SemTagPerson.processHcards(SemTagSvcPortal.getNodes("hcard"))},mailtosAdded:function(){SemTagPerson.processMailtos(SemTagSvcPortal.getNodes("mailto"))},showHover:function(e){SemTagSvcPortal.trace&&SemTagUtil.log("Person.showHover");var t=SemTagUtil.getHcardAttributeValue("X-person-inside-inline",SemTagSvcPortal.getLiveElementFromEvent(e))?null:SemTagPerson.nls.hover_label;return SemTagSvcPortal.showHover(e,SemTagPerson.showMenu,t),!1},showMenu:function(e){return SemTagSvcPortal.trace&&SemTagUtil.log("Person.showMenu"),SemTagMenu.waitCursor(),SemTagMenu.stopEvent(e),SemTagPerson.requestPersonInfo(e),!1},renderCard:function(e){var t=new BusinessCard.out;BusinessCard.getMenuData(e,null,null,null,t),SemTagSvcPortal.trace&&console.log("Inside renderCard"+t.buffer+":"+document.getElementById("businessCard")),document.getElementById("businessCard").innerHTML=t.buffer},requestPersonInfo:function(e){SemTagPerson.reqMethod.call(SemTagPerson,e)},dispatch:function(e){var t=e.email&&e.email.internet?e.email.internet:null;t&&SemTagPerson.requestor.dispatch(t.toLowerCase(),e)},requestReturn:function(e,t,a){SemTagSvcPortal.trace&&SemTagUtil.log("Person.requestReturn: "+t+" ("+(e?"success":"fail")+")");var r=e?t:SemTagPerson.emptyPerson();if(r){var n=SemTagSvcPortal.getLiveElementFromEvent(a);SemTagPerson.fillPersonJsonMoreFromDom(r,n),SemTagPerson.update(r,n,a)}else SemTagMenu.defaultCursor()},fillPersonJsonMoreFromDom:function(e,t){SemTagSvcPortal.debug&&(window.status="Person.fillPersonJsonMoreFromDom");var a=SemTagSvcPortal.findNameElementInHcard(t);if(a){var r=SemTagSvcPortal.getTextValue(a),n=r.indexOf("click");e.fn=n>0?r.substring(0,n):SemTagSvcPortal.getTextValue(a)}var o=SemTagPerson.getElementEmail(t);o&&(e.email={internet:o});var l=SemTagUtil.getHcardAttributeValue("uid",t);l&&(e.uid=l);SemTagUtil.getHcardAttributeValue("userObjectId",t);if(SemTagSvcPortal.debug&&e&&console.log("person.photo got is:"+e.photoURL+(e.photo&&e.photo.length>0?"not null":"is not available")),e&&e.photo&&e.photo.length>0?(e.photo=e.photoURL,SemTagPerson.showImage=!0):SemTagPerson.showImage=!1,!e.tel||!e.tel.voice){var i=SemTagSvcPortal.findElementByNameInHcard(t,"tel");if(i){var s=SemTagSvcPortal.getTypedValue(i,"voice");e.tel={voice:s.voice}}}var c=SemTagSvcPortal.findElementByNameInHcard(t,"adr"),m={};if(c&&(m=SemTagPerson.getAddressJson(c),e.adr=m),void 0!==e.adr&&(e.adr.locality||e.adr.countryname||e.adr.region)){e.X||(e.X={});var g=e.adr.locality+", "+e.adr.region+" "+e.adr.countryname;e.X.worklocation=g.replace(/undefined/g,"")}void 0!==SemTagAwrns&&(e.X||(e.X={}),e.X.imn=SemTagAwrns.getSametimeId(t),e.X.ststatus=a.getAttribute("semtag_ststatus"))},emptyPerson:function(){return{fn:"",email:{internet:""}}},update:function(_71,_72,_73){SemTagSvcPortal.trace&&SemTagUtil.log("Person.update"),SemTagPerson.currentPerson=_71;var _74=SemTagSvcPortal.getParentByClassName("vcard",_72),_75=SemTagUtil.getHcardAttributeValue("X-person-header-only",_74);if(_75&&(_71._headeronly=!0),SemTagPerson.readHcardContext(_74,_71),SemTagSvcPortal.setSemanticTagValue("hcard",_72,_71),SemTagPerson.isInline(_74)){var out=new SemTagPerson.out;SemTagPerson.getInlineMarkup(_71,SemTagSvcPortal.bidi,out),_74.innerHTML=out.buffer;var _76=SemTagUtil.getNodeClassValue(_74);if(SemTagUtil.setNodeClassValue(_74,_76.replace(/vcard/,"vcard-done")),_75){var _77=SemTagSvcPortal.getElementsByClassName("vcard",_74,1);_77&&SemTagPerson.processHcards(_77)}}else{var _78=new Array,_79="personMenuActions",_7a=new SemTagPerson.out,_7b=new SemTagPerson.out;SemTagPerson.getMarkup(_71,SemTagSvcPortal.bidi,_78,_79,_7a,_7b);var _7c=void 0!==_71.email&&_71.email.internet?_71.email.internet:null;SemTagSvcPortal.setMenuData(_73,_78,_79,SemTagSvcPortal.getMenuHeaderJson(_7a.buffer,"text/html",-100),SemTagSvcPortal.getMenuFooterJson(_7b.buffer,"text/html",-100)),SemTagSvcPortal.trace&&console.log("values are in update of semtagperson:"+SemTagSvcPortal.ifConnUrlExists+":"+(!1===SemTagSvcPortal.isconnServerNew)),"true"==SemTagSvcPortal.ifConnUrlExists&&!1===SemTagSvcPortal.isconnServerNew&&null!=_7c&&(0==eval("window.BusinessCard != null")?SemTagPerson.processUntilAvailable(BusinessCard.getProfileInfo,"(window.BusinessCard != null)",null,null,null,!0,"SemTagPerson.renderCard",_7c):BusinessCard.getProfileInfo(!0,"SemTagPerson.renderCard",_7c))}},readHcardContext:function(e,t){SemTagUtil.getHcardAttributeValue("X-person-inside-inline",e)&&(t._inline=!0),SemTagUtil.getHcardAttributeValue("X-person-inside-profile",e)&&(t._inprofile=!0),SemTagUtil.getHcardAttributeValue("X-person-profile-inplace",e)&&(t._profileinplace=!0)},getElementEmail:function(e){var t;e||alert("getElementEmail called with: "+e);var a=SemTagSvcPortal.getParentByClassName("vcard",e);return a?t=(t=SemTagUtil.getHcardAttributeValue("email",a)).internet:"A"==e.tagName&&e.href.match(/^mailto:/)&&(t=e.href.replace(/^mailto:/,"")),t},getNameElement:function(e){try{"vcard"!=e.className&&(e=SemTagSvcPortal.getParentByClassName("vcard",e));var t=SemTagSvcPortal.getElementsByClassName("fn",e,1)[0];return t||(t=SemTagSvcPortal.getElementsByClassName("n",e,1)[0]),t}catch(e){SemTagSvcPortal.debug&&alert(e)}return null},getAddressJson:function(e){var t={postofficebox:"",streetaddress:"",locality:"",region:"",postalcode:"",countryname:""},a=e;if("adr"!=a.className&&(a=SemTagSvcPortal.getParentByClassName("adr",e)),a)for(var r=a.childNodes,n=0;n<r.length;n++)SemTagPerson.readAddressInfo(r[n],t);else t.streetaddress="5 Technology Park Drive",t.locality="Westford",t.region="MA",t.postalcode="01886",t.countryname="USA";return t},readAddressInfo:function(e,t){var a=e.childNodes;if(a)for(var r=0;r<a.length;r++)SemTagPerson.readAddressInfo(a[r],t);if(null!=e.className){var n=e.className;n.match(/(^|\s)post-office-box(\s|$)/i)?t.postofficebox=SemTagSvcPortal.getTextValue(e):n.match(/(^|\s)extenodeed-address(\s|$)/i)?t.extenodeedaddress=SemTagSvcPortal.getTextValue(e):n.match(/(^|\s)street-address(\s|$)/i)?t.streetaddress=SemTagSvcPortal.getTextValue(e):n.match(/(^|\s)locality(\s|$)/i)?t.locality=SemTagSvcPortal.getTextValue(e):n.match(/(^|\s)region(\s|$)/i)?t.region=SemTagSvcPortal.getTextValue(e):n.match(/(^|\s)postal-code(\s|$)/i)?t.postalcode=SemTagSvcPortal.getTextValue(e):n.match(/(^|\s)country-name(\s|$)/i)&&(t.countryname=SemTagSvcPortal.getTextValue(e))}},existsInObject:function(e,t){for(var a=t.split("."),r=e,n=!0,o=0;o<a.length;o++){var l;if(!r[l=a[o].indexOf("(")>-1?a[o].substr(0,a[o].indexOf("(")):a[o]]){n=!1;break}r=r[l]}return n},executeJSTargetInFrame:function(e){if(e.indexOf("javascript:")>-1){var t=e.substr(11),a=window;if(!SemTagPerson.existsInObject(window,t))for(var r=0;r<parent.frames.length;r++)if(SemTagPerson.existsInObject(parent.frames[r],t)){a=parent.frames[r];break}a.eval(e)}}};function getTagFromServer(e){var t=SemTagSvcPortal.getLiveElementFromEvent(e),a=SemTagPerson.getElementEmail(t);if(a){a=a.toLowerCase();var r=SemTagPerson.servletUrl.replace(/@@@EMAIL@@@/,a);SemTagSvcPortal.debug&&(window.status="Person.getTagFromServer sending request for: "+a+")"),SemTagPerson.requestor.request(r,6e3,SemTagPerson.requestReturn,t,a)}else{SemTagSvcPortal.debug&&alert("getTagFromServer couldn't find the e-mail");var n={target:t};SemTagPerson.requestReturn(!1,null,n)}}function callUserProfileServlet(_9a){SemTagSvcPortal.trace&&SemTagUtil.log("callUserProfileServlet");var _9b="",_9c=SemTagSvcPortal.getLiveElementFromEvent(_9a),_9d="",_9e=SemTagPerson.getElementEmail(_9c);_9e&&(_9d="ibm-primaryEmail="+_9e);var uid=SemTagUtil.getHcardAttributeValue("uid",_9c);uid&&(_9d="identifier="+uid),_9b=SemTagUtil.getHcardAttributeValue("userObjectId",_9c);var xml=null;try{if(0<_9b.length)SemTagPerson.servletUrlForObjectId=SemTagPerson.servletUrlForObjectId.replace("@@@AVAILATTRIBUTES@@@",SemTagSvcPortal.availAttribStr),xml=ibm.portal.xml.loadXml(SemTagPerson.servletUrlForObjectId.replace(/@@@UserObjectID@@@/,_9b));else if(uid&&uid.length>0){SemTagPerson.servletUrlForUID=SemTagPerson.servletUrlForUID.replace("@@@AVAILATTRIBUTES@@@",SemTagSvcPortal.availAttribStr);try{xml=ibm.portal.xml.loadXml(SemTagPerson.servletUrlForUID.replace("@@@QUERY@@@",_9d))}catch(e){SemTagSvcPortal.debug&&console.info("Person.callUserProfileServlet Error caught is: "+e),_9d=0==uid.indexOf("uid=")?uid:"uid="+uid,SemTagPerson.servletUrl=SemTagPerson.servletUrl.replace("@@@AVAILATTRIBUTES@@@",SemTagSvcPortal.availAttribStr),xml=ibm.portal.xml.loadXml(SemTagPerson.servletUrl.replace(/@@@QUERY@@@/,_9d))}}else SemTagPerson.servletUrl=SemTagPerson.servletUrl.replace("@@@AVAILATTRIBUTES@@@",SemTagSvcPortal.availAttribStr),xml=ibm.portal.xml.loadXml(SemTagPerson.servletUrl.replace(/@@@QUERY@@@/,_9d))}catch(e){SemTagSvcPortal.debug&&console.info("Person.callUserProfileServlet caught: "+e)}if(xml){if(0<_9b.length)var xsl=ibm.portal.xml.loadXsl(SemTagSvcPortalGlobal.contextUrl+"/xsl/UserAtomByIdToPersonJson.xsl");else var xsl=ibm.portal.xml.loadXsl(SemTagSvcPortalGlobal.contextUrl+"/xsl/UserAtomToPersonJson.xsl");var _9f=ibm.portal.xml.transform(xml,xsl,null,null,!0);SemTagSvcPortal.trace&&SemTagUtil.log(_9f);var _a0=eval(_9f)[0];return SemTagSvcPortal.trace&&console.log("Person got is:"+_a0),_a0||_a0.fn||(_a0=SemTagPerson.emptyPerson()),SemTagSvcPortal.trace&&console.log("person.photo is:"+_a0.photo),SemTagPerson.fillPersonJsonMoreFromDom(_a0,_9c),void SemTagPerson.update(_a0,_9c,_9a)}SemTagSvcPortal.trace&&SemTagUtil.log("bad XML");var evt={target:_9c};SemTagPerson.requestReturn(!1,null,evt)}SemTagPerson.init();var SemTagAwrns={SVCNAME:"sametime",hcards:new Array,activeElems:[],hasApplet:!1,imIds:SemTagSvcPortalGlobal.preferredImIds,st:"",samtimeIconRequired:!1,init:function(){SemTagSvcPortal.setCallback(SemTagAwrns.SVCNAME,SemTagAwrns.hcardsAdded),SemTagAwrns.processHcards(SemTagSvcPortal.getNodes(SemTagAwrns.SVCNAME))},hcardsAdded:function(){SemTagAwrns.processHcards(SemTagSvcPortal.getNodes(SemTagAwrns.SVCNAME))},processHcards:function(e){if(e=e||null,SemTagSvcPortal.debug&&console.log("in processHcards hcards got is"+e),null!=e)if(SemTagSvcPortal.sametimeSTProxy="undefined"!=typeof stproxy,SemTagSvcPortal.sametimeSTLinks="undefined"==typeof stproxy&&"undefined"!=typeof prepareSametimeLink,SemTagSvcPortal.sametimeNotIntegrated="undefined"==typeof stproxy&&"undefined"==typeof prepareSametimeLink,SemTagSvcPortal.debug&&console.log("Inside processHCards SemTagSvcPortal.sametimeSTProxy:"+SemTagSvcPortal.sametimeSTProxy+":"+SemTagSvcPortal.sametimeNotIntegrated+":"+SemTagSvcPortal.sametimeSTLinks),SemTagSvcPortal.debug&&console.log("Inside processHCards SemTagSvcPortal.sametimeSTProxy:"+("undefined"!=typeof stproxy)+":"+("undefined"==typeof stproxy&&"undefined"!=typeof prepareSametimeLink)+":"+("undefined"==typeof stproxy&&"undefined"==typeof prepareSametimeLink)),SemTagSvcPortal.sametimeSTProxy||SemTagSvcPortal.sametimeSTLinks){if(SemTagSvcPortal.debug&&console.info("Sametime is connected to Portal"),SemTagAwrns.hcards=[],SemTagAwrns.hcards=e,SemTagSvcPortal.sametimeSTProxy&&stproxy.addOnLoad((function(){var e=SemTagAwrns.hcards;SemTagSvcPortal.debug&&console.log("Hcards got is:"+e);for(var t=0;t<e.length;t++){var a=e[t];if(!SemTagAwrns.disabled(a)){var r=SemTagSvcPortal.findNameElementInHcard(a);if(SemTagSvcPortal.debug&&console.log("fnElem got is:"+r),r){var n=r.getAttribute(SemTagSvcPortal.liveElemPrefix+"id");if(SemTagSvcPortal.debug&&console.log("leid got is:"+n+":"+SemTagAwrns.activeElems[n]),!(null==n||n&&SemTagAwrns.activeElems[n])){var o=SemTagAwrns.getSametimeId(a),l=SemTagUtil.getHcardAttributeValue("X-sametime-resolve",a);if(l){var i=document.createElement("span"),s=SemTagUtil.getHcardAttributeValue("x-sametime-no-icon",a);SemTagAwrns.samtimeIconRequired=!1,s&&(SemTagAwrns.samtimeIconRequired=!0);var c=stproxy.getLiveNameModel(o,{isInBuddyList:!1,forceWatchlist:!0});c.portalId=o,SemTagSvcPortal.debug&&console.log("Model got for id:"+o+": is :"+c);var m=SemTagAwrns.getStatus(c.status);if(r&&r.setAttribute("semtag_ststatus",m),SemTagSvcPortal.debug&&console.log("semtag_ststatus variable set to :"+m),!SemTagAwrns.samtimeIconRequired){var g=document.createElement("img");g.id=t,g.imgId=c.id,SemTagAwrns.setSametimeIconSrc(c,g,stproxy),i.appendChild(g),i.setAttribute("class","sametimeawarenessicon"),i.className+=" sametimeawarenessicon",r.parentNode.insertBefore(i,r)}stproxy.hitch&&stproxy.hitch.connect?(SemTagSvcPortal.debug&&console.log("Inside stproxy.hitch way:"),stproxy.hitch.connect(c,"onUpdate",SemTagAwrns.updateSTProxy)):(SemTagSvcPortal.debug&&console.log("Inside non stproxy.hitch way:"),c.onUpdate=SemTagAwrns.updateSTProxy),n&&(SemTagAwrns.activeElems[n]=!0)}else SemTagSvcPortal.debug&&console.log("resolve is "+l+" so continuing")}}}}})),SemTagSvcPortal.sametimeSTLinks){SemTagSvcPortal.debug&&console.log("Hcards got is:"+e);for(var t=0;t<e.length;t++){var a=e[t];if(!SemTagAwrns.disabled(a)){SemTagAwrns.hcards=[],SemTagAwrns.hcards.push(a);var r=SemTagSvcPortal.findNameElementInHcard(a);if(SemTagSvcPortal.debug&&console.log("fnElem got is:"+r),r){var n=r.getAttribute(SemTagSvcPortal.liveElemPrefix+"id");if(SemTagSvcPortal.debug&&console.log("leid got is:"+n+":"+SemTagAwrns.activeElems[n]),!(null==n||n&&SemTagAwrns.activeElems[n])){var o=SemTagAwrns.getSametimeId(a),l=SemTagUtil.getHcardAttributeValue("X-sametime-resolve",a);if(l)var i=document.createElement("span");if(SemTagSvcPortal.sametimeSTLinks&&l){if(SemTagUtil.getOwnerDocument(a).location!=document.location){var s=SemTagUtil.getFrameElement(a);if(s&&"wpsFLY_flyoutIFrame"==s.id)continue}i.style.verticalAlign="text-top"}SemTagSvcPortal.sametimeSTLinks&&l&&(st=prepareSametimeLink(o,"",l,"text:no;"),SemTagSvcPortal.debug&&console.log("ST got is:"+st),i.innerHTML=st,r.parentNode.insertBefore(i,r)),n&&(SemTagAwrns.activeElems[n]=!0)}}}}}}else SemTagSvcPortal.debug&&console.info("stproxy and stlinks both are not available,person awareness will not be available")},setSametimeIconSrc:function(e,t,a){if(e.status>=a.awareness.OFFLINE&&e.status<=a.awareness.IN_MEETING_MOBILE){switch(e.status){case 0:t.src=a.uiControl.iconPaths.iconOffline;break;case 1:t.src=a.uiControl.iconPaths.iconAvailable,t.onclick=function(){SemTagAwrns.openChat(t.imgId,e)};break;case 4:case 2:t.src=a.uiControl.iconPaths.iconAway,t.onclick=function(){SemTagAwrns.openChat(t.imgId,e)};break;case 3:t.src=a.uiControl.iconPaths.iconDnd;break;case 5:t.src=a.uiControl.iconPaths.iconInMeeting,t.onclick=function(){SemTagAwrns.openChat(t.imgId,e)};break;case 6:t.src=a.uiControl.iconPaths.iconAvailableMobile,t.onclick=function(){SemTagAwrns.openChat(t.imgId,e)};break;case 7:case 9:t.src=a.uiControl.iconPaths.iconAwayMobile,t.onclick=function(){SemTagAwrns.openChat(t.imgId,e)};break;case 8:t.src=a.uiControl.iconPaths.iconDndMobile;break;case 10:t.src=a.uiControl.iconPaths.iconInMeetingMobile,t.onclick=function(){SemTagAwrns.openChat(t.imgId,e)};break;default:t.src=a.NOT_USING}t.title=e.statusMessage,t.alt=e.statusMessage}},disabled:function(e){return SemTagUtil.getHcardAttributeValue("X-no-awareness",e)},getSametimeId:function(e){for(var t=null,a=0;a<SemTagAwrns.imIds.length;a++){var r=SemTagSvcPortal.findElementByNameInHcard(e,SemTagAwrns.imIds[a]);if(r&&0<(t=SemTagSvcPortal.getTextValue(r)).length)break}return t},updateST:function(e){var t=e.split(";"),a=t[0],r=t[1];SemTagSvcPortal.debug&&console.log("INside updateST"+e);for(var n=0;n<SemTagAwrns.hcards.length;n++){var o=SemTagAwrns.hcards[n];if(SemTagAwrns.getSametimeId(o)==a){var l=SemTagSvcPortal.findNameElementInHcard(o);l&&l.setAttribute("semtag_ststatus",r)}}},updateSTProxy:function(){SemTagSvcPortal.debug&&console.log("Update getting called for :stid"+this.id+":portalid:"+this.portalId+":status:"+this.status);for(var e=SemTagAwrns.getStatus(this.status),t=0;t<SemTagAwrns.hcards.length;t++){var a=SemTagAwrns.hcards[t];if(SemTagAwrns.getSametimeId(a).toLowerCase()==this.portalId.toLowerCase()){SemTagSvcPortal.debug&&console.log("Doing Update for :stid"+this.id+":portalid:"+this.portalId+":status:"+this.status);var r=SemTagSvcPortal.findNameElementInHcard(a);r&&r.setAttribute("semtag_ststatus",e);var n=SemTagUtil.getHcardAttributeValue("x-sametime-no-icon",a);if(SemTagAwrns.samtimeIconRequired=!1,n&&(SemTagAwrns.samtimeIconRequired=!0),!SemTagAwrns.samtimeIconRequired){var o=SemTagSvcPortal.getElementsByClassName("sametimeawarenessicon",a),l=null!=o||o.length>0?o[0]:null;l?(icon=l.firstChild,SemTagAwrns.setSametimeIconSrc(this,icon,stproxy)):SemTagSvcPortal.debug&&console.log("Awareness span does not exist should not be possible"+a+":"+this.id)}}}},getStatus:function(e){var t="";switch(e){case 0:default:t="offline";break;case 1:t="online";break;case 2:case 4:t="away";break;case 3:t="donotdisturb";break;case 5:t="meeting"}return t},openCall:function(e){stproxy.policies.get(stproxy.policies.TCSPI)&&stproxy.call.byId(e)},openInstantMeeting:function(e){stproxy.policies.get(stproxy.policies.DISABLE_MEETING_INVITATION)&&stproxy.createMeeting(e)},openSendAnnouncement:function(e){stproxy.policies.get(stproxy.policies.ALLOW_ANNOUNCEMENT)&&stproxy.createAnnouncement(e)},openAddToContacts:function(e){stproxy.createAdder(e)},openChat:function(e,t){SemTagSvcPortal.debug&&console.info("Opening chat with: "+e+":"+SemTagSvcPortal.sametimeSTLinks+":"+SemTagSvcPortal.sametimeSTProxy),SemTagSvcPortal.sametimeSTLinks&&STLinksCreateIM(e),SemTagSvcPortal.sametimeSTProxy&&(null==t&&(t=stproxy.getLiveNameModel(e,{isInBuddyList:!1,forceWatchlist:!0})),SemTagSvcPortal.debug&&console.info("Opening chat with: imId,modelid"+e+":"+t.id),stproxy.openChat(t.id))}};function STLinksUserStatusChanged_SA(e,t,a,r,n){var o="";switch(SemTagSvcPortal.debug&&console.log("STLinksUserStatusChanged_SA status got is : "+e+";"+a+":"+typeof a),a){case 32:case 554:o="online";break;case 64:case 96:case 608:o="away";break;case 128:o="donotdisturb";break;default:o="offline"}var l=e+";"+o;SemTagSvcPortal.debug&&console.log("STLinksUserStatusChanged_SA status got is Final : "+l),SemTagSvcPortal.sametimeSTLinks&&SemTagAwrns.updateST(l)}function STLinksAppletStarted_SA(){SemTagSvcPortal.debug&&alert("Applet Started!"),SemTagAwrns.hasApplet=!0}function STLinksLoggedIn_SA(e,t){SemTagSvcPortal.debug&&alert("Logged In: "+e+", "+t)}"undefined"==typeof wps_userStatusFuncs&&(wps_userStatusFuncs=new Object),wps_userStatusFuncs.STLinksUserStatusChanged_SA=0,"undefined"==typeof wps_loggedInFuncs&&(wps_loggedInFuncs=new Object),wps_loggedInFuncs.STLinksLoggedIn_SA=0,"undefined"==typeof wps_appletStartedFuncs&&(wps_appletStartedFuncs=new Object),wps_appletStartedFuncs.STLinksAppletStarted_SA=0,window.setTimeout(SemTagAwrns.init,SemTagSvcPortal.DELAY);var SemTagC2A={serviceId:"c2a",sourceTagName:"c2a:source",typeNameTagName:"c2a:typename",valueTagName:"c2a:value",displayTagName:"c2a:display",anchorTagName:"c2a:anchor",targetTagName:"c2a:target",menulabelTagName:"c2a:action-label",paramTagName:"c2a:action-param",defaultNameSpaceStr:"IBM_C2A_DEFAULT_NAMESPACE",namespaceSep:"#",liveObjectNamespace:"http://www.ibm.com/xmlns/prod/websphere/portal/v6.1/livetext",targetsAvail:null,targetNodeIDs:new Object,sourceNodeIDs:new Object,currentValue:"",currentValArray:null,IDctr:0,c2aIdBaseStr:"IBMC2ASRVC_",c2aSourceIdBase:"IBMC2ASRVC_Source_",c2aTargetIdBase:"IBMC2ASRVC_Target_",nls:{c2a_click_for_actions:SemTagSvcPortalGlobal.c2a_click_for_actions},init:function(){window.ibm||(window.ibm=new Object),window.ibm.portal||(window.ibm.portal=new Object),window.ibm.portal.c2a=new Object;for(var e=0;e<parent.frames.length;e++)SemTagC2A.canAccessFrameContent(parent.frames[e])&&(parent.frames[e].ibm||(parent.frames[e].ibm=new Object),parent.frames[e].ibm.portal||(parent.frames[e].ibm.portal=new Object),parent.frames[e].ibm.portal.c2a=new Object);SemTagC2A.defineRegExpressions(),SemTagSvcPortal.setCallback(SemTagC2A.serviceId,SemTagC2A.parseDOM),SemTagSvcPortal.setSpecialMenuProvider(SemTagC2A.getSpecialC2AMenuItems),SemTagC2A.parseDOM()},getSpecialC2AMenuItems:function(e){var t=null;try{e.parentNode;var a=SemTagSvcPortal.getSemanticTagValues(e);for(var r in a){var n=a[r];n&&(t=SemTagC2A.getTargetMenuItems(SemTagC2A.getSpecialC2ASourceInfo(r,n)))}}catch(e){SemTagSvcPortal.trace&&SemTagUtil.log("error getting special c2a menu items, exception is "+e)}return t},showHover:function(e){SemTagSvcPortal.showHover(e,SemTagC2A.handleClick,SemTagC2A.nls.c2a_click_for_actions)},canAccessFrameContent:function(e){var t=!1;try{window.location.host==e.location.host&&window.location.protocol==e.location.protocol&&(t=!0)}catch(e){}return t},findElementInWindowScope:function(e){var t;if(null==(t=document.getElementById(e)))for(var a=0;a<parent.frames.length&&(!SemTagC2A.canAccessFrameContent(parent.frames[a])||null==(t=frames[a].document.getElementById(e)));a++);return t},handleClick:function(e){window.ibm||(window.ibm=new Object),window.ibm.portal||(window.ibm.portal=new Object),window.ibm.portal.c2a=new Object;for(var t=0;t<parent.frames.length;t++)SemTagC2A.canAccessFrameContent(parent.frames[t])&&(parent.frames[t].ibm||(parent.frames[t].ibm=new Object),parent.frames[t].ibm.portal||(parent.frames[t].ibm.portal=new Object),parent.frames[t].ibm.portal.c2a=new Object);var a=SemTagSvcPortal.getLiveElementFromEvent(e);if(!SemTagC2A.isSource(a))var r=SemTagSvcPortal.getParentByClassName(SemTagC2A.sourceTagName,a);SemTagC2A.generateMenuContents(e,r)},parseDOM:function(){SemTagC2A.processDomNodes(SemTagSvcPortal.getNodes(SemTagC2A.serviceId)),SemTagC2A.processSources(SemTagC2A.sourceNodeIDs)},processDomNodes:function(e){for(var t in SemTagC2A.sourceNodeIDs)SemTagC2A.findElementInWindowScope(t)||delete SemTagC2A.sourceNodeIDs[t];for(var t in SemTagC2A.targetNodeIDs)SemTagC2A.findElementInWindowScope(t)||delete SemTagC2A.targetNodeIDs[t];for(;e&&e.length>0;){var a=e.pop(),r=a.id;null!=r&&(SemTagC2A.exists(SemTagC2A.sourceNodeIDs,r)||SemTagC2A.exists(SemTagC2A.targetNodeIDs,r))||(SemTagC2A.isSource(a)?(null!=a.id&&""!=a.id||(a.id=SemTagC2A.c2aSourceIdBase+SemTagC2A.IDctr,SemTagC2A.IDctr++),SemTagC2A.sourceNodeIDs[a.id]="true"):SemTagC2A.isTarget(a)&&(null!=a.id&&""!=a.id||(a.id=SemTagC2A.c2aTargetIdBase+SemTagC2A.IDctr,SemTagC2A.IDctr++),SemTagC2A.targetNodeIDs[a.id]="true"))}SemTagC2A.updateAvailableTargets()},exists:function(e,t){return!(!e[t]||"true"!=e[t])},processSources:function(e){for(var t in e){var a=SemTagC2A.findElementInWindowScope(t),r=SemTagC2A.getSourceInfo(a),n=SemTagC2A.isTargetDefined(r);if(null==r.value||""==r.value){SemTagSvcPortal.trace&&SemTagUtil.log("Click-to-Action error: Missing c2a:value tag");break}var o=r.anchorNode.getAttribute("hasHover");n||""!=r.display?null!=o&&"false"!=o||(SemTagSvcPortal.addHover(r.anchorNode,SemTagC2A.showHover,SemTagC2A.handleClick),r.anchorNode.setAttribute("hasHover","true")):("true"==o&&SemTagSvcPortal.removeHover(r.anchorNode,SemTagC2A.showHover,SemTagC2A.handleClick),r.anchorNode.setAttribute("hasHover","false"))}},defineRegExpressions:function(){SemTagC2A.sourceRegExp=new RegExp("(^|\\s)"+SemTagC2A.sourceTagName+"(\\s|$)"),SemTagC2A.typeNameRegExp=new RegExp("(^|\\s)"+SemTagC2A.typeNameTagName+"(\\s|$)"),SemTagC2A.valueRegExp=new RegExp("(^|\\s)"+SemTagC2A.valueTagName+"(\\s|$)"),SemTagC2A.displayRegExp=new RegExp("(^|\\s)"+SemTagC2A.displayTagName+"(\\s|$)"),SemTagC2A.anchorRegExp=new RegExp("(^|\\s)"+SemTagC2A.anchorTagName+"(\\s|$)"),SemTagC2A.targetRegExp=new RegExp("(^|\\s)"+SemTagC2A.targetTagName+"(\\s|$)"),SemTagC2A.menulabelRegExp=new RegExp("(^|\\s)"+SemTagC2A.menulabelTagName+"(\\s|$)"),SemTagC2A.paramRegExp=new RegExp("(^|\\s)"+SemTagC2A.paramTagName+"(\\s|$)")},isTarget:function(e){return"FORM"==e.tagName&&SemTagUtil.getNodeClassValue(e).match(SemTagC2A.targetRegExp)},isSource:function(e){return("SPAN"==e.tagName||"DIV"==e.tagName)&&SemTagUtil.getNodeClassValue(e).match(SemTagC2A.sourceRegExp)},updateAvailableTargets:function(){for(var e in SemTagC2A.targetsAvail=null,SemTagC2A.targetsAvail=new Array,SemTagC2A.targetNodeIDs)for(var t=SemTagC2A.findElementInWindowScope(e).childNodes,a=null,r=null,n=0;n<t.length;n++){var o=t[n],l=SemTagUtil.getNodeClassValue(o);if(""!=l&&l.match(SemTagC2A.typeNameRegExp)){var i=SemTagC2A.getElementValue(o),s=SemTagC2A.parseTypeName(i);a=s.namespace,null!=(r=s.type)&&(null==a&&(a=SemTagC2A.defaultNameSpaceStr),void 0===SemTagC2A.targetsAvail[a]&&(SemTagC2A.targetsAvail[a]=new Array),SemTagC2A.targetsAvail[a][r]=!0)}}},parseTypeName:function(e){var t=null,a=null,r=e.indexOf(SemTagC2A.namespaceSep);if(r<0?(t=SemTagC2A.defaultNameSpaceStr,a=e):(t=e.substring(0,r),a=e.substring(r+1)),t==SemTagC2A.liveObjectNamespace){var n=a.indexOf(".");if(n>0){var o=a.substring(n+1);return{namespace:t,type:a=a.substring(0,n),selector:o}}}return{namespace:t,type:a}},isTargetDefined:function(e){for(var t=!1,a=0;a<e.typenames.length;a++){if(e.typenames[a].namespace&&""!=e.typenames[a].namespace||(e.typenames[a].namespace=SemTagC2A.defaultNameSpaceStr),void 0!==SemTagC2A.targetsAvail[e.typenames[a].namespace]){var r=SemTagC2A.targetsAvail[e.typenames[a].namespace][e.typenames[a].type];t=!(void 0===r||!r)}if(1==t)return t}return!1},isTargetSourceMatch:function(e,t){for(var a,r,n=0;n<e.typenames.length;n++){a=e.typenames[n];for(var o=0;o<t.typenames.length;o++){var l;if(r=t.typenames[o],a.namespace==r.namespace)if(a.namespace==SemTagC2A.liveObjectNamespace){if((l=r.selector?SemTagC2A.selectSubField(e.value,t.selector):e.value)&&null!=l&&""!=l)return!0}else if(a.type==r.type)return!0}}return!1},getElementValue:function(e){var t;return null==(t=SemTagUtil.getNodeClassValue(e).match(SemTagC2A.displayRegExp)?e.innerHTML:e.firstChild.nodeValue)?"":t.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1")},fillC2AInfo:function(e,t){for(var a=e.childNodes,r=0;r<a.length;r++){var n=a[r],o=SemTagUtil.getNodeClassValue(n);if(null==o||""==o)n.childNodes.length>0&&SemTagC2A.fillC2AInfo(n,t);else if(o.match(SemTagC2A.typeNameRegExp)){var l=SemTagC2A.getElementValue(n),i=SemTagC2A.parseTypeName(l);t.typenames.push({namespace:i.namespace,type:i.type}),i.selector&&(t.selector=i.selector)}else o.match(SemTagC2A.valueRegExp)&&""==t.value?(t.value=SemTagC2A.getElementValue(n),t.anchorNode&&""!=t.anchorNode||(t.anchorNode=n)):o.match(SemTagC2A.displayRegExp)&&""==t.display?t.display=SemTagC2A.getElementValue(n):o.match(SemTagC2A.menulabelRegExp)&&""==t.menuLabel?t.menuLabel=SemTagC2A.getElementValue(n):o.match(SemTagC2A.anchorRegExp)?t.anchorNode=n:o.match(SemTagC2A.sourceRegExp)||o.match(SemTagC2A.targetRegExp)||n.childNodes.length>0&&SemTagC2A.fillC2AInfo(n,t)}},getSpecialC2ASourceInfo:function(e,t){var a={typenames:new Array,value:t,display:"",anchorNode:""};return a.typenames.push({namespace:SemTagC2A.liveObjectNamespace,type:e}),a},getSourceInfo:function(e){var t={typenames:new Array,value:"",display:"",anchorNode:""};return SemTagC2A.fillC2AInfo(e,t),t},getTargetInfo:function(e){var t={typenames:new Array,menuLabel:""};return SemTagC2A.fillC2AInfo(e,t),t},generateMenuContents:function(e,t){var a=null,r=null,n=SemTagC2A.getSourceInfo(t);1==SemTagC2A.isTargetDefined(n)&&(a=SemTagC2A.getTargetMenuItems(n)),""!=n.display&&(r=SemTagSvcPortal.getMenuHeaderJson(n.display,"text/html",-100)),null==a&&""==n.display||SemTagSvcPortal.setMenuData(e,a,"",r,"")},getTargetMenuItems:function(e){var t=new Array,a=new Array;for(var r in SemTagC2A.targetNodeIDs){var n=SemTagC2A.findElementInWindowScope(r),o=SemTagC2A.getTargetInfo(n),l=o.menuLabel,i=a[l];null!=i?a[l]=i++:(a[l]=1,i=1),i>1&&(l+=" ("+i+")"),1==SemTagC2A.isTargetSourceMatch(e,o)&&t.push(SemTagSvcPortal.getMenuItemJson(l,'javascript:SemTagC2A.executeMenuAction("'+r+'");'))}return t.length>0&&(SemTagC2A.currentValue=e.value),t},executeMenuAction:function(e){var t=SemTagC2A.findElementInWindowScope(e);if(t&&"FORM"==t.tagName){var a=SemTagC2A.currentValue,r=SemTagC2A.getTargetInfo(t);r.selector&&(a=SemTagC2A.selectSubField(a,r.selector));for(var n=SemTagSvcPortal.getElementsByClassName(SemTagC2A.paramTagName,t,0,["INPUT"]),o=0;o<n.length;o++)n[o].value=SemTagC2A.getStringValue(a);window.ibm.portal.c2a.event={value:a};for(var l=0;l<parent.frames.length;l++)SemTagC2A.canAccessFrameContent(parent.frames[l])&&(parent.frames[l].ibm||(parent.frames[l].ibm=new Object),parent.frames[l].ibm.portal||(parent.frames[l].ibm.portal=new Object),parent.frames[l].ibm.portal.c2a=new Object,parent.frames[l].ibm.portal.c2a.event={value:a});if(t.onsubmit)if(SemTagUtil.isGecko){var i=new Object;t.onsubmit(i)}else t.fireEvent("onsubmit");t.submit()}else SemTagSvcPortal.trace&&SemTagUtil.log("no target node can be found for id "+e)},selectSubField:function(e,t){for(var a=t.split("."),r=e,n=0;n<a.length;n++){if("object"!=typeof r||!r[a[n]]){SemTagSvcPortal.trace&&SemTagUtil.log("cannot select "+t+" from "+e),r=null;break}r=r[a[n]]}return r},getStringValue:function(e){return"string"==typeof e?e:SemTagC2A.getJSON(e)},getJSON:function(e){if(null==e)return"null";switch(typeof e){case"string":return'"'+e+'"';case"number":case"boolean":return String(e);case"object":if(e instanceof Array)return SemTagC2A.getArrayJSON(e);if(e)return SemTagC2A.getObjectJSON(e)}},getObjectJSON:function(e){var t=[];for(k in e)e.hasOwnProperty(k)&&t.push('"'+k+'":'+SemTagC2A.getJSON(e[k]));return"{"+t.join(",")+"}"},getArrayJSON:function(e){for(var t=[],a=0;a<e.length;a++)t.push(SemTagC2A.getJSON(e[a]));return"["+t.join(",")+"]"},triggerCSRAction:function(e){var t=SemTagC2A.findElementInWindowScope(e);SemTagC2A.getC2ATargetPageID(t),SemTagC2A.getC2ATargetPortletWindowID(t),SemTagC2A.getC2ACommTargetName(t),SemTagC2A.currentValue,SemTagC2A.getTargetActionParams(t)},triggerCSREvent:function(e){var t=SemTagC2A.findElementInWindowScope(e),a=(SemTagC2A.getC2ATargetPageID(t),SemTagC2A.getC2ATargetPortletWindowID(t)),r=SemTagC2A.getC2ACommTargetQName(t),n=SemTagC2A.currentValue;com.ibm.mashups.services.ServiceManager.getService(com.ibm.mashups.iwidget.services.EventService.SERVICE_NAME).fireEvent(a,r,n,"{http://www.w3.org/2001/XMLSchema}string")},getC2ATargetPageID:function(e){var t=dojo.query('input[name="com.ibm.wps.propertybroker.standard.c2a.pageid"]',e);return null!=t&&1==t.length?t[0].value:"undefined"},getC2ATargetPortletWindowID:function(e){var t=dojo.query('input[name="com.ibm.wps.propertybroker.standard.c2a.portletwindowid"]',e);return null!=t&&1==t.length?t[0].value:"undefined"},getC2ACommTargetName:function(e){var t=dojo.query('input[name="com.ibm.wps.propertybroker.standard.c2a.commtargetname"]',e);return null!=t&&1==t.length?t[0].value:"undefined"},getC2ACommTargetQName:function(e){var t=dojo.query('input[name="com.ibm.wps.propertybroker.standard.c2a.commtargetqname"]',e);return null!=t&&1==t.length?t[0].value:"undefined"},getC2ATargetActionParams:function(e){var t=dojo.query('input[type="text"]',e);dojo.forEach(t,(function(e){}))}};SemTagC2A.init(),"undefined"==typeof ibm&&(ibm={}),void 0===ibm.portal&&(ibm.portal={}),void 0===ibm.portal.xml&&(ibm.portal.xml={}),void 0===ibm.portal.xml&&(ibm.portal.xml={}),ibm.portal.util={},ibm.portal.util.cloneObject=function(e){var t={};for(i in e)t[i]=e[i];return t},ibm.portal.resource={},ibm.portal.resource.str={},ibm.portal.resource.getString=function(e,t){if(s=e[t],s=null==s?t:s,arguments.length>=2){i=1;do{s=s.replace("%"+i,arguments[i]),i+=1}while(i<arguments.length)}return s},void 0===ibm.portal.xml&&(ibm.portal.xml={}),ibm.portal.xml.ie={},ibm.portal.xml.gecko={},ibm.portal.xml.getXmlHttpRequest=function(){return"undefined"!=typeof ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest},ibm.portal.xml.loadXml=function(e){return"undefined"!=typeof ActiveXObject?ibm.portal.xml.ie.loadXml(e):ibm.portal.xml.gecko.loadXml(e)},ibm.portal.xml.loadXmlString=function(e){return"undefined"!=typeof ActiveXObject?ibm.portal.xml.ie.loadXmlString(e):ibm.portal.xml.gecko.loadXmlString(e)},ibm.portal.xml.loadXsl=function(e){return"undefined"!=typeof ActiveXObject?ibm.portal.xml.ie.loadXsl(e):ibm.portal.xml.gecko.loadXsl(e)},ibm.portal.xml.transform=function(e,t,a,r,n){return"undefined"!=typeof ActiveXObject?ibm.portal.xml.ie.transform(e,t,a,r,n):ibm.portal.xml.gecko.transform(e,t,a,r,n)},ibm.portal.xml.update=function(e,t,a,r,n){if("undefined"!=typeof ActiveXObject){var o=ibm.portal.xml.ie.transform(t,a,r,n,!0);ibm.portal.debug.text("XSLT result: "+o),e.innerHTML+=o}else o=ibm.portal.xml.gecko.transform(t,a,r,n,!1),e.appendChild(o.documentElement)},ibm.portal.xml.ie.loadXml=function(e){var t=new ActiveXObject("MSXML2.DOMDocument");if(t.async=0,t.resolveExternals=0,!t.load(e))throw new Error("Error loading xml file "+e);return t},ibm.portal.xml.ie.loadXmlString=function(e){var t=new ActiveXObject("MSXML2.DOMDocument");if(t.async=0,t.resolveExternals=0,!t.loadXML(e))throw new Error("Error loading xml string "+e);return t},ibm.portal.xml.ie.loadXsl=function(e){var t=new ActiveXObject("MSXML2.FreeThreadedDOMDocument");if(t.async=0,t.resolveExternals=0,!t.load(e))throw new Error("Error loading xsl file "+e);return t},ibm.portal.xml.ie.transform=function(e,t,a,r,n){var o=e,l=t;try{l.documentElement||(l=this.loadXsl(t))}catch(e){var i=e.message;throw new Error(""+i,""+i)}var s=new ActiveXObject("Msxml2.XSLTemplate");s.stylesheet=l;var c=s.createProcessor();if(c.input=o,r)for(var m in r)c.addParameter(m,r[m]);if(a&&c.addParameter("mode",a),n){if(!c.transform())throw new Error("Error transforming xml doc "+o);return c.output}var g=new ActiveXObject("MSXML2.DOMDocument");return g.async=0,g.validateOnParse=1,o.transformNodeToObject(l,g),g},ibm.portal.xml.gecko.loadXml=function(e){var t=document.implementation.createDocument("","",null),a=new XMLHttpRequest;return a.open("GET",e,!1),a.send(null),200==a.status&&(t=a.responseXML),t},ibm.portal.xml.gecko.loadXmlString=function(e){var t=new DOMParser;try{oXmlDoc=t.parseFromString(e,"text/xml")}catch(t){throw new Error("Error loading xml string "+e)}return oXmlDoc},ibm.portal.xml.gecko.loadXsl=function(e){var t=document.implementation.createDocument("","",null),a=new XMLHttpRequest;return a.open("GET",e,!1),a.send(null),200==a.status&&(t=a.responseXML),t},ibm.portal.xml.gecko.transform=function(e,t,a,r,n){try{var o=t;o.documentElement||(alert("xslDoc is not a Document, loading it..."),o=this.loadXsl(t));var l=new XSLTProcessor;if(l.importStylesheet(o),r)for(var i in r)l.setParameter(null,i,r[i]);a&&l.setParameter(null,"mode",a);var s=l.transformToDocument(e);if(!n)return s;resultStr=s.documentElement.textContent}catch(e){throw new Error("Error transforming xml doc "+e)}return resultStr},ibm.portal.xml.setLayerContentByXml=function(e,t,a,r,n){var o=ibm.portal.xml.transform(t,a,null,r,n);e.innerHTML?e.innerHTML=o:document.getElementById(e).innerHTML=o},ibm.portal.io={},ibm.portal.io.sAcceptLanguage="",ibm.portal.io.getResponseHeader=function(e,t){var a;try{a=e.getResponseHeader(t)}catch(e){a=null}return a},ibm.portal.io.checkForError=function(e){var t=null,a=ibm.portal.io.getResponseHeader(e,"X-IBM-REST-Error");if(a){t="";var r=ibm.portal.io.getResponseHeader(e,"X-IBM-REST-MsgArg1");t=r?ibm.portal.resource.getString(a,window.decodeURIComponent(r)):ibm.portal.resource.getString(a)}return t},ibm.portal.io.asyncRequest=function(e,t,a,r){try{ibm.portal.io.setAsync(e,t,a,r,!0)}catch(n){ibm.portal.io.setAsync(e,t,a,r,!1)}},ibm.portal.io.setAsync=function(e,t,a,r,n){var o=ibm.portal.xml.getXmlHttpRequest();o.open(e,t,!0),n||o.setRequestHeader("Accept-language","*");try{o.onreadystatechange=function(){if(4==o.readyState)if(r.startUpdate(),sError=ibm.portal.io.checkForError(o),sError)r.handleError(""+ibm.portal.resource.getString(sError));else{var e=o.responseText;r.handleData(e)}},o.send(a)}catch(e){throw new Error("","")}};