var OpenAjax=OpenAjax||{};OpenAjax.hub||(OpenAjax.hub=function(){var e={},n="org.openajax.hub.";return{implementer:"http://openajax.org",implVersion:"2.0.6",specVersion:"2.0",implExtraData:{},libraries:e,registerLibrary:function(t,r,a,i){e[t]={prefix:t,namespaceURI:r,version:a,extraData:i},this.publish(n+"registerLibrary",e[t])},unregisterLibrary:function(t){this.publish(n+"unregisterLibrary",e[t]),delete e[t]}}}(),OpenAjax.hub.Error={BadParameters:"OpenAjax.hub.Error.BadParameters",Disconnected:"OpenAjax.hub.Error.Disconnected",Duplicate:"OpenAjax.hub.Error.Duplicate",NoContainer:"OpenAjax.hub.Error.NoContainer",NoSubscription:"OpenAjax.hub.Error.NoSubscription",NotAllowed:"OpenAjax.hub.Error.NotAllowed",WrongProtocol:"OpenAjax.hub.Error.WrongProtocol",IncompatBrowser:"OpenAjax.hub.Error.IncompatBrowser"},OpenAjax.hub.SecurityAlert={LoadTimeout:"OpenAjax.hub.SecurityAlert.LoadTimeout",FramePhish:"OpenAjax.hub.SecurityAlert.FramePhish",ForgedMsg:"OpenAjax.hub.SecurityAlert.ForgedMsg"},OpenAjax.hub._debugger=function(){},OpenAjax.hub.ManagedHub=function(e){if(!e||!e.onPublish||!e.onSubscribe)throw new Error(OpenAjax.hub.Error.BadParameters);if(this._p=e,this._onUnsubscribe=e.onUnsubscribe?e.onUnsubscribe:null,this._scope=e.scope||window,e.log){var n=this;this._log=function(t){try{e.log.call(n._scope,"ManagedHub: "+t)}catch(e){OpenAjax.hub._debugger()}}}else this._log=function(){};this._subscriptions={c:{},s:null},this._containers={},this._seq=0,this._active=!0,this._isPublishing=!1,this._pubQ=[]},OpenAjax.hub.ManagedHub.prototype.subscribeForClient=function(e,n,t){if(this._assertConn(),this._invokeOnSubscribe(n,e))return this._subscribe(n,this._sendToClient,this,{c:e,sid:t});throw new Error(OpenAjax.hub.Error.NotAllowed)},OpenAjax.hub.ManagedHub.prototype.unsubscribeForClient=function(e,n){this._unsubscribe(n),this._invokeOnUnsubscribe(e,n)},OpenAjax.hub.ManagedHub.prototype.publishForClient=function(e,n,t){this._assertConn(),this._publish(n,t,e)},OpenAjax.hub.ManagedHub.prototype.disconnect=function(){for(var e in this._active=!1,this._containers)this.removeContainer(this._containers[e])},OpenAjax.hub.ManagedHub.prototype.getContainer=function(e){var n=this._containers[e];return n||null},OpenAjax.hub.ManagedHub.prototype.listContainers=function(){var e=[];for(var n in this._containers)e.push(this._containers[n]);return e},OpenAjax.hub.ManagedHub.prototype.addContainer=function(e){this._assertConn();var n=e.getClientID();if(this._containers[n])throw new Error(OpenAjax.hub.Error.Duplicate);this._containers[n]=e},OpenAjax.hub.ManagedHub.prototype.removeContainer=function(e){var n=e.getClientID();if(!this._containers[n])throw new Error(OpenAjax.hub.Error.NoContainer);e.remove(),delete this._containers[n]},OpenAjax.hub.ManagedHub.prototype.subscribe=function(e,n,t,r,a){if(this._assertConn(),this._assertSubTopic(e),!n)throw new Error(OpenAjax.hub.Error.BadParameters);if(t=t||window,this._invokeOnSubscribe(e,null)){var i=this,o=this._subscribe(e,(function(e,r,o,s){if(i._invokeOnPublish(e,r,s,null))try{n.call(t,e,r,a)}catch(e){OpenAjax.hub._debugger(),i._log("caught error from onData callback to Hub.subscribe(): "+e.message)}}),t,a);return this._invokeOnComplete(r,t,o,!0),o}this._invokeOnComplete(r,t,null,!1,OpenAjax.hub.Error.NotAllowed)},OpenAjax.hub.ManagedHub.prototype.publish=function(e,n){this._assertConn(),this._assertPubTopic(e),this._publish(e,n,null)},OpenAjax.hub.ManagedHub.prototype.unsubscribe=function(e,n,t){if(this._assertConn(),!e)throw new Error(OpenAjax.hub.Error.BadParameters);this._unsubscribe(e),this._invokeOnUnsubscribe(null,e),this._invokeOnComplete(n,t,e,!0)},OpenAjax.hub.ManagedHub.prototype.isConnected=function(){return this._active},OpenAjax.hub.ManagedHub.prototype.getScope=function(){return this._scope},OpenAjax.hub.ManagedHub.prototype.getSubscriberData=function(e){this._assertConn();var n=e.split("."),t=n.pop(),r=this._getSubscriptionObject(this._subscriptions,n,0,t);if(r)return r.data;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.ManagedHub.prototype.getSubscriberScope=function(e){this._assertConn();var n=e.split("."),t=n.pop(),r=this._getSubscriptionObject(this._subscriptions,n,0,t);if(r)return r.scope;throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.ManagedHub.prototype.getParameters=function(){return this._p},OpenAjax.hub.ManagedHub.prototype._sendToClient=function(e,n,t,r){this.isConnected()&&this._invokeOnPublish(e,n,r,t.c)&&t.c.sendToClient(e,n,t.sid)},OpenAjax.hub.ManagedHub.prototype._assertConn=function(){if(!this.isConnected())throw new Error(OpenAjax.hub.Error.Disconnected)},OpenAjax.hub.ManagedHub.prototype._assertPubTopic=function(e){if(!e||""===e||-1!=e.indexOf("*")||-1!=e.indexOf("..")||"."==e.charAt(0)||"."==e.charAt(e.length-1))throw new Error(OpenAjax.hub.Error.BadParameters)},OpenAjax.hub.ManagedHub.prototype._assertSubTopic=function(e){if(!e)throw new Error(OpenAjax.hub.Error.BadParameters);for(var n=e.split("."),t=n.length,r=0;r<t;r++){var a=n[r];if(""===a||-1!=a.indexOf("*")&&"*"!=a&&"**"!=a)throw new Error(OpenAjax.hub.Error.BadParameters);if("**"==a&&r<t-1)throw new Error(OpenAjax.hub.Error.BadParameters)}},OpenAjax.hub.ManagedHub.prototype._invokeOnComplete=function(e,n,t,r,a){if(e)try{n=n||window,e.call(n,t,r,a)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onComplete callback: "+e.message)}},OpenAjax.hub.ManagedHub.prototype._invokeOnPublish=function(e,n,t,r){try{return this._p.onPublish.call(this._scope,e,n,t,r)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onPublish callback to constructor: "+e.message)}return!1},OpenAjax.hub.ManagedHub.prototype._invokeOnSubscribe=function(e,n){try{return this._p.onSubscribe.call(this._scope,e,n)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onSubscribe callback to constructor: "+e.message)}return!1},OpenAjax.hub.ManagedHub.prototype._invokeOnUnsubscribe=function(e,n){if(this._onUnsubscribe){var t=n.slice(0,n.lastIndexOf("."));try{this._onUnsubscribe.call(this._scope,t,e)}catch(e){OpenAjax.hub._debugger(),this._log("caught error from onUnsubscribe callback to constructor: "+e.message)}}},OpenAjax.hub.ManagedHub.prototype._subscribe=function(e,n,t,r){var a=e+"."+this._seq,i={scope:t,cb:n,data:r,sid:this._seq++},o=e.split(".");return this._recursiveSubscribe(this._subscriptions,o,0,i),a},OpenAjax.hub.ManagedHub.prototype._recursiveSubscribe=function(e,n,t,r){var a=n[t];t==n.length?(r.next=e.s,e.s=r):(void 0===e.c&&(e.c={}),void 0===e.c[a]?(e.c[a]={c:{},s:null},this._recursiveSubscribe(e.c[a],n,t+1,r)):this._recursiveSubscribe(e.c[a],n,t+1,r))},OpenAjax.hub.ManagedHub.prototype._publish=function(e,n,t){if(this._isPublishing)this._pubQ.push({t:e,d:n,p:t});else for(this._safePublish(e,n,t);this._pubQ.length>0;){var r=this._pubQ.shift();this._safePublish(r.t,r.d,r.p)}},OpenAjax.hub.ManagedHub.prototype._safePublish=function(e,n,t){this._isPublishing=!0;var r=e.split(".");this._recursivePublish(this._subscriptions,r,0,e,n,t),this._isPublishing=!1},OpenAjax.hub.ManagedHub.prototype._recursivePublish=function(e,n,t,r,a,i){var o;if(void 0!==e&&(t==n.length?o=e:(this._recursivePublish(e.c[n[t]],n,t+1,r,a,i),this._recursivePublish(e.c["*"],n,t+1,r,a,i),o=e.c["**"]),void 0!==o))for(var s=o.s;s;){var u=s.scope,c=s.cb,p=s.data;"string"==typeof c&&(c=u[c]),c.call(u,r,a,p,i),s=s.next}},OpenAjax.hub.ManagedHub.prototype._unsubscribe=function(e){var n=e.split("."),t=n.pop();if(!this._recursiveUnsubscribe(this._subscriptions,n,0,t))throw new Error(OpenAjax.hub.Error.NoSubscription)},OpenAjax.hub.ManagedHub.prototype._recursiveUnsubscribe=function(e,n,t,r){if(void 0===e)return!1;if(t<n.length){var a=e.c[n[t]];if(!a)return!1;if(this._recursiveUnsubscribe(a,n,t+1,r),!a.s){for(var i in a.c)return!0;delete e.c[n[t]]}}else{for(var o=e.s,s=null,u=!1;o;){if(r==o.sid){u=!0,o==e.s?e.s=o.next:s.next=o.next;break}s=o,o=o.next}if(!u)return!1}return!0},OpenAjax.hub.ManagedHub.prototype._getSubscriptionObject=function(e,n,t,r){if(void 0!==e){if(t<n.length){var a=e.c[n[t]];return this._getSubscriptionObject(a,n,t+1,r)}for(var i=e.s;i;){if(r==i.sid)return i;i=i.next}}return null},OpenAjax.hub._hub=new OpenAjax.hub.ManagedHub({onSubscribe:function(e,n){return!0},onPublish:function(e,n,t,r){return!0}}),OpenAjax.hub.subscribe=function(e,n,t,r){return"string"==typeof n&&(n=(t=t||window)[n]||null),OpenAjax.hub._hub.subscribe(e,n,t,null,r)},OpenAjax.hub.unsubscribe=function(e){return OpenAjax.hub._hub.unsubscribe(e)},OpenAjax.hub.publish=function(e,n){OpenAjax.hub._hub.publish(e,n)},OpenAjax.hub.registerLibrary("OpenAjax","http://openajax.org/hub","2.0",{})),OpenAjax.hub.InlineContainer=function(e,n,t){if(!(e&&n&&t&&t.Container&&t.Container.onSecurityAlert))throw new Error(OpenAjax.hub.Error.BadParameters);var r=t.Container.scope||window,a=!1,i=[],o=0,s=null;if(t.Container.log)var u=function(e){try{t.Container.log.call(r,"InlineContainer::"+n+": "+e)}catch(e){OpenAjax.hub._debugger()}};else u=function(){};function c(e,n,t,r,a){if(e)try{n=n||window,e.call(n,t,r,a)}catch(e){OpenAjax.hub._debugger(),s._log("caught error from onComplete callback: "+e.message)}}function p(){for(var n in i)e.unsubscribeForClient(this,i[n].h);i=[],o=0,a=!1}function g(){if(!a)throw new Error(OpenAjax.hub.Error.Disconnected)}function l(e){var n=i[e];if(n)return n;throw new Error(OpenAjax.hub.Error.NoSubscription)}this._init=function(){e.addContainer(this)},this.getHub=function(){return e},this.sendToClient=function(e,n,t){if(a){var r=i[t];try{r.cb.call(r.sc,e,n,r.d)}catch(e){OpenAjax.hub._debugger(),s._log("caught error from onData callback to HubClient.subscribe(): "+e.message)}}},this.remove=function(){a&&p()},this.isConnected=function(){return a},this.getClientID=function(){return n},this.getPartnerOrigin=function(){return a?window.location.protocol+"//"+window.location.hostname:null},this.getParameters=function(){return t},this.connect=function(e,n,i){if(a)throw new Error(OpenAjax.hub.Error.Duplicate);if(a=!0,s=e,t.Container.onConnect)try{t.Container.onConnect.call(r,this)}catch(e){OpenAjax.hub._debugger(),u("caught error from onConnect callback to constructor: "+e.message)}c(n,i,e,!0)},this.disconnect=function(e,n,i){if(!a)throw new Error(OpenAjax.hub.Error.Disconnected);if(p(),t.Container.onDisconnect)try{t.Container.onDisconnect.call(r,this)}catch(e){OpenAjax.hub._debugger(),u("caught error from onDisconnect callback to constructor: "+e.message)}c(n,i,e,!0)},this.subscribe=function(n,t,r,a,s){if(g(),function(e){if(!e)throw new Error(OpenAjax.hub.Error.BadParameters);for(var n=e.split("."),t=n.length,r=0;r<t;r++){var a=n[r];if(""===a||-1!=a.indexOf("*")&&"*"!=a&&"**"!=a)throw new Error(OpenAjax.hub.Error.BadParameters);if("**"==a&&r<t-1)throw new Error(OpenAjax.hub.Error.BadParameters)}}(n),!t)throw new Error(OpenAjax.hub.Error.BadParameters);var u=""+o++,p=!1,l=null;try{var f=e.subscribeForClient(this,n,u);p=!0}catch(e){u=null,l=e.message}return r=r||window,p&&(i[u]={h:f,cb:t,sc:r,d:s}),c(a,r,u,p,l),u},this.publish=function(n,t){g(),function(e){if(null==e||""===e||-1!=e.indexOf("*")||-1!=e.indexOf("..")||"."==e.charAt(0)||"."==e.charAt(e.length-1))throw new Error(OpenAjax.hub.Error.BadParameters)}(n),e.publishForClient(this,n,t)},this.unsubscribe=function(n,t,r){if(g(),null==n)throw new Error(OpenAjax.hub.Error.BadParameters);var a=i[n];if(!a)throw new Error(OpenAjax.hub.Error.NoSubscription);e.unsubscribeForClient(this,a.h),delete i[n],c(t,r,n,!0)},this.getSubscriberData=function(e){return g(),l(e).d},this.getSubscriberScope=function(e){return g(),l(e).sc},this._init()},OpenAjax.hub.InlineHubClient=function(e){if(!(e&&e.HubClient&&e.HubClient.onSecurityAlert&&e.InlineHubClient&&e.InlineHubClient.container))throw new Error(OpenAjax.hub.Error.BadParameters);var n=e.InlineHubClient.container,t=e.HubClient.scope||window;if(e.HubClient.log)var r=function(r){try{e.HubClient.log.call(t,"InlineHubClient::"+n.getClientID()+": "+r)}catch(e){OpenAjax.hub._debugger()}};else r=function(){};this._log=r,this.connect=function(e,t){n.connect(this,e,t)},this.disconnect=function(e,t){n.disconnect(this,e,t)},this.getPartnerOrigin=function(){return n.getPartnerOrigin()},this.getClientID=function(){return n.getClientID()},this.subscribe=function(e,t,r,a,i){return n.subscribe(e,t,r,a,i)},this.publish=function(e,t){n.publish(e,t)},this.unsubscribe=function(e,t,r){n.unsubscribe(e,t,r)},this.isConnected=function(){return n.isConnected()},this.getScope=function(){return t},this.getSubscriberData=function(e){return n.getSubscriberData(e)},this.getSubscriberScope=function(e){return n.getSubscriberScope(e)},this.getParameters=function(){return e}};var OpenAjax=OpenAjax||{};OpenAjax.hub=OpenAjax.hub||{},OpenAjax.gadgets="object"==typeof OpenAjax.gadgets?OpenAjax.gadgets:"object"==typeof gadgets?gadgets:{},OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{},function(){if("undefined"==typeof gadgets){if("undefined"==typeof oaaConfig)for(var _b3=document.getElementsByTagName("script"),_b4=/openajax(?:managedhub-(?:all|core).*|-mashup)\.js$/i,i=_b3.length-1;i>=0;i--){var src=_b3[i].getAttribute("src");if(src){var m=src.match(_b4);if(m){var _b5=_b3[i].getAttribute("oaaConfig");if(_b5)try{oaaConfig=eval("({ "+_b5+" })")}catch(e){}break}}}"undefined"!=typeof oaaConfig&&oaaConfig.gadgetsGlobal&&(gadgets=OpenAjax.gadgets)}}(),OpenAjax.hub.IframeContainer||function(){OpenAjax.hub.IframeContainer=function(n,t,r){!function(e){var n=e[0],t=e[1],r=e[2];if(!(n&&t&&r&&r.Container&&r.Container.onSecurityAlert&&r.IframeContainer&&r.IframeContainer.parent&&r.IframeContainer.uri))throw new Error(OpenAjax.hub.Error.BadParameters)}(arguments);var a,i,o,s=this,u=r.Container.scope||window,c=!1,p={},g=r.IframeContainer.timeout||15e3;if(r.Container.log)var l=function(e){try{r.Container.log.call(u,"IframeContainer::"+t+": "+e)}catch(e){OpenAjax.hub._debugger()}};else l=function(){};function f(){if(c){for(var e in c=!1,document.getElementById(i).style.visibility="hidden",p)n.unsubscribeForClient(s,p[e]);p={}}}function d(e){try{r.Container.onSecurityAlert.call(u,s,e)}catch(e){OpenAjax.hub._debugger(),l("caught error from onSecurityAlert callback to constructor: "+e.message)}}function h(){o=setTimeout((function(){d(OpenAjax.hub.SecurityAlert.LoadTimeout),s._handleIncomingRPC=function(){}}),g)}this._init=function(){n.addContainer(this),i=OpenAjax.hub.IframeContainer._rpcRouter.add(t,this),a=function(e,n,t){if(!OpenAjax.hub.IframeContainer._prng){var r=(new Date).getTime()+Math.random()+document.cookie;OpenAjax.hub.IframeContainer._prng=OpenAjax._smash.crypto.newPRNG(r)}var a=e.IframeContainer||e.IframeHubClient;if(a&&a.seed)try{var i=a.seed.call(n);OpenAjax.hub.IframeContainer._prng.addSeed(i)}catch(e){OpenAjax.hub._debugger(),t("caught error from 'seed' callback: "+e.message)}var o=a&&a.tokenLength||6;return OpenAjax.hub.IframeContainer._prng.nextRandomB64Str(o)}(r,u,l);var e=r.IframeContainer.clientRelay,o=OpenAjax.gadgets.rpc.getRelayChannel();if(r.IframeContainer.tunnelURI){if("wpm"!==o&&"ifpc"!==o)throw new Error(OpenAjax.hub.Error.IncompatBrowser)}else l("WARNING: Parameter 'IframeContaienr.tunnelURI' not specified. Connection will not be fully secure."),"rmr"!==o||e||(e=OpenAjax.gadgets.rpc.getOrigin(r.IframeContainer.uri)+"/robots.txt");!function(){var e=document.createElement("span");r.IframeContainer.parent.appendChild(e);var n,o='<iframe id="'+i+'" name="'+i+'" src="javascript:\'<html></html>\'"',s="",u=r.IframeContainer.iframeAttrs;if(u)for(var c in u)switch(c){case"style":for(var p in u.style)s+=p+":"+u.style[p]+";";break;case"className":o+=' class="'+u[c]+'"';break;default:o+=" "+c+'="'+u[c]+'"'}o+=' style="'+(s+="visibility:hidden;")+'"></iframe>',e.innerHTML=o,n=r.IframeContainer.tunnelURI?"&parent="+encodeURIComponent(r.IframeContainer.tunnelURI)+"&forcesecure=true":"&oahParent="+encodeURIComponent(OpenAjax.gadgets.rpc.getOrigin(window.location.href));var g="";i!==t&&(g="&oahId="+i.substring(i.lastIndexOf("_")+1));document.getElementById(i).src=r.IframeContainer.uri+"#rpctoken="+a+n+g}(),OpenAjax.gadgets.rpc.setupReceiver(i,e),h()},this.sendToClient=function(e,n,t){OpenAjax.gadgets.rpc.call(i,"openajax.pubsub",null,"pub",e,n,t)},this.remove=function(){f(),clearTimeout(o),OpenAjax.gadgets.rpc.removeReceiver(i);var e=document.getElementById(i);e.parentNode.removeChild(e),OpenAjax.hub.IframeContainer._rpcRouter.remove(i)},this.isConnected=function(){return c},this.getClientID=function(){return t},this.getPartnerOrigin=function(){if(c){var e=OpenAjax.gadgets.rpc.getReceiverOrigin(i);if(e)return/^([a-zA-Z]+:\/\/[^:]+).*/.exec(e)[1]}return null},this.getParameters=function(){return r},this.getHub=function(){return n},this.getIframe=function(){return document.getElementById(i)},this._handleIncomingRPC=function(e,t,a){switch(e){case"pub":n.publishForClient(s,t,a);break;case"sub":var g="";try{p[a]=n.subscribeForClient(s,t,a)}catch(e){g=e.message}return g;case"uns":var d=p[a];return n.unsubscribeForClient(s,d),delete p[a],a;case"con":return function(){function e(e){if(e&&(c=!0,clearTimeout(o),document.getElementById(i).style.visibility="visible",r.Container.onConnect))try{r.Container.onConnect.call(u,s)}catch(e){OpenAjax.hub._debugger(),l("caught error from onConnect callback to constructor: "+e.message)}}OpenAjax.gadgets.rpc.call(i,"openajax.pubsub",e,"cmd","con")}(),!0;case"dis":if(h(),f(),r.Container.onDisconnect)try{r.Container.onDisconnect.call(u,s)}catch(e){OpenAjax.hub._debugger(),l("caught error from onDisconnect callback to constructor: "+e.message)}return!0}},this._onSecurityAlert=function(n){d(e[n])},this._init()},OpenAjax.hub.IframeHubClient=function(e){if(!e||!e.HubClient||!e.HubClient.onSecurityAlert)throw new Error(OpenAjax.hub.Error.BadParameters);var n,t=this,r=e.HubClient.scope||window,a=!1,i={},o=0;if(e.HubClient.log)var s=function(t){try{e.HubClient.log.call(r,"IframeHubClient::"+n+": "+t)}catch(e){OpenAjax.hub._debugger()}};else s=function(){};function u(){if(!a)throw new Error(OpenAjax.hub.Error.Disconnected)}this._init=function(){var t=OpenAjax.gadgets.util.getUrlParameters();if(!t.parent){var r=t.oahParent+"/robots.txt";OpenAjax.gadgets.rpc.setupReceiver("..",r)}if(e.IframeHubClient&&e.IframeHubClient.requireParentVerifiable&&null===OpenAjax.gadgets.rpc.getReceiverOrigin(".."))throw OpenAjax.gadgets.rpc.removeReceiver(".."),new Error(OpenAjax.hub.Error.IncompatBrowser);OpenAjax.hub.IframeContainer._rpcRouter.add("..",this),n=OpenAjax.gadgets.rpc.RPC_ID,t.oahId&&(n=n.substring(0,n.lastIndexOf("_")))},this.connect=function(e,n){if(a)throw new Error(OpenAjax.hub.Error.Duplicate);OpenAjax.gadgets.rpc.call("..","openajax.pubsub",(function(r){if(r&&(a=!0,e))try{e.call(n||window,t,!0)}catch(e){OpenAjax.hub._debugger(),s("caught error from onComplete callback to connect(): "+e.message)}}),"con")},this.disconnect=function(e,n){if(!a)throw new Error(OpenAjax.hub.Error.Disconnected);a=!1;var r=null;e&&(r=function(r){try{e.call(n||window,t,!0)}catch(e){OpenAjax.hub._debugger(),s("caught error from onComplete callback to disconnect(): "+e.message)}}),OpenAjax.gadgets.rpc.call("..","openajax.pubsub",r,"dis")},this.getPartnerOrigin=function(){if(a){var e=OpenAjax.gadgets.rpc.getReceiverOrigin("..");if(e)return/^([a-zA-Z]+:\/\/[^:]+).*/.exec(e)[1]}return null},this.getClientID=function(){return n},this.subscribe=function(e,n,t,r,a){if(u(),function(e){if(!e)throw new Error(OpenAjax.hub.Error.BadParameters);for(var n=e.split("."),t=n.length,r=0;r<t;r++){var a=n[r];if(""===a||-1!=a.indexOf("*")&&"*"!=a&&"**"!=a)throw new Error(OpenAjax.hub.Error.BadParameters);if("**"==a&&r<t-1)throw new Error(OpenAjax.hub.Error.BadParameters)}}(e),!n)throw new Error(OpenAjax.hub.Error.BadParameters);t=t||window;var c=""+o++;return i[c]={cb:n,sc:t,d:a},OpenAjax.gadgets.rpc.call("..","openajax.pubsub",(function(e){if(""!==e&&delete i[c],r)try{r.call(t,c,""===e,e)}catch(e){OpenAjax.hub._debugger(),s("caught error from onComplete callback to subscribe(): "+e.message)}}),"sub",e,c),c},this.publish=function(e,n){u(),function(e){if(!e||""===e||-1!=e.indexOf("*")||-1!=e.indexOf("..")||"."==e.charAt(0)||"."==e.charAt(e.length-1))throw new Error(OpenAjax.hub.Error.BadParameters)}(e),OpenAjax.gadgets.rpc.call("..","openajax.pubsub",null,"pub",e,n)},this.unsubscribe=function(e,n,t){if(u(),!e)throw new Error(OpenAjax.hub.Error.BadParameters);if(!i[e]||i[e].uns)throw new Error(OpenAjax.hub.Error.NoSubscription);i[e].uns=!0,OpenAjax.gadgets.rpc.call("..","openajax.pubsub",(function(r){if(delete i[e],n)try{n.call(t||window,e,!0)}catch(e){OpenAjax.hub._debugger(),s("caught error from onComplete callback to unsubscribe(): "+e.message)}}),"uns",null,e)},this.isConnected=function(){return a},this.getScope=function(){return r},this.getSubscriberData=function(e){if(u(),i[e])return i[e].d;throw new Error(OpenAjax.hub.Error.NoSubscription)},this.getSubscriberScope=function(e){if(u(),i[e])return i[e].sc;throw new Error(OpenAjax.hub.Error.NoSubscription)},this.getParameters=function(){return e},this._handleIncomingRPC=function(e,n,t,r){if("pub"===e&&i[r]&&!i[r].uns)try{i[r].cb.call(i[r].sc,n,t,i[r].d)}catch(e){OpenAjax.hub._debugger(),s("caught error from onData callback to subscribe(): "+e.message)}return"con"===n},this._init()},OpenAjax.hub.IframeContainer._rpcRouter=function(){var n={};function t(){var e=n[this.f];if(e)return e._handleIncomingRPC.apply(e,arguments)}function r(e,t){var r=n[e];r&&r._onSecurityAlert.call(r,t)}return{add:function(a,i){function o(e,t){if(".."!==e){for(var r=e;document.getElementById(r);)r=e+"_"+(32767*Math.random()|0).toString(16);return n[r]=t,r}n[".."]||(n[".."]=t)}return OpenAjax.gadgets.rpc.register("openajax.pubsub",t),OpenAjax.gadgets.rpc.config({securityCallback:r}),e[OpenAjax.gadgets.rpc.SEC_ERROR_LOAD_TIMEOUT]=OpenAjax.hub.SecurityAlert.LoadTimeout,e[OpenAjax.gadgets.rpc.SEC_ERROR_FRAME_PHISH]=OpenAjax.hub.SecurityAlert.FramePhish,e[OpenAjax.gadgets.rpc.SEC_ERROR_FORGED_MSG]=OpenAjax.hub.SecurityAlert.ForgedMsg,this.add=o,o(a,i)},remove:function(e){delete n[e]}}}();var e={}}(),void 0===OpenAjax._smash&&(OpenAjax._smash={}),OpenAjax._smash.crypto={strToWA:function(e,n){for(var t=Array(),r=(1<<n)-1,a=0;a<e.length*n;a+=n)t[a>>5]|=(e.charCodeAt(a/n)&r)<<32-n-a%32;return t},hmac_sha1:function(e,n,t){for(var r=Array(16),a=Array(16),i=0;i<16;i++)r[i]=909522486^e[i],a[i]=1549556828^e[i];var o=this.sha1(r.concat(this.strToWA(n,t)),512+n.length*t);return this.sha1(a.concat(o),672)},newPRNG:function(e){var n=this;("string"!=typeof e||e.length<12)&&alert("WARNING: Seed length too short ...");var t=[43417,15926,18182,33130,9585,30800,49772,40144,47678,55453,4659,38181,65340,6787,54417,65301],r=[],a=0;function o(e){for(var a,i=(a=e,n.hmac_sha1(t,a,8)),o=0;o<5;o++)r[o]^=i[o]}return o(e),{addSeed:function(e){o(e)},nextRandomOctets:function(e){for(var t=[];e>0;){a+=1;var o=n.hmac_sha1(r,a.toString(16),8);for(i=0;i<20&e>0;i++,e--)t.push((o[i>>2]>>i%4)%256)}return t},nextRandomB64Str:function(e){for(var n=this.nextRandomOctets(e),t="",r=0;r<e;r++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(63&n[r]);return t}}},sha1:function(){var e=function(e,n){var t=(65535&e)+(65535&n);return(e>>16)+(n>>16)+(t>>16)<<16|65535&t},n=function(e,n){return e<<n|e>>>32-n};function t(e,n,t,r){return e<20?n&t|~n&r:e<40?n^t^r:e<60?n&t|n&r|t&r:n^t^r}return function(r,a){r[a>>5]|=128<<24-a%32,r[15+(a+64>>9<<4)]=a;for(var i,o=Array(80),s=1732584193,u=-271733879,c=-1732584194,p=271733878,g=-1009589776,l=0;l<r.length;l+=16){for(var f=s,d=u,h=c,b=p,O=g,x=0;x<80;x++){o[x]=x<16?r[l+x]:n(o[x-3]^o[x-8]^o[x-14]^o[x-16],1);var A=e(e(n(f,5),t(x,d,h,b)),e(e(O,o[x]),(i=x)<20?1518500249:i<40?1859775393:i<60?-1894007588:-899497514));O=b,b=h,h=n(d,30),d=f,f=A}s=e(f,s),u=e(d,u),c=e(h,c),p=e(b,p),g=e(O,g)}return Array(s,u,c,p,g)}}()},this.JSON||(JSON={}),function(){function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,_130=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,_131,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function _132(e){return _130.lastIndex=0,_130.test(e)?'"'+e.replace(_130,(function(e){var n=meta[e];return"string"==typeof n?n:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,n){var t,r,a,i,o,s=gap,u=n[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(n,e,u)),typeof u){case"string":return _132(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=_131,o=[],"[object Array]"===Object.prototype.toString.apply(u)){for(i=u.length,t=0;t<i;t+=1)o[t]=str(t,u)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,a}if(rep&&"object"==typeof rep)for(i=rep.length,t=0;t<i;t+=1)"string"==typeof(r=rep[t])&&(a=str(r,u))&&o.push(_132(r)+(gap?": ":":")+a);else for(r in u)Object.hasOwnProperty.call(u,r)&&(a=str(r,u))&&o.push(_132(r)+(gap?": ":":")+a);return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,a}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,n,t){var r;if(gap="",_131="","number"==typeof t)for(r=0;r<t;r+=1)_131+=" ";else"string"==typeof t&&(_131=t);if(rep=n,n&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,_13b){var j;function walk(e,n){var t,r,a=e[n];if(a&&"object"==typeof a)for(t in a)Object.hasOwnProperty.call(a,t)&&(void 0!==(r=walk(a,t))?a[t]=r:delete a[t]);return _13b.call(e,n,a)}if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof _13b?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),OpenAjax.gadgets.util=function(){var e=null,n=[];return{getUrlParameters:function(n){if(null!==e&&void 0===n)return e;for(var t,r,a,i={},o=(t=n||document.location.href,r=t.indexOf("?"),(-1===(a=t.indexOf("#"))?t.substr(r+1):[t.substr(r+1,a-r-1),"&",t.substr(a+1)].join("")).split("&")),s=window.decodeURIComponent?decodeURIComponent:unescape,u=0,c=o.length;u<c;++u){var p=o[u].indexOf("=");if(-1!==p){var g=o[u].substring(0,p),l=o[u].substring(p+1);l=l.replace(/\+/g," "),i[g]=s(l)}}return void 0===n&&(e=i),i},registerOnLoadHandler:function(e){n.push(e)},runOnLoadHandlers:function(){for(var e=0,t=n.length;e<t;++e)n[e]()},attachBrowserEvent:function(e,n,t,r){e.addEventListener?e.addEventListener(n,t,r):e.attachEvent&&e.attachEvent("on"+n,t)},removeBrowserEvent:function(e,n,t,r){e.removeEventListener?e.removeEventListener(n,t,r):e.detachEvent&&e.detachEvent("on"+n,t)}}}(),OpenAjax.gadgets.util.getUrlParameters(),OpenAjax.gadgets.json=OpenAjax.gadgets.json||{},OpenAjax.gadgets.json.stringify||(OpenAjax.gadgets.json={parse:function(e){try{return window.JSON.parse(e)}catch(e){return!1}},stringify:function(e){try{return window.JSON.stringify(e)}catch(e){return null}}}),OpenAjax.gadgets.log=function(e){OpenAjax.gadgets.log.logAtLevel(OpenAjax.gadgets.log.INFO,e)},OpenAjax.gadgets.warn=function(e){OpenAjax.gadgets.log.logAtLevel(OpenAjax.gadgets.log.WARNING,e)},OpenAjax.gadgets.error=function(e){OpenAjax.gadgets.log.logAtLevel(OpenAjax.gadgets.log.ERROR,e)},OpenAjax.gadgets.setLogLevel=function(e){OpenAjax.gadgets.log.logLevelThreshold_=e},OpenAjax.gadgets.log.logAtLevel=function(e,n){if(!(e<OpenAjax.gadgets.log.logLevelThreshold_)&&OpenAjax.gadgets.log._console){var t=OpenAjax.gadgets.log._console;e==OpenAjax.gadgets.log.WARNING&&t.warn?t.warn(n):e==OpenAjax.gadgets.log.ERROR&&t.error?t.error(n):t.log&&t.log(n)}},OpenAjax.gadgets.log.INFO=1,OpenAjax.gadgets.log.WARNING=2,OpenAjax.gadgets.log.ERROR=3,OpenAjax.gadgets.log.NONE=4,OpenAjax.gadgets.log.logLevelThreshold_=OpenAjax.gadgets.log.INFO,OpenAjax.gadgets.log._console=window.console?window.console:window.opera?window.opera.postError:void 0,function(){if(!window.__isgadget){var e=!1;function n(){e||(e=!0,OpenAjax.gadgets.util.runOnLoadHandlers(),OpenAjax.gadgets.util.registerOnLoadHandler=function(e){setTimeout(e,0)},window.detachEvent&&window.detachEvent("onload",n))}window.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):window.attachEvent&&window.attachEvent("onload",n)}}(),OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{},OpenAjax.gadgets.rpctx.frameElement||(OpenAjax.gadgets.rpctx.frameElement=function(){var e,n,t="__g2c_rpc",r="__c2g_rpc";return{getCode:function(){return"fe"},isParentVerifiable:function(){return!1},init:function(t,r){return e=t,n=r,!0},setup:function(r,a){if(".."!==r)try{document.getElementById(r)[t]=function(n){e(OpenAjax.gadgets.json.parse(n))}}catch(e){return!1}if(".."===r){n("..",!0);OpenAjax.gadgets.util.registerOnLoadHandler((function(){window.setTimeout((function(){OpenAjax.gadgets.rpc.call(r,OpenAjax.gadgets.rpc.ACK)}),500)}))}return!0},call:function(n,a,i){!function(n,a,i){try{if(".."!==a){var o=window.frameElement;if("function"==typeof o[t])return"function"!=typeof o[t][r]&&(o[t][r]=function(n){e(OpenAjax.gadgets.json.parse(n))}),void o[t](OpenAjax.gadgets.json.stringify(i))}else{var s=document.getElementById(n);if("function"==typeof s[t]&&"function"==typeof s[t][r])return void s[t][r](OpenAjax.gadgets.json.stringify(i))}}catch(e){}}(n,a,i)}}}()),OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{},OpenAjax.gadgets.rpctx.ifpc||(OpenAjax.gadgets.rpctx.ifpc=function(){var e,n=[],t=0;function r(e){for(var n=[],t=0,r=e.length;t<r;++t)n.push(encodeURIComponent(OpenAjax.gadgets.json.stringify(e[t])));return n.join("&")}return{getCode:function(){return"ifpc"},isParentVerifiable:function(){return!0},init:function(n,t){return(e=t)("..",!0),!0},setup:function(n,t){return e(n,!0),!0},call:function(e,a,i){var o=OpenAjax.gadgets.rpc.getRelayUrl(e);if(++t,o){var s=null;if(i.l){var u=i.a;s=[o,"#",r([a,t,1,0,r([a,i.s,"","",a].concat(u))])].join("")}else s=[o,"#",e,"&",a,"@",t,"&1&0&",encodeURIComponent(OpenAjax.gadgets.json.stringify(i))].join("");return function(e){for(var t,r=n.length-1;r>=0;--r){var a=n[r];try{if(a&&(a.recyclable||"complete"===a.readyState)){if(a.parentNode.removeChild(a),!window.ActiveXObject){a.recyclable=!1,t=a;break}n[r]=a=null,n.splice(r,1)}}catch(e){}}t||((t=document.createElement("iframe")).style.border=t.style.width=t.style.height="0px",t.style.visibility="hidden",t.style.position="absolute",t.onload=function(){this.recyclable=!0},n.push(t)),t.src=e,window.setTimeout((function(){document.body.appendChild(t)}),0)}(s),!0}OpenAjax.gadgets.warn("No relay file assigned for IFPC")}}}()),OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{},OpenAjax.gadgets.rpctx.rmr||(OpenAjax.gadgets.rpctx.rmr=function(){var e,n,t=500,r=10,a={};function i(e,n,t,r){var a=function(){document.body.appendChild(e),e.src="about:blank",r&&(e.onload=function(){p(r)}),e.src=n+"#"+t};document.body?a():OpenAjax.gadgets.util.registerOnLoadHandler((function(){a()}))}function o(e){if("object"!=typeof a[e]){var n=document.createElement("iframe"),t=n.style;t.position="absolute",t.top="0px",t.border="0",t.opacity="0",t.width="10px",t.height="1px",n.id="rmrtransport-"+e,n.name=n.id;var r=OpenAjax.gadgets.rpc.getRelayUrl(e);r||(r=OpenAjax.gadgets.rpc.getOrigin(OpenAjax.gadgets.util.getUrlParameters().parent)+"/robots.txt"),a[e]={frame:n,receiveWindow:null,relayUri:r,searchCounter:0,width:10,waiting:!0,queue:[],sendId:0,recvId:0},".."!==e&&i(n,r,c(e)),s(e)}}function s(e){var n=null;a[e].searchCounter++;try{var o=OpenAjax.gadgets.rpc._getTargetWin(e);n=".."===e?o.frames["rmrtransport-"+OpenAjax.gadgets.rpc.RPC_ID]:o.frames["rmrtransport-.."]}catch(e){}var u=!1;if(n&&(u=function(e,n){var t=a[e];try{if(!("document"in n))return!1;if(!("object"==typeof n.document))return!1;if("about:blank"===n.location.href)return!1}catch(e){return!1}function r(){p(e)}t.receiveWindow=n,void 0===n.attachEvent?n.onresize=r:n.attachEvent("onresize",r);".."===e?i(t.frame,t.relayUri,c(e),e):p(e);return!0}(e,n)),!u){if(a[e].searchCounter>r)return;window.setTimeout((function(){s(e)}),t)}}function u(e,n,t,r){var i=null;if(i=".."!==t?a[".."]:a[e]){if(n!==OpenAjax.gadgets.rpc.ACK&&i.queue.push(r),i.waiting||0===i.queue.length&&(n!==OpenAjax.gadgets.rpc.ACK||!r||!0!==r.ackAlone))return!0;i.queue.length>0&&(i.waiting=!0);var o=i.relayUri+"#"+c(e);try{i.frame.contentWindow.location=o;var s=10==i.width?20:10;i.frame.style.width=s+"px",i.width=s}catch(e){return!1}}return!0}function c(e){var n=a[e],t={id:n.sendId};return n&&(t.d=Array.prototype.slice.call(n.queue,0),t.d.push({s:OpenAjax.gadgets.rpc.ACK,id:n.recvId})),OpenAjax.gadgets.json.stringify(t)}function p(t){for(var r=a[t],i=r.receiveWindow.location.hash.substring(1),o=OpenAjax.gadgets.json.parse(decodeURIComponent(i))||{},s=o.d||[],c=!1,p=!1,g=0,l=r.recvId-o.id,f=0;f<s.length;++f){var d=s[f];if(d.s!==OpenAjax.gadgets.rpc.ACK)c=!0,++g<=l||(++r.recvId,e(d));else{n(t,!0),r.waiting&&(p=!0),r.waiting=!1;var h=Math.max(0,d.id-r.sendId);r.queue.splice(0,h),r.sendId=Math.max(r.sendId,d.id||0)}}if(c||p&&r.queue.length>0){var b=".."===t?OpenAjax.gadgets.rpc.RPC_ID:"..";u(t,OpenAjax.gadgets.rpc.ACK,b,{ackAlone:c})}}return{getCode:function(){return"rmr"},isParentVerifiable:function(){return!0},init:function(t,r){return e=t,n=r,!0},setup:function(e,n){try{o(e)}catch(e){return OpenAjax.gadgets.warn("Caught exception setting up RMR: "+e),!1}return!0},call:function(e,n,t){return u(e,t.s,n,t)}}}()),OpenAjax.gadgets.rpctx=OpenAjax.gadgets.rpctx||{},OpenAjax.gadgets.rpctx.wpm||(OpenAjax.gadgets.rpctx.wpm=function(){var e,n,t,r=!1,a=!1;function i(n){var t=OpenAjax.gadgets.json.parse(n.data);if(t&&t.f){var r=OpenAjax.gadgets.rpc.getRelayUrl(t.f)||OpenAjax.gadgets.util.getUrlParameters().parent,i=OpenAjax.gadgets.rpc.getOrigin(r);(a?n.domain===/^.+:\/\/([^:]+).*/.exec(i)[1]:n.origin===i)&&e(t)}}return{getCode:function(){return"wpm"},isParentVerifiable:function(){return!0},init:function(o,s){return e=o,n=s,function(){var e=!1;function n(n){"postmessage.test"==n.data&&(e=!0,void 0===n.origin&&(a=!0))}OpenAjax.gadgets.util.attachBrowserEvent(window,"message",n,!1),window.postMessage("postmessage.test","*"),e&&(r=!0),OpenAjax.gadgets.util.removeBrowserEvent(window,"message",n,!1)}(),t=r?function(e,n,t){window.setTimeout((function(){e.postMessage(n,t)}),0)}:function(e,n,t){e.postMessage(n,t)},OpenAjax.gadgets.util.attachBrowserEvent(window,"message",i,!1),n("..",!0),!0},setup:function(e,n,t){return".."===e&&(t?OpenAjax.gadgets.rpc._createRelayIframe(n):OpenAjax.gadgets.rpc.call(e,OpenAjax.gadgets.rpc.ACK)),!0},call:function(e,n,r){var a=OpenAjax.gadgets.rpc._getTargetWin(e),i=OpenAjax.gadgets.rpc.getRelayUrl(e)||OpenAjax.gadgets.util.getUrlParameters().parent,o=OpenAjax.gadgets.rpc.getOrigin(i);return o?t(a,OpenAjax.gadgets.json.stringify(r),o):OpenAjax.gadgets.error("No relay set (used as window.postMessage targetOrigin), cannot send cross-domain message"),!0},relayOnload:function(e,t){n(e,!0)}}}()),OpenAjax.gadgets.rpc||(OpenAjax.gadgets.rpc=function(){var e="__cb",n="",t="__ack",r=500,a=10,i={},o={},s={},u={},c=0,p={},g={},l={},f={},d={},h={},b=window.top!==window.self,O=window.name,x=function(){},A=2,j=function(){function e(e){return function(){OpenAjax.gadgets.log("gadgets.rpc."+e+"("+OpenAjax.gadgets.json.stringify(Array.prototype.slice.call(arguments))+"): call ignored. [caller: "+document.location+", isChild: "+b+"]")}}return{getCode:function(){return"noop"},isParentVerifiable:function(){return!0},init:e("init"),setup:e("setup"),call:e("call")}}();function m(e,n){var t=I;n||(t=j),d[e]=t;for(var r=h[e]||[],a=0;a<r.length;++a){var i=r[a];i.t=P(e),t.call(e,i.f,i)}h[e]=[]}OpenAjax.gadgets.util&&(f=OpenAjax.gadgets.util.getUrlParameters());var v=!1,w=!1;function y(e,n,t,r,a){u[n]&&u[n]===t||(OpenAjax.gadgets.error("Invalid auth token. "+u[n]+" vs "+t),x(n,A)),a.onunload=function(){g[n]&&!v&&(x(n,1),OpenAjax.gadgets.rpc.removeReceiver(n))},w||(OpenAjax.gadgets.util.attachBrowserEvent(window,"unload",(function(){v=!0}),!1),w=!0),r=OpenAjax.gadgets.json.parse(decodeURIComponent(r)),I.relayOnload(n,r)}function _(r){if(r&&"string"==typeof r.s&&"string"==typeof r.f&&r.a instanceof Array){if(u[r.f]&&u[r.f]!==r.t&&(OpenAjax.gadgets.error("Invalid auth token. "+u[r.f]+" vs "+r.t),x(r.f,A)),r.s===t)return void window.setTimeout((function(){m(r.f,!0)}),0);r.c&&(r.callback=function(n){OpenAjax.gadgets.rpc.call(r.f,e,null,r.c,n)});var a=(i[r.s]||i[n]).apply(r,r.a);r.c&&void 0!==a&&OpenAjax.gadgets.rpc.call(r.f,e,null,r.c,a)}}function C(e){if(!e)return"";0==(e=e.toLowerCase()).indexOf("//")&&(e=window.location.protocol+e),-1==e.indexOf("://")&&(e=window.location.protocol+"//"+e);var n=e.substring(e.indexOf("://")+3),t=n.indexOf("/");-1!=t&&(n=n.substring(0,t));var r=e.substring(0,e.indexOf("://")),a="",i=n.indexOf(":");if(-1!=i){var o=n.substring(i+1);n=n.substring(0,i),("http"===r&&"80"!==o||"https"===r&&"443"!==o)&&(a=":"+o)}return r+"://"+n+a}function E(e){if(void 0===e||".."===e)return window.parent;e=String(e);var n=window.frames[e];return n||((n=document.getElementById(e))&&n.contentWindow?n.contentWindow:null)}var I="function"==typeof window.postMessage||"object"==typeof window.postMessage?OpenAjax.gadgets.rpctx.wpm:navigator.userAgent.indexOf("WebKit")>0?OpenAjax.gadgets.rpctx.rmr:"Gecko"===navigator.product?OpenAjax.gadgets.rpctx.frameElement:OpenAjax.gadgets.rpctx.ifpc;function S(e,n,t){if(!0!==g[e]){void 0===g[e]&&(g[e]=0);var i=document.getElementById(e);".."!==e&&null==i||!0!==I.setup(e,n,t)?!0!==g[e]&&g[e]++<a?window.setTimeout((function(){S(e,n,t)}),r):(d[e]=j,g[e]=!0):g[e]=!0}}function R(e,n,t){/http(s)?:\/\/.+/.test(n)||(0==n.indexOf("//")?n=window.location.protocol+n:"/"==n.charAt(0)?n=window.location.protocol+"//"+window.location.host+n:-1==n.indexOf("://")&&(n=window.location.protocol+"//"+n)),o[e]=n,s[e]=!!t}function P(e){return u[e]}function H(e,n,t){n=n||"",u[e]=String(n),S(e,n,t)}function k(e,n,t,r){if(".."===e){var a=t||f.rpctoken||f.ifpctok||"";!0===window.__isgadget?(c=a,p=r,g={parentRelayUrl:OpenAjax.gadgets.config.NonEmptyStringValidator},OpenAjax.gadgets.config.register("rpc",g,(function(e){var n=e?e.rpc:{},t=n.parentRelayUrl;if("http://"!==t.substring(0,7)&&"https://"!==t.substring(0,8)&&"//"!==t.substring(0,2)&&"string"==typeof f.parent&&""!==f.parent)if("/"!==t.substring(0,1)){var r=f.parent.lastIndexOf("/");t=f.parent.substring(0,r+1)+t}else t=C(f.parent)+t;var a=!!n.useLegacyProtocol;R("..",t,a),a&&(I=OpenAjax.gadgets.rpctx.ifpc).init(_,m);var i=p||f.forcesecure||!1;H("..",c,i)}))):(i=a,o=n,s=r||f.forcesecure||!1,(u=o||f.parent)&&(R("..",u),H("..",i,s)))}else!function(e,n,t,r){if(OpenAjax.gadgets.util){var a=document.getElementById(e);if(!a)throw new Error("Cannot set up gadgets.rpc receiver with ID: "+e+", element not found.");R(e,n||a.src);var i=OpenAjax.gadgets.util.getUrlParameters(a.src);H(e,t||i.rpctoken,r||i.forcesecure)}}(e,n,t,r);var i,o,s,u,c,p,g}return i[n]=function(){OpenAjax.gadgets.warn("Unknown RPC service: "+this.s)},i[e]=function(e,n){var t=p[e];t&&(delete p[e],t(n))},{config:function(e){"function"==typeof e.securityCallback&&(x=e.securityCallback)},register:function(r,a){if(r===e||r===t)throw new Error("Cannot overwrite callback/ack service");if(r===n)throw new Error("Cannot overwrite default service: use registerDefault");i[r]=a},unregister:function(r){if(r===e||r===t)throw new Error("Cannot delete callback/ack service");if(r===n)throw new Error("Cannot delete default service: use unregisterDefault");delete i[r]},registerDefault:function(e){i[n]=e},unregisterDefault:function(){delete i[n]},forceParentVerifiable:function(){I.isParentVerifiable()||(I=OpenAjax.gadgets.rpctx.ifpc)},call:function(e,n,t,r){var a="..";".."===(e=e||"..")&&(a=O),++c,t&&(p[c]=t);var i={s:n,f:a,c:t?c:0,a:Array.prototype.slice.call(arguments,3),t:u[e],l:s[e]};if(".."===e||document.getElementById(e)){if(!function(e,n){if(void 0===l[e]){if(l[e]=!1,C(OpenAjax.gadgets.rpc.getRelayUrl(e))!==C(window.location.href))return!1;var t=E(e);try{l[e]=t.OpenAjax.gadgets.rpc.receiveSameDomain}catch(e){OpenAjax.gadgets.error("Same domain call failed: parent= incorrectly set.")}}return"function"==typeof l[e]&&(l[e](n),!0)}(e,i)){var o=d[e];o?(s[e]&&(o=OpenAjax.gadgets.rpctx.ifpc),!1===o.call(e,a,i)&&(d[e]=j,I.call(e,a,i))):h[e]?h[e].push(i):h[e]=[i]}}else OpenAjax.gadgets.log("WARNING: attempted send to nonexistent frame: "+e)},getRelayUrl:function(e){var n=o[e];return n&&"/"===n.substring(0,1)&&(n="/"===n.substring(1,2)?document.location.protocol+n:document.location.protocol+"//"+document.location.host+n),n},setRelayUrl:R,setAuthToken:H,setupReceiver:k,getAuthToken:P,removeReceiver:function(e){delete o[e],delete s[e],delete u[e],delete g[e],delete l[e],delete d[e]},getRelayChannel:function(){return I.getCode()},receive:function(e,n){e.length>4?_(OpenAjax.gadgets.json.parse(decodeURIComponent(e[e.length-1]))):y.apply(null,e.concat(n))},receiveSameDomain:function(e){e.a=Array.prototype.slice.call(e.a),window.setTimeout((function(){_(e)}),0)},getOrigin:C,getReceiverOrigin:function(e){var n=d[e];if(!n)return null;if(!n.isParentVerifiable(e))return null;var t=OpenAjax.gadgets.rpc.getRelayUrl(e)||OpenAjax.gadgets.util.getUrlParameters().parent;return OpenAjax.gadgets.rpc.getOrigin(t)},init:function(){!1===I.init(_,m)&&(I=j),b&&k("..")},_getTargetWin:E,_createRelayIframe:function(e,n){var t=OpenAjax.gadgets.rpc.getRelayUrl("..");if(t){var r=t+"#..&"+O+"&"+e+"&"+encodeURIComponent(OpenAjax.gadgets.json.stringify(n)),a=document.createElement("iframe");return a.style.border=a.style.width=a.style.height="0px",a.style.visibility="hidden",a.style.position="absolute",document.body?i():OpenAjax.gadgets.util.registerOnLoadHandler((function(){i()})),a}function i(){document.body.appendChild(a),a.src='javascript:"<html></html>"',a.src=r}},ACK:t,RPC_ID:O,SEC_ERROR_LOAD_TIMEOUT:0,SEC_ERROR_FRAME_PHISH:1,SEC_ERROR_FORGED_MSG:A}}(),OpenAjax.gadgets.rpc.init());